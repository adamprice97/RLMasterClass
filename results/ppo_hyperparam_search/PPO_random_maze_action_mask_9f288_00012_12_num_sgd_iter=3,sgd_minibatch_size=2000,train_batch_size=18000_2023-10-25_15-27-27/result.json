{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0003, "total_loss": 9.291155320626718, "policy_loss": -0.0026978985578925523, "vf_loss": 9.293178381743255, "vf_explained_var": 2.9457939995659723e-05, "kl": 0.003740907904748018, "entropy": 0.7349501715766059, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 41.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -25.68974358974393, "episode_len_mean": 423.8974358974359, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, 17.099999999999802, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 9.299999999999692, 29.299999999999976, 41.500000000000014, 17.69999999999981, 30.499999999999993, 36.50000000000003, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, -50.00000000000044, -50.00000000000044], "episode_lengths": [124, 500, 500, 500, 500, 500, 500, 500, 500, 370, 500, 330, 500, 500, 500, 500, 500, 500, 500, 218, 500, 408, 208, 86, 324, 196, 136, 302, 500, 500, 500, 462, 500, 500, 500, 500, 368, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37054552973517196, "mean_inference_ms": 1.190016296930977, "mean_action_processing_ms": 0.14143575864709862, "mean_env_wait_ms": 0.08229309339693884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030755996704101562, "StateBufferConnector_ms": 0.0025645280495668068, "ViewRequirementAgentConnector_ms": 0.13341292356833434}}, "episode_reward_max": 41.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -25.68974358974393, "episode_len_mean": 423.8974358974359, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, 17.099999999999802, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 9.299999999999692, 29.299999999999976, 41.500000000000014, 17.69999999999981, 30.499999999999993, 36.50000000000003, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, -50.00000000000044, -50.00000000000044], "episode_lengths": [124, 500, 500, 500, 500, 500, 500, 500, 500, 370, 500, 330, 500, 500, 500, 500, 500, 500, 500, 218, 500, 408, 208, 86, 324, 196, 136, 302, 500, 500, 500, 462, 500, 500, 500, 500, 368, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37054552973517196, "mean_inference_ms": 1.190016296930977, "mean_action_processing_ms": 0.14143575864709862, "mean_env_wait_ms": 0.08229309339693884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030755996704101562, "StateBufferConnector_ms": 0.0025645280495668068, "ViewRequirementAgentConnector_ms": 0.13341292356833434}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5905.560126325334, "num_env_steps_trained_throughput_per_sec": 5905.560126325334, "timesteps_total": 18000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 3047.975, "sample_time_ms": 2834.187, "load_time_ms": 13.786, "load_throughput": 1305710.244, "learn_time_ms": 188.001, "learn_throughput": 95743.971, "synch_weights_time_ms": 9.998}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 39, "training_iteration": 1, "trial_id": "9f288_00012", "date": "2023-10-25_16-31-40", "timestamp": 1698247900, "time_this_iter_s": 3.0529725551605225, "time_total_s": 3.0529725551605225, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 3.0529725551605225, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 59.480000000000004, "ram_util_percent": 25.959999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 9.060537656148275, "policy_loss": -0.0013339210439611364, "vf_loss": 9.061623255411783, "vf_explained_var": 1.1117370040328414e-05, "kl": 0.003194780467933479, "entropy": 0.7107124703901785, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -9.420430107527137, "episode_len_mean": 358.1720430107527, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, 17.099999999999802, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 9.299999999999692, 29.299999999999976, 41.500000000000014, 17.69999999999981, 30.499999999999993, 36.50000000000003, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 28.499999999999964, 18.899999999999828, 36.10000000000004, 47.3, 40.10000000000002, 36.50000000000003, 30.699999999999996, 29.899999999999984, 10.899999999999714, 28.29999999999996, 2.499999999999595, 28.29999999999996, 9.499999999999694, 34.10000000000004, 18.099999999999817, 35.900000000000034, 38.50000000000003, 45.3, -50.00000000000044, 35.500000000000036, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 37.70000000000003, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 39.10000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 32.90000000000003, 39.300000000000026, 26.499999999999936, 18.099999999999817, 4.099999999999618, 35.70000000000003, 21.89999999999987, 39.10000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004], "episode_lengths": [124, 500, 500, 500, 500, 500, 500, 500, 500, 370, 500, 330, 500, 500, 500, 500, 500, 500, 500, 218, 500, 408, 208, 86, 324, 196, 136, 302, 500, 500, 500, 462, 500, 500, 500, 500, 368, 500, 500, 500, 500, 192, 500, 500, 216, 312, 140, 28, 100, 136, 194, 202, 392, 218, 476, 218, 406, 160, 320, 142, 116, 48, 500, 146, 274, 500, 500, 500, 500, 482, 124, 500, 500, 414, 500, 110, 116, 500, 500, 500, 106, 500, 172, 108, 236, 320, 460, 144, 282, 110, 500, 500, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37497105384448126, "mean_inference_ms": 1.1973121506418147, "mean_action_processing_ms": 0.14078935799092168, "mean_env_wait_ms": 0.08310054674742078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03116643556984522, "StateBufferConnector_ms": 0.002150381765057964, "ViewRequirementAgentConnector_ms": 0.14410890558714506}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -9.420430107527137, "episode_len_mean": 358.1720430107527, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, 17.099999999999802, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 9.299999999999692, 29.299999999999976, 41.500000000000014, 17.69999999999981, 30.499999999999993, 36.50000000000003, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 28.499999999999964, 18.899999999999828, 36.10000000000004, 47.3, 40.10000000000002, 36.50000000000003, 30.699999999999996, 29.899999999999984, 10.899999999999714, 28.29999999999996, 2.499999999999595, 28.29999999999996, 9.499999999999694, 34.10000000000004, 18.099999999999817, 35.900000000000034, 38.50000000000003, 45.3, -50.00000000000044, 35.500000000000036, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 37.70000000000003, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 39.10000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 32.90000000000003, 39.300000000000026, 26.499999999999936, 18.099999999999817, 4.099999999999618, 35.70000000000003, 21.89999999999987, 39.10000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004], "episode_lengths": [124, 500, 500, 500, 500, 500, 500, 500, 500, 370, 500, 330, 500, 500, 500, 500, 500, 500, 500, 218, 500, 408, 208, 86, 324, 196, 136, 302, 500, 500, 500, 462, 500, 500, 500, 500, 368, 500, 500, 500, 500, 192, 500, 500, 216, 312, 140, 28, 100, 136, 194, 202, 392, 218, 476, 218, 406, 160, 320, 142, 116, 48, 500, 146, 274, 500, 500, 500, 500, 482, 124, 500, 500, 414, 500, 110, 116, 500, 500, 500, 106, 500, 172, 108, 236, 320, 460, 144, 282, 110, 500, 500, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37497105384448126, "mean_inference_ms": 1.1973121506418147, "mean_action_processing_ms": 0.14078935799092168, "mean_env_wait_ms": 0.08310054674742078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03116643556984522, "StateBufferConnector_ms": 0.002150381765057964, "ViewRequirementAgentConnector_ms": 0.14410890558714506}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5694.471780081338, "num_env_steps_trained_throughput_per_sec": 5694.471780081338, "timesteps_total": 36000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 3104.468, "sample_time_ms": 2845.849, "load_time_ms": 15.402, "load_throughput": 1168682.471, "learn_time_ms": 231.13, "learn_throughput": 77878.169, "synch_weights_time_ms": 10.582}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 93, "training_iteration": 2, "trial_id": "9f288_00012", "date": "2023-10-25_16-31-43", "timestamp": 1698247903, "time_this_iter_s": 3.1682236194610596, "time_total_s": 6.221196174621582, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.221196174621582, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 65.625, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0003, "total_loss": 9.003453572591146, "policy_loss": -0.0007003065612581042, "vf_loss": 9.004112173009801, "vf_explained_var": 7.940663231743707e-06, "kl": 0.0021778665430213515, "entropy": 0.6735361748271518, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6769999999998066, "episode_len_mean": 308.88, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.29999999999996, 2.499999999999595, 28.29999999999996, 9.499999999999694, 34.10000000000004, 18.099999999999817, 35.900000000000034, 38.50000000000003, 45.3, -50.00000000000044, 35.500000000000036, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 37.70000000000003, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 39.10000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 32.90000000000003, 39.300000000000026, 26.499999999999936, 18.099999999999817, 4.099999999999618, 35.70000000000003, 21.89999999999987, 39.10000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 34.70000000000004, 27.49999999999995, 40.500000000000014, -50.00000000000044, 22.299999999999876, 34.30000000000004, 24.499999999999908, 17.899999999999814, 39.50000000000002, 33.70000000000004, 31.900000000000013, 16.699999999999797, -50.00000000000044, 30.699999999999996, 34.70000000000004, -50.00000000000044, 27.49999999999995, 23.29999999999989, 37.10000000000003, -50.00000000000044, -50.00000000000044, 34.30000000000004, 26.299999999999933, 31.900000000000013, -50.00000000000044, -50.00000000000044, 15.099999999999774, 36.30000000000003, -50.00000000000044, -50.00000000000044, 32.100000000000016, 33.500000000000036, -50.00000000000044, 41.30000000000001, 20.699999999999854, -50.00000000000044, 42.10000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, 4.899999999999629, 19.09999999999983, 46.099999999999994, 23.29999999999989, 38.300000000000026, -50.00000000000044, 37.50000000000003, 37.90000000000003, 45.5, 27.699999999999953, -50.00000000000044, -50.00000000000044, 11.29999999999972, 45.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [218, 476, 218, 406, 160, 320, 142, 116, 48, 500, 146, 274, 500, 500, 500, 500, 482, 124, 500, 500, 414, 500, 110, 116, 500, 500, 500, 106, 500, 172, 108, 236, 320, 460, 144, 282, 110, 500, 500, 158, 500, 500, 154, 226, 96, 500, 278, 158, 256, 322, 106, 164, 182, 334, 500, 194, 154, 500, 226, 268, 130, 500, 500, 158, 238, 182, 500, 500, 350, 138, 500, 500, 180, 166, 500, 88, 294, 500, 80, 500, 104, 500, 156, 500, 452, 310, 40, 268, 118, 500, 126, 122, 46, 224, 500, 500, 388, 46, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778180349442167, "mean_inference_ms": 1.207702682231199, "mean_action_processing_ms": 0.14002240974503663, "mean_env_wait_ms": 0.08298246978458103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0289919376373291, "StateBufferConnector_ms": 0.0029990673065185547, "ViewRequirementAgentConnector_ms": 0.1275618076324463}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6769999999998066, "episode_len_mean": 308.88, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.29999999999996, 2.499999999999595, 28.29999999999996, 9.499999999999694, 34.10000000000004, 18.099999999999817, 35.900000000000034, 38.50000000000003, 45.3, -50.00000000000044, 35.500000000000036, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 37.70000000000003, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 39.10000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 32.90000000000003, 39.300000000000026, 26.499999999999936, 18.099999999999817, 4.099999999999618, 35.70000000000003, 21.89999999999987, 39.10000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 34.70000000000004, 27.49999999999995, 40.500000000000014, -50.00000000000044, 22.299999999999876, 34.30000000000004, 24.499999999999908, 17.899999999999814, 39.50000000000002, 33.70000000000004, 31.900000000000013, 16.699999999999797, -50.00000000000044, 30.699999999999996, 34.70000000000004, -50.00000000000044, 27.49999999999995, 23.29999999999989, 37.10000000000003, -50.00000000000044, -50.00000000000044, 34.30000000000004, 26.299999999999933, 31.900000000000013, -50.00000000000044, -50.00000000000044, 15.099999999999774, 36.30000000000003, -50.00000000000044, -50.00000000000044, 32.100000000000016, 33.500000000000036, -50.00000000000044, 41.30000000000001, 20.699999999999854, -50.00000000000044, 42.10000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, 4.899999999999629, 19.09999999999983, 46.099999999999994, 23.29999999999989, 38.300000000000026, -50.00000000000044, 37.50000000000003, 37.90000000000003, 45.5, 27.699999999999953, -50.00000000000044, -50.00000000000044, 11.29999999999972, 45.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [218, 476, 218, 406, 160, 320, 142, 116, 48, 500, 146, 274, 500, 500, 500, 500, 482, 124, 500, 500, 414, 500, 110, 116, 500, 500, 500, 106, 500, 172, 108, 236, 320, 460, 144, 282, 110, 500, 500, 158, 500, 500, 154, 226, 96, 500, 278, 158, 256, 322, 106, 164, 182, 334, 500, 194, 154, 500, 226, 268, 130, 500, 500, 158, 238, 182, 500, 500, 350, 138, 500, 500, 180, 166, 500, 88, 294, 500, 80, 500, 104, 500, 156, 500, 452, 310, 40, 268, 118, 500, 126, 122, 46, 224, 500, 500, 388, 46, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778180349442167, "mean_inference_ms": 1.207702682231199, "mean_action_processing_ms": 0.14002240974503663, "mean_env_wait_ms": 0.08298246978458103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0289919376373291, "StateBufferConnector_ms": 0.0029990673065185547, "ViewRequirementAgentConnector_ms": 0.1275618076324463}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5505.789878312865, "num_env_steps_trained_throughput_per_sec": 5505.789878312865, "timesteps_total": 54000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 3159.407, "sample_time_ms": 2850.574, "load_time_ms": 17.955, "load_throughput": 1002480.463, "learn_time_ms": 279.484, "learn_throughput": 64404.468, "synch_weights_time_ms": 10.056}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 153, "training_iteration": 3, "trial_id": "9f288_00012", "date": "2023-10-25_16-31-47", "timestamp": 1698247907, "time_this_iter_s": 3.2743561267852783, "time_total_s": 9.49555230140686, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 9.49555230140686, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 57.839999999999996, "ram_util_percent": 26.059999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0003, "total_loss": 9.041652644122088, "policy_loss": -9.163048256326604e-05, "vf_loss": 9.041791880572283, "vf_explained_var": -1.7417801751030816e-06, "kl": 0.0006198380933668617, "entropy": 0.6293741541880148, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.056999999999846, "episode_len_mean": 265.18, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 20.699999999999854, -50.00000000000044, 42.10000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, 4.899999999999629, 19.09999999999983, 46.099999999999994, 23.29999999999989, 38.300000000000026, -50.00000000000044, 37.50000000000003, 37.90000000000003, 45.5, 27.699999999999953, -50.00000000000044, -50.00000000000044, 11.29999999999972, 45.5, -50.00000000000044, -50.00000000000044, 27.899999999999956, 23.099999999999888, 40.30000000000002, 43.7, 40.500000000000014, 40.10000000000002, -50.00000000000044, 41.30000000000001, 4.699999999999626, 32.30000000000002, 42.900000000000006, 41.500000000000014, 33.10000000000003, 26.499999999999936, 37.300000000000026, 20.49999999999985, 40.30000000000002, 18.099999999999817, 32.100000000000016, 37.90000000000003, 2.699999999999598, 14.499999999999766, 39.10000000000002, -50.00000000000044, -50.00000000000044, 34.900000000000034, 32.700000000000024, 22.899999999999885, -50.00000000000044, 34.50000000000004, -50.00000000000044, 43.10000000000001, 37.300000000000026, 39.300000000000026, 43.30000000000001, 42.500000000000014, 41.90000000000001, 11.699999999999726, 33.90000000000004, -50.00000000000044, 13.099999999999746, 46.699999999999996, -50.00000000000044, 29.899999999999984, 38.90000000000002, 32.700000000000024, 6.8999999999996575, 30.099999999999987, 40.70000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 34.30000000000004, -50.00000000000044, 36.70000000000003, 23.699999999999896, 36.70000000000003, 42.900000000000006, 38.90000000000002, 41.500000000000014, 20.899999999999856, 43.50000000000001, -50.00000000000044, 3.2999999999996064, 0.09999999999956088, 40.90000000000002, -50.00000000000044, 44.5, 4.299999999999621, 14.09999999999976, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 88, 294, 500, 80, 500, 104, 500, 156, 500, 452, 310, 40, 268, 118, 500, 126, 122, 46, 224, 500, 500, 388, 46, 500, 500, 222, 270, 98, 64, 96, 100, 500, 88, 454, 178, 72, 86, 170, 236, 128, 296, 98, 320, 180, 122, 474, 356, 110, 500, 500, 152, 174, 272, 500, 156, 500, 70, 128, 108, 68, 76, 82, 384, 162, 500, 370, 34, 500, 202, 112, 174, 432, 200, 94, 500, 76, 500, 158, 500, 134, 264, 134, 72, 112, 86, 292, 66, 500, 468, 500, 92, 500, 56, 458, 360, 160, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37406524431852345, "mean_inference_ms": 1.2063823578383397, "mean_action_processing_ms": 0.14036139018013513, "mean_env_wait_ms": 0.08253878383397842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023510456085205078, "StateBufferConnector_ms": 0.0060062408447265625, "ViewRequirementAgentConnector_ms": 0.10451436042785645}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.056999999999846, "episode_len_mean": 265.18, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 20.699999999999854, -50.00000000000044, 42.10000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, 4.899999999999629, 19.09999999999983, 46.099999999999994, 23.29999999999989, 38.300000000000026, -50.00000000000044, 37.50000000000003, 37.90000000000003, 45.5, 27.699999999999953, -50.00000000000044, -50.00000000000044, 11.29999999999972, 45.5, -50.00000000000044, -50.00000000000044, 27.899999999999956, 23.099999999999888, 40.30000000000002, 43.7, 40.500000000000014, 40.10000000000002, -50.00000000000044, 41.30000000000001, 4.699999999999626, 32.30000000000002, 42.900000000000006, 41.500000000000014, 33.10000000000003, 26.499999999999936, 37.300000000000026, 20.49999999999985, 40.30000000000002, 18.099999999999817, 32.100000000000016, 37.90000000000003, 2.699999999999598, 14.499999999999766, 39.10000000000002, -50.00000000000044, -50.00000000000044, 34.900000000000034, 32.700000000000024, 22.899999999999885, -50.00000000000044, 34.50000000000004, -50.00000000000044, 43.10000000000001, 37.300000000000026, 39.300000000000026, 43.30000000000001, 42.500000000000014, 41.90000000000001, 11.699999999999726, 33.90000000000004, -50.00000000000044, 13.099999999999746, 46.699999999999996, -50.00000000000044, 29.899999999999984, 38.90000000000002, 32.700000000000024, 6.8999999999996575, 30.099999999999987, 40.70000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 34.30000000000004, -50.00000000000044, 36.70000000000003, 23.699999999999896, 36.70000000000003, 42.900000000000006, 38.90000000000002, 41.500000000000014, 20.899999999999856, 43.50000000000001, -50.00000000000044, 3.2999999999996064, 0.09999999999956088, 40.90000000000002, -50.00000000000044, 44.5, 4.299999999999621, 14.09999999999976, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 88, 294, 500, 80, 500, 104, 500, 156, 500, 452, 310, 40, 268, 118, 500, 126, 122, 46, 224, 500, 500, 388, 46, 500, 500, 222, 270, 98, 64, 96, 100, 500, 88, 454, 178, 72, 86, 170, 236, 128, 296, 98, 320, 180, 122, 474, 356, 110, 500, 500, 152, 174, 272, 500, 156, 500, 70, 128, 108, 68, 76, 82, 384, 162, 500, 370, 34, 500, 202, 112, 174, 432, 200, 94, 500, 76, 500, 158, 500, 134, 264, 134, 72, 112, 86, 292, 66, 500, 468, 500, 92, 500, 56, 458, 360, 160, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37406524431852345, "mean_inference_ms": 1.2063823578383397, "mean_action_processing_ms": 0.14036139018013513, "mean_env_wait_ms": 0.08253878383397842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023510456085205078, "StateBufferConnector_ms": 0.0060062408447265625, "ViewRequirementAgentConnector_ms": 0.10451436042785645}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5604.577645671933, "num_env_steps_trained_throughput_per_sec": 5604.577645671933, "timesteps_total": 72000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 3172.221, "sample_time_ms": 2847.956, "load_time_ms": 17.053, "load_throughput": 1055547.008, "learn_time_ms": 296.083, "learn_throughput": 60793.818, "synch_weights_time_ms": 9.875}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 227, "training_iteration": 4, "trial_id": "9f288_00012", "date": "2023-10-25_16-31-50", "timestamp": 1698247910, "time_this_iter_s": 3.2184946537017822, "time_total_s": 12.714046955108643, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 12.714046955108643, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 62.925, "ram_util_percent": 26.049999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0003, "total_loss": 8.684695914939597, "policy_loss": -0.0002861372022717087, "vf_loss": 8.68504050925926, "vf_explained_var": -8.6824099222819e-06, "kl": 0.0005054087657522696, "entropy": 0.6479016829420019, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 122.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.077999999999827, "episode_len_mean": 279.94, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.90000000000004, -50.00000000000044, 13.099999999999746, 46.699999999999996, -50.00000000000044, 29.899999999999984, 38.90000000000002, 32.700000000000024, 6.8999999999996575, 30.099999999999987, 40.70000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 34.30000000000004, -50.00000000000044, 36.70000000000003, 23.699999999999896, 36.70000000000003, 42.900000000000006, 38.90000000000002, 41.500000000000014, 20.899999999999856, 43.50000000000001, -50.00000000000044, 3.2999999999996064, 0.09999999999956088, 40.90000000000002, -50.00000000000044, 44.5, 4.299999999999621, 14.09999999999976, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 40.500000000000014, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.500000000000014, 35.30000000000004, 35.10000000000004, 25.899999999999928, 21.699999999999868, -50.00000000000044, 45.5, 39.10000000000002, 43.10000000000001, 45.7, 43.7, 5.899999999999643, 43.10000000000001, 36.10000000000004, 26.09999999999993, -50.00000000000044, 35.70000000000003, 36.30000000000003, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.10000000000001, 10.499999999999709, 7.699999999999669, 33.500000000000036, -50.00000000000044, 42.30000000000001, 2.499999999999595, 39.10000000000002, 34.30000000000004, -50.00000000000044, 31.900000000000013, 4.499999999999623, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002, 11.899999999999729, 24.299999999999905, 35.10000000000004, 19.499999999999837, -50.00000000000044, -50.00000000000044, 37.10000000000003, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 37.70000000000003, 33.70000000000004, 23.8999999999999, 34.70000000000004, 42.500000000000014, 40.30000000000002, 0.6999999999995694, -50.00000000000044], "episode_lengths": [162, 500, 370, 34, 500, 202, 112, 174, 432, 200, 94, 500, 76, 500, 158, 500, 134, 264, 134, 72, 112, 86, 292, 66, 500, 468, 500, 92, 500, 56, 458, 360, 160, 500, 500, 500, 500, 106, 96, 500, 114, 500, 500, 74, 76, 148, 150, 242, 284, 500, 46, 110, 70, 44, 64, 442, 70, 140, 240, 500, 144, 138, 500, 78, 500, 60, 396, 424, 166, 500, 78, 476, 110, 158, 500, 182, 456, 500, 78, 500, 500, 176, 382, 258, 150, 306, 500, 500, 130, 492, 500, 500, 124, 164, 262, 154, 76, 98, 494, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3746713247035349, "mean_inference_ms": 1.2075465951743611, "mean_action_processing_ms": 0.14194220192103862, "mean_env_wait_ms": 0.08126963617287414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021005630493164062, "StateBufferConnector_ms": 0.009508848190307617, "ViewRequirementAgentConnector_ms": 0.11772871017456055}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.077999999999827, "episode_len_mean": 279.94, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.90000000000004, -50.00000000000044, 13.099999999999746, 46.699999999999996, -50.00000000000044, 29.899999999999984, 38.90000000000002, 32.700000000000024, 6.8999999999996575, 30.099999999999987, 40.70000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 34.30000000000004, -50.00000000000044, 36.70000000000003, 23.699999999999896, 36.70000000000003, 42.900000000000006, 38.90000000000002, 41.500000000000014, 20.899999999999856, 43.50000000000001, -50.00000000000044, 3.2999999999996064, 0.09999999999956088, 40.90000000000002, -50.00000000000044, 44.5, 4.299999999999621, 14.09999999999976, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 40.500000000000014, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.500000000000014, 35.30000000000004, 35.10000000000004, 25.899999999999928, 21.699999999999868, -50.00000000000044, 45.5, 39.10000000000002, 43.10000000000001, 45.7, 43.7, 5.899999999999643, 43.10000000000001, 36.10000000000004, 26.09999999999993, -50.00000000000044, 35.70000000000003, 36.30000000000003, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.10000000000001, 10.499999999999709, 7.699999999999669, 33.500000000000036, -50.00000000000044, 42.30000000000001, 2.499999999999595, 39.10000000000002, 34.30000000000004, -50.00000000000044, 31.900000000000013, 4.499999999999623, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002, 11.899999999999729, 24.299999999999905, 35.10000000000004, 19.499999999999837, -50.00000000000044, -50.00000000000044, 37.10000000000003, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 37.70000000000003, 33.70000000000004, 23.8999999999999, 34.70000000000004, 42.500000000000014, 40.30000000000002, 0.6999999999995694, -50.00000000000044], "episode_lengths": [162, 500, 370, 34, 500, 202, 112, 174, 432, 200, 94, 500, 76, 500, 158, 500, 134, 264, 134, 72, 112, 86, 292, 66, 500, 468, 500, 92, 500, 56, 458, 360, 160, 500, 500, 500, 500, 106, 96, 500, 114, 500, 500, 74, 76, 148, 150, 242, 284, 500, 46, 110, 70, 44, 64, 442, 70, 140, 240, 500, 144, 138, 500, 78, 500, 60, 396, 424, 166, 500, 78, 476, 110, 158, 500, 182, 456, 500, 78, 500, 500, 176, 382, 258, 150, 306, 500, 500, 130, 492, 500, 500, 124, 164, 262, 154, 76, 98, 494, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3746713247035349, "mean_inference_ms": 1.2075465951743611, "mean_action_processing_ms": 0.14194220192103862, "mean_env_wait_ms": 0.08126963617287414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021005630493164062, "StateBufferConnector_ms": 0.009508848190307617, "ViewRequirementAgentConnector_ms": 0.11772871017456055}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5514.711222155711, "num_env_steps_trained_throughput_per_sec": 5514.711222155711, "timesteps_total": 90000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 3190.576, "sample_time_ms": 2842.522, "load_time_ms": 18.659, "load_throughput": 964680.916, "learn_time_ms": 318.107, "learn_throughput": 56584.822, "synch_weights_time_ms": 9.895}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 291, "training_iteration": 5, "trial_id": "9f288_00012", "date": "2023-10-25_16-31-53", "timestamp": 1698247913, "time_this_iter_s": 3.2699949741363525, "time_total_s": 15.984041929244995, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 15.984041929244995, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 57.6, "ram_util_percent": 26.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0003, "total_loss": 8.759041362338596, "policy_loss": -0.00034022634779965437, "vf_loss": 8.759438161496762, "vf_explained_var": -3.635883331298828e-06, "kl": 0.000693477009639941, "entropy": 0.6068202809051231, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 149.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.961999999999861, "episode_len_mean": 241.14, "episode_media": {}, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.499999999999837, -50.00000000000044, -50.00000000000044, 37.10000000000003, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 37.70000000000003, 33.70000000000004, 23.8999999999999, 34.70000000000004, 42.500000000000014, 40.30000000000002, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 42.10000000000001, 33.70000000000004, 17.099999999999802, 44.5, 43.50000000000001, 37.300000000000026, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.5, 46.5, 28.09999999999996, 17.499999999999808, 19.69999999999984, 29.49999999999998, 30.9, 45.9, 44.7, 40.70000000000002, 41.70000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 1.099999999999575, 44.7, -50.00000000000044, 37.300000000000026, -50.00000000000044, 18.699999999999825, 33.90000000000004, 45.1, 40.70000000000002, 42.70000000000001, -50.00000000000044, 26.499999999999936, 43.7, 42.10000000000001, -50.00000000000044, 36.30000000000003, 40.10000000000002, -50.00000000000044, 18.899999999999828, 13.699999999999754, 14.09999999999976, -50.00000000000044, 45.9, 38.50000000000003, -50.00000000000044, 40.90000000000002, 46.099999999999994, 24.099999999999902, 43.900000000000006, 12.499999999999737, 40.70000000000002, -50.00000000000044, 40.30000000000002, 41.30000000000001, 44.10000000000001, 30.099999999999987, 36.50000000000003, 38.300000000000026, 41.90000000000001, -50.00000000000044, 44.7, 43.50000000000001, 41.70000000000002, 43.50000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, 44.7, 39.300000000000026, 34.70000000000004, -50.00000000000044, 28.699999999999967, -50.00000000000044, 12.69999999999974, 35.500000000000036, 12.499999999999737, 38.300000000000026, 41.30000000000001, 40.30000000000002], "episode_lengths": [306, 500, 500, 130, 492, 500, 500, 124, 164, 262, 154, 76, 98, 494, 500, 500, 80, 164, 330, 56, 66, 128, 114, 500, 500, 56, 36, 220, 326, 304, 206, 192, 42, 54, 94, 84, 88, 500, 500, 490, 54, 500, 128, 500, 314, 162, 50, 94, 74, 500, 236, 64, 80, 500, 138, 100, 500, 312, 364, 360, 500, 42, 116, 500, 92, 40, 260, 62, 376, 94, 500, 98, 88, 60, 200, 136, 118, 82, 500, 54, 66, 84, 66, 82, 500, 500, 208, 500, 54, 108, 154, 500, 214, 500, 374, 146, 376, 118, 88, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37507068171409214, "mean_inference_ms": 1.20312853640017, "mean_action_processing_ms": 0.14129965245691078, "mean_env_wait_ms": 0.08144856201155706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02148270606994629, "StateBufferConnector_ms": 0.0045223236083984375, "ViewRequirementAgentConnector_ms": 0.12647342681884766}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.961999999999861, "episode_len_mean": 241.14, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.499999999999837, -50.00000000000044, -50.00000000000044, 37.10000000000003, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 37.70000000000003, 33.70000000000004, 23.8999999999999, 34.70000000000004, 42.500000000000014, 40.30000000000002, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 42.10000000000001, 33.70000000000004, 17.099999999999802, 44.5, 43.50000000000001, 37.300000000000026, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.5, 46.5, 28.09999999999996, 17.499999999999808, 19.69999999999984, 29.49999999999998, 30.9, 45.9, 44.7, 40.70000000000002, 41.70000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 1.099999999999575, 44.7, -50.00000000000044, 37.300000000000026, -50.00000000000044, 18.699999999999825, 33.90000000000004, 45.1, 40.70000000000002, 42.70000000000001, -50.00000000000044, 26.499999999999936, 43.7, 42.10000000000001, -50.00000000000044, 36.30000000000003, 40.10000000000002, -50.00000000000044, 18.899999999999828, 13.699999999999754, 14.09999999999976, -50.00000000000044, 45.9, 38.50000000000003, -50.00000000000044, 40.90000000000002, 46.099999999999994, 24.099999999999902, 43.900000000000006, 12.499999999999737, 40.70000000000002, -50.00000000000044, 40.30000000000002, 41.30000000000001, 44.10000000000001, 30.099999999999987, 36.50000000000003, 38.300000000000026, 41.90000000000001, -50.00000000000044, 44.7, 43.50000000000001, 41.70000000000002, 43.50000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, 44.7, 39.300000000000026, 34.70000000000004, -50.00000000000044, 28.699999999999967, -50.00000000000044, 12.69999999999974, 35.500000000000036, 12.499999999999737, 38.300000000000026, 41.30000000000001, 40.30000000000002], "episode_lengths": [306, 500, 500, 130, 492, 500, 500, 124, 164, 262, 154, 76, 98, 494, 500, 500, 80, 164, 330, 56, 66, 128, 114, 500, 500, 56, 36, 220, 326, 304, 206, 192, 42, 54, 94, 84, 88, 500, 500, 490, 54, 500, 128, 500, 314, 162, 50, 94, 74, 500, 236, 64, 80, 500, 138, 100, 500, 312, 364, 360, 500, 42, 116, 500, 92, 40, 260, 62, 376, 94, 500, 98, 88, 60, 200, 136, 118, 82, 500, 54, 66, 84, 66, 82, 500, 500, 208, 500, 54, 108, 154, 500, 214, 500, 374, 146, 376, 118, 88, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37507068171409214, "mean_inference_ms": 1.20312853640017, "mean_action_processing_ms": 0.14129965245691078, "mean_env_wait_ms": 0.08144856201155706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02148270606994629, "StateBufferConnector_ms": 0.0045223236083984375, "ViewRequirementAgentConnector_ms": 0.12647342681884766}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5682.500323649928, "num_env_steps_trained_throughput_per_sec": 5682.500323649928, "timesteps_total": 108000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3186.75, "sample_time_ms": 2834.268, "load_time_ms": 17.717, "load_throughput": 1015952.632, "learn_time_ms": 323.547, "learn_throughput": 55633.359, "synch_weights_time_ms": 9.724}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 376, "training_iteration": 6, "trial_id": "9f288_00012", "date": "2023-10-25_16-31-56", "timestamp": 1698247916, "time_this_iter_s": 3.1736178398132324, "time_total_s": 19.157659769058228, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 19.157659769058228, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 60.25, "ram_util_percent": 26.049999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0003, "total_loss": 8.055122640397814, "policy_loss": -0.0007312680008234802, "vf_loss": 8.055907955876103, "vf_explained_var": -3.6336757518627025e-06, "kl": 0.0009227289431104397, "entropy": 0.5700127206466816, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 176.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.962999999999884, "episode_len_mean": 216.14, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, 44.7, 39.300000000000026, 34.70000000000004, -50.00000000000044, 28.699999999999967, -50.00000000000044, 12.69999999999974, 35.500000000000036, 12.499999999999737, 38.300000000000026, 41.30000000000001, 40.30000000000002, 45.1, 44.900000000000006, -50.00000000000044, 45.3, 8.099999999999675, 45.1, 28.29999999999996, 43.7, -50.00000000000044, -50.00000000000044, 36.50000000000003, 27.699999999999953, 31.300000000000004, 32.30000000000002, 44.5, 44.10000000000001, 25.099999999999916, 46.3, 37.70000000000003, 38.700000000000024, 46.3, 43.7, 44.300000000000004, 42.70000000000001, 19.09999999999983, 43.10000000000001, 46.099999999999994, 33.30000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 38.10000000000002, -50.00000000000044, 32.700000000000024, 28.89999999999997, 30.9, 35.10000000000004, 45.5, 17.899999999999814, 27.299999999999947, 45.7, 38.300000000000026, 36.900000000000034, 43.900000000000006, 37.10000000000003, 40.10000000000002, -50.00000000000044, 45.3, 42.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 25.29999999999992, 44.5, 44.7, 40.70000000000002, -50.00000000000044, 17.099999999999802, 36.70000000000003, 41.70000000000002, 45.7, 12.69999999999974, -50.00000000000044, -50.00000000000044, 41.500000000000014, 38.700000000000024, 43.50000000000001, 25.099999999999916, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.300000000000026, 47.3, 32.50000000000002, 42.900000000000006, -50.00000000000044, 32.700000000000024, 43.900000000000006, -50.00000000000044, 46.699999999999996], "episode_lengths": [500, 500, 208, 500, 54, 108, 154, 500, 214, 500, 374, 146, 376, 118, 88, 98, 50, 52, 500, 48, 420, 50, 218, 64, 500, 500, 136, 224, 188, 178, 56, 60, 250, 38, 124, 114, 38, 64, 58, 74, 310, 70, 40, 168, 500, 74, 500, 500, 54, 500, 120, 500, 174, 212, 192, 150, 46, 322, 228, 44, 118, 132, 62, 130, 100, 500, 48, 78, 58, 500, 500, 58, 248, 56, 54, 94, 500, 330, 134, 84, 44, 374, 500, 500, 86, 114, 66, 250, 76, 500, 500, 128, 28, 176, 72, 500, 174, 62, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3757651563184771, "mean_inference_ms": 1.20563522198335, "mean_action_processing_ms": 0.14193102697859772, "mean_env_wait_ms": 0.08128392646164255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0356144905090332, "StateBufferConnector_ms": 0.0020101070404052734, "ViewRequirementAgentConnector_ms": 0.10440850257873535}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.962999999999884, "episode_len_mean": 216.14, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, 44.7, 39.300000000000026, 34.70000000000004, -50.00000000000044, 28.699999999999967, -50.00000000000044, 12.69999999999974, 35.500000000000036, 12.499999999999737, 38.300000000000026, 41.30000000000001, 40.30000000000002, 45.1, 44.900000000000006, -50.00000000000044, 45.3, 8.099999999999675, 45.1, 28.29999999999996, 43.7, -50.00000000000044, -50.00000000000044, 36.50000000000003, 27.699999999999953, 31.300000000000004, 32.30000000000002, 44.5, 44.10000000000001, 25.099999999999916, 46.3, 37.70000000000003, 38.700000000000024, 46.3, 43.7, 44.300000000000004, 42.70000000000001, 19.09999999999983, 43.10000000000001, 46.099999999999994, 33.30000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 38.10000000000002, -50.00000000000044, 32.700000000000024, 28.89999999999997, 30.9, 35.10000000000004, 45.5, 17.899999999999814, 27.299999999999947, 45.7, 38.300000000000026, 36.900000000000034, 43.900000000000006, 37.10000000000003, 40.10000000000002, -50.00000000000044, 45.3, 42.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 25.29999999999992, 44.5, 44.7, 40.70000000000002, -50.00000000000044, 17.099999999999802, 36.70000000000003, 41.70000000000002, 45.7, 12.69999999999974, -50.00000000000044, -50.00000000000044, 41.500000000000014, 38.700000000000024, 43.50000000000001, 25.099999999999916, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.300000000000026, 47.3, 32.50000000000002, 42.900000000000006, -50.00000000000044, 32.700000000000024, 43.900000000000006, -50.00000000000044, 46.699999999999996], "episode_lengths": [500, 500, 208, 500, 54, 108, 154, 500, 214, 500, 374, 146, 376, 118, 88, 98, 50, 52, 500, 48, 420, 50, 218, 64, 500, 500, 136, 224, 188, 178, 56, 60, 250, 38, 124, 114, 38, 64, 58, 74, 310, 70, 40, 168, 500, 74, 500, 500, 54, 500, 120, 500, 174, 212, 192, 150, 46, 322, 228, 44, 118, 132, 62, 130, 100, 500, 48, 78, 58, 500, 500, 58, 248, 56, 54, 94, 500, 330, 134, 84, 44, 374, 500, 500, 86, 114, 66, 250, 76, 500, 500, 128, 28, 176, 72, 500, 174, 62, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3757651563184771, "mean_inference_ms": 1.20563522198335, "mean_action_processing_ms": 0.14193102697859772, "mean_env_wait_ms": 0.08128392646164255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0356144905090332, "StateBufferConnector_ms": 0.0020101070404052734, "ViewRequirementAgentConnector_ms": 0.10440850257873535}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5512.779562047207, "num_env_steps_trained_throughput_per_sec": 5512.779562047207, "timesteps_total": 126000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 3197.949, "sample_time_ms": 2834.535, "load_time_ms": 18.452, "load_throughput": 975480.75, "learn_time_ms": 333.632, "learn_throughput": 53951.683, "synch_weights_time_ms": 9.62}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 460, "training_iteration": 7, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-00", "timestamp": 1698247920, "time_this_iter_s": 3.270142078399658, "time_total_s": 22.427801847457886, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 22.427801847457886, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 58.739999999999995, "ram_util_percent": 26.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0003, "total_loss": 6.451670116848415, "policy_loss": -0.0002845725803463547, "vf_loss": 6.452009130407263, "vf_explained_var": -2.2958826135706017e-07, "kl": 0.0004548196832543125, "entropy": 0.5503951929233692, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.097999999999837, "episode_len_mean": 249.68, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.900000000000034, 43.900000000000006, 37.10000000000003, 40.10000000000002, -50.00000000000044, 45.3, 42.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 25.29999999999992, 44.5, 44.7, 40.70000000000002, -50.00000000000044, 17.099999999999802, 36.70000000000003, 41.70000000000002, 45.7, 12.69999999999974, -50.00000000000044, -50.00000000000044, 41.500000000000014, 38.700000000000024, 43.50000000000001, 25.099999999999916, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.300000000000026, 47.3, 32.50000000000002, 42.900000000000006, -50.00000000000044, 32.700000000000024, 43.900000000000006, -50.00000000000044, 46.699999999999996, 13.299999999999748, -50.00000000000044, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 34.900000000000034, 35.70000000000003, 40.10000000000002, 45.3, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.900000000000006, -50.00000000000044, 23.699999999999896, -50.00000000000044, 46.3, -50.00000000000044, 43.7, -50.00000000000044, 4.699999999999626, 37.10000000000003, -50.00000000000044, 47.3, 43.50000000000001, 42.70000000000001, 39.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 36.50000000000003, 39.90000000000002, -50.00000000000044, 12.099999999999731, 44.900000000000006, 46.699999999999996, 45.7, 31.900000000000013, 33.70000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 38.300000000000026, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 21.299999999999862, -50.00000000000044, 45.7, 20.299999999999848, -50.00000000000044, 42.70000000000001], "episode_lengths": [132, 62, 130, 100, 500, 48, 78, 58, 500, 500, 58, 248, 56, 54, 94, 500, 330, 134, 84, 44, 374, 500, 500, 86, 114, 66, 250, 76, 500, 500, 128, 28, 176, 72, 500, 174, 62, 500, 34, 368, 500, 48, 500, 54, 500, 152, 144, 100, 48, 500, 114, 500, 32, 500, 500, 86, 72, 500, 264, 500, 38, 500, 64, 500, 454, 130, 500, 28, 66, 74, 104, 500, 38, 500, 500, 136, 102, 500, 380, 52, 34, 44, 182, 164, 500, 500, 90, 500, 500, 118, 78, 500, 500, 56, 288, 500, 44, 298, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37563940835177206, "mean_inference_ms": 1.21007717309812, "mean_action_processing_ms": 0.14110310207625804, "mean_env_wait_ms": 0.08124385188476912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03809952735900879, "StateBufferConnector_ms": 0.00399017333984375, "ViewRequirementAgentConnector_ms": 0.11737823486328125}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.097999999999837, "episode_len_mean": 249.68, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.900000000000034, 43.900000000000006, 37.10000000000003, 40.10000000000002, -50.00000000000044, 45.3, 42.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 25.29999999999992, 44.5, 44.7, 40.70000000000002, -50.00000000000044, 17.099999999999802, 36.70000000000003, 41.70000000000002, 45.7, 12.69999999999974, -50.00000000000044, -50.00000000000044, 41.500000000000014, 38.700000000000024, 43.50000000000001, 25.099999999999916, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.300000000000026, 47.3, 32.50000000000002, 42.900000000000006, -50.00000000000044, 32.700000000000024, 43.900000000000006, -50.00000000000044, 46.699999999999996, 13.299999999999748, -50.00000000000044, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 34.900000000000034, 35.70000000000003, 40.10000000000002, 45.3, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.900000000000006, -50.00000000000044, 23.699999999999896, -50.00000000000044, 46.3, -50.00000000000044, 43.7, -50.00000000000044, 4.699999999999626, 37.10000000000003, -50.00000000000044, 47.3, 43.50000000000001, 42.70000000000001, 39.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 36.50000000000003, 39.90000000000002, -50.00000000000044, 12.099999999999731, 44.900000000000006, 46.699999999999996, 45.7, 31.900000000000013, 33.70000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 38.300000000000026, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 21.299999999999862, -50.00000000000044, 45.7, 20.299999999999848, -50.00000000000044, 42.70000000000001], "episode_lengths": [132, 62, 130, 100, 500, 48, 78, 58, 500, 500, 58, 248, 56, 54, 94, 500, 330, 134, 84, 44, 374, 500, 500, 86, 114, 66, 250, 76, 500, 500, 128, 28, 176, 72, 500, 174, 62, 500, 34, 368, 500, 48, 500, 54, 500, 152, 144, 100, 48, 500, 114, 500, 32, 500, 500, 86, 72, 500, 264, 500, 38, 500, 64, 500, 454, 130, 500, 28, 66, 74, 104, 500, 38, 500, 500, 136, 102, 500, 380, 52, 34, 44, 182, 164, 500, 500, 90, 500, 500, 118, 78, 500, 500, 56, 288, 500, 44, 298, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37563940835177206, "mean_inference_ms": 1.21007717309812, "mean_action_processing_ms": 0.14110310207625804, "mean_env_wait_ms": 0.08124385188476912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03809952735900879, "StateBufferConnector_ms": 0.00399017333984375, "ViewRequirementAgentConnector_ms": 0.11737823486328125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5508.602353660173, "num_env_steps_trained_throughput_per_sec": 5508.602353660173, "timesteps_total": 144000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3206.657, "sample_time_ms": 2840.14, "load_time_ms": 18.905, "load_throughput": 952144.882, "learn_time_ms": 336.365, "learn_throughput": 53513.247, "synch_weights_time_ms": 9.626}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 521, "training_iteration": 8, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-03", "timestamp": 1698247923, "time_this_iter_s": 3.272615432739258, "time_total_s": 25.700417280197144, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 25.700417280197144, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 55.46, "ram_util_percent": 26.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0003, "total_loss": 6.84734332119977, "policy_loss": 1.8005776736471387e-05, "vf_loss": 6.847379755090784, "vf_explained_var": -1.896310735631872e-06, "kl": 3.579373287299893e-05, "entropy": 0.5449493715056667, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 230.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.27199999999982, "episode_len_mean": 267.9, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 36.50000000000003, 39.90000000000002, -50.00000000000044, 12.099999999999731, 44.900000000000006, 46.699999999999996, 45.7, 31.900000000000013, 33.70000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 38.300000000000026, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 21.299999999999862, -50.00000000000044, 45.7, 20.299999999999848, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.30000000000001, 45.5, 44.10000000000001, 41.90000000000001, -50.00000000000044, 43.7, 46.3, 41.500000000000014, 24.899999999999913, -50.00000000000044, 4.499999999999623, 46.699999999999996, 42.70000000000001, 43.30000000000001, 42.500000000000014, 39.10000000000002, 45.5, 11.499999999999723, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 23.699999999999896, 43.10000000000001, 39.10000000000002, -50.00000000000044, 42.900000000000006, 38.300000000000026, 47.3, 31.70000000000001, 18.699999999999825, 42.500000000000014, -50.00000000000044, 21.299999999999862, 41.30000000000001, -50.00000000000044, 44.300000000000004, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 34.900000000000034, -50.00000000000044, -50.00000000000044, 27.49999999999995, 23.499999999999893, 42.30000000000001, 45.1, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 41.30000000000001, 38.300000000000026], "episode_lengths": [104, 500, 38, 500, 500, 136, 102, 500, 380, 52, 34, 44, 182, 164, 500, 500, 90, 500, 500, 118, 78, 500, 500, 56, 288, 500, 44, 298, 500, 74, 500, 78, 46, 60, 82, 500, 64, 38, 86, 252, 500, 456, 34, 74, 68, 76, 110, 46, 386, 500, 500, 500, 56, 264, 70, 110, 500, 72, 118, 28, 184, 314, 76, 500, 288, 88, 500, 58, 106, 500, 500, 500, 176, 152, 500, 500, 226, 266, 78, 50, 500, 158, 500, 500, 500, 500, 500, 500, 90, 54, 500, 138, 500, 40, 500, 500, 86, 500, 88, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376847278226045, "mean_inference_ms": 1.2161264548363775, "mean_action_processing_ms": 0.14119260978588552, "mean_env_wait_ms": 0.08190339864011566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025005340576171875, "StateBufferConnector_ms": 0.006987094879150391, "ViewRequirementAgentConnector_ms": 0.1430051326751709}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.27199999999982, "episode_len_mean": 267.9, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 36.50000000000003, 39.90000000000002, -50.00000000000044, 12.099999999999731, 44.900000000000006, 46.699999999999996, 45.7, 31.900000000000013, 33.70000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 38.300000000000026, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 21.299999999999862, -50.00000000000044, 45.7, 20.299999999999848, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.30000000000001, 45.5, 44.10000000000001, 41.90000000000001, -50.00000000000044, 43.7, 46.3, 41.500000000000014, 24.899999999999913, -50.00000000000044, 4.499999999999623, 46.699999999999996, 42.70000000000001, 43.30000000000001, 42.500000000000014, 39.10000000000002, 45.5, 11.499999999999723, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 23.699999999999896, 43.10000000000001, 39.10000000000002, -50.00000000000044, 42.900000000000006, 38.300000000000026, 47.3, 31.70000000000001, 18.699999999999825, 42.500000000000014, -50.00000000000044, 21.299999999999862, 41.30000000000001, -50.00000000000044, 44.300000000000004, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 34.900000000000034, -50.00000000000044, -50.00000000000044, 27.49999999999995, 23.499999999999893, 42.30000000000001, 45.1, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 41.30000000000001, 38.300000000000026], "episode_lengths": [104, 500, 38, 500, 500, 136, 102, 500, 380, 52, 34, 44, 182, 164, 500, 500, 90, 500, 500, 118, 78, 500, 500, 56, 288, 500, 44, 298, 500, 74, 500, 78, 46, 60, 82, 500, 64, 38, 86, 252, 500, 456, 34, 74, 68, 76, 110, 46, 386, 500, 500, 500, 56, 264, 70, 110, 500, 72, 118, 28, 184, 314, 76, 500, 288, 88, 500, 58, 106, 500, 500, 500, 176, 152, 500, 500, 226, 266, 78, 50, 500, 158, 500, 500, 500, 500, 500, 500, 90, 54, 500, 138, 500, 40, 500, 500, 86, 500, 88, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376847278226045, "mean_inference_ms": 1.2161264548363775, "mean_action_processing_ms": 0.14119260978588552, "mean_env_wait_ms": 0.08190339864011566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025005340576171875, "StateBufferConnector_ms": 0.006987094879150391, "ViewRequirementAgentConnector_ms": 0.1430051326751709}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5603.522722414604, "num_env_steps_trained_throughput_per_sec": 5603.522722414604, "timesteps_total": 162000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 3207.28, "sample_time_ms": 2860.104, "load_time_ms": 17.861, "load_throughput": 1007754.18, "learn_time_ms": 318.038, "learn_throughput": 56596.947, "synch_weights_time_ms": 9.613}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "done": false, "episodes_total": 591, "training_iteration": 9, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-06", "timestamp": 1698247926, "time_this_iter_s": 3.2192611694335938, "time_total_s": 28.919678449630737, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 28.919678449630737, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 70.15, "ram_util_percent": 26.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0003, "total_loss": 6.949351911191587, "policy_loss": -0.0005078083939022488, "vf_loss": 6.9499141551830155, "vf_explained_var": -2.8234940988046154e-06, "kl": 0.0008225217981561173, "entropy": 0.5477309282179232, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 257.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.2739999999998126, "episode_len_mean": 277.86, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.50000000000002, 34.900000000000034, -50.00000000000044, -50.00000000000044, 27.49999999999995, 23.499999999999893, 42.30000000000001, 45.1, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 41.30000000000001, 38.300000000000026, 44.7, 47.7, -50.00000000000044, 26.09999999999993, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 32.100000000000016, -50.00000000000044, 17.899999999999814, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, 24.499999999999908, 45.7, 25.899999999999928, -50.00000000000044, 38.10000000000002, 23.8999999999999, 44.5, 43.50000000000001, 39.70000000000002, 34.50000000000004, 0.09999999999956088, -50.00000000000044, 44.5, 44.7, 22.49999999999988, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 27.49999999999995, 45.9, 44.10000000000001, 40.10000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 36.70000000000003, 29.099999999999973, 40.70000000000002, 37.90000000000003, 26.89999999999994, 33.10000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, 17.899999999999814, 46.099999999999994, 44.300000000000004, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.900000000000006, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044], "episode_lengths": [500, 176, 152, 500, 500, 226, 266, 78, 50, 500, 158, 500, 500, 500, 500, 500, 500, 90, 54, 500, 138, 500, 40, 500, 500, 86, 500, 88, 118, 54, 24, 500, 240, 164, 500, 500, 500, 500, 90, 180, 500, 322, 500, 500, 70, 50, 60, 500, 500, 500, 228, 500, 256, 44, 242, 500, 120, 262, 56, 66, 104, 156, 500, 500, 56, 54, 276, 500, 78, 500, 500, 44, 226, 42, 60, 100, 110, 500, 500, 134, 210, 94, 122, 232, 170, 500, 500, 94, 322, 40, 58, 52, 500, 52, 500, 62, 52, 500, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37956370837355996, "mean_inference_ms": 1.221993083294572, "mean_action_processing_ms": 0.14177262601508567, "mean_env_wait_ms": 0.08278643622296125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599358558654785, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.12303280830383301}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.2739999999998126, "episode_len_mean": 277.86, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.50000000000002, 34.900000000000034, -50.00000000000044, -50.00000000000044, 27.49999999999995, 23.499999999999893, 42.30000000000001, 45.1, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 41.30000000000001, 38.300000000000026, 44.7, 47.7, -50.00000000000044, 26.09999999999993, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 32.100000000000016, -50.00000000000044, 17.899999999999814, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, 24.499999999999908, 45.7, 25.899999999999928, -50.00000000000044, 38.10000000000002, 23.8999999999999, 44.5, 43.50000000000001, 39.70000000000002, 34.50000000000004, 0.09999999999956088, -50.00000000000044, 44.5, 44.7, 22.49999999999988, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 27.49999999999995, 45.9, 44.10000000000001, 40.10000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 36.70000000000003, 29.099999999999973, 40.70000000000002, 37.90000000000003, 26.89999999999994, 33.10000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, 17.899999999999814, 46.099999999999994, 44.300000000000004, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.900000000000006, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044], "episode_lengths": [500, 176, 152, 500, 500, 226, 266, 78, 50, 500, 158, 500, 500, 500, 500, 500, 500, 90, 54, 500, 138, 500, 40, 500, 500, 86, 500, 88, 118, 54, 24, 500, 240, 164, 500, 500, 500, 500, 90, 180, 500, 322, 500, 500, 70, 50, 60, 500, 500, 500, 228, 500, 256, 44, 242, 500, 120, 262, 56, 66, 104, 156, 500, 500, 56, 54, 276, 500, 78, 500, 500, 44, 226, 42, 60, 100, 110, 500, 500, 134, 210, 94, 122, 232, 170, 500, 500, 94, 322, 40, 58, 52, 500, 52, 500, 62, 52, 500, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37956370837355996, "mean_inference_ms": 1.221993083294572, "mean_action_processing_ms": 0.14177262601508567, "mean_env_wait_ms": 0.08278643622296125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599358558654785, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.12303280830383301}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4811.283787814134, "num_env_steps_trained_throughput_per_sec": 4811.283787814134, "timesteps_total": 180000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3260.673, "sample_time_ms": 2912.115, "load_time_ms": 18.112, "load_throughput": 993795.769, "learn_time_ms": 318.838, "learn_throughput": 56454.96, "synch_weights_time_ms": 10.009}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 662, "training_iteration": 10, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-10", "timestamp": 1698247930, "time_this_iter_s": 3.7482011318206787, "time_total_s": 32.667879581451416, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 32.667879581451416, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 54.63333333333333, "ram_util_percent": 26.16666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0003, "total_loss": 6.765175024668376, "policy_loss": -5.921400669548246e-07, "vf_loss": 6.765228059556749, "vf_explained_var": -2.991270135950159e-06, "kl": 9.101921797015098e-05, "entropy": 0.5249960256947411, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 284.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.826999999999845, "episode_len_mean": 237.4, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 36.70000000000003, 29.099999999999973, 40.70000000000002, 37.90000000000003, 26.89999999999994, 33.10000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, 17.899999999999814, 46.099999999999994, 44.300000000000004, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.900000000000006, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 6.699999999999655, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 43.50000000000001, 45.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 27.099999999999945, 46.5, 45.1, 43.10000000000001, 34.50000000000004, -50.00000000000044, 43.7, 43.30000000000001, -50.00000000000044, 13.899999999999757, 46.5, 43.7, 42.900000000000006, 40.10000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 35.70000000000003, 36.900000000000034, 39.10000000000002, -50.00000000000044, 44.900000000000006, 41.100000000000016, 23.29999999999989, 40.500000000000014, -50.00000000000044, 43.900000000000006, 40.10000000000002, -50.00000000000044, 46.699999999999996, 45.3, 46.3, -50.00000000000044, 44.900000000000006, 23.699999999999896, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 46.3, 45.9, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.7, 35.30000000000004, 32.50000000000002, 16.09999999999979, 33.90000000000004, 46.5, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 42.30000000000001, 46.3], "episode_lengths": [500, 500, 134, 210, 94, 122, 232, 170, 500, 500, 94, 322, 40, 58, 52, 500, 52, 500, 62, 52, 500, 38, 500, 500, 500, 72, 434, 500, 52, 56, 500, 66, 42, 122, 500, 500, 36, 500, 230, 36, 50, 70, 156, 500, 64, 68, 500, 362, 36, 64, 72, 100, 80, 500, 500, 500, 78, 144, 132, 110, 500, 52, 90, 268, 96, 500, 62, 100, 500, 34, 48, 38, 500, 52, 264, 500, 500, 52, 76, 500, 500, 500, 234, 38, 42, 118, 500, 500, 54, 148, 176, 340, 162, 36, 500, 32, 500, 48, 78, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3806076559874957, "mean_inference_ms": 1.218346814898087, "mean_action_processing_ms": 0.14141118279296708, "mean_env_wait_ms": 0.08310843459223659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024010181427001953, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.13234424591064453}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.826999999999845, "episode_len_mean": 237.4, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 36.70000000000003, 29.099999999999973, 40.70000000000002, 37.90000000000003, 26.89999999999994, 33.10000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, 17.899999999999814, 46.099999999999994, 44.300000000000004, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.900000000000006, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 6.699999999999655, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 43.50000000000001, 45.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 27.099999999999945, 46.5, 45.1, 43.10000000000001, 34.50000000000004, -50.00000000000044, 43.7, 43.30000000000001, -50.00000000000044, 13.899999999999757, 46.5, 43.7, 42.900000000000006, 40.10000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 35.70000000000003, 36.900000000000034, 39.10000000000002, -50.00000000000044, 44.900000000000006, 41.100000000000016, 23.29999999999989, 40.500000000000014, -50.00000000000044, 43.900000000000006, 40.10000000000002, -50.00000000000044, 46.699999999999996, 45.3, 46.3, -50.00000000000044, 44.900000000000006, 23.699999999999896, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 46.3, 45.9, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.7, 35.30000000000004, 32.50000000000002, 16.09999999999979, 33.90000000000004, 46.5, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 42.30000000000001, 46.3], "episode_lengths": [500, 500, 134, 210, 94, 122, 232, 170, 500, 500, 94, 322, 40, 58, 52, 500, 52, 500, 62, 52, 500, 38, 500, 500, 500, 72, 434, 500, 52, 56, 500, 66, 42, 122, 500, 500, 36, 500, 230, 36, 50, 70, 156, 500, 64, 68, 500, 362, 36, 64, 72, 100, 80, 500, 500, 500, 78, 144, 132, 110, 500, 52, 90, 268, 96, 500, 62, 100, 500, 34, 48, 38, 500, 52, 264, 500, 500, 52, 76, 500, 500, 500, 234, 38, 42, 118, 500, 500, 54, 148, 176, 340, 162, 36, 500, 32, 500, 48, 78, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3806076559874957, "mean_inference_ms": 1.218346814898087, "mean_action_processing_ms": 0.14141118279296708, "mean_env_wait_ms": 0.08310843459223659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024010181427001953, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.13234424591064453}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5700.551982922236, "num_env_steps_trained_throughput_per_sec": 5700.551982922236, "timesteps_total": 198000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 198000, "timers": {"training_iteration_time_ms": 3271.634, "sample_time_ms": 2906.918, "load_time_ms": 18.115, "load_throughput": 993637.506, "learn_time_ms": 334.837, "learn_throughput": 53757.476, "synch_weights_time_ms": 10.165}, "counters": {"num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "done": false, "episodes_total": 739, "training_iteration": 11, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-13", "timestamp": 1698247933, "time_this_iter_s": 3.163714647293091, "time_total_s": 35.83159422874451, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 35.83159422874451, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 63.775, "ram_util_percent": 26.150000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0003, "total_loss": 6.334454924971969, "policy_loss": -0.000524366757384053, "vf_loss": 6.335031597702591, "vf_explained_var": -1.7528180722837095e-06, "kl": 0.0006533487309265293, "entropy": 0.5224518974622091, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.180999999999864, "episode_len_mean": 213.88, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 26.69999999999994, 46.3, 45.9, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.7, 35.30000000000004, 32.50000000000002, 16.09999999999979, 33.90000000000004, 46.5, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 42.30000000000001, 46.3, -50.00000000000044, 44.300000000000004, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 36.900000000000034, 33.70000000000004, 9.499999999999694, 39.90000000000002, 46.699999999999996, 46.9, 45.9, 45.5, 45.7, -50.00000000000044, -50.00000000000044, 45.3, 37.10000000000003, 46.099999999999994, 47.1, 42.70000000000001, 41.70000000000002, -50.00000000000044, 42.500000000000014, 39.300000000000026, -50.00000000000044, 46.3, -50.00000000000044, 37.70000000000003, 42.70000000000001, 46.3, 36.70000000000003, 46.099999999999994, -50.00000000000044, 47.1, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 44.900000000000006, 45.5, 45.5, 40.70000000000002, -50.00000000000044, 39.70000000000002, 39.10000000000002, 45.3, -50.00000000000044, 44.10000000000001, 46.699999999999996, 37.300000000000026, -50.00000000000044, 43.30000000000001, 40.30000000000002, 46.5, 45.5, 41.90000000000001, 44.5, 46.5, 38.50000000000003, 45.3, -50.00000000000044, 42.30000000000001, -50.00000000000044, 21.09999999999986, 42.70000000000001, 37.10000000000003], "episode_lengths": [500, 234, 38, 42, 118, 500, 500, 54, 148, 176, 340, 162, 36, 500, 32, 500, 48, 78, 38, 500, 58, 62, 500, 500, 48, 500, 500, 500, 500, 500, 500, 500, 44, 500, 132, 164, 406, 102, 34, 32, 42, 46, 44, 500, 500, 48, 130, 40, 30, 74, 84, 500, 76, 108, 500, 38, 500, 124, 74, 38, 134, 40, 500, 30, 500, 46, 40, 500, 48, 500, 500, 48, 52, 46, 46, 94, 500, 104, 110, 48, 500, 60, 34, 128, 500, 68, 98, 36, 46, 82, 56, 36, 116, 48, 500, 78, 500, 290, 74, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38004971367803364, "mean_inference_ms": 1.2171183892967208, "mean_action_processing_ms": 0.14139514970178768, "mean_env_wait_ms": 0.08328016806565336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029562950134277344, "StateBufferConnector_ms": 0.0050029754638671875, "ViewRequirementAgentConnector_ms": 0.11468243598937988}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.180999999999864, "episode_len_mean": 213.88, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 26.69999999999994, 46.3, 45.9, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.7, 35.30000000000004, 32.50000000000002, 16.09999999999979, 33.90000000000004, 46.5, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 42.30000000000001, 46.3, -50.00000000000044, 44.300000000000004, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 36.900000000000034, 33.70000000000004, 9.499999999999694, 39.90000000000002, 46.699999999999996, 46.9, 45.9, 45.5, 45.7, -50.00000000000044, -50.00000000000044, 45.3, 37.10000000000003, 46.099999999999994, 47.1, 42.70000000000001, 41.70000000000002, -50.00000000000044, 42.500000000000014, 39.300000000000026, -50.00000000000044, 46.3, -50.00000000000044, 37.70000000000003, 42.70000000000001, 46.3, 36.70000000000003, 46.099999999999994, -50.00000000000044, 47.1, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 44.900000000000006, 45.5, 45.5, 40.70000000000002, -50.00000000000044, 39.70000000000002, 39.10000000000002, 45.3, -50.00000000000044, 44.10000000000001, 46.699999999999996, 37.300000000000026, -50.00000000000044, 43.30000000000001, 40.30000000000002, 46.5, 45.5, 41.90000000000001, 44.5, 46.5, 38.50000000000003, 45.3, -50.00000000000044, 42.30000000000001, -50.00000000000044, 21.09999999999986, 42.70000000000001, 37.10000000000003], "episode_lengths": [500, 234, 38, 42, 118, 500, 500, 54, 148, 176, 340, 162, 36, 500, 32, 500, 48, 78, 38, 500, 58, 62, 500, 500, 48, 500, 500, 500, 500, 500, 500, 500, 44, 500, 132, 164, 406, 102, 34, 32, 42, 46, 44, 500, 500, 48, 130, 40, 30, 74, 84, 500, 76, 108, 500, 38, 500, 124, 74, 38, 134, 40, 500, 30, 500, 46, 40, 500, 48, 500, 500, 48, 52, 46, 46, 94, 500, 104, 110, 48, 500, 60, 34, 128, 500, 68, 98, 36, 46, 82, 56, 36, 116, 48, 500, 78, 500, 290, 74, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38004971367803364, "mean_inference_ms": 1.2171183892967208, "mean_action_processing_ms": 0.14139514970178768, "mean_env_wait_ms": 0.08328016806565336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029562950134277344, "StateBufferConnector_ms": 0.0050029754638671875, "ViewRequirementAgentConnector_ms": 0.11468243598937988}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5537.965491671538, "num_env_steps_trained_throughput_per_sec": 5537.965491671538, "timesteps_total": 216000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3280.467, "sample_time_ms": 2904.733, "load_time_ms": 18.597, "load_throughput": 967885.286, "learn_time_ms": 345.439, "learn_throughput": 52107.578, "synch_weights_time_ms": 10.045}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 820, "training_iteration": 12, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-16", "timestamp": 1698247936, "time_this_iter_s": 3.2562825679779053, "time_total_s": 39.08787679672241, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 39.08787679672241, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 56.839999999999996, "ram_util_percent": 26.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0003, "total_loss": 6.526332819903338, "policy_loss": -1.668122907479604e-05, "vf_loss": 6.526397634435583, "vf_explained_var": 8.12389232494213e-07, "kl": 0.00010934813796784174, "entropy": 0.48209713564978707, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.797999999999838, "episode_len_mean": 232.68, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, 44.900000000000006, 45.5, 45.5, 40.70000000000002, -50.00000000000044, 39.70000000000002, 39.10000000000002, 45.3, -50.00000000000044, 44.10000000000001, 46.699999999999996, 37.300000000000026, -50.00000000000044, 43.30000000000001, 40.30000000000002, 46.5, 45.5, 41.90000000000001, 44.5, 46.5, 38.50000000000003, 45.3, -50.00000000000044, 42.30000000000001, -50.00000000000044, 21.09999999999986, 42.70000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 26.499999999999936, 47.5, -50.00000000000044, 45.7, 44.900000000000006, 46.3, -50.00000000000044, 40.500000000000014, -50.00000000000044, 4.299999999999621, 41.100000000000016, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 45.5, 45.1, 26.09999999999993, -50.00000000000044, 14.899999999999771, 39.90000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.3, 20.099999999999845, -50.00000000000044, -50.00000000000044, 45.3, 46.699999999999996, 46.9, 5.299999999999635, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.50000000000001, 40.70000000000002, -50.00000000000044, 43.50000000000001, 44.900000000000006, 44.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, 19.299999999999834, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 48, 52, 46, 46, 94, 500, 104, 110, 48, 500, 60, 34, 128, 500, 68, 98, 36, 46, 82, 56, 36, 116, 48, 500, 78, 500, 290, 74, 130, 500, 500, 56, 500, 500, 44, 236, 26, 500, 44, 52, 38, 500, 96, 500, 458, 90, 500, 38, 500, 48, 46, 50, 240, 500, 352, 102, 500, 62, 500, 40, 500, 500, 60, 500, 500, 28, 500, 48, 300, 500, 500, 48, 34, 32, 448, 78, 50, 500, 500, 108, 66, 94, 500, 66, 52, 60, 500, 96, 500, 52, 80, 500, 500, 36, 308, 38, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3797556778551845, "mean_inference_ms": 1.2141248609494297, "mean_action_processing_ms": 0.14144223651384627, "mean_env_wait_ms": 0.08343812054917421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018825769424438477, "StateBufferConnector_ms": 0.007819652557373047, "ViewRequirementAgentConnector_ms": 0.1261458396911621}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.797999999999838, "episode_len_mean": 232.68, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, 44.900000000000006, 45.5, 45.5, 40.70000000000002, -50.00000000000044, 39.70000000000002, 39.10000000000002, 45.3, -50.00000000000044, 44.10000000000001, 46.699999999999996, 37.300000000000026, -50.00000000000044, 43.30000000000001, 40.30000000000002, 46.5, 45.5, 41.90000000000001, 44.5, 46.5, 38.50000000000003, 45.3, -50.00000000000044, 42.30000000000001, -50.00000000000044, 21.09999999999986, 42.70000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 26.499999999999936, 47.5, -50.00000000000044, 45.7, 44.900000000000006, 46.3, -50.00000000000044, 40.500000000000014, -50.00000000000044, 4.299999999999621, 41.100000000000016, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 45.5, 45.1, 26.09999999999993, -50.00000000000044, 14.899999999999771, 39.90000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.3, 20.099999999999845, -50.00000000000044, -50.00000000000044, 45.3, 46.699999999999996, 46.9, 5.299999999999635, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.50000000000001, 40.70000000000002, -50.00000000000044, 43.50000000000001, 44.900000000000006, 44.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, 19.299999999999834, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 48, 52, 46, 46, 94, 500, 104, 110, 48, 500, 60, 34, 128, 500, 68, 98, 36, 46, 82, 56, 36, 116, 48, 500, 78, 500, 290, 74, 130, 500, 500, 56, 500, 500, 44, 236, 26, 500, 44, 52, 38, 500, 96, 500, 458, 90, 500, 38, 500, 48, 46, 50, 240, 500, 352, 102, 500, 62, 500, 40, 500, 500, 60, 500, 500, 28, 500, 48, 300, 500, 500, 48, 34, 32, 448, 78, 50, 500, 500, 108, 66, 94, 500, 66, 52, 60, 500, 96, 500, 52, 80, 500, 500, 36, 308, 38, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3797556778551845, "mean_inference_ms": 1.2141248609494297, "mean_action_processing_ms": 0.14144223651384627, "mean_env_wait_ms": 0.08343812054917421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018825769424438477, "StateBufferConnector_ms": 0.007819652557373047, "ViewRequirementAgentConnector_ms": 0.1261458396911621}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5929.965314432212, "num_env_steps_trained_throughput_per_sec": 5929.965314432212, "timesteps_total": 234000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 234000, "timers": {"training_iteration_time_ms": 3256.981, "sample_time_ms": 2903.112, "load_time_ms": 17.23, "load_throughput": 1044714.908, "learn_time_ms": 324.843, "learn_throughput": 55411.387, "synch_weights_time_ms": 9.945}, "counters": {"num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "done": false, "episodes_total": 890, "training_iteration": 13, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-19", "timestamp": 1698247939, "time_this_iter_s": 3.040424108505249, "time_total_s": 42.12830090522766, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 42.12830090522766, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 66.125, "ram_util_percent": 26.125000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0003, "total_loss": 6.6551436494897915, "policy_loss": -0.00016026436868641112, "vf_loss": 6.6553541112829135, "vf_explained_var": -1.6534769976580584e-06, "kl": 0.0002773877492298606, "entropy": 0.502225809627109, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 365.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.09699999999978637, "episode_len_mean": 284.6, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.3, 20.099999999999845, -50.00000000000044, -50.00000000000044, 45.3, 46.699999999999996, 46.9, 5.299999999999635, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.50000000000001, 40.70000000000002, -50.00000000000044, 43.50000000000001, 44.900000000000006, 44.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, 19.299999999999834, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.5, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.7, 44.10000000000001, 46.3, -50.00000000000044, 43.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 30.099999999999987, 35.70000000000003, 46.3, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 43.30000000000001, 12.69999999999974, -50.00000000000044, 42.500000000000014, 46.9, 18.699999999999825, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 44.300000000000004, 5.899999999999643, 26.09999999999993, 45.5, -50.00000000000044, 4.099999999999618, 18.099999999999817, -50.00000000000044, 42.70000000000001, 43.900000000000006, -50.00000000000044, 43.30000000000001], "episode_lengths": [500, 500, 60, 500, 500, 28, 500, 48, 300, 500, 500, 48, 34, 32, 448, 78, 50, 500, 500, 108, 66, 94, 500, 66, 52, 60, 500, 96, 500, 52, 80, 500, 500, 36, 308, 38, 40, 500, 500, 500, 32, 26, 92, 500, 500, 64, 60, 38, 500, 62, 40, 500, 500, 58, 500, 500, 500, 44, 500, 200, 144, 38, 500, 500, 430, 500, 68, 374, 500, 76, 32, 314, 74, 500, 44, 500, 156, 40, 500, 500, 500, 40, 500, 500, 500, 422, 500, 500, 58, 442, 240, 46, 500, 460, 320, 500, 74, 62, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790748402469852, "mean_inference_ms": 1.2122983639805154, "mean_action_processing_ms": 0.14053719843898502, "mean_env_wait_ms": 0.0830384388163094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035823822021484375, "StateBufferConnector_ms": 0.011818885803222656, "ViewRequirementAgentConnector_ms": 0.13158059120178223}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.09699999999978637, "episode_len_mean": 284.6, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.3, 20.099999999999845, -50.00000000000044, -50.00000000000044, 45.3, 46.699999999999996, 46.9, 5.299999999999635, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.50000000000001, 40.70000000000002, -50.00000000000044, 43.50000000000001, 44.900000000000006, 44.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, 19.299999999999834, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.5, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.7, 44.10000000000001, 46.3, -50.00000000000044, 43.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 30.099999999999987, 35.70000000000003, 46.3, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 43.30000000000001, 12.69999999999974, -50.00000000000044, 42.500000000000014, 46.9, 18.699999999999825, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 44.300000000000004, 5.899999999999643, 26.09999999999993, 45.5, -50.00000000000044, 4.099999999999618, 18.099999999999817, -50.00000000000044, 42.70000000000001, 43.900000000000006, -50.00000000000044, 43.30000000000001], "episode_lengths": [500, 500, 60, 500, 500, 28, 500, 48, 300, 500, 500, 48, 34, 32, 448, 78, 50, 500, 500, 108, 66, 94, 500, 66, 52, 60, 500, 96, 500, 52, 80, 500, 500, 36, 308, 38, 40, 500, 500, 500, 32, 26, 92, 500, 500, 64, 60, 38, 500, 62, 40, 500, 500, 58, 500, 500, 500, 44, 500, 200, 144, 38, 500, 500, 430, 500, 68, 374, 500, 76, 32, 314, 74, 500, 44, 500, 156, 40, 500, 500, 500, 40, 500, 500, 500, 422, 500, 500, 58, 442, 240, 46, 500, 460, 320, 500, 74, 62, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790748402469852, "mean_inference_ms": 1.2122983639805154, "mean_action_processing_ms": 0.14053719843898502, "mean_env_wait_ms": 0.0830384388163094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035823822021484375, "StateBufferConnector_ms": 0.011818885803222656, "ViewRequirementAgentConnector_ms": 0.13158059120178223}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5725.866805811153, "num_env_steps_trained_throughput_per_sec": 5725.866805811153, "timesteps_total": 252000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3250.277, "sample_time_ms": 2895.121, "load_time_ms": 17.98, "load_throughput": 1001101.54, "learn_time_ms": 325.216, "learn_throughput": 55347.78, "synch_weights_time_ms": 10.008}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 951, "training_iteration": 14, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-23", "timestamp": 1698247943, "time_this_iter_s": 3.149653673171997, "time_total_s": 45.27795457839966, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 45.27795457839966, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 62.125, "ram_util_percent": 26.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0003, "total_loss": 6.733884352224845, "policy_loss": -0.00010382685879314388, "vf_loss": 6.734038264663131, "vf_explained_var": 7.218784756130642e-07, "kl": 0.00021229255610756404, "entropy": 0.5004036625226339, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 392.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.481999999999805, "episode_len_mean": 275.78, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.699999999999825, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 44.300000000000004, 5.899999999999643, 26.09999999999993, 45.5, -50.00000000000044, 4.099999999999618, 18.099999999999817, -50.00000000000044, 42.70000000000001, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.699999999999996, 42.500000000000014, 41.70000000000002, 33.500000000000036, -50.00000000000044, -50.00000000000044, 42.900000000000006, 16.09999999999979, -50.00000000000044, 44.5, 41.90000000000001, 41.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.5, 33.500000000000036, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.50000000000001, 31.1, -50.00000000000044, 47.1, 46.099999999999994, 36.30000000000003, 37.10000000000003, 45.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.1, 39.90000000000002, 45.7, 28.699999999999967, -50.00000000000044, 20.49999999999985, -50.00000000000044, -50.00000000000044, 37.90000000000003, 45.3, 46.3, 45.5, 40.30000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.10000000000004, 1.099999999999575, 33.500000000000036, 39.50000000000002, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 35.10000000000004], "episode_lengths": [314, 74, 500, 44, 500, 156, 40, 500, 500, 500, 40, 500, 500, 500, 422, 500, 500, 58, 442, 240, 46, 500, 460, 320, 500, 74, 62, 500, 68, 500, 34, 76, 84, 166, 500, 500, 72, 340, 500, 56, 82, 86, 500, 92, 500, 500, 500, 500, 90, 36, 166, 500, 500, 52, 500, 500, 80, 500, 66, 190, 500, 30, 40, 138, 130, 48, 500, 76, 500, 50, 102, 44, 214, 500, 296, 500, 500, 122, 48, 38, 46, 98, 500, 74, 500, 34, 500, 500, 160, 490, 166, 106, 500, 90, 54, 500, 54, 52, 500, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37862688184087534, "mean_inference_ms": 1.2081076841405562, "mean_action_processing_ms": 0.14018218632055912, "mean_env_wait_ms": 0.08261982035112524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026003122329711914, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.11117339134216309}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.481999999999805, "episode_len_mean": 275.78, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.699999999999825, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 44.300000000000004, 5.899999999999643, 26.09999999999993, 45.5, -50.00000000000044, 4.099999999999618, 18.099999999999817, -50.00000000000044, 42.70000000000001, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.699999999999996, 42.500000000000014, 41.70000000000002, 33.500000000000036, -50.00000000000044, -50.00000000000044, 42.900000000000006, 16.09999999999979, -50.00000000000044, 44.5, 41.90000000000001, 41.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.5, 33.500000000000036, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.50000000000001, 31.1, -50.00000000000044, 47.1, 46.099999999999994, 36.30000000000003, 37.10000000000003, 45.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.1, 39.90000000000002, 45.7, 28.699999999999967, -50.00000000000044, 20.49999999999985, -50.00000000000044, -50.00000000000044, 37.90000000000003, 45.3, 46.3, 45.5, 40.30000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.10000000000004, 1.099999999999575, 33.500000000000036, 39.50000000000002, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 35.10000000000004], "episode_lengths": [314, 74, 500, 44, 500, 156, 40, 500, 500, 500, 40, 500, 500, 500, 422, 500, 500, 58, 442, 240, 46, 500, 460, 320, 500, 74, 62, 500, 68, 500, 34, 76, 84, 166, 500, 500, 72, 340, 500, 56, 82, 86, 500, 92, 500, 500, 500, 500, 90, 36, 166, 500, 500, 52, 500, 500, 80, 500, 66, 190, 500, 30, 40, 138, 130, 48, 500, 76, 500, 50, 102, 44, 214, 500, 296, 500, 500, 122, 48, 38, 46, 98, 500, 74, 500, 34, 500, 500, 160, 490, 166, 106, 500, 90, 54, 500, 54, 52, 500, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37862688184087534, "mean_inference_ms": 1.2081076841405562, "mean_action_processing_ms": 0.14018218632055912, "mean_env_wait_ms": 0.08261982035112524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026003122329711914, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.11117339134216309}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5509.242300576082, "num_env_steps_trained_throughput_per_sec": 5509.242300576082, "timesteps_total": 270000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 3250.601, "sample_time_ms": 2892.552, "load_time_ms": 17.853, "load_throughput": 1008238.075, "learn_time_ms": 328.378, "learn_throughput": 54814.833, "synch_weights_time_ms": 9.861}, "counters": {"num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 1022, "training_iteration": 15, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-26", "timestamp": 1698247946, "time_this_iter_s": 3.2741544246673584, "time_total_s": 48.55210900306702, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 48.55210900306702, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 55.660000000000004, "ram_util_percent": 26.160000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 0.0003, "total_loss": 6.591504944695367, "policy_loss": -0.00011556219585515835, "vf_loss": 6.591671095954047, "vf_explained_var": 1.5232298109266492e-07, "kl": 0.00035696447095685043, "entropy": 0.5055076303305449, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 419.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.541999999999842, "episode_len_mean": 245.24, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 39.90000000000002, 45.7, 28.699999999999967, -50.00000000000044, 20.49999999999985, -50.00000000000044, -50.00000000000044, 37.90000000000003, 45.3, 46.3, 45.5, 40.30000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.10000000000004, 1.099999999999575, 33.500000000000036, 39.50000000000002, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 35.10000000000004, -50.00000000000044, 33.30000000000003, -50.00000000000044, 38.700000000000024, 43.50000000000001, 32.50000000000002, 44.7, -50.00000000000044, 34.50000000000004, 44.10000000000001, 34.50000000000004, 43.50000000000001, 39.50000000000002, 11.099999999999717, 19.09999999999983, 46.099999999999994, -50.00000000000044, 44.10000000000001, 45.7, 34.30000000000004, 25.099999999999916, 33.10000000000003, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, 42.900000000000006, 41.70000000000002, 45.1, 46.699999999999996, -50.00000000000044, 43.10000000000001, 44.300000000000004, -50.00000000000044, 38.300000000000026, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.5, -50.00000000000044, 17.299999999999805, 41.90000000000001, -50.00000000000044, -50.00000000000044, 33.70000000000004, 39.70000000000002, 43.900000000000006, 44.300000000000004, 45.3], "episode_lengths": [50, 102, 44, 214, 500, 296, 500, 500, 122, 48, 38, 46, 98, 500, 74, 500, 34, 500, 500, 160, 490, 166, 106, 500, 90, 54, 500, 54, 52, 500, 150, 500, 168, 500, 114, 66, 176, 54, 500, 156, 60, 156, 66, 106, 390, 310, 40, 500, 60, 44, 158, 250, 170, 216, 500, 500, 500, 94, 58, 98, 500, 500, 500, 48, 500, 52, 58, 500, 500, 76, 54, 500, 500, 208, 500, 72, 84, 50, 34, 500, 70, 58, 500, 118, 84, 500, 500, 78, 500, 36, 500, 328, 82, 500, 500, 164, 104, 62, 58, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785373652075286, "mean_inference_ms": 1.2078728836077974, "mean_action_processing_ms": 0.14068127944150738, "mean_env_wait_ms": 0.0824693841760908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014999628067016602, "StateBufferConnector_ms": 0.011996984481811523, "ViewRequirementAgentConnector_ms": 0.1090235710144043}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.541999999999842, "episode_len_mean": 245.24, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 39.90000000000002, 45.7, 28.699999999999967, -50.00000000000044, 20.49999999999985, -50.00000000000044, -50.00000000000044, 37.90000000000003, 45.3, 46.3, 45.5, 40.30000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.10000000000004, 1.099999999999575, 33.500000000000036, 39.50000000000002, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 35.10000000000004, -50.00000000000044, 33.30000000000003, -50.00000000000044, 38.700000000000024, 43.50000000000001, 32.50000000000002, 44.7, -50.00000000000044, 34.50000000000004, 44.10000000000001, 34.50000000000004, 43.50000000000001, 39.50000000000002, 11.099999999999717, 19.09999999999983, 46.099999999999994, -50.00000000000044, 44.10000000000001, 45.7, 34.30000000000004, 25.099999999999916, 33.10000000000003, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, 42.900000000000006, 41.70000000000002, 45.1, 46.699999999999996, -50.00000000000044, 43.10000000000001, 44.300000000000004, -50.00000000000044, 38.300000000000026, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.5, -50.00000000000044, 17.299999999999805, 41.90000000000001, -50.00000000000044, -50.00000000000044, 33.70000000000004, 39.70000000000002, 43.900000000000006, 44.300000000000004, 45.3], "episode_lengths": [50, 102, 44, 214, 500, 296, 500, 500, 122, 48, 38, 46, 98, 500, 74, 500, 34, 500, 500, 160, 490, 166, 106, 500, 90, 54, 500, 54, 52, 500, 150, 500, 168, 500, 114, 66, 176, 54, 500, 156, 60, 156, 66, 106, 390, 310, 40, 500, 60, 44, 158, 250, 170, 216, 500, 500, 500, 94, 58, 98, 500, 500, 500, 48, 500, 52, 58, 500, 500, 76, 54, 500, 500, 208, 500, 72, 84, 50, 34, 500, 70, 58, 500, 118, 84, 500, 500, 78, 500, 36, 500, 328, 82, 500, 500, 164, 104, 62, 58, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785373652075286, "mean_inference_ms": 1.2078728836077974, "mean_action_processing_ms": 0.14068127944150738, "mean_env_wait_ms": 0.0824693841760908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014999628067016602, "StateBufferConnector_ms": 0.011996984481811523, "ViewRequirementAgentConnector_ms": 0.1090235710144043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5607.398270219395, "num_env_steps_trained_throughput_per_sec": 5607.398270219395, "timesteps_total": 288000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 3254.844, "sample_time_ms": 2898.209, "load_time_ms": 18.605, "load_throughput": 967492.1, "learn_time_ms": 326.126, "learn_throughput": 55193.314, "synch_weights_time_ms": 9.947}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1091, "training_iteration": 16, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-29", "timestamp": 1698247949, "time_this_iter_s": 3.2160494327545166, "time_total_s": 51.76815843582153, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 51.76815843582153, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 62.075, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 0.0003, "total_loss": 6.956543569211607, "policy_loss": -8.996024175926491e-05, "vf_loss": 6.9566869205898705, "vf_explained_var": -6.777268868905527e-07, "kl": 0.0003256694097573203, "entropy": 0.5344649774056894, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 446.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.653999999999852, "episode_len_mean": 234.14, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, 44.300000000000004, -50.00000000000044, 38.300000000000026, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.5, -50.00000000000044, 17.299999999999805, 41.90000000000001, -50.00000000000044, -50.00000000000044, 33.70000000000004, 39.70000000000002, 43.900000000000006, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, 16.499999999999794, 43.50000000000001, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.700000000000024, 41.100000000000016, -50.00000000000044, 42.30000000000001, -50.00000000000044, 34.70000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 27.699999999999953, 45.1, 46.699999999999996, 34.30000000000004, -50.00000000000044, 44.900000000000006, 45.7, 44.900000000000006, 46.099999999999994, 11.499999999999723, 32.90000000000003, 32.50000000000002, 31.70000000000001, -50.00000000000044, 45.1, 41.90000000000001, 26.69999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.9, 45.5, 41.70000000000002, 21.499999999999865, -50.00000000000044, -50.00000000000044, 45.3, 14.299999999999763, 43.10000000000001, 43.900000000000006, -50.00000000000044, 41.500000000000014, 44.7, 42.900000000000006, 41.90000000000001, 35.30000000000004, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, 45.9, 45.5, 18.899999999999828, 33.500000000000036, -50.00000000000044, 40.30000000000002, 37.70000000000003, -50.00000000000044, 46.3, 45.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 44.900000000000006, 45.5, -50.00000000000044], "episode_lengths": [500, 70, 58, 500, 118, 84, 500, 500, 78, 500, 36, 500, 328, 82, 500, 500, 164, 104, 62, 58, 48, 500, 500, 336, 66, 272, 500, 500, 500, 60, 114, 90, 500, 78, 500, 154, 70, 500, 500, 70, 224, 50, 34, 158, 500, 52, 44, 52, 40, 386, 172, 176, 184, 500, 50, 82, 234, 66, 500, 500, 60, 32, 46, 84, 286, 500, 500, 48, 358, 70, 62, 500, 86, 54, 72, 82, 148, 500, 150, 500, 60, 48, 500, 42, 46, 312, 166, 500, 98, 124, 500, 38, 50, 60, 500, 500, 30, 52, 46, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37825436216340586, "mean_inference_ms": 1.2066880312872954, "mean_action_processing_ms": 0.14052481020495236, "mean_env_wait_ms": 0.08282430572829115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016994714736938477, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.11201596260070801}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.653999999999852, "episode_len_mean": 234.14, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, 44.300000000000004, -50.00000000000044, 38.300000000000026, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.5, -50.00000000000044, 17.299999999999805, 41.90000000000001, -50.00000000000044, -50.00000000000044, 33.70000000000004, 39.70000000000002, 43.900000000000006, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, 16.499999999999794, 43.50000000000001, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.700000000000024, 41.100000000000016, -50.00000000000044, 42.30000000000001, -50.00000000000044, 34.70000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 27.699999999999953, 45.1, 46.699999999999996, 34.30000000000004, -50.00000000000044, 44.900000000000006, 45.7, 44.900000000000006, 46.099999999999994, 11.499999999999723, 32.90000000000003, 32.50000000000002, 31.70000000000001, -50.00000000000044, 45.1, 41.90000000000001, 26.69999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.9, 45.5, 41.70000000000002, 21.499999999999865, -50.00000000000044, -50.00000000000044, 45.3, 14.299999999999763, 43.10000000000001, 43.900000000000006, -50.00000000000044, 41.500000000000014, 44.7, 42.900000000000006, 41.90000000000001, 35.30000000000004, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, 45.9, 45.5, 18.899999999999828, 33.500000000000036, -50.00000000000044, 40.30000000000002, 37.70000000000003, -50.00000000000044, 46.3, 45.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 44.900000000000006, 45.5, -50.00000000000044], "episode_lengths": [500, 70, 58, 500, 118, 84, 500, 500, 78, 500, 36, 500, 328, 82, 500, 500, 164, 104, 62, 58, 48, 500, 500, 336, 66, 272, 500, 500, 500, 60, 114, 90, 500, 78, 500, 154, 70, 500, 500, 70, 224, 50, 34, 158, 500, 52, 44, 52, 40, 386, 172, 176, 184, 500, 50, 82, 234, 66, 500, 500, 60, 32, 46, 84, 286, 500, 500, 48, 358, 70, 62, 500, 86, 54, 72, 82, 148, 500, 150, 500, 60, 48, 500, 42, 46, 312, 166, 500, 98, 124, 500, 38, 50, 60, 500, 500, 30, 52, 46, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37825436216340586, "mean_inference_ms": 1.2066880312872954, "mean_action_processing_ms": 0.14052481020495236, "mean_env_wait_ms": 0.08282430572829115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016994714736938477, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.11201596260070801}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5639.200252465365, "num_env_steps_trained_throughput_per_sec": 5639.200252465365, "timesteps_total": 306000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 306000, "timers": {"training_iteration_time_ms": 3247.524, "sample_time_ms": 2902.743, "load_time_ms": 17.522, "load_throughput": 1027258.95, "learn_time_ms": 315.263, "learn_throughput": 57095.22, "synch_weights_time_ms": 10.039}, "counters": {"num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "done": false, "episodes_total": 1170, "training_iteration": 17, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-32", "timestamp": 1698247952, "time_this_iter_s": 3.1979610919952393, "time_total_s": 54.96611952781677, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 54.96611952781677, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 58.519999999999996, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 0.0003, "total_loss": 6.723360308894405, "policy_loss": -0.0001284791225636447, "vf_loss": 6.723541489353886, "vf_explained_var": -1.3068870261863427e-06, "kl": 0.0003816915106392992, "entropy": 0.5278397169378068, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.510999999999841, "episode_len_mean": 240.54, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, 41.90000000000001, 35.30000000000004, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, 45.9, 45.5, 18.899999999999828, 33.500000000000036, -50.00000000000044, 40.30000000000002, 37.70000000000003, -50.00000000000044, 46.3, 45.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, -50.00000000000044, 32.50000000000002, -50.00000000000044, 42.500000000000014, 13.299999999999748, 39.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.7, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.10000000000002, 37.10000000000003, 44.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 38.300000000000026, 43.7, 41.30000000000001, 46.5, 45.1, -50.00000000000044, 29.49999999999998, -50.00000000000044, 42.70000000000001, 46.9, 42.30000000000001, 43.10000000000001, 42.70000000000001, 46.099999999999994, 40.90000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 44.7, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 39.50000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.7, 39.70000000000002, 22.899999999999885, 47.3, 38.300000000000026, 34.10000000000004, 45.7, 45.3, 25.699999999999925, -50.00000000000044, 45.7, -50.00000000000044, 42.500000000000014, 18.29999999999982, -50.00000000000044, 46.3, 41.70000000000002, 44.300000000000004, -50.00000000000044], "episode_lengths": [72, 82, 148, 500, 150, 500, 60, 48, 500, 42, 46, 312, 166, 500, 98, 124, 500, 38, 50, 60, 500, 500, 30, 52, 46, 500, 500, 500, 500, 500, 334, 500, 176, 500, 76, 368, 110, 70, 500, 500, 64, 50, 500, 500, 500, 80, 120, 130, 56, 500, 84, 500, 118, 64, 88, 36, 50, 500, 206, 500, 74, 32, 78, 70, 74, 40, 92, 500, 82, 500, 54, 500, 124, 500, 500, 500, 54, 106, 90, 500, 500, 44, 104, 272, 28, 118, 160, 44, 48, 244, 500, 44, 500, 76, 318, 500, 38, 84, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3796640355037338, "mean_inference_ms": 1.2097792371251654, "mean_action_processing_ms": 0.14078083079720766, "mean_env_wait_ms": 0.08347269089991755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800774574279785, "StateBufferConnector_ms": 0.006997585296630859, "ViewRequirementAgentConnector_ms": 0.12100529670715332}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.510999999999841, "episode_len_mean": 240.54, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, 41.90000000000001, 35.30000000000004, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, 45.9, 45.5, 18.899999999999828, 33.500000000000036, -50.00000000000044, 40.30000000000002, 37.70000000000003, -50.00000000000044, 46.3, 45.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, -50.00000000000044, 32.50000000000002, -50.00000000000044, 42.500000000000014, 13.299999999999748, 39.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.7, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.10000000000002, 37.10000000000003, 44.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 38.300000000000026, 43.7, 41.30000000000001, 46.5, 45.1, -50.00000000000044, 29.49999999999998, -50.00000000000044, 42.70000000000001, 46.9, 42.30000000000001, 43.10000000000001, 42.70000000000001, 46.099999999999994, 40.90000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 44.7, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 39.50000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.7, 39.70000000000002, 22.899999999999885, 47.3, 38.300000000000026, 34.10000000000004, 45.7, 45.3, 25.699999999999925, -50.00000000000044, 45.7, -50.00000000000044, 42.500000000000014, 18.29999999999982, -50.00000000000044, 46.3, 41.70000000000002, 44.300000000000004, -50.00000000000044], "episode_lengths": [72, 82, 148, 500, 150, 500, 60, 48, 500, 42, 46, 312, 166, 500, 98, 124, 500, 38, 50, 60, 500, 500, 30, 52, 46, 500, 500, 500, 500, 500, 334, 500, 176, 500, 76, 368, 110, 70, 500, 500, 64, 50, 500, 500, 500, 80, 120, 130, 56, 500, 84, 500, 118, 64, 88, 36, 50, 500, 206, 500, 74, 32, 78, 70, 74, 40, 92, 500, 82, 500, 54, 500, 124, 500, 500, 500, 54, 106, 90, 500, 500, 44, 104, 272, 28, 118, 160, 44, 48, 244, 500, 44, 500, 76, 318, 500, 38, 84, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3796640355037338, "mean_inference_ms": 1.2097792371251654, "mean_action_processing_ms": 0.14078083079720766, "mean_env_wait_ms": 0.08347269089991755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800774574279785, "StateBufferConnector_ms": 0.006997585296630859, "ViewRequirementAgentConnector_ms": 0.12100529670715332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5109.722754079828, "num_env_steps_trained_throughput_per_sec": 5109.722754079828, "timesteps_total": 324000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 3273.032, "sample_time_ms": 2922.163, "load_time_ms": 17.369, "load_throughput": 1036308.696, "learn_time_ms": 321.407, "learn_throughput": 56003.765, "synch_weights_time_ms": 10.035}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1244, "training_iteration": 18, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-36", "timestamp": 1698247956, "time_this_iter_s": 3.5286877155303955, "time_total_s": 58.49480724334717, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 58.49480724334717, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 63.67999999999999, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 0.0003, "total_loss": 6.962736730222349, "policy_loss": -0.00030645121026922153, "vf_loss": 6.963095488371672, "vf_explained_var": -8.322574474193432e-07, "kl": 0.0005857092042426168, "entropy": 0.5226674532448804, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 500.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.64899999999986, "episode_len_mean": 219.22, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.899999999999885, 47.3, 38.300000000000026, 34.10000000000004, 45.7, 45.3, 25.699999999999925, -50.00000000000044, 45.7, -50.00000000000044, 42.500000000000014, 18.29999999999982, -50.00000000000044, 46.3, 41.70000000000002, 44.300000000000004, -50.00000000000044, 15.899999999999785, 39.90000000000002, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.90000000000002, 31.1, -50.00000000000044, 43.7, 44.5, 44.900000000000006, 45.1, -50.00000000000044, 42.70000000000001, -50.00000000000044, 37.300000000000026, 46.3, 45.5, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.70000000000002, -50.00000000000044, 39.10000000000002, 45.9, -50.00000000000044, 42.30000000000001, 41.70000000000002, 46.3, -50.00000000000044, 38.50000000000003, 6.299999999999649, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, 45.1, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, 45.9, 31.300000000000004, 39.10000000000002, 36.70000000000003, 42.30000000000001, 42.10000000000001, 39.50000000000002, 9.499999999999694, 45.3, 47.3, 46.5, 37.70000000000003, -50.00000000000044, 8.899999999999686, 41.70000000000002, -50.00000000000044, 44.10000000000001, 46.099999999999994, 46.099999999999994, -50.00000000000044, 47.7, 15.299999999999777, 44.7, 45.3, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, -50.00000000000044, 46.3, 44.900000000000006, 31.500000000000007, 46.3, 45.1, 30.699999999999996], "episode_lengths": [272, 28, 118, 160, 44, 48, 244, 500, 44, 500, 76, 318, 500, 38, 84, 58, 500, 342, 102, 36, 500, 500, 500, 40, 92, 190, 500, 64, 56, 52, 50, 500, 74, 500, 128, 38, 46, 500, 500, 130, 500, 500, 34, 84, 500, 110, 42, 500, 78, 84, 38, 500, 116, 438, 500, 88, 500, 500, 46, 50, 500, 500, 66, 500, 34, 42, 188, 110, 134, 78, 80, 106, 406, 48, 28, 36, 124, 500, 412, 84, 500, 60, 40, 40, 500, 24, 348, 54, 48, 500, 66, 28, 500, 500, 38, 52, 186, 38, 50, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38142635140232173, "mean_inference_ms": 1.2255189432813451, "mean_action_processing_ms": 0.14185972976840444, "mean_env_wait_ms": 0.0834384970004774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299760818481445, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.12501025199890137}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.64899999999986, "episode_len_mean": 219.22, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.899999999999885, 47.3, 38.300000000000026, 34.10000000000004, 45.7, 45.3, 25.699999999999925, -50.00000000000044, 45.7, -50.00000000000044, 42.500000000000014, 18.29999999999982, -50.00000000000044, 46.3, 41.70000000000002, 44.300000000000004, -50.00000000000044, 15.899999999999785, 39.90000000000002, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.90000000000002, 31.1, -50.00000000000044, 43.7, 44.5, 44.900000000000006, 45.1, -50.00000000000044, 42.70000000000001, -50.00000000000044, 37.300000000000026, 46.3, 45.5, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.70000000000002, -50.00000000000044, 39.10000000000002, 45.9, -50.00000000000044, 42.30000000000001, 41.70000000000002, 46.3, -50.00000000000044, 38.50000000000003, 6.299999999999649, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, 45.1, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, 45.9, 31.300000000000004, 39.10000000000002, 36.70000000000003, 42.30000000000001, 42.10000000000001, 39.50000000000002, 9.499999999999694, 45.3, 47.3, 46.5, 37.70000000000003, -50.00000000000044, 8.899999999999686, 41.70000000000002, -50.00000000000044, 44.10000000000001, 46.099999999999994, 46.099999999999994, -50.00000000000044, 47.7, 15.299999999999777, 44.7, 45.3, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, -50.00000000000044, 46.3, 44.900000000000006, 31.500000000000007, 46.3, 45.1, 30.699999999999996], "episode_lengths": [272, 28, 118, 160, 44, 48, 244, 500, 44, 500, 76, 318, 500, 38, 84, 58, 500, 342, 102, 36, 500, 500, 500, 40, 92, 190, 500, 64, 56, 52, 50, 500, 74, 500, 128, 38, 46, 500, 500, 130, 500, 500, 34, 84, 500, 110, 42, 500, 78, 84, 38, 500, 116, 438, 500, 88, 500, 500, 46, 50, 500, 500, 66, 500, 34, 42, 188, 110, 134, 78, 80, 106, 406, 48, 28, 36, 124, 500, 412, 84, 500, 60, 40, 40, 500, 24, 348, 54, 48, 500, 66, 28, 500, 500, 38, 52, 186, 38, 50, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38142635140232173, "mean_inference_ms": 1.2255189432813451, "mean_action_processing_ms": 0.14185972976840444, "mean_env_wait_ms": 0.0834384970004774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299760818481445, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.12501025199890137}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4994.921351172129, "num_env_steps_trained_throughput_per_sec": 4994.921351172129, "timesteps_total": 342000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 342000, "timers": {"training_iteration_time_ms": 3312.171, "sample_time_ms": 2960.094, "load_time_ms": 17.89, "load_throughput": 1006164.758, "learn_time_ms": 322.046, "learn_throughput": 55892.613, "synch_weights_time_ms": 10.085}, "counters": {"num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "done": false, "episodes_total": 1327, "training_iteration": 19, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-40", "timestamp": 1698247960, "time_this_iter_s": 3.6096549034118652, "time_total_s": 62.10446214675903, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 62.10446214675903, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 69.30000000000001, "ram_util_percent": 26.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 0.0003, "total_loss": 6.67919937769572, "policy_loss": -0.0002116845248060094, "vf_loss": 6.679458971376772, "vf_explained_var": -2.0243503429271556e-06, "kl": 0.00026141960254082934, "entropy": 0.47898699398393985, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 527.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.342999999999842, "episode_len_mean": 232.26, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.50000000000002, 9.499999999999694, 45.3, 47.3, 46.5, 37.70000000000003, -50.00000000000044, 8.899999999999686, 41.70000000000002, -50.00000000000044, 44.10000000000001, 46.099999999999994, 46.099999999999994, -50.00000000000044, 47.7, 15.299999999999777, 44.7, 45.3, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, -50.00000000000044, 46.3, 44.900000000000006, 31.500000000000007, 46.3, 45.1, 30.699999999999996, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 45.7, 45.5, 45.5, 19.09999999999983, 44.7, 45.3, 47.3, 41.90000000000001, 23.8999999999999, -50.00000000000044, 44.900000000000006, 34.900000000000034, 44.300000000000004, -50.00000000000044, 41.90000000000001, 43.7, 46.099999999999994, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, 34.70000000000004, 46.5, 44.7, 46.3, 47.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.50000000000001, 41.30000000000001, 23.099999999999888, 39.50000000000002, 12.299999999999734, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 21.499999999999865, 45.3, -50.00000000000044, 22.099999999999874, -50.00000000000044, 44.10000000000001, 42.900000000000006, 41.30000000000001, 39.50000000000002, -50.00000000000044, 45.1, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 7.499999999999666, 47.1, -50.00000000000044], "episode_lengths": [106, 406, 48, 28, 36, 124, 500, 412, 84, 500, 60, 40, 40, 500, 24, 348, 54, 48, 500, 66, 28, 500, 500, 38, 52, 186, 38, 50, 194, 500, 108, 500, 500, 42, 40, 44, 46, 46, 310, 54, 48, 28, 82, 262, 500, 52, 152, 58, 500, 82, 64, 40, 500, 56, 62, 500, 154, 36, 54, 38, 26, 500, 500, 84, 500, 66, 88, 270, 106, 378, 396, 500, 500, 500, 500, 500, 500, 80, 286, 48, 500, 280, 500, 60, 72, 88, 106, 500, 50, 74, 90, 500, 500, 500, 154, 500, 500, 426, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38192369547966154, "mean_inference_ms": 1.2273139205874253, "mean_action_processing_ms": 0.14163067756788275, "mean_env_wait_ms": 0.08346642032438402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025000810623168945, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.13199305534362793}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.342999999999842, "episode_len_mean": 232.26, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.50000000000002, 9.499999999999694, 45.3, 47.3, 46.5, 37.70000000000003, -50.00000000000044, 8.899999999999686, 41.70000000000002, -50.00000000000044, 44.10000000000001, 46.099999999999994, 46.099999999999994, -50.00000000000044, 47.7, 15.299999999999777, 44.7, 45.3, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, -50.00000000000044, 46.3, 44.900000000000006, 31.500000000000007, 46.3, 45.1, 30.699999999999996, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 45.7, 45.5, 45.5, 19.09999999999983, 44.7, 45.3, 47.3, 41.90000000000001, 23.8999999999999, -50.00000000000044, 44.900000000000006, 34.900000000000034, 44.300000000000004, -50.00000000000044, 41.90000000000001, 43.7, 46.099999999999994, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, 34.70000000000004, 46.5, 44.7, 46.3, 47.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.50000000000001, 41.30000000000001, 23.099999999999888, 39.50000000000002, 12.299999999999734, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 21.499999999999865, 45.3, -50.00000000000044, 22.099999999999874, -50.00000000000044, 44.10000000000001, 42.900000000000006, 41.30000000000001, 39.50000000000002, -50.00000000000044, 45.1, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 7.499999999999666, 47.1, -50.00000000000044], "episode_lengths": [106, 406, 48, 28, 36, 124, 500, 412, 84, 500, 60, 40, 40, 500, 24, 348, 54, 48, 500, 66, 28, 500, 500, 38, 52, 186, 38, 50, 194, 500, 108, 500, 500, 42, 40, 44, 46, 46, 310, 54, 48, 28, 82, 262, 500, 52, 152, 58, 500, 82, 64, 40, 500, 56, 62, 500, 154, 36, 54, 38, 26, 500, 500, 84, 500, 66, 88, 270, 106, 378, 396, 500, 500, 500, 500, 500, 500, 80, 286, 48, 500, 280, 500, 60, 72, 88, 106, 500, 50, 74, 90, 500, 500, 500, 154, 500, 500, 426, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38192369547966154, "mean_inference_ms": 1.2273139205874253, "mean_action_processing_ms": 0.14163067756788275, "mean_env_wait_ms": 0.08346642032438402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025000810623168945, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.13199305534362793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5897.448912516969, "num_env_steps_trained_throughput_per_sec": 5897.448912516969, "timesteps_total": 360000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 3243.268, "sample_time_ms": 2899.786, "load_time_ms": 16.953, "load_throughput": 1061771.46, "learn_time_ms": 314.573, "learn_throughput": 57220.487, "synch_weights_time_ms": 9.699}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1398, "training_iteration": 20, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-43", "timestamp": 1698247963, "time_this_iter_s": 3.059166669845581, "time_total_s": 65.16362881660461, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 65.16362881660461, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 60.84000000000001, "ram_util_percent": 26.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0003, "total_loss": 6.458393838670519, "policy_loss": -5.0142959312156393e-05, "vf_loss": 6.458490195097746, "vf_explained_var": -7.748603820800781e-07, "kl": 0.00021894842410469446, "entropy": 0.46134547613285204, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 554.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.845999999999822, "episode_len_mean": 252.16, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.10000000000001, 21.499999999999865, 45.3, -50.00000000000044, 22.099999999999874, -50.00000000000044, 44.10000000000001, 42.900000000000006, 41.30000000000001, 39.50000000000002, -50.00000000000044, 45.1, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 7.499999999999666, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, 8.899999999999686, -50.00000000000044, -50.00000000000044, 44.7, 43.7, 42.500000000000014, -50.00000000000044, 44.900000000000006, 38.90000000000002, 43.7, 36.30000000000003, 46.099999999999994, -50.00000000000044, 37.70000000000003, 44.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.7, 45.9, 45.3, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 11.899999999999729, 44.900000000000006, -50.00000000000044, 35.70000000000003, 44.900000000000006, 47.1, -50.00000000000044, 46.5, 41.30000000000001, -50.00000000000044, 45.5, 41.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 47.9, 40.500000000000014, 43.900000000000006, 40.500000000000014, 7.299999999999663, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.50000000000001, 40.70000000000002, 41.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 41.70000000000002, 45.3, 36.70000000000003, -50.00000000000044], "episode_lengths": [500, 80, 286, 48, 500, 280, 500, 60, 72, 88, 106, 500, 50, 74, 90, 500, 500, 500, 154, 500, 500, 426, 30, 500, 40, 500, 44, 412, 500, 500, 54, 64, 76, 500, 52, 112, 64, 138, 40, 500, 124, 56, 108, 500, 500, 500, 72, 500, 44, 42, 48, 500, 500, 102, 64, 500, 122, 500, 500, 382, 52, 500, 144, 52, 30, 500, 36, 88, 500, 46, 88, 500, 48, 500, 22, 96, 62, 96, 428, 500, 500, 52, 66, 94, 88, 500, 78, 500, 500, 500, 44, 42, 500, 500, 34, 60, 84, 48, 134, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3815892665365104, "mean_inference_ms": 1.2267021640342615, "mean_action_processing_ms": 0.1412357574191052, "mean_env_wait_ms": 0.08320335063054789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025998830795288086, "StateBufferConnector_ms": 0.0019989013671875, "ViewRequirementAgentConnector_ms": 0.11951565742492676}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.845999999999822, "episode_len_mean": 252.16, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.10000000000001, 21.499999999999865, 45.3, -50.00000000000044, 22.099999999999874, -50.00000000000044, 44.10000000000001, 42.900000000000006, 41.30000000000001, 39.50000000000002, -50.00000000000044, 45.1, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 7.499999999999666, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, 8.899999999999686, -50.00000000000044, -50.00000000000044, 44.7, 43.7, 42.500000000000014, -50.00000000000044, 44.900000000000006, 38.90000000000002, 43.7, 36.30000000000003, 46.099999999999994, -50.00000000000044, 37.70000000000003, 44.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.7, 45.9, 45.3, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 11.899999999999729, 44.900000000000006, -50.00000000000044, 35.70000000000003, 44.900000000000006, 47.1, -50.00000000000044, 46.5, 41.30000000000001, -50.00000000000044, 45.5, 41.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 47.9, 40.500000000000014, 43.900000000000006, 40.500000000000014, 7.299999999999663, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.50000000000001, 40.70000000000002, 41.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 41.70000000000002, 45.3, 36.70000000000003, -50.00000000000044], "episode_lengths": [500, 80, 286, 48, 500, 280, 500, 60, 72, 88, 106, 500, 50, 74, 90, 500, 500, 500, 154, 500, 500, 426, 30, 500, 40, 500, 44, 412, 500, 500, 54, 64, 76, 500, 52, 112, 64, 138, 40, 500, 124, 56, 108, 500, 500, 500, 72, 500, 44, 42, 48, 500, 500, 102, 64, 500, 122, 500, 500, 382, 52, 500, 144, 52, 30, 500, 36, 88, 500, 46, 88, 500, 48, 500, 22, 96, 62, 96, 428, 500, 500, 52, 66, 94, 88, 500, 78, 500, 500, 500, 44, 42, 500, 500, 34, 60, 84, 48, 134, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3815892665365104, "mean_inference_ms": 1.2267021640342615, "mean_action_processing_ms": 0.1412357574191052, "mean_env_wait_ms": 0.08320335063054789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025998830795288086, "StateBufferConnector_ms": 0.0019989013671875, "ViewRequirementAgentConnector_ms": 0.11951565742492676}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5592.342781943698, "num_env_steps_trained_throughput_per_sec": 5592.342781943698, "timesteps_total": 378000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 378000, "timers": {"training_iteration_time_ms": 3249.377, "sample_time_ms": 2899.437, "load_time_ms": 18.029, "load_throughput": 998410.055, "learn_time_ms": 320.337, "learn_throughput": 56190.781, "synch_weights_time_ms": 9.419}, "counters": {"num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "done": false, "episodes_total": 1474, "training_iteration": 21, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-46", "timestamp": 1698247966, "time_this_iter_s": 3.225682020187378, "time_total_s": 68.38931083679199, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.38931083679199, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 64.375, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 0.0003, "total_loss": 7.23085590645119, "policy_loss": -5.377842872231095e-05, "vf_loss": 7.230962559028908, "vf_explained_var": -1.7660635489004629e-07, "kl": 0.00010265785206060914, "entropy": 0.5300565196408166, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 581.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.406999999999861, "episode_len_mean": 231.64, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.900000000000006, 43.50000000000001, 40.70000000000002, 41.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 41.70000000000002, 45.3, 36.70000000000003, -50.00000000000044, 46.3, 12.899999999999743, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 25.099999999999916, -50.00000000000044, 33.70000000000004, 9.099999999999689, 17.69999999999981, 23.8999999999999, -50.00000000000044, 10.299999999999706, -50.00000000000044, 30.9, 44.10000000000001, -50.00000000000044, 32.50000000000002, 44.300000000000004, 46.699999999999996, 45.3, -50.00000000000044, 46.3, -50.00000000000044, 41.100000000000016, 41.70000000000002, 46.099999999999994, 29.69999999999998, -50.00000000000044, 47.5, -50.00000000000044, 46.9, 32.700000000000024, 39.10000000000002, 46.5, -50.00000000000044, 44.7, -50.00000000000044, 41.30000000000001, 26.499999999999936, 30.099999999999987, 41.90000000000001, 44.300000000000004, 47.1, 23.699999999999896, -50.00000000000044, 33.10000000000003, -50.00000000000044, 44.300000000000004, 29.299999999999976, 45.1, 37.70000000000003, -50.00000000000044, 47.7, 45.3, 28.09999999999996, 21.09999999999986, 29.49999999999998, 39.70000000000002, 46.9, 39.50000000000002, 46.3, 46.699999999999996, 34.30000000000004, -50.00000000000044, 29.899999999999984, 33.500000000000036, 41.30000000000001, 35.70000000000003, 27.099999999999945, 32.30000000000002, -50.00000000000044, 39.70000000000002, 42.70000000000001, -50.00000000000044], "episode_lengths": [500, 500, 52, 66, 94, 88, 500, 78, 500, 500, 500, 44, 42, 500, 500, 34, 60, 84, 48, 134, 500, 38, 372, 500, 38, 40, 500, 500, 74, 500, 250, 500, 164, 410, 324, 262, 500, 398, 500, 192, 60, 500, 176, 58, 34, 48, 500, 38, 500, 90, 84, 40, 204, 500, 26, 500, 32, 174, 110, 36, 500, 54, 500, 88, 236, 200, 82, 58, 30, 264, 500, 170, 500, 58, 208, 50, 124, 500, 24, 48, 220, 290, 206, 104, 32, 106, 38, 34, 158, 500, 202, 166, 88, 144, 230, 178, 500, 104, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38109524472446027, "mean_inference_ms": 1.2248769001206705, "mean_action_processing_ms": 0.14139550008952834, "mean_env_wait_ms": 0.08351940249301984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033987998962402344, "StateBufferConnector_ms": 0.0069959163665771484, "ViewRequirementAgentConnector_ms": 0.1210031509399414}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.406999999999861, "episode_len_mean": 231.64, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.900000000000006, 43.50000000000001, 40.70000000000002, 41.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 41.70000000000002, 45.3, 36.70000000000003, -50.00000000000044, 46.3, 12.899999999999743, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 25.099999999999916, -50.00000000000044, 33.70000000000004, 9.099999999999689, 17.69999999999981, 23.8999999999999, -50.00000000000044, 10.299999999999706, -50.00000000000044, 30.9, 44.10000000000001, -50.00000000000044, 32.50000000000002, 44.300000000000004, 46.699999999999996, 45.3, -50.00000000000044, 46.3, -50.00000000000044, 41.100000000000016, 41.70000000000002, 46.099999999999994, 29.69999999999998, -50.00000000000044, 47.5, -50.00000000000044, 46.9, 32.700000000000024, 39.10000000000002, 46.5, -50.00000000000044, 44.7, -50.00000000000044, 41.30000000000001, 26.499999999999936, 30.099999999999987, 41.90000000000001, 44.300000000000004, 47.1, 23.699999999999896, -50.00000000000044, 33.10000000000003, -50.00000000000044, 44.300000000000004, 29.299999999999976, 45.1, 37.70000000000003, -50.00000000000044, 47.7, 45.3, 28.09999999999996, 21.09999999999986, 29.49999999999998, 39.70000000000002, 46.9, 39.50000000000002, 46.3, 46.699999999999996, 34.30000000000004, -50.00000000000044, 29.899999999999984, 33.500000000000036, 41.30000000000001, 35.70000000000003, 27.099999999999945, 32.30000000000002, -50.00000000000044, 39.70000000000002, 42.70000000000001, -50.00000000000044], "episode_lengths": [500, 500, 52, 66, 94, 88, 500, 78, 500, 500, 500, 44, 42, 500, 500, 34, 60, 84, 48, 134, 500, 38, 372, 500, 38, 40, 500, 500, 74, 500, 250, 500, 164, 410, 324, 262, 500, 398, 500, 192, 60, 500, 176, 58, 34, 48, 500, 38, 500, 90, 84, 40, 204, 500, 26, 500, 32, 174, 110, 36, 500, 54, 500, 88, 236, 200, 82, 58, 30, 264, 500, 170, 500, 58, 208, 50, 124, 500, 24, 48, 220, 290, 206, 104, 32, 106, 38, 34, 158, 500, 202, 166, 88, 144, 230, 178, 500, 104, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38109524472446027, "mean_inference_ms": 1.2248769001206705, "mean_action_processing_ms": 0.14139550008952834, "mean_env_wait_ms": 0.08351940249301984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033987998962402344, "StateBufferConnector_ms": 0.0069959163665771484, "ViewRequirementAgentConnector_ms": 0.1210031509399414}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5603.673282587342, "num_env_steps_trained_throughput_per_sec": 5603.673282587342, "timesteps_total": 396000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 3245.667, "sample_time_ms": 2900.486, "load_time_ms": 17.245, "load_throughput": 1043803.498, "learn_time_ms": 316.012, "learn_throughput": 56959.896, "synch_weights_time_ms": 9.722}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1553, "training_iteration": 22, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-49", "timestamp": 1698247969, "time_this_iter_s": 3.217879295349121, "time_total_s": 71.60719013214111, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 71.60719013214111, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 57.04, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 0.0003, "total_loss": 6.021604926497848, "policy_loss": -0.0008464053066240416, "vf_loss": 6.022497848228172, "vf_explained_var": 4.635916815863715e-07, "kl": 0.0012781933074658507, "entropy": 0.465792049964269, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 608.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.3699999999998385, "episode_len_mean": 246.94, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, -50.00000000000044, 41.30000000000001, 26.499999999999936, 30.099999999999987, 41.90000000000001, 44.300000000000004, 47.1, 23.699999999999896, -50.00000000000044, 33.10000000000003, -50.00000000000044, 44.300000000000004, 29.299999999999976, 45.1, 37.70000000000003, -50.00000000000044, 47.7, 45.3, 28.09999999999996, 21.09999999999986, 29.49999999999998, 39.70000000000002, 46.9, 39.50000000000002, 46.3, 46.699999999999996, 34.30000000000004, -50.00000000000044, 29.899999999999984, 33.500000000000036, 41.30000000000001, 35.70000000000003, 27.099999999999945, 32.30000000000002, -50.00000000000044, 39.70000000000002, 42.70000000000001, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 44.300000000000004, 35.500000000000036, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.9, 46.9, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.9, -50.00000000000044, -50.00000000000044, 23.099999999999888, 39.70000000000002, -50.00000000000044, 21.499999999999865, 43.900000000000006, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 39.50000000000002, 47.5, 44.900000000000006, -50.00000000000044, 46.9, 45.9, 46.099999999999994, -50.00000000000044, 42.10000000000001, 34.900000000000034, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, 45.5, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.5, -50.00000000000044], "episode_lengths": [500, 54, 500, 88, 236, 200, 82, 58, 30, 264, 500, 170, 500, 58, 208, 50, 124, 500, 24, 48, 220, 290, 206, 104, 32, 106, 38, 34, 158, 500, 202, 166, 88, 144, 230, 178, 500, 104, 74, 500, 64, 48, 500, 58, 146, 500, 36, 500, 500, 42, 32, 184, 500, 500, 500, 46, 32, 500, 500, 270, 104, 500, 286, 62, 500, 144, 500, 500, 106, 26, 52, 500, 32, 42, 40, 500, 80, 152, 102, 500, 500, 500, 42, 36, 500, 40, 66, 500, 46, 30, 500, 500, 500, 500, 500, 500, 144, 500, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38091577132899945, "mean_inference_ms": 1.2252393599059093, "mean_action_processing_ms": 0.14174435470984187, "mean_env_wait_ms": 0.08324961673904374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026005268096923828, "StateBufferConnector_ms": 0.008996009826660156, "ViewRequirementAgentConnector_ms": 0.12700891494750977}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.3699999999998385, "episode_len_mean": 246.94, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, -50.00000000000044, 41.30000000000001, 26.499999999999936, 30.099999999999987, 41.90000000000001, 44.300000000000004, 47.1, 23.699999999999896, -50.00000000000044, 33.10000000000003, -50.00000000000044, 44.300000000000004, 29.299999999999976, 45.1, 37.70000000000003, -50.00000000000044, 47.7, 45.3, 28.09999999999996, 21.09999999999986, 29.49999999999998, 39.70000000000002, 46.9, 39.50000000000002, 46.3, 46.699999999999996, 34.30000000000004, -50.00000000000044, 29.899999999999984, 33.500000000000036, 41.30000000000001, 35.70000000000003, 27.099999999999945, 32.30000000000002, -50.00000000000044, 39.70000000000002, 42.70000000000001, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 44.300000000000004, 35.500000000000036, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.9, 46.9, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.9, -50.00000000000044, -50.00000000000044, 23.099999999999888, 39.70000000000002, -50.00000000000044, 21.499999999999865, 43.900000000000006, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 39.50000000000002, 47.5, 44.900000000000006, -50.00000000000044, 46.9, 45.9, 46.099999999999994, -50.00000000000044, 42.10000000000001, 34.900000000000034, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, 45.5, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.5, -50.00000000000044], "episode_lengths": [500, 54, 500, 88, 236, 200, 82, 58, 30, 264, 500, 170, 500, 58, 208, 50, 124, 500, 24, 48, 220, 290, 206, 104, 32, 106, 38, 34, 158, 500, 202, 166, 88, 144, 230, 178, 500, 104, 74, 500, 64, 48, 500, 58, 146, 500, 36, 500, 500, 42, 32, 184, 500, 500, 500, 46, 32, 500, 500, 270, 104, 500, 286, 62, 500, 144, 500, 500, 106, 26, 52, 500, 32, 42, 40, 500, 80, 152, 102, 500, 500, 500, 42, 36, 500, 40, 66, 500, 46, 30, 500, 500, 500, 500, 500, 500, 144, 500, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38091577132899945, "mean_inference_ms": 1.2252393599059093, "mean_action_processing_ms": 0.14174435470984187, "mean_env_wait_ms": 0.08324961673904374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026005268096923828, "StateBufferConnector_ms": 0.008996009826660156, "ViewRequirementAgentConnector_ms": 0.12700891494750977}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5433.819512124553, "num_env_steps_trained_throughput_per_sec": 5433.819512124553, "timesteps_total": 414000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 414000, "timers": {"training_iteration_time_ms": 3273.483, "sample_time_ms": 2905.281, "load_time_ms": 18.613, "load_throughput": 967070.741, "learn_time_ms": 337.691, "learn_throughput": 53303.179, "synch_weights_time_ms": 9.796}, "counters": {"num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "done": false, "episodes_total": 1613, "training_iteration": 23, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-52", "timestamp": 1698247972, "time_this_iter_s": 3.3185856342315674, "time_total_s": 74.92577576637268, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 74.92577576637268, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 66.9, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 0.0003, "total_loss": 6.607327266975686, "policy_loss": -0.00013932406350418373, "vf_loss": 6.607512968557852, "vf_explained_var": -1.1656019422743056e-06, "kl": 0.000333061892012699, "entropy": 0.4629861315091451, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 635.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4389999999998018, "episode_len_mean": 271.18, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.10000000000001, 34.900000000000034, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, 45.5, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.9, 16.8999999999998, 42.900000000000006, 35.30000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 41.70000000000002, 43.10000000000001, -50.00000000000044, 2.299999999999592, 45.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, 33.10000000000003, -50.00000000000044, 44.5, 47.5, 38.50000000000003, 47.7, 47.1, -50.00000000000044, 42.10000000000001, -50.00000000000044, 46.9, 46.9, -50.00000000000044, -50.00000000000044, 3.699999999999612, 45.9, 44.7, 32.50000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.100000000000016, -50.00000000000044, 47.7, 44.5, -50.00000000000044, 45.1, 43.50000000000001, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.099999999999675, 41.70000000000002, 41.70000000000002, 47.9, 29.299999999999976, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, 43.50000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, 39.300000000000026, 27.899999999999956], "episode_lengths": [500, 80, 152, 102, 500, 500, 500, 42, 36, 500, 40, 66, 500, 46, 30, 500, 500, 500, 500, 500, 500, 144, 500, 36, 500, 500, 32, 332, 72, 148, 500, 74, 500, 500, 154, 84, 70, 500, 478, 44, 500, 62, 500, 500, 500, 52, 32, 500, 170, 500, 56, 26, 116, 24, 30, 500, 80, 500, 32, 32, 500, 500, 464, 42, 54, 176, 500, 110, 500, 500, 500, 68, 90, 500, 24, 56, 500, 50, 66, 24, 500, 500, 500, 420, 84, 84, 22, 208, 500, 500, 40, 50, 66, 500, 66, 500, 50, 500, 108, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3805866926925799, "mean_inference_ms": 1.222402681238664, "mean_action_processing_ms": 0.14152761337872274, "mean_env_wait_ms": 0.08323831763959064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014767885208129883, "StateBufferConnector_ms": 0.004003047943115234, "ViewRequirementAgentConnector_ms": 0.12798166275024414}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4389999999998018, "episode_len_mean": 271.18, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.10000000000001, 34.900000000000034, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, 45.5, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.9, 16.8999999999998, 42.900000000000006, 35.30000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 41.70000000000002, 43.10000000000001, -50.00000000000044, 2.299999999999592, 45.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, 33.10000000000003, -50.00000000000044, 44.5, 47.5, 38.50000000000003, 47.7, 47.1, -50.00000000000044, 42.10000000000001, -50.00000000000044, 46.9, 46.9, -50.00000000000044, -50.00000000000044, 3.699999999999612, 45.9, 44.7, 32.50000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.100000000000016, -50.00000000000044, 47.7, 44.5, -50.00000000000044, 45.1, 43.50000000000001, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.099999999999675, 41.70000000000002, 41.70000000000002, 47.9, 29.299999999999976, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, 43.50000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, 39.300000000000026, 27.899999999999956], "episode_lengths": [500, 80, 152, 102, 500, 500, 500, 42, 36, 500, 40, 66, 500, 46, 30, 500, 500, 500, 500, 500, 500, 144, 500, 36, 500, 500, 32, 332, 72, 148, 500, 74, 500, 500, 154, 84, 70, 500, 478, 44, 500, 62, 500, 500, 500, 52, 32, 500, 170, 500, 56, 26, 116, 24, 30, 500, 80, 500, 32, 32, 500, 500, 464, 42, 54, 176, 500, 110, 500, 500, 500, 68, 90, 500, 24, 56, 500, 50, 66, 24, 500, 500, 500, 420, 84, 84, 22, 208, 500, 500, 40, 50, 66, 500, 66, 500, 50, 500, 108, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3805866926925799, "mean_inference_ms": 1.222402681238664, "mean_action_processing_ms": 0.14152761337872274, "mean_env_wait_ms": 0.08323831763959064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014767885208129883, "StateBufferConnector_ms": 0.004003047943115234, "ViewRequirementAgentConnector_ms": 0.12798166275024414}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5764.756610316511, "num_env_steps_trained_throughput_per_sec": 5764.756610316511, "timesteps_total": 432000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 3271.362, "sample_time_ms": 2909.429, "load_time_ms": 17.628, "load_throughput": 1021116.476, "learn_time_ms": 332.428, "learn_throughput": 54147.059, "synch_weights_time_ms": 9.776}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1688, "training_iteration": 24, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-56", "timestamp": 1698247976, "time_this_iter_s": 3.128215789794922, "time_total_s": 78.0539915561676, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 78.0539915561676, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 56.46, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 0.0003, "total_loss": 6.414300106189869, "policy_loss": -0.00039669552266045856, "vf_loss": 6.4147463727880405, "vf_explained_var": -6.843496251989294e-08, "kl": 0.0005749921919678618, "entropy": 0.4962572091155582, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 662.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8899999999998154, "episode_len_mean": 261.7, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 32.50000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.100000000000016, -50.00000000000044, 47.7, 44.5, -50.00000000000044, 45.1, 43.50000000000001, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.099999999999675, 41.70000000000002, 41.70000000000002, 47.9, 29.299999999999976, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, 43.50000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, 39.300000000000026, 27.899999999999956, 45.5, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 46.9, -50.00000000000044, 45.3, 46.3, 45.9, -50.00000000000044, 40.10000000000002, 41.90000000000001, -50.00000000000044, 11.699999999999726, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, 34.50000000000004, 43.900000000000006, 45.5, 45.5, 46.3, 32.90000000000003, 27.699999999999953, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 31.300000000000004, -50.00000000000044, 36.900000000000034, 39.70000000000002, -50.00000000000044, 44.900000000000006, 43.7, 41.500000000000014, 32.100000000000016, -50.00000000000044, 44.300000000000004, 38.300000000000026, 45.9, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7], "episode_lengths": [54, 176, 500, 110, 500, 500, 500, 68, 90, 500, 24, 56, 500, 50, 66, 24, 500, 500, 500, 420, 84, 84, 22, 208, 500, 500, 40, 50, 66, 500, 66, 500, 50, 500, 108, 222, 46, 500, 500, 44, 56, 32, 500, 48, 38, 42, 500, 100, 82, 500, 384, 500, 500, 132, 500, 72, 500, 500, 280, 500, 500, 476, 500, 156, 62, 46, 46, 38, 172, 224, 60, 500, 500, 46, 120, 500, 500, 500, 32, 500, 500, 52, 188, 500, 132, 104, 500, 52, 64, 86, 180, 500, 58, 118, 42, 78, 500, 500, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3803293804068631, "mean_inference_ms": 1.2229029378891376, "mean_action_processing_ms": 0.1413180390272293, "mean_env_wait_ms": 0.08311503813343364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100682258605957, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.09380292892456055}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8899999999998154, "episode_len_mean": 261.7, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 32.50000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.100000000000016, -50.00000000000044, 47.7, 44.5, -50.00000000000044, 45.1, 43.50000000000001, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.099999999999675, 41.70000000000002, 41.70000000000002, 47.9, 29.299999999999976, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, 43.50000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, 39.300000000000026, 27.899999999999956, 45.5, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 46.9, -50.00000000000044, 45.3, 46.3, 45.9, -50.00000000000044, 40.10000000000002, 41.90000000000001, -50.00000000000044, 11.699999999999726, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, 34.50000000000004, 43.900000000000006, 45.5, 45.5, 46.3, 32.90000000000003, 27.699999999999953, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 31.300000000000004, -50.00000000000044, 36.900000000000034, 39.70000000000002, -50.00000000000044, 44.900000000000006, 43.7, 41.500000000000014, 32.100000000000016, -50.00000000000044, 44.300000000000004, 38.300000000000026, 45.9, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7], "episode_lengths": [54, 176, 500, 110, 500, 500, 500, 68, 90, 500, 24, 56, 500, 50, 66, 24, 500, 500, 500, 420, 84, 84, 22, 208, 500, 500, 40, 50, 66, 500, 66, 500, 50, 500, 108, 222, 46, 500, 500, 44, 56, 32, 500, 48, 38, 42, 500, 100, 82, 500, 384, 500, 500, 132, 500, 72, 500, 500, 280, 500, 500, 476, 500, 156, 62, 46, 46, 38, 172, 224, 60, 500, 500, 46, 120, 500, 500, 500, 32, 500, 500, 52, 188, 500, 132, 104, 500, 52, 64, 86, 180, 500, 58, 118, 42, 78, 500, 500, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3803293804068631, "mean_inference_ms": 1.2229029378891376, "mean_action_processing_ms": 0.1413180390272293, "mean_env_wait_ms": 0.08311503813343364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100682258605957, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.09380292892456055}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5535.198848229516, "num_env_steps_trained_throughput_per_sec": 5535.198848229516, "timesteps_total": 450000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 3269.83, "sample_time_ms": 2910.101, "load_time_ms": 17.469, "load_throughput": 1030409.311, "learn_time_ms": 330.354, "learn_throughput": 54487.076, "synch_weights_time_ms": 9.805}, "counters": {"num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "episodes_total": 1752, "training_iteration": 25, "trial_id": "9f288_00012", "date": "2023-10-25_16-32-59", "timestamp": 1698247979, "time_this_iter_s": 3.2579147815704346, "time_total_s": 81.31190633773804, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 81.31190633773804, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 62.475, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 0.0003, "total_loss": 6.561434904734294, "policy_loss": 3.4173663826314386e-05, "vf_loss": 6.561453218813296, "vf_explained_var": -3.752885041413484e-07, "kl": 0.00012202710032627595, "entropy": 0.5239822533395555, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 689.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.460999999999812, "episode_len_mean": 270.98, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.90000000000003, 27.699999999999953, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 31.300000000000004, -50.00000000000044, 36.900000000000034, 39.70000000000002, -50.00000000000044, 44.900000000000006, 43.7, 41.500000000000014, 32.100000000000016, -50.00000000000044, 44.300000000000004, 38.300000000000026, 45.9, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.3, 44.5, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, 44.7, 40.30000000000002, 45.1, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 29.49999999999998, 17.499999999999808, 41.70000000000002, 43.50000000000001, 47.5, 46.699999999999996, 18.699999999999825, 46.099999999999994, 44.300000000000004, 44.300000000000004, -50.00000000000044, 44.7, 41.90000000000001, 44.7, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.900000000000006, 40.90000000000002, -50.00000000000044, 46.5, 38.300000000000026, 2.499999999999595, 36.70000000000003, 16.699999999999797, -50.00000000000044, 44.10000000000001, 43.10000000000001, 31.70000000000001, 45.9, 34.10000000000004, 46.099999999999994, -50.00000000000044, 44.7, 24.499999999999908, -50.00000000000044, -50.00000000000044], "episode_lengths": [172, 224, 60, 500, 500, 46, 120, 500, 500, 500, 32, 500, 500, 52, 188, 500, 132, 104, 500, 52, 64, 86, 180, 500, 58, 118, 42, 78, 500, 500, 500, 44, 500, 500, 28, 56, 500, 500, 210, 500, 500, 82, 500, 500, 500, 76, 500, 500, 60, 500, 500, 500, 240, 500, 54, 98, 50, 500, 500, 126, 500, 500, 206, 326, 84, 66, 26, 34, 314, 40, 58, 58, 500, 54, 82, 54, 500, 500, 146, 500, 62, 92, 500, 36, 118, 476, 134, 334, 500, 60, 70, 184, 42, 160, 40, 500, 54, 256, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37977358629359215, "mean_inference_ms": 1.2223042212279953, "mean_action_processing_ms": 0.14141426710818888, "mean_env_wait_ms": 0.08303181951929157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029727458953857422, "StateBufferConnector_ms": 0.003977060317993164, "ViewRequirementAgentConnector_ms": 0.09862208366394043}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.460999999999812, "episode_len_mean": 270.98, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.90000000000003, 27.699999999999953, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 31.300000000000004, -50.00000000000044, 36.900000000000034, 39.70000000000002, -50.00000000000044, 44.900000000000006, 43.7, 41.500000000000014, 32.100000000000016, -50.00000000000044, 44.300000000000004, 38.300000000000026, 45.9, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.3, 44.5, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, 44.7, 40.30000000000002, 45.1, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 29.49999999999998, 17.499999999999808, 41.70000000000002, 43.50000000000001, 47.5, 46.699999999999996, 18.699999999999825, 46.099999999999994, 44.300000000000004, 44.300000000000004, -50.00000000000044, 44.7, 41.90000000000001, 44.7, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.900000000000006, 40.90000000000002, -50.00000000000044, 46.5, 38.300000000000026, 2.499999999999595, 36.70000000000003, 16.699999999999797, -50.00000000000044, 44.10000000000001, 43.10000000000001, 31.70000000000001, 45.9, 34.10000000000004, 46.099999999999994, -50.00000000000044, 44.7, 24.499999999999908, -50.00000000000044, -50.00000000000044], "episode_lengths": [172, 224, 60, 500, 500, 46, 120, 500, 500, 500, 32, 500, 500, 52, 188, 500, 132, 104, 500, 52, 64, 86, 180, 500, 58, 118, 42, 78, 500, 500, 500, 44, 500, 500, 28, 56, 500, 500, 210, 500, 500, 82, 500, 500, 500, 76, 500, 500, 60, 500, 500, 500, 240, 500, 54, 98, 50, 500, 500, 126, 500, 500, 206, 326, 84, 66, 26, 34, 314, 40, 58, 58, 500, 54, 82, 54, 500, 500, 146, 500, 62, 92, 500, 36, 118, 476, 134, 334, 500, 60, 70, 184, 42, 160, 40, 500, 54, 256, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37977358629359215, "mean_inference_ms": 1.2223042212279953, "mean_action_processing_ms": 0.14141426710818888, "mean_env_wait_ms": 0.08303181951929157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029727458953857422, "StateBufferConnector_ms": 0.003977060317993164, "ViewRequirementAgentConnector_ms": 0.09862208366394043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5660.734593007672, "num_env_steps_trained_throughput_per_sec": 5660.734593007672, "timesteps_total": 468000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 3266.805, "sample_time_ms": 2904.931, "load_time_ms": 16.816, "load_throughput": 1070413.931, "learn_time_ms": 333.297, "learn_throughput": 54005.853, "synch_weights_time_ms": 9.66}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1820, "training_iteration": 26, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-02", "timestamp": 1698247982, "time_this_iter_s": 3.1862637996673584, "time_total_s": 84.4981701374054, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 84.4981701374054, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 57.17999999999999, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 0.0003, "total_loss": 6.81198407985546, "policy_loss": -0.00021289633931937042, "vf_loss": 6.81224881278144, "vf_explained_var": -1.9404623243543838e-06, "kl": 0.0005387927079879438, "entropy": 0.5190927618079715, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 716.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.620999999999837, "episode_len_mean": 249.46, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, 44.300000000000004, -50.00000000000044, 44.7, 41.90000000000001, 44.7, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.900000000000006, 40.90000000000002, -50.00000000000044, 46.5, 38.300000000000026, 2.499999999999595, 36.70000000000003, 16.699999999999797, -50.00000000000044, 44.10000000000001, 43.10000000000001, 31.70000000000001, 45.9, 34.10000000000004, 46.099999999999994, -50.00000000000044, 44.7, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.5, 43.7, 44.5, 37.10000000000003, 35.30000000000004, 45.7, -50.00000000000044, 44.10000000000001, 27.299999999999947, -50.00000000000044, 23.099999999999888, 45.3, 9.699999999999697, -50.00000000000044, 45.5, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 28.89999999999997, 46.3, 39.70000000000002, 42.10000000000001, 42.30000000000001, 31.300000000000004, 46.099999999999994, 26.499999999999936, 46.099999999999994, 40.90000000000002, 44.5, 9.499999999999694, 40.10000000000002, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.5, 44.900000000000006, 35.10000000000004, 34.50000000000004, 46.099999999999994, 42.900000000000006, -50.00000000000044, 13.899999999999757, 47.3, -50.00000000000044, 40.500000000000014, 35.10000000000004, 32.100000000000016, 16.09999999999979, -50.00000000000044, -50.00000000000044, 45.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [58, 58, 500, 54, 82, 54, 500, 500, 146, 500, 62, 92, 500, 36, 118, 476, 134, 334, 500, 60, 70, 184, 42, 160, 40, 500, 54, 256, 500, 500, 500, 500, 500, 64, 46, 64, 56, 130, 148, 44, 500, 60, 228, 500, 270, 48, 404, 500, 46, 168, 500, 500, 500, 86, 212, 38, 104, 80, 78, 188, 40, 236, 40, 92, 56, 406, 100, 500, 362, 500, 500, 500, 58, 500, 56, 52, 150, 156, 40, 72, 500, 362, 28, 500, 96, 150, 180, 340, 500, 500, 48, 38, 500, 500, 500, 106, 50, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37972251761163633, "mean_inference_ms": 1.2197931645015674, "mean_action_processing_ms": 0.14089944073577573, "mean_env_wait_ms": 0.08308486012428233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022011756896972656, "StateBufferConnector_ms": 0.0019991397857666016, "ViewRequirementAgentConnector_ms": 0.10455083847045898}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.620999999999837, "episode_len_mean": 249.46, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, 44.300000000000004, -50.00000000000044, 44.7, 41.90000000000001, 44.7, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.900000000000006, 40.90000000000002, -50.00000000000044, 46.5, 38.300000000000026, 2.499999999999595, 36.70000000000003, 16.699999999999797, -50.00000000000044, 44.10000000000001, 43.10000000000001, 31.70000000000001, 45.9, 34.10000000000004, 46.099999999999994, -50.00000000000044, 44.7, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.5, 43.7, 44.5, 37.10000000000003, 35.30000000000004, 45.7, -50.00000000000044, 44.10000000000001, 27.299999999999947, -50.00000000000044, 23.099999999999888, 45.3, 9.699999999999697, -50.00000000000044, 45.5, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 28.89999999999997, 46.3, 39.70000000000002, 42.10000000000001, 42.30000000000001, 31.300000000000004, 46.099999999999994, 26.499999999999936, 46.099999999999994, 40.90000000000002, 44.5, 9.499999999999694, 40.10000000000002, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.5, 44.900000000000006, 35.10000000000004, 34.50000000000004, 46.099999999999994, 42.900000000000006, -50.00000000000044, 13.899999999999757, 47.3, -50.00000000000044, 40.500000000000014, 35.10000000000004, 32.100000000000016, 16.09999999999979, -50.00000000000044, -50.00000000000044, 45.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [58, 58, 500, 54, 82, 54, 500, 500, 146, 500, 62, 92, 500, 36, 118, 476, 134, 334, 500, 60, 70, 184, 42, 160, 40, 500, 54, 256, 500, 500, 500, 500, 500, 64, 46, 64, 56, 130, 148, 44, 500, 60, 228, 500, 270, 48, 404, 500, 46, 168, 500, 500, 500, 86, 212, 38, 104, 80, 78, 188, 40, 236, 40, 92, 56, 406, 100, 500, 362, 500, 500, 500, 58, 500, 56, 52, 150, 156, 40, 72, 500, 362, 28, 500, 96, 150, 180, 340, 500, 500, 48, 38, 500, 500, 500, 106, 50, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37972251761163633, "mean_inference_ms": 1.2197931645015674, "mean_action_processing_ms": 0.14089944073577573, "mean_env_wait_ms": 0.08308486012428233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022011756896972656, "StateBufferConnector_ms": 0.0019991397857666016, "ViewRequirementAgentConnector_ms": 0.10455083847045898}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5595.206252137181, "num_env_steps_trained_throughput_per_sec": 5595.206252137181, "timesteps_total": 486000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 486000, "timers": {"training_iteration_time_ms": 3269.315, "sample_time_ms": 2902.616, "load_time_ms": 17.012, "load_throughput": 1058073.681, "learn_time_ms": 337.987, "learn_throughput": 53256.423, "synch_weights_time_ms": 9.699}, "counters": {"num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "done": false, "episodes_total": 1890, "training_iteration": 27, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-05", "timestamp": 1698247985, "time_this_iter_s": 3.22704815864563, "time_total_s": 87.72521829605103, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 87.72521829605103, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 56.36, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 0.0003, "total_loss": 6.970153243453415, "policy_loss": -0.00047947880294587876, "vf_loss": 6.970687071482341, "vf_explained_var": -2.635849846733941e-06, "kl": 0.0008581036810337263, "entropy": 0.5438435883433731, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.4169999999998355, "episode_len_mean": 251.48, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 35.10000000000004, 34.50000000000004, 46.099999999999994, 42.900000000000006, -50.00000000000044, 13.899999999999757, 47.3, -50.00000000000044, 40.500000000000014, 35.10000000000004, 32.100000000000016, 16.09999999999979, -50.00000000000044, -50.00000000000044, 45.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.5, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, 42.30000000000001, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.30000000000001, 45.5, -50.00000000000044, 46.3, 40.30000000000002, 46.099999999999994, 19.499999999999837, 41.70000000000002, 36.70000000000003, 10.299999999999706, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.7, 36.10000000000004, 43.50000000000001, 34.30000000000004, 38.700000000000024, 33.90000000000004, 44.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 28.499999999999964, 45.3, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.1, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 8.299999999999677, 38.90000000000002, 28.499999999999964, 45.9, -50.00000000000044, 24.69999999999991, 39.70000000000002, 28.89999999999997, 37.50000000000003, 42.10000000000001, 17.69999999999981, -50.00000000000044, 43.50000000000001, 46.5, 46.3, -50.00000000000044, 32.30000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.5, 44.7, 44.900000000000006], "episode_lengths": [52, 150, 156, 40, 72, 500, 362, 28, 500, 96, 150, 180, 340, 500, 500, 48, 38, 500, 500, 500, 106, 50, 500, 500, 500, 500, 46, 500, 500, 500, 88, 500, 56, 500, 56, 500, 80, 78, 500, 82, 500, 68, 46, 500, 38, 98, 40, 306, 84, 134, 398, 228, 500, 500, 500, 56, 44, 140, 66, 158, 114, 162, 60, 54, 500, 500, 216, 48, 500, 66, 500, 50, 84, 500, 500, 98, 500, 418, 112, 216, 42, 500, 254, 104, 212, 126, 80, 324, 500, 66, 36, 38, 500, 178, 500, 70, 500, 56, 54, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813450603059721, "mean_inference_ms": 1.219787960504077, "mean_action_processing_ms": 0.141082157116136, "mean_env_wait_ms": 0.08279409769870286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017746925354003906, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.11562299728393555}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.4169999999998355, "episode_len_mean": 251.48, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 35.10000000000004, 34.50000000000004, 46.099999999999994, 42.900000000000006, -50.00000000000044, 13.899999999999757, 47.3, -50.00000000000044, 40.500000000000014, 35.10000000000004, 32.100000000000016, 16.09999999999979, -50.00000000000044, -50.00000000000044, 45.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.5, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, 42.30000000000001, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.30000000000001, 45.5, -50.00000000000044, 46.3, 40.30000000000002, 46.099999999999994, 19.499999999999837, 41.70000000000002, 36.70000000000003, 10.299999999999706, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.7, 36.10000000000004, 43.50000000000001, 34.30000000000004, 38.700000000000024, 33.90000000000004, 44.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 28.499999999999964, 45.3, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.1, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 8.299999999999677, 38.90000000000002, 28.499999999999964, 45.9, -50.00000000000044, 24.69999999999991, 39.70000000000002, 28.89999999999997, 37.50000000000003, 42.10000000000001, 17.69999999999981, -50.00000000000044, 43.50000000000001, 46.5, 46.3, -50.00000000000044, 32.30000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.5, 44.7, 44.900000000000006], "episode_lengths": [52, 150, 156, 40, 72, 500, 362, 28, 500, 96, 150, 180, 340, 500, 500, 48, 38, 500, 500, 500, 106, 50, 500, 500, 500, 500, 46, 500, 500, 500, 88, 500, 56, 500, 56, 500, 80, 78, 500, 82, 500, 68, 46, 500, 38, 98, 40, 306, 84, 134, 398, 228, 500, 500, 500, 56, 44, 140, 66, 158, 114, 162, 60, 54, 500, 500, 216, 48, 500, 66, 500, 50, 84, 500, 500, 98, 500, 418, 112, 216, 42, 500, 254, 104, 212, 126, 80, 324, 500, 66, 36, 38, 500, 178, 500, 70, 500, 56, 54, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813450603059721, "mean_inference_ms": 1.219787960504077, "mean_action_processing_ms": 0.141082157116136, "mean_env_wait_ms": 0.08279409769870286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017746925354003906, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.11562299728393555}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5327.986443454904, "num_env_steps_trained_throughput_per_sec": 5327.986443454904, "timesteps_total": 504000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 3254.884, "sample_time_ms": 2885.716, "load_time_ms": 17.291, "load_throughput": 1040975.434, "learn_time_ms": 340.143, "learn_throughput": 52918.877, "synch_weights_time_ms": 9.632}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1965, "training_iteration": 28, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-09", "timestamp": 1698247989, "time_this_iter_s": 3.3843870162963867, "time_total_s": 91.10960531234741, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 91.10960531234741, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 69.025, "ram_util_percent": 26.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 0.0003, "total_loss": 7.046237256791857, "policy_loss": -0.00030634134869884564, "vf_loss": 7.046602425751863, "vf_explained_var": -1.4746630633318866e-06, "kl": 0.0012456927518238788, "entropy": 0.5886306254952042, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 770.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.80299999999988, "episode_len_mean": 207.72, "episode_media": {}, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.50000000000003, 42.10000000000001, 17.69999999999981, -50.00000000000044, 43.50000000000001, 46.5, 46.3, -50.00000000000044, 32.30000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.5, 44.7, 44.900000000000006, 38.700000000000024, 43.10000000000001, 44.5, -50.00000000000044, 37.90000000000003, 22.299999999999876, -50.00000000000044, 46.3, -50.00000000000044, 37.10000000000003, 34.50000000000004, 31.1, -50.00000000000044, 44.5, 44.7, 42.10000000000001, 39.10000000000002, 43.900000000000006, 45.7, 22.299999999999876, 25.899999999999928, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, 45.9, 41.30000000000001, 44.300000000000004, 43.50000000000001, -50.00000000000044, 46.5, 45.7, 41.30000000000001, 38.90000000000002, 37.300000000000026, 42.500000000000014, 43.50000000000001, 27.49999999999995, 27.899999999999956, 34.10000000000004, 43.7, -50.00000000000044, 44.900000000000006, 42.70000000000001, 26.299999999999933, -50.00000000000044, 39.300000000000026, 32.100000000000016, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 37.70000000000003, 45.9, -50.00000000000044, 45.1, 46.099999999999994, 44.300000000000004, -50.00000000000044, 38.700000000000024, 45.5, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 41.30000000000001, 42.500000000000014, 7.699999999999669, 40.10000000000002, 39.90000000000002, 45.1, -50.00000000000044, 44.7, 16.29999999999979, -50.00000000000044, 42.30000000000001, 13.299999999999748, 36.10000000000004, 43.7, 40.10000000000002, -50.00000000000044, 38.10000000000002], "episode_lengths": [126, 80, 324, 500, 66, 36, 38, 500, 178, 500, 70, 500, 56, 54, 52, 114, 70, 56, 500, 122, 278, 500, 38, 500, 130, 156, 190, 500, 56, 54, 80, 110, 62, 44, 278, 242, 500, 106, 500, 48, 500, 60, 42, 88, 58, 66, 500, 36, 44, 88, 112, 128, 76, 66, 226, 222, 160, 64, 500, 52, 74, 238, 500, 108, 180, 500, 38, 500, 500, 124, 42, 500, 50, 40, 58, 500, 114, 46, 500, 100, 500, 56, 500, 88, 76, 424, 100, 102, 50, 500, 54, 338, 500, 78, 368, 140, 64, 100, 500, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38069113494850776, "mean_inference_ms": 1.2198365465828631, "mean_action_processing_ms": 0.14114460785534175, "mean_env_wait_ms": 0.08314399323441363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018995285034179688, "StateBufferConnector_ms": 0.003996133804321289, "ViewRequirementAgentConnector_ms": 0.11083483695983887}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.80299999999988, "episode_len_mean": 207.72, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.50000000000003, 42.10000000000001, 17.69999999999981, -50.00000000000044, 43.50000000000001, 46.5, 46.3, -50.00000000000044, 32.30000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.5, 44.7, 44.900000000000006, 38.700000000000024, 43.10000000000001, 44.5, -50.00000000000044, 37.90000000000003, 22.299999999999876, -50.00000000000044, 46.3, -50.00000000000044, 37.10000000000003, 34.50000000000004, 31.1, -50.00000000000044, 44.5, 44.7, 42.10000000000001, 39.10000000000002, 43.900000000000006, 45.7, 22.299999999999876, 25.899999999999928, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, 45.9, 41.30000000000001, 44.300000000000004, 43.50000000000001, -50.00000000000044, 46.5, 45.7, 41.30000000000001, 38.90000000000002, 37.300000000000026, 42.500000000000014, 43.50000000000001, 27.49999999999995, 27.899999999999956, 34.10000000000004, 43.7, -50.00000000000044, 44.900000000000006, 42.70000000000001, 26.299999999999933, -50.00000000000044, 39.300000000000026, 32.100000000000016, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 37.70000000000003, 45.9, -50.00000000000044, 45.1, 46.099999999999994, 44.300000000000004, -50.00000000000044, 38.700000000000024, 45.5, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 41.30000000000001, 42.500000000000014, 7.699999999999669, 40.10000000000002, 39.90000000000002, 45.1, -50.00000000000044, 44.7, 16.29999999999979, -50.00000000000044, 42.30000000000001, 13.299999999999748, 36.10000000000004, 43.7, 40.10000000000002, -50.00000000000044, 38.10000000000002], "episode_lengths": [126, 80, 324, 500, 66, 36, 38, 500, 178, 500, 70, 500, 56, 54, 52, 114, 70, 56, 500, 122, 278, 500, 38, 500, 130, 156, 190, 500, 56, 54, 80, 110, 62, 44, 278, 242, 500, 106, 500, 48, 500, 60, 42, 88, 58, 66, 500, 36, 44, 88, 112, 128, 76, 66, 226, 222, 160, 64, 500, 52, 74, 238, 500, 108, 180, 500, 38, 500, 500, 124, 42, 500, 50, 40, 58, 500, 114, 46, 500, 100, 500, 56, 500, 88, 76, 424, 100, 102, 50, 500, 54, 338, 500, 78, 368, 140, 64, 100, 500, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38069113494850776, "mean_inference_ms": 1.2198365465828631, "mean_action_processing_ms": 0.14114460785534175, "mean_env_wait_ms": 0.08314399323441363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018995285034179688, "StateBufferConnector_ms": 0.003996133804321289, "ViewRequirementAgentConnector_ms": 0.11083483695983887}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5650.847655530756, "num_env_steps_trained_throughput_per_sec": 5650.847655530756, "timesteps_total": 522000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 522000, "timers": {"training_iteration_time_ms": 3213.055, "sample_time_ms": 2833.628, "load_time_ms": 16.927, "load_throughput": 1063383.617, "learn_time_ms": 350.834, "learn_throughput": 51306.311, "synch_weights_time_ms": 9.56}, "counters": {"num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "done": false, "episodes_total": 2050, "training_iteration": 29, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-12", "timestamp": 1698247992, "time_this_iter_s": 3.1903622150421143, "time_total_s": 94.29996752738953, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 94.29996752738953, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 55.620000000000005, "ram_util_percent": 26.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 0.0003, "total_loss": 6.66915460869118, "policy_loss": -0.00028821894967997515, "vf_loss": 6.669500333291513, "vf_explained_var": -8.918620921947338e-07, "kl": 0.0006735863925213278, "entropy": 0.5754857968401026, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 797.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.425999999999835, "episode_len_mean": 256.4, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.70000000000003, 45.9, -50.00000000000044, 45.1, 46.099999999999994, 44.300000000000004, -50.00000000000044, 38.700000000000024, 45.5, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 41.30000000000001, 42.500000000000014, 7.699999999999669, 40.10000000000002, 39.90000000000002, 45.1, -50.00000000000044, 44.7, 16.29999999999979, -50.00000000000044, 42.30000000000001, 13.299999999999748, 36.10000000000004, 43.7, 40.10000000000002, -50.00000000000044, 38.10000000000002, 7.299999999999663, 20.899999999999856, 32.100000000000016, 42.500000000000014, 42.70000000000001, 28.699999999999967, -50.00000000000044, 42.30000000000001, 45.9, -50.00000000000044, 43.50000000000001, 33.500000000000036, -50.00000000000044, 31.500000000000007, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 43.10000000000001, 42.70000000000001, 18.699999999999825, 30.499999999999993, -50.00000000000044, 42.70000000000001, 46.9, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.7, 28.09999999999996, 40.500000000000014, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 8.299999999999677, 43.50000000000001, 35.900000000000034, 34.900000000000034, 46.099999999999994, 43.50000000000001, 46.699999999999996, -50.00000000000044, 45.7, 30.699999999999996, 43.50000000000001, -50.00000000000044, 43.50000000000001, 23.699999999999896, 35.30000000000004, 42.30000000000001], "episode_lengths": [500, 500, 124, 42, 500, 50, 40, 58, 500, 114, 46, 500, 100, 500, 56, 500, 88, 76, 424, 100, 102, 50, 500, 54, 338, 500, 78, 368, 140, 64, 100, 500, 120, 428, 292, 180, 76, 74, 214, 500, 78, 42, 500, 66, 166, 500, 186, 110, 500, 500, 500, 500, 500, 308, 500, 500, 500, 110, 70, 74, 314, 196, 500, 74, 32, 40, 500, 44, 500, 500, 500, 146, 54, 220, 96, 500, 62, 500, 500, 92, 500, 286, 500, 500, 418, 66, 142, 152, 40, 66, 34, 500, 44, 194, 66, 500, 66, 264, 148, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38050245065804317, "mean_inference_ms": 1.221042528557564, "mean_action_processing_ms": 0.14131515129088737, "mean_env_wait_ms": 0.08307072129091246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03101205825805664, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.10800719261169434}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.425999999999835, "episode_len_mean": 256.4, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.70000000000003, 45.9, -50.00000000000044, 45.1, 46.099999999999994, 44.300000000000004, -50.00000000000044, 38.700000000000024, 45.5, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 41.30000000000001, 42.500000000000014, 7.699999999999669, 40.10000000000002, 39.90000000000002, 45.1, -50.00000000000044, 44.7, 16.29999999999979, -50.00000000000044, 42.30000000000001, 13.299999999999748, 36.10000000000004, 43.7, 40.10000000000002, -50.00000000000044, 38.10000000000002, 7.299999999999663, 20.899999999999856, 32.100000000000016, 42.500000000000014, 42.70000000000001, 28.699999999999967, -50.00000000000044, 42.30000000000001, 45.9, -50.00000000000044, 43.50000000000001, 33.500000000000036, -50.00000000000044, 31.500000000000007, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 43.10000000000001, 42.70000000000001, 18.699999999999825, 30.499999999999993, -50.00000000000044, 42.70000000000001, 46.9, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.7, 28.09999999999996, 40.500000000000014, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 8.299999999999677, 43.50000000000001, 35.900000000000034, 34.900000000000034, 46.099999999999994, 43.50000000000001, 46.699999999999996, -50.00000000000044, 45.7, 30.699999999999996, 43.50000000000001, -50.00000000000044, 43.50000000000001, 23.699999999999896, 35.30000000000004, 42.30000000000001], "episode_lengths": [500, 500, 124, 42, 500, 50, 40, 58, 500, 114, 46, 500, 100, 500, 56, 500, 88, 76, 424, 100, 102, 50, 500, 54, 338, 500, 78, 368, 140, 64, 100, 500, 120, 428, 292, 180, 76, 74, 214, 500, 78, 42, 500, 66, 166, 500, 186, 110, 500, 500, 500, 500, 500, 308, 500, 500, 500, 110, 70, 74, 314, 196, 500, 74, 32, 40, 500, 44, 500, 500, 500, 146, 54, 220, 96, 500, 62, 500, 500, 92, 500, 286, 500, 500, 418, 66, 142, 152, 40, 66, 34, 500, 44, 194, 66, 500, 66, 264, 148, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38050245065804317, "mean_inference_ms": 1.221042528557564, "mean_action_processing_ms": 0.14131515129088737, "mean_env_wait_ms": 0.08307072129091246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03101205825805664, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.10800719261169434}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5369.371963002864, "num_env_steps_trained_throughput_per_sec": 5369.371963002864, "timesteps_total": 540000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 3243.073, "sample_time_ms": 2839.687, "load_time_ms": 18.187, "load_throughput": 989690.774, "learn_time_ms": 373.707, "learn_throughput": 48166.014, "synch_weights_time_ms": 9.585}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2117, "training_iteration": 30, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-15", "timestamp": 1698247995, "time_this_iter_s": 3.3593437671661377, "time_total_s": 97.65931129455566, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 97.65931129455566, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 64.425, "ram_util_percent": 26.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 0.0003, "total_loss": 7.086797025468615, "policy_loss": -0.00021181283173737702, "vf_loss": 7.087067003603335, "vf_explained_var": -9.823728490758825e-07, "kl": 0.0004418276169236311, "entropy": 0.5825308980765166, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 824.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.085999999999858, "episode_len_mean": 239.84, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 8.299999999999677, 43.50000000000001, 35.900000000000034, 34.900000000000034, 46.099999999999994, 43.50000000000001, 46.699999999999996, -50.00000000000044, 45.7, 30.699999999999996, 43.50000000000001, -50.00000000000044, 43.50000000000001, 23.699999999999896, 35.30000000000004, 42.30000000000001, 43.30000000000001, 41.90000000000001, 38.10000000000002, -50.00000000000044, 30.699999999999996, 28.09999999999996, 33.70000000000004, -50.00000000000044, 6.8999999999996575, 12.899999999999743, 44.900000000000006, 30.9, 38.90000000000002, -50.00000000000044, 34.70000000000004, 40.90000000000002, 19.09999999999983, 28.29999999999996, 46.3, -50.00000000000044, 18.29999999999982, -50.00000000000044, 41.70000000000002, 46.099999999999994, 40.500000000000014, 42.10000000000001, 41.100000000000016, 41.500000000000014, 34.50000000000004, 42.70000000000001, 25.899999999999928, 40.70000000000002, -50.00000000000044, 44.5, 39.70000000000002, 45.1, -50.00000000000044, 45.5, -50.00000000000044, 45.1, 38.10000000000002, 33.90000000000004, 42.500000000000014, 45.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, 44.5, 38.300000000000026, 43.50000000000001, 39.70000000000002, 45.7, -50.00000000000044, 45.1, 42.900000000000006, 15.099999999999774, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 42.10000000000001, 42.30000000000001, 44.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034], "episode_lengths": [500, 500, 92, 500, 286, 500, 500, 418, 66, 142, 152, 40, 66, 34, 500, 44, 194, 66, 500, 66, 264, 148, 78, 68, 82, 120, 500, 194, 220, 164, 500, 432, 372, 52, 192, 112, 500, 154, 92, 310, 218, 38, 500, 318, 500, 84, 40, 96, 80, 90, 86, 156, 74, 242, 94, 500, 56, 104, 50, 500, 46, 500, 50, 120, 162, 76, 46, 500, 70, 500, 198, 500, 56, 118, 66, 104, 44, 500, 50, 72, 350, 126, 500, 500, 500, 138, 500, 80, 78, 54, 500, 134, 500, 500, 500, 68, 500, 500, 500, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38037478630321586, "mean_inference_ms": 1.2187001498372192, "mean_action_processing_ms": 0.14100285869819287, "mean_env_wait_ms": 0.08310707027805046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027005910873413086, "StateBufferConnector_ms": 0.002000570297241211, "ViewRequirementAgentConnector_ms": 0.08685421943664551}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.085999999999858, "episode_len_mean": 239.84, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 8.299999999999677, 43.50000000000001, 35.900000000000034, 34.900000000000034, 46.099999999999994, 43.50000000000001, 46.699999999999996, -50.00000000000044, 45.7, 30.699999999999996, 43.50000000000001, -50.00000000000044, 43.50000000000001, 23.699999999999896, 35.30000000000004, 42.30000000000001, 43.30000000000001, 41.90000000000001, 38.10000000000002, -50.00000000000044, 30.699999999999996, 28.09999999999996, 33.70000000000004, -50.00000000000044, 6.8999999999996575, 12.899999999999743, 44.900000000000006, 30.9, 38.90000000000002, -50.00000000000044, 34.70000000000004, 40.90000000000002, 19.09999999999983, 28.29999999999996, 46.3, -50.00000000000044, 18.29999999999982, -50.00000000000044, 41.70000000000002, 46.099999999999994, 40.500000000000014, 42.10000000000001, 41.100000000000016, 41.500000000000014, 34.50000000000004, 42.70000000000001, 25.899999999999928, 40.70000000000002, -50.00000000000044, 44.5, 39.70000000000002, 45.1, -50.00000000000044, 45.5, -50.00000000000044, 45.1, 38.10000000000002, 33.90000000000004, 42.500000000000014, 45.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, 44.5, 38.300000000000026, 43.50000000000001, 39.70000000000002, 45.7, -50.00000000000044, 45.1, 42.900000000000006, 15.099999999999774, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 42.10000000000001, 42.30000000000001, 44.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034], "episode_lengths": [500, 500, 92, 500, 286, 500, 500, 418, 66, 142, 152, 40, 66, 34, 500, 44, 194, 66, 500, 66, 264, 148, 78, 68, 82, 120, 500, 194, 220, 164, 500, 432, 372, 52, 192, 112, 500, 154, 92, 310, 218, 38, 500, 318, 500, 84, 40, 96, 80, 90, 86, 156, 74, 242, 94, 500, 56, 104, 50, 500, 46, 500, 50, 120, 162, 76, 46, 500, 70, 500, 198, 500, 56, 118, 66, 104, 44, 500, 50, 72, 350, 126, 500, 500, 500, 138, 500, 80, 78, 54, 500, 134, 500, 500, 500, 68, 500, 500, 500, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38037478630321586, "mean_inference_ms": 1.2187001498372192, "mean_action_processing_ms": 0.14100285869819287, "mean_env_wait_ms": 0.08310707027805046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027005910873413086, "StateBufferConnector_ms": 0.002000570297241211, "ViewRequirementAgentConnector_ms": 0.08685421943664551}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5804.771389684199, "num_env_steps_trained_throughput_per_sec": 5804.771389684199, "timesteps_total": 558000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 558000, "timers": {"training_iteration_time_ms": 3231.294, "sample_time_ms": 2844.166, "load_time_ms": 16.633, "load_throughput": 1082174.513, "learn_time_ms": 358.983, "learn_throughput": 50141.708, "synch_weights_time_ms": 9.606}, "counters": {"num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "done": false, "episodes_total": 2194, "training_iteration": 31, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-18", "timestamp": 1698247998, "time_this_iter_s": 3.107964038848877, "time_total_s": 100.76727533340454, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 100.76727533340454, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 55.4, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 0.0003, "total_loss": 6.895705134780319, "policy_loss": 0.0001334054050622163, "vf_loss": 6.895628876156277, "vf_explained_var": -1.1192427741156684e-06, "kl": 0.000167728128622272, "entropy": 0.5718787676758237, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 851.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7729999999998127, "episode_len_mean": 277.88, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 45.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, 44.5, 38.300000000000026, 43.50000000000001, 39.70000000000002, 45.7, -50.00000000000044, 45.1, 42.900000000000006, 15.099999999999774, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 42.10000000000001, 42.30000000000001, 44.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 34.10000000000004, 42.30000000000001, 40.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 45.5, 40.10000000000002, 44.900000000000006, 26.89999999999994, 8.299999999999677, -50.00000000000044, 46.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.5, 27.49999999999995, 36.900000000000034, -50.00000000000044, 21.09999999999986, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 32.30000000000002, -50.00000000000044, 25.499999999999922, 42.70000000000001, 39.50000000000002, 20.299999999999848, 43.900000000000006, -50.00000000000044, 25.699999999999925, 44.5, -50.00000000000044, 38.700000000000024, 32.100000000000016, 42.900000000000006, 11.899999999999729, 45.5, 44.300000000000004, -50.00000000000044, 21.89999999999987, -50.00000000000044, 41.70000000000002, 35.70000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 39.10000000000002, 43.10000000000001, 12.499999999999737], "episode_lengths": [76, 46, 500, 70, 500, 198, 500, 56, 118, 66, 104, 44, 500, 50, 72, 350, 126, 500, 500, 500, 138, 500, 80, 78, 54, 500, 134, 500, 500, 500, 68, 500, 500, 500, 132, 500, 500, 500, 140, 500, 500, 492, 160, 78, 100, 500, 58, 500, 48, 46, 100, 52, 232, 418, 500, 36, 64, 500, 500, 500, 500, 74, 500, 36, 226, 132, 500, 290, 500, 500, 140, 500, 178, 500, 246, 74, 106, 298, 62, 500, 244, 56, 500, 114, 180, 72, 382, 46, 58, 500, 282, 500, 84, 144, 500, 124, 500, 110, 70, 376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37993988390109196, "mean_inference_ms": 1.219080314850724, "mean_action_processing_ms": 0.14124285591744346, "mean_env_wait_ms": 0.08310572798335414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0269925594329834, "StateBufferConnector_ms": 0.005997180938720703, "ViewRequirementAgentConnector_ms": 0.0923149585723877}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7729999999998127, "episode_len_mean": 277.88, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 45.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, 44.5, 38.300000000000026, 43.50000000000001, 39.70000000000002, 45.7, -50.00000000000044, 45.1, 42.900000000000006, 15.099999999999774, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 42.10000000000001, 42.30000000000001, 44.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 34.10000000000004, 42.30000000000001, 40.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 45.5, 40.10000000000002, 44.900000000000006, 26.89999999999994, 8.299999999999677, -50.00000000000044, 46.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.5, 27.49999999999995, 36.900000000000034, -50.00000000000044, 21.09999999999986, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 32.30000000000002, -50.00000000000044, 25.499999999999922, 42.70000000000001, 39.50000000000002, 20.299999999999848, 43.900000000000006, -50.00000000000044, 25.699999999999925, 44.5, -50.00000000000044, 38.700000000000024, 32.100000000000016, 42.900000000000006, 11.899999999999729, 45.5, 44.300000000000004, -50.00000000000044, 21.89999999999987, -50.00000000000044, 41.70000000000002, 35.70000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 39.10000000000002, 43.10000000000001, 12.499999999999737], "episode_lengths": [76, 46, 500, 70, 500, 198, 500, 56, 118, 66, 104, 44, 500, 50, 72, 350, 126, 500, 500, 500, 138, 500, 80, 78, 54, 500, 134, 500, 500, 500, 68, 500, 500, 500, 132, 500, 500, 500, 140, 500, 500, 492, 160, 78, 100, 500, 58, 500, 48, 46, 100, 52, 232, 418, 500, 36, 64, 500, 500, 500, 500, 74, 500, 36, 226, 132, 500, 290, 500, 500, 140, 500, 178, 500, 246, 74, 106, 298, 62, 500, 244, 56, 500, 114, 180, 72, 382, 46, 58, 500, 282, 500, 84, 144, 500, 124, 500, 110, 70, 376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37993988390109196, "mean_inference_ms": 1.219080314850724, "mean_action_processing_ms": 0.14124285591744346, "mean_env_wait_ms": 0.08310572798335414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0269925594329834, "StateBufferConnector_ms": 0.005997180938720703, "ViewRequirementAgentConnector_ms": 0.0923149585723877}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5572.570285381249, "num_env_steps_trained_throughput_per_sec": 5572.570285381249, "timesteps_total": 576000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 3233.086, "sample_time_ms": 2845.697, "load_time_ms": 17.381, "load_throughput": 1035630.617, "learn_time_ms": 358.842, "learn_throughput": 50161.337, "synch_weights_time_ms": 9.261}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2259, "training_iteration": 32, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-22", "timestamp": 1698248002, "time_this_iter_s": 3.2371044158935547, "time_total_s": 104.0043797492981, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 104.0043797492981, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 63.3, "ram_util_percent": 26.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 0.0003, "total_loss": 7.231453665980586, "policy_loss": -0.0006243419031509095, "vf_loss": 7.232135384171097, "vf_explained_var": 9.934107462565105e-08, "kl": 0.0015233627554546612, "entropy": 0.5739282237158881, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.768999999999876, "episode_len_mean": 218.06, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.100000000000016, 42.900000000000006, 11.899999999999729, 45.5, 44.300000000000004, -50.00000000000044, 21.89999999999987, -50.00000000000044, 41.70000000000002, 35.70000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 39.10000000000002, 43.10000000000001, 12.499999999999737, 41.90000000000001, 40.10000000000002, 41.100000000000016, 44.7, 36.70000000000003, 44.300000000000004, 39.90000000000002, 42.900000000000006, 45.9, 43.10000000000001, 41.100000000000016, 45.1, 44.5, 44.10000000000001, 36.30000000000003, -50.00000000000044, 44.7, -50.00000000000044, 44.900000000000006, 36.30000000000003, -50.00000000000044, 16.8999999999998, 43.30000000000001, 34.30000000000004, 43.50000000000001, 37.70000000000003, -50.00000000000044, 18.899999999999828, 44.5, 29.099999999999973, 40.70000000000002, 17.099999999999802, 38.10000000000002, 47.1, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.900000000000006, 13.499999999999751, 28.09999999999996, 30.699999999999996, 38.90000000000002, 47.5, 43.50000000000001, 31.300000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.3, 43.50000000000001, -50.00000000000044, 10.299999999999706, 23.099999999999888, 43.7, 34.70000000000004, -50.00000000000044, 42.900000000000006, 45.1, -50.00000000000044, 36.10000000000004, 28.09999999999996, 46.5, -50.00000000000044, 40.30000000000002, 43.50000000000001, -50.00000000000044, 44.7, 46.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.500000000000007, -50.00000000000044, 45.7, 40.70000000000002, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, 42.70000000000001, 37.50000000000003], "episode_lengths": [180, 72, 382, 46, 58, 500, 282, 500, 84, 144, 500, 124, 500, 110, 70, 376, 82, 100, 90, 54, 134, 58, 102, 72, 42, 70, 90, 50, 56, 60, 138, 500, 54, 500, 52, 138, 500, 332, 68, 158, 66, 124, 500, 312, 56, 210, 94, 330, 120, 30, 500, 88, 500, 52, 366, 220, 194, 112, 26, 66, 188, 500, 40, 500, 48, 66, 500, 398, 270, 64, 154, 500, 72, 50, 500, 140, 220, 36, 500, 98, 66, 500, 54, 36, 108, 500, 500, 500, 500, 78, 186, 500, 44, 94, 500, 202, 500, 500, 74, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37921876530910675, "mean_inference_ms": 1.2185549232259272, "mean_action_processing_ms": 0.1411765559886578, "mean_env_wait_ms": 0.08289216520138137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026014328002929688, "StateBufferConnector_ms": 0.00503087043762207, "ViewRequirementAgentConnector_ms": 0.1199955940246582}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.768999999999876, "episode_len_mean": 218.06, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.100000000000016, 42.900000000000006, 11.899999999999729, 45.5, 44.300000000000004, -50.00000000000044, 21.89999999999987, -50.00000000000044, 41.70000000000002, 35.70000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 39.10000000000002, 43.10000000000001, 12.499999999999737, 41.90000000000001, 40.10000000000002, 41.100000000000016, 44.7, 36.70000000000003, 44.300000000000004, 39.90000000000002, 42.900000000000006, 45.9, 43.10000000000001, 41.100000000000016, 45.1, 44.5, 44.10000000000001, 36.30000000000003, -50.00000000000044, 44.7, -50.00000000000044, 44.900000000000006, 36.30000000000003, -50.00000000000044, 16.8999999999998, 43.30000000000001, 34.30000000000004, 43.50000000000001, 37.70000000000003, -50.00000000000044, 18.899999999999828, 44.5, 29.099999999999973, 40.70000000000002, 17.099999999999802, 38.10000000000002, 47.1, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.900000000000006, 13.499999999999751, 28.09999999999996, 30.699999999999996, 38.90000000000002, 47.5, 43.50000000000001, 31.300000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.3, 43.50000000000001, -50.00000000000044, 10.299999999999706, 23.099999999999888, 43.7, 34.70000000000004, -50.00000000000044, 42.900000000000006, 45.1, -50.00000000000044, 36.10000000000004, 28.09999999999996, 46.5, -50.00000000000044, 40.30000000000002, 43.50000000000001, -50.00000000000044, 44.7, 46.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.500000000000007, -50.00000000000044, 45.7, 40.70000000000002, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, 42.70000000000001, 37.50000000000003], "episode_lengths": [180, 72, 382, 46, 58, 500, 282, 500, 84, 144, 500, 124, 500, 110, 70, 376, 82, 100, 90, 54, 134, 58, 102, 72, 42, 70, 90, 50, 56, 60, 138, 500, 54, 500, 52, 138, 500, 332, 68, 158, 66, 124, 500, 312, 56, 210, 94, 330, 120, 30, 500, 88, 500, 52, 366, 220, 194, 112, 26, 66, 188, 500, 40, 500, 48, 66, 500, 398, 270, 64, 154, 500, 72, 50, 500, 140, 220, 36, 500, 98, 66, 500, 54, 36, 108, 500, 500, 500, 500, 78, 186, 500, 44, 94, 500, 202, 500, 500, 74, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37921876530910675, "mean_inference_ms": 1.2185549232259272, "mean_action_processing_ms": 0.1411765559886578, "mean_env_wait_ms": 0.08289216520138137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026014328002929688, "StateBufferConnector_ms": 0.00503087043762207, "ViewRequirementAgentConnector_ms": 0.1199955940246582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5555.6242203009015, "num_env_steps_trained_throughput_per_sec": 5555.6242203009015, "timesteps_total": 594000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 594000, "timers": {"training_iteration_time_ms": 3225.824, "sample_time_ms": 2841.212, "load_time_ms": 17.835, "load_throughput": 1009259.727, "learn_time_ms": 355.487, "learn_throughput": 50634.819, "synch_weights_time_ms": 9.385}, "counters": {"num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "done": false, "episodes_total": 2343, "training_iteration": 33, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-25", "timestamp": 1698248005, "time_this_iter_s": 3.244959592819214, "time_total_s": 107.24933934211731, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 107.24933934211731, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 58.160000000000004, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 0.0003, "total_loss": 7.04150895719175, "policy_loss": -0.0004323903402244603, "vf_loss": 7.041999887537073, "vf_explained_var": 4.128173545554832e-07, "kl": 0.0012453860095454864, "entropy": 0.5867109298706055, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 905.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.988999999999844, "episode_len_mean": 255.8, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, 34.70000000000004, -50.00000000000044, 42.900000000000006, 45.1, -50.00000000000044, 36.10000000000004, 28.09999999999996, 46.5, -50.00000000000044, 40.30000000000002, 43.50000000000001, -50.00000000000044, 44.7, 46.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.500000000000007, -50.00000000000044, 45.7, 40.70000000000002, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, 42.70000000000001, 37.50000000000003, 11.099999999999717, 46.5, -50.00000000000044, 40.90000000000002, -50.00000000000044, 37.90000000000003, 29.69999999999998, -50.00000000000044, 19.09999999999983, 34.30000000000004, 23.099999999999888, 15.49999999999978, -50.00000000000044, 42.900000000000006, 36.50000000000003, 43.30000000000001, 42.900000000000006, 22.899999999999885, 33.500000000000036, -50.00000000000044, 44.10000000000001, 45.7, 43.30000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 24.299999999999905, 27.299999999999947, -50.00000000000044, 32.100000000000016, 40.30000000000002, 35.900000000000034, 44.900000000000006, 23.29999999999989, -50.00000000000044, -50.00000000000044, 38.300000000000026, 37.90000000000003, 44.5, 41.30000000000001, 44.10000000000001, -50.00000000000044, 37.10000000000003, 45.9, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 27.899999999999956, 33.30000000000003, 9.699999999999697, 34.900000000000034, 35.70000000000003, 45.9, 40.70000000000002, 8.699999999999683, 24.499999999999908, 5.299999999999635, 39.90000000000002, 40.10000000000002, 27.099999999999945, -50.00000000000044, 41.70000000000002, 42.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [64, 154, 500, 72, 50, 500, 140, 220, 36, 500, 98, 66, 500, 54, 36, 108, 500, 500, 500, 500, 78, 186, 500, 44, 94, 500, 202, 500, 500, 74, 126, 390, 36, 500, 92, 500, 122, 204, 500, 310, 158, 270, 346, 500, 72, 136, 68, 72, 272, 166, 500, 60, 44, 68, 500, 500, 178, 500, 500, 258, 228, 500, 180, 98, 142, 52, 268, 500, 500, 118, 122, 56, 88, 60, 500, 130, 42, 500, 500, 248, 500, 222, 168, 404, 152, 144, 42, 94, 414, 256, 448, 102, 100, 230, 500, 84, 80, 84, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37953892154881624, "mean_inference_ms": 1.2189440308621986, "mean_action_processing_ms": 0.14164411138264021, "mean_env_wait_ms": 0.08308308272519006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025016307830810547, "StateBufferConnector_ms": 0.0050394535064697266, "ViewRequirementAgentConnector_ms": 0.12800121307373047}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.988999999999844, "episode_len_mean": 255.8, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, 34.70000000000004, -50.00000000000044, 42.900000000000006, 45.1, -50.00000000000044, 36.10000000000004, 28.09999999999996, 46.5, -50.00000000000044, 40.30000000000002, 43.50000000000001, -50.00000000000044, 44.7, 46.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.500000000000007, -50.00000000000044, 45.7, 40.70000000000002, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, 42.70000000000001, 37.50000000000003, 11.099999999999717, 46.5, -50.00000000000044, 40.90000000000002, -50.00000000000044, 37.90000000000003, 29.69999999999998, -50.00000000000044, 19.09999999999983, 34.30000000000004, 23.099999999999888, 15.49999999999978, -50.00000000000044, 42.900000000000006, 36.50000000000003, 43.30000000000001, 42.900000000000006, 22.899999999999885, 33.500000000000036, -50.00000000000044, 44.10000000000001, 45.7, 43.30000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 24.299999999999905, 27.299999999999947, -50.00000000000044, 32.100000000000016, 40.30000000000002, 35.900000000000034, 44.900000000000006, 23.29999999999989, -50.00000000000044, -50.00000000000044, 38.300000000000026, 37.90000000000003, 44.5, 41.30000000000001, 44.10000000000001, -50.00000000000044, 37.10000000000003, 45.9, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 27.899999999999956, 33.30000000000003, 9.699999999999697, 34.900000000000034, 35.70000000000003, 45.9, 40.70000000000002, 8.699999999999683, 24.499999999999908, 5.299999999999635, 39.90000000000002, 40.10000000000002, 27.099999999999945, -50.00000000000044, 41.70000000000002, 42.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [64, 154, 500, 72, 50, 500, 140, 220, 36, 500, 98, 66, 500, 54, 36, 108, 500, 500, 500, 500, 78, 186, 500, 44, 94, 500, 202, 500, 500, 74, 126, 390, 36, 500, 92, 500, 122, 204, 500, 310, 158, 270, 346, 500, 72, 136, 68, 72, 272, 166, 500, 60, 44, 68, 500, 500, 178, 500, 500, 258, 228, 500, 180, 98, 142, 52, 268, 500, 500, 118, 122, 56, 88, 60, 500, 130, 42, 500, 500, 248, 500, 222, 168, 404, 152, 144, 42, 94, 414, 256, 448, 102, 100, 230, 500, 84, 80, 84, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37953892154881624, "mean_inference_ms": 1.2189440308621986, "mean_action_processing_ms": 0.14164411138264021, "mean_env_wait_ms": 0.08308308272519006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025016307830810547, "StateBufferConnector_ms": 0.0050394535064697266, "ViewRequirementAgentConnector_ms": 0.12800121307373047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5542.060028465854, "num_env_steps_trained_throughput_per_sec": 5542.060028465854, "timesteps_total": 612000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 3238.371, "sample_time_ms": 2843.686, "load_time_ms": 19.342, "load_throughput": 930639.426, "learn_time_ms": 364.233, "learn_throughput": 49418.91, "synch_weights_time_ms": 9.205}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2412, "training_iteration": 34, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-28", "timestamp": 1698248008, "time_this_iter_s": 3.25488543510437, "time_total_s": 110.50422477722168, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 110.50422477722168, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 53.88000000000001, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693484e-11, "cur_lr": 0.0003, "total_loss": 6.992710078204119, "policy_loss": 0.0001425333321094513, "vf_loss": 6.992624759674072, "vf_explained_var": -1.5894571940104166e-07, "kl": 0.0001730606449051998, "entropy": 0.5725853972964816, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 932.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.17099999999983, "episode_len_mean": 263.96, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 38.300000000000026, 37.90000000000003, 44.5, 41.30000000000001, 44.10000000000001, -50.00000000000044, 37.10000000000003, 45.9, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 27.899999999999956, 33.30000000000003, 9.699999999999697, 34.900000000000034, 35.70000000000003, 45.9, 40.70000000000002, 8.699999999999683, 24.499999999999908, 5.299999999999635, 39.90000000000002, 40.10000000000002, 27.099999999999945, -50.00000000000044, 41.70000000000002, 42.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 45.3, 42.30000000000001, 0.6999999999995694, 44.5, -50.00000000000044, 47.3, -50.00000000000044, 2.299999999999592, 40.70000000000002, 42.900000000000006, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 28.89999999999997, 29.899999999999984, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.3, 45.3, 31.900000000000013, 22.899999999999885, -50.00000000000044, 45.7, 38.700000000000024, -50.00000000000044, 45.9, 40.70000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.10000000000001, 27.899999999999956, 35.500000000000036, -50.00000000000044, 45.3, -50.00000000000044, 0.2999999999995637, 35.70000000000003, 43.900000000000006, 36.900000000000034, 31.300000000000004, 18.29999999999982, 35.900000000000034, 32.90000000000003, 41.30000000000001, 39.70000000000002, -50.00000000000044, 45.5, 30.499999999999993, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 118, 122, 56, 88, 60, 500, 130, 42, 500, 500, 248, 500, 222, 168, 404, 152, 144, 42, 94, 414, 256, 448, 102, 100, 230, 500, 84, 80, 84, 500, 500, 500, 266, 48, 78, 494, 56, 500, 28, 500, 478, 94, 72, 72, 500, 500, 46, 500, 500, 212, 202, 500, 40, 500, 90, 500, 38, 48, 182, 272, 500, 44, 114, 500, 42, 94, 500, 140, 500, 500, 500, 52, 500, 60, 222, 146, 500, 48, 500, 498, 144, 62, 132, 188, 318, 142, 172, 88, 104, 500, 46, 196, 88, 500, 500, 52, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3796669927673353, "mean_inference_ms": 1.2180913067330128, "mean_action_processing_ms": 0.1410106193240942, "mean_env_wait_ms": 0.08344049470756895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02000284194946289, "StateBufferConnector_ms": 0.0030024051666259766, "ViewRequirementAgentConnector_ms": 0.13400721549987793}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.17099999999983, "episode_len_mean": 263.96, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 38.300000000000026, 37.90000000000003, 44.5, 41.30000000000001, 44.10000000000001, -50.00000000000044, 37.10000000000003, 45.9, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 27.899999999999956, 33.30000000000003, 9.699999999999697, 34.900000000000034, 35.70000000000003, 45.9, 40.70000000000002, 8.699999999999683, 24.499999999999908, 5.299999999999635, 39.90000000000002, 40.10000000000002, 27.099999999999945, -50.00000000000044, 41.70000000000002, 42.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 45.3, 42.30000000000001, 0.6999999999995694, 44.5, -50.00000000000044, 47.3, -50.00000000000044, 2.299999999999592, 40.70000000000002, 42.900000000000006, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 28.89999999999997, 29.899999999999984, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.3, 45.3, 31.900000000000013, 22.899999999999885, -50.00000000000044, 45.7, 38.700000000000024, -50.00000000000044, 45.9, 40.70000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.10000000000001, 27.899999999999956, 35.500000000000036, -50.00000000000044, 45.3, -50.00000000000044, 0.2999999999995637, 35.70000000000003, 43.900000000000006, 36.900000000000034, 31.300000000000004, 18.29999999999982, 35.900000000000034, 32.90000000000003, 41.30000000000001, 39.70000000000002, -50.00000000000044, 45.5, 30.499999999999993, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 118, 122, 56, 88, 60, 500, 130, 42, 500, 500, 248, 500, 222, 168, 404, 152, 144, 42, 94, 414, 256, 448, 102, 100, 230, 500, 84, 80, 84, 500, 500, 500, 266, 48, 78, 494, 56, 500, 28, 500, 478, 94, 72, 72, 500, 500, 46, 500, 500, 212, 202, 500, 40, 500, 90, 500, 38, 48, 182, 272, 500, 44, 114, 500, 42, 94, 500, 140, 500, 500, 500, 52, 500, 60, 222, 146, 500, 48, 500, 498, 144, 62, 132, 188, 318, 142, 172, 88, 104, 500, 46, 196, 88, 500, 500, 52, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3796669927673353, "mean_inference_ms": 1.2180913067330128, "mean_action_processing_ms": 0.1410106193240942, "mean_env_wait_ms": 0.08344049470756895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02000284194946289, "StateBufferConnector_ms": 0.0030024051666259766, "ViewRequirementAgentConnector_ms": 0.13400721549987793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5689.801672495957, "num_env_steps_trained_throughput_per_sec": 5689.801672495957, "timesteps_total": 630000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 3229.535, "sample_time_ms": 2850.557, "load_time_ms": 18.319, "load_throughput": 982569.186, "learn_time_ms": 349.426, "learn_throughput": 51512.999, "synch_weights_time_ms": 9.326}, "counters": {"num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 2479, "training_iteration": 35, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-31", "timestamp": 1698248011, "time_this_iter_s": 3.169548511505127, "time_total_s": 113.6737732887268, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 113.6737732887268, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 67.32499999999999, "ram_util_percent": 26.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346742e-12, "cur_lr": 0.0003, "total_loss": 6.377007290169045, "policy_loss": -0.00011240649554464553, "vf_loss": 6.377177079518636, "vf_explained_var": -2.5607921459056712e-06, "kl": 0.0004786326491168009, "entropy": 0.5734351961701004, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 959.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.2009999999998175, "episode_len_mean": 273.62, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.899999999999885, -50.00000000000044, 45.7, 38.700000000000024, -50.00000000000044, 45.9, 40.70000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.10000000000001, 27.899999999999956, 35.500000000000036, -50.00000000000044, 45.3, -50.00000000000044, 0.2999999999995637, 35.70000000000003, 43.900000000000006, 36.900000000000034, 31.300000000000004, 18.29999999999982, 35.900000000000034, 32.90000000000003, 41.30000000000001, 39.70000000000002, -50.00000000000044, 45.5, 30.499999999999993, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 38.700000000000024, 8.899999999999686, -50.00000000000044, 45.7, -50.00000000000044, 34.70000000000004, -50.00000000000044, 33.10000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.7, 40.30000000000002, 37.50000000000003, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.09999999999979, 41.100000000000016, 42.900000000000006, -50.00000000000044, 45.5, 29.49999999999998, 40.30000000000002, -50.00000000000044, 45.9, 9.699999999999697, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 24.899999999999913, -50.00000000000044, 45.1, 34.70000000000004, -50.00000000000044, 0.09999999999956088, 34.10000000000004, 43.7, 45.7, 45.9, -50.00000000000044, 43.10000000000001, 44.7, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 2.499999999999595, 45.7, 41.100000000000016], "episode_lengths": [272, 500, 44, 114, 500, 42, 94, 500, 140, 500, 500, 500, 52, 500, 60, 222, 146, 500, 48, 500, 498, 144, 62, 132, 188, 318, 142, 172, 88, 104, 500, 46, 196, 88, 500, 500, 52, 500, 500, 500, 64, 42, 114, 412, 500, 44, 500, 154, 500, 170, 82, 500, 500, 44, 98, 126, 500, 228, 500, 500, 500, 340, 90, 72, 500, 46, 206, 98, 500, 42, 404, 500, 56, 62, 500, 500, 500, 112, 252, 500, 50, 154, 500, 500, 160, 64, 44, 42, 500, 70, 54, 126, 500, 500, 500, 166, 500, 476, 44, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37977772258628145, "mean_inference_ms": 1.2174576970523225, "mean_action_processing_ms": 0.1407574404540362, "mean_env_wait_ms": 0.08327773415605876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020991802215576172, "StateBufferConnector_ms": 0.005003690719604492, "ViewRequirementAgentConnector_ms": 0.12102246284484863}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.2009999999998175, "episode_len_mean": 273.62, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.899999999999885, -50.00000000000044, 45.7, 38.700000000000024, -50.00000000000044, 45.9, 40.70000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.10000000000001, 27.899999999999956, 35.500000000000036, -50.00000000000044, 45.3, -50.00000000000044, 0.2999999999995637, 35.70000000000003, 43.900000000000006, 36.900000000000034, 31.300000000000004, 18.29999999999982, 35.900000000000034, 32.90000000000003, 41.30000000000001, 39.70000000000002, -50.00000000000044, 45.5, 30.499999999999993, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 38.700000000000024, 8.899999999999686, -50.00000000000044, 45.7, -50.00000000000044, 34.70000000000004, -50.00000000000044, 33.10000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.7, 40.30000000000002, 37.50000000000003, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.09999999999979, 41.100000000000016, 42.900000000000006, -50.00000000000044, 45.5, 29.49999999999998, 40.30000000000002, -50.00000000000044, 45.9, 9.699999999999697, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 24.899999999999913, -50.00000000000044, 45.1, 34.70000000000004, -50.00000000000044, 0.09999999999956088, 34.10000000000004, 43.7, 45.7, 45.9, -50.00000000000044, 43.10000000000001, 44.7, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 2.499999999999595, 45.7, 41.100000000000016], "episode_lengths": [272, 500, 44, 114, 500, 42, 94, 500, 140, 500, 500, 500, 52, 500, 60, 222, 146, 500, 48, 500, 498, 144, 62, 132, 188, 318, 142, 172, 88, 104, 500, 46, 196, 88, 500, 500, 52, 500, 500, 500, 64, 42, 114, 412, 500, 44, 500, 154, 500, 170, 82, 500, 500, 44, 98, 126, 500, 228, 500, 500, 500, 340, 90, 72, 500, 46, 206, 98, 500, 42, 404, 500, 56, 62, 500, 500, 500, 112, 252, 500, 50, 154, 500, 500, 160, 64, 44, 42, 500, 70, 54, 126, 500, 500, 500, 166, 500, 476, 44, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37977772258628145, "mean_inference_ms": 1.2174576970523225, "mean_action_processing_ms": 0.1407574404540362, "mean_env_wait_ms": 0.08327773415605876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020991802215576172, "StateBufferConnector_ms": 0.005003690719604492, "ViewRequirementAgentConnector_ms": 0.12102246284484863}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5623.43251811439, "num_env_steps_trained_throughput_per_sec": 5623.43251811439, "timesteps_total": 648000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 3231.644, "sample_time_ms": 2852.218, "load_time_ms": 19.219, "load_throughput": 936556.087, "learn_time_ms": 348.922, "learn_throughput": 51587.529, "synch_weights_time_ms": 9.48}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2540, "training_iteration": 36, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-35", "timestamp": 1698248015, "time_this_iter_s": 3.207890272140503, "time_total_s": 116.88166356086731, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 116.88166356086731, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 54.260000000000005, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.910383045673371e-12, "cur_lr": 0.0003, "total_loss": 7.198823081122504, "policy_loss": -0.00015732645988464355, "vf_loss": 7.199036827793828, "vf_explained_var": -3.9736429850260414e-08, "kl": 0.0007937805715919745, "entropy": 0.5636287342619013, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 986.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.778999999999835, "episode_len_mean": 257.88, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.899999999999913, -50.00000000000044, 45.1, 34.70000000000004, -50.00000000000044, 0.09999999999956088, 34.10000000000004, 43.7, 45.7, 45.9, -50.00000000000044, 43.10000000000001, 44.7, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 2.499999999999595, 45.7, 41.100000000000016, -50.00000000000044, 42.10000000000001, 33.90000000000004, 39.50000000000002, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 44.10000000000001, 44.10000000000001, 30.099999999999987, 42.900000000000006, -50.00000000000044, 46.9, 44.900000000000006, 41.70000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 26.499999999999936, -50.00000000000044, 43.7, -50.00000000000044, 26.09999999999993, 43.7, -50.00000000000044, 35.10000000000004, 39.90000000000002, 43.50000000000001, 45.7, -50.00000000000044, 36.30000000000003, 41.30000000000001, -50.00000000000044, -50.00000000000044, 16.8999999999998, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 32.30000000000002, 43.900000000000006, 45.3, 42.30000000000001, -50.00000000000044, 19.09999999999983, 45.5, 5.899999999999643, -50.00000000000044, 44.5, 14.09999999999976, -50.00000000000044, 35.30000000000004, 42.900000000000006, 45.3, -50.00000000000044, 40.10000000000002, 33.500000000000036, 18.29999999999982, -50.00000000000044, 15.899999999999785, 46.099999999999994, 45.1, 45.3, 33.90000000000004, -50.00000000000044, 40.90000000000002, 10.299999999999706, 41.70000000000002, 27.49999999999995, -50.00000000000044], "episode_lengths": [252, 500, 50, 154, 500, 500, 160, 64, 44, 42, 500, 70, 54, 126, 500, 500, 500, 166, 500, 476, 44, 90, 500, 80, 162, 106, 500, 500, 114, 500, 500, 114, 500, 60, 60, 200, 72, 500, 32, 52, 84, 500, 164, 500, 236, 500, 64, 500, 240, 64, 500, 150, 102, 66, 44, 500, 138, 88, 500, 500, 332, 70, 500, 500, 78, 92, 58, 500, 500, 178, 62, 48, 78, 500, 310, 46, 442, 500, 56, 360, 500, 148, 72, 48, 500, 100, 166, 318, 500, 342, 40, 50, 48, 162, 500, 92, 398, 84, 226, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3795361858810204, "mean_inference_ms": 1.2158507589388738, "mean_action_processing_ms": 0.140966589507422, "mean_env_wait_ms": 0.08334994611624584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019988059997558594, "StateBufferConnector_ms": 0.0050048828125, "ViewRequirementAgentConnector_ms": 0.10191941261291504}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.778999999999835, "episode_len_mean": 257.88, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.899999999999913, -50.00000000000044, 45.1, 34.70000000000004, -50.00000000000044, 0.09999999999956088, 34.10000000000004, 43.7, 45.7, 45.9, -50.00000000000044, 43.10000000000001, 44.7, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 2.499999999999595, 45.7, 41.100000000000016, -50.00000000000044, 42.10000000000001, 33.90000000000004, 39.50000000000002, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 44.10000000000001, 44.10000000000001, 30.099999999999987, 42.900000000000006, -50.00000000000044, 46.9, 44.900000000000006, 41.70000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 26.499999999999936, -50.00000000000044, 43.7, -50.00000000000044, 26.09999999999993, 43.7, -50.00000000000044, 35.10000000000004, 39.90000000000002, 43.50000000000001, 45.7, -50.00000000000044, 36.30000000000003, 41.30000000000001, -50.00000000000044, -50.00000000000044, 16.8999999999998, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 32.30000000000002, 43.900000000000006, 45.3, 42.30000000000001, -50.00000000000044, 19.09999999999983, 45.5, 5.899999999999643, -50.00000000000044, 44.5, 14.09999999999976, -50.00000000000044, 35.30000000000004, 42.900000000000006, 45.3, -50.00000000000044, 40.10000000000002, 33.500000000000036, 18.29999999999982, -50.00000000000044, 15.899999999999785, 46.099999999999994, 45.1, 45.3, 33.90000000000004, -50.00000000000044, 40.90000000000002, 10.299999999999706, 41.70000000000002, 27.49999999999995, -50.00000000000044], "episode_lengths": [252, 500, 50, 154, 500, 500, 160, 64, 44, 42, 500, 70, 54, 126, 500, 500, 500, 166, 500, 476, 44, 90, 500, 80, 162, 106, 500, 500, 114, 500, 500, 114, 500, 60, 60, 200, 72, 500, 32, 52, 84, 500, 164, 500, 236, 500, 64, 500, 240, 64, 500, 150, 102, 66, 44, 500, 138, 88, 500, 500, 332, 70, 500, 500, 78, 92, 58, 500, 500, 178, 62, 48, 78, 500, 310, 46, 442, 500, 56, 360, 500, 148, 72, 48, 500, 100, 166, 318, 500, 342, 40, 50, 48, 162, 500, 92, 398, 84, 226, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3795361858810204, "mean_inference_ms": 1.2158507589388738, "mean_action_processing_ms": 0.140966589507422, "mean_env_wait_ms": 0.08334994611624584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019988059997558594, "StateBufferConnector_ms": 0.0050048828125, "ViewRequirementAgentConnector_ms": 0.10191941261291504}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5616.398588101704, "num_env_steps_trained_throughput_per_sec": 5616.398588101704, "timesteps_total": 666000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 666000, "timers": {"training_iteration_time_ms": 3230.43, "sample_time_ms": 2850.727, "load_time_ms": 19.289, "load_throughput": 933158.545, "learn_time_ms": 349.192, "learn_throughput": 51547.64, "synch_weights_time_ms": 9.417}, "counters": {"num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "done": false, "episodes_total": 2618, "training_iteration": 37, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-38", "timestamp": 1698248018, "time_this_iter_s": 3.2110531330108643, "time_total_s": 120.09271669387817, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 120.09271669387817, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 65.25, "ram_util_percent": 26.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366855e-12, "cur_lr": 0.0003, "total_loss": 7.004438912426984, "policy_loss": -0.0013202802079764228, "vf_loss": 7.005815152768736, "vf_explained_var": -4.1060977511935766e-07, "kl": 0.0017426003787415869, "entropy": 0.5600524390185321, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.372999999999841, "episode_len_mean": 251.98, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.30000000000002, 43.900000000000006, 45.3, 42.30000000000001, -50.00000000000044, 19.09999999999983, 45.5, 5.899999999999643, -50.00000000000044, 44.5, 14.09999999999976, -50.00000000000044, 35.30000000000004, 42.900000000000006, 45.3, -50.00000000000044, 40.10000000000002, 33.500000000000036, 18.29999999999982, -50.00000000000044, 15.899999999999785, 46.099999999999994, 45.1, 45.3, 33.90000000000004, -50.00000000000044, 40.90000000000002, 10.299999999999706, 41.70000000000002, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 8.099999999999675, -50.00000000000044, 24.899999999999913, 43.50000000000001, 37.300000000000026, 42.900000000000006, 40.90000000000002, 40.90000000000002, 39.70000000000002, -50.00000000000044, 4.299999999999621, 44.7, -50.00000000000044, 2.499999999999595, 38.10000000000002, -50.00000000000044, -50.00000000000044, 21.89999999999987, 43.900000000000006, -50.00000000000044, 39.50000000000002, 31.900000000000013, -50.00000000000044, 43.900000000000006, 24.69999999999991, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.10000000000002, 45.1, 44.300000000000004, 12.69999999999974, -50.00000000000044, -50.00000000000044, 47.7, 26.499999999999936, 44.900000000000006, 33.70000000000004, 31.300000000000004, 23.699999999999896, -50.00000000000044, 42.70000000000001, 41.500000000000014, 42.10000000000001, -50.00000000000044, 13.699999999999754, 40.10000000000002, 45.1, -50.00000000000044, 43.50000000000001, 43.7, 21.699999999999868, 42.10000000000001, 46.5, -50.00000000000044, 41.100000000000016, 44.300000000000004, 43.50000000000001, 41.500000000000014, 42.900000000000006], "episode_lengths": [500, 178, 62, 48, 78, 500, 310, 46, 442, 500, 56, 360, 500, 148, 72, 48, 500, 100, 166, 318, 500, 342, 40, 50, 48, 162, 500, 92, 398, 84, 226, 500, 500, 500, 500, 60, 500, 420, 500, 252, 66, 128, 72, 92, 92, 104, 500, 458, 54, 500, 476, 120, 500, 500, 282, 62, 500, 106, 182, 500, 62, 254, 236, 500, 500, 500, 500, 80, 100, 50, 58, 374, 500, 500, 24, 236, 52, 164, 188, 264, 500, 74, 86, 80, 500, 364, 100, 50, 500, 66, 64, 284, 80, 36, 500, 90, 58, 66, 86, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791927013364315, "mean_inference_ms": 1.2164020216028526, "mean_action_processing_ms": 0.141267183933731, "mean_env_wait_ms": 0.08362555397826381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011992931365966797, "StateBufferConnector_ms": 0.009002447128295898, "ViewRequirementAgentConnector_ms": 0.09187626838684082}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.372999999999841, "episode_len_mean": 251.98, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.30000000000002, 43.900000000000006, 45.3, 42.30000000000001, -50.00000000000044, 19.09999999999983, 45.5, 5.899999999999643, -50.00000000000044, 44.5, 14.09999999999976, -50.00000000000044, 35.30000000000004, 42.900000000000006, 45.3, -50.00000000000044, 40.10000000000002, 33.500000000000036, 18.29999999999982, -50.00000000000044, 15.899999999999785, 46.099999999999994, 45.1, 45.3, 33.90000000000004, -50.00000000000044, 40.90000000000002, 10.299999999999706, 41.70000000000002, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 8.099999999999675, -50.00000000000044, 24.899999999999913, 43.50000000000001, 37.300000000000026, 42.900000000000006, 40.90000000000002, 40.90000000000002, 39.70000000000002, -50.00000000000044, 4.299999999999621, 44.7, -50.00000000000044, 2.499999999999595, 38.10000000000002, -50.00000000000044, -50.00000000000044, 21.89999999999987, 43.900000000000006, -50.00000000000044, 39.50000000000002, 31.900000000000013, -50.00000000000044, 43.900000000000006, 24.69999999999991, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.10000000000002, 45.1, 44.300000000000004, 12.69999999999974, -50.00000000000044, -50.00000000000044, 47.7, 26.499999999999936, 44.900000000000006, 33.70000000000004, 31.300000000000004, 23.699999999999896, -50.00000000000044, 42.70000000000001, 41.500000000000014, 42.10000000000001, -50.00000000000044, 13.699999999999754, 40.10000000000002, 45.1, -50.00000000000044, 43.50000000000001, 43.7, 21.699999999999868, 42.10000000000001, 46.5, -50.00000000000044, 41.100000000000016, 44.300000000000004, 43.50000000000001, 41.500000000000014, 42.900000000000006], "episode_lengths": [500, 178, 62, 48, 78, 500, 310, 46, 442, 500, 56, 360, 500, 148, 72, 48, 500, 100, 166, 318, 500, 342, 40, 50, 48, 162, 500, 92, 398, 84, 226, 500, 500, 500, 500, 60, 500, 420, 500, 252, 66, 128, 72, 92, 92, 104, 500, 458, 54, 500, 476, 120, 500, 500, 282, 62, 500, 106, 182, 500, 62, 254, 236, 500, 500, 500, 500, 80, 100, 50, 58, 374, 500, 500, 24, 236, 52, 164, 188, 264, 500, 74, 86, 80, 500, 364, 100, 50, 500, 66, 64, 284, 80, 36, 500, 90, 58, 66, 86, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791927013364315, "mean_inference_ms": 1.2164020216028526, "mean_action_processing_ms": 0.141267183933731, "mean_env_wait_ms": 0.08362555397826381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011992931365966797, "StateBufferConnector_ms": 0.009002447128295898, "ViewRequirementAgentConnector_ms": 0.09187626838684082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5680.1796772466505, "num_env_steps_trained_throughput_per_sec": 5680.1796772466505, "timesteps_total": 684000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 3209.483, "sample_time_ms": 2841.811, "load_time_ms": 19.704, "load_throughput": 913538.513, "learn_time_ms": 336.842, "learn_throughput": 53437.522, "synch_weights_time_ms": 9.421}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2686, "training_iteration": 38, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-41", "timestamp": 1698248021, "time_this_iter_s": 3.1749136447906494, "time_total_s": 123.26763033866882, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 123.26763033866882, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 54.42, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183427e-13, "cur_lr": 0.0003, "total_loss": 7.1628853833233865, "policy_loss": -0.00031058538567136837, "vf_loss": 7.163253713537146, "vf_explained_var": -1.1148276152434172e-06, "kl": 0.0010917463179701506, "entropy": 0.5767231274534155, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1040.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.230999999999874, "episode_len_mean": 223.44, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.70000000000004, 31.300000000000004, 23.699999999999896, -50.00000000000044, 42.70000000000001, 41.500000000000014, 42.10000000000001, -50.00000000000044, 13.699999999999754, 40.10000000000002, 45.1, -50.00000000000044, 43.50000000000001, 43.7, 21.699999999999868, 42.10000000000001, 46.5, -50.00000000000044, 41.100000000000016, 44.300000000000004, 43.50000000000001, 41.500000000000014, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, 16.8999999999998, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.30000000000001, 36.50000000000003, 10.499999999999709, 41.30000000000001, -50.00000000000044, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.5, 33.10000000000003, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 42.30000000000001, 40.500000000000014, 35.30000000000004, -50.00000000000044, 45.7, 40.30000000000002, -50.00000000000044, 21.699999999999868, 31.500000000000007, -50.00000000000044, 46.5, 41.90000000000001, 32.30000000000002, 43.900000000000006, 39.90000000000002, 40.500000000000014, 44.10000000000001, 18.29999999999982, -50.00000000000044, 44.900000000000006, 42.900000000000006, 46.099999999999994, 12.899999999999743, 29.299999999999976, 38.90000000000002, 35.10000000000004, 43.7, 35.70000000000003, 43.30000000000001, 45.9, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.10000000000002, 31.1, 45.9, 42.900000000000006, 18.699999999999825, 46.3, 10.099999999999703, 31.1, 45.1, 45.5, 41.90000000000001, 35.10000000000004, -50.00000000000044, 5.299999999999635], "episode_lengths": [164, 188, 264, 500, 74, 86, 80, 500, 364, 100, 50, 500, 66, 64, 284, 80, 36, 500, 90, 58, 66, 86, 72, 500, 500, 500, 66, 54, 98, 500, 500, 56, 332, 500, 88, 500, 88, 136, 396, 88, 500, 296, 500, 500, 500, 500, 142, 46, 170, 500, 40, 62, 500, 78, 96, 148, 500, 44, 98, 500, 284, 186, 500, 36, 82, 178, 62, 102, 96, 60, 318, 500, 52, 72, 40, 372, 208, 112, 150, 64, 144, 68, 42, 500, 500, 80, 120, 190, 42, 72, 314, 38, 400, 190, 50, 46, 82, 150, 500, 448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790940323488876, "mean_inference_ms": 1.2154731209521543, "mean_action_processing_ms": 0.1403904683176936, "mean_env_wait_ms": 0.0834937113718463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017801523208618164, "StateBufferConnector_ms": 0.010995149612426758, "ViewRequirementAgentConnector_ms": 0.10335755348205566}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.230999999999874, "episode_len_mean": 223.44, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.70000000000004, 31.300000000000004, 23.699999999999896, -50.00000000000044, 42.70000000000001, 41.500000000000014, 42.10000000000001, -50.00000000000044, 13.699999999999754, 40.10000000000002, 45.1, -50.00000000000044, 43.50000000000001, 43.7, 21.699999999999868, 42.10000000000001, 46.5, -50.00000000000044, 41.100000000000016, 44.300000000000004, 43.50000000000001, 41.500000000000014, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, 16.8999999999998, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.30000000000001, 36.50000000000003, 10.499999999999709, 41.30000000000001, -50.00000000000044, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.5, 33.10000000000003, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 42.30000000000001, 40.500000000000014, 35.30000000000004, -50.00000000000044, 45.7, 40.30000000000002, -50.00000000000044, 21.699999999999868, 31.500000000000007, -50.00000000000044, 46.5, 41.90000000000001, 32.30000000000002, 43.900000000000006, 39.90000000000002, 40.500000000000014, 44.10000000000001, 18.29999999999982, -50.00000000000044, 44.900000000000006, 42.900000000000006, 46.099999999999994, 12.899999999999743, 29.299999999999976, 38.90000000000002, 35.10000000000004, 43.7, 35.70000000000003, 43.30000000000001, 45.9, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.10000000000002, 31.1, 45.9, 42.900000000000006, 18.699999999999825, 46.3, 10.099999999999703, 31.1, 45.1, 45.5, 41.90000000000001, 35.10000000000004, -50.00000000000044, 5.299999999999635], "episode_lengths": [164, 188, 264, 500, 74, 86, 80, 500, 364, 100, 50, 500, 66, 64, 284, 80, 36, 500, 90, 58, 66, 86, 72, 500, 500, 500, 66, 54, 98, 500, 500, 56, 332, 500, 88, 500, 88, 136, 396, 88, 500, 296, 500, 500, 500, 500, 142, 46, 170, 500, 40, 62, 500, 78, 96, 148, 500, 44, 98, 500, 284, 186, 500, 36, 82, 178, 62, 102, 96, 60, 318, 500, 52, 72, 40, 372, 208, 112, 150, 64, 144, 68, 42, 500, 500, 80, 120, 190, 42, 72, 314, 38, 400, 190, 50, 46, 82, 150, 500, 448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790940323488876, "mean_inference_ms": 1.2154731209521543, "mean_action_processing_ms": 0.1403904683176936, "mean_env_wait_ms": 0.0834937113718463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017801523208618164, "StateBufferConnector_ms": 0.010995149612426758, "ViewRequirementAgentConnector_ms": 0.10335755348205566}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5545.2428376200105, "num_env_steps_trained_throughput_per_sec": 5545.2428376200105, "timesteps_total": 702000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 702000, "timers": {"training_iteration_time_ms": 3215.549, "sample_time_ms": 2841.155, "load_time_ms": 19.997, "load_throughput": 900136.062, "learn_time_ms": 343.249, "learn_throughput": 52440.122, "synch_weights_time_ms": 9.447}, "counters": {"num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "done": false, "episodes_total": 2763, "training_iteration": 39, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-44", "timestamp": 1698248024, "time_this_iter_s": 3.2520241737365723, "time_total_s": 126.5196545124054, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 126.5196545124054, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 63.150000000000006, "ram_util_percent": 26.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917137e-13, "cur_lr": 0.0003, "total_loss": 6.9693524925797075, "policy_loss": -0.00018819975149300363, "vf_loss": 6.969597392612034, "vf_explained_var": -1.1567716245298033e-06, "kl": 0.0008104388617177257, "entropy": 0.5672017126171677, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1067.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.847999999999866, "episode_len_mean": 222.26, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000004, 43.7, 35.70000000000003, 43.30000000000001, 45.9, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.10000000000002, 31.1, 45.9, 42.900000000000006, 18.699999999999825, 46.3, 10.099999999999703, 31.1, 45.1, 45.5, 41.90000000000001, 35.10000000000004, -50.00000000000044, 5.299999999999635, 42.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 32.90000000000003, 43.50000000000001, 36.50000000000003, 38.700000000000024, 44.300000000000004, 41.30000000000001, 32.100000000000016, 36.10000000000004, 43.30000000000001, -50.00000000000044, 47.1, 37.10000000000003, -50.00000000000044, 41.500000000000014, 39.50000000000002, 43.10000000000001, 44.10000000000001, 46.3, 43.30000000000001, -50.00000000000044, 43.30000000000001, 44.300000000000004, 42.10000000000001, 45.9, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 36.10000000000004, 4.499999999999623, 46.5, 42.500000000000014, 37.50000000000003, 31.900000000000013, 41.90000000000001, 46.9, -50.00000000000044, 46.3, 42.500000000000014, -50.00000000000044, 43.900000000000006, 40.500000000000014, -50.00000000000044, 45.5, 18.099999999999817, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 16.29999999999979, 43.30000000000001, 44.7, 41.90000000000001, 44.5, 14.299999999999763, 42.70000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 46.9, 38.50000000000003, -50.00000000000044, -50.00000000000044, 3.699999999999612, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.5, 46.5, -50.00000000000044], "episode_lengths": [150, 64, 144, 68, 42, 500, 500, 80, 120, 190, 42, 72, 314, 38, 400, 190, 50, 46, 82, 150, 500, 448, 78, 48, 500, 500, 172, 66, 136, 114, 58, 88, 180, 140, 68, 500, 30, 130, 500, 86, 106, 70, 60, 38, 68, 500, 68, 58, 80, 42, 76, 500, 500, 100, 500, 140, 456, 36, 76, 126, 182, 82, 32, 500, 38, 76, 500, 62, 96, 500, 46, 320, 500, 500, 500, 208, 338, 68, 54, 82, 56, 358, 74, 500, 500, 234, 32, 116, 500, 500, 464, 360, 500, 500, 500, 82, 500, 46, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37894508601780663, "mean_inference_ms": 1.213553434553847, "mean_action_processing_ms": 0.14090209609590704, "mean_env_wait_ms": 0.0830405330367725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021825075149536133, "StateBufferConnector_ms": 0.009992122650146484, "ViewRequirementAgentConnector_ms": 0.10044336318969727}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.847999999999866, "episode_len_mean": 222.26, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.10000000000004, 43.7, 35.70000000000003, 43.30000000000001, 45.9, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.10000000000002, 31.1, 45.9, 42.900000000000006, 18.699999999999825, 46.3, 10.099999999999703, 31.1, 45.1, 45.5, 41.90000000000001, 35.10000000000004, -50.00000000000044, 5.299999999999635, 42.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 32.90000000000003, 43.50000000000001, 36.50000000000003, 38.700000000000024, 44.300000000000004, 41.30000000000001, 32.100000000000016, 36.10000000000004, 43.30000000000001, -50.00000000000044, 47.1, 37.10000000000003, -50.00000000000044, 41.500000000000014, 39.50000000000002, 43.10000000000001, 44.10000000000001, 46.3, 43.30000000000001, -50.00000000000044, 43.30000000000001, 44.300000000000004, 42.10000000000001, 45.9, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 36.10000000000004, 4.499999999999623, 46.5, 42.500000000000014, 37.50000000000003, 31.900000000000013, 41.90000000000001, 46.9, -50.00000000000044, 46.3, 42.500000000000014, -50.00000000000044, 43.900000000000006, 40.500000000000014, -50.00000000000044, 45.5, 18.099999999999817, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 16.29999999999979, 43.30000000000001, 44.7, 41.90000000000001, 44.5, 14.299999999999763, 42.70000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 46.9, 38.50000000000003, -50.00000000000044, -50.00000000000044, 3.699999999999612, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.5, 46.5, -50.00000000000044], "episode_lengths": [150, 64, 144, 68, 42, 500, 500, 80, 120, 190, 42, 72, 314, 38, 400, 190, 50, 46, 82, 150, 500, 448, 78, 48, 500, 500, 172, 66, 136, 114, 58, 88, 180, 140, 68, 500, 30, 130, 500, 86, 106, 70, 60, 38, 68, 500, 68, 58, 80, 42, 76, 500, 500, 100, 500, 140, 456, 36, 76, 126, 182, 82, 32, 500, 38, 76, 500, 62, 96, 500, 46, 320, 500, 500, 500, 208, 338, 68, 54, 82, 56, 358, 74, 500, 500, 234, 32, 116, 500, 500, 464, 360, 500, 500, 500, 82, 500, 46, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37894508601780663, "mean_inference_ms": 1.213553434553847, "mean_action_processing_ms": 0.14090209609590704, "mean_env_wait_ms": 0.0830405330367725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021825075149536133, "StateBufferConnector_ms": 0.009992122650146484, "ViewRequirementAgentConnector_ms": 0.10044336318969727}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5568.770234951701, "num_env_steps_trained_throughput_per_sec": 5568.770234951701, "timesteps_total": 720000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 3203.545, "sample_time_ms": 2839.364, "load_time_ms": 19.792, "load_throughput": 909447.026, "learn_time_ms": 333.377, "learn_throughput": 53992.892, "synch_weights_time_ms": 9.312}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2841, "training_iteration": 40, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-48", "timestamp": 1698248028, "time_this_iter_s": 3.2393112182617188, "time_total_s": 129.75896573066711, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 129.75896573066711, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 53.2, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 0.0003, "total_loss": 6.665430775395146, "policy_loss": -0.0003788716125267523, "vf_loss": 6.665864291014494, "vf_explained_var": 1.1037897180627894e-07, "kl": 0.0010037077916799128, "entropy": 0.5474260681205325, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1094.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.373999999999821, "episode_len_mean": 266.92, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 46.3, 42.500000000000014, -50.00000000000044, 43.900000000000006, 40.500000000000014, -50.00000000000044, 45.5, 18.099999999999817, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 16.29999999999979, 43.30000000000001, 44.7, 41.90000000000001, 44.5, 14.299999999999763, 42.70000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 46.9, 38.50000000000003, -50.00000000000044, -50.00000000000044, 3.699999999999612, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 25.499999999999922, 43.30000000000001, -50.00000000000044, 38.10000000000002, 37.90000000000003, -50.00000000000044, 42.10000000000001, 44.10000000000001, 44.10000000000001, 21.699999999999868, -50.00000000000044, 47.1, -50.00000000000044, 45.3, -50.00000000000044, 40.70000000000002, 42.900000000000006, 22.899999999999885, 23.29999999999989, -50.00000000000044, -50.00000000000044, 44.5, 41.30000000000001, 17.69999999999981, 46.9, -50.00000000000044, 42.70000000000001, -50.00000000000044, 30.9, 46.9, 36.30000000000003, 45.5, 35.500000000000036, 45.7, 40.70000000000002, 0.2999999999995637, -50.00000000000044, 42.70000000000001, 40.90000000000002, 13.899999999999757, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.099999999999994, 41.30000000000001, -50.00000000000044, 15.699999999999783, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, 37.10000000000003, -50.00000000000044, 44.7, 25.29999999999992, 38.300000000000026, 43.10000000000001, 6.499999999999652, 30.699999999999996], "episode_lengths": [32, 500, 38, 76, 500, 62, 96, 500, 46, 320, 500, 500, 500, 208, 338, 68, 54, 82, 56, 358, 74, 500, 500, 234, 32, 116, 500, 500, 464, 360, 500, 500, 500, 82, 500, 46, 36, 500, 500, 246, 68, 500, 120, 122, 500, 80, 60, 60, 284, 500, 30, 500, 48, 500, 94, 72, 272, 268, 500, 500, 56, 88, 324, 32, 500, 74, 500, 192, 32, 138, 46, 146, 44, 94, 498, 500, 74, 92, 362, 500, 500, 66, 40, 88, 500, 344, 188, 500, 500, 500, 500, 322, 130, 500, 54, 248, 118, 70, 436, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37855426733703706, "mean_inference_ms": 1.2129355602985135, "mean_action_processing_ms": 0.14023671131104581, "mean_env_wait_ms": 0.08290494070175514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025991439819335938, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.1257469654083252}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.373999999999821, "episode_len_mean": 266.92, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 46.3, 42.500000000000014, -50.00000000000044, 43.900000000000006, 40.500000000000014, -50.00000000000044, 45.5, 18.099999999999817, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 16.29999999999979, 43.30000000000001, 44.7, 41.90000000000001, 44.5, 14.299999999999763, 42.70000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 46.9, 38.50000000000003, -50.00000000000044, -50.00000000000044, 3.699999999999612, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 25.499999999999922, 43.30000000000001, -50.00000000000044, 38.10000000000002, 37.90000000000003, -50.00000000000044, 42.10000000000001, 44.10000000000001, 44.10000000000001, 21.699999999999868, -50.00000000000044, 47.1, -50.00000000000044, 45.3, -50.00000000000044, 40.70000000000002, 42.900000000000006, 22.899999999999885, 23.29999999999989, -50.00000000000044, -50.00000000000044, 44.5, 41.30000000000001, 17.69999999999981, 46.9, -50.00000000000044, 42.70000000000001, -50.00000000000044, 30.9, 46.9, 36.30000000000003, 45.5, 35.500000000000036, 45.7, 40.70000000000002, 0.2999999999995637, -50.00000000000044, 42.70000000000001, 40.90000000000002, 13.899999999999757, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.099999999999994, 41.30000000000001, -50.00000000000044, 15.699999999999783, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, 37.10000000000003, -50.00000000000044, 44.7, 25.29999999999992, 38.300000000000026, 43.10000000000001, 6.499999999999652, 30.699999999999996], "episode_lengths": [32, 500, 38, 76, 500, 62, 96, 500, 46, 320, 500, 500, 500, 208, 338, 68, 54, 82, 56, 358, 74, 500, 500, 234, 32, 116, 500, 500, 464, 360, 500, 500, 500, 82, 500, 46, 36, 500, 500, 246, 68, 500, 120, 122, 500, 80, 60, 60, 284, 500, 30, 500, 48, 500, 94, 72, 272, 268, 500, 500, 56, 88, 324, 32, 500, 74, 500, 192, 32, 138, 46, 146, 44, 94, 498, 500, 74, 92, 362, 500, 500, 66, 40, 88, 500, 344, 188, 500, 500, 500, 500, 322, 130, 500, 54, 248, 118, 70, 436, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37855426733703706, "mean_inference_ms": 1.2129355602985135, "mean_action_processing_ms": 0.14023671131104581, "mean_env_wait_ms": 0.08290494070175514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025991439819335938, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.1257469654083252}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5277.801821902269, "num_env_steps_trained_throughput_per_sec": 5277.801821902269, "timesteps_total": 738000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 738000, "timers": {"training_iteration_time_ms": 3234.507, "sample_time_ms": 2862.763, "load_time_ms": 20.089, "load_throughput": 896002.886, "learn_time_ms": 340.038, "learn_throughput": 52935.188, "synch_weights_time_ms": 9.815}, "counters": {"num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "done": false, "episodes_total": 2903, "training_iteration": 41, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-51", "timestamp": 1698248031, "time_this_iter_s": 3.4175024032592773, "time_total_s": 133.1764681339264, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 133.1764681339264, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 53.04, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 0.0003, "total_loss": 7.309819327460395, "policy_loss": -0.0003501369997307106, "vf_loss": 7.310224162207709, "vf_explained_var": -4.6359168158637154e-08, "kl": 0.0008597063407052019, "entropy": 0.5488733715481229, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1121.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.479999999999842, "episode_len_mean": 245.88, "episode_media": {}, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, 37.10000000000003, -50.00000000000044, 44.7, 25.29999999999992, 38.300000000000026, 43.10000000000001, 6.499999999999652, 30.699999999999996, -50.00000000000044, 45.3, 45.9, 41.500000000000014, 47.3, 34.30000000000004, 38.700000000000024, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 33.70000000000004, 14.899999999999771, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.300000000000004, 45.1, 46.3, 44.10000000000001, -50.00000000000044, 43.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, 35.30000000000004, -50.00000000000044, 44.900000000000006, 28.29999999999996, 29.899999999999984, 44.300000000000004, 40.90000000000002, 41.30000000000001, 39.70000000000002, 46.099999999999994, 43.7, 45.1, 39.70000000000002, 43.7, 29.299999999999976, 31.70000000000001, 41.100000000000016, 44.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 35.10000000000004, 39.70000000000002, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 47.7, 41.500000000000014, 37.50000000000003, -50.00000000000044, 37.10000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, 45.9, -50.00000000000044, 44.5, 41.500000000000014, 27.49999999999995, 23.099999999999888, 39.10000000000002, 13.299999999999748, -50.00000000000044, 0.49999999999956657, 38.700000000000024, -50.00000000000044], "episode_lengths": [188, 500, 500, 500, 500, 322, 130, 500, 54, 248, 118, 70, 436, 194, 500, 48, 42, 86, 28, 158, 114, 88, 500, 500, 500, 44, 164, 352, 34, 500, 500, 62, 58, 50, 38, 60, 500, 64, 82, 500, 500, 82, 500, 56, 500, 500, 500, 474, 148, 500, 52, 218, 202, 58, 92, 88, 104, 40, 64, 50, 104, 64, 208, 184, 90, 54, 500, 500, 66, 500, 150, 104, 46, 500, 88, 500, 500, 36, 500, 24, 86, 126, 500, 130, 74, 500, 500, 126, 42, 500, 56, 86, 226, 270, 110, 368, 500, 496, 114, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780154031634034, "mean_inference_ms": 1.2128317109771967, "mean_action_processing_ms": 0.14042128377523483, "mean_env_wait_ms": 0.08298260398239135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037993669509887695, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.12450146675109863}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.479999999999842, "episode_len_mean": 245.88, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, 37.10000000000003, -50.00000000000044, 44.7, 25.29999999999992, 38.300000000000026, 43.10000000000001, 6.499999999999652, 30.699999999999996, -50.00000000000044, 45.3, 45.9, 41.500000000000014, 47.3, 34.30000000000004, 38.700000000000024, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 33.70000000000004, 14.899999999999771, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.300000000000004, 45.1, 46.3, 44.10000000000001, -50.00000000000044, 43.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, 35.30000000000004, -50.00000000000044, 44.900000000000006, 28.29999999999996, 29.899999999999984, 44.300000000000004, 40.90000000000002, 41.30000000000001, 39.70000000000002, 46.099999999999994, 43.7, 45.1, 39.70000000000002, 43.7, 29.299999999999976, 31.70000000000001, 41.100000000000016, 44.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 35.10000000000004, 39.70000000000002, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 47.7, 41.500000000000014, 37.50000000000003, -50.00000000000044, 37.10000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, 45.9, -50.00000000000044, 44.5, 41.500000000000014, 27.49999999999995, 23.099999999999888, 39.10000000000002, 13.299999999999748, -50.00000000000044, 0.49999999999956657, 38.700000000000024, -50.00000000000044], "episode_lengths": [188, 500, 500, 500, 500, 322, 130, 500, 54, 248, 118, 70, 436, 194, 500, 48, 42, 86, 28, 158, 114, 88, 500, 500, 500, 44, 164, 352, 34, 500, 500, 62, 58, 50, 38, 60, 500, 64, 82, 500, 500, 82, 500, 56, 500, 500, 500, 474, 148, 500, 52, 218, 202, 58, 92, 88, 104, 40, 64, 50, 104, 64, 208, 184, 90, 54, 500, 500, 66, 500, 150, 104, 46, 500, 88, 500, 500, 36, 500, 24, 86, 126, 500, 130, 74, 500, 500, 126, 42, 500, 56, 86, 226, 270, 110, 368, 500, 496, 114, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780154031634034, "mean_inference_ms": 1.2128317109771967, "mean_action_processing_ms": 0.14042128377523483, "mean_env_wait_ms": 0.08298260398239135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037993669509887695, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.12450146675109863}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5695.265627408075, "num_env_steps_trained_throughput_per_sec": 5695.265627408075, "timesteps_total": 756000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 3227.548, "sample_time_ms": 2857.088, "load_time_ms": 20.342, "load_throughput": 884882.559, "learn_time_ms": 338.108, "learn_throughput": 53237.428, "synch_weights_time_ms": 9.908}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2989, "training_iteration": 42, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-54", "timestamp": 1698248034, "time_this_iter_s": 3.1672229766845703, "time_total_s": 136.34369111061096, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 136.34369111061096, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 63.225, "ram_util_percent": 26.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864642e-14, "cur_lr": 0.0003, "total_loss": 6.51197228608308, "policy_loss": -0.00011015821386266637, "vf_loss": 6.512137077472828, "vf_explained_var": -1.3289628205475985e-06, "kl": 0.00045065733921016243, "entropy": 0.5458225475417243, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1148.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.832999999999846, "episode_len_mean": 247.34, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000004, 39.70000000000002, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 47.7, 41.500000000000014, 37.50000000000003, -50.00000000000044, 37.10000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, 45.9, -50.00000000000044, 44.5, 41.500000000000014, 27.49999999999995, 23.099999999999888, 39.10000000000002, 13.299999999999748, -50.00000000000044, 0.49999999999956657, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.90000000000002, 39.70000000000002, 38.50000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.500000000000014, 5.899999999999643, 42.10000000000001, 42.30000000000001, 41.70000000000002, -50.00000000000044, 43.900000000000006, 26.499999999999936, 25.899999999999928, -50.00000000000044, 44.10000000000001, 38.700000000000024, -50.00000000000044, 42.500000000000014, 40.10000000000002, 34.30000000000004, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, 45.5, 45.1, 37.300000000000026, 38.50000000000003, -50.00000000000044, 46.3, 10.699999999999712, -50.00000000000044, 33.500000000000036, 33.70000000000004, 42.30000000000001, 44.10000000000001, -50.00000000000044, 22.49999999999988, -50.00000000000044, 34.30000000000004, 37.90000000000003, 43.10000000000001, 36.30000000000003, 34.30000000000004, -50.00000000000044, 41.90000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.3, 42.500000000000014, -50.00000000000044, 45.1, 32.30000000000002, 32.30000000000002, 44.300000000000004, 46.5], "episode_lengths": [150, 104, 46, 500, 88, 500, 500, 36, 500, 24, 86, 126, 500, 130, 74, 500, 500, 126, 42, 500, 56, 86, 226, 270, 110, 368, 500, 496, 114, 500, 500, 68, 500, 500, 500, 126, 500, 500, 52, 500, 500, 102, 104, 116, 500, 90, 500, 76, 442, 80, 78, 84, 500, 62, 236, 242, 500, 60, 114, 500, 76, 100, 158, 500, 58, 500, 46, 46, 50, 128, 116, 500, 38, 394, 500, 166, 164, 78, 60, 500, 276, 500, 158, 122, 70, 138, 158, 500, 82, 500, 58, 500, 28, 76, 500, 50, 178, 178, 58, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3779824257525605, "mean_inference_ms": 1.212841559958653, "mean_action_processing_ms": 0.1400038886999903, "mean_env_wait_ms": 0.08329885250720707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029003143310546875, "StateBufferConnector_ms": 0.00900125503540039, "ViewRequirementAgentConnector_ms": 0.09705853462219238}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.832999999999846, "episode_len_mean": 247.34, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.10000000000004, 39.70000000000002, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 47.7, 41.500000000000014, 37.50000000000003, -50.00000000000044, 37.10000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, 45.9, -50.00000000000044, 44.5, 41.500000000000014, 27.49999999999995, 23.099999999999888, 39.10000000000002, 13.299999999999748, -50.00000000000044, 0.49999999999956657, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.90000000000002, 39.70000000000002, 38.50000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.500000000000014, 5.899999999999643, 42.10000000000001, 42.30000000000001, 41.70000000000002, -50.00000000000044, 43.900000000000006, 26.499999999999936, 25.899999999999928, -50.00000000000044, 44.10000000000001, 38.700000000000024, -50.00000000000044, 42.500000000000014, 40.10000000000002, 34.30000000000004, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, 45.5, 45.1, 37.300000000000026, 38.50000000000003, -50.00000000000044, 46.3, 10.699999999999712, -50.00000000000044, 33.500000000000036, 33.70000000000004, 42.30000000000001, 44.10000000000001, -50.00000000000044, 22.49999999999988, -50.00000000000044, 34.30000000000004, 37.90000000000003, 43.10000000000001, 36.30000000000003, 34.30000000000004, -50.00000000000044, 41.90000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.3, 42.500000000000014, -50.00000000000044, 45.1, 32.30000000000002, 32.30000000000002, 44.300000000000004, 46.5], "episode_lengths": [150, 104, 46, 500, 88, 500, 500, 36, 500, 24, 86, 126, 500, 130, 74, 500, 500, 126, 42, 500, 56, 86, 226, 270, 110, 368, 500, 496, 114, 500, 500, 68, 500, 500, 500, 126, 500, 500, 52, 500, 500, 102, 104, 116, 500, 90, 500, 76, 442, 80, 78, 84, 500, 62, 236, 242, 500, 60, 114, 500, 76, 100, 158, 500, 58, 500, 46, 46, 50, 128, 116, 500, 38, 394, 500, 166, 164, 78, 60, 500, 276, 500, 158, 122, 70, 138, 158, 500, 82, 500, 58, 500, 28, 76, 500, 50, 178, 178, 58, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3779824257525605, "mean_inference_ms": 1.212841559958653, "mean_action_processing_ms": 0.1400038886999903, "mean_env_wait_ms": 0.08329885250720707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029003143310546875, "StateBufferConnector_ms": 0.00900125503540039, "ViewRequirementAgentConnector_ms": 0.09705853462219238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5718.825260934874, "num_env_steps_trained_throughput_per_sec": 5718.825260934874, "timesteps_total": 774000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 774000, "timers": {"training_iteration_time_ms": 3218.302, "sample_time_ms": 2854.126, "load_time_ms": 18.881, "load_throughput": 953323.131, "learn_time_ms": 333.355, "learn_throughput": 53996.549, "synch_weights_time_ms": 9.837}, "counters": {"num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "done": false, "episodes_total": 3059, "training_iteration": 43, "trial_id": "9f288_00012", "date": "2023-10-25_16-33-57", "timestamp": 1698248037, "time_this_iter_s": 3.153493642807007, "time_total_s": 139.49718475341797, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 139.49718475341797, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 60.275000000000006, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.273736754432321e-14, "cur_lr": 0.0003, "total_loss": 6.828960136131004, "policy_loss": -0.00043538626697328355, "vf_loss": 6.8294543690151635, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.001345633802577174, "entropy": 0.5870778693093194, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1175.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.078999999999833, "episode_len_mean": 254.86, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 37.300000000000026, 38.50000000000003, -50.00000000000044, 46.3, 10.699999999999712, -50.00000000000044, 33.500000000000036, 33.70000000000004, 42.30000000000001, 44.10000000000001, -50.00000000000044, 22.49999999999988, -50.00000000000044, 34.30000000000004, 37.90000000000003, 43.10000000000001, 36.30000000000003, 34.30000000000004, -50.00000000000044, 41.90000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.3, 42.500000000000014, -50.00000000000044, 45.1, 32.30000000000002, 32.30000000000002, 44.300000000000004, 46.5, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, 44.300000000000004, 46.3, -50.00000000000044, 37.300000000000026, -50.00000000000044, 16.09999999999979, 40.10000000000002, 32.90000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, 46.699999999999996, 33.10000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 31.70000000000001, 46.099999999999994, -50.00000000000044, 45.1, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 8.299999999999677, 38.700000000000024, 42.70000000000001, 47.7, 43.900000000000006, -50.00000000000044, 42.30000000000001, 30.699999999999996, 43.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.7, -50.00000000000044, 47.1, 12.099999999999731, 23.29999999999989, 40.70000000000002, 41.90000000000001, 0.49999999999956657, 28.499999999999964, 47.1], "episode_lengths": [50, 128, 116, 500, 38, 394, 500, 166, 164, 78, 60, 500, 276, 500, 158, 122, 70, 138, 158, 500, 82, 500, 58, 500, 28, 76, 500, 50, 178, 178, 58, 36, 500, 500, 46, 68, 500, 176, 500, 58, 38, 500, 128, 500, 340, 100, 172, 74, 500, 500, 500, 266, 500, 34, 170, 500, 72, 500, 500, 38, 184, 40, 500, 50, 50, 500, 500, 500, 500, 500, 90, 418, 114, 74, 24, 62, 500, 78, 194, 62, 68, 500, 500, 50, 82, 500, 500, 500, 500, 46, 64, 500, 30, 380, 268, 94, 82, 496, 216, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37767777170807615, "mean_inference_ms": 1.2126385271581062, "mean_action_processing_ms": 0.14045146773901152, "mean_env_wait_ms": 0.08332415094752778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019009828567504883, "StateBufferConnector_ms": 0.008999347686767578, "ViewRequirementAgentConnector_ms": 0.11342644691467285}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.078999999999833, "episode_len_mean": 254.86, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 37.300000000000026, 38.50000000000003, -50.00000000000044, 46.3, 10.699999999999712, -50.00000000000044, 33.500000000000036, 33.70000000000004, 42.30000000000001, 44.10000000000001, -50.00000000000044, 22.49999999999988, -50.00000000000044, 34.30000000000004, 37.90000000000003, 43.10000000000001, 36.30000000000003, 34.30000000000004, -50.00000000000044, 41.90000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.3, 42.500000000000014, -50.00000000000044, 45.1, 32.30000000000002, 32.30000000000002, 44.300000000000004, 46.5, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, 44.300000000000004, 46.3, -50.00000000000044, 37.300000000000026, -50.00000000000044, 16.09999999999979, 40.10000000000002, 32.90000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, 46.699999999999996, 33.10000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 31.70000000000001, 46.099999999999994, -50.00000000000044, 45.1, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 8.299999999999677, 38.700000000000024, 42.70000000000001, 47.7, 43.900000000000006, -50.00000000000044, 42.30000000000001, 30.699999999999996, 43.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.7, -50.00000000000044, 47.1, 12.099999999999731, 23.29999999999989, 40.70000000000002, 41.90000000000001, 0.49999999999956657, 28.499999999999964, 47.1], "episode_lengths": [50, 128, 116, 500, 38, 394, 500, 166, 164, 78, 60, 500, 276, 500, 158, 122, 70, 138, 158, 500, 82, 500, 58, 500, 28, 76, 500, 50, 178, 178, 58, 36, 500, 500, 46, 68, 500, 176, 500, 58, 38, 500, 128, 500, 340, 100, 172, 74, 500, 500, 500, 266, 500, 34, 170, 500, 72, 500, 500, 38, 184, 40, 500, 50, 50, 500, 500, 500, 500, 500, 90, 418, 114, 74, 24, 62, 500, 78, 194, 62, 68, 500, 500, 50, 82, 500, 500, 500, 500, 46, 64, 500, 30, 380, 268, 94, 82, 496, 216, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37767777170807615, "mean_inference_ms": 1.2126385271581062, "mean_action_processing_ms": 0.14045146773901152, "mean_env_wait_ms": 0.08332415094752778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019009828567504883, "StateBufferConnector_ms": 0.008999347686767578, "ViewRequirementAgentConnector_ms": 0.11342644691467285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5650.70681482343, "num_env_steps_trained_throughput_per_sec": 5650.70681482343, "timesteps_total": 792000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 3212.057, "sample_time_ms": 2855.52, "load_time_ms": 18.853, "load_throughput": 954773.483, "learn_time_ms": 325.646, "learn_throughput": 55274.828, "synch_weights_time_ms": 9.936}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 3127, "training_iteration": 44, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-01", "timestamp": 1698248041, "time_this_iter_s": 3.1923184394836426, "time_total_s": 142.6895031929016, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 142.6895031929016, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 57.7, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161605e-14, "cur_lr": 0.0003, "total_loss": 7.457696314211245, "policy_loss": -0.0002223195301161872, "vf_loss": 7.457974893075448, "vf_explained_var": -1.6468542593496817e-06, "kl": 0.00048396811450435997, "entropy": 0.5613598978077924, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1202.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 20.203999999999894, "episode_len_mean": 198.76, "episode_media": {}, "episodes_this_iter": 93, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.099999999999731, 23.29999999999989, 40.70000000000002, 41.90000000000001, 0.49999999999956657, 28.499999999999964, 47.1, 41.90000000000001, 45.7, -50.00000000000044, 45.1, 46.5, 41.30000000000001, 43.50000000000001, 42.70000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.500000000000014, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 13.899999999999757, 45.9, 30.9, 39.10000000000002, -50.00000000000044, -50.00000000000044, 27.699999999999953, 25.099999999999916, -50.00000000000044, 45.9, 46.099999999999994, 29.899999999999984, 45.7, 36.10000000000004, 13.499999999999751, 44.300000000000004, 43.30000000000001, 40.70000000000002, -50.00000000000044, 35.30000000000004, 46.699999999999996, -50.00000000000044, 40.70000000000002, 29.899999999999984, 44.300000000000004, 41.70000000000002, 44.300000000000004, -50.00000000000044, 36.50000000000003, 44.900000000000006, 44.300000000000004, 34.900000000000034, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 47.5, 40.30000000000002, 46.099999999999994, 37.50000000000003, 46.9, 21.699999999999868, 36.70000000000003, 22.699999999999882, 46.9, 40.10000000000002, 25.099999999999916, 45.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.3, 46.099999999999994, 46.699999999999996, 43.30000000000001, 42.70000000000001, -50.00000000000044, 17.899999999999814, 17.69999999999981, 38.700000000000024, 46.5, 39.300000000000026, 43.30000000000001, 25.499999999999922, 45.9, 19.899999999999842, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 35.500000000000036, 37.90000000000003, 20.299999999999848], "episode_lengths": [380, 268, 94, 82, 496, 216, 30, 82, 44, 500, 50, 36, 88, 66, 74, 70, 500, 500, 500, 32, 76, 56, 76, 500, 500, 362, 42, 192, 110, 500, 500, 224, 250, 500, 42, 40, 202, 44, 140, 366, 58, 68, 94, 500, 148, 34, 500, 94, 202, 58, 84, 58, 500, 136, 52, 58, 152, 144, 500, 500, 46, 500, 26, 98, 40, 126, 32, 284, 134, 274, 32, 100, 250, 44, 82, 500, 500, 40, 38, 40, 34, 68, 74, 500, 322, 324, 114, 36, 108, 68, 246, 42, 302, 68, 500, 48, 500, 146, 122, 298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775623086458388, "mean_inference_ms": 1.2115980253329237, "mean_action_processing_ms": 0.13996570574739353, "mean_env_wait_ms": 0.08310419700797368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025037050247192383, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.11734533309936523}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 20.203999999999894, "episode_len_mean": 198.76, "episodes_this_iter": 93, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.099999999999731, 23.29999999999989, 40.70000000000002, 41.90000000000001, 0.49999999999956657, 28.499999999999964, 47.1, 41.90000000000001, 45.7, -50.00000000000044, 45.1, 46.5, 41.30000000000001, 43.50000000000001, 42.70000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.500000000000014, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 13.899999999999757, 45.9, 30.9, 39.10000000000002, -50.00000000000044, -50.00000000000044, 27.699999999999953, 25.099999999999916, -50.00000000000044, 45.9, 46.099999999999994, 29.899999999999984, 45.7, 36.10000000000004, 13.499999999999751, 44.300000000000004, 43.30000000000001, 40.70000000000002, -50.00000000000044, 35.30000000000004, 46.699999999999996, -50.00000000000044, 40.70000000000002, 29.899999999999984, 44.300000000000004, 41.70000000000002, 44.300000000000004, -50.00000000000044, 36.50000000000003, 44.900000000000006, 44.300000000000004, 34.900000000000034, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 47.5, 40.30000000000002, 46.099999999999994, 37.50000000000003, 46.9, 21.699999999999868, 36.70000000000003, 22.699999999999882, 46.9, 40.10000000000002, 25.099999999999916, 45.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.3, 46.099999999999994, 46.699999999999996, 43.30000000000001, 42.70000000000001, -50.00000000000044, 17.899999999999814, 17.69999999999981, 38.700000000000024, 46.5, 39.300000000000026, 43.30000000000001, 25.499999999999922, 45.9, 19.899999999999842, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 35.500000000000036, 37.90000000000003, 20.299999999999848], "episode_lengths": [380, 268, 94, 82, 496, 216, 30, 82, 44, 500, 50, 36, 88, 66, 74, 70, 500, 500, 500, 32, 76, 56, 76, 500, 500, 362, 42, 192, 110, 500, 500, 224, 250, 500, 42, 40, 202, 44, 140, 366, 58, 68, 94, 500, 148, 34, 500, 94, 202, 58, 84, 58, 500, 136, 52, 58, 152, 144, 500, 500, 46, 500, 26, 98, 40, 126, 32, 284, 134, 274, 32, 100, 250, 44, 82, 500, 500, 40, 38, 40, 34, 68, 74, 500, 322, 324, 114, 36, 108, 68, 246, 42, 302, 68, 500, 48, 500, 146, 122, 298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775623086458388, "mean_inference_ms": 1.2115980253329237, "mean_action_processing_ms": 0.13996570574739353, "mean_env_wait_ms": 0.08310419700797368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025037050247192383, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.11734533309936523}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5442.691406582013, "num_env_steps_trained_throughput_per_sec": 5442.691406582013, "timesteps_total": 810000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 810000, "timers": {"training_iteration_time_ms": 3226.42, "sample_time_ms": 2856.893, "load_time_ms": 19.824, "load_throughput": 908009.78, "learn_time_ms": 337.632, "learn_throughput": 53312.443, "synch_weights_time_ms": 9.969}, "counters": {"num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "done": false, "episodes_total": 3220, "training_iteration": 45, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-04", "timestamp": 1698248044, "time_this_iter_s": 3.3128910064697266, "time_total_s": 146.00239419937134, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 146.00239419937134, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 54.3, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860808026e-15, "cur_lr": 0.0003, "total_loss": 6.2648998543068215, "policy_loss": -0.000255525672131356, "vf_loss": 6.265206725509079, "vf_explained_var": -8.322574474193432e-07, "kl": 0.0005557270371651965, "entropy": 0.5125482910209231, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1229.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.464999999999836, "episode_len_mean": 241.02, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.50000000000003, 46.9, 21.699999999999868, 36.70000000000003, 22.699999999999882, 46.9, 40.10000000000002, 25.099999999999916, 45.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.3, 46.099999999999994, 46.699999999999996, 43.30000000000001, 42.70000000000001, -50.00000000000044, 17.899999999999814, 17.69999999999981, 38.700000000000024, 46.5, 39.300000000000026, 43.30000000000001, 25.499999999999922, 45.9, 19.899999999999842, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 35.500000000000036, 37.90000000000003, 20.299999999999848, 46.099999999999994, 43.10000000000001, 1.4999999999995808, 39.50000000000002, 28.499999999999964, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.300000000000004, 27.099999999999945, 41.90000000000001, -50.00000000000044, 41.70000000000002, 36.30000000000003, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.10000000000001, -50.00000000000044, 43.30000000000001, 46.5, 46.3, 19.499999999999837, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 44.7, 43.7, -50.00000000000044, 42.70000000000001, 46.699999999999996, 46.099999999999994, 12.099999999999731, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.099999999999994, -50.00000000000044, 46.9, -50.00000000000044, 42.900000000000006, 46.099999999999994, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004], "episode_lengths": [126, 32, 284, 134, 274, 32, 100, 250, 44, 82, 500, 500, 40, 38, 40, 34, 68, 74, 500, 322, 324, 114, 36, 108, 68, 246, 42, 302, 68, 500, 48, 500, 146, 122, 298, 40, 70, 486, 106, 216, 500, 58, 500, 58, 230, 82, 500, 84, 138, 500, 42, 500, 500, 46, 500, 500, 500, 122, 60, 500, 68, 36, 38, 306, 66, 40, 500, 500, 66, 500, 56, 500, 500, 192, 500, 500, 54, 64, 500, 74, 34, 40, 380, 500, 500, 500, 500, 500, 500, 48, 40, 500, 32, 500, 72, 40, 64, 500, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37744600797404815, "mean_inference_ms": 1.2115523598487312, "mean_action_processing_ms": 0.1401006479354541, "mean_env_wait_ms": 0.08321797928792789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240018367767334, "StateBufferConnector_ms": 0.00899815559387207, "ViewRequirementAgentConnector_ms": 0.11694717407226562}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.464999999999836, "episode_len_mean": 241.02, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.50000000000003, 46.9, 21.699999999999868, 36.70000000000003, 22.699999999999882, 46.9, 40.10000000000002, 25.099999999999916, 45.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.3, 46.099999999999994, 46.699999999999996, 43.30000000000001, 42.70000000000001, -50.00000000000044, 17.899999999999814, 17.69999999999981, 38.700000000000024, 46.5, 39.300000000000026, 43.30000000000001, 25.499999999999922, 45.9, 19.899999999999842, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 35.500000000000036, 37.90000000000003, 20.299999999999848, 46.099999999999994, 43.10000000000001, 1.4999999999995808, 39.50000000000002, 28.499999999999964, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.300000000000004, 27.099999999999945, 41.90000000000001, -50.00000000000044, 41.70000000000002, 36.30000000000003, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.10000000000001, -50.00000000000044, 43.30000000000001, 46.5, 46.3, 19.499999999999837, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 44.7, 43.7, -50.00000000000044, 42.70000000000001, 46.699999999999996, 46.099999999999994, 12.099999999999731, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.099999999999994, -50.00000000000044, 46.9, -50.00000000000044, 42.900000000000006, 46.099999999999994, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004], "episode_lengths": [126, 32, 284, 134, 274, 32, 100, 250, 44, 82, 500, 500, 40, 38, 40, 34, 68, 74, 500, 322, 324, 114, 36, 108, 68, 246, 42, 302, 68, 500, 48, 500, 146, 122, 298, 40, 70, 486, 106, 216, 500, 58, 500, 58, 230, 82, 500, 84, 138, 500, 42, 500, 500, 46, 500, 500, 500, 122, 60, 500, 68, 36, 38, 306, 66, 40, 500, 500, 66, 500, 56, 500, 500, 192, 500, 500, 54, 64, 500, 74, 34, 40, 380, 500, 500, 500, 500, 500, 500, 48, 40, 500, 32, 500, 72, 40, 64, 500, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37744600797404815, "mean_inference_ms": 1.2115523598487312, "mean_action_processing_ms": 0.1401006479354541, "mean_env_wait_ms": 0.08321797928792789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240018367767334, "StateBufferConnector_ms": 0.00899815559387207, "ViewRequirementAgentConnector_ms": 0.11694717407226562}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5620.836774815188, "num_env_steps_trained_throughput_per_sec": 5620.836774815188, "timesteps_total": 828000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 3226.568, "sample_time_ms": 2857.929, "load_time_ms": 19.64, "load_throughput": 916473.921, "learn_time_ms": 337.009, "learn_throughput": 53411.017, "synch_weights_time_ms": 9.886}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3285, "training_iteration": 46, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-07", "timestamp": 1698248047, "time_this_iter_s": 3.2093608379364014, "time_total_s": 149.21175503730774, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 149.21175503730774, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 63.55, "ram_util_percent": 26.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404013e-15, "cur_lr": 0.0003, "total_loss": 6.575818273756239, "policy_loss": -6.742803034959016e-05, "vf_loss": 6.5759352048238116, "vf_explained_var": -1.9205941094292534e-06, "kl": 0.0001938988691794537, "entropy": 0.494698996897097, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1256.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.35999999999983, "episode_len_mean": 247.04, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.9, -50.00000000000044, -50.00000000000044, 44.7, 43.7, -50.00000000000044, 42.70000000000001, 46.699999999999996, 46.099999999999994, 12.099999999999731, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.099999999999994, -50.00000000000044, 46.9, -50.00000000000044, 42.900000000000006, 46.099999999999994, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 33.70000000000004, -50.00000000000044, 10.299999999999706, 41.500000000000014, 45.1, 47.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.50000000000003, 36.50000000000003, 46.699999999999996, -50.00000000000044, 41.90000000000001, 44.7, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 47.5, -50.00000000000044, 43.900000000000006, 41.500000000000014, 38.90000000000002, 38.10000000000002, 36.30000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 20.49999999999985, 39.50000000000002, 42.70000000000001, 40.30000000000002, -50.00000000000044, 32.100000000000016, 45.5, 46.5, 42.10000000000001, 41.90000000000001, 32.50000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.50000000000002, 41.70000000000002, 43.50000000000001, 38.50000000000003, -50.00000000000044, 5.6999999999996405, 38.50000000000003, 43.7, -50.00000000000044, 45.3, 2.499999999999595, 44.300000000000004, 46.099999999999994, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, 46.699999999999996, 44.5, 40.500000000000014], "episode_lengths": [192, 500, 500, 54, 64, 500, 74, 34, 40, 380, 500, 500, 500, 500, 500, 500, 48, 40, 500, 32, 500, 72, 40, 64, 500, 500, 58, 42, 500, 500, 34, 164, 500, 398, 86, 50, 22, 62, 500, 500, 136, 136, 34, 500, 82, 54, 500, 342, 500, 500, 52, 500, 500, 48, 500, 26, 500, 62, 86, 112, 120, 138, 68, 500, 500, 296, 106, 74, 98, 500, 180, 46, 36, 80, 82, 176, 500, 500, 72, 500, 106, 84, 66, 116, 500, 444, 116, 64, 500, 48, 476, 58, 40, 500, 78, 30, 500, 34, 56, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774355288805431, "mean_inference_ms": 1.2108365511763894, "mean_action_processing_ms": 0.140341696960086, "mean_env_wait_ms": 0.0830890284099025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028510332107543945, "StateBufferConnector_ms": 0.003793954849243164, "ViewRequirementAgentConnector_ms": 0.1421051025390625}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.35999999999983, "episode_len_mean": 247.04, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.9, -50.00000000000044, -50.00000000000044, 44.7, 43.7, -50.00000000000044, 42.70000000000001, 46.699999999999996, 46.099999999999994, 12.099999999999731, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.099999999999994, -50.00000000000044, 46.9, -50.00000000000044, 42.900000000000006, 46.099999999999994, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 33.70000000000004, -50.00000000000044, 10.299999999999706, 41.500000000000014, 45.1, 47.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.50000000000003, 36.50000000000003, 46.699999999999996, -50.00000000000044, 41.90000000000001, 44.7, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 47.5, -50.00000000000044, 43.900000000000006, 41.500000000000014, 38.90000000000002, 38.10000000000002, 36.30000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 20.49999999999985, 39.50000000000002, 42.70000000000001, 40.30000000000002, -50.00000000000044, 32.100000000000016, 45.5, 46.5, 42.10000000000001, 41.90000000000001, 32.50000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.50000000000002, 41.70000000000002, 43.50000000000001, 38.50000000000003, -50.00000000000044, 5.6999999999996405, 38.50000000000003, 43.7, -50.00000000000044, 45.3, 2.499999999999595, 44.300000000000004, 46.099999999999994, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, 46.699999999999996, 44.5, 40.500000000000014], "episode_lengths": [192, 500, 500, 54, 64, 500, 74, 34, 40, 380, 500, 500, 500, 500, 500, 500, 48, 40, 500, 32, 500, 72, 40, 64, 500, 500, 58, 42, 500, 500, 34, 164, 500, 398, 86, 50, 22, 62, 500, 500, 136, 136, 34, 500, 82, 54, 500, 342, 500, 500, 52, 500, 500, 48, 500, 26, 500, 62, 86, 112, 120, 138, 68, 500, 500, 296, 106, 74, 98, 500, 180, 46, 36, 80, 82, 176, 500, 500, 72, 500, 106, 84, 66, 116, 500, 444, 116, 64, 500, 48, 476, 58, 40, 500, 78, 30, 500, 34, 56, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774355288805431, "mean_inference_ms": 1.2108365511763894, "mean_action_processing_ms": 0.140341696960086, "mean_env_wait_ms": 0.0830890284099025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028510332107543945, "StateBufferConnector_ms": 0.003793954849243164, "ViewRequirementAgentConnector_ms": 0.1421051025390625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5312.403498366504, "num_env_steps_trained_throughput_per_sec": 5312.403498366504, "timesteps_total": 846000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 846000, "timers": {"training_iteration_time_ms": 3244.81, "sample_time_ms": 2876.12, "load_time_ms": 20.353, "load_throughput": 884401.586, "learn_time_ms": 336.458, "learn_throughput": 53498.427, "synch_weights_time_ms": 9.873}, "counters": {"num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "done": false, "episodes_total": 3358, "training_iteration": 47, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-11", "timestamp": 1698248051, "time_this_iter_s": 3.3933045864105225, "time_total_s": 152.60505962371826, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 152.60505962371826, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 55.54, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 0.0003, "total_loss": 6.698089140432852, "policy_loss": -0.0002415795569066648, "vf_loss": 6.698382889782941, "vf_explained_var": -1.4702479044596355e-06, "kl": 0.0004820646723797179, "entropy": 0.5211254910186485, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1283.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.4309999999998295, "episode_len_mean": 251.32, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 42.10000000000001, 41.90000000000001, 32.50000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.50000000000002, 41.70000000000002, 43.50000000000001, 38.50000000000003, -50.00000000000044, 5.6999999999996405, 38.50000000000003, 43.7, -50.00000000000044, 45.3, 2.499999999999595, 44.300000000000004, 46.099999999999994, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, 46.699999999999996, 44.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.5, 36.900000000000034, -50.00000000000044, 37.300000000000026, 47.5, 23.099999999999888, 31.900000000000013, 39.70000000000002, -50.00000000000044, 39.10000000000002, 39.300000000000026, -50.00000000000044, 37.90000000000003, 46.3, 45.1, 47.1, -50.00000000000044, 41.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 43.7, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.5, 23.499999999999893, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, 41.90000000000001, 39.90000000000002, 44.7, 36.30000000000003, 41.30000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, 21.299999999999862, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.3, 26.499999999999936, 37.10000000000003], "episode_lengths": [36, 80, 82, 176, 500, 500, 72, 500, 106, 84, 66, 116, 500, 444, 116, 64, 500, 48, 476, 58, 40, 500, 78, 30, 500, 34, 56, 96, 500, 500, 500, 104, 36, 132, 500, 128, 26, 270, 182, 104, 500, 110, 108, 500, 122, 38, 50, 30, 500, 88, 114, 500, 500, 62, 500, 36, 500, 64, 500, 46, 500, 500, 144, 46, 266, 500, 60, 500, 38, 72, 500, 74, 500, 74, 82, 102, 54, 138, 88, 500, 134, 500, 288, 92, 500, 500, 500, 136, 66, 500, 500, 500, 500, 500, 66, 500, 500, 38, 236, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37709660254068145, "mean_inference_ms": 1.2107597317975656, "mean_action_processing_ms": 0.1403926196661783, "mean_env_wait_ms": 0.08307100877042792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028004169464111328, "StateBufferConnector_ms": 0.0067403316497802734, "ViewRequirementAgentConnector_ms": 0.11555933952331543}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.4309999999998295, "episode_len_mean": 251.32, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 42.10000000000001, 41.90000000000001, 32.50000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.50000000000002, 41.70000000000002, 43.50000000000001, 38.50000000000003, -50.00000000000044, 5.6999999999996405, 38.50000000000003, 43.7, -50.00000000000044, 45.3, 2.499999999999595, 44.300000000000004, 46.099999999999994, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, 46.699999999999996, 44.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.5, 36.900000000000034, -50.00000000000044, 37.300000000000026, 47.5, 23.099999999999888, 31.900000000000013, 39.70000000000002, -50.00000000000044, 39.10000000000002, 39.300000000000026, -50.00000000000044, 37.90000000000003, 46.3, 45.1, 47.1, -50.00000000000044, 41.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 43.7, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.5, 23.499999999999893, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, 41.90000000000001, 39.90000000000002, 44.7, 36.30000000000003, 41.30000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, 21.299999999999862, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.3, 26.499999999999936, 37.10000000000003], "episode_lengths": [36, 80, 82, 176, 500, 500, 72, 500, 106, 84, 66, 116, 500, 444, 116, 64, 500, 48, 476, 58, 40, 500, 78, 30, 500, 34, 56, 96, 500, 500, 500, 104, 36, 132, 500, 128, 26, 270, 182, 104, 500, 110, 108, 500, 122, 38, 50, 30, 500, 88, 114, 500, 500, 62, 500, 36, 500, 64, 500, 46, 500, 500, 144, 46, 266, 500, 60, 500, 38, 72, 500, 74, 500, 74, 82, 102, 54, 138, 88, 500, 134, 500, 288, 92, 500, 500, 500, 136, 66, 500, 500, 500, 500, 500, 66, 500, 500, 38, 236, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37709660254068145, "mean_inference_ms": 1.2107597317975656, "mean_action_processing_ms": 0.1403926196661783, "mean_env_wait_ms": 0.08307100877042792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028004169464111328, "StateBufferConnector_ms": 0.0067403316497802734, "ViewRequirementAgentConnector_ms": 0.11555933952331543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5721.140313732076, "num_env_steps_trained_throughput_per_sec": 5721.140313732076, "timesteps_total": 864000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 3242.541, "sample_time_ms": 2877.442, "load_time_ms": 18.986, "load_throughput": 948050.993, "learn_time_ms": 334.16, "learn_throughput": 53866.343, "synch_weights_time_ms": 9.971}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3430, "training_iteration": 48, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-14", "timestamp": 1698248054, "time_this_iter_s": 3.151221513748169, "time_total_s": 155.75628113746643, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 155.75628113746643, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 61.275, "ram_util_percent": 26.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601003e-16, "cur_lr": 0.0003, "total_loss": 6.304981708526611, "policy_loss": -0.0005255467517094479, "vf_loss": 6.305558752130579, "vf_explained_var": -1.0861290825737847e-06, "kl": 0.00083774582174522, "entropy": 0.5148768193191953, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1310.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.8390000000002027, "episode_len_mean": 283.94, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.70000000000003, 45.5, 23.499999999999893, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, 41.90000000000001, 39.90000000000002, 44.7, 36.30000000000003, 41.30000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, 21.299999999999862, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.3, 26.499999999999936, 37.10000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.10000000000002, 45.9, 42.500000000000014, 46.3, 9.499999999999694, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 38.50000000000003, 45.9, -50.00000000000044, 45.7, 45.1, 20.299999999999848, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.7, 32.30000000000002, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.5, 42.10000000000001, 33.30000000000003, -50.00000000000044, 29.099999999999973, 28.89999999999997], "episode_lengths": [500, 144, 46, 266, 500, 60, 500, 38, 72, 500, 74, 500, 74, 82, 102, 54, 138, 88, 500, 134, 500, 288, 92, 500, 500, 500, 136, 66, 500, 500, 500, 500, 500, 66, 500, 500, 38, 236, 130, 500, 86, 500, 500, 500, 168, 500, 58, 60, 500, 500, 40, 100, 42, 76, 38, 406, 500, 500, 72, 500, 116, 42, 500, 44, 50, 298, 500, 74, 500, 500, 60, 500, 76, 500, 500, 500, 70, 134, 500, 500, 32, 500, 500, 60, 500, 40, 500, 54, 178, 500, 198, 500, 500, 72, 56, 80, 168, 500, 210, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769680788625723, "mean_inference_ms": 1.2107330149383881, "mean_action_processing_ms": 0.14015067464571618, "mean_env_wait_ms": 0.08294996285637111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028911590576171875, "StateBufferConnector_ms": 0.007787227630615234, "ViewRequirementAgentConnector_ms": 0.11650466918945312}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.8390000000002027, "episode_len_mean": 283.94, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.70000000000003, 45.5, 23.499999999999893, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, 41.90000000000001, 39.90000000000002, 44.7, 36.30000000000003, 41.30000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, 21.299999999999862, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.3, 26.499999999999936, 37.10000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.10000000000002, 45.9, 42.500000000000014, 46.3, 9.499999999999694, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 38.50000000000003, 45.9, -50.00000000000044, 45.7, 45.1, 20.299999999999848, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.7, 32.30000000000002, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.5, 42.10000000000001, 33.30000000000003, -50.00000000000044, 29.099999999999973, 28.89999999999997], "episode_lengths": [500, 144, 46, 266, 500, 60, 500, 38, 72, 500, 74, 500, 74, 82, 102, 54, 138, 88, 500, 134, 500, 288, 92, 500, 500, 500, 136, 66, 500, 500, 500, 500, 500, 66, 500, 500, 38, 236, 130, 500, 86, 500, 500, 500, 168, 500, 58, 60, 500, 500, 40, 100, 42, 76, 38, 406, 500, 500, 72, 500, 116, 42, 500, 44, 50, 298, 500, 74, 500, 500, 60, 500, 76, 500, 500, 500, 70, 134, 500, 500, 32, 500, 500, 60, 500, 40, 500, 54, 178, 500, 198, 500, 500, 72, 56, 80, 168, 500, 210, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769680788625723, "mean_inference_ms": 1.2107330149383881, "mean_action_processing_ms": 0.14015067464571618, "mean_env_wait_ms": 0.08294996285637111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028911590576171875, "StateBufferConnector_ms": 0.007787227630615234, "ViewRequirementAgentConnector_ms": 0.11650466918945312}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5619.630570235936, "num_env_steps_trained_throughput_per_sec": 5619.630570235936, "timesteps_total": 882000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 882000, "timers": {"training_iteration_time_ms": 3238.244, "sample_time_ms": 2873.152, "load_time_ms": 20.072, "load_throughput": 896778.758, "learn_time_ms": 333.122, "learn_throughput": 54034.302, "synch_weights_time_ms": 9.917}, "counters": {"num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "done": false, "episodes_total": 3491, "training_iteration": 49, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-17", "timestamp": 1698248057, "time_this_iter_s": 3.2090506553649902, "time_total_s": 158.96533179283142, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 158.96533179283142, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 58.379999999999995, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788005016e-16, "cur_lr": 0.0003, "total_loss": 6.962337264308223, "policy_loss": -0.00033297582908912944, "vf_loss": 6.9627195640846535, "vf_explained_var": -8.80824195014106e-07, "kl": 0.0007841689277517651, "entropy": 0.49225557733465125, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1337.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.6659999999998021, "episode_len_mean": 283.92, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.7, 32.30000000000002, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.5, 42.10000000000001, 33.30000000000003, -50.00000000000044, 29.099999999999973, 28.89999999999997, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.10000000000002, 9.8999999999997, -50.00000000000044, -50.00000000000044, 44.5, 32.700000000000024, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 39.300000000000026, 39.300000000000026, -50.00000000000044, 13.099999999999746, 45.3, 43.7, 41.500000000000014, 45.5, -50.00000000000044, 43.900000000000006, 36.900000000000034, 38.700000000000024, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 8.899999999999686, -50.00000000000044, 26.499999999999936, 44.300000000000004, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 45.3, 44.7, 29.299999999999976, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 44.900000000000006, 40.90000000000002, 37.70000000000003, 36.70000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, 34.900000000000034, 42.70000000000001, 46.099999999999994, 21.699999999999868, 45.3, 1.099999999999575], "episode_lengths": [74, 500, 500, 60, 500, 76, 500, 500, 500, 70, 134, 500, 500, 32, 500, 500, 60, 500, 40, 500, 54, 178, 500, 198, 500, 500, 72, 56, 80, 168, 500, 210, 212, 500, 500, 70, 100, 402, 500, 500, 56, 174, 500, 84, 500, 500, 78, 108, 108, 500, 370, 48, 64, 86, 46, 500, 62, 132, 114, 500, 500, 226, 500, 500, 500, 500, 500, 70, 412, 500, 236, 58, 92, 500, 36, 500, 500, 500, 36, 72, 48, 54, 208, 500, 500, 292, 500, 52, 92, 124, 134, 500, 186, 500, 152, 74, 40, 284, 48, 490]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37696622739689195, "mean_inference_ms": 1.2097413954747873, "mean_action_processing_ms": 0.13998280599059318, "mean_env_wait_ms": 0.08289564401110211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03336381912231445, "StateBufferConnector_ms": 0.009021520614624023, "ViewRequirementAgentConnector_ms": 0.11717915534973145}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.6659999999998021, "episode_len_mean": 283.92, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.7, 32.30000000000002, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.5, 42.10000000000001, 33.30000000000003, -50.00000000000044, 29.099999999999973, 28.89999999999997, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.10000000000002, 9.8999999999997, -50.00000000000044, -50.00000000000044, 44.5, 32.700000000000024, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 39.300000000000026, 39.300000000000026, -50.00000000000044, 13.099999999999746, 45.3, 43.7, 41.500000000000014, 45.5, -50.00000000000044, 43.900000000000006, 36.900000000000034, 38.700000000000024, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 8.899999999999686, -50.00000000000044, 26.499999999999936, 44.300000000000004, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 45.3, 44.7, 29.299999999999976, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 44.900000000000006, 40.90000000000002, 37.70000000000003, 36.70000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, 34.900000000000034, 42.70000000000001, 46.099999999999994, 21.699999999999868, 45.3, 1.099999999999575], "episode_lengths": [74, 500, 500, 60, 500, 76, 500, 500, 500, 70, 134, 500, 500, 32, 500, 500, 60, 500, 40, 500, 54, 178, 500, 198, 500, 500, 72, 56, 80, 168, 500, 210, 212, 500, 500, 70, 100, 402, 500, 500, 56, 174, 500, 84, 500, 500, 78, 108, 108, 500, 370, 48, 64, 86, 46, 500, 62, 132, 114, 500, 500, 226, 500, 500, 500, 500, 500, 70, 412, 500, 236, 58, 92, 500, 36, 500, 500, 500, 36, 72, 48, 54, 208, 500, 500, 292, 500, 52, 92, 124, 134, 500, 186, 500, 152, 74, 40, 284, 48, 490]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37696622739689195, "mean_inference_ms": 1.2097413954747873, "mean_action_processing_ms": 0.13998280599059318, "mean_env_wait_ms": 0.08289564401110211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03336381912231445, "StateBufferConnector_ms": 0.009021520614624023, "ViewRequirementAgentConnector_ms": 0.11717915534973145}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 6088.66735254508, "num_env_steps_trained_throughput_per_sec": 6088.66735254508, "timesteps_total": 900000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 3210.644, "sample_time_ms": 2867.786, "load_time_ms": 18.817, "load_throughput": 956602.642, "learn_time_ms": 311.899, "learn_throughput": 57710.956, "synch_weights_time_ms": 9.955}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3558, "training_iteration": 50, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-20", "timestamp": 1698248060, "time_this_iter_s": 2.963305711746216, "time_total_s": 161.92863750457764, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 161.92863750457764, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 62.45, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002508e-16, "cur_lr": 0.0003, "total_loss": 6.200914965735541, "policy_loss": -6.526500348829561e-05, "vf_loss": 6.20103140230532, "vf_explained_var": -7.549921671549479e-07, "kl": 0.000953498619285003, "entropy": 0.5120355387528738, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1364.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7659999999998002, "episode_len_mean": 282.92, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 8.899999999999686, -50.00000000000044, 26.499999999999936, 44.300000000000004, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 45.3, 44.7, 29.299999999999976, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 44.900000000000006, 40.90000000000002, 37.70000000000003, 36.70000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, 34.900000000000034, 42.70000000000001, 46.099999999999994, 21.699999999999868, 45.3, 1.099999999999575, 19.299999999999834, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.9, 46.099999999999994, 41.30000000000001, 46.699999999999996, 44.7, 29.099999999999973, -50.00000000000044, 43.7, -50.00000000000044, 40.10000000000002, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 35.30000000000004, 34.30000000000004, -50.00000000000044, -50.00000000000044, 45.3, 42.30000000000001, 24.899999999999913, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 47.1, -50.00000000000044, 39.300000000000026, -50.00000000000044, 42.500000000000014, 44.10000000000001, 20.099999999999845, -50.00000000000044, -50.00000000000044, 41.70000000000002, 4.899999999999629, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.300000000000026, 32.100000000000016, -50.00000000000044, 43.10000000000001], "episode_lengths": [500, 226, 500, 500, 500, 500, 500, 70, 412, 500, 236, 58, 92, 500, 36, 500, 500, 500, 36, 72, 48, 54, 208, 500, 500, 292, 500, 52, 92, 124, 134, 500, 186, 500, 152, 74, 40, 284, 48, 490, 308, 48, 500, 500, 58, 36, 500, 500, 170, 500, 32, 40, 88, 34, 54, 210, 500, 64, 500, 100, 500, 134, 500, 500, 36, 500, 148, 158, 500, 500, 48, 78, 252, 38, 500, 500, 500, 500, 500, 76, 30, 500, 108, 500, 76, 60, 300, 500, 500, 84, 452, 46, 500, 52, 500, 500, 108, 180, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767017145298414, "mean_inference_ms": 1.20899482358599, "mean_action_processing_ms": 0.1402176256083598, "mean_env_wait_ms": 0.08288681086209042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200697898864746, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.12634491920471191}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7659999999998002, "episode_len_mean": 282.92, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 8.899999999999686, -50.00000000000044, 26.499999999999936, 44.300000000000004, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 45.3, 44.7, 29.299999999999976, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 44.900000000000006, 40.90000000000002, 37.70000000000003, 36.70000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, 34.900000000000034, 42.70000000000001, 46.099999999999994, 21.699999999999868, 45.3, 1.099999999999575, 19.299999999999834, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.9, 46.099999999999994, 41.30000000000001, 46.699999999999996, 44.7, 29.099999999999973, -50.00000000000044, 43.7, -50.00000000000044, 40.10000000000002, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 35.30000000000004, 34.30000000000004, -50.00000000000044, -50.00000000000044, 45.3, 42.30000000000001, 24.899999999999913, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 47.1, -50.00000000000044, 39.300000000000026, -50.00000000000044, 42.500000000000014, 44.10000000000001, 20.099999999999845, -50.00000000000044, -50.00000000000044, 41.70000000000002, 4.899999999999629, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.300000000000026, 32.100000000000016, -50.00000000000044, 43.10000000000001], "episode_lengths": [500, 226, 500, 500, 500, 500, 500, 70, 412, 500, 236, 58, 92, 500, 36, 500, 500, 500, 36, 72, 48, 54, 208, 500, 500, 292, 500, 52, 92, 124, 134, 500, 186, 500, 152, 74, 40, 284, 48, 490, 308, 48, 500, 500, 58, 36, 500, 500, 170, 500, 32, 40, 88, 34, 54, 210, 500, 64, 500, 100, 500, 134, 500, 500, 36, 500, 148, 158, 500, 500, 48, 78, 252, 38, 500, 500, 500, 500, 500, 76, 30, 500, 108, 500, 76, 60, 300, 500, 500, 84, 452, 46, 500, 52, 500, 500, 108, 180, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767017145298414, "mean_inference_ms": 1.20899482358599, "mean_action_processing_ms": 0.1402176256083598, "mean_env_wait_ms": 0.08288681086209042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200697898864746, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.12634491920471191}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5865.528679744152, "num_env_steps_trained_throughput_per_sec": 5865.528679744152, "timesteps_total": 918000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 918000, "timers": {"training_iteration_time_ms": 3176.471, "sample_time_ms": 2838.879, "load_time_ms": 18.76, "load_throughput": 959499.773, "learn_time_ms": 307.089, "learn_throughput": 58614.948, "synch_weights_time_ms": 9.555}, "counters": {"num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "done": false, "episodes_total": 3618, "training_iteration": 51, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-23", "timestamp": 1698248063, "time_this_iter_s": 3.074767589569092, "time_total_s": 165.00340509414673, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 165.00340509414673, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 60.7, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001254e-17, "cur_lr": 0.0003, "total_loss": 6.571984397040473, "policy_loss": -6.521534588601854e-05, "vf_loss": 6.572099173510516, "vf_explained_var": -8.962772510669849e-07, "kl": 0.00022637612077331865, "entropy": 0.4951779731997737, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1391.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.604999999999813, "episode_len_mean": 269.56, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, 42.30000000000001, 24.899999999999913, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 47.1, -50.00000000000044, 39.300000000000026, -50.00000000000044, 42.500000000000014, 44.10000000000001, 20.099999999999845, -50.00000000000044, -50.00000000000044, 41.70000000000002, 4.899999999999629, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.300000000000026, 32.100000000000016, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.50000000000002, 45.7, 44.300000000000004, 44.900000000000006, -50.00000000000044, 36.900000000000034, 46.099999999999994, 33.10000000000003, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 33.10000000000003, 38.10000000000002, 46.3, 39.300000000000026, -50.00000000000044, 1.6999999999995836, 43.10000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 24.299999999999905, 43.50000000000001, 41.90000000000001, 44.900000000000006, -50.00000000000044, 15.299999999999777, 45.1, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 25.29999999999992, 45.9, 40.30000000000002, 46.099999999999994, 44.900000000000006, 36.30000000000003, 45.5, -50.00000000000044, 32.50000000000002, 44.5, 16.8999999999998, 28.699999999999967, 24.499999999999908, 32.100000000000016, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001], "episode_lengths": [500, 48, 78, 252, 38, 500, 500, 500, 500, 500, 76, 30, 500, 108, 500, 76, 60, 300, 500, 500, 84, 452, 46, 500, 52, 500, 500, 108, 180, 500, 70, 500, 60, 500, 106, 44, 58, 52, 500, 132, 40, 170, 64, 500, 40, 500, 50, 500, 500, 170, 120, 38, 108, 500, 484, 70, 500, 86, 500, 500, 500, 42, 124, 500, 500, 500, 42, 258, 66, 82, 52, 500, 348, 50, 500, 116, 500, 500, 500, 500, 50, 248, 42, 98, 40, 52, 138, 46, 500, 176, 56, 332, 214, 256, 180, 338, 500, 500, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762487014493317, "mean_inference_ms": 1.2087992593405203, "mean_action_processing_ms": 0.13978008152050872, "mean_env_wait_ms": 0.08277345896440172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701115608215332, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.11477494239807129}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.604999999999813, "episode_len_mean": 269.56, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, 42.30000000000001, 24.899999999999913, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 47.1, -50.00000000000044, 39.300000000000026, -50.00000000000044, 42.500000000000014, 44.10000000000001, 20.099999999999845, -50.00000000000044, -50.00000000000044, 41.70000000000002, 4.899999999999629, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.300000000000026, 32.100000000000016, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.50000000000002, 45.7, 44.300000000000004, 44.900000000000006, -50.00000000000044, 36.900000000000034, 46.099999999999994, 33.10000000000003, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 33.10000000000003, 38.10000000000002, 46.3, 39.300000000000026, -50.00000000000044, 1.6999999999995836, 43.10000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 24.299999999999905, 43.50000000000001, 41.90000000000001, 44.900000000000006, -50.00000000000044, 15.299999999999777, 45.1, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 25.29999999999992, 45.9, 40.30000000000002, 46.099999999999994, 44.900000000000006, 36.30000000000003, 45.5, -50.00000000000044, 32.50000000000002, 44.5, 16.8999999999998, 28.699999999999967, 24.499999999999908, 32.100000000000016, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001], "episode_lengths": [500, 48, 78, 252, 38, 500, 500, 500, 500, 500, 76, 30, 500, 108, 500, 76, 60, 300, 500, 500, 84, 452, 46, 500, 52, 500, 500, 108, 180, 500, 70, 500, 60, 500, 106, 44, 58, 52, 500, 132, 40, 170, 64, 500, 40, 500, 50, 500, 500, 170, 120, 38, 108, 500, 484, 70, 500, 86, 500, 500, 500, 42, 124, 500, 500, 500, 42, 258, 66, 82, 52, 500, 348, 50, 500, 116, 500, 500, 500, 500, 50, 248, 42, 98, 40, 52, 138, 46, 500, 176, 56, 332, 214, 256, 180, 338, 500, 500, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762487014493317, "mean_inference_ms": 1.2087992593405203, "mean_action_processing_ms": 0.13978008152050872, "mean_env_wait_ms": 0.08277345896440172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701115608215332, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.11477494239807129}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5603.776849391785, "num_env_steps_trained_throughput_per_sec": 5603.776849391785, "timesteps_total": 936000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 3181.631, "sample_time_ms": 2836.49, "load_time_ms": 19.06, "load_throughput": 944391.279, "learn_time_ms": 314.887, "learn_throughput": 57163.325, "synch_weights_time_ms": 9.307}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3687, "training_iteration": 52, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-26", "timestamp": 1698248066, "time_this_iter_s": 3.2191128730773926, "time_total_s": 168.22251796722412, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 168.22251796722412, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 56.2, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.440892098500627e-17, "cur_lr": 0.0003, "total_loss": 7.130424040335196, "policy_loss": -0.00012449144075314203, "vf_loss": 7.130598386128743, "vf_explained_var": -1.205338372124566e-06, "kl": 0.00028903870348265763, "entropy": 0.498593149361787, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.404999999999817, "episode_len_mean": 271.58, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 15.299999999999777, 45.1, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 25.29999999999992, 45.9, 40.30000000000002, 46.099999999999994, 44.900000000000006, 36.30000000000003, 45.5, -50.00000000000044, 32.50000000000002, 44.5, 16.8999999999998, 28.699999999999967, 24.499999999999908, 32.100000000000016, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, 35.30000000000004, 8.899999999999686, 44.900000000000006, 44.7, -50.00000000000044, 37.10000000000003, 46.099999999999994, 41.30000000000001, -50.00000000000044, 25.29999999999992, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, 25.699999999999925, -50.00000000000044, -50.00000000000044, 41.30000000000001, 20.099999999999845, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 41.500000000000014, 43.900000000000006, 42.70000000000001, -50.00000000000044, 42.30000000000001, 46.099999999999994, 40.500000000000014, -50.00000000000044, 33.30000000000003, 44.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 32.50000000000002, 38.10000000000002, 10.699999999999712, 32.700000000000024, 35.900000000000034, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 43.30000000000001, 42.30000000000001, 41.500000000000014, -50.00000000000044, 44.10000000000001, 44.7, 22.699999999999882, 47.1, -50.00000000000044, 26.09999999999993, -50.00000000000044, 42.30000000000001, 22.699999999999882], "episode_lengths": [500, 348, 50, 500, 116, 500, 500, 500, 500, 50, 248, 42, 98, 40, 52, 138, 46, 500, 176, 56, 332, 214, 256, 180, 338, 500, 500, 500, 60, 500, 500, 144, 500, 106, 500, 500, 98, 148, 412, 52, 54, 500, 130, 40, 88, 500, 248, 44, 500, 500, 500, 346, 500, 244, 500, 500, 88, 300, 500, 84, 34, 500, 86, 62, 74, 500, 78, 40, 96, 500, 168, 56, 500, 500, 82, 500, 176, 120, 394, 174, 142, 500, 44, 500, 500, 500, 124, 68, 78, 86, 500, 60, 54, 274, 30, 500, 240, 500, 78, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3761196456348233, "mean_inference_ms": 1.2084168771656303, "mean_action_processing_ms": 0.14008205164964221, "mean_env_wait_ms": 0.08281555382617231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100229263305664, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.10600423812866211}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.404999999999817, "episode_len_mean": 271.58, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 15.299999999999777, 45.1, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 25.29999999999992, 45.9, 40.30000000000002, 46.099999999999994, 44.900000000000006, 36.30000000000003, 45.5, -50.00000000000044, 32.50000000000002, 44.5, 16.8999999999998, 28.699999999999967, 24.499999999999908, 32.100000000000016, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, 35.30000000000004, 8.899999999999686, 44.900000000000006, 44.7, -50.00000000000044, 37.10000000000003, 46.099999999999994, 41.30000000000001, -50.00000000000044, 25.29999999999992, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, 25.699999999999925, -50.00000000000044, -50.00000000000044, 41.30000000000001, 20.099999999999845, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 41.500000000000014, 43.900000000000006, 42.70000000000001, -50.00000000000044, 42.30000000000001, 46.099999999999994, 40.500000000000014, -50.00000000000044, 33.30000000000003, 44.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 32.50000000000002, 38.10000000000002, 10.699999999999712, 32.700000000000024, 35.900000000000034, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 43.30000000000001, 42.30000000000001, 41.500000000000014, -50.00000000000044, 44.10000000000001, 44.7, 22.699999999999882, 47.1, -50.00000000000044, 26.09999999999993, -50.00000000000044, 42.30000000000001, 22.699999999999882], "episode_lengths": [500, 348, 50, 500, 116, 500, 500, 500, 500, 50, 248, 42, 98, 40, 52, 138, 46, 500, 176, 56, 332, 214, 256, 180, 338, 500, 500, 500, 60, 500, 500, 144, 500, 106, 500, 500, 98, 148, 412, 52, 54, 500, 130, 40, 88, 500, 248, 44, 500, 500, 500, 346, 500, 244, 500, 500, 88, 300, 500, 84, 34, 500, 86, 62, 74, 500, 78, 40, 96, 500, 168, 56, 500, 500, 82, 500, 176, 120, 394, 174, 142, 500, 44, 500, 500, 500, 124, 68, 78, 86, 500, 60, 54, 274, 30, 500, 240, 500, 78, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3761196456348233, "mean_inference_ms": 1.2084168771656303, "mean_action_processing_ms": 0.14008205164964221, "mean_env_wait_ms": 0.08281555382617231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100229263305664, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.10600423812866211}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5600.657383408398, "num_env_steps_trained_throughput_per_sec": 5600.657383408398, "timesteps_total": 954000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 954000, "timers": {"training_iteration_time_ms": 3188.272, "sample_time_ms": 2836.75, "load_time_ms": 19.859, "load_throughput": 906387.69, "learn_time_ms": 320.494, "learn_throughput": 56163.238, "synch_weights_time_ms": 9.281}, "counters": {"num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "done": false, "episodes_total": 3758, "training_iteration": 53, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-30", "timestamp": 1698248070, "time_this_iter_s": 3.2209033966064453, "time_total_s": 171.44342136383057, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 171.44342136383057, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 63.05, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 0.0003, "total_loss": 7.500311763198288, "policy_loss": -0.00021685935832836009, "vf_loss": 7.50058306588067, "vf_explained_var": -1.231829325358073e-06, "kl": 0.0002832981989584482, "entropy": 0.5422567537537327, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1445.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 18.229999999999883, "episode_len_mean": 208.48, "episode_media": {}, "episodes_this_iter": 87, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, 42.30000000000001, 41.500000000000014, -50.00000000000044, 44.10000000000001, 44.7, 22.699999999999882, 47.1, -50.00000000000044, 26.09999999999993, -50.00000000000044, 42.30000000000001, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 31.500000000000007, 45.7, 43.30000000000001, 43.10000000000001, 44.10000000000001, 43.50000000000001, 43.50000000000001, 40.70000000000002, 43.30000000000001, 27.899999999999956, 15.49999999999978, 37.10000000000003, 38.700000000000024, 30.9, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, 35.70000000000003, 46.9, -50.00000000000044, -50.00000000000044, 29.099999999999973, 0.49999999999956657, 38.10000000000002, -50.00000000000044, 44.300000000000004, 43.10000000000001, -50.00000000000044, 28.699999999999967, 29.099999999999973, 45.3, 40.70000000000002, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 27.299999999999947, 33.70000000000004, 44.5, 42.10000000000001, 39.90000000000002, 39.50000000000002, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, 15.49999999999978, 31.1, 4.099999999999618, 44.900000000000006, 47.5, 45.1, -50.00000000000044, 28.89999999999997, -50.00000000000044, 42.30000000000001, 35.10000000000004, -50.00000000000044, 9.499999999999694, 29.899999999999984, 44.900000000000006, 42.70000000000001, 43.7, 12.69999999999974, 31.70000000000001, 45.7, 45.5, 43.50000000000001, 40.500000000000014, 39.70000000000002, 43.900000000000006, 43.10000000000001, 47.7, 42.900000000000006, 44.10000000000001, 21.699999999999868, 44.5, 43.7, 46.9, 41.100000000000016], "episode_lengths": [68, 78, 86, 500, 60, 54, 274, 30, 500, 240, 500, 78, 274, 500, 500, 500, 500, 90, 186, 44, 68, 70, 60, 66, 66, 94, 68, 222, 346, 130, 114, 192, 500, 500, 38, 66, 144, 32, 500, 500, 210, 496, 120, 500, 58, 70, 500, 214, 210, 48, 94, 500, 500, 28, 500, 500, 228, 164, 56, 80, 102, 106, 54, 500, 500, 82, 346, 190, 460, 52, 26, 50, 500, 212, 500, 78, 150, 500, 406, 202, 52, 74, 64, 374, 184, 44, 46, 66, 96, 104, 62, 70, 24, 72, 60, 284, 56, 64, 32, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762002853493195, "mean_inference_ms": 1.2064414203153746, "mean_action_processing_ms": 0.14027642633111406, "mean_env_wait_ms": 0.08283153896271143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023008108139038086, "StateBufferConnector_ms": 0.004996776580810547, "ViewRequirementAgentConnector_ms": 0.12098884582519531}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 18.229999999999883, "episode_len_mean": 208.48, "episodes_this_iter": 87, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, 42.30000000000001, 41.500000000000014, -50.00000000000044, 44.10000000000001, 44.7, 22.699999999999882, 47.1, -50.00000000000044, 26.09999999999993, -50.00000000000044, 42.30000000000001, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 31.500000000000007, 45.7, 43.30000000000001, 43.10000000000001, 44.10000000000001, 43.50000000000001, 43.50000000000001, 40.70000000000002, 43.30000000000001, 27.899999999999956, 15.49999999999978, 37.10000000000003, 38.700000000000024, 30.9, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, 35.70000000000003, 46.9, -50.00000000000044, -50.00000000000044, 29.099999999999973, 0.49999999999956657, 38.10000000000002, -50.00000000000044, 44.300000000000004, 43.10000000000001, -50.00000000000044, 28.699999999999967, 29.099999999999973, 45.3, 40.70000000000002, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 27.299999999999947, 33.70000000000004, 44.5, 42.10000000000001, 39.90000000000002, 39.50000000000002, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, 15.49999999999978, 31.1, 4.099999999999618, 44.900000000000006, 47.5, 45.1, -50.00000000000044, 28.89999999999997, -50.00000000000044, 42.30000000000001, 35.10000000000004, -50.00000000000044, 9.499999999999694, 29.899999999999984, 44.900000000000006, 42.70000000000001, 43.7, 12.69999999999974, 31.70000000000001, 45.7, 45.5, 43.50000000000001, 40.500000000000014, 39.70000000000002, 43.900000000000006, 43.10000000000001, 47.7, 42.900000000000006, 44.10000000000001, 21.699999999999868, 44.5, 43.7, 46.9, 41.100000000000016], "episode_lengths": [68, 78, 86, 500, 60, 54, 274, 30, 500, 240, 500, 78, 274, 500, 500, 500, 500, 90, 186, 44, 68, 70, 60, 66, 66, 94, 68, 222, 346, 130, 114, 192, 500, 500, 38, 66, 144, 32, 500, 500, 210, 496, 120, 500, 58, 70, 500, 214, 210, 48, 94, 500, 500, 28, 500, 500, 228, 164, 56, 80, 102, 106, 54, 500, 500, 82, 346, 190, 460, 52, 26, 50, 500, 212, 500, 78, 150, 500, 406, 202, 52, 74, 64, 374, 184, 44, 46, 66, 96, 104, 62, 70, 24, 72, 60, 284, 56, 64, 32, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762002853493195, "mean_inference_ms": 1.2064414203153746, "mean_action_processing_ms": 0.14027642633111406, "mean_env_wait_ms": 0.08283153896271143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023008108139038086, "StateBufferConnector_ms": 0.004996776580810547, "ViewRequirementAgentConnector_ms": 0.12098884582519531}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5747.164117250945, "num_env_steps_trained_throughput_per_sec": 5747.164117250945, "timesteps_total": 972000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 3182.925, "sample_time_ms": 2831.514, "load_time_ms": 18.481, "load_throughput": 973972.418, "learn_time_ms": 321.459, "learn_throughput": 55994.764, "synch_weights_time_ms": 9.584}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3845, "training_iteration": 54, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-33", "timestamp": 1698248073, "time_this_iter_s": 3.137974977493286, "time_total_s": 174.58139634132385, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 174.58139634132385, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 55.48, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 0.0003, "total_loss": 7.113086841724537, "policy_loss": 4.6356408684342e-06, "vf_loss": 7.113134154567012, "vf_explained_var": -7.240860550491899e-07, "kl": 0.00016078407189218174, "entropy": 0.5198680681210978, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1472.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 20.2939999999999, "episode_len_mean": 187.84, "episode_media": {}, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 45.5, 43.50000000000001, 40.500000000000014, 39.70000000000002, 43.900000000000006, 43.10000000000001, 47.7, 42.900000000000006, 44.10000000000001, 21.699999999999868, 44.5, 43.7, 46.9, 41.100000000000016, 45.5, 45.7, -50.00000000000044, 31.500000000000007, 45.3, 46.5, -50.00000000000044, 44.10000000000001, 41.100000000000016, -50.00000000000044, 27.899999999999956, 35.10000000000004, 44.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, 39.300000000000026, 43.30000000000001, 44.300000000000004, 24.499999999999908, 40.30000000000002, 32.90000000000003, -50.00000000000044, 42.70000000000001, 45.1, 39.10000000000002, -50.00000000000044, 43.30000000000001, 45.7, 38.10000000000002, 45.1, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.7, -50.00000000000044, -50.00000000000044, 29.899999999999984, 43.50000000000001, -50.00000000000044, 14.09999999999976, -50.00000000000044, 31.70000000000001, 46.3, 46.099999999999994, 43.900000000000006, 45.9, 17.099999999999802, 42.30000000000001, 46.5, 36.10000000000004, -50.00000000000044, 43.10000000000001, 36.50000000000003, 44.10000000000001, 45.7, 41.90000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.30000000000001, 37.10000000000003, 43.30000000000001, 41.500000000000014, 38.10000000000002, -50.00000000000044, 35.30000000000004, -50.00000000000044, 39.10000000000002, 45.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.300000000000026, 34.50000000000004, 34.30000000000004, 43.10000000000001, 44.10000000000001, -50.00000000000044, 30.499999999999993, 34.50000000000004, 46.9], "episode_lengths": [44, 46, 66, 96, 104, 62, 70, 24, 72, 60, 284, 56, 64, 32, 90, 46, 44, 500, 186, 48, 36, 500, 60, 90, 500, 222, 150, 56, 46, 500, 500, 500, 338, 108, 68, 58, 256, 98, 172, 500, 74, 50, 110, 500, 68, 44, 120, 50, 500, 500, 94, 44, 500, 500, 202, 66, 500, 360, 500, 184, 38, 40, 62, 42, 330, 78, 36, 140, 500, 70, 136, 60, 44, 82, 52, 500, 500, 86, 68, 130, 68, 86, 120, 500, 148, 500, 110, 44, 500, 40, 500, 128, 156, 158, 70, 60, 500, 196, 156, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37562626146665856, "mean_inference_ms": 1.2075084462427026, "mean_action_processing_ms": 0.14039529490465802, "mean_env_wait_ms": 0.08306038332787517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300119400024414, "StateBufferConnector_ms": 0.0029976367950439453, "ViewRequirementAgentConnector_ms": 0.14198684692382812}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 20.2939999999999, "episode_len_mean": 187.84, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 45.5, 43.50000000000001, 40.500000000000014, 39.70000000000002, 43.900000000000006, 43.10000000000001, 47.7, 42.900000000000006, 44.10000000000001, 21.699999999999868, 44.5, 43.7, 46.9, 41.100000000000016, 45.5, 45.7, -50.00000000000044, 31.500000000000007, 45.3, 46.5, -50.00000000000044, 44.10000000000001, 41.100000000000016, -50.00000000000044, 27.899999999999956, 35.10000000000004, 44.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, 39.300000000000026, 43.30000000000001, 44.300000000000004, 24.499999999999908, 40.30000000000002, 32.90000000000003, -50.00000000000044, 42.70000000000001, 45.1, 39.10000000000002, -50.00000000000044, 43.30000000000001, 45.7, 38.10000000000002, 45.1, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.7, -50.00000000000044, -50.00000000000044, 29.899999999999984, 43.50000000000001, -50.00000000000044, 14.09999999999976, -50.00000000000044, 31.70000000000001, 46.3, 46.099999999999994, 43.900000000000006, 45.9, 17.099999999999802, 42.30000000000001, 46.5, 36.10000000000004, -50.00000000000044, 43.10000000000001, 36.50000000000003, 44.10000000000001, 45.7, 41.90000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.30000000000001, 37.10000000000003, 43.30000000000001, 41.500000000000014, 38.10000000000002, -50.00000000000044, 35.30000000000004, -50.00000000000044, 39.10000000000002, 45.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.300000000000026, 34.50000000000004, 34.30000000000004, 43.10000000000001, 44.10000000000001, -50.00000000000044, 30.499999999999993, 34.50000000000004, 46.9], "episode_lengths": [44, 46, 66, 96, 104, 62, 70, 24, 72, 60, 284, 56, 64, 32, 90, 46, 44, 500, 186, 48, 36, 500, 60, 90, 500, 222, 150, 56, 46, 500, 500, 500, 338, 108, 68, 58, 256, 98, 172, 500, 74, 50, 110, 500, 68, 44, 120, 50, 500, 500, 94, 44, 500, 500, 202, 66, 500, 360, 500, 184, 38, 40, 62, 42, 330, 78, 36, 140, 500, 70, 136, 60, 44, 82, 52, 500, 500, 86, 68, 130, 68, 86, 120, 500, 148, 500, 110, 44, 500, 40, 500, 128, 156, 158, 70, 60, 500, 196, 156, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37562626146665856, "mean_inference_ms": 1.2075084462427026, "mean_action_processing_ms": 0.14039529490465802, "mean_env_wait_ms": 0.08306038332787517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300119400024414, "StateBufferConnector_ms": 0.0029976367950439453, "ViewRequirementAgentConnector_ms": 0.14198684692382812}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5576.056747989469, "num_env_steps_trained_throughput_per_sec": 5576.056747989469, "timesteps_total": 990000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 990000, "timers": {"training_iteration_time_ms": 3174.915, "sample_time_ms": 2826.387, "load_time_ms": 18.51, "load_throughput": 972449.418, "learn_time_ms": 318.582, "learn_throughput": 56500.433, "synch_weights_time_ms": 9.449}, "counters": {"num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "done": false, "episodes_total": 3930, "training_iteration": 55, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-36", "timestamp": 1698248076, "time_this_iter_s": 3.2340750694274902, "time_total_s": 177.81547141075134, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 177.81547141075134, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 65.075, "ram_util_percent": 26.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125784e-18, "cur_lr": 0.0003, "total_loss": 7.13357072406345, "policy_loss": -0.00010172332878466006, "vf_loss": 7.133725784443043, "vf_explained_var": -9.669197930230034e-07, "kl": 0.00022345196614992346, "entropy": 0.5333280430899726, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1499.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.050999999999874, "episode_len_mean": 225.22, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.500000000000014, 43.30000000000001, 37.10000000000003, 43.30000000000001, 41.500000000000014, 38.10000000000002, -50.00000000000044, 35.30000000000004, -50.00000000000044, 39.10000000000002, 45.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.300000000000026, 34.50000000000004, 34.30000000000004, 43.10000000000001, 44.10000000000001, -50.00000000000044, 30.499999999999993, 34.50000000000004, 46.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, 29.099999999999973, 39.90000000000002, 43.7, 43.30000000000001, 46.099999999999994, 44.10000000000001, 19.499999999999837, 46.699999999999996, 36.30000000000003, 42.500000000000014, -50.00000000000044, 43.900000000000006, 15.699999999999783, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 39.300000000000026, 43.30000000000001, 2.699999999999598, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.70000000000002, 47.1, 46.099999999999994, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 37.70000000000003, 45.9, 23.29999999999989, 46.5, 17.099999999999802, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 35.10000000000004, 41.90000000000001, 32.30000000000002, 18.499999999999822, 40.30000000000002, 44.5, 36.900000000000034, 40.500000000000014, -50.00000000000044, 45.5, 18.899999999999828, -50.00000000000044, -50.00000000000044, 40.90000000000002, 41.30000000000001, 44.300000000000004, 40.90000000000002, 44.10000000000001, 36.70000000000003, 37.10000000000003, 24.69999999999991, 42.900000000000006, 27.299999999999947, 43.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.500000000000014, 35.30000000000004, 37.10000000000003, 42.500000000000014, 14.899999999999771], "episode_lengths": [500, 86, 68, 130, 68, 86, 120, 500, 148, 500, 110, 44, 500, 40, 500, 128, 156, 158, 70, 60, 500, 196, 156, 32, 500, 500, 70, 210, 102, 64, 68, 40, 60, 306, 34, 138, 76, 500, 62, 344, 500, 500, 152, 500, 108, 68, 474, 500, 500, 68, 84, 30, 40, 500, 74, 500, 500, 124, 42, 268, 36, 330, 500, 500, 500, 500, 500, 58, 150, 82, 178, 316, 98, 56, 132, 96, 500, 46, 312, 500, 500, 92, 88, 58, 92, 60, 134, 130, 254, 72, 228, 68, 500, 500, 102, 86, 148, 130, 76, 352]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37574832308078276, "mean_inference_ms": 1.2072542240763144, "mean_action_processing_ms": 0.13966219196254434, "mean_env_wait_ms": 0.08287444040450452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014002323150634766, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.11903190612792969}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.050999999999874, "episode_len_mean": 225.22, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.500000000000014, 43.30000000000001, 37.10000000000003, 43.30000000000001, 41.500000000000014, 38.10000000000002, -50.00000000000044, 35.30000000000004, -50.00000000000044, 39.10000000000002, 45.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.300000000000026, 34.50000000000004, 34.30000000000004, 43.10000000000001, 44.10000000000001, -50.00000000000044, 30.499999999999993, 34.50000000000004, 46.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, 29.099999999999973, 39.90000000000002, 43.7, 43.30000000000001, 46.099999999999994, 44.10000000000001, 19.499999999999837, 46.699999999999996, 36.30000000000003, 42.500000000000014, -50.00000000000044, 43.900000000000006, 15.699999999999783, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 39.300000000000026, 43.30000000000001, 2.699999999999598, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.70000000000002, 47.1, 46.099999999999994, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 37.70000000000003, 45.9, 23.29999999999989, 46.5, 17.099999999999802, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 35.10000000000004, 41.90000000000001, 32.30000000000002, 18.499999999999822, 40.30000000000002, 44.5, 36.900000000000034, 40.500000000000014, -50.00000000000044, 45.5, 18.899999999999828, -50.00000000000044, -50.00000000000044, 40.90000000000002, 41.30000000000001, 44.300000000000004, 40.90000000000002, 44.10000000000001, 36.70000000000003, 37.10000000000003, 24.69999999999991, 42.900000000000006, 27.299999999999947, 43.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.500000000000014, 35.30000000000004, 37.10000000000003, 42.500000000000014, 14.899999999999771], "episode_lengths": [500, 86, 68, 130, 68, 86, 120, 500, 148, 500, 110, 44, 500, 40, 500, 128, 156, 158, 70, 60, 500, 196, 156, 32, 500, 500, 70, 210, 102, 64, 68, 40, 60, 306, 34, 138, 76, 500, 62, 344, 500, 500, 152, 500, 108, 68, 474, 500, 500, 68, 84, 30, 40, 500, 74, 500, 500, 124, 42, 268, 36, 330, 500, 500, 500, 500, 500, 58, 150, 82, 178, 316, 98, 56, 132, 96, 500, 46, 312, 500, 500, 92, 88, 58, 92, 60, 134, 130, 254, 72, 228, 68, 500, 500, 102, 86, 148, 130, 76, 352]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37574832308078276, "mean_inference_ms": 1.2072542240763144, "mean_action_processing_ms": 0.13966219196254434, "mean_env_wait_ms": 0.08287444040450452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014002323150634766, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.11903190612792969}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5833.7673003071295, "num_env_steps_trained_throughput_per_sec": 5833.7673003071295, "timesteps_total": 1008000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 3163.226, "sample_time_ms": 2818.151, "load_time_ms": 17.597, "load_throughput": 1022924.741, "learn_time_ms": 315.943, "learn_throughput": 56972.319, "synch_weights_time_ms": 9.349}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 4006, "training_iteration": 56, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-39", "timestamp": 1698248079, "time_this_iter_s": 3.092482328414917, "time_total_s": 180.90795373916626, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 180.90795373916626, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 55.11999999999999, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.775557561562892e-18, "cur_lr": 0.0003, "total_loss": 7.089511005966751, "policy_loss": -0.0002776801724124838, "vf_loss": 7.089839617411296, "vf_explained_var": -8.432953445999711e-07, "kl": 0.00046953797254005805, "entropy": 0.5088663200537363, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1526.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.543999999999828, "episode_len_mean": 265.22, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 35.10000000000004, 41.90000000000001, 32.30000000000002, 18.499999999999822, 40.30000000000002, 44.5, 36.900000000000034, 40.500000000000014, -50.00000000000044, 45.5, 18.899999999999828, -50.00000000000044, -50.00000000000044, 40.90000000000002, 41.30000000000001, 44.300000000000004, 40.90000000000002, 44.10000000000001, 36.70000000000003, 37.10000000000003, 24.69999999999991, 42.900000000000006, 27.299999999999947, 43.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.500000000000014, 35.30000000000004, 37.10000000000003, 42.500000000000014, 14.899999999999771, -50.00000000000044, 46.3, 44.7, 19.499999999999837, 14.499999999999766, 30.9, 38.50000000000003, -50.00000000000044, -50.00000000000044, 18.499999999999822, 39.70000000000002, 33.70000000000004, 41.70000000000002, 19.899999999999842, 45.3, 41.100000000000016, -50.00000000000044, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.300000000000026, -50.00000000000044, -50.00000000000044, 40.90000000000002, 19.299999999999834, 41.90000000000001, -50.00000000000044, -50.00000000000044, 1.099999999999575, 45.9, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 33.30000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 37.300000000000026, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.9, 41.500000000000014, -50.00000000000044, 31.70000000000001, -50.00000000000044, 43.900000000000006, 3.699999999999612, 44.7, 4.899999999999629, 41.90000000000001], "episode_lengths": [500, 500, 500, 58, 150, 82, 178, 316, 98, 56, 132, 96, 500, 46, 312, 500, 500, 92, 88, 58, 92, 60, 134, 130, 254, 72, 228, 68, 500, 500, 102, 86, 148, 130, 76, 352, 500, 38, 54, 306, 356, 192, 116, 500, 500, 316, 104, 164, 84, 302, 48, 90, 500, 48, 44, 500, 500, 58, 118, 500, 500, 92, 308, 82, 500, 500, 490, 42, 246, 500, 500, 500, 50, 500, 168, 78, 500, 500, 500, 500, 48, 128, 142, 500, 500, 500, 500, 100, 500, 500, 32, 86, 500, 184, 500, 62, 464, 54, 452, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3753336804578011, "mean_inference_ms": 1.206870139737173, "mean_action_processing_ms": 0.1402265773068284, "mean_env_wait_ms": 0.08263788594619839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300119400024414, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.12301325798034668}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.543999999999828, "episode_len_mean": 265.22, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 35.10000000000004, 41.90000000000001, 32.30000000000002, 18.499999999999822, 40.30000000000002, 44.5, 36.900000000000034, 40.500000000000014, -50.00000000000044, 45.5, 18.899999999999828, -50.00000000000044, -50.00000000000044, 40.90000000000002, 41.30000000000001, 44.300000000000004, 40.90000000000002, 44.10000000000001, 36.70000000000003, 37.10000000000003, 24.69999999999991, 42.900000000000006, 27.299999999999947, 43.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.500000000000014, 35.30000000000004, 37.10000000000003, 42.500000000000014, 14.899999999999771, -50.00000000000044, 46.3, 44.7, 19.499999999999837, 14.499999999999766, 30.9, 38.50000000000003, -50.00000000000044, -50.00000000000044, 18.499999999999822, 39.70000000000002, 33.70000000000004, 41.70000000000002, 19.899999999999842, 45.3, 41.100000000000016, -50.00000000000044, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.300000000000026, -50.00000000000044, -50.00000000000044, 40.90000000000002, 19.299999999999834, 41.90000000000001, -50.00000000000044, -50.00000000000044, 1.099999999999575, 45.9, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 33.30000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 37.300000000000026, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.9, 41.500000000000014, -50.00000000000044, 31.70000000000001, -50.00000000000044, 43.900000000000006, 3.699999999999612, 44.7, 4.899999999999629, 41.90000000000001], "episode_lengths": [500, 500, 500, 58, 150, 82, 178, 316, 98, 56, 132, 96, 500, 46, 312, 500, 500, 92, 88, 58, 92, 60, 134, 130, 254, 72, 228, 68, 500, 500, 102, 86, 148, 130, 76, 352, 500, 38, 54, 306, 356, 192, 116, 500, 500, 316, 104, 164, 84, 302, 48, 90, 500, 48, 44, 500, 500, 58, 118, 500, 500, 92, 308, 82, 500, 500, 490, 42, 246, 500, 500, 500, 50, 500, 168, 78, 500, 500, 500, 500, 48, 128, 142, 500, 500, 500, 500, 100, 500, 500, 32, 86, 500, 184, 500, 62, 464, 54, 452, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3753336804578011, "mean_inference_ms": 1.206870139737173, "mean_action_processing_ms": 0.1402265773068284, "mean_env_wait_ms": 0.08263788594619839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300119400024414, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.12301325798034668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5802.7659137345, "num_env_steps_trained_throughput_per_sec": 5802.7659137345, "timesteps_total": 1026000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1026000, "timers": {"training_iteration_time_ms": 3134.692, "sample_time_ms": 2792.116, "load_time_ms": 16.815, "load_throughput": 1070491.337, "learn_time_ms": 313.986, "learn_throughput": 57327.459, "synch_weights_time_ms": 9.49}, "counters": {"num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "done": false, "episodes_total": 4070, "training_iteration": 57, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-42", "timestamp": 1698248082, "time_this_iter_s": 3.1069672107696533, "time_total_s": 184.0149209499359, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 184.0149209499359, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 63.400000000000006, "ram_util_percent": 26.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.387778780781446e-18, "cur_lr": 0.0003, "total_loss": 6.673285996472394, "policy_loss": -0.0001800138572299922, "vf_loss": 6.673520847603127, "vf_explained_var": -1.0022410640010126e-06, "kl": 0.0005126154643301527, "entropy": 0.5474507047070397, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1553.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.5479999999998086, "episode_len_mean": 275.12, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, -50.00000000000044, 33.30000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 37.300000000000026, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.9, 41.500000000000014, -50.00000000000044, 31.70000000000001, -50.00000000000044, 43.900000000000006, 3.699999999999612, 44.7, 4.899999999999629, 41.90000000000001, 11.29999999999972, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.5, 20.899999999999856, 31.500000000000007, 21.699999999999868, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.5, 30.29999999999999, 44.7, -50.00000000000044, 46.099999999999994, 11.699999999999726, -50.00000000000044, 45.7, 41.30000000000001, 46.099999999999994, -50.00000000000044, 38.50000000000003, 13.299999999999748, 38.50000000000003, -50.00000000000044, 45.3, -50.00000000000044, 41.90000000000001, 46.699999999999996, 23.29999999999989, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.30000000000001, 30.099999999999987, -50.00000000000044, -50.00000000000044, 44.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.1, -50.00000000000044, 36.10000000000004, 43.7, 43.30000000000001, 36.10000000000004, 42.500000000000014, 34.70000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 45.5, 44.10000000000001, 29.899999999999984, 46.099999999999994, 43.10000000000001, 35.10000000000004, -50.00000000000044], "episode_lengths": [500, 50, 500, 168, 78, 500, 500, 500, 500, 48, 128, 142, 500, 500, 500, 500, 100, 500, 500, 32, 86, 500, 184, 500, 62, 464, 54, 452, 82, 388, 500, 500, 94, 58, 500, 500, 56, 292, 186, 284, 500, 500, 48, 500, 500, 132, 500, 56, 198, 54, 500, 40, 384, 500, 44, 88, 40, 500, 116, 368, 116, 500, 48, 500, 82, 34, 268, 500, 70, 500, 88, 200, 500, 500, 56, 46, 500, 500, 500, 112, 50, 500, 140, 64, 68, 140, 76, 154, 500, 500, 40, 36, 500, 46, 60, 202, 40, 70, 150, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37591402053865935, "mean_inference_ms": 1.2073236808407413, "mean_action_processing_ms": 0.1400377043710909, "mean_env_wait_ms": 0.08272836180082117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019006729125976562, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.140977144241333}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.5479999999998086, "episode_len_mean": 275.12, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, -50.00000000000044, 33.30000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 37.300000000000026, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.9, 41.500000000000014, -50.00000000000044, 31.70000000000001, -50.00000000000044, 43.900000000000006, 3.699999999999612, 44.7, 4.899999999999629, 41.90000000000001, 11.29999999999972, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.5, 20.899999999999856, 31.500000000000007, 21.699999999999868, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.5, 30.29999999999999, 44.7, -50.00000000000044, 46.099999999999994, 11.699999999999726, -50.00000000000044, 45.7, 41.30000000000001, 46.099999999999994, -50.00000000000044, 38.50000000000003, 13.299999999999748, 38.50000000000003, -50.00000000000044, 45.3, -50.00000000000044, 41.90000000000001, 46.699999999999996, 23.29999999999989, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.30000000000001, 30.099999999999987, -50.00000000000044, -50.00000000000044, 44.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.1, -50.00000000000044, 36.10000000000004, 43.7, 43.30000000000001, 36.10000000000004, 42.500000000000014, 34.70000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 45.5, 44.10000000000001, 29.899999999999984, 46.099999999999994, 43.10000000000001, 35.10000000000004, -50.00000000000044], "episode_lengths": [500, 50, 500, 168, 78, 500, 500, 500, 500, 48, 128, 142, 500, 500, 500, 500, 100, 500, 500, 32, 86, 500, 184, 500, 62, 464, 54, 452, 82, 388, 500, 500, 94, 58, 500, 500, 56, 292, 186, 284, 500, 500, 48, 500, 500, 132, 500, 56, 198, 54, 500, 40, 384, 500, 44, 88, 40, 500, 116, 368, 116, 500, 48, 500, 82, 34, 268, 500, 70, 500, 88, 200, 500, 500, 56, 46, 500, 500, 500, 112, 50, 500, 140, 64, 68, 140, 76, 154, 500, 500, 40, 36, 500, 46, 60, 202, 40, 70, 150, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37591402053865935, "mean_inference_ms": 1.2073236808407413, "mean_action_processing_ms": 0.1400377043710909, "mean_env_wait_ms": 0.08272836180082117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019006729125976562, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.140977144241333}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5244.790342037777, "num_env_steps_trained_throughput_per_sec": 5244.790342037777, "timesteps_total": 1044000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 3163.267, "sample_time_ms": 2811.049, "load_time_ms": 17.736, "load_throughput": 1014857.364, "learn_time_ms": 322.78, "learn_throughput": 55765.465, "synch_weights_time_ms": 9.392}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 4141, "training_iteration": 58, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-46", "timestamp": 1698248086, "time_this_iter_s": 3.4389688968658447, "time_total_s": 187.45388984680176, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 187.45388984680176, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 61.260000000000005, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.93889390390723e-19, "cur_lr": 0.0003, "total_loss": 6.600178365354185, "policy_loss": -0.00017848017591017264, "vf_loss": 6.600407547420925, "vf_explained_var": -9.095227276837384e-07, "kl": 0.0003616553264733482, "entropy": 0.5067467799893132, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1580.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.34399999999987, "episode_len_mean": 207.3, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 38.90000000000002, 45.1, -50.00000000000044, 36.10000000000004, 43.7, 43.30000000000001, 36.10000000000004, 42.500000000000014, 34.70000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 45.5, 44.10000000000001, 29.899999999999984, 46.099999999999994, 43.10000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 6.499999999999652, 44.5, 45.3, 46.099999999999994, 45.7, 36.10000000000004, 44.5, 45.7, 45.5, -50.00000000000044, 43.7, 46.3, 45.3, 41.90000000000001, 26.69999999999994, 44.10000000000001, 47.3, 38.300000000000026, 45.3, 44.7, 24.099999999999902, 41.70000000000002, 17.299999999999805, 47.5, -50.00000000000044, 36.50000000000003, 43.7, 44.7, 33.500000000000036, -50.00000000000044, 43.7, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 46.3, 37.10000000000003, -50.00000000000044, 6.299999999999649, -50.00000000000044, 24.499999999999908, 43.900000000000006, 43.900000000000006, -50.00000000000044, 47.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 38.700000000000024, 44.900000000000006, -50.00000000000044, 44.5, 42.900000000000006, 39.50000000000002, 35.500000000000036, -50.00000000000044, 3.699999999999612, 44.7, 31.500000000000007, 41.30000000000001, 30.29999999999999, 44.5, 43.7, -50.00000000000044, -50.00000000000044, 45.1, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 41.70000000000002, 41.90000000000001, 45.3, 43.10000000000001, 44.5], "episode_lengths": [500, 500, 112, 50, 500, 140, 64, 68, 140, 76, 154, 500, 500, 40, 36, 500, 46, 60, 202, 40, 70, 150, 500, 500, 436, 56, 48, 40, 44, 140, 56, 44, 46, 500, 64, 38, 48, 82, 234, 60, 28, 118, 48, 54, 260, 84, 328, 26, 500, 136, 64, 54, 166, 500, 64, 500, 212, 500, 500, 38, 130, 500, 438, 500, 256, 62, 62, 500, 22, 500, 52, 500, 114, 52, 500, 56, 72, 106, 146, 500, 464, 54, 186, 88, 198, 56, 64, 500, 500, 50, 42, 500, 500, 500, 56, 84, 82, 48, 70, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37585268343601397, "mean_inference_ms": 1.2075218268187886, "mean_action_processing_ms": 0.14003816167668556, "mean_env_wait_ms": 0.08276973075232086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025992631912231445, "StateBufferConnector_ms": 0.003000974655151367, "ViewRequirementAgentConnector_ms": 0.1280040740966797}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.34399999999987, "episode_len_mean": 207.3, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 38.90000000000002, 45.1, -50.00000000000044, 36.10000000000004, 43.7, 43.30000000000001, 36.10000000000004, 42.500000000000014, 34.70000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 45.5, 44.10000000000001, 29.899999999999984, 46.099999999999994, 43.10000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 6.499999999999652, 44.5, 45.3, 46.099999999999994, 45.7, 36.10000000000004, 44.5, 45.7, 45.5, -50.00000000000044, 43.7, 46.3, 45.3, 41.90000000000001, 26.69999999999994, 44.10000000000001, 47.3, 38.300000000000026, 45.3, 44.7, 24.099999999999902, 41.70000000000002, 17.299999999999805, 47.5, -50.00000000000044, 36.50000000000003, 43.7, 44.7, 33.500000000000036, -50.00000000000044, 43.7, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 46.3, 37.10000000000003, -50.00000000000044, 6.299999999999649, -50.00000000000044, 24.499999999999908, 43.900000000000006, 43.900000000000006, -50.00000000000044, 47.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 38.700000000000024, 44.900000000000006, -50.00000000000044, 44.5, 42.900000000000006, 39.50000000000002, 35.500000000000036, -50.00000000000044, 3.699999999999612, 44.7, 31.500000000000007, 41.30000000000001, 30.29999999999999, 44.5, 43.7, -50.00000000000044, -50.00000000000044, 45.1, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 41.70000000000002, 41.90000000000001, 45.3, 43.10000000000001, 44.5], "episode_lengths": [500, 500, 112, 50, 500, 140, 64, 68, 140, 76, 154, 500, 500, 40, 36, 500, 46, 60, 202, 40, 70, 150, 500, 500, 436, 56, 48, 40, 44, 140, 56, 44, 46, 500, 64, 38, 48, 82, 234, 60, 28, 118, 48, 54, 260, 84, 328, 26, 500, 136, 64, 54, 166, 500, 64, 500, 212, 500, 500, 38, 130, 500, 438, 500, 256, 62, 62, 500, 22, 500, 52, 500, 114, 52, 500, 56, 72, 106, 146, 500, 464, 54, 186, 88, 198, 56, 64, 500, 500, 50, 42, 500, 500, 500, 56, 84, 82, 48, 70, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37585268343601397, "mean_inference_ms": 1.2075218268187886, "mean_action_processing_ms": 0.14003816167668556, "mean_env_wait_ms": 0.08276973075232086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025992631912231445, "StateBufferConnector_ms": 0.003000974655151367, "ViewRequirementAgentConnector_ms": 0.1280040740966797}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5694.400911617374, "num_env_steps_trained_throughput_per_sec": 5694.400911617374, "timesteps_total": 1062000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1062000, "timers": {"training_iteration_time_ms": 3159.061, "sample_time_ms": 2808.17, "load_time_ms": 16.65, "load_throughput": 1081069.65, "learn_time_ms": 322.543, "learn_throughput": 55806.504, "synch_weights_time_ms": 9.389}, "counters": {"num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "done": false, "episodes_total": 4218, "training_iteration": 59, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-49", "timestamp": 1698248089, "time_this_iter_s": 3.1669979095458984, "time_total_s": 190.62088775634766, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 190.62088775634766, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 61.325, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953615e-19, "cur_lr": 0.0003, "total_loss": 6.896642261081272, "policy_loss": -0.0003771167076020329, "vf_loss": 6.897071414523655, "vf_explained_var": -1.0199016994900173e-06, "kl": 0.0006835420790920394, "entropy": 0.5200519650070755, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1607.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.746999999999831, "episode_len_mean": 248.18, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 42.900000000000006, 39.50000000000002, 35.500000000000036, -50.00000000000044, 3.699999999999612, 44.7, 31.500000000000007, 41.30000000000001, 30.29999999999999, 44.5, 43.7, -50.00000000000044, -50.00000000000044, 45.1, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 41.70000000000002, 41.90000000000001, 45.3, 43.10000000000001, 44.5, 13.699999999999754, 46.3, -50.00000000000044, 37.70000000000003, 46.699999999999996, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 6.8999999999996575, 45.9, 43.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 45.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, 41.500000000000014, 27.699999999999953, -50.00000000000044, 42.500000000000014, 40.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, -50.00000000000044, 37.70000000000003, 38.300000000000026, 44.10000000000001, -50.00000000000044, 4.499999999999623, -50.00000000000044, 40.70000000000002, 42.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 44.5, 47.1, -50.00000000000044, 46.9, 45.5, 44.7, 44.7, 45.1, 46.099999999999994, 29.899999999999984, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 39.10000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 32.100000000000016, -50.00000000000044, 45.3, -50.00000000000044, 23.499999999999893, -50.00000000000044, 28.89999999999997, 45.1], "episode_lengths": [56, 72, 106, 146, 500, 464, 54, 186, 88, 198, 56, 64, 500, 500, 50, 42, 500, 500, 500, 56, 84, 82, 48, 70, 56, 364, 38, 500, 124, 34, 500, 38, 56, 500, 432, 42, 70, 52, 500, 500, 36, 42, 500, 134, 500, 86, 224, 500, 76, 96, 42, 500, 500, 500, 364, 500, 500, 124, 118, 60, 500, 456, 500, 94, 74, 500, 54, 500, 46, 56, 30, 500, 32, 46, 54, 54, 50, 40, 202, 500, 500, 206, 500, 110, 500, 98, 500, 152, 500, 500, 500, 78, 180, 500, 48, 500, 266, 500, 212, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37545956695182153, "mean_inference_ms": 1.2072392315437925, "mean_action_processing_ms": 0.14028620160798652, "mean_env_wait_ms": 0.08271651747011274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200101852416992, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.11395072937011719}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.746999999999831, "episode_len_mean": 248.18, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 42.900000000000006, 39.50000000000002, 35.500000000000036, -50.00000000000044, 3.699999999999612, 44.7, 31.500000000000007, 41.30000000000001, 30.29999999999999, 44.5, 43.7, -50.00000000000044, -50.00000000000044, 45.1, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 41.70000000000002, 41.90000000000001, 45.3, 43.10000000000001, 44.5, 13.699999999999754, 46.3, -50.00000000000044, 37.70000000000003, 46.699999999999996, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 6.8999999999996575, 45.9, 43.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 45.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, 41.500000000000014, 27.699999999999953, -50.00000000000044, 42.500000000000014, 40.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, -50.00000000000044, 37.70000000000003, 38.300000000000026, 44.10000000000001, -50.00000000000044, 4.499999999999623, -50.00000000000044, 40.70000000000002, 42.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 44.5, 47.1, -50.00000000000044, 46.9, 45.5, 44.7, 44.7, 45.1, 46.099999999999994, 29.899999999999984, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 39.10000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 32.100000000000016, -50.00000000000044, 45.3, -50.00000000000044, 23.499999999999893, -50.00000000000044, 28.89999999999997, 45.1], "episode_lengths": [56, 72, 106, 146, 500, 464, 54, 186, 88, 198, 56, 64, 500, 500, 50, 42, 500, 500, 500, 56, 84, 82, 48, 70, 56, 364, 38, 500, 124, 34, 500, 38, 56, 500, 432, 42, 70, 52, 500, 500, 36, 42, 500, 134, 500, 86, 224, 500, 76, 96, 42, 500, 500, 500, 364, 500, 500, 124, 118, 60, 500, 456, 500, 94, 74, 500, 54, 500, 46, 56, 30, 500, 32, 46, 54, 54, 50, 40, 202, 500, 500, 206, 500, 110, 500, 98, 500, 152, 500, 500, 500, 78, 180, 500, 48, 500, 266, 500, 212, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37545956695182153, "mean_inference_ms": 1.2072392315437925, "mean_action_processing_ms": 0.14028620160798652, "mean_env_wait_ms": 0.08271651747011274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200101852416992, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.11395072937011719}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5607.620260928708, "num_env_steps_trained_throughput_per_sec": 5607.620260928708, "timesteps_total": 1080000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 3184.421, "sample_time_ms": 2809.446, "load_time_ms": 18.253, "load_throughput": 986151.256, "learn_time_ms": 345.133, "learn_throughput": 52153.772, "synch_weights_time_ms": 9.386}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4293, "training_iteration": 60, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-52", "timestamp": 1698248092, "time_this_iter_s": 3.2169182300567627, "time_total_s": 193.83780598640442, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 193.83780598640442, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 55.279999999999994, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 0.0003, "total_loss": 6.725264037096942, "policy_loss": -0.00018541956389391863, "vf_loss": 6.725501590304905, "vf_explained_var": -8.388801857277199e-07, "kl": 0.0005375772649750738, "entropy": 0.5216004798809687, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1634.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.50599999999984, "episode_len_mean": 245.6, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 45.5, 44.7, 44.7, 45.1, 46.099999999999994, 29.899999999999984, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 39.10000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 32.100000000000016, -50.00000000000044, 45.3, -50.00000000000044, 23.499999999999893, -50.00000000000044, 28.89999999999997, 45.1, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 42.30000000000001, 42.900000000000006, 40.500000000000014, 39.10000000000002, 46.099999999999994, 45.1, 40.90000000000002, 45.7, -50.00000000000044, 42.10000000000001, 46.3, 12.299999999999734, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.90000000000002, 30.699999999999996, -50.00000000000044, 28.29999999999996, 46.099999999999994, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 26.09999999999993, 37.90000000000003, 34.10000000000004, 45.9, 45.5, 45.3, 46.099999999999994, 44.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, 26.299999999999933, -50.00000000000044, 45.3, 35.70000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 42.500000000000014, -50.00000000000044, 31.300000000000004, 13.299999999999748, 30.29999999999999, 45.9, 47.1, 29.49999999999998, 40.70000000000002, -50.00000000000044, 44.5, 45.9, 5.299999999999635], "episode_lengths": [500, 32, 46, 54, 54, 50, 40, 202, 500, 500, 206, 500, 110, 500, 98, 500, 152, 500, 500, 500, 78, 180, 500, 48, 500, 266, 500, 212, 50, 500, 142, 500, 500, 172, 500, 78, 72, 96, 110, 40, 50, 92, 44, 500, 80, 38, 378, 500, 500, 66, 102, 194, 500, 218, 40, 500, 58, 60, 500, 500, 240, 122, 160, 42, 46, 48, 40, 52, 500, 104, 500, 34, 44, 500, 238, 500, 48, 144, 500, 102, 500, 56, 54, 500, 500, 500, 230, 76, 500, 188, 368, 198, 42, 30, 206, 94, 500, 56, 42, 448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3758048835185291, "mean_inference_ms": 1.2059988137747508, "mean_action_processing_ms": 0.1400379265854604, "mean_env_wait_ms": 0.08248969659805573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0269927978515625, "StateBufferConnector_ms": 0.004998683929443359, "ViewRequirementAgentConnector_ms": 0.11827993392944336}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.50599999999984, "episode_len_mean": 245.6, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 45.5, 44.7, 44.7, 45.1, 46.099999999999994, 29.899999999999984, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 39.10000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 32.100000000000016, -50.00000000000044, 45.3, -50.00000000000044, 23.499999999999893, -50.00000000000044, 28.89999999999997, 45.1, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 42.30000000000001, 42.900000000000006, 40.500000000000014, 39.10000000000002, 46.099999999999994, 45.1, 40.90000000000002, 45.7, -50.00000000000044, 42.10000000000001, 46.3, 12.299999999999734, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.90000000000002, 30.699999999999996, -50.00000000000044, 28.29999999999996, 46.099999999999994, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 26.09999999999993, 37.90000000000003, 34.10000000000004, 45.9, 45.5, 45.3, 46.099999999999994, 44.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, 26.299999999999933, -50.00000000000044, 45.3, 35.70000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 42.500000000000014, -50.00000000000044, 31.300000000000004, 13.299999999999748, 30.29999999999999, 45.9, 47.1, 29.49999999999998, 40.70000000000002, -50.00000000000044, 44.5, 45.9, 5.299999999999635], "episode_lengths": [500, 32, 46, 54, 54, 50, 40, 202, 500, 500, 206, 500, 110, 500, 98, 500, 152, 500, 500, 500, 78, 180, 500, 48, 500, 266, 500, 212, 50, 500, 142, 500, 500, 172, 500, 78, 72, 96, 110, 40, 50, 92, 44, 500, 80, 38, 378, 500, 500, 66, 102, 194, 500, 218, 40, 500, 58, 60, 500, 500, 240, 122, 160, 42, 46, 48, 40, 52, 500, 104, 500, 34, 44, 500, 238, 500, 48, 144, 500, 102, 500, 56, 54, 500, 500, 500, 230, 76, 500, 188, 368, 198, 42, 30, 206, 94, 500, 56, 42, 448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3758048835185291, "mean_inference_ms": 1.2059988137747508, "mean_action_processing_ms": 0.1400379265854604, "mean_env_wait_ms": 0.08248969659805573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0269927978515625, "StateBufferConnector_ms": 0.004998683929443359, "ViewRequirementAgentConnector_ms": 0.11827993392944336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5687.19743379033, "num_env_steps_trained_throughput_per_sec": 5687.19743379033, "timesteps_total": 1098000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1098000, "timers": {"training_iteration_time_ms": 3194.044, "sample_time_ms": 2815.102, "load_time_ms": 18.41, "load_throughput": 977742.621, "learn_time_ms": 349.046, "learn_throughput": 51569.079, "synch_weights_time_ms": 9.383}, "counters": {"num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "done": false, "episodes_total": 4364, "training_iteration": 61, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-55", "timestamp": 1698248095, "time_this_iter_s": 3.169999599456787, "time_total_s": 197.0078055858612, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 197.0078055858612, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 63.825, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884037e-20, "cur_lr": 0.0003, "total_loss": 7.075106550146033, "policy_loss": -0.0003076569625624904, "vf_loss": 7.075464407602946, "vf_explained_var": -1.0022410640010126e-06, "kl": 0.0007457515080541607, "entropy": 0.5032384914380533, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1661.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.886999999999835, "episode_len_mean": 256.8, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 26.299999999999933, -50.00000000000044, 45.3, 35.70000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 42.500000000000014, -50.00000000000044, 31.300000000000004, 13.299999999999748, 30.29999999999999, 45.9, 47.1, 29.49999999999998, 40.70000000000002, -50.00000000000044, 44.5, 45.9, 5.299999999999635, -50.00000000000044, -50.00000000000044, 47.1, 47.1, -50.00000000000044, 22.49999999999988, 46.5, -50.00000000000044, 40.500000000000014, -50.00000000000044, 41.90000000000001, 35.30000000000004, 44.300000000000004, 39.10000000000002, -50.00000000000044, 0.6999999999995694, 36.30000000000003, 45.5, 35.70000000000003, 4.299999999999621, 33.30000000000003, -50.00000000000044, 44.5, 40.90000000000002, 43.50000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 24.099999999999902, -50.00000000000044, 43.7, 34.10000000000004, -50.00000000000044, 18.499999999999822, 40.500000000000014, -50.00000000000044, 37.90000000000003, 31.70000000000001, -50.00000000000044, 38.50000000000003, 43.30000000000001, 35.10000000000004, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.1, 19.899999999999842, -50.00000000000044, 30.499999999999993, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.900000000000006, -50.00000000000044, 46.099999999999994, 20.299999999999848, 45.9, 42.900000000000006, 29.69999999999998, 32.50000000000002, 26.89999999999994, 41.90000000000001, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, -50.00000000000044, 41.100000000000016], "episode_lengths": [500, 238, 500, 48, 144, 500, 102, 500, 56, 54, 500, 500, 500, 230, 76, 500, 188, 368, 198, 42, 30, 206, 94, 500, 56, 42, 448, 500, 500, 30, 30, 500, 276, 36, 500, 96, 500, 82, 148, 58, 110, 500, 494, 138, 46, 144, 458, 168, 500, 56, 92, 66, 72, 500, 500, 116, 500, 260, 500, 64, 160, 500, 316, 96, 500, 122, 184, 500, 116, 68, 150, 234, 500, 500, 50, 302, 500, 196, 90, 500, 500, 500, 28, 62, 500, 40, 298, 42, 72, 204, 176, 232, 82, 42, 500, 40, 500, 28, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3756197852704632, "mean_inference_ms": 1.2066698974768828, "mean_action_processing_ms": 0.1400881508360379, "mean_env_wait_ms": 0.08265186635139651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029015064239501953, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.1303253173828125}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.886999999999835, "episode_len_mean": 256.8, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 26.299999999999933, -50.00000000000044, 45.3, 35.70000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 42.500000000000014, -50.00000000000044, 31.300000000000004, 13.299999999999748, 30.29999999999999, 45.9, 47.1, 29.49999999999998, 40.70000000000002, -50.00000000000044, 44.5, 45.9, 5.299999999999635, -50.00000000000044, -50.00000000000044, 47.1, 47.1, -50.00000000000044, 22.49999999999988, 46.5, -50.00000000000044, 40.500000000000014, -50.00000000000044, 41.90000000000001, 35.30000000000004, 44.300000000000004, 39.10000000000002, -50.00000000000044, 0.6999999999995694, 36.30000000000003, 45.5, 35.70000000000003, 4.299999999999621, 33.30000000000003, -50.00000000000044, 44.5, 40.90000000000002, 43.50000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 24.099999999999902, -50.00000000000044, 43.7, 34.10000000000004, -50.00000000000044, 18.499999999999822, 40.500000000000014, -50.00000000000044, 37.90000000000003, 31.70000000000001, -50.00000000000044, 38.50000000000003, 43.30000000000001, 35.10000000000004, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.1, 19.899999999999842, -50.00000000000044, 30.499999999999993, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.900000000000006, -50.00000000000044, 46.099999999999994, 20.299999999999848, 45.9, 42.900000000000006, 29.69999999999998, 32.50000000000002, 26.89999999999994, 41.90000000000001, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, -50.00000000000044, 41.100000000000016], "episode_lengths": [500, 238, 500, 48, 144, 500, 102, 500, 56, 54, 500, 500, 500, 230, 76, 500, 188, 368, 198, 42, 30, 206, 94, 500, 56, 42, 448, 500, 500, 30, 30, 500, 276, 36, 500, 96, 500, 82, 148, 58, 110, 500, 494, 138, 46, 144, 458, 168, 500, 56, 92, 66, 72, 500, 500, 116, 500, 260, 500, 64, 160, 500, 316, 96, 500, 122, 184, 500, 116, 68, 150, 234, 500, 500, 50, 302, 500, 196, 90, 500, 500, 500, 28, 62, 500, 40, 298, 42, 72, 204, 176, 232, 82, 42, 500, 40, 500, 28, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3756197852704632, "mean_inference_ms": 1.2066698974768828, "mean_action_processing_ms": 0.1400881508360379, "mean_env_wait_ms": 0.08265186635139651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029015064239501953, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.1303253173828125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5730.65200683906, "num_env_steps_trained_throughput_per_sec": 5730.65200683906, "timesteps_total": 1116000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 3186.933, "sample_time_ms": 2816.921, "load_time_ms": 17.213, "load_throughput": 1045751.02, "learn_time_ms": 341.217, "learn_throughput": 52752.366, "synch_weights_time_ms": 9.58}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4437, "training_iteration": 62, "trial_id": "9f288_00012", "date": "2023-10-25_16-34-59", "timestamp": 1698248099, "time_this_iter_s": 3.147998332977295, "time_total_s": 200.1558039188385, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 200.1558039188385, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 56.96, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.3368086899420186e-20, "cur_lr": 0.0003, "total_loss": 6.496394069106491, "policy_loss": -0.00022688521831123917, "vf_loss": 6.496666943585431, "vf_explained_var": -7.549921671549479e-07, "kl": 0.0005327724201193902, "entropy": 0.45956713844228675, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1688.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.538999999999837, "episode_len_mean": 250.26, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.69999999999994, -50.00000000000044, -50.00000000000044, 45.1, 19.899999999999842, -50.00000000000044, 30.499999999999993, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.900000000000006, -50.00000000000044, 46.099999999999994, 20.299999999999848, 45.9, 42.900000000000006, 29.69999999999998, 32.50000000000002, 26.89999999999994, 41.90000000000001, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, -50.00000000000044, 41.100000000000016, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.5, 25.699999999999925, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 45.5, 15.49999999999978, -50.00000000000044, 33.70000000000004, 30.499999999999993, 46.099999999999994, 45.9, 43.900000000000006, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 31.500000000000007, 36.10000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 14.899999999999771, 18.499999999999822, -50.00000000000044, 45.3, 36.30000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 28.699999999999967, 44.7, 47.1, 43.7, -50.00000000000044, 45.5, 42.30000000000001, 43.50000000000001, 41.90000000000001, 28.499999999999964, 37.90000000000003, 44.10000000000001, 44.5, 20.299999999999848, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.1, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 34.70000000000004, 39.90000000000002, 38.90000000000002, 39.10000000000002, -50.00000000000044, 42.10000000000001, 45.7, 43.900000000000006], "episode_lengths": [234, 500, 500, 50, 302, 500, 196, 90, 500, 500, 500, 28, 62, 500, 40, 298, 42, 72, 204, 176, 232, 82, 42, 500, 40, 500, 28, 500, 90, 84, 500, 500, 40, 46, 244, 500, 500, 146, 500, 500, 46, 346, 500, 164, 196, 40, 42, 62, 76, 500, 44, 500, 500, 186, 140, 500, 500, 28, 500, 500, 352, 316, 500, 48, 138, 66, 500, 500, 214, 54, 30, 64, 500, 46, 78, 66, 82, 216, 122, 60, 56, 298, 70, 500, 500, 500, 54, 50, 500, 144, 500, 500, 154, 102, 112, 110, 500, 80, 44, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37553567574762775, "mean_inference_ms": 1.2061743801445304, "mean_action_processing_ms": 0.13988421456067882, "mean_env_wait_ms": 0.0827290007490409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024997234344482422, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.13199067115783691}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.538999999999837, "episode_len_mean": 250.26, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.69999999999994, -50.00000000000044, -50.00000000000044, 45.1, 19.899999999999842, -50.00000000000044, 30.499999999999993, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.900000000000006, -50.00000000000044, 46.099999999999994, 20.299999999999848, 45.9, 42.900000000000006, 29.69999999999998, 32.50000000000002, 26.89999999999994, 41.90000000000001, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, -50.00000000000044, 41.100000000000016, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.5, 25.699999999999925, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 45.5, 15.49999999999978, -50.00000000000044, 33.70000000000004, 30.499999999999993, 46.099999999999994, 45.9, 43.900000000000006, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 31.500000000000007, 36.10000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 14.899999999999771, 18.499999999999822, -50.00000000000044, 45.3, 36.30000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 28.699999999999967, 44.7, 47.1, 43.7, -50.00000000000044, 45.5, 42.30000000000001, 43.50000000000001, 41.90000000000001, 28.499999999999964, 37.90000000000003, 44.10000000000001, 44.5, 20.299999999999848, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.1, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 34.70000000000004, 39.90000000000002, 38.90000000000002, 39.10000000000002, -50.00000000000044, 42.10000000000001, 45.7, 43.900000000000006], "episode_lengths": [234, 500, 500, 50, 302, 500, 196, 90, 500, 500, 500, 28, 62, 500, 40, 298, 42, 72, 204, 176, 232, 82, 42, 500, 40, 500, 28, 500, 90, 84, 500, 500, 40, 46, 244, 500, 500, 146, 500, 500, 46, 346, 500, 164, 196, 40, 42, 62, 76, 500, 44, 500, 500, 186, 140, 500, 500, 28, 500, 500, 352, 316, 500, 48, 138, 66, 500, 500, 214, 54, 30, 64, 500, 46, 78, 66, 82, 216, 122, 60, 56, 298, 70, 500, 500, 500, 54, 50, 500, 144, 500, 500, 154, 102, 112, 110, 500, 80, 44, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37553567574762775, "mean_inference_ms": 1.2061743801445304, "mean_action_processing_ms": 0.13988421456067882, "mean_env_wait_ms": 0.0827290007490409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024997234344482422, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.13199067115783691}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5617.975862581644, "num_env_steps_trained_throughput_per_sec": 5617.975862581644, "timesteps_total": 1134000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1134000, "timers": {"training_iteration_time_ms": 3185.942, "sample_time_ms": 2815.13, "load_time_ms": 17.315, "load_throughput": 1039533.502, "learn_time_ms": 341.916, "learn_throughput": 52644.434, "synch_weights_time_ms": 9.577}, "counters": {"num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "done": false, "episodes_total": 4508, "training_iteration": 63, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-02", "timestamp": 1698248102, "time_this_iter_s": 3.2089996337890625, "time_total_s": 203.36480355262756, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 203.36480355262756, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 63.699999999999996, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 0.0003, "total_loss": 6.5957706592701095, "policy_loss": -0.0004107710663919096, "vf_loss": 6.596228493584527, "vf_explained_var": -1.090544241446036e-06, "kl": 0.0009463278017352439, "entropy": 0.47071681530387316, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1715.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.614999999999844, "episode_len_mean": 229.52, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 44.5, 20.299999999999848, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.1, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 34.70000000000004, 39.90000000000002, 38.90000000000002, 39.10000000000002, -50.00000000000044, 42.10000000000001, 45.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 28.29999999999996, -50.00000000000044, 45.7, -50.00000000000044, 46.099999999999994, 44.10000000000001, 43.50000000000001, 42.10000000000001, 46.3, -50.00000000000044, 46.699999999999996, 40.70000000000002, 47.1, 23.099999999999888, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.7, 46.3, 47.1, 45.5, 3.0999999999996035, -50.00000000000044, 39.300000000000026, 45.5, 32.50000000000002, 47.9, 42.70000000000001, 41.70000000000002, 43.7, 38.300000000000026, -50.00000000000044, 45.1, 41.70000000000002, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 35.10000000000004, 46.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 38.10000000000002, -50.00000000000044, 26.09999999999993, 46.9, 45.5, 46.099999999999994, 44.300000000000004, 11.899999999999729, 45.5, 44.10000000000001, 3.0999999999996035, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, 47.5, 46.699999999999996, -50.00000000000044], "episode_lengths": [60, 56, 298, 70, 500, 500, 500, 54, 50, 500, 144, 500, 500, 154, 102, 112, 110, 500, 80, 44, 62, 500, 500, 68, 218, 500, 44, 500, 40, 60, 66, 80, 38, 500, 34, 94, 30, 270, 500, 68, 500, 24, 38, 30, 46, 470, 500, 108, 46, 176, 22, 74, 84, 64, 118, 500, 50, 84, 500, 32, 500, 500, 40, 40, 142, 500, 500, 500, 130, 150, 32, 122, 500, 500, 500, 50, 500, 46, 120, 500, 240, 32, 46, 40, 58, 382, 46, 60, 470, 34, 500, 500, 500, 500, 74, 500, 66, 26, 34, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3756469521640845, "mean_inference_ms": 1.205356305356389, "mean_action_processing_ms": 0.13997916116598957, "mean_env_wait_ms": 0.08259941940688748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022003889083862305, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.11901021003723145}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.614999999999844, "episode_len_mean": 229.52, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 44.5, 20.299999999999848, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.1, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 34.70000000000004, 39.90000000000002, 38.90000000000002, 39.10000000000002, -50.00000000000044, 42.10000000000001, 45.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 28.29999999999996, -50.00000000000044, 45.7, -50.00000000000044, 46.099999999999994, 44.10000000000001, 43.50000000000001, 42.10000000000001, 46.3, -50.00000000000044, 46.699999999999996, 40.70000000000002, 47.1, 23.099999999999888, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.7, 46.3, 47.1, 45.5, 3.0999999999996035, -50.00000000000044, 39.300000000000026, 45.5, 32.50000000000002, 47.9, 42.70000000000001, 41.70000000000002, 43.7, 38.300000000000026, -50.00000000000044, 45.1, 41.70000000000002, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 35.10000000000004, 46.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 38.10000000000002, -50.00000000000044, 26.09999999999993, 46.9, 45.5, 46.099999999999994, 44.300000000000004, 11.899999999999729, 45.5, 44.10000000000001, 3.0999999999996035, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, 47.5, 46.699999999999996, -50.00000000000044], "episode_lengths": [60, 56, 298, 70, 500, 500, 500, 54, 50, 500, 144, 500, 500, 154, 102, 112, 110, 500, 80, 44, 62, 500, 500, 68, 218, 500, 44, 500, 40, 60, 66, 80, 38, 500, 34, 94, 30, 270, 500, 68, 500, 24, 38, 30, 46, 470, 500, 108, 46, 176, 22, 74, 84, 64, 118, 500, 50, 84, 500, 32, 500, 500, 40, 40, 142, 500, 500, 500, 130, 150, 32, 122, 500, 500, 500, 50, 500, 46, 120, 500, 240, 32, 46, 40, 58, 382, 46, 60, 470, 34, 500, 500, 500, 500, 74, 500, 66, 26, 34, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3756469521640845, "mean_inference_ms": 1.205356305356389, "mean_action_processing_ms": 0.13997916116598957, "mean_env_wait_ms": 0.08259941940688748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022003889083862305, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.11901021003723145}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5607.515719024197, "num_env_steps_trained_throughput_per_sec": 5607.515719024197, "timesteps_total": 1152000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 3193.641, "sample_time_ms": 2820.73, "load_time_ms": 18.118, "load_throughput": 993466.221, "learn_time_ms": 343.517, "learn_throughput": 52399.205, "synch_weights_time_ms": 9.274}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4587, "training_iteration": 64, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-05", "timestamp": 1698248105, "time_this_iter_s": 3.2149713039398193, "time_total_s": 206.57977485656738, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 206.57977485656738, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 54.96, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855046e-20, "cur_lr": 0.0003, "total_loss": 6.988658834386755, "policy_loss": -0.0001639187060020588, "vf_loss": 6.988869278519242, "vf_explained_var": -8.830317744502315e-07, "kl": 0.0004551318833726462, "entropy": 0.4667019844055176, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1742.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.580999999999816, "episode_len_mean": 259.82, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 38.10000000000002, -50.00000000000044, 26.09999999999993, 46.9, 45.5, 46.099999999999994, 44.300000000000004, 11.899999999999729, 45.5, 44.10000000000001, 3.0999999999996035, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, 47.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, 45.9, -50.00000000000044, 37.70000000000003, 44.300000000000004, 28.09999999999996, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.30000000000001, 42.30000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 35.10000000000004, 45.9, -50.00000000000044, 5.099999999999632, 46.3, 41.90000000000001, -50.00000000000044, 42.900000000000006, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 46.3, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 33.70000000000004, 46.9, 40.10000000000002, 44.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 36.50000000000003, -50.00000000000044, 4.699999999999626, 46.099999999999994, 37.90000000000003, -50.00000000000044, 45.3, 43.900000000000006, 46.9, 46.099999999999994, 46.9, -50.00000000000044, 13.899999999999757, 37.10000000000003, 41.100000000000016, 45.5, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 33.10000000000003], "episode_lengths": [500, 500, 50, 500, 46, 120, 500, 240, 32, 46, 40, 58, 382, 46, 60, 470, 34, 500, 500, 500, 500, 74, 500, 66, 26, 34, 500, 500, 500, 58, 64, 42, 500, 124, 58, 220, 500, 500, 52, 78, 78, 202, 500, 500, 500, 160, 150, 42, 500, 450, 38, 82, 500, 72, 190, 500, 500, 500, 136, 38, 60, 56, 500, 500, 494, 500, 500, 164, 32, 100, 60, 54, 500, 500, 32, 500, 500, 44, 32, 500, 136, 500, 454, 40, 122, 500, 48, 62, 32, 40, 32, 500, 362, 130, 90, 46, 432, 500, 500, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3758532337742368, "mean_inference_ms": 1.205619050894864, "mean_action_processing_ms": 0.1396079974901448, "mean_env_wait_ms": 0.08263721572961073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025009870529174805, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.10800981521606445}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.580999999999816, "episode_len_mean": 259.82, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 38.10000000000002, -50.00000000000044, 26.09999999999993, 46.9, 45.5, 46.099999999999994, 44.300000000000004, 11.899999999999729, 45.5, 44.10000000000001, 3.0999999999996035, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, 47.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, 45.9, -50.00000000000044, 37.70000000000003, 44.300000000000004, 28.09999999999996, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.30000000000001, 42.30000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 35.10000000000004, 45.9, -50.00000000000044, 5.099999999999632, 46.3, 41.90000000000001, -50.00000000000044, 42.900000000000006, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 46.3, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 33.70000000000004, 46.9, 40.10000000000002, 44.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 36.50000000000003, -50.00000000000044, 4.699999999999626, 46.099999999999994, 37.90000000000003, -50.00000000000044, 45.3, 43.900000000000006, 46.9, 46.099999999999994, 46.9, -50.00000000000044, 13.899999999999757, 37.10000000000003, 41.100000000000016, 45.5, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 33.10000000000003], "episode_lengths": [500, 500, 50, 500, 46, 120, 500, 240, 32, 46, 40, 58, 382, 46, 60, 470, 34, 500, 500, 500, 500, 74, 500, 66, 26, 34, 500, 500, 500, 58, 64, 42, 500, 124, 58, 220, 500, 500, 52, 78, 78, 202, 500, 500, 500, 160, 150, 42, 500, 450, 38, 82, 500, 72, 190, 500, 500, 500, 136, 38, 60, 56, 500, 500, 494, 500, 500, 164, 32, 100, 60, 54, 500, 500, 32, 500, 500, 44, 32, 500, 136, 500, 454, 40, 122, 500, 48, 62, 32, 40, 32, 500, 362, 130, 90, 46, 432, 500, 500, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3758532337742368, "mean_inference_ms": 1.205619050894864, "mean_action_processing_ms": 0.1396079974901448, "mean_env_wait_ms": 0.08263721572961073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025009870529174805, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.10800981521606445}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5763.742175744292, "num_env_steps_trained_throughput_per_sec": 5763.742175744292, "timesteps_total": 1170000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1170000, "timers": {"training_iteration_time_ms": 3183.13, "sample_time_ms": 2817.128, "load_time_ms": 17.321, "load_throughput": 1039200.106, "learn_time_ms": 337.406, "learn_throughput": 53348.204, "synch_weights_time_ms": 9.274}, "counters": {"num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "done": false, "episodes_total": 4660, "training_iteration": 65, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-08", "timestamp": 1698248108, "time_this_iter_s": 3.1279702186584473, "time_total_s": 209.70774507522583, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 209.70774507522583, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 62.6, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427523e-21, "cur_lr": 0.0003, "total_loss": 6.567006040502478, "policy_loss": 8.183152035430626e-06, "vf_loss": 6.567043498710349, "vf_explained_var": -1.0287320172345197e-06, "kl": 9.818590968877659e-05, "entropy": 0.4560899922141322, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1769.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.080999999999845, "episode_len_mean": 224.88, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 36.50000000000003, -50.00000000000044, 4.699999999999626, 46.099999999999994, 37.90000000000003, -50.00000000000044, 45.3, 43.900000000000006, 46.9, 46.099999999999994, 46.9, -50.00000000000044, 13.899999999999757, 37.10000000000003, 41.100000000000016, 45.5, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.3, 40.70000000000002, 44.900000000000006, 39.10000000000002, 44.900000000000006, -50.00000000000044, 21.299999999999862, 46.5, -50.00000000000044, 44.5, 43.30000000000001, 30.499999999999993, -50.00000000000044, 45.5, 45.5, 46.099999999999994, 46.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.300000000000004, -50.00000000000044, 41.500000000000014, 44.5, 45.3, -50.00000000000044, 45.1, -50.00000000000044, 23.099999999999888, 46.699999999999996, 31.70000000000001, 45.9, 42.70000000000001, 41.90000000000001, 26.69999999999994, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 22.49999999999988, 0.49999999999956657, 45.7, 46.5, -50.00000000000044, -50.00000000000044, 46.3, 47.1, -50.00000000000044, 46.099999999999994, 47.3, 43.10000000000001, 45.3, 45.7, 8.899999999999686, -50.00000000000044, -50.00000000000044, 46.9, 42.500000000000014, -50.00000000000044, 46.099999999999994, 46.9, 44.900000000000006, 39.90000000000002, 37.90000000000003, -50.00000000000044, 46.3, 45.9, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [32, 500, 136, 500, 454, 40, 122, 500, 48, 62, 32, 40, 32, 500, 362, 130, 90, 46, 432, 500, 500, 170, 500, 38, 94, 52, 110, 52, 500, 288, 36, 500, 56, 68, 196, 500, 46, 46, 40, 38, 500, 500, 60, 58, 500, 86, 56, 48, 500, 50, 500, 270, 34, 184, 42, 74, 82, 234, 32, 34, 500, 500, 276, 496, 44, 36, 500, 500, 38, 30, 500, 40, 28, 70, 48, 44, 412, 500, 500, 32, 76, 500, 40, 32, 52, 102, 122, 500, 38, 42, 50, 500, 500, 500, 500, 52, 500, 56, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37549994622643257, "mean_inference_ms": 1.205177992728741, "mean_action_processing_ms": 0.13946918721611148, "mean_env_wait_ms": 0.08241524981386669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02398085594177246, "StateBufferConnector_ms": 0.006005764007568359, "ViewRequirementAgentConnector_ms": 0.0949697494506836}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.080999999999845, "episode_len_mean": 224.88, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 36.50000000000003, -50.00000000000044, 4.699999999999626, 46.099999999999994, 37.90000000000003, -50.00000000000044, 45.3, 43.900000000000006, 46.9, 46.099999999999994, 46.9, -50.00000000000044, 13.899999999999757, 37.10000000000003, 41.100000000000016, 45.5, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.3, 40.70000000000002, 44.900000000000006, 39.10000000000002, 44.900000000000006, -50.00000000000044, 21.299999999999862, 46.5, -50.00000000000044, 44.5, 43.30000000000001, 30.499999999999993, -50.00000000000044, 45.5, 45.5, 46.099999999999994, 46.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.300000000000004, -50.00000000000044, 41.500000000000014, 44.5, 45.3, -50.00000000000044, 45.1, -50.00000000000044, 23.099999999999888, 46.699999999999996, 31.70000000000001, 45.9, 42.70000000000001, 41.90000000000001, 26.69999999999994, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 22.49999999999988, 0.49999999999956657, 45.7, 46.5, -50.00000000000044, -50.00000000000044, 46.3, 47.1, -50.00000000000044, 46.099999999999994, 47.3, 43.10000000000001, 45.3, 45.7, 8.899999999999686, -50.00000000000044, -50.00000000000044, 46.9, 42.500000000000014, -50.00000000000044, 46.099999999999994, 46.9, 44.900000000000006, 39.90000000000002, 37.90000000000003, -50.00000000000044, 46.3, 45.9, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [32, 500, 136, 500, 454, 40, 122, 500, 48, 62, 32, 40, 32, 500, 362, 130, 90, 46, 432, 500, 500, 170, 500, 38, 94, 52, 110, 52, 500, 288, 36, 500, 56, 68, 196, 500, 46, 46, 40, 38, 500, 500, 60, 58, 500, 86, 56, 48, 500, 50, 500, 270, 34, 184, 42, 74, 82, 234, 32, 34, 500, 500, 276, 496, 44, 36, 500, 500, 38, 30, 500, 40, 28, 70, 48, 44, 412, 500, 500, 32, 76, 500, 40, 32, 52, 102, 122, 500, 38, 42, 50, 500, 500, 500, 500, 52, 500, 56, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37549994622643257, "mean_inference_ms": 1.205177992728741, "mean_action_processing_ms": 0.13946918721611148, "mean_env_wait_ms": 0.08241524981386669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02398085594177246, "StateBufferConnector_ms": 0.006005764007568359, "ViewRequirementAgentConnector_ms": 0.0949697494506836}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5555.553086338173, "num_env_steps_trained_throughput_per_sec": 5555.553086338173, "timesteps_total": 1188000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 3198.582, "sample_time_ms": 2825.38, "load_time_ms": 18.32, "load_throughput": 982509.087, "learn_time_ms": 343.706, "learn_throughput": 52370.363, "synch_weights_time_ms": 9.375}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4738, "training_iteration": 66, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-11", "timestamp": 1698248111, "time_this_iter_s": 3.2459990978240967, "time_total_s": 212.95374417304993, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 212.95374417304993, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 55.06, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137616e-21, "cur_lr": 0.0003, "total_loss": 6.676282105622469, "policy_loss": -0.00020131130737287026, "vf_loss": 6.676527853365298, "vf_explained_var": -9.095227276837384e-07, "kl": 0.00036945287288385015, "entropy": 0.4434605362238707, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1796.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.463999999999817, "episode_len_mean": 255.98, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, 47.1, -50.00000000000044, 46.099999999999994, 47.3, 43.10000000000001, 45.3, 45.7, 8.899999999999686, -50.00000000000044, -50.00000000000044, 46.9, 42.500000000000014, -50.00000000000044, 46.099999999999994, 46.9, 44.900000000000006, 39.90000000000002, 37.90000000000003, -50.00000000000044, 46.3, 45.9, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 32.50000000000002, 42.30000000000001, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, 13.699999999999754, 27.099999999999945, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.299999999999848, 41.500000000000014, -50.00000000000044, 46.699999999999996, -50.00000000000044, 29.099999999999973, 44.900000000000006, 31.500000000000007, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 26.499999999999936, 42.30000000000001, 44.10000000000001, -50.00000000000044, 47.5, 45.9, 46.3, 46.099999999999994, 39.300000000000026, 46.099999999999994, 47.3, 44.900000000000006, 46.099999999999994, 44.900000000000006, 45.7, 43.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 14.899999999999771, -50.00000000000044, 34.10000000000004, -50.00000000000044, 45.9, 45.3, 5.499999999999638, 16.699999999999797, 47.5], "episode_lengths": [500, 38, 30, 500, 40, 28, 70, 48, 44, 412, 500, 500, 32, 76, 500, 40, 32, 52, 102, 122, 500, 38, 42, 50, 500, 500, 500, 500, 52, 500, 56, 500, 500, 500, 500, 76, 500, 96, 500, 500, 500, 46, 500, 52, 500, 176, 78, 48, 60, 500, 500, 346, 500, 364, 230, 500, 268, 500, 500, 500, 298, 86, 500, 34, 500, 210, 52, 186, 500, 500, 44, 500, 236, 78, 60, 500, 26, 42, 38, 40, 108, 40, 28, 52, 40, 52, 44, 62, 500, 90, 500, 352, 500, 160, 500, 42, 48, 446, 334, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3751574364849624, "mean_inference_ms": 1.2057657944104792, "mean_action_processing_ms": 0.13995815610975978, "mean_env_wait_ms": 0.08261381643348434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030000686645507812, "StateBufferConnector_ms": 0.009004831314086914, "ViewRequirementAgentConnector_ms": 0.11698675155639648}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.463999999999817, "episode_len_mean": 255.98, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, 47.1, -50.00000000000044, 46.099999999999994, 47.3, 43.10000000000001, 45.3, 45.7, 8.899999999999686, -50.00000000000044, -50.00000000000044, 46.9, 42.500000000000014, -50.00000000000044, 46.099999999999994, 46.9, 44.900000000000006, 39.90000000000002, 37.90000000000003, -50.00000000000044, 46.3, 45.9, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 32.50000000000002, 42.30000000000001, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, 13.699999999999754, 27.099999999999945, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.299999999999848, 41.500000000000014, -50.00000000000044, 46.699999999999996, -50.00000000000044, 29.099999999999973, 44.900000000000006, 31.500000000000007, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 26.499999999999936, 42.30000000000001, 44.10000000000001, -50.00000000000044, 47.5, 45.9, 46.3, 46.099999999999994, 39.300000000000026, 46.099999999999994, 47.3, 44.900000000000006, 46.099999999999994, 44.900000000000006, 45.7, 43.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 14.899999999999771, -50.00000000000044, 34.10000000000004, -50.00000000000044, 45.9, 45.3, 5.499999999999638, 16.699999999999797, 47.5], "episode_lengths": [500, 38, 30, 500, 40, 28, 70, 48, 44, 412, 500, 500, 32, 76, 500, 40, 32, 52, 102, 122, 500, 38, 42, 50, 500, 500, 500, 500, 52, 500, 56, 500, 500, 500, 500, 76, 500, 96, 500, 500, 500, 46, 500, 52, 500, 176, 78, 48, 60, 500, 500, 346, 500, 364, 230, 500, 268, 500, 500, 500, 298, 86, 500, 34, 500, 210, 52, 186, 500, 500, 44, 500, 236, 78, 60, 500, 26, 42, 38, 40, 108, 40, 28, 52, 40, 52, 44, 62, 500, 90, 500, 352, 500, 160, 500, 42, 48, 446, 334, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3751574364849624, "mean_inference_ms": 1.2057657944104792, "mean_action_processing_ms": 0.13995815610975978, "mean_env_wait_ms": 0.08261381643348434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030000686645507812, "StateBufferConnector_ms": 0.009004831314086914, "ViewRequirementAgentConnector_ms": 0.11698675155639648}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5635.5637327462, "num_env_steps_trained_throughput_per_sec": 5635.5637327462, "timesteps_total": 1206000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1206000, "timers": {"training_iteration_time_ms": 3207.785, "sample_time_ms": 2830.583, "load_time_ms": 19.423, "load_throughput": 926728.001, "learn_time_ms": 346.803, "learn_throughput": 51902.641, "synch_weights_time_ms": 9.275}, "counters": {"num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "done": false, "episodes_total": 4805, "training_iteration": 67, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-15", "timestamp": 1698248115, "time_this_iter_s": 3.2009997367858887, "time_total_s": 216.15474390983582, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 216.15474390983582, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 63.925, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 0.0003, "total_loss": 6.604793089407462, "policy_loss": -0.0003948650426334805, "vf_loss": 6.605236088788068, "vf_explained_var": -1.0287320172345197e-06, "kl": 0.0005328506974356733, "entropy": 0.4825220571623908, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1823.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.7029999999998235, "episode_len_mean": 248.62, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.099999999999973, 44.900000000000006, 31.500000000000007, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 26.499999999999936, 42.30000000000001, 44.10000000000001, -50.00000000000044, 47.5, 45.9, 46.3, 46.099999999999994, 39.300000000000026, 46.099999999999994, 47.3, 44.900000000000006, 46.099999999999994, 44.900000000000006, 45.7, 43.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 14.899999999999771, -50.00000000000044, 34.10000000000004, -50.00000000000044, 45.9, 45.3, 5.499999999999638, 16.699999999999797, 47.5, -50.00000000000044, 47.5, 9.8999999999997, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.3, 46.5, 42.70000000000001, 44.900000000000006, -50.00000000000044, 16.699999999999797, 46.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.70000000000002, 43.900000000000006, -50.00000000000044, 14.09999999999976, 35.70000000000003, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, 28.09999999999996, 46.099999999999994, 22.099999999999874, 17.299999999999805, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 40.30000000000002, 45.3, 44.10000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 45.9, -50.00000000000044, 44.5, 32.30000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.300000000000004], "episode_lengths": [210, 52, 186, 500, 500, 44, 500, 236, 78, 60, 500, 26, 42, 38, 40, 108, 40, 28, 52, 40, 52, 44, 62, 500, 90, 500, 352, 500, 160, 500, 42, 48, 446, 334, 26, 500, 26, 402, 40, 500, 500, 500, 36, 500, 102, 500, 38, 36, 74, 52, 500, 334, 36, 96, 500, 500, 68, 500, 104, 62, 500, 360, 144, 500, 448, 500, 500, 500, 500, 500, 34, 44, 220, 40, 280, 328, 500, 500, 46, 54, 500, 98, 48, 60, 500, 180, 500, 40, 500, 46, 42, 500, 56, 178, 68, 500, 500, 48, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37559988228549485, "mean_inference_ms": 1.205641459175153, "mean_action_processing_ms": 0.13986508984263682, "mean_env_wait_ms": 0.08268994146305587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699756622314453, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.11397528648376465}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.7029999999998235, "episode_len_mean": 248.62, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.099999999999973, 44.900000000000006, 31.500000000000007, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 26.499999999999936, 42.30000000000001, 44.10000000000001, -50.00000000000044, 47.5, 45.9, 46.3, 46.099999999999994, 39.300000000000026, 46.099999999999994, 47.3, 44.900000000000006, 46.099999999999994, 44.900000000000006, 45.7, 43.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 14.899999999999771, -50.00000000000044, 34.10000000000004, -50.00000000000044, 45.9, 45.3, 5.499999999999638, 16.699999999999797, 47.5, -50.00000000000044, 47.5, 9.8999999999997, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.3, 46.5, 42.70000000000001, 44.900000000000006, -50.00000000000044, 16.699999999999797, 46.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.70000000000002, 43.900000000000006, -50.00000000000044, 14.09999999999976, 35.70000000000003, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, 28.09999999999996, 46.099999999999994, 22.099999999999874, 17.299999999999805, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 40.30000000000002, 45.3, 44.10000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 45.9, -50.00000000000044, 44.5, 32.30000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.300000000000004], "episode_lengths": [210, 52, 186, 500, 500, 44, 500, 236, 78, 60, 500, 26, 42, 38, 40, 108, 40, 28, 52, 40, 52, 44, 62, 500, 90, 500, 352, 500, 160, 500, 42, 48, 446, 334, 26, 500, 26, 402, 40, 500, 500, 500, 36, 500, 102, 500, 38, 36, 74, 52, 500, 334, 36, 96, 500, 500, 68, 500, 104, 62, 500, 360, 144, 500, 448, 500, 500, 500, 500, 500, 34, 44, 220, 40, 280, 328, 500, 500, 46, 54, 500, 98, 48, 60, 500, 180, 500, 40, 500, 46, 42, 500, 56, 178, 68, 500, 500, 48, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37559988228549485, "mean_inference_ms": 1.205641459175153, "mean_action_processing_ms": 0.13986508984263682, "mean_env_wait_ms": 0.08268994146305587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699756622314453, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.11397528648376465}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5447.9774337940335, "num_env_steps_trained_throughput_per_sec": 5447.9774337940335, "timesteps_total": 1224000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 3194.985, "sample_time_ms": 2822.483, "load_time_ms": 19.523, "load_throughput": 921984.911, "learn_time_ms": 341.903, "learn_throughput": 52646.512, "synch_weights_time_ms": 9.375}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4870, "training_iteration": 68, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-18", "timestamp": 1698248118, "time_this_iter_s": 3.3109705448150635, "time_total_s": 219.46571445465088, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 219.46571445465088, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 57.86, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 0.0003, "total_loss": 6.389579419736509, "policy_loss": 0.00013006388865135335, "vf_loss": 6.389494012903284, "vf_explained_var": -9.227682043004919e-07, "kl": 0.00014830489374820336, "entropy": 0.44705421063635087, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1850.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.271000000000222, "episode_len_mean": 298.26, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, 43.900000000000006, -50.00000000000044, 14.09999999999976, 35.70000000000003, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, 28.09999999999996, 46.099999999999994, 22.099999999999874, 17.299999999999805, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 40.30000000000002, 45.3, 44.10000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 45.9, -50.00000000000044, 44.5, 32.30000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.300000000000004, 28.29999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, 12.099999999999731, -50.00000000000044, 45.9, 34.50000000000004, -50.00000000000044, 46.099999999999994, 42.10000000000001, 46.099999999999994, 37.70000000000003, -50.00000000000044, 27.699999999999953, 33.30000000000003, 45.5, -50.00000000000044, 43.10000000000001, 40.90000000000002, 15.299999999999777, 38.50000000000003, 8.49999999999968, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 10.299999999999706, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.5, -50.00000000000044, 47.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 44.10000000000001, 46.699999999999996, -50.00000000000044], "episode_lengths": [500, 104, 62, 500, 360, 144, 500, 448, 500, 500, 500, 500, 500, 34, 44, 220, 40, 280, 328, 500, 500, 46, 54, 500, 98, 48, 60, 500, 180, 500, 40, 500, 46, 42, 500, 56, 178, 68, 500, 500, 48, 500, 58, 218, 52, 500, 500, 58, 500, 500, 500, 500, 462, 380, 500, 42, 156, 500, 40, 80, 40, 124, 500, 224, 168, 46, 500, 70, 92, 348, 116, 416, 500, 500, 52, 500, 398, 304, 500, 500, 500, 500, 500, 500, 500, 500, 500, 34, 56, 500, 26, 58, 500, 500, 38, 500, 48, 60, 34, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37562067170510594, "mean_inference_ms": 1.20481871524677, "mean_action_processing_ms": 0.13938404333837698, "mean_env_wait_ms": 0.08259378429128379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035003662109375, "StateBufferConnector_ms": 0.005998849868774414, "ViewRequirementAgentConnector_ms": 0.10899472236633301}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.271000000000222, "episode_len_mean": 298.26, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, 43.900000000000006, -50.00000000000044, 14.09999999999976, 35.70000000000003, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, 28.09999999999996, 46.099999999999994, 22.099999999999874, 17.299999999999805, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 40.30000000000002, 45.3, 44.10000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 45.9, -50.00000000000044, 44.5, 32.30000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.300000000000004, 28.29999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, 12.099999999999731, -50.00000000000044, 45.9, 34.50000000000004, -50.00000000000044, 46.099999999999994, 42.10000000000001, 46.099999999999994, 37.70000000000003, -50.00000000000044, 27.699999999999953, 33.30000000000003, 45.5, -50.00000000000044, 43.10000000000001, 40.90000000000002, 15.299999999999777, 38.50000000000003, 8.49999999999968, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 10.299999999999706, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.5, -50.00000000000044, 47.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 44.10000000000001, 46.699999999999996, -50.00000000000044], "episode_lengths": [500, 104, 62, 500, 360, 144, 500, 448, 500, 500, 500, 500, 500, 34, 44, 220, 40, 280, 328, 500, 500, 46, 54, 500, 98, 48, 60, 500, 180, 500, 40, 500, 46, 42, 500, 56, 178, 68, 500, 500, 48, 500, 58, 218, 52, 500, 500, 58, 500, 500, 500, 500, 462, 380, 500, 42, 156, 500, 40, 80, 40, 124, 500, 224, 168, 46, 500, 70, 92, 348, 116, 416, 500, 500, 52, 500, 398, 304, 500, 500, 500, 500, 500, 500, 500, 500, 500, 34, 56, 500, 26, 58, 500, 500, 38, 500, 48, 60, 34, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37562067170510594, "mean_inference_ms": 1.20481871524677, "mean_action_processing_ms": 0.13938404333837698, "mean_env_wait_ms": 0.08259378429128379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035003662109375, "StateBufferConnector_ms": 0.005998849868774414, "ViewRequirementAgentConnector_ms": 0.10899472236633301}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5533.3521693482335, "num_env_steps_trained_throughput_per_sec": 5533.3521693482335, "timesteps_total": 1242000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1242000, "timers": {"training_iteration_time_ms": 3204.185, "sample_time_ms": 2830.783, "load_time_ms": 20.326, "load_throughput": 885557.216, "learn_time_ms": 341.5, "learn_throughput": 52708.628, "synch_weights_time_ms": 9.875}, "counters": {"num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "done": false, "episodes_total": 4927, "training_iteration": 69, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-21", "timestamp": 1698248121, "time_this_iter_s": 3.2599997520446777, "time_total_s": 222.72571420669556, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 222.72571420669556, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 55.839999999999996, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.388131789017202e-22, "cur_lr": 0.0003, "total_loss": 6.46464819378323, "policy_loss": -6.224794520272149e-05, "vf_loss": 6.464757725044533, "vf_explained_var": -9.27183363172743e-07, "kl": 7.367049954714949e-05, "entropy": 0.4710470603571998, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1877.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.4380000000002193, "episode_len_mean": 284.94, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, 40.90000000000002, 15.299999999999777, 38.50000000000003, 8.49999999999968, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 10.299999999999706, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.5, -50.00000000000044, 47.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 44.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 44.7, 46.5, 46.5, 29.899999999999984, -50.00000000000044, 3.699999999999612, 46.099999999999994, 45.1, 46.3, -50.00000000000044, 43.7, 25.899999999999928, 42.10000000000001, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.9, 23.699999999999896, -50.00000000000044, 43.7, -50.00000000000044, 42.30000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 44.7, 23.699999999999896, 2.0999999999995893, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 2.299999999999592, 45.9, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 46.5, 46.9, -50.00000000000044, 46.5, 46.699999999999996, 46.3, 46.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.1, -50.00000000000044], "episode_lengths": [500, 70, 92, 348, 116, 416, 500, 500, 52, 500, 398, 304, 500, 500, 500, 500, 500, 500, 500, 500, 500, 34, 56, 500, 26, 58, 500, 500, 38, 500, 48, 60, 34, 500, 500, 94, 500, 500, 54, 36, 36, 202, 500, 464, 40, 50, 38, 500, 64, 242, 80, 54, 34, 500, 500, 116, 32, 264, 500, 64, 500, 78, 104, 500, 500, 500, 24, 500, 54, 264, 480, 500, 56, 78, 500, 282, 500, 500, 500, 500, 46, 478, 42, 500, 500, 44, 500, 36, 36, 32, 500, 36, 34, 38, 32, 500, 76, 500, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3754640350775888, "mean_inference_ms": 1.2042838926967818, "mean_action_processing_ms": 0.13980079112668953, "mean_env_wait_ms": 0.08246857203391236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031003236770629883, "StateBufferConnector_ms": 0.008017539978027344, "ViewRequirementAgentConnector_ms": 0.09999346733093262}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.4380000000002193, "episode_len_mean": 284.94, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, 40.90000000000002, 15.299999999999777, 38.50000000000003, 8.49999999999968, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 10.299999999999706, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.5, -50.00000000000044, 47.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 44.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 44.7, 46.5, 46.5, 29.899999999999984, -50.00000000000044, 3.699999999999612, 46.099999999999994, 45.1, 46.3, -50.00000000000044, 43.7, 25.899999999999928, 42.10000000000001, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.9, 23.699999999999896, -50.00000000000044, 43.7, -50.00000000000044, 42.30000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 44.7, 23.699999999999896, 2.0999999999995893, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 2.299999999999592, 45.9, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 46.5, 46.9, -50.00000000000044, 46.5, 46.699999999999996, 46.3, 46.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.1, -50.00000000000044], "episode_lengths": [500, 70, 92, 348, 116, 416, 500, 500, 52, 500, 398, 304, 500, 500, 500, 500, 500, 500, 500, 500, 500, 34, 56, 500, 26, 58, 500, 500, 38, 500, 48, 60, 34, 500, 500, 94, 500, 500, 54, 36, 36, 202, 500, 464, 40, 50, 38, 500, 64, 242, 80, 54, 34, 500, 500, 116, 32, 264, 500, 64, 500, 78, 104, 500, 500, 500, 24, 500, 54, 264, 480, 500, 56, 78, 500, 282, 500, 500, 500, 500, 46, 478, 42, 500, 500, 44, 500, 36, 36, 32, 500, 36, 34, 38, 32, 500, 76, 500, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3754640350775888, "mean_inference_ms": 1.2042838926967818, "mean_action_processing_ms": 0.13980079112668953, "mean_env_wait_ms": 0.08246857203391236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031003236770629883, "StateBufferConnector_ms": 0.008017539978027344, "ViewRequirementAgentConnector_ms": 0.09999346733093262}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5552.1297726933435, "num_env_steps_trained_throughput_per_sec": 5552.1297726933435, "timesteps_total": 1260000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 3207.394, "sample_time_ms": 2832.992, "load_time_ms": 20.526, "load_throughput": 876928.256, "learn_time_ms": 342.297, "learn_throughput": 52585.944, "synch_weights_time_ms": 9.878}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4993, "training_iteration": 70, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-25", "timestamp": 1698248125, "time_this_iter_s": 3.248000383377075, "time_total_s": 225.97371459007263, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 225.97371459007263, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 63.2, "ram_util_percent": 26.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.694065894508601e-22, "cur_lr": 0.0003, "total_loss": 6.169260272273311, "policy_loss": -0.000176433439332026, "vf_loss": 6.169481895588063, "vf_explained_var": -9.139378865559896e-07, "kl": 0.00033562680898866247, "entropy": 0.45260863613199304, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1904.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.9009999999997844, "episode_len_mean": 276.56, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.7, -50.00000000000044, 44.7, 23.699999999999896, 2.0999999999995893, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 2.299999999999592, 45.9, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 46.5, 46.9, -50.00000000000044, 46.5, 46.699999999999996, 46.3, 46.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.1, -50.00000000000044, 45.5, 45.3, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 42.500000000000014, 46.099999999999994, 37.90000000000003, 47.1, 40.500000000000014, 47.3, 43.900000000000006, 6.499999999999652, 47.1, 39.50000000000002, -50.00000000000044, -50.00000000000044, 11.099999999999717, 44.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.3, 47.3, 21.499999999999865, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, 46.9, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 44.7, 3.2999999999996064, -50.00000000000044, 45.9, 40.500000000000014, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.3, 45.3, -50.00000000000044], "episode_lengths": [500, 24, 500, 54, 264, 480, 500, 56, 78, 500, 282, 500, 500, 500, 500, 46, 478, 42, 500, 500, 44, 500, 36, 36, 32, 500, 36, 34, 38, 32, 500, 76, 500, 30, 500, 46, 48, 500, 28, 500, 500, 30, 500, 76, 40, 122, 30, 96, 28, 62, 436, 30, 106, 500, 500, 390, 52, 500, 44, 500, 500, 30, 500, 48, 28, 286, 500, 26, 500, 500, 500, 62, 40, 500, 500, 328, 500, 32, 88, 500, 500, 500, 58, 444, 500, 500, 54, 468, 500, 42, 96, 58, 500, 500, 500, 500, 30, 28, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3750165177287799, "mean_inference_ms": 1.2036775500763206, "mean_action_processing_ms": 0.13990217515612996, "mean_env_wait_ms": 0.08229761093060185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018024444580078125, "StateBufferConnector_ms": 0.005018949508666992, "ViewRequirementAgentConnector_ms": 0.10100603103637695}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.9009999999997844, "episode_len_mean": 276.56, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.7, -50.00000000000044, 44.7, 23.699999999999896, 2.0999999999995893, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 2.299999999999592, 45.9, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 46.5, 46.9, -50.00000000000044, 46.5, 46.699999999999996, 46.3, 46.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.1, -50.00000000000044, 45.5, 45.3, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 42.500000000000014, 46.099999999999994, 37.90000000000003, 47.1, 40.500000000000014, 47.3, 43.900000000000006, 6.499999999999652, 47.1, 39.50000000000002, -50.00000000000044, -50.00000000000044, 11.099999999999717, 44.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.3, 47.3, 21.499999999999865, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, 46.9, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 44.7, 3.2999999999996064, -50.00000000000044, 45.9, 40.500000000000014, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.3, 45.3, -50.00000000000044], "episode_lengths": [500, 24, 500, 54, 264, 480, 500, 56, 78, 500, 282, 500, 500, 500, 500, 46, 478, 42, 500, 500, 44, 500, 36, 36, 32, 500, 36, 34, 38, 32, 500, 76, 500, 30, 500, 46, 48, 500, 28, 500, 500, 30, 500, 76, 40, 122, 30, 96, 28, 62, 436, 30, 106, 500, 500, 390, 52, 500, 44, 500, 500, 30, 500, 48, 28, 286, 500, 26, 500, 500, 500, 62, 40, 500, 500, 328, 500, 32, 88, 500, 500, 500, 58, 444, 500, 500, 54, 468, 500, 42, 96, 58, 500, 500, 500, 500, 30, 28, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3750165177287799, "mean_inference_ms": 1.2036775500763206, "mean_action_processing_ms": 0.13990217515612996, "mean_env_wait_ms": 0.08229761093060185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018024444580078125, "StateBufferConnector_ms": 0.005018949508666992, "ViewRequirementAgentConnector_ms": 0.10100603103637695}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5701.596825305002, "num_env_steps_trained_throughput_per_sec": 5701.596825305002, "timesteps_total": 1278000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1278000, "timers": {"training_iteration_time_ms": 3206.594, "sample_time_ms": 2828.992, "load_time_ms": 21.326, "load_throughput": 844036.62, "learn_time_ms": 344.697, "learn_throughput": 52219.772, "synch_weights_time_ms": 9.878}, "counters": {"num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "done": false, "episodes_total": 5058, "training_iteration": 71, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-28", "timestamp": 1698248128, "time_this_iter_s": 3.162998914718628, "time_total_s": 229.13671350479126, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 229.13671350479126, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 51.760000000000005, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 0.0003, "total_loss": 6.495718673423484, "policy_loss": -0.00017698601759211333, "vf_loss": 6.495940950181749, "vf_explained_var": -9.139378865559896e-07, "kl": 0.0004045528895757242, "entropy": 0.4531590982719704, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1931.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.235999999999811, "episode_len_mean": 248.24, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 44.7, 3.2999999999996064, -50.00000000000044, 45.9, 40.500000000000014, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.3, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 45.1, 45.5, 46.699999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.1, 46.5, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 45.3, 12.69999999999974, 46.3, 44.300000000000004, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, 47.5, 44.300000000000004, -50.00000000000044, 40.90000000000002, -50.00000000000044, 47.5, -50.00000000000044, 47.3, 46.699999999999996, 44.900000000000006, -50.00000000000044, 46.5, 28.29999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.5, 44.10000000000001, 46.9, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 45.7, 33.500000000000036, 46.099999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.90000000000001, 46.699999999999996, 47.3, -50.00000000000044, 45.7, 47.1, 47.3, -50.00000000000044, -50.00000000000044, 46.9, 22.299999999999876, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.1, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.1, -50.00000000000044, 43.7, 44.5, -50.00000000000044, -50.00000000000044, 46.699999999999996], "episode_lengths": [500, 58, 444, 500, 500, 54, 468, 500, 42, 96, 58, 500, 500, 500, 500, 30, 28, 48, 500, 500, 36, 50, 46, 34, 500, 62, 500, 30, 36, 500, 500, 48, 500, 68, 48, 374, 38, 58, 500, 354, 500, 500, 26, 58, 500, 92, 500, 26, 500, 28, 34, 52, 500, 36, 218, 500, 78, 500, 56, 60, 32, 500, 62, 500, 500, 36, 44, 166, 40, 66, 500, 500, 62, 82, 34, 28, 500, 44, 30, 28, 500, 500, 32, 278, 500, 500, 34, 30, 64, 500, 500, 500, 56, 50, 500, 64, 56, 500, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37466764058168567, "mean_inference_ms": 1.2037564616512657, "mean_action_processing_ms": 0.1397014241037265, "mean_env_wait_ms": 0.08237244691471407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027042865753173828, "StateBufferConnector_ms": 0.008002042770385742, "ViewRequirementAgentConnector_ms": 0.11899638175964355}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.235999999999811, "episode_len_mean": 248.24, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 44.7, 3.2999999999996064, -50.00000000000044, 45.9, 40.500000000000014, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.3, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 45.1, 45.5, 46.699999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.1, 46.5, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 45.3, 12.69999999999974, 46.3, 44.300000000000004, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, 47.5, 44.300000000000004, -50.00000000000044, 40.90000000000002, -50.00000000000044, 47.5, -50.00000000000044, 47.3, 46.699999999999996, 44.900000000000006, -50.00000000000044, 46.5, 28.29999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.5, 44.10000000000001, 46.9, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 45.7, 33.500000000000036, 46.099999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.90000000000001, 46.699999999999996, 47.3, -50.00000000000044, 45.7, 47.1, 47.3, -50.00000000000044, -50.00000000000044, 46.9, 22.299999999999876, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.1, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.1, -50.00000000000044, 43.7, 44.5, -50.00000000000044, -50.00000000000044, 46.699999999999996], "episode_lengths": [500, 58, 444, 500, 500, 54, 468, 500, 42, 96, 58, 500, 500, 500, 500, 30, 28, 48, 500, 500, 36, 50, 46, 34, 500, 62, 500, 30, 36, 500, 500, 48, 500, 68, 48, 374, 38, 58, 500, 354, 500, 500, 26, 58, 500, 92, 500, 26, 500, 28, 34, 52, 500, 36, 218, 500, 78, 500, 56, 60, 32, 500, 62, 500, 500, 36, 44, 166, 40, 66, 500, 500, 62, 82, 34, 28, 500, 44, 30, 28, 500, 500, 32, 278, 500, 500, 34, 30, 64, 500, 500, 500, 56, 50, 500, 64, 56, 500, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37466764058168567, "mean_inference_ms": 1.2037564616512657, "mean_action_processing_ms": 0.1397014241037265, "mean_env_wait_ms": 0.08237244691471407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027042865753173828, "StateBufferConnector_ms": 0.008002042770385742, "ViewRequirementAgentConnector_ms": 0.11899638175964355}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5716.151545930058, "num_env_steps_trained_throughput_per_sec": 5716.151545930058, "timesteps_total": 1296000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 3207.391, "sample_time_ms": 2827.789, "load_time_ms": 21.326, "load_throughput": 844020.579, "learn_time_ms": 346.697, "learn_throughput": 51918.513, "synch_weights_time_ms": 9.777}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 5139, "training_iteration": 72, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-31", "timestamp": 1698248131, "time_this_iter_s": 3.155970335006714, "time_total_s": 232.29268383979797, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 232.29268383979797, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 63.224999999999994, "ram_util_percent": 26.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 0.0003, "total_loss": 6.219137280075638, "policy_loss": -0.00010310927474940265, "vf_loss": 6.219282415178087, "vf_explained_var": -1.0287320172345197e-06, "kl": 0.00021859824917406194, "entropy": 0.4220025197223381, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1958.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.388999999999816, "episode_len_mean": 251.7, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 33.500000000000036, 46.099999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.90000000000001, 46.699999999999996, 47.3, -50.00000000000044, 45.7, 47.1, 47.3, -50.00000000000044, -50.00000000000044, 46.9, 22.299999999999876, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.1, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.1, -50.00000000000044, 43.7, 44.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 28.09999999999996, 46.9, 47.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 39.300000000000026, 45.5, -50.00000000000044, 47.3, 36.900000000000034, -50.00000000000044, 39.90000000000002, 45.1, -50.00000000000044, 41.70000000000002, 9.699999999999697, 44.5, 30.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 44.900000000000006, 36.900000000000034, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 46.9, 39.300000000000026, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.10000000000001, 45.3, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.30000000000001, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 40.10000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 18.29999999999982, 45.3, -50.00000000000044, 42.500000000000014], "episode_lengths": [44, 166, 40, 66, 500, 500, 62, 82, 34, 28, 500, 44, 30, 28, 500, 500, 32, 278, 500, 500, 34, 30, 64, 500, 500, 500, 56, 50, 500, 64, 56, 500, 500, 34, 500, 220, 32, 24, 500, 40, 500, 34, 500, 500, 108, 46, 500, 28, 132, 500, 102, 50, 500, 84, 404, 56, 192, 58, 500, 500, 50, 500, 38, 56, 500, 52, 132, 500, 500, 190, 500, 32, 108, 500, 500, 74, 80, 48, 500, 38, 500, 500, 500, 28, 68, 500, 36, 72, 500, 500, 500, 32, 100, 62, 500, 500, 318, 48, 500, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37448248897273345, "mean_inference_ms": 1.2039167873899437, "mean_action_processing_ms": 0.13986201764539685, "mean_env_wait_ms": 0.08230036093198256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022006511688232422, "StateBufferConnector_ms": 0.006005048751831055, "ViewRequirementAgentConnector_ms": 0.11997699737548828}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.388999999999816, "episode_len_mean": 251.7, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 33.500000000000036, 46.099999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.90000000000001, 46.699999999999996, 47.3, -50.00000000000044, 45.7, 47.1, 47.3, -50.00000000000044, -50.00000000000044, 46.9, 22.299999999999876, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.1, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.1, -50.00000000000044, 43.7, 44.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 28.09999999999996, 46.9, 47.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 39.300000000000026, 45.5, -50.00000000000044, 47.3, 36.900000000000034, -50.00000000000044, 39.90000000000002, 45.1, -50.00000000000044, 41.70000000000002, 9.699999999999697, 44.5, 30.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 44.900000000000006, 36.900000000000034, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 46.9, 39.300000000000026, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.10000000000001, 45.3, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.30000000000001, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 40.10000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 18.29999999999982, 45.3, -50.00000000000044, 42.500000000000014], "episode_lengths": [44, 166, 40, 66, 500, 500, 62, 82, 34, 28, 500, 44, 30, 28, 500, 500, 32, 278, 500, 500, 34, 30, 64, 500, 500, 500, 56, 50, 500, 64, 56, 500, 500, 34, 500, 220, 32, 24, 500, 40, 500, 34, 500, 500, 108, 46, 500, 28, 132, 500, 102, 50, 500, 84, 404, 56, 192, 58, 500, 500, 50, 500, 38, 56, 500, 52, 132, 500, 500, 190, 500, 32, 108, 500, 500, 74, 80, 48, 500, 38, 500, 500, 500, 28, 68, 500, 36, 72, 500, 500, 500, 32, 100, 62, 500, 500, 318, 48, 500, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37448248897273345, "mean_inference_ms": 1.2039167873899437, "mean_action_processing_ms": 0.13986201764539685, "mean_env_wait_ms": 0.08230036093198256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022006511688232422, "StateBufferConnector_ms": 0.006005048751831055, "ViewRequirementAgentConnector_ms": 0.11997699737548828}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5513.008214146137, "num_env_steps_trained_throughput_per_sec": 5513.008214146137, "timesteps_total": 1314000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1314000, "timers": {"training_iteration_time_ms": 3213.492, "sample_time_ms": 2827.389, "load_time_ms": 21.627, "load_throughput": 832305.011, "learn_time_ms": 352.895, "learn_throughput": 51006.736, "synch_weights_time_ms": 9.78}, "counters": {"num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "done": false, "episodes_total": 5205, "training_iteration": 73, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-34", "timestamp": 1698248134, "time_this_iter_s": 3.2719991207122803, "time_total_s": 235.56468296051025, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 235.56468296051025, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 53.21999999999999, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357513e-23, "cur_lr": 0.0003, "total_loss": 6.571256831840232, "policy_loss": 5.082206593619453e-05, "vf_loss": 6.571248460699011, "vf_explained_var": -9.889955873842592e-07, "kl": 7.890686916890968e-05, "entropy": 0.42435381920249376, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1985.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4359999999997983, "episode_len_mean": 266.2, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, 39.300000000000026, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.10000000000001, 45.3, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.30000000000001, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 40.10000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 18.29999999999982, 45.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, 36.50000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.7, 30.9, 46.3, 47.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 26.89999999999994, 38.700000000000024, 46.099999999999994, 40.500000000000014, 47.5, 47.1, 46.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, 47.1, -50.00000000000044, 43.50000000000001, 45.9, -50.00000000000044, 46.5, -50.00000000000044, 45.1, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 31.300000000000004, -50.00000000000044, -50.00000000000044, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, 46.9, -50.00000000000044, 45.5, 44.900000000000006, -50.00000000000044, 47.3, 46.3, 43.900000000000006, 46.099999999999994, 42.500000000000014, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [32, 108, 500, 500, 74, 80, 48, 500, 38, 500, 500, 500, 28, 68, 500, 36, 72, 500, 500, 500, 32, 100, 62, 500, 500, 318, 48, 500, 76, 500, 136, 68, 500, 500, 402, 500, 46, 500, 500, 54, 192, 38, 28, 500, 40, 500, 500, 232, 114, 40, 96, 26, 30, 38, 500, 500, 44, 500, 74, 30, 500, 66, 42, 500, 36, 500, 50, 500, 44, 52, 500, 48, 500, 500, 500, 44, 188, 500, 500, 500, 500, 500, 76, 500, 500, 36, 32, 500, 46, 52, 500, 28, 38, 62, 40, 76, 116, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37512551444851233, "mean_inference_ms": 1.203415648849084, "mean_action_processing_ms": 0.13957873290097683, "mean_env_wait_ms": 0.0823267600168702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013006448745727539, "StateBufferConnector_ms": 0.004004001617431641, "ViewRequirementAgentConnector_ms": 0.12694501876831055}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4359999999997983, "episode_len_mean": 266.2, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, 39.300000000000026, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.10000000000001, 45.3, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.30000000000001, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 40.10000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 18.29999999999982, 45.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, 36.50000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.7, 30.9, 46.3, 47.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 26.89999999999994, 38.700000000000024, 46.099999999999994, 40.500000000000014, 47.5, 47.1, 46.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, 47.1, -50.00000000000044, 43.50000000000001, 45.9, -50.00000000000044, 46.5, -50.00000000000044, 45.1, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 31.300000000000004, -50.00000000000044, -50.00000000000044, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, 46.9, -50.00000000000044, 45.5, 44.900000000000006, -50.00000000000044, 47.3, 46.3, 43.900000000000006, 46.099999999999994, 42.500000000000014, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [32, 108, 500, 500, 74, 80, 48, 500, 38, 500, 500, 500, 28, 68, 500, 36, 72, 500, 500, 500, 32, 100, 62, 500, 500, 318, 48, 500, 76, 500, 136, 68, 500, 500, 402, 500, 46, 500, 500, 54, 192, 38, 28, 500, 40, 500, 500, 232, 114, 40, 96, 26, 30, 38, 500, 500, 44, 500, 74, 30, 500, 66, 42, 500, 36, 500, 50, 500, 44, 52, 500, 48, 500, 500, 500, 44, 188, 500, 500, 500, 500, 500, 76, 500, 500, 36, 32, 500, 46, 52, 500, 28, 38, 62, 40, 76, 116, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37512551444851233, "mean_inference_ms": 1.203415648849084, "mean_action_processing_ms": 0.13957873290097683, "mean_env_wait_ms": 0.0823267600168702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013006448745727539, "StateBufferConnector_ms": 0.004004001617431641, "ViewRequirementAgentConnector_ms": 0.12694501876831055}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5449.591324710805, "num_env_steps_trained_throughput_per_sec": 5449.591324710805, "timesteps_total": 1332000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 3222.894, "sample_time_ms": 2830.992, "load_time_ms": 21.624, "load_throughput": 832425.228, "learn_time_ms": 358.594, "learn_throughput": 50195.998, "synch_weights_time_ms": 9.883}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5276, "training_iteration": 74, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-38", "timestamp": 1698248138, "time_this_iter_s": 3.3079988956451416, "time_total_s": 238.8726818561554, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 238.8726818561554, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 67.95, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678756e-23, "cur_lr": 0.0003, "total_loss": 6.466792989660193, "policy_loss": -0.00017688143998384476, "vf_loss": 6.467009879924633, "vf_explained_var": -9.360136809172454e-07, "kl": 0.00028042875414960826, "entropy": 0.4005021430827953, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2012.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4659999999998026, "episode_len_mean": 265.92, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 31.300000000000004, -50.00000000000044, -50.00000000000044, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, 46.9, -50.00000000000044, 45.5, 44.900000000000006, -50.00000000000044, 47.3, 46.3, 43.900000000000006, 46.099999999999994, 42.500000000000014, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 41.70000000000002, 47.1, -50.00000000000044, 42.900000000000006, 47.3, -50.00000000000044, 8.899999999999686, -50.00000000000044, 11.699999999999726, -50.00000000000044, -50.00000000000044, 4.499999999999623, 45.3, 39.300000000000026, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 42.30000000000001, 45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 29.49999999999998, 45.1, 47.3, 34.50000000000004, 36.70000000000003, 42.30000000000001, 47.7, 45.5, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 43.50000000000001, 26.09999999999993, 45.9, 41.90000000000001, -50.00000000000044, 44.900000000000006, 46.9, 33.500000000000036, -50.00000000000044, 47.1, -50.00000000000044], "episode_lengths": [52, 500, 48, 500, 500, 500, 44, 188, 500, 500, 500, 500, 500, 76, 500, 500, 36, 32, 500, 46, 52, 500, 28, 38, 62, 40, 76, 116, 500, 500, 500, 500, 28, 500, 84, 30, 500, 72, 28, 500, 412, 500, 384, 500, 500, 456, 48, 108, 30, 500, 500, 500, 224, 52, 500, 50, 500, 40, 66, 500, 40, 500, 28, 500, 500, 500, 30, 500, 78, 48, 58, 500, 500, 42, 36, 206, 50, 28, 156, 134, 78, 24, 46, 500, 228, 500, 500, 26, 500, 66, 240, 42, 82, 500, 52, 32, 166, 500, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3747764764270438, "mean_inference_ms": 1.2036223302151483, "mean_action_processing_ms": 0.13982523432464267, "mean_env_wait_ms": 0.08222853472569253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019002199172973633, "StateBufferConnector_ms": 0.002003192901611328, "ViewRequirementAgentConnector_ms": 0.11899352073669434}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4659999999998026, "episode_len_mean": 265.92, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 31.300000000000004, -50.00000000000044, -50.00000000000044, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, 46.9, -50.00000000000044, 45.5, 44.900000000000006, -50.00000000000044, 47.3, 46.3, 43.900000000000006, 46.099999999999994, 42.500000000000014, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 41.70000000000002, 47.1, -50.00000000000044, 42.900000000000006, 47.3, -50.00000000000044, 8.899999999999686, -50.00000000000044, 11.699999999999726, -50.00000000000044, -50.00000000000044, 4.499999999999623, 45.3, 39.300000000000026, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 42.30000000000001, 45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 29.49999999999998, 45.1, 47.3, 34.50000000000004, 36.70000000000003, 42.30000000000001, 47.7, 45.5, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 43.50000000000001, 26.09999999999993, 45.9, 41.90000000000001, -50.00000000000044, 44.900000000000006, 46.9, 33.500000000000036, -50.00000000000044, 47.1, -50.00000000000044], "episode_lengths": [52, 500, 48, 500, 500, 500, 44, 188, 500, 500, 500, 500, 500, 76, 500, 500, 36, 32, 500, 46, 52, 500, 28, 38, 62, 40, 76, 116, 500, 500, 500, 500, 28, 500, 84, 30, 500, 72, 28, 500, 412, 500, 384, 500, 500, 456, 48, 108, 30, 500, 500, 500, 224, 52, 500, 50, 500, 40, 66, 500, 40, 500, 28, 500, 500, 500, 30, 500, 78, 48, 58, 500, 500, 42, 36, 206, 50, 28, 156, 134, 78, 24, 46, 500, 228, 500, 500, 26, 500, 66, 240, 42, 82, 500, 52, 32, 166, 500, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3747764764270438, "mean_inference_ms": 1.2036223302151483, "mean_action_processing_ms": 0.13982523432464267, "mean_env_wait_ms": 0.08222853472569253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019002199172973633, "StateBufferConnector_ms": 0.002003192901611328, "ViewRequirementAgentConnector_ms": 0.11899352073669434}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5582.009564114003, "num_env_steps_trained_throughput_per_sec": 5582.009564114003, "timesteps_total": 1350000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1350000, "timers": {"training_iteration_time_ms": 3233.161, "sample_time_ms": 2831.195, "load_time_ms": 22.621, "load_throughput": 795722.055, "learn_time_ms": 367.758, "learn_throughput": 48945.165, "synch_weights_time_ms": 9.886}, "counters": {"num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "done": false, "episodes_total": 5345, "training_iteration": 75, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-41", "timestamp": 1698248141, "time_this_iter_s": 3.2306418418884277, "time_total_s": 242.10332369804382, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 242.10332369804382, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 54.239999999999995, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339378e-24, "cur_lr": 0.0003, "total_loss": 6.3495922618442115, "policy_loss": -0.0002535548819987862, "vf_loss": 6.349889967176649, "vf_explained_var": -9.757501107675058e-07, "kl": 0.0004464798986034608, "entropy": 0.4411458571751912, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2039.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.321999999999838, "episode_len_mean": 237.42, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 29.49999999999998, 45.1, 47.3, 34.50000000000004, 36.70000000000003, 42.30000000000001, 47.7, 45.5, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 43.50000000000001, 26.09999999999993, 45.9, 41.90000000000001, -50.00000000000044, 44.900000000000006, 46.9, 33.500000000000036, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 38.700000000000024, -50.00000000000044, 40.90000000000002, 27.899999999999956, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, 26.499999999999936, -50.00000000000044, 41.90000000000001, -50.00000000000044, 31.900000000000013, 47.3, 44.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.7, 46.5, -50.00000000000044, 45.3, 46.099999999999994, 46.5, 45.1, 43.900000000000006, 46.699999999999996, 44.5, -50.00000000000044, 32.100000000000016, 43.10000000000001, 45.5, 42.10000000000001, 11.29999999999972, 45.5, -50.00000000000044, 45.7, 46.099999999999994, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, 47.9, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, 40.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.10000000000002, 36.900000000000034], "episode_lengths": [48, 58, 500, 500, 42, 36, 206, 50, 28, 156, 134, 78, 24, 46, 500, 228, 500, 500, 26, 500, 66, 240, 42, 82, 500, 52, 32, 166, 500, 30, 500, 500, 500, 36, 114, 500, 92, 222, 500, 86, 500, 500, 34, 236, 500, 82, 500, 182, 28, 60, 500, 54, 500, 500, 54, 36, 500, 48, 40, 36, 50, 62, 34, 56, 500, 180, 70, 46, 80, 388, 46, 500, 44, 40, 74, 104, 500, 500, 76, 46, 22, 500, 500, 88, 500, 84, 100, 40, 500, 500, 500, 408, 500, 500, 500, 500, 500, 52, 110, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3747903188312928, "mean_inference_ms": 1.2023537261469106, "mean_action_processing_ms": 0.13988426258141928, "mean_env_wait_ms": 0.08226061848530168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025002241134643555, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.12603521347045898}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.321999999999838, "episode_len_mean": 237.42, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 29.49999999999998, 45.1, 47.3, 34.50000000000004, 36.70000000000003, 42.30000000000001, 47.7, 45.5, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 43.50000000000001, 26.09999999999993, 45.9, 41.90000000000001, -50.00000000000044, 44.900000000000006, 46.9, 33.500000000000036, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 38.700000000000024, -50.00000000000044, 40.90000000000002, 27.899999999999956, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, 26.499999999999936, -50.00000000000044, 41.90000000000001, -50.00000000000044, 31.900000000000013, 47.3, 44.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.7, 46.5, -50.00000000000044, 45.3, 46.099999999999994, 46.5, 45.1, 43.900000000000006, 46.699999999999996, 44.5, -50.00000000000044, 32.100000000000016, 43.10000000000001, 45.5, 42.10000000000001, 11.29999999999972, 45.5, -50.00000000000044, 45.7, 46.099999999999994, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, 47.9, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, 40.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.10000000000002, 36.900000000000034], "episode_lengths": [48, 58, 500, 500, 42, 36, 206, 50, 28, 156, 134, 78, 24, 46, 500, 228, 500, 500, 26, 500, 66, 240, 42, 82, 500, 52, 32, 166, 500, 30, 500, 500, 500, 36, 114, 500, 92, 222, 500, 86, 500, 500, 34, 236, 500, 82, 500, 182, 28, 60, 500, 54, 500, 500, 54, 36, 500, 48, 40, 36, 50, 62, 34, 56, 500, 180, 70, 46, 80, 388, 46, 500, 44, 40, 74, 104, 500, 500, 76, 46, 22, 500, 500, 88, 500, 84, 100, 40, 500, 500, 500, 408, 500, 500, 500, 500, 500, 52, 110, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3747903188312928, "mean_inference_ms": 1.2023537261469106, "mean_action_processing_ms": 0.13988426258141928, "mean_env_wait_ms": 0.08226061848530168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025002241134643555, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.12603521347045898}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5758.213298531713, "num_env_steps_trained_throughput_per_sec": 5758.213298531713, "timesteps_total": 1368000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 3221.758, "sample_time_ms": 2828.291, "load_time_ms": 22.818, "load_throughput": 788848.671, "learn_time_ms": 358.959, "learn_throughput": 50145.035, "synch_weights_time_ms": 9.888}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5414, "training_iteration": 76, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-44", "timestamp": 1698248144, "time_this_iter_s": 3.1309690475463867, "time_total_s": 245.2342927455902, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 245.2342927455902, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 62.474999999999994, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.646977960169689e-24, "cur_lr": 0.0003, "total_loss": 6.3976018693712025, "policy_loss": -6.448656872466759e-05, "vf_loss": 6.39771083549217, "vf_explained_var": -1.037562334979022e-06, "kl": 0.00016511432076869056, "entropy": 0.4436133194852758, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2066.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.15500000000020273, "episode_len_mean": 277.1, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.29999999999972, 45.5, -50.00000000000044, 45.7, 46.099999999999994, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, 47.9, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, 40.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.10000000000002, 36.900000000000034, -50.00000000000044, -50.00000000000044, 35.500000000000036, 47.7, 33.70000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 47.3, -50.00000000000044, -50.00000000000044, 43.7, 45.1, 43.50000000000001, 43.50000000000001, 26.89999999999994, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.10000000000001, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 39.90000000000002, 40.70000000000002, 14.299999999999763, -50.00000000000044, 27.299999999999947, -50.00000000000044, 46.5, 40.30000000000002, 43.30000000000001, 47.1, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.7, 41.30000000000001, 37.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.699999999999996, -50.00000000000044, 38.300000000000026, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.3], "episode_lengths": [388, 46, 500, 44, 40, 74, 104, 500, 500, 76, 46, 22, 500, 500, 88, 500, 84, 100, 40, 500, 500, 500, 408, 500, 500, 500, 500, 500, 52, 110, 132, 500, 500, 146, 24, 164, 114, 500, 500, 42, 36, 500, 106, 500, 500, 500, 86, 28, 500, 500, 64, 50, 66, 66, 232, 500, 500, 116, 60, 66, 40, 500, 500, 98, 500, 102, 94, 358, 500, 228, 500, 36, 98, 68, 30, 500, 90, 500, 500, 500, 500, 500, 32, 44, 88, 126, 500, 40, 500, 500, 500, 98, 34, 500, 118, 500, 30, 500, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37459417388068017, "mean_inference_ms": 1.203261513169647, "mean_action_processing_ms": 0.13980126172428325, "mean_env_wait_ms": 0.08230009286273451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02098226547241211, "StateBufferConnector_ms": 0.005995750427246094, "ViewRequirementAgentConnector_ms": 0.1310262680053711}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.15500000000020273, "episode_len_mean": 277.1, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.29999999999972, 45.5, -50.00000000000044, 45.7, 46.099999999999994, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, 47.9, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, 40.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.10000000000002, 36.900000000000034, -50.00000000000044, -50.00000000000044, 35.500000000000036, 47.7, 33.70000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 47.3, -50.00000000000044, -50.00000000000044, 43.7, 45.1, 43.50000000000001, 43.50000000000001, 26.89999999999994, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.10000000000001, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 39.90000000000002, 40.70000000000002, 14.299999999999763, -50.00000000000044, 27.299999999999947, -50.00000000000044, 46.5, 40.30000000000002, 43.30000000000001, 47.1, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.7, 41.30000000000001, 37.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.699999999999996, -50.00000000000044, 38.300000000000026, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.3], "episode_lengths": [388, 46, 500, 44, 40, 74, 104, 500, 500, 76, 46, 22, 500, 500, 88, 500, 84, 100, 40, 500, 500, 500, 408, 500, 500, 500, 500, 500, 52, 110, 132, 500, 500, 146, 24, 164, 114, 500, 500, 42, 36, 500, 106, 500, 500, 500, 86, 28, 500, 500, 64, 50, 66, 66, 232, 500, 500, 116, 60, 66, 40, 500, 500, 98, 500, 102, 94, 358, 500, 228, 500, 36, 98, 68, 30, 500, 90, 500, 500, 500, 500, 500, 32, 44, 88, 126, 500, 40, 500, 500, 500, 98, 34, 500, 118, 500, 30, 500, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37459417388068017, "mean_inference_ms": 1.203261513169647, "mean_action_processing_ms": 0.13980126172428325, "mean_env_wait_ms": 0.08230009286273451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02098226547241211, "StateBufferConnector_ms": 0.005995750427246094, "ViewRequirementAgentConnector_ms": 0.1310262680053711}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5758.150057228776, "num_env_steps_trained_throughput_per_sec": 5758.150057228776, "timesteps_total": 1386000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1386000, "timers": {"training_iteration_time_ms": 3214.958, "sample_time_ms": 2826.891, "load_time_ms": 21.715, "load_throughput": 828922.935, "learn_time_ms": 354.759, "learn_throughput": 50738.718, "synch_weights_time_ms": 9.791}, "counters": {"num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "done": false, "episodes_total": 5483, "training_iteration": 77, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-47", "timestamp": 1698248147, "time_this_iter_s": 3.132997989654541, "time_total_s": 248.36729073524475, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 248.36729073524475, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 57.080000000000005, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848445e-24, "cur_lr": 0.0003, "total_loss": 7.0240006623444735, "policy_loss": -0.0006706595972732261, "vf_loss": 7.0247179490548595, "vf_explained_var": -9.845804285120081e-07, "kl": 0.0010336477937955722, "entropy": 0.4646835812815913, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2093.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.589999999999812, "episode_len_mean": 264.72, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.299999999999947, -50.00000000000044, 46.5, 40.30000000000002, 43.30000000000001, 47.1, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.7, 41.30000000000001, 37.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.699999999999996, -50.00000000000044, 38.300000000000026, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 43.50000000000001, 32.50000000000002, 45.1, 11.699999999999726, 22.099999999999874, 46.099999999999994, 24.299999999999905, -50.00000000000044, 9.499999999999694, 46.699999999999996, 4.099999999999618, -50.00000000000044, 44.5, -50.00000000000044, 45.9, -50.00000000000044, 46.3, 42.900000000000006, 40.500000000000014, 44.300000000000004, 39.50000000000002, 45.3, 45.1, 14.499999999999766, 26.09999999999993, 45.7, 36.10000000000004, 35.500000000000036, 45.1, -50.00000000000044, 46.699999999999996, 42.70000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 37.50000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 0.09999999999956088, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, 46.699999999999996, 6.099999999999646, 41.100000000000016, -50.00000000000044, 44.5, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.30000000000004, 23.29999999999989, 44.7, 46.9], "episode_lengths": [500, 228, 500, 36, 98, 68, 30, 500, 90, 500, 500, 500, 500, 500, 32, 44, 88, 126, 500, 40, 500, 500, 500, 98, 34, 500, 118, 500, 30, 500, 500, 38, 500, 500, 168, 500, 66, 176, 50, 384, 280, 40, 258, 500, 406, 34, 460, 500, 56, 500, 42, 500, 38, 72, 96, 58, 106, 48, 50, 356, 240, 44, 140, 146, 50, 500, 34, 74, 500, 500, 234, 126, 72, 500, 500, 500, 500, 34, 500, 500, 36, 34, 440, 90, 500, 56, 34, 500, 40, 500, 500, 52, 500, 500, 500, 52, 148, 268, 54, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37480210243708384, "mean_inference_ms": 1.2038435138601975, "mean_action_processing_ms": 0.13962855267178167, "mean_env_wait_ms": 0.0824807207317874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02899336814880371, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.12198042869567871}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.589999999999812, "episode_len_mean": 264.72, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.299999999999947, -50.00000000000044, 46.5, 40.30000000000002, 43.30000000000001, 47.1, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.7, 41.30000000000001, 37.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.699999999999996, -50.00000000000044, 38.300000000000026, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 43.50000000000001, 32.50000000000002, 45.1, 11.699999999999726, 22.099999999999874, 46.099999999999994, 24.299999999999905, -50.00000000000044, 9.499999999999694, 46.699999999999996, 4.099999999999618, -50.00000000000044, 44.5, -50.00000000000044, 45.9, -50.00000000000044, 46.3, 42.900000000000006, 40.500000000000014, 44.300000000000004, 39.50000000000002, 45.3, 45.1, 14.499999999999766, 26.09999999999993, 45.7, 36.10000000000004, 35.500000000000036, 45.1, -50.00000000000044, 46.699999999999996, 42.70000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 37.50000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 0.09999999999956088, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, 46.699999999999996, 6.099999999999646, 41.100000000000016, -50.00000000000044, 44.5, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.30000000000004, 23.29999999999989, 44.7, 46.9], "episode_lengths": [500, 228, 500, 36, 98, 68, 30, 500, 90, 500, 500, 500, 500, 500, 32, 44, 88, 126, 500, 40, 500, 500, 500, 98, 34, 500, 118, 500, 30, 500, 500, 38, 500, 500, 168, 500, 66, 176, 50, 384, 280, 40, 258, 500, 406, 34, 460, 500, 56, 500, 42, 500, 38, 72, 96, 58, 106, 48, 50, 356, 240, 44, 140, 146, 50, 500, 34, 74, 500, 500, 234, 126, 72, 500, 500, 500, 500, 34, 500, 500, 36, 34, 440, 90, 500, 56, 34, 500, 40, 500, 500, 52, 500, 500, 500, 52, 148, 268, 54, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37480210243708384, "mean_inference_ms": 1.2038435138601975, "mean_action_processing_ms": 0.13962855267178167, "mean_env_wait_ms": 0.0824807207317874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02899336814880371, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.12198042869567871}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5272.3907426288815, "num_env_steps_trained_throughput_per_sec": 5272.3907426288815, "timesteps_total": 1404000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 3225.962, "sample_time_ms": 2831.894, "load_time_ms": 21.912, "load_throughput": 821473.85, "learn_time_ms": 360.462, "learn_throughput": 49935.949, "synch_weights_time_ms": 9.791}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5551, "training_iteration": 78, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-51", "timestamp": 1698248151, "time_this_iter_s": 3.418999671936035, "time_total_s": 251.7862904071808, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 251.7862904071808, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 70.05, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424223e-25, "cur_lr": 0.0003, "total_loss": 6.690941757626003, "policy_loss": 7.589768480371547e-05, "vf_loss": 6.690910904495804, "vf_explained_var": -9.448439986617476e-07, "kl": 0.00022325972412528682, "entropy": 0.4507478287926427, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2120.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.12999999999979203, "episode_len_mean": 279.26, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.69999999999994, 37.50000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 0.09999999999956088, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, 46.699999999999996, 6.099999999999646, 41.100000000000016, -50.00000000000044, 44.5, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.30000000000004, 23.29999999999989, 44.7, 46.9, 35.70000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 44.300000000000004, -50.00000000000044, 22.099999999999874, 35.500000000000036, 44.7, 46.699999999999996, 44.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 43.30000000000001, 43.900000000000006, -50.00000000000044, 14.09999999999976, -50.00000000000044, 45.1, 32.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 35.70000000000003, 46.5, 44.10000000000001, 23.499999999999893, 37.50000000000003, -50.00000000000044, 46.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 42.900000000000006, -50.00000000000044, 40.30000000000002, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 44.900000000000006, 45.1, 46.3, -50.00000000000044], "episode_lengths": [234, 126, 72, 500, 500, 500, 500, 34, 500, 500, 36, 34, 440, 90, 500, 56, 34, 500, 40, 500, 500, 52, 500, 500, 500, 52, 148, 268, 54, 32, 144, 74, 500, 500, 284, 500, 58, 500, 280, 146, 54, 34, 56, 60, 500, 500, 500, 500, 80, 500, 500, 222, 500, 68, 62, 500, 360, 500, 50, 178, 500, 500, 42, 500, 500, 144, 36, 60, 266, 126, 500, 38, 52, 500, 500, 46, 72, 500, 98, 28, 500, 500, 42, 500, 52, 500, 32, 500, 42, 500, 500, 500, 500, 500, 48, 50, 52, 50, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37502417063358295, "mean_inference_ms": 1.204865559244704, "mean_action_processing_ms": 0.14034371303240106, "mean_env_wait_ms": 0.08252902704688855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027008533477783203, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.1389932632446289}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.12999999999979203, "episode_len_mean": 279.26, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.69999999999994, 37.50000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 0.09999999999956088, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, 46.699999999999996, 6.099999999999646, 41.100000000000016, -50.00000000000044, 44.5, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.30000000000004, 23.29999999999989, 44.7, 46.9, 35.70000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 44.300000000000004, -50.00000000000044, 22.099999999999874, 35.500000000000036, 44.7, 46.699999999999996, 44.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 43.30000000000001, 43.900000000000006, -50.00000000000044, 14.09999999999976, -50.00000000000044, 45.1, 32.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 35.70000000000003, 46.5, 44.10000000000001, 23.499999999999893, 37.50000000000003, -50.00000000000044, 46.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 42.900000000000006, -50.00000000000044, 40.30000000000002, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 44.900000000000006, 45.1, 46.3, -50.00000000000044], "episode_lengths": [234, 126, 72, 500, 500, 500, 500, 34, 500, 500, 36, 34, 440, 90, 500, 56, 34, 500, 40, 500, 500, 52, 500, 500, 500, 52, 148, 268, 54, 32, 144, 74, 500, 500, 284, 500, 58, 500, 280, 146, 54, 34, 56, 60, 500, 500, 500, 500, 80, 500, 500, 222, 500, 68, 62, 500, 360, 500, 50, 178, 500, 500, 42, 500, 500, 144, 36, 60, 266, 126, 500, 38, 52, 500, 500, 46, 72, 500, 98, 28, 500, 500, 42, 500, 52, 500, 32, 500, 42, 500, 500, 500, 500, 500, 48, 50, 52, 50, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37502417063358295, "mean_inference_ms": 1.204865559244704, "mean_action_processing_ms": 0.14034371303240106, "mean_env_wait_ms": 0.08252902704688855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027008533477783203, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.1389932632446289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5303.463228277692, "num_env_steps_trained_throughput_per_sec": 5303.463228277692, "timesteps_total": 1422000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1422000, "timers": {"training_iteration_time_ms": 3240.062, "sample_time_ms": 2847.094, "load_time_ms": 21.208, "load_throughput": 848717.236, "learn_time_ms": 360.362, "learn_throughput": 49949.772, "synch_weights_time_ms": 9.494}, "counters": {"num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "done": false, "episodes_total": 5621, "training_iteration": 79, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-54", "timestamp": 1698248154, "time_this_iter_s": 3.3999998569488525, "time_total_s": 255.18629026412964, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 255.18629026412964, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 64.52000000000001, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 0.0003, "total_loss": 5.936236028318052, "policy_loss": -0.00020020993219481574, "vf_loss": 5.936480186603688, "vf_explained_var": -8.874469333224827e-07, "kl": 0.00037565892163378054, "entropy": 0.4405401349067688, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2147.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8589999999998077, "episode_len_mean": 256.98, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, -50.00000000000044, 35.70000000000003, 46.5, 44.10000000000001, 23.499999999999893, 37.50000000000003, -50.00000000000044, 46.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 42.900000000000006, -50.00000000000044, 40.30000000000002, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 44.900000000000006, 45.1, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 26.89999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 46.9, -50.00000000000044, 45.5, 44.10000000000001, 13.899999999999757, 46.9, 46.699999999999996, -50.00000000000044, 40.500000000000014, -50.00000000000044, 24.69999999999991, 41.100000000000016, 46.099999999999994, 45.3, -50.00000000000044, 43.900000000000006, 46.699999999999996, -50.00000000000044, 35.70000000000003, 40.70000000000002, 46.099999999999994, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 40.90000000000002, 43.900000000000006, 46.9, -50.00000000000044, 46.099999999999994, 47.5, -50.00000000000044, 46.099999999999994, 36.10000000000004, -50.00000000000044, 42.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 35.900000000000034, 45.9, 45.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [42, 500, 500, 144, 36, 60, 266, 126, 500, 38, 52, 500, 500, 46, 72, 500, 98, 28, 500, 500, 42, 500, 52, 500, 32, 500, 42, 500, 500, 500, 500, 500, 48, 50, 52, 50, 38, 500, 500, 62, 500, 232, 66, 500, 500, 500, 500, 46, 500, 500, 46, 32, 500, 46, 60, 362, 32, 34, 500, 96, 500, 254, 90, 40, 48, 500, 62, 34, 500, 144, 94, 40, 500, 34, 40, 500, 92, 62, 32, 500, 40, 26, 500, 40, 140, 500, 72, 36, 500, 500, 500, 500, 500, 500, 22, 142, 42, 44, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37572840687502806, "mean_inference_ms": 1.2060854918602666, "mean_action_processing_ms": 0.1403160220248824, "mean_env_wait_ms": 0.0825724301196818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029999732971191406, "StateBufferConnector_ms": 0.007003307342529297, "ViewRequirementAgentConnector_ms": 0.12998366355895996}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8589999999998077, "episode_len_mean": 256.98, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, -50.00000000000044, 35.70000000000003, 46.5, 44.10000000000001, 23.499999999999893, 37.50000000000003, -50.00000000000044, 46.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 42.900000000000006, -50.00000000000044, 40.30000000000002, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 44.900000000000006, 45.1, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 26.89999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 46.9, -50.00000000000044, 45.5, 44.10000000000001, 13.899999999999757, 46.9, 46.699999999999996, -50.00000000000044, 40.500000000000014, -50.00000000000044, 24.69999999999991, 41.100000000000016, 46.099999999999994, 45.3, -50.00000000000044, 43.900000000000006, 46.699999999999996, -50.00000000000044, 35.70000000000003, 40.70000000000002, 46.099999999999994, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 40.90000000000002, 43.900000000000006, 46.9, -50.00000000000044, 46.099999999999994, 47.5, -50.00000000000044, 46.099999999999994, 36.10000000000004, -50.00000000000044, 42.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 35.900000000000034, 45.9, 45.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [42, 500, 500, 144, 36, 60, 266, 126, 500, 38, 52, 500, 500, 46, 72, 500, 98, 28, 500, 500, 42, 500, 52, 500, 32, 500, 42, 500, 500, 500, 500, 500, 48, 50, 52, 50, 38, 500, 500, 62, 500, 232, 66, 500, 500, 500, 500, 46, 500, 500, 46, 32, 500, 46, 60, 362, 32, 34, 500, 96, 500, 254, 90, 40, 48, 500, 62, 34, 500, 144, 94, 40, 500, 34, 40, 500, 92, 62, 32, 500, 40, 26, 500, 40, 140, 500, 72, 36, 500, 500, 500, 500, 500, 500, 22, 142, 42, 44, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37572840687502806, "mean_inference_ms": 1.2060854918602666, "mean_action_processing_ms": 0.1403160220248824, "mean_env_wait_ms": 0.0825724301196818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029999732971191406, "StateBufferConnector_ms": 0.007003307342529297, "ViewRequirementAgentConnector_ms": 0.12998366355895996}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5361.913359515971, "num_env_steps_trained_throughput_per_sec": 5361.913359515971, "timesteps_total": 1440000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 3251.463, "sample_time_ms": 2872.394, "load_time_ms": 19.805, "load_throughput": 908849.262, "learn_time_ms": 347.565, "learn_throughput": 51788.82, "synch_weights_time_ms": 9.794}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5683, "training_iteration": 80, "trial_id": "9f288_00012", "date": "2023-10-25_16-35-57", "timestamp": 1698248157, "time_this_iter_s": 3.3640024662017822, "time_total_s": 258.5502927303314, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 258.5502927303314, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 66.72, "ram_util_percent": 26.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060557e-25, "cur_lr": 0.0003, "total_loss": 6.9364611131173595, "policy_loss": -9.565248533531471e-05, "vf_loss": 6.936604217246726, "vf_explained_var": -9.5367431640625e-07, "kl": 0.00022862992436448285, "entropy": 0.47432871549217787, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2174.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.492999999999827, "episode_len_mean": 250.7, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 36.10000000000004, -50.00000000000044, 42.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 35.900000000000034, 45.9, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 36.900000000000034, 41.500000000000014, 43.50000000000001, 47.3, -50.00000000000044, -50.00000000000044, 39.90000000000002, 13.699999999999754, 44.5, -50.00000000000044, 13.099999999999746, -50.00000000000044, 46.699999999999996, 47.1, 46.9, 46.699999999999996, -50.00000000000044, 45.9, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 44.10000000000001, 44.5, -50.00000000000044, 11.699999999999726, 45.3, -50.00000000000044, 31.300000000000004, 33.10000000000003, 43.30000000000001, 44.5, 42.30000000000001, 31.900000000000013, 42.900000000000006, 47.3, -50.00000000000044, 45.7, -50.00000000000044, 30.9, 43.50000000000001, -50.00000000000044, 45.9, 41.30000000000001, -50.00000000000044, 37.300000000000026, -50.00000000000044, 42.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 34.30000000000004, 31.70000000000001, 16.499999999999794, 46.699999999999996, 13.699999999999754, 39.10000000000002, 39.10000000000002, -50.00000000000044, 46.699999999999996, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 19.899999999999842, -50.00000000000044, 45.1, 45.9, 46.699999999999996, -50.00000000000044, 35.10000000000004, 42.30000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044], "episode_lengths": [40, 140, 500, 72, 36, 500, 500, 500, 500, 500, 500, 22, 142, 42, 44, 500, 500, 500, 500, 86, 132, 86, 66, 28, 500, 500, 102, 364, 56, 500, 370, 500, 34, 30, 32, 34, 500, 42, 500, 86, 500, 500, 36, 72, 60, 56, 500, 384, 48, 500, 188, 170, 68, 56, 78, 182, 72, 28, 500, 44, 500, 192, 66, 500, 42, 88, 500, 128, 500, 80, 50, 500, 500, 500, 44, 158, 184, 336, 34, 364, 110, 110, 500, 34, 122, 500, 500, 500, 28, 302, 500, 50, 42, 34, 500, 150, 78, 500, 116, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763047201859533, "mean_inference_ms": 1.206334498643452, "mean_action_processing_ms": 0.14031555382955593, "mean_env_wait_ms": 0.08258350764916107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024011611938476562, "StateBufferConnector_ms": 0.00799870491027832, "ViewRequirementAgentConnector_ms": 0.13596892356872559}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.492999999999827, "episode_len_mean": 250.7, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 36.10000000000004, -50.00000000000044, 42.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 35.900000000000034, 45.9, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 36.900000000000034, 41.500000000000014, 43.50000000000001, 47.3, -50.00000000000044, -50.00000000000044, 39.90000000000002, 13.699999999999754, 44.5, -50.00000000000044, 13.099999999999746, -50.00000000000044, 46.699999999999996, 47.1, 46.9, 46.699999999999996, -50.00000000000044, 45.9, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 44.10000000000001, 44.5, -50.00000000000044, 11.699999999999726, 45.3, -50.00000000000044, 31.300000000000004, 33.10000000000003, 43.30000000000001, 44.5, 42.30000000000001, 31.900000000000013, 42.900000000000006, 47.3, -50.00000000000044, 45.7, -50.00000000000044, 30.9, 43.50000000000001, -50.00000000000044, 45.9, 41.30000000000001, -50.00000000000044, 37.300000000000026, -50.00000000000044, 42.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 34.30000000000004, 31.70000000000001, 16.499999999999794, 46.699999999999996, 13.699999999999754, 39.10000000000002, 39.10000000000002, -50.00000000000044, 46.699999999999996, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 19.899999999999842, -50.00000000000044, 45.1, 45.9, 46.699999999999996, -50.00000000000044, 35.10000000000004, 42.30000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044], "episode_lengths": [40, 140, 500, 72, 36, 500, 500, 500, 500, 500, 500, 22, 142, 42, 44, 500, 500, 500, 500, 86, 132, 86, 66, 28, 500, 500, 102, 364, 56, 500, 370, 500, 34, 30, 32, 34, 500, 42, 500, 86, 500, 500, 36, 72, 60, 56, 500, 384, 48, 500, 188, 170, 68, 56, 78, 182, 72, 28, 500, 44, 500, 192, 66, 500, 42, 88, 500, 128, 500, 80, 50, 500, 500, 500, 44, 158, 184, 336, 34, 364, 110, 110, 500, 34, 122, 500, 500, 500, 28, 302, 500, 50, 42, 34, 500, 150, 78, 500, 116, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763047201859533, "mean_inference_ms": 1.206334498643452, "mean_action_processing_ms": 0.14031555382955593, "mean_env_wait_ms": 0.08258350764916107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024011611938476562, "StateBufferConnector_ms": 0.00799870491027832, "ViewRequirementAgentConnector_ms": 0.13596892356872559}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5415.152937288062, "num_env_steps_trained_throughput_per_sec": 5415.152937288062, "timesteps_total": 1458000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1458000, "timers": {"training_iteration_time_ms": 3268.162, "sample_time_ms": 2883.094, "load_time_ms": 19.905, "load_throughput": 904280.468, "learn_time_ms": 353.462, "learn_throughput": 50924.831, "synch_weights_time_ms": 9.698}, "counters": {"num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "done": false, "episodes_total": 5766, "training_iteration": 81, "trial_id": "9f288_00012", "date": "2023-10-25_16-36-01", "timestamp": 1698248161, "time_this_iter_s": 3.3310012817382812, "time_total_s": 261.8812940120697, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 261.8812940120697, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 57.760000000000005, "ram_util_percent": 26.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530278e-26, "cur_lr": 0.0003, "total_loss": 6.308018878654197, "policy_loss": -0.0004969589688159802, "vf_loss": 6.308564839539705, "vf_explained_var": -1.0817139237015336e-06, "kl": 0.0009368224786646385, "entropy": 0.49045673454249344, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2201.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.037999999999828, "episode_len_mean": 250.26, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.300000000000026, -50.00000000000044, 42.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 34.30000000000004, 31.70000000000001, 16.499999999999794, 46.699999999999996, 13.699999999999754, 39.10000000000002, 39.10000000000002, -50.00000000000044, 46.699999999999996, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 19.899999999999842, -50.00000000000044, 45.1, 45.9, 46.699999999999996, -50.00000000000044, 35.10000000000004, 42.30000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.90000000000001, 7.699999999999669, 46.699999999999996, 26.499999999999936, 44.10000000000001, 42.500000000000014, -50.00000000000044, 43.7, 46.9, -50.00000000000044, 7.09999999999966, 43.10000000000001, 41.30000000000001, 38.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.500000000000014, 46.5, 35.500000000000036, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 23.699999999999896, 45.3, 22.49999999999988, 43.7, 46.9, 27.299999999999947, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.7, 44.10000000000001, -50.00000000000044, 46.699999999999996, 46.699999999999996, 20.899999999999856, 45.5, -50.00000000000044, 45.1, 37.70000000000003, -50.00000000000044, 43.7, 46.699999999999996, 30.699999999999996, 45.9, -50.00000000000044, 45.3], "episode_lengths": [500, 128, 500, 80, 50, 500, 500, 500, 44, 158, 184, 336, 34, 364, 110, 110, 500, 34, 122, 500, 500, 500, 28, 302, 500, 50, 42, 34, 500, 150, 78, 500, 116, 500, 82, 424, 34, 236, 60, 76, 500, 64, 32, 500, 430, 70, 88, 120, 500, 500, 40, 500, 86, 36, 146, 500, 500, 62, 500, 500, 44, 500, 500, 500, 82, 74, 500, 62, 500, 500, 264, 48, 276, 64, 32, 228, 500, 38, 72, 500, 500, 36, 500, 44, 60, 500, 34, 34, 292, 46, 500, 50, 124, 500, 64, 34, 194, 42, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37601456352472573, "mean_inference_ms": 1.2078310361431566, "mean_action_processing_ms": 0.14034054217573833, "mean_env_wait_ms": 0.08289288031687152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800774574279785, "StateBufferConnector_ms": 0.009002685546875, "ViewRequirementAgentConnector_ms": 0.13297271728515625}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.037999999999828, "episode_len_mean": 250.26, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.300000000000026, -50.00000000000044, 42.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 34.30000000000004, 31.70000000000001, 16.499999999999794, 46.699999999999996, 13.699999999999754, 39.10000000000002, 39.10000000000002, -50.00000000000044, 46.699999999999996, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 19.899999999999842, -50.00000000000044, 45.1, 45.9, 46.699999999999996, -50.00000000000044, 35.10000000000004, 42.30000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.90000000000001, 7.699999999999669, 46.699999999999996, 26.499999999999936, 44.10000000000001, 42.500000000000014, -50.00000000000044, 43.7, 46.9, -50.00000000000044, 7.09999999999966, 43.10000000000001, 41.30000000000001, 38.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.500000000000014, 46.5, 35.500000000000036, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 23.699999999999896, 45.3, 22.49999999999988, 43.7, 46.9, 27.299999999999947, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.7, 44.10000000000001, -50.00000000000044, 46.699999999999996, 46.699999999999996, 20.899999999999856, 45.5, -50.00000000000044, 45.1, 37.70000000000003, -50.00000000000044, 43.7, 46.699999999999996, 30.699999999999996, 45.9, -50.00000000000044, 45.3], "episode_lengths": [500, 128, 500, 80, 50, 500, 500, 500, 44, 158, 184, 336, 34, 364, 110, 110, 500, 34, 122, 500, 500, 500, 28, 302, 500, 50, 42, 34, 500, 150, 78, 500, 116, 500, 82, 424, 34, 236, 60, 76, 500, 64, 32, 500, 430, 70, 88, 120, 500, 500, 40, 500, 86, 36, 146, 500, 500, 62, 500, 500, 44, 500, 500, 500, 82, 74, 500, 62, 500, 500, 264, 48, 276, 64, 32, 228, 500, 38, 72, 500, 500, 36, 500, 44, 60, 500, 34, 34, 292, 46, 500, 50, 124, 500, 64, 34, 194, 42, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37601456352472573, "mean_inference_ms": 1.2078310361431566, "mean_action_processing_ms": 0.14034054217573833, "mean_env_wait_ms": 0.08289288031687152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800774574279785, "StateBufferConnector_ms": 0.009002685546875, "ViewRequirementAgentConnector_ms": 0.13297271728515625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5469.461164692294, "num_env_steps_trained_throughput_per_sec": 5469.461164692294, "timesteps_total": 1476000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 3282.365, "sample_time_ms": 2900.097, "load_time_ms": 19.702, "load_throughput": 913599.315, "learn_time_ms": 350.662, "learn_throughput": 51331.542, "synch_weights_time_ms": 9.901}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5832, "training_iteration": 82, "trial_id": "9f288_00012", "date": "2023-10-25_16-36-04", "timestamp": 1698248164, "time_this_iter_s": 3.2970008850097656, "time_total_s": 265.17829489707947, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 265.17829489707947, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 72.6, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 0.0003, "total_loss": 6.739485016575566, "policy_loss": -0.00031163571057496247, "vf_loss": 6.7398415141635475, "vf_explained_var": -9.713349518952547e-07, "kl": 0.0010780875590617816, "entropy": 0.44892435162155714, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2228.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.657999999999836, "episode_len_mean": 234.08, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, 45.7, 44.10000000000001, -50.00000000000044, 46.699999999999996, 46.699999999999996, 20.899999999999856, 45.5, -50.00000000000044, 45.1, 37.70000000000003, -50.00000000000044, 43.7, 46.699999999999996, 30.699999999999996, 45.9, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 45.7, -50.00000000000044, 46.9, 36.10000000000004, 40.70000000000002, -50.00000000000044, 45.7, 21.699999999999868, 38.90000000000002, 34.30000000000004, 46.699999999999996, -50.00000000000044, 46.5, 40.90000000000002, -50.00000000000044, 44.900000000000006, 43.10000000000001, 43.7, -50.00000000000044, 0.8999999999995723, 43.900000000000006, 44.5, 45.1, 45.9, -50.00000000000044, 43.900000000000006, 40.90000000000002, -50.00000000000044, 45.5, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 36.30000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.900000000000006, 45.7, -50.00000000000044, 23.29999999999989, -50.00000000000044, 40.30000000000002, 46.5, 43.10000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.50000000000001, 45.5, 47.5, -50.00000000000044, 44.300000000000004, 44.900000000000006, 12.499999999999737, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, 37.300000000000026, 6.299999999999649, -50.00000000000044, 46.9, 8.299999999999677, -50.00000000000044, 47.5, 43.900000000000006], "episode_lengths": [500, 36, 500, 44, 60, 500, 34, 34, 292, 46, 500, 50, 124, 500, 64, 34, 194, 42, 500, 48, 500, 500, 54, 44, 500, 32, 140, 94, 500, 44, 284, 112, 158, 34, 500, 36, 92, 500, 52, 70, 64, 500, 492, 62, 56, 50, 42, 500, 62, 92, 500, 46, 46, 500, 500, 46, 138, 34, 500, 500, 34, 72, 44, 500, 268, 500, 98, 36, 70, 62, 500, 500, 54, 500, 500, 118, 500, 66, 46, 26, 500, 58, 52, 376, 62, 500, 500, 500, 140, 500, 500, 44, 128, 438, 500, 32, 418, 500, 26, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37721223113161245, "mean_inference_ms": 1.2063865425778346, "mean_action_processing_ms": 0.14047517741171084, "mean_env_wait_ms": 0.08289020738896351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023006916046142578, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.13897705078125}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.657999999999836, "episode_len_mean": 234.08, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, 45.7, 44.10000000000001, -50.00000000000044, 46.699999999999996, 46.699999999999996, 20.899999999999856, 45.5, -50.00000000000044, 45.1, 37.70000000000003, -50.00000000000044, 43.7, 46.699999999999996, 30.699999999999996, 45.9, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 45.7, -50.00000000000044, 46.9, 36.10000000000004, 40.70000000000002, -50.00000000000044, 45.7, 21.699999999999868, 38.90000000000002, 34.30000000000004, 46.699999999999996, -50.00000000000044, 46.5, 40.90000000000002, -50.00000000000044, 44.900000000000006, 43.10000000000001, 43.7, -50.00000000000044, 0.8999999999995723, 43.900000000000006, 44.5, 45.1, 45.9, -50.00000000000044, 43.900000000000006, 40.90000000000002, -50.00000000000044, 45.5, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 36.30000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.900000000000006, 45.7, -50.00000000000044, 23.29999999999989, -50.00000000000044, 40.30000000000002, 46.5, 43.10000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.50000000000001, 45.5, 47.5, -50.00000000000044, 44.300000000000004, 44.900000000000006, 12.499999999999737, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, 37.300000000000026, 6.299999999999649, -50.00000000000044, 46.9, 8.299999999999677, -50.00000000000044, 47.5, 43.900000000000006], "episode_lengths": [500, 36, 500, 44, 60, 500, 34, 34, 292, 46, 500, 50, 124, 500, 64, 34, 194, 42, 500, 48, 500, 500, 54, 44, 500, 32, 140, 94, 500, 44, 284, 112, 158, 34, 500, 36, 92, 500, 52, 70, 64, 500, 492, 62, 56, 50, 42, 500, 62, 92, 500, 46, 46, 500, 500, 46, 138, 34, 500, 500, 34, 72, 44, 500, 268, 500, 98, 36, 70, 62, 500, 500, 54, 500, 500, 118, 500, 66, 46, 26, 500, 58, 52, 376, 62, 500, 500, 500, 140, 500, 500, 44, 128, 438, 500, 32, 418, 500, 26, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37721223113161245, "mean_inference_ms": 1.2063865425778346, "mean_action_processing_ms": 0.14047517741171084, "mean_env_wait_ms": 0.08289020738896351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023006916046142578, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.13897705078125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5461.211657031947, "num_env_steps_trained_throughput_per_sec": 5461.211657031947, "timesteps_total": 1494000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1494000, "timers": {"training_iteration_time_ms": 3285.462, "sample_time_ms": 2912.694, "load_time_ms": 19.599, "load_throughput": 918398.163, "learn_time_ms": 341.268, "learn_throughput": 52744.457, "synch_weights_time_ms": 9.898}, "counters": {"num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "done": false, "episodes_total": 5912, "training_iteration": 83, "trial_id": "9f288_00012", "date": "2023-10-25_16-36-07", "timestamp": 1698248167, "time_this_iter_s": 3.3019702434539795, "time_total_s": 268.48026514053345, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 268.48026514053345, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 63.879999999999995, "ram_util_percent": 26.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825696e-26, "cur_lr": 0.0003, "total_loss": 6.541535766036422, "policy_loss": -0.0003339397113045885, "vf_loss": 6.541916123142949, "vf_explained_var": -1.0728836059570312e-06, "kl": 0.0006457677077420427, "entropy": 0.4642988509602017, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2255.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1129999999997964, "episode_len_mean": 274.44, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.50000000000001, 45.5, 47.5, -50.00000000000044, 44.300000000000004, 44.900000000000006, 12.499999999999737, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, 37.300000000000026, 6.299999999999649, -50.00000000000044, 46.9, 8.299999999999677, -50.00000000000044, 47.5, 43.900000000000006, -50.00000000000044, 46.099999999999994, 41.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, 39.90000000000002, 35.30000000000004, 25.499999999999922, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.699999999999996, 44.7, 42.500000000000014, 45.3, 45.3, 25.699999999999925, 43.7, -50.00000000000044, 39.300000000000026, 46.099999999999994, 46.5, 39.50000000000002, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, 45.7, 47.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, 45.1, 45.3, 40.30000000000002, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 37.50000000000003, -50.00000000000044, 14.699999999999768, 38.300000000000026, 43.7, -50.00000000000044], "episode_lengths": [62, 500, 500, 54, 500, 500, 118, 500, 66, 46, 26, 500, 58, 52, 376, 62, 500, 500, 500, 140, 500, 500, 44, 128, 438, 500, 32, 418, 500, 26, 62, 500, 40, 84, 500, 38, 500, 102, 148, 246, 500, 500, 58, 500, 500, 500, 44, 52, 500, 70, 500, 34, 54, 76, 48, 48, 244, 64, 500, 108, 40, 36, 106, 56, 500, 500, 500, 500, 500, 500, 342, 500, 44, 22, 500, 70, 500, 500, 48, 80, 500, 328, 500, 500, 50, 48, 98, 500, 40, 58, 500, 500, 500, 50, 126, 500, 354, 118, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3765379859301647, "mean_inference_ms": 1.2079612819437586, "mean_action_processing_ms": 0.1402751877820593, "mean_env_wait_ms": 0.08292091669191506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022675514221191406, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.13599443435668945}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1129999999997964, "episode_len_mean": 274.44, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.50000000000001, 45.5, 47.5, -50.00000000000044, 44.300000000000004, 44.900000000000006, 12.499999999999737, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, 37.300000000000026, 6.299999999999649, -50.00000000000044, 46.9, 8.299999999999677, -50.00000000000044, 47.5, 43.900000000000006, -50.00000000000044, 46.099999999999994, 41.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, 39.90000000000002, 35.30000000000004, 25.499999999999922, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.699999999999996, 44.7, 42.500000000000014, 45.3, 45.3, 25.699999999999925, 43.7, -50.00000000000044, 39.300000000000026, 46.099999999999994, 46.5, 39.50000000000002, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, 45.7, 47.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, 45.1, 45.3, 40.30000000000002, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 37.50000000000003, -50.00000000000044, 14.699999999999768, 38.300000000000026, 43.7, -50.00000000000044], "episode_lengths": [62, 500, 500, 54, 500, 500, 118, 500, 66, 46, 26, 500, 58, 52, 376, 62, 500, 500, 500, 140, 500, 500, 44, 128, 438, 500, 32, 418, 500, 26, 62, 500, 40, 84, 500, 38, 500, 102, 148, 246, 500, 500, 58, 500, 500, 500, 44, 52, 500, 70, 500, 34, 54, 76, 48, 48, 244, 64, 500, 108, 40, 36, 106, 56, 500, 500, 500, 500, 500, 500, 342, 500, 44, 22, 500, 70, 500, 500, 48, 80, 500, 328, 500, 500, 50, 48, 98, 500, 40, 58, 500, 500, 500, 50, 126, 500, 354, 118, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3765379859301647, "mean_inference_ms": 1.2079612819437586, "mean_action_processing_ms": 0.1402751877820593, "mean_env_wait_ms": 0.08292091669191506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022675514221191406, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.13599443435668945}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5604.029751491185, "num_env_steps_trained_throughput_per_sec": 5604.029751491185, "timesteps_total": 1512000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 3276.359, "sample_time_ms": 2913.191, "load_time_ms": 18.7, "load_throughput": 962585.067, "learn_time_ms": 332.568, "learn_throughput": 54124.246, "synch_weights_time_ms": 9.898}, "counters": {"num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": true, "episodes_total": 5981, "training_iteration": 84, "trial_id": "9f288_00012", "date": "2023-10-25_16-36-11", "timestamp": 1698248171, "time_this_iter_s": 3.217970132827759, "time_total_s": 271.6982352733612, "pid": 1288, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 271.6982352733612, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 63.775, "ram_util_percent": 26.3}}
