{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000007, "cur_lr": 0.0003, "total_loss": 9.166217581431072, "policy_loss": -0.002414645751317342, "vf_loss": 9.168008391062418, "vf_explained_var": 3.743171691894531e-06, "kl": 0.003483023407467679, "entropy": 0.7279528419176737, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 15.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 36.10000000000004, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -23.495833333333664, "episode_len_mean": 422.8333333333333, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 33.70000000000004, -50.00000000000044, 20.699999999999854, 24.099999999999902, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 15.299999999999777, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 140, 500, 164, 500, 294, 260, 352, 500, 500, 500, 500, 324, 348, 500, 500, 430, 500, 336, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38325594061420554, "mean_inference_ms": 1.2126623929201903, "mean_action_processing_ms": 0.1374375331890095, "mean_env_wait_ms": 0.08489072938144822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020805001258850098, "StateBufferConnector_ms": 0.004169344902038574, "ViewRequirementAgentConnector_ms": 0.09489258130391438}}, "episode_reward_max": 36.10000000000004, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -23.495833333333664, "episode_len_mean": 422.8333333333333, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 33.70000000000004, -50.00000000000044, 20.699999999999854, 24.099999999999902, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 15.299999999999777, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 140, 500, 164, 500, 294, 260, 352, 500, 500, 500, 500, 324, 348, 500, 500, 430, 500, 336, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38325594061420554, "mean_inference_ms": 1.2126623929201903, "mean_action_processing_ms": 0.1374375331890095, "mean_env_wait_ms": 0.08489072938144822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020805001258850098, "StateBufferConnector_ms": 0.004169344902038574, "ViewRequirementAgentConnector_ms": 0.09489258130391438}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5657.319300763393, "num_env_steps_trained_throughput_per_sec": 5657.319300763393, "timesteps_total": 12000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 2121.146, "sample_time_ms": 1914.252, "load_time_ms": 6.985, "load_throughput": 1718038.23, "learn_time_ms": 188.598, "learn_throughput": 63627.265, "synch_weights_time_ms": 10.311}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 24, "training_iteration": 1, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-24", "timestamp": 1698246984, "time_this_iter_s": 2.1301450729370117, "time_total_s": 2.1301450729370117, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 2.1301450729370117, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 56.725, "ram_util_percent": 26.424999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000003, "cur_lr": 0.0003, "total_loss": 8.842418638865153, "policy_loss": -0.0027292033036549887, "vf_loss": 8.8448792775472, "vf_explained_var": -3.153681755065918e-05, "kl": 0.0034014809825597086, "entropy": 0.7160896400610606, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 45.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 42.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -10.892982456140631, "episode_len_mean": 381.4035087719298, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 33.70000000000004, -50.00000000000044, 20.699999999999854, 24.099999999999902, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 15.299999999999777, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 10.499999999999709, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 20.899999999999856, 24.69999999999991, 6.8999999999996575, 34.70000000000004, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.099999999999802, 9.099999999999689, 8.49999999999968, 27.899999999999956, 25.899999999999928, 41.100000000000016, 6.299999999999649, 10.299999999999706, 14.499999999999766, 29.299999999999976, 42.10000000000001, 14.899999999999771, 26.89999999999994], "episode_lengths": [500, 500, 140, 500, 164, 500, 294, 260, 352, 500, 500, 500, 500, 324, 348, 500, 500, 430, 500, 336, 500, 500, 500, 500, 500, 500, 500, 268, 500, 396, 228, 500, 500, 500, 88, 292, 254, 432, 154, 206, 500, 500, 500, 500, 330, 410, 416, 222, 242, 90, 438, 398, 356, 208, 80, 352, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38570971973328877, "mean_inference_ms": 1.2228797549282864, "mean_action_processing_ms": 0.14014981236908272, "mean_env_wait_ms": 0.0849117298287692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02281958596748218, "StateBufferConnector_ms": 0.0087729671545196, "ViewRequirementAgentConnector_ms": 0.11187018009654262}}, "episode_reward_max": 42.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -10.892982456140631, "episode_len_mean": 381.4035087719298, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 33.70000000000004, -50.00000000000044, 20.699999999999854, 24.099999999999902, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 15.299999999999777, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 10.499999999999709, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 20.899999999999856, 24.69999999999991, 6.8999999999996575, 34.70000000000004, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.099999999999802, 9.099999999999689, 8.49999999999968, 27.899999999999956, 25.899999999999928, 41.100000000000016, 6.299999999999649, 10.299999999999706, 14.499999999999766, 29.299999999999976, 42.10000000000001, 14.899999999999771, 26.89999999999994], "episode_lengths": [500, 500, 140, 500, 164, 500, 294, 260, 352, 500, 500, 500, 500, 324, 348, 500, 500, 430, 500, 336, 500, 500, 500, 500, 500, 500, 500, 268, 500, 396, 228, 500, 500, 500, 88, 292, 254, 432, 154, 206, 500, 500, 500, 500, 330, 410, 416, 222, 242, 90, 438, 398, 356, 208, 80, 352, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38570971973328877, "mean_inference_ms": 1.2228797549282864, "mean_action_processing_ms": 0.14014981236908272, "mean_env_wait_ms": 0.0849117298287692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02281958596748218, "StateBufferConnector_ms": 0.0087729671545196, "ViewRequirementAgentConnector_ms": 0.11187018009654262}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5468.911835183065, "num_env_steps_trained_throughput_per_sec": 5468.911835183065, "timesteps_total": 24000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 2157.683, "sample_time_ms": 1947.665, "load_time_ms": 6.996, "load_throughput": 1715227.917, "learn_time_ms": 192.19, "learn_throughput": 62438.234, "synch_weights_time_ms": 9.832}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 57, "training_iteration": 2, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-26", "timestamp": 1698246986, "time_this_iter_s": 2.199218511581421, "time_total_s": 4.329363584518433, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 4.329363584518433, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 65.93333333333334, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000002, "cur_lr": 0.0003, "total_loss": 9.022592735290527, "policy_loss": -0.001408731285482645, "vf_loss": 9.023922665913899, "vf_explained_var": 7.152557373046875e-08, "kl": 0.0029112498909247128, "entropy": 0.6672151863574982, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 75.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 43.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.1806122448981924, "episode_len_mean": 343.8775510204082, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 33.70000000000004, -50.00000000000044, 20.699999999999854, 24.099999999999902, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 15.299999999999777, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 10.499999999999709, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 20.899999999999856, 24.69999999999991, 6.8999999999996575, 34.70000000000004, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.099999999999802, 9.099999999999689, 8.49999999999968, 27.899999999999956, 25.899999999999928, 41.100000000000016, 6.299999999999649, 10.299999999999706, 14.499999999999766, 29.299999999999976, 42.10000000000001, 14.899999999999771, 26.89999999999994, 30.9, -50.00000000000044, 37.10000000000003, 23.29999999999989, 29.099999999999973, 39.300000000000026, -50.00000000000044, -50.00000000000044, 34.50000000000004, 40.10000000000002, 37.300000000000026, 7.499999999999666, 31.1, 36.900000000000034, 24.099999999999902, 2.299999999999592, -50.00000000000044, 28.29999999999996, 39.70000000000002, 38.300000000000026, 30.9, 20.49999999999985, 9.299999999999692, 43.50000000000001, -50.00000000000044, 33.500000000000036, 10.699999999999712, 24.299999999999905, 27.899999999999956, 2.299999999999592, -50.00000000000044, 10.499999999999709, -50.00000000000044, 10.299999999999706, 20.49999999999985, 19.899999999999842, 43.900000000000006, -50.00000000000044, 35.10000000000004, 34.30000000000004, -50.00000000000044], "episode_lengths": [500, 500, 140, 500, 164, 500, 294, 260, 352, 500, 500, 500, 500, 324, 348, 500, 500, 430, 500, 336, 500, 500, 500, 500, 500, 500, 500, 268, 500, 396, 228, 500, 500, 500, 88, 292, 254, 432, 154, 206, 500, 500, 500, 500, 330, 410, 416, 222, 242, 90, 438, 398, 356, 208, 80, 352, 232, 192, 500, 130, 268, 210, 108, 500, 500, 156, 100, 128, 426, 190, 132, 260, 478, 500, 218, 104, 118, 192, 296, 408, 66, 500, 166, 394, 258, 222, 478, 500, 396, 500, 398, 296, 302, 62, 500, 150, 158, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3858332717924536, "mean_inference_ms": 1.2301823294661018, "mean_action_processing_ms": 0.14215339727064297, "mean_env_wait_ms": 0.08478831412732313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024502131403708945, "StateBufferConnector_ms": 0.009184710833491112, "ViewRequirementAgentConnector_ms": 0.12834169426742864}}, "episode_reward_max": 43.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.1806122448981924, "episode_len_mean": 343.8775510204082, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 33.70000000000004, -50.00000000000044, 20.699999999999854, 24.099999999999902, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 15.299999999999777, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 10.499999999999709, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 20.899999999999856, 24.69999999999991, 6.8999999999996575, 34.70000000000004, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.099999999999802, 9.099999999999689, 8.49999999999968, 27.899999999999956, 25.899999999999928, 41.100000000000016, 6.299999999999649, 10.299999999999706, 14.499999999999766, 29.299999999999976, 42.10000000000001, 14.899999999999771, 26.89999999999994, 30.9, -50.00000000000044, 37.10000000000003, 23.29999999999989, 29.099999999999973, 39.300000000000026, -50.00000000000044, -50.00000000000044, 34.50000000000004, 40.10000000000002, 37.300000000000026, 7.499999999999666, 31.1, 36.900000000000034, 24.099999999999902, 2.299999999999592, -50.00000000000044, 28.29999999999996, 39.70000000000002, 38.300000000000026, 30.9, 20.49999999999985, 9.299999999999692, 43.50000000000001, -50.00000000000044, 33.500000000000036, 10.699999999999712, 24.299999999999905, 27.899999999999956, 2.299999999999592, -50.00000000000044, 10.499999999999709, -50.00000000000044, 10.299999999999706, 20.49999999999985, 19.899999999999842, 43.900000000000006, -50.00000000000044, 35.10000000000004, 34.30000000000004, -50.00000000000044], "episode_lengths": [500, 500, 140, 500, 164, 500, 294, 260, 352, 500, 500, 500, 500, 324, 348, 500, 500, 430, 500, 336, 500, 500, 500, 500, 500, 500, 500, 268, 500, 396, 228, 500, 500, 500, 88, 292, 254, 432, 154, 206, 500, 500, 500, 500, 330, 410, 416, 222, 242, 90, 438, 398, 356, 208, 80, 352, 232, 192, 500, 130, 268, 210, 108, 500, 500, 156, 100, 128, 426, 190, 132, 260, 478, 500, 218, 104, 118, 192, 296, 408, 66, 500, 166, 394, 258, 222, 478, 500, 396, 500, 398, 296, 302, 62, 500, 150, 158, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3858332717924536, "mean_inference_ms": 1.2301823294661018, "mean_action_processing_ms": 0.14215339727064297, "mean_env_wait_ms": 0.08478831412732313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024502131403708945, "StateBufferConnector_ms": 0.009184710833491112, "ViewRequirementAgentConnector_ms": 0.12834169426742864}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5099.97239843048, "num_env_steps_trained_throughput_per_sec": 5099.97239843048, "timesteps_total": 36000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 2222.774, "sample_time_ms": 1968.641, "load_time_ms": 7.663, "load_throughput": 1565947.731, "learn_time_ms": 235.583, "learn_throughput": 50937.567, "synch_weights_time_ms": 9.887}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 98, "training_iteration": 3, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-29", "timestamp": 1698246989, "time_this_iter_s": 2.3579535484313965, "time_total_s": 6.687317132949829, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.687317132949829, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 66.8, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.02500000000000001, "cur_lr": 0.0003, "total_loss": 8.780628490447999, "policy_loss": -0.0007279440760612488, "vf_loss": 8.781374295552572, "vf_explained_var": 8.966525395711263e-06, "kl": 0.0018027909566474894, "entropy": 0.6298497299353282, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 105.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.947999999999822, "episode_len_mean": 291.26, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.099999999999802, 9.099999999999689, 8.49999999999968, 27.899999999999956, 25.899999999999928, 41.100000000000016, 6.299999999999649, 10.299999999999706, 14.499999999999766, 29.299999999999976, 42.10000000000001, 14.899999999999771, 26.89999999999994, 30.9, -50.00000000000044, 37.10000000000003, 23.29999999999989, 29.099999999999973, 39.300000000000026, -50.00000000000044, -50.00000000000044, 34.50000000000004, 40.10000000000002, 37.300000000000026, 7.499999999999666, 31.1, 36.900000000000034, 24.099999999999902, 2.299999999999592, -50.00000000000044, 28.29999999999996, 39.70000000000002, 38.300000000000026, 30.9, 20.49999999999985, 9.299999999999692, 43.50000000000001, -50.00000000000044, 33.500000000000036, 10.699999999999712, 24.299999999999905, 27.899999999999956, 2.299999999999592, -50.00000000000044, 10.499999999999709, -50.00000000000044, 10.299999999999706, 20.49999999999985, 19.899999999999842, 43.900000000000006, -50.00000000000044, 35.10000000000004, 34.30000000000004, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 16.8999999999998, 44.900000000000006, 42.500000000000014, 37.70000000000003, 10.699999999999712, 39.50000000000002, 20.49999999999985, 26.499999999999936, 31.900000000000013, 44.300000000000004, -50.00000000000044, 37.50000000000003, 23.699999999999896, 37.70000000000003, 7.499999999999666, -50.00000000000044, 40.30000000000002, 23.099999999999888, -50.00000000000044, 38.50000000000003, 21.699999999999868, 37.70000000000003, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.900000000000006, 35.900000000000034, 22.899999999999885, -50.00000000000044, -50.00000000000044, 43.7, 42.500000000000014, -50.00000000000044, 41.90000000000001, 32.90000000000003, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 330, 410, 416, 222, 242, 90, 438, 398, 356, 208, 80, 352, 232, 192, 500, 130, 268, 210, 108, 500, 500, 156, 100, 128, 426, 190, 132, 260, 478, 500, 218, 104, 118, 192, 296, 408, 66, 500, 166, 394, 258, 222, 478, 500, 396, 500, 398, 296, 302, 62, 500, 150, 158, 500, 500, 162, 500, 332, 52, 76, 124, 394, 106, 296, 236, 182, 58, 500, 126, 264, 124, 426, 500, 98, 270, 500, 116, 284, 124, 110, 500, 500, 500, 62, 500, 62, 142, 272, 500, 500, 64, 76, 500, 82, 172, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3868255867053415, "mean_inference_ms": 1.2338008365856183, "mean_action_processing_ms": 0.14483268831660429, "mean_env_wait_ms": 0.08440867202768061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024023056030273438, "StateBufferConnector_ms": 0.012000799179077148, "ViewRequirementAgentConnector_ms": 0.12200212478637695}}, "episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.947999999999822, "episode_len_mean": 291.26, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.099999999999802, 9.099999999999689, 8.49999999999968, 27.899999999999956, 25.899999999999928, 41.100000000000016, 6.299999999999649, 10.299999999999706, 14.499999999999766, 29.299999999999976, 42.10000000000001, 14.899999999999771, 26.89999999999994, 30.9, -50.00000000000044, 37.10000000000003, 23.29999999999989, 29.099999999999973, 39.300000000000026, -50.00000000000044, -50.00000000000044, 34.50000000000004, 40.10000000000002, 37.300000000000026, 7.499999999999666, 31.1, 36.900000000000034, 24.099999999999902, 2.299999999999592, -50.00000000000044, 28.29999999999996, 39.70000000000002, 38.300000000000026, 30.9, 20.49999999999985, 9.299999999999692, 43.50000000000001, -50.00000000000044, 33.500000000000036, 10.699999999999712, 24.299999999999905, 27.899999999999956, 2.299999999999592, -50.00000000000044, 10.499999999999709, -50.00000000000044, 10.299999999999706, 20.49999999999985, 19.899999999999842, 43.900000000000006, -50.00000000000044, 35.10000000000004, 34.30000000000004, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 16.8999999999998, 44.900000000000006, 42.500000000000014, 37.70000000000003, 10.699999999999712, 39.50000000000002, 20.49999999999985, 26.499999999999936, 31.900000000000013, 44.300000000000004, -50.00000000000044, 37.50000000000003, 23.699999999999896, 37.70000000000003, 7.499999999999666, -50.00000000000044, 40.30000000000002, 23.099999999999888, -50.00000000000044, 38.50000000000003, 21.699999999999868, 37.70000000000003, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.900000000000006, 35.900000000000034, 22.899999999999885, -50.00000000000044, -50.00000000000044, 43.7, 42.500000000000014, -50.00000000000044, 41.90000000000001, 32.90000000000003, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 330, 410, 416, 222, 242, 90, 438, 398, 356, 208, 80, 352, 232, 192, 500, 130, 268, 210, 108, 500, 500, 156, 100, 128, 426, 190, 132, 260, 478, 500, 218, 104, 118, 192, 296, 408, 66, 500, 166, 394, 258, 222, 478, 500, 396, 500, 398, 296, 302, 62, 500, 150, 158, 500, 500, 162, 500, 332, 52, 76, 124, 394, 106, 296, 236, 182, 58, 500, 126, 264, 124, 426, 500, 98, 270, 500, 116, 284, 124, 110, 500, 500, 500, 62, 500, 62, 142, 272, 500, 500, 64, 76, 500, 82, 172, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3868255867053415, "mean_inference_ms": 1.2338008365856183, "mean_action_processing_ms": 0.14483268831660429, "mean_env_wait_ms": 0.08440867202768061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024023056030273438, "StateBufferConnector_ms": 0.012000799179077148, "ViewRequirementAgentConnector_ms": 0.12200212478637695}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5240.380993313814, "num_env_steps_trained_throughput_per_sec": 5240.380993313814, "timesteps_total": 48000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 2239.558, "sample_time_ms": 1952.479, "load_time_ms": 9.946, "load_throughput": 1206516.558, "learn_time_ms": 266.217, "learn_throughput": 45075.98, "synch_weights_time_ms": 9.915}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 140, "training_iteration": 4, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-31", "timestamp": 1698246991, "time_this_iter_s": 2.293910026550293, "time_total_s": 8.981227159500122, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 8.981227159500122, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 57.800000000000004, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000004, "cur_lr": 0.0003, "total_loss": 8.52549867630005, "policy_loss": -0.00048722649614016216, "vf_loss": 8.526038773854573, "vf_explained_var": -5.245208740234375e-07, "kl": 0.0008674983609495257, "entropy": 0.6375301063060761, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.794999999999838, "episode_len_mean": 267.76, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.299999999999706, 20.49999999999985, 19.899999999999842, 43.900000000000006, -50.00000000000044, 35.10000000000004, 34.30000000000004, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 16.8999999999998, 44.900000000000006, 42.500000000000014, 37.70000000000003, 10.699999999999712, 39.50000000000002, 20.49999999999985, 26.499999999999936, 31.900000000000013, 44.300000000000004, -50.00000000000044, 37.50000000000003, 23.699999999999896, 37.70000000000003, 7.499999999999666, -50.00000000000044, 40.30000000000002, 23.099999999999888, -50.00000000000044, 38.50000000000003, 21.699999999999868, 37.70000000000003, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.900000000000006, 35.900000000000034, 22.899999999999885, -50.00000000000044, -50.00000000000044, 43.7, 42.500000000000014, -50.00000000000044, 41.90000000000001, 32.90000000000003, -50.00000000000044, 30.29999999999999, 41.70000000000002, 33.90000000000004, 46.3, 42.10000000000001, 46.9, 18.899999999999828, 40.30000000000002, -50.00000000000044, 1.099999999999575, 37.90000000000003, 30.9, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 25.899999999999928, 24.899999999999913, -50.00000000000044, 46.3, 42.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, 0.6999999999995694, 41.70000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 41.70000000000002, 37.50000000000003, 35.70000000000003, 3.899999999999615, 34.900000000000034, -50.00000000000044, -50.00000000000044, 27.49999999999995, 40.90000000000002, 46.699999999999996, 31.70000000000001, -50.00000000000044, 27.49999999999995, 26.09999999999993, 21.89999999999987, 42.500000000000014, 45.3, 19.69999999999984, -50.00000000000044], "episode_lengths": [398, 296, 302, 62, 500, 150, 158, 500, 500, 162, 500, 332, 52, 76, 124, 394, 106, 296, 236, 182, 58, 500, 126, 264, 124, 426, 500, 98, 270, 500, 116, 284, 124, 110, 500, 500, 500, 62, 500, 62, 142, 272, 500, 500, 64, 76, 500, 82, 172, 500, 198, 84, 162, 38, 80, 32, 312, 98, 500, 490, 122, 192, 68, 500, 500, 500, 62, 500, 242, 252, 500, 38, 76, 500, 140, 500, 494, 84, 500, 74, 500, 84, 126, 144, 462, 152, 500, 500, 226, 92, 34, 184, 500, 226, 240, 282, 76, 48, 304, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847929316339507, "mean_inference_ms": 1.2269687688989082, "mean_action_processing_ms": 0.14632930635799318, "mean_env_wait_ms": 0.08414732476707897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025001049041748047, "StateBufferConnector_ms": 0.008997678756713867, "ViewRequirementAgentConnector_ms": 0.11400127410888672}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.794999999999838, "episode_len_mean": 267.76, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.299999999999706, 20.49999999999985, 19.899999999999842, 43.900000000000006, -50.00000000000044, 35.10000000000004, 34.30000000000004, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 16.8999999999998, 44.900000000000006, 42.500000000000014, 37.70000000000003, 10.699999999999712, 39.50000000000002, 20.49999999999985, 26.499999999999936, 31.900000000000013, 44.300000000000004, -50.00000000000044, 37.50000000000003, 23.699999999999896, 37.70000000000003, 7.499999999999666, -50.00000000000044, 40.30000000000002, 23.099999999999888, -50.00000000000044, 38.50000000000003, 21.699999999999868, 37.70000000000003, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.900000000000006, 35.900000000000034, 22.899999999999885, -50.00000000000044, -50.00000000000044, 43.7, 42.500000000000014, -50.00000000000044, 41.90000000000001, 32.90000000000003, -50.00000000000044, 30.29999999999999, 41.70000000000002, 33.90000000000004, 46.3, 42.10000000000001, 46.9, 18.899999999999828, 40.30000000000002, -50.00000000000044, 1.099999999999575, 37.90000000000003, 30.9, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 25.899999999999928, 24.899999999999913, -50.00000000000044, 46.3, 42.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, 0.6999999999995694, 41.70000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 41.70000000000002, 37.50000000000003, 35.70000000000003, 3.899999999999615, 34.900000000000034, -50.00000000000044, -50.00000000000044, 27.49999999999995, 40.90000000000002, 46.699999999999996, 31.70000000000001, -50.00000000000044, 27.49999999999995, 26.09999999999993, 21.89999999999987, 42.500000000000014, 45.3, 19.69999999999984, -50.00000000000044], "episode_lengths": [398, 296, 302, 62, 500, 150, 158, 500, 500, 162, 500, 332, 52, 76, 124, 394, 106, 296, 236, 182, 58, 500, 126, 264, 124, 426, 500, 98, 270, 500, 116, 284, 124, 110, 500, 500, 500, 62, 500, 62, 142, 272, 500, 500, 64, 76, 500, 82, 172, 500, 198, 84, 162, 38, 80, 32, 312, 98, 500, 490, 122, 192, 68, 500, 500, 500, 62, 500, 242, 252, 500, 38, 76, 500, 140, 500, 494, 84, 500, 74, 500, 84, 126, 144, 462, 152, 500, 500, 226, 92, 34, 184, 500, 226, 240, 282, 76, 48, 304, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847929316339507, "mean_inference_ms": 1.2269687688989082, "mean_action_processing_ms": 0.14632930635799318, "mean_env_wait_ms": 0.08414732476707897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025001049041748047, "StateBufferConnector_ms": 0.008997678756713867, "ViewRequirementAgentConnector_ms": 0.11400127410888672}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5334.967654703962, "num_env_steps_trained_throughput_per_sec": 5334.967654703962, "timesteps_total": 60000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 2241.508, "sample_time_ms": 1949.038, "load_time_ms": 9.357, "load_throughput": 1282485.285, "learn_time_ms": 271.863, "learn_throughput": 44139.866, "synch_weights_time_ms": 10.25}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 190, "training_iteration": 5, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-33", "timestamp": 1698246993, "time_this_iter_s": 2.2543089389801025, "time_total_s": 11.235536098480225, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 11.235536098480225, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 54.0, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000002, "cur_lr": 0.0003, "total_loss": 7.800452486673991, "policy_loss": -0.000757282537718614, "vf_loss": 7.801262203852335, "vf_explained_var": 3.6418437957763673e-06, "kl": 0.001475497709869463, "entropy": 0.6175462524096171, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 165.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.030999999999842, "episode_len_mean": 255.4, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.90000000000003, -50.00000000000044, 30.29999999999999, 41.70000000000002, 33.90000000000004, 46.3, 42.10000000000001, 46.9, 18.899999999999828, 40.30000000000002, -50.00000000000044, 1.099999999999575, 37.90000000000003, 30.9, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 25.899999999999928, 24.899999999999913, -50.00000000000044, 46.3, 42.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, 0.6999999999995694, 41.70000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 41.70000000000002, 37.50000000000003, 35.70000000000003, 3.899999999999615, 34.900000000000034, -50.00000000000044, -50.00000000000044, 27.49999999999995, 40.90000000000002, 46.699999999999996, 31.70000000000001, -50.00000000000044, 27.49999999999995, 26.09999999999993, 21.89999999999987, 42.500000000000014, 45.3, 19.69999999999984, -50.00000000000044, 41.100000000000016, 40.30000000000002, -50.00000000000044, -50.00000000000044, 34.50000000000004, 41.90000000000001, 36.50000000000003, 19.899999999999842, -50.00000000000044, 42.30000000000001, 40.70000000000002, 46.5, 39.10000000000002, 45.3, 24.69999999999991, -50.00000000000044, 42.30000000000001, 6.699999999999655, -50.00000000000044, 35.10000000000004, -50.00000000000044, 6.8999999999996575, 39.300000000000026, 38.50000000000003, 42.70000000000001, 44.7, 14.09999999999976, 41.90000000000001, -50.00000000000044, 37.70000000000003, 42.900000000000006, 47.1, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 17.499999999999808, 43.900000000000006, 33.500000000000036, -50.00000000000044, 19.899999999999842, -50.00000000000044, 38.50000000000003, 47.3, 39.300000000000026, -50.00000000000044], "episode_lengths": [172, 500, 198, 84, 162, 38, 80, 32, 312, 98, 500, 490, 122, 192, 68, 500, 500, 500, 62, 500, 242, 252, 500, 38, 76, 500, 140, 500, 494, 84, 500, 74, 500, 84, 126, 144, 462, 152, 500, 500, 226, 92, 34, 184, 500, 226, 240, 282, 76, 48, 304, 500, 90, 98, 500, 500, 156, 82, 136, 302, 500, 78, 94, 36, 110, 48, 254, 500, 78, 434, 500, 150, 500, 432, 108, 116, 74, 54, 360, 82, 500, 124, 72, 30, 500, 70, 500, 500, 500, 74, 326, 62, 166, 500, 302, 500, 116, 28, 108, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3831745583913067, "mean_inference_ms": 1.222062272491025, "mean_action_processing_ms": 0.14634232790830826, "mean_env_wait_ms": 0.08368681951708268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029001474380493164, "StateBufferConnector_ms": 0.004995822906494141, "ViewRequirementAgentConnector_ms": 0.10710024833679199}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.030999999999842, "episode_len_mean": 255.4, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.90000000000003, -50.00000000000044, 30.29999999999999, 41.70000000000002, 33.90000000000004, 46.3, 42.10000000000001, 46.9, 18.899999999999828, 40.30000000000002, -50.00000000000044, 1.099999999999575, 37.90000000000003, 30.9, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 25.899999999999928, 24.899999999999913, -50.00000000000044, 46.3, 42.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, 0.6999999999995694, 41.70000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 41.70000000000002, 37.50000000000003, 35.70000000000003, 3.899999999999615, 34.900000000000034, -50.00000000000044, -50.00000000000044, 27.49999999999995, 40.90000000000002, 46.699999999999996, 31.70000000000001, -50.00000000000044, 27.49999999999995, 26.09999999999993, 21.89999999999987, 42.500000000000014, 45.3, 19.69999999999984, -50.00000000000044, 41.100000000000016, 40.30000000000002, -50.00000000000044, -50.00000000000044, 34.50000000000004, 41.90000000000001, 36.50000000000003, 19.899999999999842, -50.00000000000044, 42.30000000000001, 40.70000000000002, 46.5, 39.10000000000002, 45.3, 24.69999999999991, -50.00000000000044, 42.30000000000001, 6.699999999999655, -50.00000000000044, 35.10000000000004, -50.00000000000044, 6.8999999999996575, 39.300000000000026, 38.50000000000003, 42.70000000000001, 44.7, 14.09999999999976, 41.90000000000001, -50.00000000000044, 37.70000000000003, 42.900000000000006, 47.1, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 17.499999999999808, 43.900000000000006, 33.500000000000036, -50.00000000000044, 19.899999999999842, -50.00000000000044, 38.50000000000003, 47.3, 39.300000000000026, -50.00000000000044], "episode_lengths": [172, 500, 198, 84, 162, 38, 80, 32, 312, 98, 500, 490, 122, 192, 68, 500, 500, 500, 62, 500, 242, 252, 500, 38, 76, 500, 140, 500, 494, 84, 500, 74, 500, 84, 126, 144, 462, 152, 500, 500, 226, 92, 34, 184, 500, 226, 240, 282, 76, 48, 304, 500, 90, 98, 500, 500, 156, 82, 136, 302, 500, 78, 94, 36, 110, 48, 254, 500, 78, 434, 500, 150, 500, 432, 108, 116, 74, 54, 360, 82, 500, 124, 72, 30, 500, 70, 500, 500, 500, 74, 326, 62, 166, 500, 302, 500, 116, 28, 108, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3831745583913067, "mean_inference_ms": 1.222062272491025, "mean_action_processing_ms": 0.14634232790830826, "mean_env_wait_ms": 0.08368681951708268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029001474380493164, "StateBufferConnector_ms": 0.004995822906494141, "ViewRequirementAgentConnector_ms": 0.10710024833679199}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4533.564618925071, "num_env_steps_trained_throughput_per_sec": 4533.564618925071, "timesteps_total": 72000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 2309.078, "sample_time_ms": 1991.346, "load_time_ms": 10.158, "load_throughput": 1181281.491, "learn_time_ms": 296.531, "learn_throughput": 40468.004, "synch_weights_time_ms": 10.042}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 238, "training_iteration": 6, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-36", "timestamp": 1698246996, "time_this_iter_s": 2.651923179626465, "time_total_s": 13.88745927810669, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 13.88745927810669, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 54.574999999999996, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003125000000000001, "cur_lr": 0.0003, "total_loss": 6.5396377881368, "policy_loss": -0.000821031133333842, "vf_loss": 6.540512275695801, "vf_explained_var": 3.8743019104003906e-07, "kl": 0.0012854424864220467, "entropy": 0.5753671765327454, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 195.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.56299999999987, "episode_len_mean": 230.12, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, 40.30000000000002, -50.00000000000044, -50.00000000000044, 34.50000000000004, 41.90000000000001, 36.50000000000003, 19.899999999999842, -50.00000000000044, 42.30000000000001, 40.70000000000002, 46.5, 39.10000000000002, 45.3, 24.69999999999991, -50.00000000000044, 42.30000000000001, 6.699999999999655, -50.00000000000044, 35.10000000000004, -50.00000000000044, 6.8999999999996575, 39.300000000000026, 38.50000000000003, 42.70000000000001, 44.7, 14.09999999999976, 41.90000000000001, -50.00000000000044, 37.70000000000003, 42.900000000000006, 47.1, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 17.499999999999808, 43.900000000000006, 33.500000000000036, -50.00000000000044, 19.899999999999842, -50.00000000000044, 38.50000000000003, 47.3, 39.300000000000026, -50.00000000000044, 16.8999999999998, 42.70000000000001, -50.00000000000044, 26.69999999999994, 10.899999999999714, -50.00000000000044, 44.900000000000006, 34.50000000000004, 27.899999999999956, 44.10000000000001, 43.7, 36.30000000000003, 44.300000000000004, 40.70000000000002, -50.00000000000044, 40.70000000000002, 24.69999999999991, -50.00000000000044, 39.70000000000002, 44.7, 44.300000000000004, 45.5, 44.7, 34.10000000000004, 33.30000000000003, 32.50000000000002, 46.9, 13.299999999999748, 31.500000000000007, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.500000000000014, 38.10000000000002, 46.5, 27.899999999999956, 42.10000000000001, 38.10000000000002, 28.699999999999967, 41.90000000000001, 46.9, -50.00000000000044, 16.8999999999998, 36.10000000000004, 35.900000000000034, -50.00000000000044, -50.00000000000044, 38.50000000000003, 41.90000000000001, 38.10000000000002, -50.00000000000044], "episode_lengths": [500, 90, 98, 500, 500, 156, 82, 136, 302, 500, 78, 94, 36, 110, 48, 254, 500, 78, 434, 500, 150, 500, 432, 108, 116, 74, 54, 360, 82, 500, 124, 72, 30, 500, 70, 500, 500, 500, 74, 326, 62, 166, 500, 302, 500, 116, 28, 108, 500, 332, 74, 500, 234, 392, 500, 52, 156, 222, 60, 64, 138, 58, 94, 500, 94, 254, 500, 104, 54, 58, 46, 54, 160, 168, 176, 32, 368, 186, 500, 500, 98, 96, 120, 36, 222, 80, 120, 214, 82, 32, 500, 332, 140, 142, 500, 500, 116, 82, 120, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836353525842092, "mean_inference_ms": 1.2206151858313758, "mean_action_processing_ms": 0.14531383187944288, "mean_env_wait_ms": 0.08361890669910353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02982306480407715, "StateBufferConnector_ms": 0.009995698928833008, "ViewRequirementAgentConnector_ms": 0.11680293083190918}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.56299999999987, "episode_len_mean": 230.12, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, 40.30000000000002, -50.00000000000044, -50.00000000000044, 34.50000000000004, 41.90000000000001, 36.50000000000003, 19.899999999999842, -50.00000000000044, 42.30000000000001, 40.70000000000002, 46.5, 39.10000000000002, 45.3, 24.69999999999991, -50.00000000000044, 42.30000000000001, 6.699999999999655, -50.00000000000044, 35.10000000000004, -50.00000000000044, 6.8999999999996575, 39.300000000000026, 38.50000000000003, 42.70000000000001, 44.7, 14.09999999999976, 41.90000000000001, -50.00000000000044, 37.70000000000003, 42.900000000000006, 47.1, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 17.499999999999808, 43.900000000000006, 33.500000000000036, -50.00000000000044, 19.899999999999842, -50.00000000000044, 38.50000000000003, 47.3, 39.300000000000026, -50.00000000000044, 16.8999999999998, 42.70000000000001, -50.00000000000044, 26.69999999999994, 10.899999999999714, -50.00000000000044, 44.900000000000006, 34.50000000000004, 27.899999999999956, 44.10000000000001, 43.7, 36.30000000000003, 44.300000000000004, 40.70000000000002, -50.00000000000044, 40.70000000000002, 24.69999999999991, -50.00000000000044, 39.70000000000002, 44.7, 44.300000000000004, 45.5, 44.7, 34.10000000000004, 33.30000000000003, 32.50000000000002, 46.9, 13.299999999999748, 31.500000000000007, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.500000000000014, 38.10000000000002, 46.5, 27.899999999999956, 42.10000000000001, 38.10000000000002, 28.699999999999967, 41.90000000000001, 46.9, -50.00000000000044, 16.8999999999998, 36.10000000000004, 35.900000000000034, -50.00000000000044, -50.00000000000044, 38.50000000000003, 41.90000000000001, 38.10000000000002, -50.00000000000044], "episode_lengths": [500, 90, 98, 500, 500, 156, 82, 136, 302, 500, 78, 94, 36, 110, 48, 254, 500, 78, 434, 500, 150, 500, 432, 108, 116, 74, 54, 360, 82, 500, 124, 72, 30, 500, 70, 500, 500, 500, 74, 326, 62, 166, 500, 302, 500, 116, 28, 108, 500, 332, 74, 500, 234, 392, 500, 52, 156, 222, 60, 64, 138, 58, 94, 500, 94, 254, 500, 104, 54, 58, 46, 54, 160, 168, 176, 32, 368, 186, 500, 500, 98, 96, 120, 36, 222, 80, 120, 214, 82, 32, 500, 332, 140, 142, 500, 500, 116, 82, 120, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836353525842092, "mean_inference_ms": 1.2206151858313758, "mean_action_processing_ms": 0.14531383187944288, "mean_env_wait_ms": 0.08361890669910353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02982306480407715, "StateBufferConnector_ms": 0.009995698928833008, "ViewRequirementAgentConnector_ms": 0.11680293083190918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5317.48486658283, "num_env_steps_trained_throughput_per_sec": 5317.48486658283, "timesteps_total": 84000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 2301.596, "sample_time_ms": 1985.68, "load_time_ms": 9.85, "load_throughput": 1218292.061, "learn_time_ms": 295.209, "learn_throughput": 40649.219, "synch_weights_time_ms": 10.001}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 289, "training_iteration": 7, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-38", "timestamp": 1698246998, "time_this_iter_s": 2.2617039680480957, "time_total_s": 16.149163246154785, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 16.149163246154785, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 53.13333333333333, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000005, "cur_lr": 0.0003, "total_loss": 7.109908262888591, "policy_loss": -0.0004497772781178355, "vf_loss": 7.110414425532023, "vf_explained_var": -1.4940897623697917e-06, "kl": 0.0010389888933635425, "entropy": 0.5791569749514262, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.332999999999878, "episode_len_mean": 222.46, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.899999999999714, -50.00000000000044, 44.900000000000006, 34.50000000000004, 27.899999999999956, 44.10000000000001, 43.7, 36.30000000000003, 44.300000000000004, 40.70000000000002, -50.00000000000044, 40.70000000000002, 24.69999999999991, -50.00000000000044, 39.70000000000002, 44.7, 44.300000000000004, 45.5, 44.7, 34.10000000000004, 33.30000000000003, 32.50000000000002, 46.9, 13.299999999999748, 31.500000000000007, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.500000000000014, 38.10000000000002, 46.5, 27.899999999999956, 42.10000000000001, 38.10000000000002, 28.699999999999967, 41.90000000000001, 46.9, -50.00000000000044, 16.8999999999998, 36.10000000000004, 35.900000000000034, -50.00000000000044, -50.00000000000044, 38.50000000000003, 41.90000000000001, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 14.499999999999766, 41.30000000000001, 46.3, 47.5, 27.699999999999953, 43.7, 39.300000000000026, -50.00000000000044, 34.900000000000034, 35.500000000000036, 1.4999999999995808, 44.5, 7.699999999999669, 17.899999999999814, 19.09999999999983, -50.00000000000044, -50.00000000000044, 45.7, 41.30000000000001, 43.10000000000001, 46.3, 31.900000000000013, 6.8999999999996575, 7.499999999999666, 42.500000000000014, 46.9, 34.70000000000004, 41.100000000000016, 41.30000000000001, 43.7, 23.29999999999989, 38.90000000000002, 41.30000000000001, -50.00000000000044, 39.70000000000002, 38.50000000000003, 14.499999999999766, 43.50000000000001, -50.00000000000044, 17.299999999999805, 15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.7, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.7], "episode_lengths": [392, 500, 52, 156, 222, 60, 64, 138, 58, 94, 500, 94, 254, 500, 104, 54, 58, 46, 54, 160, 168, 176, 32, 368, 186, 500, 500, 98, 96, 120, 36, 222, 80, 120, 214, 82, 32, 500, 332, 140, 142, 500, 500, 116, 82, 120, 500, 500, 500, 90, 356, 88, 38, 26, 224, 64, 108, 500, 152, 146, 486, 56, 424, 322, 310, 500, 500, 44, 88, 70, 38, 182, 432, 426, 76, 32, 154, 90, 88, 64, 268, 112, 88, 500, 104, 116, 356, 66, 500, 328, 350, 500, 500, 500, 40, 64, 114, 500, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3826385822592702, "mean_inference_ms": 1.219261408876064, "mean_action_processing_ms": 0.14492532305864794, "mean_env_wait_ms": 0.08371475306047105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036653757095336914, "StateBufferConnector_ms": 0.007992982864379883, "ViewRequirementAgentConnector_ms": 0.12137985229492188}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.332999999999878, "episode_len_mean": 222.46, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.899999999999714, -50.00000000000044, 44.900000000000006, 34.50000000000004, 27.899999999999956, 44.10000000000001, 43.7, 36.30000000000003, 44.300000000000004, 40.70000000000002, -50.00000000000044, 40.70000000000002, 24.69999999999991, -50.00000000000044, 39.70000000000002, 44.7, 44.300000000000004, 45.5, 44.7, 34.10000000000004, 33.30000000000003, 32.50000000000002, 46.9, 13.299999999999748, 31.500000000000007, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.500000000000014, 38.10000000000002, 46.5, 27.899999999999956, 42.10000000000001, 38.10000000000002, 28.699999999999967, 41.90000000000001, 46.9, -50.00000000000044, 16.8999999999998, 36.10000000000004, 35.900000000000034, -50.00000000000044, -50.00000000000044, 38.50000000000003, 41.90000000000001, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 14.499999999999766, 41.30000000000001, 46.3, 47.5, 27.699999999999953, 43.7, 39.300000000000026, -50.00000000000044, 34.900000000000034, 35.500000000000036, 1.4999999999995808, 44.5, 7.699999999999669, 17.899999999999814, 19.09999999999983, -50.00000000000044, -50.00000000000044, 45.7, 41.30000000000001, 43.10000000000001, 46.3, 31.900000000000013, 6.8999999999996575, 7.499999999999666, 42.500000000000014, 46.9, 34.70000000000004, 41.100000000000016, 41.30000000000001, 43.7, 23.29999999999989, 38.90000000000002, 41.30000000000001, -50.00000000000044, 39.70000000000002, 38.50000000000003, 14.499999999999766, 43.50000000000001, -50.00000000000044, 17.299999999999805, 15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.7, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.7], "episode_lengths": [392, 500, 52, 156, 222, 60, 64, 138, 58, 94, 500, 94, 254, 500, 104, 54, 58, 46, 54, 160, 168, 176, 32, 368, 186, 500, 500, 98, 96, 120, 36, 222, 80, 120, 214, 82, 32, 500, 332, 140, 142, 500, 500, 116, 82, 120, 500, 500, 500, 90, 356, 88, 38, 26, 224, 64, 108, 500, 152, 146, 486, 56, 424, 322, 310, 500, 500, 44, 88, 70, 38, 182, 432, 426, 76, 32, 154, 90, 88, 64, 268, 112, 88, 500, 104, 116, 356, 66, 500, 328, 350, 500, 500, 500, 40, 64, 114, 500, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3826385822592702, "mean_inference_ms": 1.219261408876064, "mean_action_processing_ms": 0.14492532305864794, "mean_env_wait_ms": 0.08371475306047105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036653757095336914, "StateBufferConnector_ms": 0.007992982864379883, "ViewRequirementAgentConnector_ms": 0.12137985229492188}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5075.242109759382, "num_env_steps_trained_throughput_per_sec": 5075.242109759382, "timesteps_total": 96000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 2309.449, "sample_time_ms": 1980.859, "load_time_ms": 10.213, "load_throughput": 1174988.208, "learn_time_ms": 307.651, "learn_throughput": 39005.291, "synch_weights_time_ms": 9.851}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 342, "training_iteration": 8, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-41", "timestamp": 1698247001, "time_this_iter_s": 2.369415760040283, "time_total_s": 18.51857900619507, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 18.51857900619507, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 53.875, "ram_util_percent": 26.549999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000003, "cur_lr": 0.0003, "total_loss": 7.291666396458944, "policy_loss": -6.152341763178507e-05, "vf_loss": 7.2917852878570555, "vf_explained_var": -1.909335454305013e-06, "kl": 0.00044581515523987034, "entropy": 0.5771996299425761, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 255.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.573999999999858, "episode_len_mean": 235.0, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.300000000000026, -50.00000000000044, 34.900000000000034, 35.500000000000036, 1.4999999999995808, 44.5, 7.699999999999669, 17.899999999999814, 19.09999999999983, -50.00000000000044, -50.00000000000044, 45.7, 41.30000000000001, 43.10000000000001, 46.3, 31.900000000000013, 6.8999999999996575, 7.499999999999666, 42.500000000000014, 46.9, 34.70000000000004, 41.100000000000016, 41.30000000000001, 43.7, 23.29999999999989, 38.90000000000002, 41.30000000000001, -50.00000000000044, 39.70000000000002, 38.50000000000003, 14.499999999999766, 43.50000000000001, -50.00000000000044, 17.299999999999805, 15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.7, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.7, 43.10000000000001, 45.5, 44.900000000000006, 28.499999999999964, 40.30000000000002, -50.00000000000044, 44.300000000000004, 43.30000000000001, 28.29999999999996, 42.900000000000006, 42.30000000000001, 17.499999999999808, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 34.50000000000004, -50.00000000000044, 46.3, 6.099999999999646, -50.00000000000044, 32.700000000000024, 43.30000000000001, 32.700000000000024, 24.499999999999908, 42.70000000000001, -50.00000000000044, 42.500000000000014, 34.50000000000004, 45.5, -50.00000000000044, 38.90000000000002, 34.50000000000004, 29.099999999999973, -50.00000000000044, 40.10000000000002, 43.10000000000001, -50.00000000000044, 24.099999999999902, 42.70000000000001, 40.30000000000002, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.7, 41.70000000000002, 43.900000000000006, 45.3], "episode_lengths": [108, 500, 152, 146, 486, 56, 424, 322, 310, 500, 500, 44, 88, 70, 38, 182, 432, 426, 76, 32, 154, 90, 88, 64, 268, 112, 88, 500, 104, 116, 356, 66, 500, 328, 350, 500, 500, 500, 40, 64, 114, 500, 500, 44, 500, 54, 70, 46, 52, 216, 98, 500, 58, 68, 218, 72, 78, 326, 500, 500, 34, 500, 86, 500, 500, 66, 500, 156, 500, 38, 440, 500, 174, 68, 174, 256, 74, 500, 76, 156, 46, 500, 112, 156, 210, 500, 100, 70, 500, 260, 74, 98, 46, 500, 88, 500, 54, 84, 62, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38044929719605874, "mean_inference_ms": 1.2203388509075668, "mean_action_processing_ms": 0.14484754170618028, "mean_env_wait_ms": 0.08343503089872618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03380894660949707, "StateBufferConnector_ms": 0.004994630813598633, "ViewRequirementAgentConnector_ms": 0.12672710418701172}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.573999999999858, "episode_len_mean": 235.0, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.300000000000026, -50.00000000000044, 34.900000000000034, 35.500000000000036, 1.4999999999995808, 44.5, 7.699999999999669, 17.899999999999814, 19.09999999999983, -50.00000000000044, -50.00000000000044, 45.7, 41.30000000000001, 43.10000000000001, 46.3, 31.900000000000013, 6.8999999999996575, 7.499999999999666, 42.500000000000014, 46.9, 34.70000000000004, 41.100000000000016, 41.30000000000001, 43.7, 23.29999999999989, 38.90000000000002, 41.30000000000001, -50.00000000000044, 39.70000000000002, 38.50000000000003, 14.499999999999766, 43.50000000000001, -50.00000000000044, 17.299999999999805, 15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.7, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.7, 43.10000000000001, 45.5, 44.900000000000006, 28.499999999999964, 40.30000000000002, -50.00000000000044, 44.300000000000004, 43.30000000000001, 28.29999999999996, 42.900000000000006, 42.30000000000001, 17.499999999999808, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 34.50000000000004, -50.00000000000044, 46.3, 6.099999999999646, -50.00000000000044, 32.700000000000024, 43.30000000000001, 32.700000000000024, 24.499999999999908, 42.70000000000001, -50.00000000000044, 42.500000000000014, 34.50000000000004, 45.5, -50.00000000000044, 38.90000000000002, 34.50000000000004, 29.099999999999973, -50.00000000000044, 40.10000000000002, 43.10000000000001, -50.00000000000044, 24.099999999999902, 42.70000000000001, 40.30000000000002, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.7, 41.70000000000002, 43.900000000000006, 45.3], "episode_lengths": [108, 500, 152, 146, 486, 56, 424, 322, 310, 500, 500, 44, 88, 70, 38, 182, 432, 426, 76, 32, 154, 90, 88, 64, 268, 112, 88, 500, 104, 116, 356, 66, 500, 328, 350, 500, 500, 500, 40, 64, 114, 500, 500, 44, 500, 54, 70, 46, 52, 216, 98, 500, 58, 68, 218, 72, 78, 326, 500, 500, 34, 500, 86, 500, 500, 66, 500, 156, 500, 38, 440, 500, 174, 68, 174, 256, 74, 500, 76, 156, 46, 500, 112, 156, 210, 500, 100, 70, 500, 260, 74, 98, 46, 500, 88, 500, 54, 84, 62, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38044929719605874, "mean_inference_ms": 1.2203388509075668, "mean_action_processing_ms": 0.14484754170618028, "mean_env_wait_ms": 0.08343503089872618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03380894660949707, "StateBufferConnector_ms": 0.004994630813598633, "ViewRequirementAgentConnector_ms": 0.12672710418701172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5525.154382007621, "num_env_steps_trained_throughput_per_sec": 5525.154382007621, "timesteps_total": 108000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 2294.164, "sample_time_ms": 1971.677, "load_time_ms": 9.967, "load_throughput": 1203994.397, "learn_time_ms": 301.764, "learn_throughput": 39766.166, "synch_weights_time_ms": 9.756}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 398, "training_iteration": 9, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-43", "timestamp": 1698247003, "time_this_iter_s": 2.1775476932525635, "time_total_s": 20.696126699447632, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 20.696126699447632, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 58.333333333333336, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00039062500000000013, "cur_lr": 0.0003, "total_loss": 6.80372969309489, "policy_loss": -0.00012807324528694153, "vf_loss": 6.803915230433146, "vf_explained_var": -3.063678741455078e-06, "kl": 0.00023979258390909307, "entropy": 0.5751953353484471, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 285.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.793999999999864, "episode_len_mean": 232.78, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 44.900000000000006, 28.499999999999964, 40.30000000000002, -50.00000000000044, 44.300000000000004, 43.30000000000001, 28.29999999999996, 42.900000000000006, 42.30000000000001, 17.499999999999808, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 34.50000000000004, -50.00000000000044, 46.3, 6.099999999999646, -50.00000000000044, 32.700000000000024, 43.30000000000001, 32.700000000000024, 24.499999999999908, 42.70000000000001, -50.00000000000044, 42.500000000000014, 34.50000000000004, 45.5, -50.00000000000044, 38.90000000000002, 34.50000000000004, 29.099999999999973, -50.00000000000044, 40.10000000000002, 43.10000000000001, -50.00000000000044, 24.099999999999902, 42.70000000000001, 40.30000000000002, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.7, 41.70000000000002, 43.900000000000006, 45.3, 41.500000000000014, 46.099999999999994, 42.30000000000001, 46.099999999999994, 35.30000000000004, 38.90000000000002, 42.70000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.70000000000003, 24.69999999999991, 46.099999999999994, 38.90000000000002, -50.00000000000044, 35.10000000000004, 30.9, -50.00000000000044, -50.00000000000044, 45.1, 43.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 24.499999999999908, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.5, 15.699999999999783, 9.499999999999694, 39.300000000000026, 6.8999999999996575, -50.00000000000044, 34.10000000000004, 41.100000000000016, 39.10000000000002, -50.00000000000044, 33.30000000000003, 35.10000000000004, 34.10000000000004, 43.10000000000001, 37.10000000000003, 24.899999999999913, -50.00000000000044], "episode_lengths": [46, 52, 216, 98, 500, 58, 68, 218, 72, 78, 326, 500, 500, 34, 500, 86, 500, 500, 66, 500, 156, 500, 38, 440, 500, 174, 68, 174, 256, 74, 500, 76, 156, 46, 500, 112, 156, 210, 500, 100, 70, 500, 260, 74, 98, 46, 500, 88, 500, 54, 84, 62, 48, 86, 40, 78, 40, 148, 112, 74, 76, 500, 500, 134, 254, 40, 112, 500, 150, 192, 500, 500, 50, 68, 500, 102, 500, 256, 52, 500, 500, 40, 500, 56, 344, 406, 108, 432, 500, 160, 90, 110, 500, 168, 150, 160, 70, 130, 252, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379659573909871, "mean_inference_ms": 1.2191768840231514, "mean_action_processing_ms": 0.1447227547409954, "mean_env_wait_ms": 0.08328790602049592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02030038833618164, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.10835433006286621}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.793999999999864, "episode_len_mean": 232.78, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 44.900000000000006, 28.499999999999964, 40.30000000000002, -50.00000000000044, 44.300000000000004, 43.30000000000001, 28.29999999999996, 42.900000000000006, 42.30000000000001, 17.499999999999808, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 34.50000000000004, -50.00000000000044, 46.3, 6.099999999999646, -50.00000000000044, 32.700000000000024, 43.30000000000001, 32.700000000000024, 24.499999999999908, 42.70000000000001, -50.00000000000044, 42.500000000000014, 34.50000000000004, 45.5, -50.00000000000044, 38.90000000000002, 34.50000000000004, 29.099999999999973, -50.00000000000044, 40.10000000000002, 43.10000000000001, -50.00000000000044, 24.099999999999902, 42.70000000000001, 40.30000000000002, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.7, 41.70000000000002, 43.900000000000006, 45.3, 41.500000000000014, 46.099999999999994, 42.30000000000001, 46.099999999999994, 35.30000000000004, 38.90000000000002, 42.70000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.70000000000003, 24.69999999999991, 46.099999999999994, 38.90000000000002, -50.00000000000044, 35.10000000000004, 30.9, -50.00000000000044, -50.00000000000044, 45.1, 43.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 24.499999999999908, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.5, 15.699999999999783, 9.499999999999694, 39.300000000000026, 6.8999999999996575, -50.00000000000044, 34.10000000000004, 41.100000000000016, 39.10000000000002, -50.00000000000044, 33.30000000000003, 35.10000000000004, 34.10000000000004, 43.10000000000001, 37.10000000000003, 24.899999999999913, -50.00000000000044], "episode_lengths": [46, 52, 216, 98, 500, 58, 68, 218, 72, 78, 326, 500, 500, 34, 500, 86, 500, 500, 66, 500, 156, 500, 38, 440, 500, 174, 68, 174, 256, 74, 500, 76, 156, 46, 500, 112, 156, 210, 500, 100, 70, 500, 260, 74, 98, 46, 500, 88, 500, 54, 84, 62, 48, 86, 40, 78, 40, 148, 112, 74, 76, 500, 500, 134, 254, 40, 112, 500, 150, 192, 500, 500, 50, 68, 500, 102, 500, 256, 52, 500, 500, 40, 500, 56, 344, 406, 108, 432, 500, 160, 90, 110, 500, 168, 150, 160, 70, 130, 252, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379659573909871, "mean_inference_ms": 1.2191768840231514, "mean_action_processing_ms": 0.1447227547409954, "mean_env_wait_ms": 0.08328790602049592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02030038833618164, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.10835433006286621}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5217.307584263548, "num_env_steps_trained_throughput_per_sec": 5217.307584263548, "timesteps_total": 120000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 2294.751, "sample_time_ms": 1970.427, "load_time_ms": 9.942, "load_throughput": 1207051.849, "learn_time_ms": 303.672, "learn_throughput": 39516.348, "synch_weights_time_ms": 9.611}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 445, "training_iteration": 10, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-45", "timestamp": 1698247005, "time_this_iter_s": 2.3048503398895264, "time_total_s": 23.000977039337158, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 23.000977039337158, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 62.666666666666664, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000007, "cur_lr": 0.0003, "total_loss": 6.811871306101481, "policy_loss": -4.777610301971435e-05, "vf_loss": 6.811972014109293, "vf_explained_var": -1.8457571665445963e-06, "kl": 0.0003598781492655689, "entropy": 0.5294130822022756, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.315999999999846, "episode_len_mean": 247.54, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, -50.00000000000044, 44.7, 41.70000000000002, 43.900000000000006, 45.3, 41.500000000000014, 46.099999999999994, 42.30000000000001, 46.099999999999994, 35.30000000000004, 38.90000000000002, 42.70000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.70000000000003, 24.69999999999991, 46.099999999999994, 38.90000000000002, -50.00000000000044, 35.10000000000004, 30.9, -50.00000000000044, -50.00000000000044, 45.1, 43.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 24.499999999999908, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.5, 15.699999999999783, 9.499999999999694, 39.300000000000026, 6.8999999999996575, -50.00000000000044, 34.10000000000004, 41.100000000000016, 39.10000000000002, -50.00000000000044, 33.30000000000003, 35.10000000000004, 34.10000000000004, 43.10000000000001, 37.10000000000003, 24.899999999999913, -50.00000000000044, 5.099999999999632, 29.69999999999998, 39.10000000000002, 42.500000000000014, -50.00000000000044, 46.099999999999994, 38.10000000000002, 44.300000000000004, 40.30000000000002, -50.00000000000044, 47.5, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 44.5, -50.00000000000044, 8.299999999999677, -50.00000000000044, 40.10000000000002, 21.699999999999868, -50.00000000000044, 31.900000000000013, -50.00000000000044, 43.30000000000001, 2.499999999999595, 44.900000000000006, 46.699999999999996, 30.9, -50.00000000000044, 44.7, 40.500000000000014, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 33.30000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.89999999999997, 32.90000000000003, -50.00000000000044, 40.500000000000014], "episode_lengths": [88, 500, 54, 84, 62, 48, 86, 40, 78, 40, 148, 112, 74, 76, 500, 500, 134, 254, 40, 112, 500, 150, 192, 500, 500, 50, 68, 500, 102, 500, 256, 52, 500, 500, 40, 500, 56, 344, 406, 108, 432, 500, 160, 90, 110, 500, 168, 150, 160, 70, 130, 252, 500, 450, 204, 110, 76, 500, 40, 120, 58, 98, 500, 26, 68, 500, 54, 500, 56, 500, 418, 500, 100, 284, 500, 182, 500, 68, 476, 52, 34, 192, 500, 54, 96, 222, 500, 500, 500, 48, 168, 392, 500, 500, 52, 500, 212, 172, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792234303036482, "mean_inference_ms": 1.2174514187343062, "mean_action_processing_ms": 0.14422165474075954, "mean_env_wait_ms": 0.08355256621430464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022019624710083008, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.10095810890197754}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.315999999999846, "episode_len_mean": 247.54, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, -50.00000000000044, 44.7, 41.70000000000002, 43.900000000000006, 45.3, 41.500000000000014, 46.099999999999994, 42.30000000000001, 46.099999999999994, 35.30000000000004, 38.90000000000002, 42.70000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.70000000000003, 24.69999999999991, 46.099999999999994, 38.90000000000002, -50.00000000000044, 35.10000000000004, 30.9, -50.00000000000044, -50.00000000000044, 45.1, 43.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 24.499999999999908, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.5, 15.699999999999783, 9.499999999999694, 39.300000000000026, 6.8999999999996575, -50.00000000000044, 34.10000000000004, 41.100000000000016, 39.10000000000002, -50.00000000000044, 33.30000000000003, 35.10000000000004, 34.10000000000004, 43.10000000000001, 37.10000000000003, 24.899999999999913, -50.00000000000044, 5.099999999999632, 29.69999999999998, 39.10000000000002, 42.500000000000014, -50.00000000000044, 46.099999999999994, 38.10000000000002, 44.300000000000004, 40.30000000000002, -50.00000000000044, 47.5, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 44.5, -50.00000000000044, 8.299999999999677, -50.00000000000044, 40.10000000000002, 21.699999999999868, -50.00000000000044, 31.900000000000013, -50.00000000000044, 43.30000000000001, 2.499999999999595, 44.900000000000006, 46.699999999999996, 30.9, -50.00000000000044, 44.7, 40.500000000000014, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 33.30000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.89999999999997, 32.90000000000003, -50.00000000000044, 40.500000000000014], "episode_lengths": [88, 500, 54, 84, 62, 48, 86, 40, 78, 40, 148, 112, 74, 76, 500, 500, 134, 254, 40, 112, 500, 150, 192, 500, 500, 50, 68, 500, 102, 500, 256, 52, 500, 500, 40, 500, 56, 344, 406, 108, 432, 500, 160, 90, 110, 500, 168, 150, 160, 70, 130, 252, 500, 450, 204, 110, 76, 500, 40, 120, 58, 98, 500, 26, 68, 500, 54, 500, 56, 500, 418, 500, 100, 284, 500, 182, 500, 68, 476, 52, 34, 192, 500, 54, 96, 222, 500, 500, 500, 48, 168, 392, 500, 500, 52, 500, 212, 172, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792234303036482, "mean_inference_ms": 1.2174514187343062, "mean_action_processing_ms": 0.14422165474075954, "mean_env_wait_ms": 0.08355256621430464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022019624710083008, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.10095810890197754}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5537.836720915811, "num_env_steps_trained_throughput_per_sec": 5537.836720915811, "timesteps_total": 132000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 2299.328, "sample_time_ms": 1965.926, "load_time_ms": 9.943, "load_throughput": 1206855.038, "learn_time_ms": 312.782, "learn_throughput": 38365.379, "synch_weights_time_ms": 9.477}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 492, "training_iteration": 11, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-48", "timestamp": 1698247008, "time_this_iter_s": 2.1719088554382324, "time_total_s": 25.17288589477539, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 25.17288589477539, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 56.20000000000001, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000003e-05, "cur_lr": 0.0003, "total_loss": 6.485482438405355, "policy_loss": -8.855462074279785e-05, "vf_loss": 6.48561840057373, "vf_explained_var": 7.649262746175131e-07, "kl": 0.0003666964934192644, "entropy": 0.4746761331955592, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 345.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.343999999999813, "episode_len_mean": 277.2, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.300000000000026, 6.8999999999996575, -50.00000000000044, 34.10000000000004, 41.100000000000016, 39.10000000000002, -50.00000000000044, 33.30000000000003, 35.10000000000004, 34.10000000000004, 43.10000000000001, 37.10000000000003, 24.899999999999913, -50.00000000000044, 5.099999999999632, 29.69999999999998, 39.10000000000002, 42.500000000000014, -50.00000000000044, 46.099999999999994, 38.10000000000002, 44.300000000000004, 40.30000000000002, -50.00000000000044, 47.5, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 44.5, -50.00000000000044, 8.299999999999677, -50.00000000000044, 40.10000000000002, 21.699999999999868, -50.00000000000044, 31.900000000000013, -50.00000000000044, 43.30000000000001, 2.499999999999595, 44.900000000000006, 46.699999999999996, 30.9, -50.00000000000044, 44.7, 40.500000000000014, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 33.30000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.89999999999997, 32.90000000000003, -50.00000000000044, 40.500000000000014, 45.5, 5.099999999999632, 19.299999999999834, 47.5, -50.00000000000044, 44.900000000000006, 3.699999999999612, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 34.50000000000004, 40.90000000000002, 28.699999999999967, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 36.70000000000003, 15.299999999999777, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.90000000000003, 40.10000000000002, 42.30000000000001, -50.00000000000044, 46.9, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [108, 432, 500, 160, 90, 110, 500, 168, 150, 160, 70, 130, 252, 500, 450, 204, 110, 76, 500, 40, 120, 58, 98, 500, 26, 68, 500, 54, 500, 56, 500, 418, 500, 100, 284, 500, 182, 500, 68, 476, 52, 34, 192, 500, 54, 96, 222, 500, 500, 500, 48, 168, 392, 500, 500, 52, 500, 212, 172, 500, 96, 46, 450, 308, 26, 500, 52, 464, 46, 500, 500, 500, 500, 46, 156, 92, 214, 500, 500, 38, 500, 134, 348, 500, 116, 500, 500, 500, 62, 122, 100, 78, 500, 32, 234, 500, 500, 48, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37937916631001095, "mean_inference_ms": 1.2167872608805461, "mean_action_processing_ms": 0.14388216506988158, "mean_env_wait_ms": 0.08323176210515953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900528907775879, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.11347723007202148}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.343999999999813, "episode_len_mean": 277.2, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.300000000000026, 6.8999999999996575, -50.00000000000044, 34.10000000000004, 41.100000000000016, 39.10000000000002, -50.00000000000044, 33.30000000000003, 35.10000000000004, 34.10000000000004, 43.10000000000001, 37.10000000000003, 24.899999999999913, -50.00000000000044, 5.099999999999632, 29.69999999999998, 39.10000000000002, 42.500000000000014, -50.00000000000044, 46.099999999999994, 38.10000000000002, 44.300000000000004, 40.30000000000002, -50.00000000000044, 47.5, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 44.5, -50.00000000000044, 8.299999999999677, -50.00000000000044, 40.10000000000002, 21.699999999999868, -50.00000000000044, 31.900000000000013, -50.00000000000044, 43.30000000000001, 2.499999999999595, 44.900000000000006, 46.699999999999996, 30.9, -50.00000000000044, 44.7, 40.500000000000014, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 33.30000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.89999999999997, 32.90000000000003, -50.00000000000044, 40.500000000000014, 45.5, 5.099999999999632, 19.299999999999834, 47.5, -50.00000000000044, 44.900000000000006, 3.699999999999612, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 34.50000000000004, 40.90000000000002, 28.699999999999967, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 36.70000000000003, 15.299999999999777, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.90000000000003, 40.10000000000002, 42.30000000000001, -50.00000000000044, 46.9, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [108, 432, 500, 160, 90, 110, 500, 168, 150, 160, 70, 130, 252, 500, 450, 204, 110, 76, 500, 40, 120, 58, 98, 500, 26, 68, 500, 54, 500, 56, 500, 418, 500, 100, 284, 500, 182, 500, 68, 476, 52, 34, 192, 500, 54, 96, 222, 500, 500, 500, 48, 168, 392, 500, 500, 52, 500, 212, 172, 500, 96, 46, 450, 308, 26, 500, 52, 464, 46, 500, 500, 500, 500, 46, 156, 92, 214, 500, 500, 38, 500, 134, 348, 500, 116, 500, 500, 500, 62, 122, 100, 78, 500, 32, 234, 500, 500, 48, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37937916631001095, "mean_inference_ms": 1.2167872608805461, "mean_action_processing_ms": 0.14388216506988158, "mean_env_wait_ms": 0.08323176210515953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900528907775879, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.11347723007202148}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4986.368726772981, "num_env_steps_trained_throughput_per_sec": 4986.368726772981, "timesteps_total": 144000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 2320.562, "sample_time_ms": 1959.7, "load_time_ms": 10.824, "load_throughput": 1108651.028, "learn_time_ms": 339.34, "learn_throughput": 35362.719, "synch_weights_time_ms": 9.497}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 531, "training_iteration": 12, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-50", "timestamp": 1698247010, "time_this_iter_s": 2.41144061088562, "time_total_s": 27.58432650566101, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 27.58432650566101, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 51.225, "ram_util_percent": 26.549999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.8828125000000016e-05, "cur_lr": 0.0003, "total_loss": 6.187857516606649, "policy_loss": -0.00028450638055801394, "vf_loss": 6.188193448384603, "vf_explained_var": -4.5299530029296873e-07, "kl": 0.00049542408586755, "entropy": 0.5133254518111546, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 375.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.9699999999998035, "episode_len_mean": 280.88, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 33.30000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.89999999999997, 32.90000000000003, -50.00000000000044, 40.500000000000014, 45.5, 5.099999999999632, 19.299999999999834, 47.5, -50.00000000000044, 44.900000000000006, 3.699999999999612, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 34.50000000000004, 40.90000000000002, 28.699999999999967, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 36.70000000000003, 15.299999999999777, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.90000000000003, 40.10000000000002, 42.30000000000001, -50.00000000000044, 46.9, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 30.499999999999993, 41.90000000000001, 38.700000000000024, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 32.50000000000002, 44.900000000000006, 46.099999999999994, 42.500000000000014, -50.00000000000044, 41.100000000000016, 42.500000000000014, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, 25.29999999999992, 40.10000000000002, 43.900000000000006, -50.00000000000044, 41.30000000000001, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 43.50000000000001, 33.70000000000004, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.10000000000001, -50.00000000000044, 37.50000000000003, 44.7], "episode_lengths": [500, 500, 500, 48, 168, 392, 500, 500, 52, 500, 212, 172, 500, 96, 46, 450, 308, 26, 500, 52, 464, 46, 500, 500, 500, 500, 46, 156, 92, 214, 500, 500, 38, 500, 134, 348, 500, 116, 500, 500, 500, 62, 122, 100, 78, 500, 32, 234, 500, 500, 48, 500, 500, 196, 82, 114, 500, 36, 500, 500, 84, 500, 500, 80, 176, 52, 40, 76, 500, 90, 76, 500, 22, 500, 500, 500, 80, 44, 248, 100, 62, 500, 88, 58, 88, 500, 500, 500, 180, 500, 66, 164, 84, 500, 90, 500, 80, 500, 126, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37947795438858023, "mean_inference_ms": 1.216108373756348, "mean_action_processing_ms": 0.14322561365285774, "mean_env_wait_ms": 0.0825863600966695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02740788459777832, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.10854005813598633}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.9699999999998035, "episode_len_mean": 280.88, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 33.30000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.89999999999997, 32.90000000000003, -50.00000000000044, 40.500000000000014, 45.5, 5.099999999999632, 19.299999999999834, 47.5, -50.00000000000044, 44.900000000000006, 3.699999999999612, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 34.50000000000004, 40.90000000000002, 28.699999999999967, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 36.70000000000003, 15.299999999999777, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.90000000000003, 40.10000000000002, 42.30000000000001, -50.00000000000044, 46.9, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 30.499999999999993, 41.90000000000001, 38.700000000000024, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 32.50000000000002, 44.900000000000006, 46.099999999999994, 42.500000000000014, -50.00000000000044, 41.100000000000016, 42.500000000000014, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, 25.29999999999992, 40.10000000000002, 43.900000000000006, -50.00000000000044, 41.30000000000001, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 43.50000000000001, 33.70000000000004, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.10000000000001, -50.00000000000044, 37.50000000000003, 44.7], "episode_lengths": [500, 500, 500, 48, 168, 392, 500, 500, 52, 500, 212, 172, 500, 96, 46, 450, 308, 26, 500, 52, 464, 46, 500, 500, 500, 500, 46, 156, 92, 214, 500, 500, 38, 500, 134, 348, 500, 116, 500, 500, 500, 62, 122, 100, 78, 500, 32, 234, 500, 500, 48, 500, 500, 196, 82, 114, 500, 36, 500, 500, 84, 500, 500, 80, 176, 52, 40, 76, 500, 90, 76, 500, 22, 500, 500, 500, 80, 44, 248, 100, 62, 500, 88, 58, 88, 500, 500, 500, 180, 500, 66, 164, 84, 500, 90, 500, 80, 500, 126, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37947795438858023, "mean_inference_ms": 1.216108373756348, "mean_action_processing_ms": 0.14322561365285774, "mean_env_wait_ms": 0.0825863600966695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02740788459777832, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.10854005813598633}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5028.676203620648, "num_env_steps_trained_throughput_per_sec": 5028.676203620648, "timesteps_total": 156000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 2323.898, "sample_time_ms": 1948.178, "load_time_ms": 11.497, "load_throughput": 1043740.005, "learn_time_ms": 353.628, "learn_throughput": 33933.94, "synch_weights_time_ms": 9.294}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 578, "training_iteration": 13, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-52", "timestamp": 1698247012, "time_this_iter_s": 2.3913142681121826, "time_total_s": 29.975640773773193, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 29.975640773773193, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 58.73333333333334, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000008e-05, "cur_lr": 0.0003, "total_loss": 6.890653371810913, "policy_loss": -0.00016422742046415806, "vf_loss": 6.8908733367919925, "vf_explained_var": 7.947285970052083e-08, "kl": 0.0005340663946810764, "entropy": 0.5564784447352091, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.386999999999846, "episode_len_mean": 241.78, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.499999999999993, 41.90000000000001, 38.700000000000024, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 32.50000000000002, 44.900000000000006, 46.099999999999994, 42.500000000000014, -50.00000000000044, 41.100000000000016, 42.500000000000014, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, 25.29999999999992, 40.10000000000002, 43.900000000000006, -50.00000000000044, 41.30000000000001, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 43.50000000000001, 33.70000000000004, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.10000000000001, -50.00000000000044, 37.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 42.900000000000006, 41.30000000000001, 40.10000000000002, 37.90000000000003, 23.699999999999896, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, 27.899999999999956, 39.90000000000002, 12.499999999999737, -50.00000000000044, 42.900000000000006, 42.30000000000001, 45.1, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, 21.699999999999868, 37.50000000000003, 29.099999999999973, 35.500000000000036, 45.9, -50.00000000000044, 43.50000000000001, 47.5, 41.70000000000002, 43.30000000000001, 47.1, 45.3, 41.70000000000002, 41.70000000000002, -50.00000000000044, 34.10000000000004, -50.00000000000044, 40.70000000000002, 39.50000000000002, 36.70000000000003], "episode_lengths": [196, 82, 114, 500, 36, 500, 500, 84, 500, 500, 80, 176, 52, 40, 76, 500, 90, 76, 500, 22, 500, 500, 500, 80, 44, 248, 100, 62, 500, 88, 58, 88, 500, 500, 500, 180, 500, 66, 164, 84, 500, 90, 500, 80, 500, 126, 54, 500, 500, 96, 72, 88, 100, 122, 264, 500, 500, 168, 500, 500, 130, 222, 102, 376, 500, 72, 78, 50, 32, 500, 500, 40, 500, 34, 500, 500, 66, 38, 500, 500, 284, 126, 210, 146, 42, 500, 66, 26, 84, 68, 30, 48, 84, 84, 500, 160, 500, 94, 106, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3799180837197176, "mean_inference_ms": 1.215079767069552, "mean_action_processing_ms": 0.14250952817267415, "mean_env_wait_ms": 0.08230185328248489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021403789520263672, "StateBufferConnector_ms": 0.002000093460083008, "ViewRequirementAgentConnector_ms": 0.12901997566223145}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.386999999999846, "episode_len_mean": 241.78, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.499999999999993, 41.90000000000001, 38.700000000000024, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 32.50000000000002, 44.900000000000006, 46.099999999999994, 42.500000000000014, -50.00000000000044, 41.100000000000016, 42.500000000000014, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, 25.29999999999992, 40.10000000000002, 43.900000000000006, -50.00000000000044, 41.30000000000001, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 43.50000000000001, 33.70000000000004, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.10000000000001, -50.00000000000044, 37.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 42.900000000000006, 41.30000000000001, 40.10000000000002, 37.90000000000003, 23.699999999999896, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, 27.899999999999956, 39.90000000000002, 12.499999999999737, -50.00000000000044, 42.900000000000006, 42.30000000000001, 45.1, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, 21.699999999999868, 37.50000000000003, 29.099999999999973, 35.500000000000036, 45.9, -50.00000000000044, 43.50000000000001, 47.5, 41.70000000000002, 43.30000000000001, 47.1, 45.3, 41.70000000000002, 41.70000000000002, -50.00000000000044, 34.10000000000004, -50.00000000000044, 40.70000000000002, 39.50000000000002, 36.70000000000003], "episode_lengths": [196, 82, 114, 500, 36, 500, 500, 84, 500, 500, 80, 176, 52, 40, 76, 500, 90, 76, 500, 22, 500, 500, 500, 80, 44, 248, 100, 62, 500, 88, 58, 88, 500, 500, 500, 180, 500, 66, 164, 84, 500, 90, 500, 80, 500, 126, 54, 500, 500, 96, 72, 88, 100, 122, 264, 500, 500, 168, 500, 500, 130, 222, 102, 376, 500, 72, 78, 50, 32, 500, 500, 40, 500, 34, 500, 500, 66, 38, 500, 500, 284, 126, 210, 146, 42, 500, 66, 26, 84, 68, 30, 48, 84, 84, 500, 160, 500, 94, 106, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3799180837197176, "mean_inference_ms": 1.215079767069552, "mean_action_processing_ms": 0.14250952817267415, "mean_env_wait_ms": 0.08230185328248489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021403789520263672, "StateBufferConnector_ms": 0.002000093460083008, "ViewRequirementAgentConnector_ms": 0.12901997566223145}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5355.62197931476, "num_env_steps_trained_throughput_per_sec": 5355.62197931476, "timesteps_total": 168000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 2318.97, "sample_time_ms": 1950.881, "load_time_ms": 10.618, "load_throughput": 1130207.598, "learn_time_ms": 347.002, "learn_throughput": 34581.935, "synch_weights_time_ms": 9.094}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 631, "training_iteration": 14, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-55", "timestamp": 1698247015, "time_this_iter_s": 2.245630979537964, "time_total_s": 32.22127175331116, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 32.22127175331116, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 58.633333333333326, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000004e-05, "cur_lr": 0.0003, "total_loss": 5.9392526308695475, "policy_loss": 2.665643890698751e-05, "vf_loss": 5.9392735958099365, "vf_explained_var": 1.5099843343098958e-07, "kl": 2.9782053544143613e-05, "entropy": 0.4777333031098048, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 435.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7770000000001984, "episode_len_mean": 283.32, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 43.50000000000001, 33.70000000000004, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.10000000000001, -50.00000000000044, 37.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 42.900000000000006, 41.30000000000001, 40.10000000000002, 37.90000000000003, 23.699999999999896, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, 27.899999999999956, 39.90000000000002, 12.499999999999737, -50.00000000000044, 42.900000000000006, 42.30000000000001, 45.1, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, 21.699999999999868, 37.50000000000003, 29.099999999999973, 35.500000000000036, 45.9, -50.00000000000044, 43.50000000000001, 47.5, 41.70000000000002, 43.30000000000001, 47.1, 45.3, 41.70000000000002, 41.70000000000002, -50.00000000000044, 34.10000000000004, -50.00000000000044, 40.70000000000002, 39.50000000000002, 36.70000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 40.70000000000002, 27.49999999999995, -50.00000000000044, -50.00000000000044, 46.9, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 44.900000000000006, -50.00000000000044], "episode_lengths": [88, 500, 500, 500, 180, 500, 66, 164, 84, 500, 90, 500, 80, 500, 126, 54, 500, 500, 96, 72, 88, 100, 122, 264, 500, 500, 168, 500, 500, 130, 222, 102, 376, 500, 72, 78, 50, 32, 500, 500, 40, 500, 34, 500, 500, 66, 38, 500, 500, 284, 126, 210, 146, 42, 500, 66, 26, 84, 68, 30, 48, 84, 84, 500, 160, 500, 94, 106, 134, 82, 500, 500, 114, 500, 500, 500, 500, 500, 58, 500, 500, 94, 226, 500, 500, 32, 46, 500, 500, 60, 500, 500, 500, 500, 500, 500, 500, 194, 52, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3809313416875877, "mean_inference_ms": 1.2154021274375484, "mean_action_processing_ms": 0.1428228894552993, "mean_env_wait_ms": 0.08250896901317871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02582263946533203, "StateBufferConnector_ms": 0.002000093460083008, "ViewRequirementAgentConnector_ms": 0.12207555770874023}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7770000000001984, "episode_len_mean": 283.32, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 43.50000000000001, 33.70000000000004, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.10000000000001, -50.00000000000044, 37.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 42.900000000000006, 41.30000000000001, 40.10000000000002, 37.90000000000003, 23.699999999999896, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, 27.899999999999956, 39.90000000000002, 12.499999999999737, -50.00000000000044, 42.900000000000006, 42.30000000000001, 45.1, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, 21.699999999999868, 37.50000000000003, 29.099999999999973, 35.500000000000036, 45.9, -50.00000000000044, 43.50000000000001, 47.5, 41.70000000000002, 43.30000000000001, 47.1, 45.3, 41.70000000000002, 41.70000000000002, -50.00000000000044, 34.10000000000004, -50.00000000000044, 40.70000000000002, 39.50000000000002, 36.70000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 40.70000000000002, 27.49999999999995, -50.00000000000044, -50.00000000000044, 46.9, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 44.900000000000006, -50.00000000000044], "episode_lengths": [88, 500, 500, 500, 180, 500, 66, 164, 84, 500, 90, 500, 80, 500, 126, 54, 500, 500, 96, 72, 88, 100, 122, 264, 500, 500, 168, 500, 500, 130, 222, 102, 376, 500, 72, 78, 50, 32, 500, 500, 40, 500, 34, 500, 500, 66, 38, 500, 500, 284, 126, 210, 146, 42, 500, 66, 26, 84, 68, 30, 48, 84, 84, 500, 160, 500, 94, 106, 134, 82, 500, 500, 114, 500, 500, 500, 500, 500, 58, 500, 500, 94, 226, 500, 500, 32, 46, 500, 500, 60, 500, 500, 500, 500, 500, 500, 500, 194, 52, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3809313416875877, "mean_inference_ms": 1.2154021274375484, "mean_action_processing_ms": 0.1428228894552993, "mean_env_wait_ms": 0.08250896901317871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02582263946533203, "StateBufferConnector_ms": 0.002000093460083008, "ViewRequirementAgentConnector_ms": 0.12207555770874023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4903.2091636838895, "num_env_steps_trained_throughput_per_sec": 4903.2091636838895, "timesteps_total": 180000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 2338.777, "sample_time_ms": 1955.442, "load_time_ms": 11.622, "load_throughput": 1032482.184, "learn_time_ms": 361.502, "learn_throughput": 33194.806, "synch_weights_time_ms": 8.835}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 662, "training_iteration": 15, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-57", "timestamp": 1698247017, "time_this_iter_s": 2.452376365661621, "time_total_s": 34.67364811897278, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 34.67364811897278, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 54.400000000000006, "ram_util_percent": 26.549999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000002e-06, "cur_lr": 0.0003, "total_loss": 6.677062606811523, "policy_loss": -0.0005028583109378815, "vf_loss": 6.677619043986002, "vf_explained_var": -4.867712656656901e-07, "kl": 0.0007695981020515792, "entropy": 0.534978007276853, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.01000000000019817, "episode_len_mean": 280.66, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 21.699999999999868, 37.50000000000003, 29.099999999999973, 35.500000000000036, 45.9, -50.00000000000044, 43.50000000000001, 47.5, 41.70000000000002, 43.30000000000001, 47.1, 45.3, 41.70000000000002, 41.70000000000002, -50.00000000000044, 34.10000000000004, -50.00000000000044, 40.70000000000002, 39.50000000000002, 36.70000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 40.70000000000002, 27.49999999999995, -50.00000000000044, -50.00000000000044, 46.9, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 39.10000000000002, 42.10000000000001, 39.10000000000002, 41.100000000000016, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 44.10000000000001, 42.10000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.499999999999652, 42.900000000000006, -50.00000000000044, 42.30000000000001, 44.7, -50.00000000000044, 43.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, 37.10000000000003, 8.299999999999677, 30.29999999999999, 26.69999999999994, 43.50000000000001, 36.900000000000034, 42.70000000000001], "episode_lengths": [500, 284, 126, 210, 146, 42, 500, 66, 26, 84, 68, 30, 48, 84, 84, 500, 160, 500, 94, 106, 134, 82, 500, 500, 114, 500, 500, 500, 500, 500, 58, 500, 500, 94, 226, 500, 500, 32, 46, 500, 500, 60, 500, 500, 500, 500, 500, 500, 500, 194, 52, 500, 500, 110, 46, 500, 62, 500, 500, 56, 110, 80, 110, 90, 500, 54, 500, 46, 60, 80, 112, 500, 500, 500, 436, 72, 500, 78, 54, 500, 64, 86, 500, 500, 500, 500, 500, 56, 500, 80, 500, 500, 122, 130, 418, 198, 234, 66, 132, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3822675104903644, "mean_inference_ms": 1.2162304520976006, "mean_action_processing_ms": 0.14323246578543108, "mean_env_wait_ms": 0.08287506543557707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300262451171875, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.10699343681335449}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.01000000000019817, "episode_len_mean": 280.66, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 21.699999999999868, 37.50000000000003, 29.099999999999973, 35.500000000000036, 45.9, -50.00000000000044, 43.50000000000001, 47.5, 41.70000000000002, 43.30000000000001, 47.1, 45.3, 41.70000000000002, 41.70000000000002, -50.00000000000044, 34.10000000000004, -50.00000000000044, 40.70000000000002, 39.50000000000002, 36.70000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 40.70000000000002, 27.49999999999995, -50.00000000000044, -50.00000000000044, 46.9, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 39.10000000000002, 42.10000000000001, 39.10000000000002, 41.100000000000016, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 44.10000000000001, 42.10000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.499999999999652, 42.900000000000006, -50.00000000000044, 42.30000000000001, 44.7, -50.00000000000044, 43.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, 37.10000000000003, 8.299999999999677, 30.29999999999999, 26.69999999999994, 43.50000000000001, 36.900000000000034, 42.70000000000001], "episode_lengths": [500, 284, 126, 210, 146, 42, 500, 66, 26, 84, 68, 30, 48, 84, 84, 500, 160, 500, 94, 106, 134, 82, 500, 500, 114, 500, 500, 500, 500, 500, 58, 500, 500, 94, 226, 500, 500, 32, 46, 500, 500, 60, 500, 500, 500, 500, 500, 500, 500, 194, 52, 500, 500, 110, 46, 500, 62, 500, 500, 56, 110, 80, 110, 90, 500, 54, 500, 46, 60, 80, 112, 500, 500, 500, 436, 72, 500, 78, 54, 500, 64, 86, 500, 500, 500, 500, 500, 56, 500, 80, 500, 500, 122, 130, 418, 198, 234, 66, 132, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3822675104903644, "mean_inference_ms": 1.2162304520976006, "mean_action_processing_ms": 0.14323246578543108, "mean_env_wait_ms": 0.08287506543557707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300262451171875, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.10699343681335449}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5263.051191927561, "num_env_steps_trained_throughput_per_sec": 5263.051191927561, "timesteps_total": 192000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 2302.089, "sample_time_ms": 1929.037, "load_time_ms": 11.006, "load_throughput": 1090321.692, "learn_time_ms": 351.464, "learn_throughput": 34142.861, "synch_weights_time_ms": 9.106}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 710, "training_iteration": 16, "trial_id": "9f288_00009", "date": "2023-10-25_16-16-59", "timestamp": 1698247019, "time_this_iter_s": 2.284865379333496, "time_total_s": 36.958513498306274, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 36.958513498306274, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 63.56666666666666, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.051757812500001e-06, "cur_lr": 0.0003, "total_loss": 6.725992965698242, "policy_loss": -9.12459605994324e-05, "vf_loss": 6.726141277949015, "vf_explained_var": -6.516774495442708e-07, "kl": 0.0003718705267488076, "entropy": 0.5708193083604177, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.771999999999824, "episode_len_mean": 262.92, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 39.10000000000002, 42.10000000000001, 39.10000000000002, 41.100000000000016, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 44.10000000000001, 42.10000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.499999999999652, 42.900000000000006, -50.00000000000044, 42.30000000000001, 44.7, -50.00000000000044, 43.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, 37.10000000000003, 8.299999999999677, 30.29999999999999, 26.69999999999994, 43.50000000000001, 36.900000000000034, 42.70000000000001, -50.00000000000044, 44.7, 38.90000000000002, 42.500000000000014, 37.90000000000003, 45.1, 32.700000000000024, -50.00000000000044, -50.00000000000044, 28.89999999999997, 45.5, 45.5, 24.69999999999991, 45.7, 43.50000000000001, 16.699999999999797, 15.299999999999777, 23.699999999999896, 42.30000000000001, 22.099999999999874, 24.099999999999902, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 24.69999999999991, 41.30000000000001, 40.70000000000002, 39.50000000000002, 6.299999999999649, 43.10000000000001, 43.7, 39.10000000000002, -50.00000000000044, 44.300000000000004, 38.700000000000024, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 194, 52, 500, 500, 110, 46, 500, 62, 500, 500, 56, 110, 80, 110, 90, 500, 54, 500, 46, 60, 80, 112, 500, 500, 500, 436, 72, 500, 78, 54, 500, 64, 86, 500, 500, 500, 500, 500, 56, 500, 80, 500, 500, 122, 130, 418, 198, 234, 66, 132, 74, 500, 54, 112, 76, 122, 50, 174, 500, 500, 212, 46, 46, 254, 44, 66, 334, 348, 264, 78, 280, 260, 500, 60, 500, 38, 112, 500, 500, 500, 500, 68, 254, 88, 94, 106, 438, 70, 64, 110, 500, 58, 114, 500, 236, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38357700304706827, "mean_inference_ms": 1.2190024652708271, "mean_action_processing_ms": 0.1434415584897082, "mean_env_wait_ms": 0.0832429213271452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032993316650390625, "StateBufferConnector_ms": 0.007002592086791992, "ViewRequirementAgentConnector_ms": 0.10699462890625}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.771999999999824, "episode_len_mean": 262.92, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 39.10000000000002, 42.10000000000001, 39.10000000000002, 41.100000000000016, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 44.10000000000001, 42.10000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.499999999999652, 42.900000000000006, -50.00000000000044, 42.30000000000001, 44.7, -50.00000000000044, 43.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, 37.10000000000003, 8.299999999999677, 30.29999999999999, 26.69999999999994, 43.50000000000001, 36.900000000000034, 42.70000000000001, -50.00000000000044, 44.7, 38.90000000000002, 42.500000000000014, 37.90000000000003, 45.1, 32.700000000000024, -50.00000000000044, -50.00000000000044, 28.89999999999997, 45.5, 45.5, 24.69999999999991, 45.7, 43.50000000000001, 16.699999999999797, 15.299999999999777, 23.699999999999896, 42.30000000000001, 22.099999999999874, 24.099999999999902, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 24.69999999999991, 41.30000000000001, 40.70000000000002, 39.50000000000002, 6.299999999999649, 43.10000000000001, 43.7, 39.10000000000002, -50.00000000000044, 44.300000000000004, 38.700000000000024, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 194, 52, 500, 500, 110, 46, 500, 62, 500, 500, 56, 110, 80, 110, 90, 500, 54, 500, 46, 60, 80, 112, 500, 500, 500, 436, 72, 500, 78, 54, 500, 64, 86, 500, 500, 500, 500, 500, 56, 500, 80, 500, 500, 122, 130, 418, 198, 234, 66, 132, 74, 500, 54, 112, 76, 122, 50, 174, 500, 500, 212, 46, 46, 254, 44, 66, 334, 348, 264, 78, 280, 260, 500, 60, 500, 38, 112, 500, 500, 500, 500, 68, 254, 88, 94, 106, 438, 70, 64, 110, 500, 58, 114, 500, 236, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38357700304706827, "mean_inference_ms": 1.2190024652708271, "mean_action_processing_ms": 0.1434415584897082, "mean_env_wait_ms": 0.0832429213271452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032993316650390625, "StateBufferConnector_ms": 0.007002592086791992, "ViewRequirementAgentConnector_ms": 0.10699462890625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4855.476688397421, "num_env_steps_trained_throughput_per_sec": 4855.476688397421, "timesteps_total": 204000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 2323.562, "sample_time_ms": 1933.369, "load_time_ms": 12.106, "load_throughput": 991242.922, "learn_time_ms": 367.509, "learn_throughput": 32652.242, "synch_weights_time_ms": 9.002}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 756, "training_iteration": 17, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-02", "timestamp": 1698247022, "time_this_iter_s": 2.476436138153076, "time_total_s": 39.43494963645935, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 39.43494963645935, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 63.366666666666674, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500005e-06, "cur_lr": 0.0003, "total_loss": 6.734025446573893, "policy_loss": -0.0004934186736742656, "vf_loss": 6.734577608108521, "vf_explained_var": 1.7881393432617187e-08, "kl": 0.0011485521098904884, "entropy": 0.5874883552392324, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 525.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.701999999999833, "episode_len_mean": 263.66, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, 37.10000000000003, 8.299999999999677, 30.29999999999999, 26.69999999999994, 43.50000000000001, 36.900000000000034, 42.70000000000001, -50.00000000000044, 44.7, 38.90000000000002, 42.500000000000014, 37.90000000000003, 45.1, 32.700000000000024, -50.00000000000044, -50.00000000000044, 28.89999999999997, 45.5, 45.5, 24.69999999999991, 45.7, 43.50000000000001, 16.699999999999797, 15.299999999999777, 23.699999999999896, 42.30000000000001, 22.099999999999874, 24.099999999999902, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 24.69999999999991, 41.30000000000001, 40.70000000000002, 39.50000000000002, 6.299999999999649, 43.10000000000001, 43.7, 39.10000000000002, -50.00000000000044, 44.300000000000004, 38.700000000000024, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 19.499999999999837, 38.300000000000026, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 38.50000000000003, 40.70000000000002, 46.099999999999994, -50.00000000000044, 28.09999999999996, 37.90000000000003, 30.099999999999987, 47.1, 38.50000000000003, 44.900000000000006, 4.899999999999629, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 18.899999999999828, -50.00000000000044, 38.300000000000026, 18.099999999999817, 41.30000000000001, -50.00000000000044, 21.699999999999868, 44.300000000000004, 37.300000000000026, 5.099999999999632], "episode_lengths": [56, 500, 80, 500, 500, 122, 130, 418, 198, 234, 66, 132, 74, 500, 54, 112, 76, 122, 50, 174, 500, 500, 212, 46, 46, 254, 44, 66, 334, 348, 264, 78, 280, 260, 500, 60, 500, 38, 112, 500, 500, 500, 500, 68, 254, 88, 94, 106, 438, 70, 64, 110, 500, 58, 114, 500, 236, 500, 500, 500, 54, 500, 500, 500, 62, 500, 306, 118, 500, 142, 500, 500, 500, 500, 172, 116, 94, 40, 500, 220, 122, 200, 30, 116, 52, 452, 500, 500, 72, 500, 312, 500, 118, 320, 88, 500, 284, 58, 128, 450]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3843077771609593, "mean_inference_ms": 1.222259153649717, "mean_action_processing_ms": 0.14380659943009572, "mean_env_wait_ms": 0.08371625664206359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0319828987121582, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.1089932918548584}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.701999999999833, "episode_len_mean": 263.66, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, 37.10000000000003, 8.299999999999677, 30.29999999999999, 26.69999999999994, 43.50000000000001, 36.900000000000034, 42.70000000000001, -50.00000000000044, 44.7, 38.90000000000002, 42.500000000000014, 37.90000000000003, 45.1, 32.700000000000024, -50.00000000000044, -50.00000000000044, 28.89999999999997, 45.5, 45.5, 24.69999999999991, 45.7, 43.50000000000001, 16.699999999999797, 15.299999999999777, 23.699999999999896, 42.30000000000001, 22.099999999999874, 24.099999999999902, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 24.69999999999991, 41.30000000000001, 40.70000000000002, 39.50000000000002, 6.299999999999649, 43.10000000000001, 43.7, 39.10000000000002, -50.00000000000044, 44.300000000000004, 38.700000000000024, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 19.499999999999837, 38.300000000000026, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 38.50000000000003, 40.70000000000002, 46.099999999999994, -50.00000000000044, 28.09999999999996, 37.90000000000003, 30.099999999999987, 47.1, 38.50000000000003, 44.900000000000006, 4.899999999999629, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 18.899999999999828, -50.00000000000044, 38.300000000000026, 18.099999999999817, 41.30000000000001, -50.00000000000044, 21.699999999999868, 44.300000000000004, 37.300000000000026, 5.099999999999632], "episode_lengths": [56, 500, 80, 500, 500, 122, 130, 418, 198, 234, 66, 132, 74, 500, 54, 112, 76, 122, 50, 174, 500, 500, 212, 46, 46, 254, 44, 66, 334, 348, 264, 78, 280, 260, 500, 60, 500, 38, 112, 500, 500, 500, 500, 68, 254, 88, 94, 106, 438, 70, 64, 110, 500, 58, 114, 500, 236, 500, 500, 500, 54, 500, 500, 500, 62, 500, 306, 118, 500, 142, 500, 500, 500, 500, 172, 116, 94, 40, 500, 220, 122, 200, 30, 116, 52, 452, 500, 500, 72, 500, 312, 500, 118, 320, 88, 500, 284, 58, 128, 450]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3843077771609593, "mean_inference_ms": 1.222259153649717, "mean_action_processing_ms": 0.14380659943009572, "mean_env_wait_ms": 0.08371625664206359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0319828987121582, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.1089932918548584}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5252.083181591744, "num_env_steps_trained_throughput_per_sec": 5252.083181591744, "timesteps_total": 216000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 2315.601, "sample_time_ms": 1933.458, "load_time_ms": 11.631, "load_throughput": 1031762.569, "learn_time_ms": 359.916, "learn_throughput": 33341.096, "synch_weights_time_ms": 9.021}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 797, "training_iteration": 18, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-04", "timestamp": 1698247024, "time_this_iter_s": 2.289808750152588, "time_total_s": 41.72475838661194, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 41.72475838661194, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 55.400000000000006, "ram_util_percent": 26.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250003e-07, "cur_lr": 0.0003, "total_loss": 6.821365388234456, "policy_loss": -0.00019789387782414753, "vf_loss": 6.821623675028483, "vf_explained_var": -8.424123128255208e-07, "kl": 0.0008637975746448016, "entropy": 0.6044517616430919, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 555.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5989999999998132, "episode_len_mean": 279.64, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, 40.70000000000002, 39.50000000000002, 6.299999999999649, 43.10000000000001, 43.7, 39.10000000000002, -50.00000000000044, 44.300000000000004, 38.700000000000024, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 19.499999999999837, 38.300000000000026, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 38.50000000000003, 40.70000000000002, 46.099999999999994, -50.00000000000044, 28.09999999999996, 37.90000000000003, 30.099999999999987, 47.1, 38.50000000000003, 44.900000000000006, 4.899999999999629, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 18.899999999999828, -50.00000000000044, 38.300000000000026, 18.099999999999817, 41.30000000000001, -50.00000000000044, 21.699999999999868, 44.300000000000004, 37.300000000000026, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, 45.3, -50.00000000000044, 17.099999999999802, 38.90000000000002, 35.500000000000036, 30.29999999999999, 45.7, 31.1, 41.500000000000014, 36.70000000000003, 45.1, 43.30000000000001, 39.50000000000002, 40.70000000000002, -50.00000000000044, 42.500000000000014, 42.30000000000001, -50.00000000000044, 43.50000000000001, 40.90000000000002, 35.70000000000003, 41.90000000000001, -50.00000000000044, 26.09999999999993, 41.30000000000001, -50.00000000000044, -50.00000000000044, 7.499999999999666, 25.499999999999922], "episode_lengths": [88, 94, 106, 438, 70, 64, 110, 500, 58, 114, 500, 236, 500, 500, 500, 54, 500, 500, 500, 62, 500, 306, 118, 500, 142, 500, 500, 500, 500, 172, 116, 94, 40, 500, 220, 122, 200, 30, 116, 52, 452, 500, 500, 72, 500, 312, 500, 118, 320, 88, 500, 284, 58, 128, 450, 500, 500, 500, 500, 122, 500, 46, 500, 500, 46, 500, 142, 500, 500, 460, 500, 48, 500, 330, 112, 146, 198, 44, 190, 86, 134, 50, 68, 106, 94, 500, 76, 78, 500, 66, 92, 144, 82, 500, 240, 88, 500, 500, 426, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3846555030718969, "mean_inference_ms": 1.2224498087401838, "mean_action_processing_ms": 0.14418238660931623, "mean_env_wait_ms": 0.08406669753536229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031992435455322266, "StateBufferConnector_ms": 0.0020008087158203125, "ViewRequirementAgentConnector_ms": 0.125993013381958}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5989999999998132, "episode_len_mean": 279.64, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, 40.70000000000002, 39.50000000000002, 6.299999999999649, 43.10000000000001, 43.7, 39.10000000000002, -50.00000000000044, 44.300000000000004, 38.700000000000024, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 19.499999999999837, 38.300000000000026, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 38.50000000000003, 40.70000000000002, 46.099999999999994, -50.00000000000044, 28.09999999999996, 37.90000000000003, 30.099999999999987, 47.1, 38.50000000000003, 44.900000000000006, 4.899999999999629, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 18.899999999999828, -50.00000000000044, 38.300000000000026, 18.099999999999817, 41.30000000000001, -50.00000000000044, 21.699999999999868, 44.300000000000004, 37.300000000000026, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, 45.3, -50.00000000000044, 17.099999999999802, 38.90000000000002, 35.500000000000036, 30.29999999999999, 45.7, 31.1, 41.500000000000014, 36.70000000000003, 45.1, 43.30000000000001, 39.50000000000002, 40.70000000000002, -50.00000000000044, 42.500000000000014, 42.30000000000001, -50.00000000000044, 43.50000000000001, 40.90000000000002, 35.70000000000003, 41.90000000000001, -50.00000000000044, 26.09999999999993, 41.30000000000001, -50.00000000000044, -50.00000000000044, 7.499999999999666, 25.499999999999922], "episode_lengths": [88, 94, 106, 438, 70, 64, 110, 500, 58, 114, 500, 236, 500, 500, 500, 54, 500, 500, 500, 62, 500, 306, 118, 500, 142, 500, 500, 500, 500, 172, 116, 94, 40, 500, 220, 122, 200, 30, 116, 52, 452, 500, 500, 72, 500, 312, 500, 118, 320, 88, 500, 284, 58, 128, 450, 500, 500, 500, 500, 122, 500, 46, 500, 500, 46, 500, 142, 500, 500, 460, 500, 48, 500, 330, 112, 146, 198, 44, 190, 86, 134, 50, 68, 106, 94, 500, 76, 78, 500, 66, 92, 144, 82, 500, 240, 88, 500, 500, 426, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3846555030718969, "mean_inference_ms": 1.2224498087401838, "mean_action_processing_ms": 0.14418238660931623, "mean_env_wait_ms": 0.08406669753536229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031992435455322266, "StateBufferConnector_ms": 0.0020008087158203125, "ViewRequirementAgentConnector_ms": 0.125993013381958}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5192.4911999801925, "num_env_steps_trained_throughput_per_sec": 5192.4911999801925, "timesteps_total": 228000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 2329.516, "sample_time_ms": 1936.97, "load_time_ms": 12.831, "load_throughput": 935263.038, "learn_time_ms": 369.06, "learn_throughput": 32515.039, "synch_weights_time_ms": 8.98}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 842, "training_iteration": 19, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-07", "timestamp": 1698247027, "time_this_iter_s": 2.3160297870635986, "time_total_s": 44.04078817367554, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 44.04078817367554, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 62.333333333333336, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.8146972656250013e-07, "cur_lr": 0.0003, "total_loss": 6.899493646621704, "policy_loss": -0.0008565450708071391, "vf_loss": 6.90041036605835, "vf_explained_var": -2.197424570719401e-06, "kl": 0.0017392994198265417, "entropy": 0.6026153445243836, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.952999999999821, "episode_len_mean": 276.12, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 18.899999999999828, -50.00000000000044, 38.300000000000026, 18.099999999999817, 41.30000000000001, -50.00000000000044, 21.699999999999868, 44.300000000000004, 37.300000000000026, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, 45.3, -50.00000000000044, 17.099999999999802, 38.90000000000002, 35.500000000000036, 30.29999999999999, 45.7, 31.1, 41.500000000000014, 36.70000000000003, 45.1, 43.30000000000001, 39.50000000000002, 40.70000000000002, -50.00000000000044, 42.500000000000014, 42.30000000000001, -50.00000000000044, 43.50000000000001, 40.90000000000002, 35.70000000000003, 41.90000000000001, -50.00000000000044, 26.09999999999993, 41.30000000000001, -50.00000000000044, -50.00000000000044, 7.499999999999666, 25.499999999999922, 42.70000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 12.899999999999743, 0.09999999999956088, 40.30000000000002, 44.300000000000004, -50.00000000000044, 38.10000000000002, 35.10000000000004, -50.00000000000044, 46.099999999999994, 47.3, -50.00000000000044, 39.300000000000026, 45.3, 34.10000000000004, 33.30000000000003, 18.699999999999825, 38.90000000000002, -50.00000000000044, -50.00000000000044, 31.1, 12.099999999999731, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, 42.10000000000001, 26.499999999999936, 36.10000000000004, 20.49999999999985, 44.7, 37.300000000000026, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 312, 500, 118, 320, 88, 500, 284, 58, 128, 450, 500, 500, 500, 500, 122, 500, 46, 500, 500, 46, 500, 142, 500, 500, 460, 500, 48, 500, 330, 112, 146, 198, 44, 190, 86, 134, 50, 68, 106, 94, 500, 76, 78, 500, 66, 92, 144, 82, 500, 240, 88, 500, 500, 426, 246, 74, 40, 500, 500, 372, 500, 98, 58, 500, 120, 150, 500, 40, 28, 500, 108, 48, 160, 168, 314, 112, 500, 500, 190, 380, 500, 84, 500, 68, 64, 500, 80, 236, 140, 296, 54, 128, 500, 500, 180, 500, 104, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3846323491507816, "mean_inference_ms": 1.222146615200999, "mean_action_processing_ms": 0.14419479364391122, "mean_env_wait_ms": 0.08391272061277234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0259857177734375, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.12697315216064453}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.952999999999821, "episode_len_mean": 276.12, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 18.899999999999828, -50.00000000000044, 38.300000000000026, 18.099999999999817, 41.30000000000001, -50.00000000000044, 21.699999999999868, 44.300000000000004, 37.300000000000026, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, 45.3, -50.00000000000044, 17.099999999999802, 38.90000000000002, 35.500000000000036, 30.29999999999999, 45.7, 31.1, 41.500000000000014, 36.70000000000003, 45.1, 43.30000000000001, 39.50000000000002, 40.70000000000002, -50.00000000000044, 42.500000000000014, 42.30000000000001, -50.00000000000044, 43.50000000000001, 40.90000000000002, 35.70000000000003, 41.90000000000001, -50.00000000000044, 26.09999999999993, 41.30000000000001, -50.00000000000044, -50.00000000000044, 7.499999999999666, 25.499999999999922, 42.70000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 12.899999999999743, 0.09999999999956088, 40.30000000000002, 44.300000000000004, -50.00000000000044, 38.10000000000002, 35.10000000000004, -50.00000000000044, 46.099999999999994, 47.3, -50.00000000000044, 39.300000000000026, 45.3, 34.10000000000004, 33.30000000000003, 18.699999999999825, 38.90000000000002, -50.00000000000044, -50.00000000000044, 31.1, 12.099999999999731, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, 42.10000000000001, 26.499999999999936, 36.10000000000004, 20.49999999999985, 44.7, 37.300000000000026, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 312, 500, 118, 320, 88, 500, 284, 58, 128, 450, 500, 500, 500, 500, 122, 500, 46, 500, 500, 46, 500, 142, 500, 500, 460, 500, 48, 500, 330, 112, 146, 198, 44, 190, 86, 134, 50, 68, 106, 94, 500, 76, 78, 500, 66, 92, 144, 82, 500, 240, 88, 500, 500, 426, 246, 74, 40, 500, 500, 372, 500, 98, 58, 500, 120, 150, 500, 40, 28, 500, 108, 48, 160, 168, 314, 112, 500, 500, 190, 380, 500, 84, 500, 68, 64, 500, 80, 236, 140, 296, 54, 128, 500, 500, 180, 500, 104, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3846323491507816, "mean_inference_ms": 1.222146615200999, "mean_action_processing_ms": 0.14419479364391122, "mean_env_wait_ms": 0.08391272061277234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0259857177734375, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.12697315216064453}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5354.009152470976, "num_env_steps_trained_throughput_per_sec": 5354.009152470976, "timesteps_total": 240000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 2323.643, "sample_time_ms": 1933.704, "load_time_ms": 12.559, "load_throughput": 955482.177, "learn_time_ms": 366.855, "learn_throughput": 32710.49, "synch_weights_time_ms": 9.05}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 886, "training_iteration": 20, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-09", "timestamp": 1698247029, "time_this_iter_s": 2.247309684753418, "time_total_s": 46.288097858428955, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 46.288097858428955, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 57.833333333333336, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125006e-07, "cur_lr": 0.0003, "total_loss": 6.5454455057779946, "policy_loss": -7.256036624312401e-05, "vf_loss": 6.54557417233785, "vf_explained_var": -2.3305416107177735e-06, "kl": 0.0004318674569134373, "entropy": 0.5627301881710688, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 615.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.632999999999837, "episode_len_mean": 259.36, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.70000000000003, 41.90000000000001, -50.00000000000044, 26.09999999999993, 41.30000000000001, -50.00000000000044, -50.00000000000044, 7.499999999999666, 25.499999999999922, 42.70000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 12.899999999999743, 0.09999999999956088, 40.30000000000002, 44.300000000000004, -50.00000000000044, 38.10000000000002, 35.10000000000004, -50.00000000000044, 46.099999999999994, 47.3, -50.00000000000044, 39.300000000000026, 45.3, 34.10000000000004, 33.30000000000003, 18.699999999999825, 38.90000000000002, -50.00000000000044, -50.00000000000044, 31.1, 12.099999999999731, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, 42.10000000000001, 26.499999999999936, 36.10000000000004, 20.49999999999985, 44.7, 37.300000000000026, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 33.10000000000003, 45.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, 36.900000000000034, 37.50000000000003, 36.900000000000034, -50.00000000000044, -50.00000000000044, 36.50000000000003, 5.099999999999632, 46.099999999999994, 14.899999999999771, 46.3, 39.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.099999999999994, 23.499999999999893, -50.00000000000044, 44.900000000000006, 31.300000000000004, 25.499999999999922, 11.29999999999972, 40.30000000000002, -50.00000000000044, 44.5, -50.00000000000044, 41.100000000000016, 34.10000000000004, 46.3, 37.10000000000003, 42.30000000000001, 42.500000000000014, 42.10000000000001, 45.3, 20.49999999999985, 14.299999999999763, -50.00000000000044, 42.10000000000001, 44.10000000000001, -50.00000000000044], "episode_lengths": [144, 82, 500, 240, 88, 500, 500, 426, 246, 74, 40, 500, 500, 372, 500, 98, 58, 500, 120, 150, 500, 40, 28, 500, 108, 48, 160, 168, 314, 112, 500, 500, 190, 380, 500, 84, 500, 68, 64, 500, 80, 236, 140, 296, 54, 128, 500, 500, 180, 500, 104, 500, 500, 500, 500, 108, 170, 46, 86, 500, 500, 132, 126, 132, 500, 500, 136, 450, 40, 352, 38, 102, 500, 70, 500, 40, 266, 500, 52, 188, 246, 388, 98, 500, 56, 500, 90, 160, 38, 130, 78, 76, 80, 48, 296, 358, 500, 80, 60, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38509093936755756, "mean_inference_ms": 1.225764523961417, "mean_action_processing_ms": 0.14397494610292666, "mean_env_wait_ms": 0.08337917524754665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399277687072754, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.12197613716125488}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.632999999999837, "episode_len_mean": 259.36, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.70000000000003, 41.90000000000001, -50.00000000000044, 26.09999999999993, 41.30000000000001, -50.00000000000044, -50.00000000000044, 7.499999999999666, 25.499999999999922, 42.70000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 12.899999999999743, 0.09999999999956088, 40.30000000000002, 44.300000000000004, -50.00000000000044, 38.10000000000002, 35.10000000000004, -50.00000000000044, 46.099999999999994, 47.3, -50.00000000000044, 39.300000000000026, 45.3, 34.10000000000004, 33.30000000000003, 18.699999999999825, 38.90000000000002, -50.00000000000044, -50.00000000000044, 31.1, 12.099999999999731, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, 42.10000000000001, 26.499999999999936, 36.10000000000004, 20.49999999999985, 44.7, 37.300000000000026, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 33.10000000000003, 45.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, 36.900000000000034, 37.50000000000003, 36.900000000000034, -50.00000000000044, -50.00000000000044, 36.50000000000003, 5.099999999999632, 46.099999999999994, 14.899999999999771, 46.3, 39.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.099999999999994, 23.499999999999893, -50.00000000000044, 44.900000000000006, 31.300000000000004, 25.499999999999922, 11.29999999999972, 40.30000000000002, -50.00000000000044, 44.5, -50.00000000000044, 41.100000000000016, 34.10000000000004, 46.3, 37.10000000000003, 42.30000000000001, 42.500000000000014, 42.10000000000001, 45.3, 20.49999999999985, 14.299999999999763, -50.00000000000044, 42.10000000000001, 44.10000000000001, -50.00000000000044], "episode_lengths": [144, 82, 500, 240, 88, 500, 500, 426, 246, 74, 40, 500, 500, 372, 500, 98, 58, 500, 120, 150, 500, 40, 28, 500, 108, 48, 160, 168, 314, 112, 500, 500, 190, 380, 500, 84, 500, 68, 64, 500, 80, 236, 140, 296, 54, 128, 500, 500, 180, 500, 104, 500, 500, 500, 500, 108, 170, 46, 86, 500, 500, 132, 126, 132, 500, 500, 136, 450, 40, 352, 38, 102, 500, 70, 500, 40, 266, 500, 52, 188, 246, 388, 98, 500, 56, 500, 90, 160, 38, 130, 78, 76, 80, 48, 296, 358, 500, 80, 60, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38509093936755756, "mean_inference_ms": 1.225764523961417, "mean_action_processing_ms": 0.14397494610292666, "mean_env_wait_ms": 0.08337917524754665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399277687072754, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.12197613716125488}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4757.731627916166, "num_env_steps_trained_throughput_per_sec": 4757.731627916166, "timesteps_total": 252000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 2359.173, "sample_time_ms": 1948.054, "load_time_ms": 13.93, "load_throughput": 861464.184, "learn_time_ms": 386.81, "learn_throughput": 31023.014, "synch_weights_time_ms": 9.005}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 933, "training_iteration": 21, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-11", "timestamp": 1698247031, "time_this_iter_s": 2.527209758758545, "time_total_s": 48.8153076171875, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 48.8153076171875, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 57.25, "ram_util_percent": 26.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062503e-08, "cur_lr": 0.0003, "total_loss": 6.537697156270345, "policy_loss": -0.0005805120492974917, "vf_loss": 6.538335196177164, "vf_explained_var": -1.7921129862467448e-06, "kl": 0.0011345998009460346, "entropy": 0.5762065400679907, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 645.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.670999999999845, "episode_len_mean": 248.98, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 33.10000000000003, 45.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, 36.900000000000034, 37.50000000000003, 36.900000000000034, -50.00000000000044, -50.00000000000044, 36.50000000000003, 5.099999999999632, 46.099999999999994, 14.899999999999771, 46.3, 39.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.099999999999994, 23.499999999999893, -50.00000000000044, 44.900000000000006, 31.300000000000004, 25.499999999999922, 11.29999999999972, 40.30000000000002, -50.00000000000044, 44.5, -50.00000000000044, 41.100000000000016, 34.10000000000004, 46.3, 37.10000000000003, 42.30000000000001, 42.500000000000014, 42.10000000000001, 45.3, 20.49999999999985, 14.299999999999763, -50.00000000000044, 42.10000000000001, 44.10000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, 43.7, 41.100000000000016, 19.299999999999834, -50.00000000000044, 43.50000000000001, 12.099999999999731, 39.50000000000002, 14.299999999999763, 34.10000000000004, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 29.49999999999998, -50.00000000000044, 42.10000000000001, 23.29999999999989, 20.699999999999854, 38.10000000000002, -50.00000000000044, 30.9, 39.50000000000002, -50.00000000000044, 42.30000000000001, 41.100000000000016, -50.00000000000044, 42.30000000000001, 45.3, 44.900000000000006, 36.30000000000003, 42.500000000000014, 41.90000000000001, 41.30000000000001, -50.00000000000044, 42.30000000000001, 41.90000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, 39.50000000000002, -50.00000000000044, 42.10000000000001], "episode_lengths": [500, 104, 500, 500, 500, 500, 108, 170, 46, 86, 500, 500, 132, 126, 132, 500, 500, 136, 450, 40, 352, 38, 102, 500, 70, 500, 40, 266, 500, 52, 188, 246, 388, 98, 500, 56, 500, 90, 160, 38, 130, 78, 76, 80, 48, 296, 358, 500, 80, 60, 500, 184, 500, 64, 90, 308, 500, 66, 380, 106, 358, 160, 170, 500, 500, 500, 52, 500, 58, 500, 206, 500, 80, 268, 294, 120, 500, 192, 106, 500, 78, 90, 500, 78, 48, 52, 138, 76, 82, 88, 500, 78, 82, 500, 74, 500, 66, 106, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3848580624080794, "mean_inference_ms": 1.2265271311786645, "mean_action_processing_ms": 0.14387941339235166, "mean_env_wait_ms": 0.08339109369424022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999380111694336, "StateBufferConnector_ms": 0.0040035247802734375, "ViewRequirementAgentConnector_ms": 0.1239776611328125}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.670999999999845, "episode_len_mean": 248.98, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 33.10000000000003, 45.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, 36.900000000000034, 37.50000000000003, 36.900000000000034, -50.00000000000044, -50.00000000000044, 36.50000000000003, 5.099999999999632, 46.099999999999994, 14.899999999999771, 46.3, 39.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.099999999999994, 23.499999999999893, -50.00000000000044, 44.900000000000006, 31.300000000000004, 25.499999999999922, 11.29999999999972, 40.30000000000002, -50.00000000000044, 44.5, -50.00000000000044, 41.100000000000016, 34.10000000000004, 46.3, 37.10000000000003, 42.30000000000001, 42.500000000000014, 42.10000000000001, 45.3, 20.49999999999985, 14.299999999999763, -50.00000000000044, 42.10000000000001, 44.10000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, 43.7, 41.100000000000016, 19.299999999999834, -50.00000000000044, 43.50000000000001, 12.099999999999731, 39.50000000000002, 14.299999999999763, 34.10000000000004, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 29.49999999999998, -50.00000000000044, 42.10000000000001, 23.29999999999989, 20.699999999999854, 38.10000000000002, -50.00000000000044, 30.9, 39.50000000000002, -50.00000000000044, 42.30000000000001, 41.100000000000016, -50.00000000000044, 42.30000000000001, 45.3, 44.900000000000006, 36.30000000000003, 42.500000000000014, 41.90000000000001, 41.30000000000001, -50.00000000000044, 42.30000000000001, 41.90000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, 39.50000000000002, -50.00000000000044, 42.10000000000001], "episode_lengths": [500, 104, 500, 500, 500, 500, 108, 170, 46, 86, 500, 500, 132, 126, 132, 500, 500, 136, 450, 40, 352, 38, 102, 500, 70, 500, 40, 266, 500, 52, 188, 246, 388, 98, 500, 56, 500, 90, 160, 38, 130, 78, 76, 80, 48, 296, 358, 500, 80, 60, 500, 184, 500, 64, 90, 308, 500, 66, 380, 106, 358, 160, 170, 500, 500, 500, 52, 500, 58, 500, 206, 500, 80, 268, 294, 120, 500, 192, 106, 500, 78, 90, 500, 78, 48, 52, 138, 76, 82, 88, 500, 78, 82, 500, 74, 500, 66, 106, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3848580624080794, "mean_inference_ms": 1.2265271311786645, "mean_action_processing_ms": 0.14387941339235166, "mean_env_wait_ms": 0.08339109369424022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999380111694336, "StateBufferConnector_ms": 0.0040035247802734375, "ViewRequirementAgentConnector_ms": 0.1239776611328125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5757.896886341601, "num_env_steps_trained_throughput_per_sec": 5757.896886341601, "timesteps_total": 264000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 2326.926, "sample_time_ms": 1938.76, "load_time_ms": 13.048, "load_throughput": 919675.776, "learn_time_ms": 364.74, "learn_throughput": 32900.16, "synch_weights_time_ms": 9.004}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 982, "training_iteration": 22, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-14", "timestamp": 1698247034, "time_this_iter_s": 2.0898005962371826, "time_total_s": 50.90510821342468, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 50.90510821342468, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 57.43333333333334, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.7683715820312516e-08, "cur_lr": 0.0003, "total_loss": 7.014326906204223, "policy_loss": -0.0005940079689025878, "vf_loss": 7.0149813016255695, "vf_explained_var": 1.708666483561198e-07, "kl": 0.0017014549526455389, "entropy": 0.6031539340813955, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.08599999999985, "episode_len_mean": 249.82, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, 44.10000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, 43.7, 41.100000000000016, 19.299999999999834, -50.00000000000044, 43.50000000000001, 12.099999999999731, 39.50000000000002, 14.299999999999763, 34.10000000000004, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 29.49999999999998, -50.00000000000044, 42.10000000000001, 23.29999999999989, 20.699999999999854, 38.10000000000002, -50.00000000000044, 30.9, 39.50000000000002, -50.00000000000044, 42.30000000000001, 41.100000000000016, -50.00000000000044, 42.30000000000001, 45.3, 44.900000000000006, 36.30000000000003, 42.500000000000014, 41.90000000000001, 41.30000000000001, -50.00000000000044, 42.30000000000001, 41.90000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, 39.50000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 18.699999999999825, -50.00000000000044, 43.50000000000001, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 39.50000000000002, 22.299999999999876, 27.899999999999956, -50.00000000000044, 39.70000000000002, 36.10000000000004, 45.9, 37.70000000000003, 31.1, -50.00000000000044, -50.00000000000044, 44.7, 36.70000000000003, -50.00000000000044, 32.30000000000002, 41.90000000000001, 44.5, -50.00000000000044, 9.699999999999697, 42.900000000000006, 34.10000000000004, 38.300000000000026, 44.10000000000001, -50.00000000000044, 44.10000000000001, 45.7, 39.300000000000026, -50.00000000000044, 30.099999999999987, 43.50000000000001, 34.900000000000034, -50.00000000000044, 43.50000000000001, 45.5, 35.900000000000034, 39.300000000000026], "episode_lengths": [80, 60, 500, 184, 500, 64, 90, 308, 500, 66, 380, 106, 358, 160, 170, 500, 500, 500, 52, 500, 58, 500, 206, 500, 80, 268, 294, 120, 500, 192, 106, 500, 78, 90, 500, 78, 48, 52, 138, 76, 82, 88, 500, 78, 82, 500, 74, 500, 66, 106, 500, 80, 500, 314, 500, 66, 154, 500, 500, 500, 500, 314, 500, 500, 106, 278, 222, 500, 104, 140, 42, 124, 190, 500, 500, 54, 134, 500, 178, 82, 56, 500, 404, 72, 160, 118, 60, 500, 60, 44, 108, 500, 200, 66, 152, 500, 66, 46, 142, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38354242102283775, "mean_inference_ms": 1.2228842616556532, "mean_action_processing_ms": 0.14358243181760297, "mean_env_wait_ms": 0.08350512781804209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024995088577270508, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.11599135398864746}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.08599999999985, "episode_len_mean": 249.82, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, 44.10000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, 43.7, 41.100000000000016, 19.299999999999834, -50.00000000000044, 43.50000000000001, 12.099999999999731, 39.50000000000002, 14.299999999999763, 34.10000000000004, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 29.49999999999998, -50.00000000000044, 42.10000000000001, 23.29999999999989, 20.699999999999854, 38.10000000000002, -50.00000000000044, 30.9, 39.50000000000002, -50.00000000000044, 42.30000000000001, 41.100000000000016, -50.00000000000044, 42.30000000000001, 45.3, 44.900000000000006, 36.30000000000003, 42.500000000000014, 41.90000000000001, 41.30000000000001, -50.00000000000044, 42.30000000000001, 41.90000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, 39.50000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 18.699999999999825, -50.00000000000044, 43.50000000000001, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 39.50000000000002, 22.299999999999876, 27.899999999999956, -50.00000000000044, 39.70000000000002, 36.10000000000004, 45.9, 37.70000000000003, 31.1, -50.00000000000044, -50.00000000000044, 44.7, 36.70000000000003, -50.00000000000044, 32.30000000000002, 41.90000000000001, 44.5, -50.00000000000044, 9.699999999999697, 42.900000000000006, 34.10000000000004, 38.300000000000026, 44.10000000000001, -50.00000000000044, 44.10000000000001, 45.7, 39.300000000000026, -50.00000000000044, 30.099999999999987, 43.50000000000001, 34.900000000000034, -50.00000000000044, 43.50000000000001, 45.5, 35.900000000000034, 39.300000000000026], "episode_lengths": [80, 60, 500, 184, 500, 64, 90, 308, 500, 66, 380, 106, 358, 160, 170, 500, 500, 500, 52, 500, 58, 500, 206, 500, 80, 268, 294, 120, 500, 192, 106, 500, 78, 90, 500, 78, 48, 52, 138, 76, 82, 88, 500, 78, 82, 500, 74, 500, 66, 106, 500, 80, 500, 314, 500, 66, 154, 500, 500, 500, 500, 314, 500, 500, 106, 278, 222, 500, 104, 140, 42, 124, 190, 500, 500, 54, 134, 500, 178, 82, 56, 500, 404, 72, 160, 118, 60, 500, 60, 44, 108, 500, 200, 66, 152, 500, 66, 46, 142, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38354242102283775, "mean_inference_ms": 1.2228842616556532, "mean_action_processing_ms": 0.14358243181760297, "mean_env_wait_ms": 0.08350512781804209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024995088577270508, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.11599135398864746}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5457.446915786859, "num_env_steps_trained_throughput_per_sec": 5457.446915786859, "timesteps_total": 276000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 2308.178, "sample_time_ms": 1934.8, "load_time_ms": 12.675, "load_throughput": 946740.277, "learn_time_ms": 350.276, "learn_throughput": 34258.716, "synch_weights_time_ms": 9.152}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1030, "training_iteration": 23, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-16", "timestamp": 1698247036, "time_this_iter_s": 2.2048285007476807, "time_total_s": 53.10993671417236, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 53.10993671417236, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 57.366666666666674, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156258e-08, "cur_lr": 0.0003, "total_loss": 7.035858710606893, "policy_loss": -0.0009738108919312556, "vf_loss": 7.036890697479248, "vf_explained_var": -3.5961469014485676e-07, "kl": 0.0014356506025857622, "entropy": 0.5809245447317759, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 705.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.259999999999868, "episode_len_mean": 228.1, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 39.50000000000002, 22.299999999999876, 27.899999999999956, -50.00000000000044, 39.70000000000002, 36.10000000000004, 45.9, 37.70000000000003, 31.1, -50.00000000000044, -50.00000000000044, 44.7, 36.70000000000003, -50.00000000000044, 32.30000000000002, 41.90000000000001, 44.5, -50.00000000000044, 9.699999999999697, 42.900000000000006, 34.10000000000004, 38.300000000000026, 44.10000000000001, -50.00000000000044, 44.10000000000001, 45.7, 39.300000000000026, -50.00000000000044, 30.099999999999987, 43.50000000000001, 34.900000000000034, -50.00000000000044, 43.50000000000001, 45.5, 35.900000000000034, 39.300000000000026, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.500000000000014, 40.30000000000002, -50.00000000000044, 33.70000000000004, 38.90000000000002, 40.30000000000002, -50.00000000000044, 46.5, -50.00000000000044, 27.299999999999947, 44.10000000000001, 41.100000000000016, 43.30000000000001, -50.00000000000044, 44.900000000000006, 43.900000000000006, -50.00000000000044, 31.300000000000004, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.699999999999996, 45.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.90000000000002, 45.9, 39.50000000000002, 36.70000000000003, 44.300000000000004, 34.50000000000004, 36.50000000000003, 44.300000000000004, 45.5, 38.10000000000002, 40.70000000000002, 39.50000000000002, 44.10000000000001, 46.099999999999994, 43.10000000000001, -50.00000000000044, 34.10000000000004, 45.9, -50.00000000000044, 45.1, 27.49999999999995, -50.00000000000044, 42.30000000000001, 33.10000000000003, 45.3, 24.299999999999905, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 314, 500, 500, 106, 278, 222, 500, 104, 140, 42, 124, 190, 500, 500, 54, 134, 500, 178, 82, 56, 500, 404, 72, 160, 118, 60, 500, 60, 44, 108, 500, 200, 66, 152, 500, 66, 46, 142, 108, 500, 52, 500, 76, 98, 500, 164, 112, 98, 500, 36, 500, 228, 60, 90, 68, 500, 52, 62, 500, 188, 500, 110, 500, 34, 50, 500, 500, 52, 500, 92, 42, 106, 134, 58, 156, 136, 58, 46, 120, 94, 106, 60, 40, 70, 500, 160, 42, 500, 50, 226, 500, 78, 170, 48, 258, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3822038940789684, "mean_inference_ms": 1.2186322640884422, "mean_action_processing_ms": 0.1426406234235758, "mean_env_wait_ms": 0.083378621412708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031995534896850586, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.11000347137451172}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.259999999999868, "episode_len_mean": 228.1, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 39.50000000000002, 22.299999999999876, 27.899999999999956, -50.00000000000044, 39.70000000000002, 36.10000000000004, 45.9, 37.70000000000003, 31.1, -50.00000000000044, -50.00000000000044, 44.7, 36.70000000000003, -50.00000000000044, 32.30000000000002, 41.90000000000001, 44.5, -50.00000000000044, 9.699999999999697, 42.900000000000006, 34.10000000000004, 38.300000000000026, 44.10000000000001, -50.00000000000044, 44.10000000000001, 45.7, 39.300000000000026, -50.00000000000044, 30.099999999999987, 43.50000000000001, 34.900000000000034, -50.00000000000044, 43.50000000000001, 45.5, 35.900000000000034, 39.300000000000026, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.500000000000014, 40.30000000000002, -50.00000000000044, 33.70000000000004, 38.90000000000002, 40.30000000000002, -50.00000000000044, 46.5, -50.00000000000044, 27.299999999999947, 44.10000000000001, 41.100000000000016, 43.30000000000001, -50.00000000000044, 44.900000000000006, 43.900000000000006, -50.00000000000044, 31.300000000000004, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.699999999999996, 45.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.90000000000002, 45.9, 39.50000000000002, 36.70000000000003, 44.300000000000004, 34.50000000000004, 36.50000000000003, 44.300000000000004, 45.5, 38.10000000000002, 40.70000000000002, 39.50000000000002, 44.10000000000001, 46.099999999999994, 43.10000000000001, -50.00000000000044, 34.10000000000004, 45.9, -50.00000000000044, 45.1, 27.49999999999995, -50.00000000000044, 42.30000000000001, 33.10000000000003, 45.3, 24.299999999999905, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 314, 500, 500, 106, 278, 222, 500, 104, 140, 42, 124, 190, 500, 500, 54, 134, 500, 178, 82, 56, 500, 404, 72, 160, 118, 60, 500, 60, 44, 108, 500, 200, 66, 152, 500, 66, 46, 142, 108, 500, 52, 500, 76, 98, 500, 164, 112, 98, 500, 36, 500, 228, 60, 90, 68, 500, 52, 62, 500, 188, 500, 110, 500, 34, 50, 500, 500, 52, 500, 92, 42, 106, 134, 58, 156, 136, 58, 46, 120, 94, 106, 60, 40, 70, 500, 160, 42, 500, 50, 226, 500, 78, 170, 48, 258, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3822038940789684, "mean_inference_ms": 1.2186322640884422, "mean_action_processing_ms": 0.1426406234235758, "mean_env_wait_ms": 0.083378621412708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031995534896850586, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.11000347137451172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5084.637089722974, "num_env_steps_trained_throughput_per_sec": 5084.637089722974, "timesteps_total": 288000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 2320.119, "sample_time_ms": 1947.218, "load_time_ms": 12.875, "load_throughput": 932027.858, "learn_time_ms": 349.647, "learn_throughput": 34320.366, "synch_weights_time_ms": 9.28}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1088, "training_iteration": 24, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-18", "timestamp": 1698247038, "time_this_iter_s": 2.365046739578247, "time_total_s": 55.47498345375061, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 55.47498345375061, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 54.53333333333333, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078129e-08, "cur_lr": 0.0003, "total_loss": 6.182807064056396, "policy_loss": -0.0005772605538368226, "vf_loss": 6.183435408274333, "vf_explained_var": 7.410844167073568e-07, "kl": 0.0015172366410600565, "entropy": 0.5110500017801921, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 735.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.581999999999866, "episode_len_mean": 224.88, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 42.500000000000014, 40.30000000000002, -50.00000000000044, 33.70000000000004, 38.90000000000002, 40.30000000000002, -50.00000000000044, 46.5, -50.00000000000044, 27.299999999999947, 44.10000000000001, 41.100000000000016, 43.30000000000001, -50.00000000000044, 44.900000000000006, 43.900000000000006, -50.00000000000044, 31.300000000000004, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.699999999999996, 45.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.90000000000002, 45.9, 39.50000000000002, 36.70000000000003, 44.300000000000004, 34.50000000000004, 36.50000000000003, 44.300000000000004, 45.5, 38.10000000000002, 40.70000000000002, 39.50000000000002, 44.10000000000001, 46.099999999999994, 43.10000000000001, -50.00000000000044, 34.10000000000004, 45.9, -50.00000000000044, 45.1, 27.49999999999995, -50.00000000000044, 42.30000000000001, 33.10000000000003, 45.3, 24.299999999999905, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 42.500000000000014, -50.00000000000044, 42.500000000000014, 18.699999999999825, 18.699999999999825, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.10000000000002, 46.3, -50.00000000000044, 39.50000000000002, -50.00000000000044, 36.50000000000003, 39.10000000000002, 41.500000000000014, 39.10000000000002, 32.50000000000002, 39.70000000000002, 37.90000000000003, 40.30000000000002, 26.09999999999993, 40.30000000000002, -50.00000000000044, 43.50000000000001, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 16.8999999999998, 45.5, -50.00000000000044, 42.30000000000001, 35.70000000000003, 46.699999999999996, 40.30000000000002], "episode_lengths": [52, 500, 76, 98, 500, 164, 112, 98, 500, 36, 500, 228, 60, 90, 68, 500, 52, 62, 500, 188, 500, 110, 500, 34, 50, 500, 500, 52, 500, 92, 42, 106, 134, 58, 156, 136, 58, 46, 120, 94, 106, 60, 40, 70, 500, 160, 42, 500, 50, 226, 500, 78, 170, 48, 258, 500, 500, 500, 148, 76, 500, 76, 314, 314, 500, 500, 78, 500, 100, 38, 500, 106, 500, 136, 110, 86, 110, 176, 104, 122, 98, 240, 98, 500, 66, 64, 500, 52, 500, 500, 64, 500, 500, 332, 46, 500, 78, 144, 34, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813013463826583, "mean_inference_ms": 1.2153403368165, "mean_action_processing_ms": 0.14223139750908328, "mean_env_wait_ms": 0.08314065355553232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029999971389770508, "StateBufferConnector_ms": 0.006002664566040039, "ViewRequirementAgentConnector_ms": 0.12100076675415039}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.581999999999866, "episode_len_mean": 224.88, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 42.500000000000014, 40.30000000000002, -50.00000000000044, 33.70000000000004, 38.90000000000002, 40.30000000000002, -50.00000000000044, 46.5, -50.00000000000044, 27.299999999999947, 44.10000000000001, 41.100000000000016, 43.30000000000001, -50.00000000000044, 44.900000000000006, 43.900000000000006, -50.00000000000044, 31.300000000000004, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.699999999999996, 45.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.90000000000002, 45.9, 39.50000000000002, 36.70000000000003, 44.300000000000004, 34.50000000000004, 36.50000000000003, 44.300000000000004, 45.5, 38.10000000000002, 40.70000000000002, 39.50000000000002, 44.10000000000001, 46.099999999999994, 43.10000000000001, -50.00000000000044, 34.10000000000004, 45.9, -50.00000000000044, 45.1, 27.49999999999995, -50.00000000000044, 42.30000000000001, 33.10000000000003, 45.3, 24.299999999999905, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 42.500000000000014, -50.00000000000044, 42.500000000000014, 18.699999999999825, 18.699999999999825, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.10000000000002, 46.3, -50.00000000000044, 39.50000000000002, -50.00000000000044, 36.50000000000003, 39.10000000000002, 41.500000000000014, 39.10000000000002, 32.50000000000002, 39.70000000000002, 37.90000000000003, 40.30000000000002, 26.09999999999993, 40.30000000000002, -50.00000000000044, 43.50000000000001, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 16.8999999999998, 45.5, -50.00000000000044, 42.30000000000001, 35.70000000000003, 46.699999999999996, 40.30000000000002], "episode_lengths": [52, 500, 76, 98, 500, 164, 112, 98, 500, 36, 500, 228, 60, 90, 68, 500, 52, 62, 500, 188, 500, 110, 500, 34, 50, 500, 500, 52, 500, 92, 42, 106, 134, 58, 156, 136, 58, 46, 120, 94, 106, 60, 40, 70, 500, 160, 42, 500, 50, 226, 500, 78, 170, 48, 258, 500, 500, 500, 148, 76, 500, 76, 314, 314, 500, 500, 78, 500, 100, 38, 500, 106, 500, 136, 110, 86, 110, 176, 104, 122, 98, 240, 98, 500, 66, 64, 500, 52, 500, 500, 64, 500, 500, 332, 46, 500, 78, 144, 34, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813013463826583, "mean_inference_ms": 1.2153403368165, "mean_action_processing_ms": 0.14223139750908328, "mean_env_wait_ms": 0.08314065355553232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029999971389770508, "StateBufferConnector_ms": 0.006002664566040039, "ViewRequirementAgentConnector_ms": 0.12100076675415039}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5371.377907017695, "num_env_steps_trained_throughput_per_sec": 5371.377907017695, "timesteps_total": 300000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 2298.788, "sample_time_ms": 1932.685, "load_time_ms": 12.852, "load_throughput": 933718.855, "learn_time_ms": 342.974, "learn_throughput": 34988.029, "synch_weights_time_ms": 9.177}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 1131, "training_iteration": 25, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-20", "timestamp": 1698247040, "time_this_iter_s": 2.2390623092651367, "time_total_s": 57.71404576301575, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 57.71404576301575, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 52.4, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.9604644775390645e-09, "cur_lr": 0.0003, "total_loss": 7.273347981770834, "policy_loss": -0.0006525834401448567, "vf_loss": 7.274058675765991, "vf_explained_var": -5.424022674560547e-07, "kl": 0.0011069154436839312, "entropy": 0.5808893601099651, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 765.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.851999999999867, "episode_len_mean": 232.2, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.30000000000004, 42.500000000000014, -50.00000000000044, 42.500000000000014, 18.699999999999825, 18.699999999999825, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.10000000000002, 46.3, -50.00000000000044, 39.50000000000002, -50.00000000000044, 36.50000000000003, 39.10000000000002, 41.500000000000014, 39.10000000000002, 32.50000000000002, 39.70000000000002, 37.90000000000003, 40.30000000000002, 26.09999999999993, 40.30000000000002, -50.00000000000044, 43.50000000000001, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 16.8999999999998, 45.5, -50.00000000000044, 42.30000000000001, 35.70000000000003, 46.699999999999996, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.90000000000002, 40.500000000000014, 1.6999999999995836, 43.900000000000006, 42.900000000000006, 31.500000000000007, 45.9, 45.1, -50.00000000000044, -50.00000000000044, 29.299999999999976, 38.50000000000003, 46.099999999999994, -50.00000000000044, 24.299999999999905, 34.50000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.30000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, 39.70000000000002, 29.299999999999976, -50.00000000000044, 38.10000000000002, 28.09999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 34.10000000000004, 26.299999999999933, 31.70000000000001, 46.9, 34.10000000000004, 31.900000000000013, 47.1, -50.00000000000044, 43.30000000000001, 46.699999999999996, -50.00000000000044, 44.300000000000004, 25.29999999999992, 41.90000000000001, 29.49999999999998, 46.099999999999994, 41.30000000000001, 43.50000000000001, 36.70000000000003, 44.300000000000004, 44.7, 22.899999999999885, 8.299999999999677], "episode_lengths": [148, 76, 500, 76, 314, 314, 500, 500, 78, 500, 100, 38, 500, 106, 500, 136, 110, 86, 110, 176, 104, 122, 98, 240, 98, 500, 66, 64, 500, 52, 500, 500, 64, 500, 500, 332, 46, 500, 78, 144, 34, 98, 500, 500, 500, 58, 92, 96, 484, 62, 72, 186, 42, 50, 500, 500, 208, 116, 40, 500, 258, 156, 500, 500, 76, 68, 144, 500, 500, 104, 208, 500, 120, 220, 40, 500, 500, 160, 238, 184, 32, 160, 182, 30, 500, 68, 34, 500, 58, 248, 82, 206, 40, 88, 66, 134, 58, 54, 272, 418]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38046742595521843, "mean_inference_ms": 1.2128659056769189, "mean_action_processing_ms": 0.1423218449810544, "mean_env_wait_ms": 0.08278993762425658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699565887451172, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.1039888858795166}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.851999999999867, "episode_len_mean": 232.2, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.30000000000004, 42.500000000000014, -50.00000000000044, 42.500000000000014, 18.699999999999825, 18.699999999999825, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.10000000000002, 46.3, -50.00000000000044, 39.50000000000002, -50.00000000000044, 36.50000000000003, 39.10000000000002, 41.500000000000014, 39.10000000000002, 32.50000000000002, 39.70000000000002, 37.90000000000003, 40.30000000000002, 26.09999999999993, 40.30000000000002, -50.00000000000044, 43.50000000000001, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 16.8999999999998, 45.5, -50.00000000000044, 42.30000000000001, 35.70000000000003, 46.699999999999996, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.90000000000002, 40.500000000000014, 1.6999999999995836, 43.900000000000006, 42.900000000000006, 31.500000000000007, 45.9, 45.1, -50.00000000000044, -50.00000000000044, 29.299999999999976, 38.50000000000003, 46.099999999999994, -50.00000000000044, 24.299999999999905, 34.50000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.30000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, 39.70000000000002, 29.299999999999976, -50.00000000000044, 38.10000000000002, 28.09999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 34.10000000000004, 26.299999999999933, 31.70000000000001, 46.9, 34.10000000000004, 31.900000000000013, 47.1, -50.00000000000044, 43.30000000000001, 46.699999999999996, -50.00000000000044, 44.300000000000004, 25.29999999999992, 41.90000000000001, 29.49999999999998, 46.099999999999994, 41.30000000000001, 43.50000000000001, 36.70000000000003, 44.300000000000004, 44.7, 22.899999999999885, 8.299999999999677], "episode_lengths": [148, 76, 500, 76, 314, 314, 500, 500, 78, 500, 100, 38, 500, 106, 500, 136, 110, 86, 110, 176, 104, 122, 98, 240, 98, 500, 66, 64, 500, 52, 500, 500, 64, 500, 500, 332, 46, 500, 78, 144, 34, 98, 500, 500, 500, 58, 92, 96, 484, 62, 72, 186, 42, 50, 500, 500, 208, 116, 40, 500, 258, 156, 500, 500, 76, 68, 144, 500, 500, 104, 208, 500, 120, 220, 40, 500, 500, 160, 238, 184, 32, 160, 182, 30, 500, 68, 34, 500, 58, 248, 82, 206, 40, 88, 66, 134, 58, 54, 272, 418]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38046742595521843, "mean_inference_ms": 1.2128659056769189, "mean_action_processing_ms": 0.1423218449810544, "mean_env_wait_ms": 0.08278993762425658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699565887451172, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.1039888858795166}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5699.55571419221, "num_env_steps_trained_throughput_per_sec": 5699.55571419221, "timesteps_total": 312000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 2281.326, "sample_time_ms": 1922.99, "load_time_ms": 12.929, "load_throughput": 928167.533, "learn_time_ms": 335.43, "learn_throughput": 35774.985, "synch_weights_time_ms": 8.879}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 1189, "training_iteration": 26, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-23", "timestamp": 1698247043, "time_this_iter_s": 2.1104342937469482, "time_total_s": 59.824480056762695, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 59.824480056762695, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 56.86666666666667, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9802322387695322e-09, "cur_lr": 0.0003, "total_loss": 7.214396683375041, "policy_loss": -0.00031594149768352506, "vf_loss": 7.214761861165365, "vf_explained_var": 1.5894571940104166e-08, "kl": 0.0008248515843661153, "entropy": 0.4927273064851761, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 795.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.119999999999855, "episode_len_mean": 239.52, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6999999999995836, 43.900000000000006, 42.900000000000006, 31.500000000000007, 45.9, 45.1, -50.00000000000044, -50.00000000000044, 29.299999999999976, 38.50000000000003, 46.099999999999994, -50.00000000000044, 24.299999999999905, 34.50000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.30000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, 39.70000000000002, 29.299999999999976, -50.00000000000044, 38.10000000000002, 28.09999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 34.10000000000004, 26.299999999999933, 31.70000000000001, 46.9, 34.10000000000004, 31.900000000000013, 47.1, -50.00000000000044, 43.30000000000001, 46.699999999999996, -50.00000000000044, 44.300000000000004, 25.29999999999992, 41.90000000000001, 29.49999999999998, 46.099999999999994, 41.30000000000001, 43.50000000000001, 36.70000000000003, 44.300000000000004, 44.7, 22.899999999999885, 8.299999999999677, 0.8999999999995723, 17.299999999999805, 42.30000000000001, 43.30000000000001, 39.70000000000002, 33.30000000000003, 39.70000000000002, 43.50000000000001, -50.00000000000044, 43.30000000000001, 39.10000000000002, 46.3, 43.7, -50.00000000000044, -50.00000000000044, 16.499999999999794, 35.30000000000004, 46.3, 29.69999999999998, 42.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.50000000000001, 9.499999999999694, 10.099999999999703, 41.90000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.3, 45.5, 27.899999999999956, 46.699999999999996, 46.9], "episode_lengths": [484, 62, 72, 186, 42, 50, 500, 500, 208, 116, 40, 500, 258, 156, 500, 500, 76, 68, 144, 500, 500, 104, 208, 500, 120, 220, 40, 500, 500, 160, 238, 184, 32, 160, 182, 30, 500, 68, 34, 500, 58, 248, 82, 206, 40, 88, 66, 134, 58, 54, 272, 418, 492, 328, 78, 68, 104, 168, 104, 66, 500, 68, 110, 38, 64, 500, 500, 336, 148, 38, 204, 76, 500, 92, 500, 500, 82, 500, 66, 406, 400, 82, 500, 92, 500, 274, 500, 500, 500, 500, 500, 40, 90, 500, 500, 38, 46, 222, 34, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3798131387374016, "mean_inference_ms": 1.2117580763500282, "mean_action_processing_ms": 0.14194989011329745, "mean_env_wait_ms": 0.08252824003338319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022002220153808594, "StateBufferConnector_ms": 0.0010004043579101562, "ViewRequirementAgentConnector_ms": 0.08797693252563477}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.119999999999855, "episode_len_mean": 239.52, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.6999999999995836, 43.900000000000006, 42.900000000000006, 31.500000000000007, 45.9, 45.1, -50.00000000000044, -50.00000000000044, 29.299999999999976, 38.50000000000003, 46.099999999999994, -50.00000000000044, 24.299999999999905, 34.50000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.30000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, 39.70000000000002, 29.299999999999976, -50.00000000000044, 38.10000000000002, 28.09999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 34.10000000000004, 26.299999999999933, 31.70000000000001, 46.9, 34.10000000000004, 31.900000000000013, 47.1, -50.00000000000044, 43.30000000000001, 46.699999999999996, -50.00000000000044, 44.300000000000004, 25.29999999999992, 41.90000000000001, 29.49999999999998, 46.099999999999994, 41.30000000000001, 43.50000000000001, 36.70000000000003, 44.300000000000004, 44.7, 22.899999999999885, 8.299999999999677, 0.8999999999995723, 17.299999999999805, 42.30000000000001, 43.30000000000001, 39.70000000000002, 33.30000000000003, 39.70000000000002, 43.50000000000001, -50.00000000000044, 43.30000000000001, 39.10000000000002, 46.3, 43.7, -50.00000000000044, -50.00000000000044, 16.499999999999794, 35.30000000000004, 46.3, 29.69999999999998, 42.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.50000000000001, 9.499999999999694, 10.099999999999703, 41.90000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.3, 45.5, 27.899999999999956, 46.699999999999996, 46.9], "episode_lengths": [484, 62, 72, 186, 42, 50, 500, 500, 208, 116, 40, 500, 258, 156, 500, 500, 76, 68, 144, 500, 500, 104, 208, 500, 120, 220, 40, 500, 500, 160, 238, 184, 32, 160, 182, 30, 500, 68, 34, 500, 58, 248, 82, 206, 40, 88, 66, 134, 58, 54, 272, 418, 492, 328, 78, 68, 104, 168, 104, 66, 500, 68, 110, 38, 64, 500, 500, 336, 148, 38, 204, 76, 500, 92, 500, 500, 82, 500, 66, 406, 400, 82, 500, 92, 500, 274, 500, 500, 500, 500, 500, 40, 90, 500, 500, 38, 46, 222, 34, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3798131387374016, "mean_inference_ms": 1.2117580763500282, "mean_action_processing_ms": 0.14194989011329745, "mean_env_wait_ms": 0.08252824003338319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022002220153808594, "StateBufferConnector_ms": 0.0010004043579101562, "ViewRequirementAgentConnector_ms": 0.08797693252563477}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5314.397956922159, "num_env_steps_trained_throughput_per_sec": 5314.397956922159, "timesteps_total": 324000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 2259.984, "sample_time_ms": 1909.083, "load_time_ms": 12.108, "load_throughput": 991119.951, "learn_time_ms": 328.672, "learn_throughput": 36510.592, "synch_weights_time_ms": 8.923}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1237, "training_iteration": 27, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-25", "timestamp": 1698247045, "time_this_iter_s": 2.263017416000366, "time_total_s": 62.08749747276306, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 62.08749747276306, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 52.25, "ram_util_percent": 26.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4901161193847661e-09, "cur_lr": 0.0003, "total_loss": 6.6506987571716305, "policy_loss": -0.00018548031027118366, "vf_loss": 6.650929546356201, "vf_explained_var": -1.4503796895345051e-06, "kl": 0.0004894549115239973, "entropy": 0.4530343353748322, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 825.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.769999999999828, "episode_len_mean": 252.96, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.70000000000003, 44.300000000000004, 44.7, 22.899999999999885, 8.299999999999677, 0.8999999999995723, 17.299999999999805, 42.30000000000001, 43.30000000000001, 39.70000000000002, 33.30000000000003, 39.70000000000002, 43.50000000000001, -50.00000000000044, 43.30000000000001, 39.10000000000002, 46.3, 43.7, -50.00000000000044, -50.00000000000044, 16.499999999999794, 35.30000000000004, 46.3, 29.69999999999998, 42.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.50000000000001, 9.499999999999694, 10.099999999999703, 41.90000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.3, 45.5, 27.899999999999956, 46.699999999999996, 46.9, 31.900000000000013, 45.1, -50.00000000000044, 35.10000000000004, 46.9, 45.5, 6.299999999999649, 43.7, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 46.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.500000000000014, 44.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.900000000000006, 46.9, 45.5, 30.499999999999993, 45.1, -50.00000000000044, 15.699999999999783, -50.00000000000044, 41.90000000000001, 42.900000000000006, -50.00000000000044], "episode_lengths": [134, 58, 54, 272, 418, 492, 328, 78, 68, 104, 168, 104, 66, 500, 68, 110, 38, 64, 500, 500, 336, 148, 38, 204, 76, 500, 92, 500, 500, 82, 500, 66, 406, 400, 82, 500, 92, 500, 274, 500, 500, 500, 500, 500, 40, 90, 500, 500, 38, 46, 222, 34, 32, 182, 50, 500, 150, 32, 46, 438, 64, 500, 156, 500, 500, 36, 32, 500, 500, 500, 64, 38, 42, 500, 500, 154, 38, 102, 500, 500, 500, 102, 76, 52, 500, 44, 500, 500, 82, 72, 32, 46, 196, 50, 500, 344, 500, 82, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792066444457741, "mean_inference_ms": 1.2110275385294094, "mean_action_processing_ms": 0.14161444884746732, "mean_env_wait_ms": 0.08238029076006508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023000717163085938, "StateBufferConnector_ms": 0.003002166748046875, "ViewRequirementAgentConnector_ms": 0.10703516006469727}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.769999999999828, "episode_len_mean": 252.96, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.70000000000003, 44.300000000000004, 44.7, 22.899999999999885, 8.299999999999677, 0.8999999999995723, 17.299999999999805, 42.30000000000001, 43.30000000000001, 39.70000000000002, 33.30000000000003, 39.70000000000002, 43.50000000000001, -50.00000000000044, 43.30000000000001, 39.10000000000002, 46.3, 43.7, -50.00000000000044, -50.00000000000044, 16.499999999999794, 35.30000000000004, 46.3, 29.69999999999998, 42.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.50000000000001, 9.499999999999694, 10.099999999999703, 41.90000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.3, 45.5, 27.899999999999956, 46.699999999999996, 46.9, 31.900000000000013, 45.1, -50.00000000000044, 35.10000000000004, 46.9, 45.5, 6.299999999999649, 43.7, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 46.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.500000000000014, 44.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.900000000000006, 46.9, 45.5, 30.499999999999993, 45.1, -50.00000000000044, 15.699999999999783, -50.00000000000044, 41.90000000000001, 42.900000000000006, -50.00000000000044], "episode_lengths": [134, 58, 54, 272, 418, 492, 328, 78, 68, 104, 168, 104, 66, 500, 68, 110, 38, 64, 500, 500, 336, 148, 38, 204, 76, 500, 92, 500, 500, 82, 500, 66, 406, 400, 82, 500, 92, 500, 274, 500, 500, 500, 500, 500, 40, 90, 500, 500, 38, 46, 222, 34, 32, 182, 50, 500, 150, 32, 46, 438, 64, 500, 156, 500, 500, 36, 32, 500, 500, 500, 64, 38, 42, 500, 500, 154, 38, 102, 500, 500, 500, 102, 76, 52, 500, 44, 500, 500, 82, 72, 32, 46, 196, 50, 500, 344, 500, 82, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792066444457741, "mean_inference_ms": 1.2110275385294094, "mean_action_processing_ms": 0.14161444884746732, "mean_env_wait_ms": 0.08238029076006508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023000717163085938, "StateBufferConnector_ms": 0.003002166748046875, "ViewRequirementAgentConnector_ms": 0.10703516006469727}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5253.650530843493, "num_env_steps_trained_throughput_per_sec": 5253.650530843493, "timesteps_total": 336000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 2259.916, "sample_time_ms": 1904.035, "load_time_ms": 12.707, "load_throughput": 944336.941, "learn_time_ms": 333.074, "learn_throughput": 36027.984, "synch_weights_time_ms": 8.9}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 1284, "training_iteration": 28, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-27", "timestamp": 1698247047, "time_this_iter_s": 2.2891242504119873, "time_total_s": 64.37662172317505, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 64.37662172317505, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 60.03333333333333, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.450580596923831e-10, "cur_lr": 0.0003, "total_loss": 6.110119581222534, "policy_loss": -0.0005744135628143947, "vf_loss": 6.110739835103353, "vf_explained_var": -1.1722246805826824e-06, "kl": 0.0010225113292411455, "entropy": 0.4585222283999125, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 855.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7510000000002119, "episode_len_mean": 283.06, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.3, 45.5, 27.899999999999956, 46.699999999999996, 46.9, 31.900000000000013, 45.1, -50.00000000000044, 35.10000000000004, 46.9, 45.5, 6.299999999999649, 43.7, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 46.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.500000000000014, 44.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.900000000000006, 46.9, 45.5, 30.499999999999993, 45.1, -50.00000000000044, 15.699999999999783, -50.00000000000044, 41.90000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 3.899999999999615, 45.7, 12.299999999999734, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.300000000000004, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.9, -50.00000000000044, 44.7, -50.00000000000044], "episode_lengths": [500, 274, 500, 500, 500, 500, 500, 40, 90, 500, 500, 38, 46, 222, 34, 32, 182, 50, 500, 150, 32, 46, 438, 64, 500, 156, 500, 500, 36, 32, 500, 500, 500, 64, 38, 42, 500, 500, 154, 38, 102, 500, 500, 500, 102, 76, 52, 500, 44, 500, 500, 82, 72, 32, 46, 196, 50, 500, 344, 500, 82, 72, 500, 500, 462, 44, 378, 34, 500, 30, 500, 500, 264, 500, 500, 70, 500, 500, 34, 58, 84, 500, 500, 48, 58, 78, 500, 500, 500, 156, 500, 238, 500, 500, 500, 24, 42, 500, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790745428869326, "mean_inference_ms": 1.2100651906391107, "mean_action_processing_ms": 0.1418820969517305, "mean_env_wait_ms": 0.08245947078644407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019997596740722656, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.11904025077819824}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7510000000002119, "episode_len_mean": 283.06, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.3, 45.5, 27.899999999999956, 46.699999999999996, 46.9, 31.900000000000013, 45.1, -50.00000000000044, 35.10000000000004, 46.9, 45.5, 6.299999999999649, 43.7, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 46.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.500000000000014, 44.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.900000000000006, 46.9, 45.5, 30.499999999999993, 45.1, -50.00000000000044, 15.699999999999783, -50.00000000000044, 41.90000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 3.899999999999615, 45.7, 12.299999999999734, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.300000000000004, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.9, -50.00000000000044, 44.7, -50.00000000000044], "episode_lengths": [500, 274, 500, 500, 500, 500, 500, 40, 90, 500, 500, 38, 46, 222, 34, 32, 182, 50, 500, 150, 32, 46, 438, 64, 500, 156, 500, 500, 36, 32, 500, 500, 500, 64, 38, 42, 500, 500, 154, 38, 102, 500, 500, 500, 102, 76, 52, 500, 44, 500, 500, 82, 72, 32, 46, 196, 50, 500, 344, 500, 82, 72, 500, 500, 462, 44, 378, 34, 500, 30, 500, 500, 264, 500, 500, 70, 500, 500, 34, 58, 84, 500, 500, 48, 58, 78, 500, 500, 500, 156, 500, 238, 500, 500, 500, 24, 42, 500, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790745428869326, "mean_inference_ms": 1.2100651906391107, "mean_action_processing_ms": 0.1418820969517305, "mean_env_wait_ms": 0.08245947078644407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019997596740722656, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.11904025077819824}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5691.749766168682, "num_env_steps_trained_throughput_per_sec": 5691.749766168682, "timesteps_total": 348000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 2239.645, "sample_time_ms": 1900.05, "load_time_ms": 11.307, "load_throughput": 1061251.32, "learn_time_ms": 318.345, "learn_throughput": 37694.897, "synch_weights_time_ms": 8.942}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 1321, "training_iteration": 29, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-29", "timestamp": 1698247049, "time_this_iter_s": 2.113314390182495, "time_total_s": 66.48993611335754, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 66.48993611335754, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 58.26666666666667, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7252902984619153e-10, "cur_lr": 0.0003, "total_loss": 6.279992930094401, "policy_loss": -0.0006414581090211869, "vf_loss": 6.2806748708089195, "vf_explained_var": -2.2053718566894532e-07, "kl": 0.0007706650355923254, "entropy": 0.4047458549340566, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 885.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8209999999998088, "episode_len_mean": 267.4, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 44.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.900000000000006, 46.9, 45.5, 30.499999999999993, 45.1, -50.00000000000044, 15.699999999999783, -50.00000000000044, 41.90000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 3.899999999999615, 45.7, 12.299999999999734, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.300000000000004, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.9, -50.00000000000044, 44.7, -50.00000000000044, 14.899999999999771, -50.00000000000044, 43.30000000000001, 47.7, 46.5, -50.00000000000044, 39.300000000000026, 44.7, 45.3, -50.00000000000044, 41.500000000000014, 45.1, 21.699999999999868, 37.10000000000003, 35.900000000000034, -50.00000000000044, 45.7, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.9, 44.5, -50.00000000000044, 38.300000000000026, -50.00000000000044, 41.70000000000002, 45.9, 47.1, -50.00000000000044, 44.5, -50.00000000000044, 23.099999999999888, -50.00000000000044, 40.90000000000002, 41.30000000000001, 11.499999999999723, 23.29999999999989, 30.499999999999993, 8.49999999999968, 43.30000000000001, 34.70000000000004, -50.00000000000044], "episode_lengths": [76, 52, 500, 44, 500, 500, 82, 72, 32, 46, 196, 50, 500, 344, 500, 82, 72, 500, 500, 462, 44, 378, 34, 500, 30, 500, 500, 264, 500, 500, 70, 500, 500, 34, 58, 84, 500, 500, 48, 58, 78, 500, 500, 500, 156, 500, 238, 500, 500, 500, 24, 42, 500, 54, 500, 352, 500, 68, 24, 36, 500, 108, 54, 48, 500, 86, 50, 284, 130, 142, 500, 44, 118, 500, 500, 500, 500, 36, 32, 56, 500, 118, 500, 84, 42, 30, 500, 56, 500, 270, 500, 92, 88, 386, 268, 196, 416, 68, 154, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37888647546870224, "mean_inference_ms": 1.2087153157206747, "mean_action_processing_ms": 0.14182357669180998, "mean_env_wait_ms": 0.08246756533157809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999359130859375, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.12098813056945801}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8209999999998088, "episode_len_mean": 267.4, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 44.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.900000000000006, 46.9, 45.5, 30.499999999999993, 45.1, -50.00000000000044, 15.699999999999783, -50.00000000000044, 41.90000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 3.899999999999615, 45.7, 12.299999999999734, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.300000000000004, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.9, -50.00000000000044, 44.7, -50.00000000000044, 14.899999999999771, -50.00000000000044, 43.30000000000001, 47.7, 46.5, -50.00000000000044, 39.300000000000026, 44.7, 45.3, -50.00000000000044, 41.500000000000014, 45.1, 21.699999999999868, 37.10000000000003, 35.900000000000034, -50.00000000000044, 45.7, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.9, 44.5, -50.00000000000044, 38.300000000000026, -50.00000000000044, 41.70000000000002, 45.9, 47.1, -50.00000000000044, 44.5, -50.00000000000044, 23.099999999999888, -50.00000000000044, 40.90000000000002, 41.30000000000001, 11.499999999999723, 23.29999999999989, 30.499999999999993, 8.49999999999968, 43.30000000000001, 34.70000000000004, -50.00000000000044], "episode_lengths": [76, 52, 500, 44, 500, 500, 82, 72, 32, 46, 196, 50, 500, 344, 500, 82, 72, 500, 500, 462, 44, 378, 34, 500, 30, 500, 500, 264, 500, 500, 70, 500, 500, 34, 58, 84, 500, 500, 48, 58, 78, 500, 500, 500, 156, 500, 238, 500, 500, 500, 24, 42, 500, 54, 500, 352, 500, 68, 24, 36, 500, 108, 54, 48, 500, 86, 50, 284, 130, 142, 500, 44, 118, 500, 500, 500, 500, 36, 32, 56, 500, 118, 500, 84, 42, 30, 500, 56, 500, 270, 500, 92, 88, 386, 268, 196, 416, 68, 154, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37888647546870224, "mean_inference_ms": 1.2087153157206747, "mean_action_processing_ms": 0.14182357669180998, "mean_env_wait_ms": 0.08246756533157809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999359130859375, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.12098813056945801}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5406.806487783467, "num_env_steps_trained_throughput_per_sec": 5406.806487783467, "timesteps_total": 360000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 2237.456, "sample_time_ms": 1897.55, "load_time_ms": 11.411, "load_throughput": 1051581.771, "learn_time_ms": 318.353, "learn_throughput": 37694.005, "synch_weights_time_ms": 9.042}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1366, "training_iteration": 30, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-32", "timestamp": 1698247052, "time_this_iter_s": 2.2234227657318115, "time_total_s": 68.71335887908936, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.71335887908936, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 60.4, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309577e-10, "cur_lr": 0.0003, "total_loss": 6.217928155263265, "policy_loss": -0.00044447680314381916, "vf_loss": 6.218414545059204, "vf_explained_var": -6.318092346191406e-07, "kl": 0.000740820801221768, "entropy": 0.41901670495669047, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 915.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.444999999999812, "episode_len_mean": 261.16, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.9, -50.00000000000044, 44.7, -50.00000000000044, 14.899999999999771, -50.00000000000044, 43.30000000000001, 47.7, 46.5, -50.00000000000044, 39.300000000000026, 44.7, 45.3, -50.00000000000044, 41.500000000000014, 45.1, 21.699999999999868, 37.10000000000003, 35.900000000000034, -50.00000000000044, 45.7, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.9, 44.5, -50.00000000000044, 38.300000000000026, -50.00000000000044, 41.70000000000002, 45.9, 47.1, -50.00000000000044, 44.5, -50.00000000000044, 23.099999999999888, -50.00000000000044, 40.90000000000002, 41.30000000000001, 11.499999999999723, 23.29999999999989, 30.499999999999993, 8.49999999999968, 43.30000000000001, 34.70000000000004, -50.00000000000044, 2.8999999999996007, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.5, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 35.30000000000004, 42.70000000000001, 45.7, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.9, 36.50000000000003, 44.7, 44.7, 46.3, 47.3, 44.7, 46.699999999999996, 37.70000000000003, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 42.10000000000001, 44.900000000000006], "episode_lengths": [500, 500, 500, 24, 42, 500, 54, 500, 352, 500, 68, 24, 36, 500, 108, 54, 48, 500, 86, 50, 284, 130, 142, 500, 44, 118, 500, 500, 500, 500, 36, 32, 56, 500, 118, 500, 84, 42, 30, 500, 56, 500, 270, 500, 92, 88, 386, 268, 196, 416, 68, 154, 500, 472, 32, 500, 500, 500, 32, 500, 46, 500, 34, 40, 500, 148, 74, 44, 500, 496, 500, 34, 500, 500, 500, 98, 500, 500, 74, 32, 136, 54, 54, 38, 28, 54, 34, 124, 500, 500, 154, 500, 500, 64, 500, 500, 32, 500, 80, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785268912397787, "mean_inference_ms": 1.2077775511507747, "mean_action_processing_ms": 0.1416863869284196, "mean_env_wait_ms": 0.08244922457511132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019510507583618164, "StateBufferConnector_ms": 0.004018306732177734, "ViewRequirementAgentConnector_ms": 0.11500096321105957}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.444999999999812, "episode_len_mean": 261.16, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.9, -50.00000000000044, 44.7, -50.00000000000044, 14.899999999999771, -50.00000000000044, 43.30000000000001, 47.7, 46.5, -50.00000000000044, 39.300000000000026, 44.7, 45.3, -50.00000000000044, 41.500000000000014, 45.1, 21.699999999999868, 37.10000000000003, 35.900000000000034, -50.00000000000044, 45.7, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.9, 44.5, -50.00000000000044, 38.300000000000026, -50.00000000000044, 41.70000000000002, 45.9, 47.1, -50.00000000000044, 44.5, -50.00000000000044, 23.099999999999888, -50.00000000000044, 40.90000000000002, 41.30000000000001, 11.499999999999723, 23.29999999999989, 30.499999999999993, 8.49999999999968, 43.30000000000001, 34.70000000000004, -50.00000000000044, 2.8999999999996007, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.5, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 35.30000000000004, 42.70000000000001, 45.7, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.9, 36.50000000000003, 44.7, 44.7, 46.3, 47.3, 44.7, 46.699999999999996, 37.70000000000003, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 42.10000000000001, 44.900000000000006], "episode_lengths": [500, 500, 500, 24, 42, 500, 54, 500, 352, 500, 68, 24, 36, 500, 108, 54, 48, 500, 86, 50, 284, 130, 142, 500, 44, 118, 500, 500, 500, 500, 36, 32, 56, 500, 118, 500, 84, 42, 30, 500, 56, 500, 270, 500, 92, 88, 386, 268, 196, 416, 68, 154, 500, 472, 32, 500, 500, 500, 32, 500, 46, 500, 34, 40, 500, 148, 74, 44, 500, 496, 500, 34, 500, 500, 500, 98, 500, 500, 74, 32, 136, 54, 54, 38, 28, 54, 34, 124, 500, 500, 154, 500, 500, 64, 500, 500, 32, 500, 80, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785268912397787, "mean_inference_ms": 1.2077775511507747, "mean_action_processing_ms": 0.1416863869284196, "mean_env_wait_ms": 0.08244922457511132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019510507583618164, "StateBufferConnector_ms": 0.004018306732177734, "ViewRequirementAgentConnector_ms": 0.11500096321105957}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5050.428173582941, "num_env_steps_trained_throughput_per_sec": 5050.428173582941, "timesteps_total": 372000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 2222.838, "sample_time_ms": 1888.209, "load_time_ms": 10.941, "load_throughput": 1096834.43, "learn_time_ms": 313.428, "learn_throughput": 38286.34, "synch_weights_time_ms": 9.161}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 1413, "training_iteration": 31, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-34", "timestamp": 1698247054, "time_this_iter_s": 2.3800337314605713, "time_total_s": 71.09339261054993, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 71.09339261054993, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 59.5, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154788e-11, "cur_lr": 0.0003, "total_loss": 6.389766279856364, "policy_loss": -0.00041636849443117777, "vf_loss": 6.3902202924092615, "vf_explained_var": -1.1185805002848307e-06, "kl": 0.00040043877586413144, "entropy": 0.37713326315085094, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.5799999999998007, "episode_len_mean": 264.78, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.499999999999993, 8.49999999999968, 43.30000000000001, 34.70000000000004, -50.00000000000044, 2.8999999999996007, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.5, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 35.30000000000004, 42.70000000000001, 45.7, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.9, 36.50000000000003, 44.7, 44.7, 46.3, 47.3, 44.7, 46.699999999999996, 37.70000000000003, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 42.500000000000014, 33.500000000000036, 46.099999999999994, 46.099999999999994, 47.5, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, 44.10000000000001, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.099999999999994, 43.7, 46.699999999999996, 31.500000000000007, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 44.7, 43.50000000000001, 45.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044], "episode_lengths": [196, 416, 68, 154, 500, 472, 32, 500, 500, 500, 32, 500, 46, 500, 34, 40, 500, 148, 74, 44, 500, 496, 500, 34, 500, 500, 500, 98, 500, 500, 74, 32, 136, 54, 54, 38, 28, 54, 34, 124, 500, 500, 154, 500, 500, 64, 500, 500, 32, 500, 80, 52, 500, 42, 40, 500, 500, 48, 32, 76, 166, 40, 40, 26, 500, 48, 500, 500, 500, 500, 190, 60, 500, 46, 58, 500, 500, 42, 500, 500, 500, 36, 500, 40, 64, 34, 186, 500, 24, 500, 500, 470, 54, 66, 46, 62, 500, 500, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37853028231417274, "mean_inference_ms": 1.2069016656714304, "mean_action_processing_ms": 0.14161719368948156, "mean_env_wait_ms": 0.08253792349557079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016507387161254883, "StateBufferConnector_ms": 0.0070133209228515625, "ViewRequirementAgentConnector_ms": 0.10400032997131348}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.5799999999998007, "episode_len_mean": 264.78, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.499999999999993, 8.49999999999968, 43.30000000000001, 34.70000000000004, -50.00000000000044, 2.8999999999996007, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.5, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 35.30000000000004, 42.70000000000001, 45.7, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.9, 36.50000000000003, 44.7, 44.7, 46.3, 47.3, 44.7, 46.699999999999996, 37.70000000000003, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 42.500000000000014, 33.500000000000036, 46.099999999999994, 46.099999999999994, 47.5, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, 44.10000000000001, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.099999999999994, 43.7, 46.699999999999996, 31.500000000000007, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 44.7, 43.50000000000001, 45.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044], "episode_lengths": [196, 416, 68, 154, 500, 472, 32, 500, 500, 500, 32, 500, 46, 500, 34, 40, 500, 148, 74, 44, 500, 496, 500, 34, 500, 500, 500, 98, 500, 500, 74, 32, 136, 54, 54, 38, 28, 54, 34, 124, 500, 500, 154, 500, 500, 64, 500, 500, 32, 500, 80, 52, 500, 42, 40, 500, 500, 48, 32, 76, 166, 40, 40, 26, 500, 48, 500, 500, 500, 500, 190, 60, 500, 46, 58, 500, 500, 42, 500, 500, 500, 36, 500, 40, 64, 34, 186, 500, 24, 500, 500, 470, 54, 66, 46, 62, 500, 500, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37853028231417274, "mean_inference_ms": 1.2069016656714304, "mean_action_processing_ms": 0.14161719368948156, "mean_env_wait_ms": 0.08253792349557079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016507387161254883, "StateBufferConnector_ms": 0.0070133209228515625, "ViewRequirementAgentConnector_ms": 0.10400032997131348}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5464.4663889321955, "num_env_steps_trained_throughput_per_sec": 5464.4663889321955, "timesteps_total": 384000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 2234.03, "sample_time_ms": 1893.248, "load_time_ms": 11.012, "load_throughput": 1089724.449, "learn_time_ms": 319.563, "learn_throughput": 37551.224, "synch_weights_time_ms": 9.106}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 1461, "training_iteration": 32, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-36", "timestamp": 1698247056, "time_this_iter_s": 2.200005531311035, "time_total_s": 73.29339814186096, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 73.29339814186096, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 54.20000000000001, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.656612873077394e-11, "cur_lr": 0.0003, "total_loss": 6.032845719655355, "policy_loss": 3.453146976729234e-05, "vf_loss": 6.0328506787618, "vf_explained_var": -1.5477339426676431e-06, "kl": 8.229164722592942e-05, "entropy": 0.3942180494467417, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 975.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.42299999999979243, "episode_len_mean": 271.32, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 42.500000000000014, 33.500000000000036, 46.099999999999994, 46.099999999999994, 47.5, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, 44.10000000000001, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.099999999999994, 43.7, 46.699999999999996, 31.500000000000007, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 44.7, 43.50000000000001, 45.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 21.89999999999987, 46.699999999999996, 45.1, 47.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, 0.6999999999995694, -50.00000000000044, 44.5, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.10000000000001, 33.90000000000004, 46.5, 47.3, -50.00000000000044, -50.00000000000044, 26.69999999999994, 40.10000000000002, -50.00000000000044, 47.3], "episode_lengths": [500, 154, 500, 500, 64, 500, 500, 32, 500, 80, 52, 500, 42, 40, 500, 500, 48, 32, 76, 166, 40, 40, 26, 500, 48, 500, 500, 500, 500, 190, 60, 500, 46, 58, 500, 500, 42, 500, 500, 500, 36, 500, 40, 64, 34, 186, 500, 24, 500, 500, 470, 54, 66, 46, 62, 500, 500, 48, 500, 38, 500, 42, 500, 500, 500, 500, 42, 282, 34, 50, 30, 500, 500, 34, 500, 500, 500, 126, 60, 100, 500, 500, 44, 494, 500, 56, 52, 34, 500, 500, 60, 162, 36, 28, 500, 500, 234, 100, 500, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785664032854136, "mean_inference_ms": 1.2065862776599046, "mean_action_processing_ms": 0.141416858643111, "mean_env_wait_ms": 0.08253320774724768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018001556396484375, "StateBufferConnector_ms": 0.007995843887329102, "ViewRequirementAgentConnector_ms": 0.10748982429504395}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.42299999999979243, "episode_len_mean": 271.32, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 42.500000000000014, 33.500000000000036, 46.099999999999994, 46.099999999999994, 47.5, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, 44.10000000000001, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.099999999999994, 43.7, 46.699999999999996, 31.500000000000007, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 44.7, 43.50000000000001, 45.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 21.89999999999987, 46.699999999999996, 45.1, 47.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, 0.6999999999995694, -50.00000000000044, 44.5, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.10000000000001, 33.90000000000004, 46.5, 47.3, -50.00000000000044, -50.00000000000044, 26.69999999999994, 40.10000000000002, -50.00000000000044, 47.3], "episode_lengths": [500, 154, 500, 500, 64, 500, 500, 32, 500, 80, 52, 500, 42, 40, 500, 500, 48, 32, 76, 166, 40, 40, 26, 500, 48, 500, 500, 500, 500, 190, 60, 500, 46, 58, 500, 500, 42, 500, 500, 500, 36, 500, 40, 64, 34, 186, 500, 24, 500, 500, 470, 54, 66, 46, 62, 500, 500, 48, 500, 38, 500, 42, 500, 500, 500, 500, 42, 282, 34, 50, 30, 500, 500, 34, 500, 500, 500, 126, 60, 100, 500, 500, 44, 494, 500, 56, 52, 34, 500, 500, 60, 162, 36, 28, 500, 500, 234, 100, 500, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785664032854136, "mean_inference_ms": 1.2065862776599046, "mean_action_processing_ms": 0.141416858643111, "mean_env_wait_ms": 0.08253320774724768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018001556396484375, "StateBufferConnector_ms": 0.007995843887329102, "ViewRequirementAgentConnector_ms": 0.10748982429504395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5414.129479405414, "num_env_steps_trained_throughput_per_sec": 5414.129479405414, "timesteps_total": 396000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 2235.789, "sample_time_ms": 1888.97, "load_time_ms": 11.312, "load_throughput": 1060792.797, "learn_time_ms": 325.245, "learn_throughput": 36895.22, "synch_weights_time_ms": 9.061}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1502, "training_iteration": 33, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-38", "timestamp": 1698247058, "time_this_iter_s": 2.221421480178833, "time_total_s": 75.5148196220398, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 75.5148196220398, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 48.625, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.328306436538697e-11, "cur_lr": 0.0003, "total_loss": 6.0138645966847735, "policy_loss": -0.0002287571628888448, "vf_loss": 6.0141384919484455, "vf_explained_var": -1.3967355092366537e-06, "kl": 0.00039411771014480714, "entropy": 0.4509673982858658, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1005.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.102999999999818, "episode_len_mean": 244.58, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 21.89999999999987, 46.699999999999996, 45.1, 47.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, 0.6999999999995694, -50.00000000000044, 44.5, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.10000000000001, 33.90000000000004, 46.5, 47.3, -50.00000000000044, -50.00000000000044, 26.69999999999994, 40.10000000000002, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.699999999999996, 47.3, 46.5, 46.3, 38.90000000000002, 41.90000000000001, 44.900000000000006, 46.699999999999996, -50.00000000000044, 46.099999999999994, 47.1, 42.900000000000006, 16.699999999999797, 44.7, 45.7, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, 47.5, 46.699999999999996, -50.00000000000044, 26.69999999999994, -50.00000000000044, 39.300000000000026, 41.90000000000001, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 41.70000000000002, 47.5, 42.900000000000006, 45.1, 7.699999999999669, 47.5, -50.00000000000044, 41.70000000000002, 45.9, -50.00000000000044], "episode_lengths": [62, 500, 500, 48, 500, 38, 500, 42, 500, 500, 500, 500, 42, 282, 34, 50, 30, 500, 500, 34, 500, 500, 500, 126, 60, 100, 500, 500, 44, 494, 500, 56, 52, 34, 500, 500, 60, 162, 36, 28, 500, 500, 234, 100, 500, 28, 500, 500, 56, 500, 500, 500, 36, 500, 500, 66, 34, 28, 36, 38, 112, 82, 52, 34, 500, 40, 30, 72, 334, 54, 44, 500, 38, 40, 500, 46, 500, 26, 34, 500, 234, 500, 108, 82, 500, 30, 40, 500, 500, 48, 84, 26, 72, 50, 424, 26, 500, 84, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37747980240209883, "mean_inference_ms": 1.205834048268671, "mean_action_processing_ms": 0.14076393655468508, "mean_env_wait_ms": 0.08183528770695984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025994062423706055, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.10948443412780762}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.102999999999818, "episode_len_mean": 244.58, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 21.89999999999987, 46.699999999999996, 45.1, 47.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, 0.6999999999995694, -50.00000000000044, 44.5, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.10000000000001, 33.90000000000004, 46.5, 47.3, -50.00000000000044, -50.00000000000044, 26.69999999999994, 40.10000000000002, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.699999999999996, 47.3, 46.5, 46.3, 38.90000000000002, 41.90000000000001, 44.900000000000006, 46.699999999999996, -50.00000000000044, 46.099999999999994, 47.1, 42.900000000000006, 16.699999999999797, 44.7, 45.7, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, 47.5, 46.699999999999996, -50.00000000000044, 26.69999999999994, -50.00000000000044, 39.300000000000026, 41.90000000000001, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 41.70000000000002, 47.5, 42.900000000000006, 45.1, 7.699999999999669, 47.5, -50.00000000000044, 41.70000000000002, 45.9, -50.00000000000044], "episode_lengths": [62, 500, 500, 48, 500, 38, 500, 42, 500, 500, 500, 500, 42, 282, 34, 50, 30, 500, 500, 34, 500, 500, 500, 126, 60, 100, 500, 500, 44, 494, 500, 56, 52, 34, 500, 500, 60, 162, 36, 28, 500, 500, 234, 100, 500, 28, 500, 500, 56, 500, 500, 500, 36, 500, 500, 66, 34, 28, 36, 38, 112, 82, 52, 34, 500, 40, 30, 72, 334, 54, 44, 500, 38, 40, 500, 46, 500, 26, 34, 500, 234, 500, 108, 82, 500, 30, 40, 500, 500, 48, 84, 26, 72, 50, 424, 26, 500, 84, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37747980240209883, "mean_inference_ms": 1.205834048268671, "mean_action_processing_ms": 0.14076393655468508, "mean_env_wait_ms": 0.08183528770695984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025994062423706055, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.10948443412780762}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5651.594482346953, "num_env_steps_trained_throughput_per_sec": 5651.594482346953, "timesteps_total": 408000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 2212.113, "sample_time_ms": 1870.523, "load_time_ms": 11.117, "load_throughput": 1079420.439, "learn_time_ms": 320.043, "learn_throughput": 37495.018, "synch_weights_time_ms": 9.13}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 1556, "training_iteration": 34, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-41", "timestamp": 1698247061, "time_this_iter_s": 2.127321720123291, "time_total_s": 77.64214134216309, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 77.64214134216309, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 58.633333333333326, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693485e-11, "cur_lr": 0.0003, "total_loss": 6.37682941754659, "policy_loss": -0.0007515548417965571, "vf_loss": 6.377622572580973, "vf_explained_var": -3.5564104715983074e-07, "kl": 0.0009159305553206802, "entropy": 0.4161634852488836, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1035.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.986999999999842, "episode_len_mean": 225.8, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.699999999999996, 47.3, 46.5, 46.3, 38.90000000000002, 41.90000000000001, 44.900000000000006, 46.699999999999996, -50.00000000000044, 46.099999999999994, 47.1, 42.900000000000006, 16.699999999999797, 44.7, 45.7, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, 47.5, 46.699999999999996, -50.00000000000044, 26.69999999999994, -50.00000000000044, 39.300000000000026, 41.90000000000001, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 41.70000000000002, 47.5, 42.900000000000006, 45.1, 7.699999999999669, 47.5, -50.00000000000044, 41.70000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.5, -50.00000000000044, 10.699999999999712, 45.1, 46.699999999999996, 46.9, 46.699999999999996, 46.699999999999996, 33.30000000000003, 36.30000000000003, 47.3, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 47.5, 41.500000000000014, -50.00000000000044, 47.1, 35.900000000000034, 41.90000000000001, 38.90000000000002, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 39.300000000000026, 6.699999999999655, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 9.699999999999697, 47.3, 45.5, 40.70000000000002, 19.09999999999983, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 36, 500, 500, 66, 34, 28, 36, 38, 112, 82, 52, 34, 500, 40, 30, 72, 334, 54, 44, 500, 38, 40, 500, 46, 500, 26, 34, 500, 234, 500, 108, 82, 500, 30, 40, 500, 500, 48, 84, 26, 72, 50, 424, 26, 500, 84, 42, 500, 500, 500, 40, 56, 500, 394, 50, 34, 32, 34, 34, 168, 138, 28, 48, 500, 500, 500, 138, 500, 500, 26, 86, 500, 30, 142, 82, 112, 108, 500, 500, 500, 44, 500, 36, 108, 434, 500, 54, 62, 500, 54, 500, 404, 28, 46, 94, 310, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774597060296226, "mean_inference_ms": 1.204716354039996, "mean_action_processing_ms": 0.14060514494077736, "mean_env_wait_ms": 0.08202474466907303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019989013671875, "StateBufferConnector_ms": 0.002000570297241211, "ViewRequirementAgentConnector_ms": 0.1199953556060791}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.986999999999842, "episode_len_mean": 225.8, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.699999999999996, 47.3, 46.5, 46.3, 38.90000000000002, 41.90000000000001, 44.900000000000006, 46.699999999999996, -50.00000000000044, 46.099999999999994, 47.1, 42.900000000000006, 16.699999999999797, 44.7, 45.7, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, 47.5, 46.699999999999996, -50.00000000000044, 26.69999999999994, -50.00000000000044, 39.300000000000026, 41.90000000000001, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 41.70000000000002, 47.5, 42.900000000000006, 45.1, 7.699999999999669, 47.5, -50.00000000000044, 41.70000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.5, -50.00000000000044, 10.699999999999712, 45.1, 46.699999999999996, 46.9, 46.699999999999996, 46.699999999999996, 33.30000000000003, 36.30000000000003, 47.3, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 47.5, 41.500000000000014, -50.00000000000044, 47.1, 35.900000000000034, 41.90000000000001, 38.90000000000002, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 39.300000000000026, 6.699999999999655, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 9.699999999999697, 47.3, 45.5, 40.70000000000002, 19.09999999999983, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 36, 500, 500, 66, 34, 28, 36, 38, 112, 82, 52, 34, 500, 40, 30, 72, 334, 54, 44, 500, 38, 40, 500, 46, 500, 26, 34, 500, 234, 500, 108, 82, 500, 30, 40, 500, 500, 48, 84, 26, 72, 50, 424, 26, 500, 84, 42, 500, 500, 500, 40, 56, 500, 394, 50, 34, 32, 34, 34, 168, 138, 28, 48, 500, 500, 500, 138, 500, 500, 26, 86, 500, 30, 142, 82, 112, 108, 500, 500, 500, 44, 500, 36, 108, 434, 500, 54, 62, 500, 54, 500, 404, 28, 46, 94, 310, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774597060296226, "mean_inference_ms": 1.204716354039996, "mean_action_processing_ms": 0.14060514494077736, "mean_env_wait_ms": 0.08202474466907303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019989013671875, "StateBufferConnector_ms": 0.002000570297241211, "ViewRequirementAgentConnector_ms": 0.1199953556060791}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5149.445984612326, "num_env_steps_trained_throughput_per_sec": 5149.445984612326, "timesteps_total": 420000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 2221.742, "sample_time_ms": 1878.568, "load_time_ms": 10.635, "load_throughput": 1128314.958, "learn_time_ms": 321.947, "learn_throughput": 37273.24, "synch_weights_time_ms": 9.305}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 1606, "training_iteration": 35, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-43", "timestamp": 1698247063, "time_this_iter_s": 2.3353447914123535, "time_total_s": 79.97748613357544, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 79.97748613357544, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 60.73333333333334, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346743e-12, "cur_lr": 0.0003, "total_loss": 6.803588994344076, "policy_loss": -0.0005858806272347768, "vf_loss": 6.804216766357422, "vf_explained_var": -1.625219980875651e-06, "kl": 0.0007302512533669869, "entropy": 0.41902401645978293, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1065.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.864999999999826, "episode_len_mean": 246.98, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 10.699999999999712, 45.1, 46.699999999999996, 46.9, 46.699999999999996, 46.699999999999996, 33.30000000000003, 36.30000000000003, 47.3, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 47.5, 41.500000000000014, -50.00000000000044, 47.1, 35.900000000000034, 41.90000000000001, 38.90000000000002, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 39.300000000000026, 6.699999999999655, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 9.699999999999697, 47.3, 45.5, 40.70000000000002, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 44.900000000000006, 45.9, 46.699999999999996, 47.1, 45.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.3, 32.700000000000024, 42.500000000000014, -50.00000000000044, 23.099999999999888, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 39.50000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.5, 45.3, 47.1, -50.00000000000044, 46.099999999999994, 28.89999999999997, -50.00000000000044, 43.7, 45.1, 46.9, 16.499999999999794, -50.00000000000044, 45.7, 40.10000000000002, 46.699999999999996], "episode_lengths": [56, 500, 394, 50, 34, 32, 34, 34, 168, 138, 28, 48, 500, 500, 500, 138, 500, 500, 26, 86, 500, 30, 142, 82, 112, 108, 500, 500, 500, 44, 500, 36, 108, 434, 500, 54, 62, 500, 54, 500, 404, 28, 46, 94, 310, 500, 500, 500, 248, 500, 52, 42, 34, 30, 46, 500, 84, 500, 48, 174, 76, 500, 270, 42, 500, 38, 500, 42, 500, 500, 36, 106, 500, 500, 88, 500, 500, 500, 56, 500, 206, 500, 500, 500, 30, 46, 48, 30, 500, 40, 212, 500, 64, 50, 32, 336, 500, 44, 100, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37823543251774416, "mean_inference_ms": 1.2036750749283383, "mean_action_processing_ms": 0.1405531544534316, "mean_env_wait_ms": 0.08255480361972804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899862289428711, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.11599898338317871}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.864999999999826, "episode_len_mean": 246.98, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 10.699999999999712, 45.1, 46.699999999999996, 46.9, 46.699999999999996, 46.699999999999996, 33.30000000000003, 36.30000000000003, 47.3, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 47.5, 41.500000000000014, -50.00000000000044, 47.1, 35.900000000000034, 41.90000000000001, 38.90000000000002, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 39.300000000000026, 6.699999999999655, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 9.699999999999697, 47.3, 45.5, 40.70000000000002, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 44.900000000000006, 45.9, 46.699999999999996, 47.1, 45.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.3, 32.700000000000024, 42.500000000000014, -50.00000000000044, 23.099999999999888, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 39.50000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.5, 45.3, 47.1, -50.00000000000044, 46.099999999999994, 28.89999999999997, -50.00000000000044, 43.7, 45.1, 46.9, 16.499999999999794, -50.00000000000044, 45.7, 40.10000000000002, 46.699999999999996], "episode_lengths": [56, 500, 394, 50, 34, 32, 34, 34, 168, 138, 28, 48, 500, 500, 500, 138, 500, 500, 26, 86, 500, 30, 142, 82, 112, 108, 500, 500, 500, 44, 500, 36, 108, 434, 500, 54, 62, 500, 54, 500, 404, 28, 46, 94, 310, 500, 500, 500, 248, 500, 52, 42, 34, 30, 46, 500, 84, 500, 48, 174, 76, 500, 270, 42, 500, 38, 500, 42, 500, 500, 36, 106, 500, 500, 88, 500, 500, 500, 56, 500, 206, 500, 500, 500, 30, 46, 48, 30, 500, 40, 212, 500, 64, 50, 32, 336, 500, 44, 100, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37823543251774416, "mean_inference_ms": 1.2036750749283383, "mean_action_processing_ms": 0.1405531544534316, "mean_env_wait_ms": 0.08255480361972804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899862289428711, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.11599898338317871}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5295.4477999886585, "num_env_steps_trained_throughput_per_sec": 5295.4477999886585, "timesteps_total": 432000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 2237.809, "sample_time_ms": 1880.719, "load_time_ms": 11.358, "load_throughput": 1056479.789, "learn_time_ms": 335.281, "learn_throughput": 35790.852, "synch_weights_time_ms": 9.262}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1659, "training_iteration": 36, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-45", "timestamp": 1698247065, "time_this_iter_s": 2.271606683731079, "time_total_s": 82.24909281730652, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 82.24909281730652, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 59.43333333333334, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9103830456733713e-12, "cur_lr": 0.0003, "total_loss": 6.482493209838867, "policy_loss": -0.00026322777072588605, "vf_loss": 6.482794443766276, "vf_explained_var": -1.7523765563964843e-06, "kl": 0.00038883905301242787, "entropy": 0.3791006604830424, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1095.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.693999999999813, "episode_len_mean": 253.66, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 44.900000000000006, 45.9, 46.699999999999996, 47.1, 45.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.3, 32.700000000000024, 42.500000000000014, -50.00000000000044, 23.099999999999888, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 39.50000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.5, 45.3, 47.1, -50.00000000000044, 46.099999999999994, 28.89999999999997, -50.00000000000044, 43.7, 45.1, 46.9, 16.499999999999794, -50.00000000000044, 45.7, 40.10000000000002, 46.699999999999996, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 45.3, 43.7, 47.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, 46.5, 47.1, 47.3, 28.499999999999964, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 44.7, -50.00000000000044, 47.3, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, -50.00000000000044, 47.1, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.1, 31.1, 35.500000000000036, 46.3, 45.5, 46.699999999999996, 47.5, -50.00000000000044], "episode_lengths": [500, 500, 500, 248, 500, 52, 42, 34, 30, 46, 500, 84, 500, 48, 174, 76, 500, 270, 42, 500, 38, 500, 42, 500, 500, 36, 106, 500, 500, 88, 500, 500, 500, 56, 500, 206, 500, 500, 500, 30, 46, 48, 30, 500, 40, 212, 500, 64, 50, 32, 336, 500, 44, 100, 34, 500, 36, 40, 500, 48, 64, 30, 52, 500, 500, 500, 42, 500, 52, 36, 30, 28, 216, 500, 74, 500, 500, 444, 54, 500, 28, 158, 500, 500, 500, 488, 500, 30, 36, 66, 500, 500, 50, 190, 146, 38, 46, 34, 26, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37828972670329736, "mean_inference_ms": 1.2044549370551012, "mean_action_processing_ms": 0.14053233226884618, "mean_env_wait_ms": 0.082412583704206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199697494506836, "StateBufferConnector_ms": 0.008000850677490234, "ViewRequirementAgentConnector_ms": 0.12099123001098633}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.693999999999813, "episode_len_mean": 253.66, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 44.900000000000006, 45.9, 46.699999999999996, 47.1, 45.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.3, 32.700000000000024, 42.500000000000014, -50.00000000000044, 23.099999999999888, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 39.50000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.5, 45.3, 47.1, -50.00000000000044, 46.099999999999994, 28.89999999999997, -50.00000000000044, 43.7, 45.1, 46.9, 16.499999999999794, -50.00000000000044, 45.7, 40.10000000000002, 46.699999999999996, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 45.3, 43.7, 47.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, 46.5, 47.1, 47.3, 28.499999999999964, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 44.7, -50.00000000000044, 47.3, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, -50.00000000000044, 47.1, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.1, 31.1, 35.500000000000036, 46.3, 45.5, 46.699999999999996, 47.5, -50.00000000000044], "episode_lengths": [500, 500, 500, 248, 500, 52, 42, 34, 30, 46, 500, 84, 500, 48, 174, 76, 500, 270, 42, 500, 38, 500, 42, 500, 500, 36, 106, 500, 500, 88, 500, 500, 500, 56, 500, 206, 500, 500, 500, 30, 46, 48, 30, 500, 40, 212, 500, 64, 50, 32, 336, 500, 44, 100, 34, 500, 36, 40, 500, 48, 64, 30, 52, 500, 500, 500, 42, 500, 52, 36, 30, 28, 216, 500, 74, 500, 500, 444, 54, 500, 28, 158, 500, 500, 500, 488, 500, 30, 36, 66, 500, 500, 50, 190, 146, 38, 46, 34, 26, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37828972670329736, "mean_inference_ms": 1.2044549370551012, "mean_action_processing_ms": 0.14053233226884618, "mean_env_wait_ms": 0.082412583704206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199697494506836, "StateBufferConnector_ms": 0.008000850677490234, "ViewRequirementAgentConnector_ms": 0.12099123001098633}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5291.084535895201, "num_env_steps_trained_throughput_per_sec": 5291.084535895201, "timesteps_total": 444000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 2238.804, "sample_time_ms": 1890.279, "load_time_ms": 11.18, "load_throughput": 1073361.711, "learn_time_ms": 326.943, "learn_throughput": 36703.63, "synch_weights_time_ms": 9.315}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 1704, "training_iteration": 37, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-47", "timestamp": 1698247067, "time_this_iter_s": 2.2729616165161133, "time_total_s": 84.52205443382263, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 84.52205443382263, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 57.666666666666664, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366857e-12, "cur_lr": 0.0003, "total_loss": 6.012176084518432, "policy_loss": -0.0002660905321439107, "vf_loss": 6.012476126352946, "vf_explained_var": -1.3907750447591145e-06, "kl": 0.0004624765179376785, "entropy": 0.3401746263106664, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1125.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3979999999997954, "episode_len_mean": 266.58, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.1, 45.5, 45.3, 47.1, -50.00000000000044, 46.099999999999994, 28.89999999999997, -50.00000000000044, 43.7, 45.1, 46.9, 16.499999999999794, -50.00000000000044, 45.7, 40.10000000000002, 46.699999999999996, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 45.3, 43.7, 47.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, 46.5, 47.1, 47.3, 28.499999999999964, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 44.7, -50.00000000000044, 47.3, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, -50.00000000000044, 47.1, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.1, 31.1, 35.500000000000036, 46.3, 45.5, 46.699999999999996, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 37.10000000000003, -50.00000000000044, 19.899999999999842, 47.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.3, -50.00000000000044, 42.70000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 47.1, 47.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 30, 46, 48, 30, 500, 40, 212, 500, 64, 50, 32, 336, 500, 44, 100, 34, 500, 36, 40, 500, 48, 64, 30, 52, 500, 500, 500, 42, 500, 52, 36, 30, 28, 216, 500, 74, 500, 500, 444, 54, 500, 28, 158, 500, 500, 500, 488, 500, 30, 36, 66, 500, 500, 50, 190, 146, 38, 46, 34, 26, 500, 500, 500, 500, 46, 130, 500, 302, 30, 34, 500, 500, 32, 500, 500, 30, 500, 500, 500, 30, 500, 48, 500, 74, 130, 500, 500, 46, 500, 500, 500, 500, 24, 500, 30, 24, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784842217340348, "mean_inference_ms": 1.2052579678830624, "mean_action_processing_ms": 0.14070013425282138, "mean_env_wait_ms": 0.08234805076399848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021996021270751953, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.10797953605651855}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3979999999997954, "episode_len_mean": 266.58, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.1, 45.5, 45.3, 47.1, -50.00000000000044, 46.099999999999994, 28.89999999999997, -50.00000000000044, 43.7, 45.1, 46.9, 16.499999999999794, -50.00000000000044, 45.7, 40.10000000000002, 46.699999999999996, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 45.3, 43.7, 47.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, 46.5, 47.1, 47.3, 28.499999999999964, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 44.7, -50.00000000000044, 47.3, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, -50.00000000000044, 47.1, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.1, 31.1, 35.500000000000036, 46.3, 45.5, 46.699999999999996, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 37.10000000000003, -50.00000000000044, 19.899999999999842, 47.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.3, -50.00000000000044, 42.70000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 47.1, 47.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 30, 46, 48, 30, 500, 40, 212, 500, 64, 50, 32, 336, 500, 44, 100, 34, 500, 36, 40, 500, 48, 64, 30, 52, 500, 500, 500, 42, 500, 52, 36, 30, 28, 216, 500, 74, 500, 500, 444, 54, 500, 28, 158, 500, 500, 500, 488, 500, 30, 36, 66, 500, 500, 50, 190, 146, 38, 46, 34, 26, 500, 500, 500, 500, 46, 130, 500, 302, 30, 34, 500, 500, 32, 500, 500, 30, 500, 500, 500, 30, 500, 48, 500, 74, 130, 500, 500, 46, 500, 500, 500, 500, 24, 500, 30, 24, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784842217340348, "mean_inference_ms": 1.2052579678830624, "mean_action_processing_ms": 0.14070013425282138, "mean_env_wait_ms": 0.08234805076399848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021996021270751953, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.10797953605651855}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5290.492781756817, "num_env_steps_trained_throughput_per_sec": 5290.492781756817, "timesteps_total": 456000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 2237.213, "sample_time_ms": 1887.968, "load_time_ms": 11.55, "load_throughput": 1038933.399, "learn_time_ms": 327.274, "learn_throughput": 36666.552, "synch_weights_time_ms": 9.434}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 1741, "training_iteration": 38, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-50", "timestamp": 1698247070, "time_this_iter_s": 2.273228883743286, "time_total_s": 86.79528331756592, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 86.79528331756592, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 51.49999999999999, "ram_util_percent": 26.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183428e-13, "cur_lr": 0.0003, "total_loss": 6.202730814615886, "policy_loss": -6.832390402754148e-05, "vf_loss": 6.202835353215535, "vf_explained_var": -8.285045623779297e-07, "kl": 0.00020683194937589632, "entropy": 0.36178452769915265, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1155.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.3080000000002205, "episode_len_mean": 283.6, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, -50.00000000000044, 47.1, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.1, 31.1, 35.500000000000036, 46.3, 45.5, 46.699999999999996, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 37.10000000000003, -50.00000000000044, 19.899999999999842, 47.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.3, -50.00000000000044, 42.70000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 47.1, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 22.49999999999988, 45.1, 39.300000000000026, -50.00000000000044, 46.5, 43.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 14.699999999999768, 45.7, -50.00000000000044, 44.5, 32.100000000000016, 44.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.50000000000001, 45.9, 47.5, 47.9, 47.9, 45.7, 47.5, 46.099999999999994, 45.7], "episode_lengths": [158, 500, 500, 500, 488, 500, 30, 36, 66, 500, 500, 50, 190, 146, 38, 46, 34, 26, 500, 500, 500, 500, 46, 130, 500, 302, 30, 34, 500, 500, 32, 500, 500, 30, 500, 500, 500, 30, 500, 48, 500, 74, 130, 500, 500, 46, 500, 500, 500, 500, 24, 500, 30, 24, 500, 500, 500, 34, 276, 50, 108, 500, 36, 64, 500, 500, 40, 500, 500, 354, 44, 500, 56, 180, 58, 500, 56, 500, 500, 500, 500, 500, 500, 262, 500, 500, 58, 500, 500, 34, 500, 66, 42, 26, 22, 22, 44, 26, 40, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777832096096724, "mean_inference_ms": 1.2050780425049368, "mean_action_processing_ms": 0.14083597820671337, "mean_env_wait_ms": 0.08235553170551428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017995834350585938, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.11197853088378906}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.3080000000002205, "episode_len_mean": 283.6, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, -50.00000000000044, 47.1, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.1, 31.1, 35.500000000000036, 46.3, 45.5, 46.699999999999996, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 37.10000000000003, -50.00000000000044, 19.899999999999842, 47.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.3, -50.00000000000044, 42.70000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 47.1, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 22.49999999999988, 45.1, 39.300000000000026, -50.00000000000044, 46.5, 43.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 14.699999999999768, 45.7, -50.00000000000044, 44.5, 32.100000000000016, 44.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.50000000000001, 45.9, 47.5, 47.9, 47.9, 45.7, 47.5, 46.099999999999994, 45.7], "episode_lengths": [158, 500, 500, 500, 488, 500, 30, 36, 66, 500, 500, 50, 190, 146, 38, 46, 34, 26, 500, 500, 500, 500, 46, 130, 500, 302, 30, 34, 500, 500, 32, 500, 500, 30, 500, 500, 500, 30, 500, 48, 500, 74, 130, 500, 500, 46, 500, 500, 500, 500, 24, 500, 30, 24, 500, 500, 500, 34, 276, 50, 108, 500, 36, 64, 500, 500, 40, 500, 500, 354, 44, 500, 56, 180, 58, 500, 56, 500, 500, 500, 500, 500, 500, 262, 500, 500, 58, 500, 500, 34, 500, 66, 42, 26, 22, 22, 44, 26, 40, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777832096096724, "mean_inference_ms": 1.2050780425049368, "mean_action_processing_ms": 0.14083597820671337, "mean_env_wait_ms": 0.08235553170551428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017995834350585938, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.11197853088378906}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5592.632767065861, "num_env_steps_trained_throughput_per_sec": 5592.632767065861, "timesteps_total": 468000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 2240.949, "sample_time_ms": 1887.298, "load_time_ms": 11.55, "load_throughput": 1038931.255, "learn_time_ms": 331.679, "learn_throughput": 36179.555, "synch_weights_time_ms": 9.431}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1785, "training_iteration": 39, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-52", "timestamp": 1698247072, "time_this_iter_s": 2.149702787399292, "time_total_s": 88.94498610496521, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 88.94498610496521, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 60.53333333333333, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.637978807091714e-13, "cur_lr": 0.0003, "total_loss": 6.059564526875814, "policy_loss": -0.00036655863126118976, "vf_loss": 6.059963862101237, "vf_explained_var": -6.794929504394531e-07, "kl": 0.00036482439200042905, "entropy": 0.327775181333224, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1185.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.038000000000233, "episode_len_mean": 290.88, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 47.1, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 22.49999999999988, 45.1, 39.300000000000026, -50.00000000000044, 46.5, 43.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 14.699999999999768, 45.7, -50.00000000000044, 44.5, 32.100000000000016, 44.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.50000000000001, 45.9, 47.5, 47.9, 47.9, 45.7, 47.5, 46.099999999999994, 45.7, -50.00000000000044, 41.500000000000014, 8.099999999999675, -50.00000000000044, -50.00000000000044, 48.1, 47.7, 4.699999999999626, 47.1, 46.5, 46.9, 47.9, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 43.7, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, 47.7, -50.00000000000044], "episode_lengths": [500, 74, 130, 500, 500, 46, 500, 500, 500, 500, 24, 500, 30, 24, 500, 500, 500, 34, 276, 50, 108, 500, 36, 64, 500, 500, 40, 500, 500, 354, 44, 500, 56, 180, 58, 500, 56, 500, 500, 500, 500, 500, 500, 262, 500, 500, 58, 500, 500, 34, 500, 66, 42, 26, 22, 22, 44, 26, 40, 44, 500, 86, 420, 500, 500, 20, 24, 454, 30, 36, 32, 22, 28, 500, 500, 500, 500, 500, 22, 64, 500, 500, 30, 500, 500, 38, 34, 44, 500, 500, 500, 500, 500, 500, 52, 500, 258, 500, 24, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776936296866299, "mean_inference_ms": 1.2050894934111607, "mean_action_processing_ms": 0.1406953417030806, "mean_env_wait_ms": 0.08224116636682628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025995254516601562, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.11399698257446289}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.038000000000233, "episode_len_mean": 290.88, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 47.1, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 22.49999999999988, 45.1, 39.300000000000026, -50.00000000000044, 46.5, 43.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 14.699999999999768, 45.7, -50.00000000000044, 44.5, 32.100000000000016, 44.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.50000000000001, 45.9, 47.5, 47.9, 47.9, 45.7, 47.5, 46.099999999999994, 45.7, -50.00000000000044, 41.500000000000014, 8.099999999999675, -50.00000000000044, -50.00000000000044, 48.1, 47.7, 4.699999999999626, 47.1, 46.5, 46.9, 47.9, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 43.7, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, 47.7, -50.00000000000044], "episode_lengths": [500, 74, 130, 500, 500, 46, 500, 500, 500, 500, 24, 500, 30, 24, 500, 500, 500, 34, 276, 50, 108, 500, 36, 64, 500, 500, 40, 500, 500, 354, 44, 500, 56, 180, 58, 500, 56, 500, 500, 500, 500, 500, 500, 262, 500, 500, 58, 500, 500, 34, 500, 66, 42, 26, 22, 22, 44, 26, 40, 44, 500, 86, 420, 500, 500, 20, 24, 454, 30, 36, 32, 22, 28, 500, 500, 500, 500, 500, 22, 64, 500, 500, 30, 500, 500, 38, 34, 44, 500, 500, 500, 500, 500, 500, 52, 500, 258, 500, 24, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776936296866299, "mean_inference_ms": 1.2050894934111607, "mean_action_processing_ms": 0.1406953417030806, "mean_env_wait_ms": 0.08224116636682628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025995254516601562, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.11399698257446289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5184.943655631295, "num_env_steps_trained_throughput_per_sec": 5184.943655631295, "timesteps_total": 480000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 2250.446, "sample_time_ms": 1889.328, "load_time_ms": 12.046, "load_throughput": 996165.255, "learn_time_ms": 338.753, "learn_throughput": 35424.007, "synch_weights_time_ms": 9.428}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 1825, "training_iteration": 40, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-54", "timestamp": 1698247074, "time_this_iter_s": 2.319392442703247, "time_total_s": 91.26437854766846, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 91.26437854766846, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 60.133333333333326, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.818989403545857e-13, "cur_lr": 0.0003, "total_loss": 6.196331151326498, "policy_loss": -0.00014166968564192453, "vf_loss": 6.196509122848511, "vf_explained_var": -1.24971071879069e-06, "kl": 0.000225083680231819, "entropy": 0.3624573210875193, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1215.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.246999999999792, "episode_len_mean": 263.08, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.50000000000001, 45.9, 47.5, 47.9, 47.9, 45.7, 47.5, 46.099999999999994, 45.7, -50.00000000000044, 41.500000000000014, 8.099999999999675, -50.00000000000044, -50.00000000000044, 48.1, 47.7, 4.699999999999626, 47.1, 46.5, 46.9, 47.9, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 43.7, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 46.5, 43.7, 35.70000000000003, 46.699999999999996, 39.70000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 48.1, 45.7, -50.00000000000044, 46.3, 47.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.7, 41.90000000000001, 34.30000000000004, -50.00000000000044, 42.500000000000014, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044], "episode_lengths": [58, 500, 500, 34, 500, 66, 42, 26, 22, 22, 44, 26, 40, 44, 500, 86, 420, 500, 500, 20, 24, 454, 30, 36, 32, 22, 28, 500, 500, 500, 500, 500, 22, 64, 500, 500, 30, 500, 500, 38, 34, 44, 500, 500, 500, 500, 500, 500, 52, 500, 258, 500, 24, 500, 500, 36, 64, 144, 34, 104, 500, 500, 34, 44, 500, 48, 500, 500, 500, 30, 60, 500, 80, 500, 20, 44, 500, 38, 24, 34, 500, 500, 500, 342, 500, 500, 34, 500, 500, 24, 82, 158, 500, 76, 32, 52, 500, 500, 28, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37725955111469545, "mean_inference_ms": 1.2051470436416998, "mean_action_processing_ms": 0.1406892194344759, "mean_env_wait_ms": 0.0820284193360799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030995845794677734, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.10100221633911133}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.246999999999792, "episode_len_mean": 263.08, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.50000000000001, 45.9, 47.5, 47.9, 47.9, 45.7, 47.5, 46.099999999999994, 45.7, -50.00000000000044, 41.500000000000014, 8.099999999999675, -50.00000000000044, -50.00000000000044, 48.1, 47.7, 4.699999999999626, 47.1, 46.5, 46.9, 47.9, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 43.7, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 46.5, 43.7, 35.70000000000003, 46.699999999999996, 39.70000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 48.1, 45.7, -50.00000000000044, 46.3, 47.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.7, 41.90000000000001, 34.30000000000004, -50.00000000000044, 42.500000000000014, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044], "episode_lengths": [58, 500, 500, 34, 500, 66, 42, 26, 22, 22, 44, 26, 40, 44, 500, 86, 420, 500, 500, 20, 24, 454, 30, 36, 32, 22, 28, 500, 500, 500, 500, 500, 22, 64, 500, 500, 30, 500, 500, 38, 34, 44, 500, 500, 500, 500, 500, 500, 52, 500, 258, 500, 24, 500, 500, 36, 64, 144, 34, 104, 500, 500, 34, 44, 500, 48, 500, 500, 500, 30, 60, 500, 80, 500, 20, 44, 500, 38, 24, 34, 500, 500, 500, 342, 500, 500, 34, 500, 500, 24, 82, 158, 500, 76, 32, 52, 500, 500, 28, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37725955111469545, "mean_inference_ms": 1.2051470436416998, "mean_action_processing_ms": 0.1406892194344759, "mean_env_wait_ms": 0.0820284193360799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030995845794677734, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.10100221633911133}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5502.563752159874, "num_env_steps_trained_throughput_per_sec": 5502.563752159874, "timesteps_total": 492000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 2230.923, "sample_time_ms": 1884.388, "load_time_ms": 11.416, "load_throughput": 1051151.321, "learn_time_ms": 324.842, "learn_throughput": 36941.079, "synch_weights_time_ms": 9.386}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 1871, "training_iteration": 41, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-57", "timestamp": 1698247077, "time_this_iter_s": 2.1857993602752686, "time_total_s": 93.45017790794373, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 93.45017790794373, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 56.833333333333336, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729285e-14, "cur_lr": 0.0003, "total_loss": 6.355428091684977, "policy_loss": -0.0001887392873565356, "vf_loss": 6.355655749638875, "vf_explained_var": -6.496906280517578e-07, "kl": 0.00039898168832905865, "entropy": 0.390364079674085, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1245.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.9660000000002267, "episode_len_mean": 290.16, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 46.5, 43.7, 35.70000000000003, 46.699999999999996, 39.70000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 48.1, 45.7, -50.00000000000044, 46.3, 47.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.7, 41.90000000000001, 34.30000000000004, -50.00000000000044, 42.500000000000014, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.3, 46.699999999999996, 46.3, 47.7, 36.900000000000034, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 44.300000000000004, 46.5, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 37.50000000000003, 23.099999999999888, 33.90000000000004, 44.7, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [44, 500, 500, 500, 500, 500, 500, 52, 500, 258, 500, 24, 500, 500, 36, 64, 144, 34, 104, 500, 500, 34, 44, 500, 48, 500, 500, 500, 30, 60, 500, 80, 500, 20, 44, 500, 38, 24, 34, 500, 500, 500, 342, 500, 500, 34, 500, 500, 24, 82, 158, 500, 76, 32, 52, 500, 500, 28, 500, 500, 500, 500, 40, 28, 34, 38, 24, 132, 40, 500, 500, 500, 230, 58, 36, 500, 32, 500, 500, 26, 500, 500, 370, 500, 50, 500, 500, 30, 500, 500, 126, 270, 162, 54, 500, 88, 500, 104, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37708907275502296, "mean_inference_ms": 1.204099223738249, "mean_action_processing_ms": 0.14069511452404507, "mean_env_wait_ms": 0.08214698625471377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029001951217651367, "StateBufferConnector_ms": 0.0019991397857666016, "ViewRequirementAgentConnector_ms": 0.09099817276000977}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.9660000000002267, "episode_len_mean": 290.16, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 46.5, 43.7, 35.70000000000003, 46.699999999999996, 39.70000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 48.1, 45.7, -50.00000000000044, 46.3, 47.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.7, 41.90000000000001, 34.30000000000004, -50.00000000000044, 42.500000000000014, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.3, 46.699999999999996, 46.3, 47.7, 36.900000000000034, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 44.300000000000004, 46.5, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 37.50000000000003, 23.099999999999888, 33.90000000000004, 44.7, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [44, 500, 500, 500, 500, 500, 500, 52, 500, 258, 500, 24, 500, 500, 36, 64, 144, 34, 104, 500, 500, 34, 44, 500, 48, 500, 500, 500, 30, 60, 500, 80, 500, 20, 44, 500, 38, 24, 34, 500, 500, 500, 342, 500, 500, 34, 500, 500, 24, 82, 158, 500, 76, 32, 52, 500, 500, 28, 500, 500, 500, 500, 40, 28, 34, 38, 24, 132, 40, 500, 500, 500, 230, 58, 36, 500, 32, 500, 500, 26, 500, 500, 370, 500, 50, 500, 500, 30, 500, 500, 126, 270, 162, 54, 500, 88, 500, 104, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37708907275502296, "mean_inference_ms": 1.204099223738249, "mean_action_processing_ms": 0.14069511452404507, "mean_env_wait_ms": 0.08214698625471377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029001951217651367, "StateBufferConnector_ms": 0.0019991397857666016, "ViewRequirementAgentConnector_ms": 0.09099817276000977}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5382.369717873823, "num_env_steps_trained_throughput_per_sec": 5382.369717873823, "timesteps_total": 504000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 2234.272, "sample_time_ms": 1884.461, "load_time_ms": 12.245, "load_throughput": 980017.641, "learn_time_ms": 327.292, "learn_throughput": 36664.461, "synch_weights_time_ms": 9.383}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1912, "training_iteration": 42, "trial_id": "9f288_00009", "date": "2023-10-25_16-17-59", "timestamp": 1698247079, "time_this_iter_s": 2.2345004081726074, "time_total_s": 95.68467831611633, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 95.68467831611633, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 58.46666666666666, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864643e-14, "cur_lr": 0.0003, "total_loss": 6.498961671193441, "policy_loss": -0.0005332297335068385, "vf_loss": 6.499533573786418, "vf_explained_var": -3.1987826029459633e-07, "kl": 0.0009020960553205744, "entropy": 0.38641483585039776, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1275.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3039999999998, "episode_len_mean": 267.52, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.7, 41.90000000000001, 34.30000000000004, -50.00000000000044, 42.500000000000014, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.3, 46.699999999999996, 46.3, 47.7, 36.900000000000034, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 44.300000000000004, 46.5, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 37.50000000000003, 23.099999999999888, 33.90000000000004, 44.7, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, 46.099999999999994, 41.70000000000002, 44.5, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 14.899999999999771, 46.9, 46.9, 46.699999999999996, 46.699999999999996, 47.5, 45.3, -50.00000000000044, 37.10000000000003, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.9, 47.1, -50.00000000000044, 45.7, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 44.7, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.7], "episode_lengths": [24, 82, 158, 500, 76, 32, 52, 500, 500, 28, 500, 500, 500, 500, 40, 28, 34, 38, 24, 132, 40, 500, 500, 500, 230, 58, 36, 500, 32, 500, 500, 26, 500, 500, 370, 500, 50, 500, 500, 30, 500, 500, 126, 270, 162, 54, 500, 88, 500, 104, 500, 500, 500, 362, 40, 84, 56, 500, 170, 500, 500, 500, 84, 500, 352, 32, 32, 34, 34, 26, 48, 500, 130, 42, 52, 500, 500, 28, 500, 500, 500, 38, 32, 30, 500, 44, 194, 500, 500, 500, 32, 40, 54, 500, 500, 164, 500, 500, 70, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37726916797002447, "mean_inference_ms": 1.2035131216717572, "mean_action_processing_ms": 0.14067085402888668, "mean_env_wait_ms": 0.08226915261039362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02252054214477539, "StateBufferConnector_ms": 0.005995988845825195, "ViewRequirementAgentConnector_ms": 0.09800958633422852}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3039999999998, "episode_len_mean": 267.52, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.7, 41.90000000000001, 34.30000000000004, -50.00000000000044, 42.500000000000014, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.3, 46.699999999999996, 46.3, 47.7, 36.900000000000034, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 44.300000000000004, 46.5, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 37.50000000000003, 23.099999999999888, 33.90000000000004, 44.7, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, 46.099999999999994, 41.70000000000002, 44.5, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 14.899999999999771, 46.9, 46.9, 46.699999999999996, 46.699999999999996, 47.5, 45.3, -50.00000000000044, 37.10000000000003, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.9, 47.1, -50.00000000000044, 45.7, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 44.7, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.7], "episode_lengths": [24, 82, 158, 500, 76, 32, 52, 500, 500, 28, 500, 500, 500, 500, 40, 28, 34, 38, 24, 132, 40, 500, 500, 500, 230, 58, 36, 500, 32, 500, 500, 26, 500, 500, 370, 500, 50, 500, 500, 30, 500, 500, 126, 270, 162, 54, 500, 88, 500, 104, 500, 500, 500, 362, 40, 84, 56, 500, 170, 500, 500, 500, 84, 500, 352, 32, 32, 34, 34, 26, 48, 500, 130, 42, 52, 500, 500, 28, 500, 500, 500, 38, 32, 30, 500, 44, 194, 500, 500, 500, 32, 40, 54, 500, 500, 164, 500, 500, 70, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37726916797002447, "mean_inference_ms": 1.2035131216717572, "mean_action_processing_ms": 0.14067085402888668, "mean_env_wait_ms": 0.08226915261039362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02252054214477539, "StateBufferConnector_ms": 0.005995988845825195, "ViewRequirementAgentConnector_ms": 0.09800958633422852}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5520.472351817517, "num_env_steps_trained_throughput_per_sec": 5520.472351817517, "timesteps_total": 516000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 2230.003, "sample_time_ms": 1891.77, "load_time_ms": 11.645, "load_throughput": 1030528.863, "learn_time_ms": 316.37, "learn_throughput": 37930.242, "synch_weights_time_ms": 9.327}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 1960, "training_iteration": 43, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-01", "timestamp": 1698247081, "time_this_iter_s": 2.1807236671447754, "time_total_s": 97.86540198326111, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 97.86540198326111, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 56.63333333333333, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2737367544323214e-14, "cur_lr": 0.0003, "total_loss": 6.452207120259603, "policy_loss": -0.0006243257783353328, "vf_loss": 6.452874692281087, "vf_explained_var": -1.5596548716227214e-06, "kl": 0.0006409223226228278, "entropy": 0.4333404372135798, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1305.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.531999999999806, "episode_len_mean": 265.26, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, 46.099999999999994, 41.70000000000002, 44.5, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 14.899999999999771, 46.9, 46.9, 46.699999999999996, 46.699999999999996, 47.5, 45.3, -50.00000000000044, 37.10000000000003, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.9, 47.1, -50.00000000000044, 45.7, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 44.7, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.7, -50.00000000000044, 44.10000000000001, 46.099999999999994, 46.099999999999994, 46.699999999999996, 47.1, 47.7, 47.3, 40.70000000000002, 47.1, -50.00000000000044, 23.699999999999896, 34.900000000000034, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.3, -50.00000000000044, 14.299999999999763, 18.099999999999817, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 47.1, 43.50000000000001, 44.5, 16.699999999999797, -50.00000000000044, 42.70000000000001, -50.00000000000044, 35.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.3, 22.49999999999988, -50.00000000000044, 39.50000000000002], "episode_lengths": [500, 104, 500, 500, 500, 362, 40, 84, 56, 500, 170, 500, 500, 500, 84, 500, 352, 32, 32, 34, 34, 26, 48, 500, 130, 42, 52, 500, 500, 28, 500, 500, 500, 38, 32, 30, 500, 44, 194, 500, 500, 500, 32, 40, 54, 500, 500, 164, 500, 500, 70, 24, 500, 60, 40, 40, 34, 30, 24, 28, 94, 30, 500, 264, 152, 80, 500, 500, 500, 74, 500, 28, 500, 358, 320, 40, 500, 500, 500, 500, 138, 30, 66, 56, 334, 500, 74, 500, 142, 62, 500, 500, 500, 500, 76, 500, 38, 276, 500, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37654757025068053, "mean_inference_ms": 1.2044776786230404, "mean_action_processing_ms": 0.1405764039886068, "mean_env_wait_ms": 0.08182972288560947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021523475646972656, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.12599563598632812}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.531999999999806, "episode_len_mean": 265.26, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, 46.099999999999994, 41.70000000000002, 44.5, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 14.899999999999771, 46.9, 46.9, 46.699999999999996, 46.699999999999996, 47.5, 45.3, -50.00000000000044, 37.10000000000003, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.9, 47.1, -50.00000000000044, 45.7, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 44.7, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.7, -50.00000000000044, 44.10000000000001, 46.099999999999994, 46.099999999999994, 46.699999999999996, 47.1, 47.7, 47.3, 40.70000000000002, 47.1, -50.00000000000044, 23.699999999999896, 34.900000000000034, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.3, -50.00000000000044, 14.299999999999763, 18.099999999999817, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 47.1, 43.50000000000001, 44.5, 16.699999999999797, -50.00000000000044, 42.70000000000001, -50.00000000000044, 35.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.3, 22.49999999999988, -50.00000000000044, 39.50000000000002], "episode_lengths": [500, 104, 500, 500, 500, 362, 40, 84, 56, 500, 170, 500, 500, 500, 84, 500, 352, 32, 32, 34, 34, 26, 48, 500, 130, 42, 52, 500, 500, 28, 500, 500, 500, 38, 32, 30, 500, 44, 194, 500, 500, 500, 32, 40, 54, 500, 500, 164, 500, 500, 70, 24, 500, 60, 40, 40, 34, 30, 24, 28, 94, 30, 500, 264, 152, 80, 500, 500, 500, 74, 500, 28, 500, 358, 320, 40, 500, 500, 500, 500, 138, 30, 66, 56, 334, 500, 74, 500, 142, 62, 500, 500, 500, 500, 76, 500, 38, 276, 500, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37654757025068053, "mean_inference_ms": 1.2044776786230404, "mean_action_processing_ms": 0.1405764039886068, "mean_env_wait_ms": 0.08182972288560947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021523475646972656, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.12599563598632812}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5177.194879260515, "num_env_steps_trained_throughput_per_sec": 5177.194879260515, "timesteps_total": 528000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 2249.459, "sample_time_ms": 1890.903, "load_time_ms": 12.514, "load_throughput": 958893.489, "learn_time_ms": 335.869, "learn_throughput": 35728.208, "synch_weights_time_ms": 9.355}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 2008, "training_iteration": 44, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-03", "timestamp": 1698247083, "time_this_iter_s": 2.3228564262390137, "time_total_s": 100.18825840950012, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 100.18825840950012, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 57.53333333333333, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161607e-14, "cur_lr": 0.0003, "total_loss": 6.582690095901489, "policy_loss": -0.00014598034322261811, "vf_loss": 6.582883914311727, "vf_explained_var": -1.809994379679362e-06, "kl": 0.0006253207134742903, "entropy": 0.48033402959505717, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1335.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.723999999999818, "episode_len_mean": 253.38, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.70000000000004, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.7, -50.00000000000044, 44.10000000000001, 46.099999999999994, 46.099999999999994, 46.699999999999996, 47.1, 47.7, 47.3, 40.70000000000002, 47.1, -50.00000000000044, 23.699999999999896, 34.900000000000034, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.3, -50.00000000000044, 14.299999999999763, 18.099999999999817, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 47.1, 43.50000000000001, 44.5, 16.699999999999797, -50.00000000000044, 42.70000000000001, -50.00000000000044, 35.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.3, 22.49999999999988, -50.00000000000044, 39.50000000000002, 18.099999999999817, 45.5, -50.00000000000044, 46.5, 43.50000000000001, -50.00000000000044, 45.9, 2.8999999999996007, 45.1, 46.099999999999994, 47.1, 46.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 43.7, 13.699999999999754, -50.00000000000044, 45.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.3, 47.1, 47.9, -50.00000000000044, 46.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.7, 47.9, -50.00000000000044, -50.00000000000044, 25.29999999999992, 46.699999999999996, 47.1, -50.00000000000044, -50.00000000000044, 22.699999999999882], "episode_lengths": [164, 500, 500, 70, 24, 500, 60, 40, 40, 34, 30, 24, 28, 94, 30, 500, 264, 152, 80, 500, 500, 500, 74, 500, 28, 500, 358, 320, 40, 500, 500, 500, 500, 138, 30, 66, 56, 334, 500, 74, 500, 142, 62, 500, 500, 500, 500, 76, 500, 38, 276, 500, 106, 320, 46, 500, 36, 66, 500, 42, 472, 50, 40, 30, 36, 64, 500, 500, 500, 202, 500, 44, 30, 500, 64, 364, 500, 46, 500, 58, 500, 38, 30, 22, 500, 38, 74, 500, 500, 102, 64, 22, 500, 500, 248, 34, 30, 500, 500, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3760420091773496, "mean_inference_ms": 1.2035186709895445, "mean_action_processing_ms": 0.1403952688230042, "mean_env_wait_ms": 0.08166300228549903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02072620391845703, "StateBufferConnector_ms": 0.002002239227294922, "ViewRequirementAgentConnector_ms": 0.12398505210876465}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.723999999999818, "episode_len_mean": 253.38, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.70000000000004, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.7, -50.00000000000044, 44.10000000000001, 46.099999999999994, 46.099999999999994, 46.699999999999996, 47.1, 47.7, 47.3, 40.70000000000002, 47.1, -50.00000000000044, 23.699999999999896, 34.900000000000034, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.3, -50.00000000000044, 14.299999999999763, 18.099999999999817, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 47.1, 43.50000000000001, 44.5, 16.699999999999797, -50.00000000000044, 42.70000000000001, -50.00000000000044, 35.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.3, 22.49999999999988, -50.00000000000044, 39.50000000000002, 18.099999999999817, 45.5, -50.00000000000044, 46.5, 43.50000000000001, -50.00000000000044, 45.9, 2.8999999999996007, 45.1, 46.099999999999994, 47.1, 46.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 43.7, 13.699999999999754, -50.00000000000044, 45.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.3, 47.1, 47.9, -50.00000000000044, 46.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.7, 47.9, -50.00000000000044, -50.00000000000044, 25.29999999999992, 46.699999999999996, 47.1, -50.00000000000044, -50.00000000000044, 22.699999999999882], "episode_lengths": [164, 500, 500, 70, 24, 500, 60, 40, 40, 34, 30, 24, 28, 94, 30, 500, 264, 152, 80, 500, 500, 500, 74, 500, 28, 500, 358, 320, 40, 500, 500, 500, 500, 138, 30, 66, 56, 334, 500, 74, 500, 142, 62, 500, 500, 500, 500, 76, 500, 38, 276, 500, 106, 320, 46, 500, 36, 66, 500, 42, 472, 50, 40, 30, 36, 64, 500, 500, 500, 202, 500, 44, 30, 500, 64, 364, 500, 46, 500, 58, 500, 38, 30, 22, 500, 38, 74, 500, 500, 102, 64, 22, 500, 500, 248, 34, 30, 500, 500, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3760420091773496, "mean_inference_ms": 1.2035186709895445, "mean_action_processing_ms": 0.1403952688230042, "mean_env_wait_ms": 0.08166300228549903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02072620391845703, "StateBufferConnector_ms": 0.002002239227294922, "ViewRequirementAgentConnector_ms": 0.12398505210876465}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5696.086770527536, "num_env_steps_trained_throughput_per_sec": 5696.086770527536, "timesteps_total": 540000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 2227.095, "sample_time_ms": 1880.076, "load_time_ms": 12.314, "load_throughput": 974465.843, "learn_time_ms": 324.593, "learn_throughput": 36969.353, "synch_weights_time_ms": 9.181}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2055, "training_iteration": 45, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-05", "timestamp": 1698247085, "time_this_iter_s": 2.111740827560425, "time_total_s": 102.29999923706055, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 102.29999923706055, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 51.79999999999999, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.684341886080803e-15, "cur_lr": 0.0003, "total_loss": 6.0702635765075685, "policy_loss": -0.0005108414217829705, "vf_loss": 6.070819886525472, "vf_explained_var": 2.3444493611653645e-07, "kl": 0.0009978732695792303, "entropy": 0.4546113103628159, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1365.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.20700000000020963, "episode_len_mean": 277.62, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.3, 22.49999999999988, -50.00000000000044, 39.50000000000002, 18.099999999999817, 45.5, -50.00000000000044, 46.5, 43.50000000000001, -50.00000000000044, 45.9, 2.8999999999996007, 45.1, 46.099999999999994, 47.1, 46.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 43.7, 13.699999999999754, -50.00000000000044, 45.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.3, 47.1, 47.9, -50.00000000000044, 46.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.7, 47.9, -50.00000000000044, -50.00000000000044, 25.29999999999992, 46.699999999999996, 47.1, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 44.10000000000001, 41.500000000000014, -50.00000000000044, 38.700000000000024, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.5, 46.5, 46.3, 24.899999999999913, 46.099999999999994, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 26.69999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 43.7, -50.00000000000044, 35.500000000000036], "episode_lengths": [500, 142, 62, 500, 500, 500, 500, 76, 500, 38, 276, 500, 106, 320, 46, 500, 36, 66, 500, 42, 472, 50, 40, 30, 36, 64, 500, 500, 500, 202, 500, 44, 30, 500, 64, 364, 500, 46, 500, 58, 500, 38, 30, 22, 500, 38, 74, 500, 500, 102, 64, 22, 500, 500, 248, 34, 30, 500, 500, 274, 500, 60, 86, 500, 114, 50, 500, 500, 500, 28, 92, 500, 500, 500, 500, 500, 500, 500, 500, 36, 36, 36, 38, 252, 40, 124, 500, 500, 500, 500, 500, 56, 234, 52, 500, 500, 32, 64, 500, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37598884605457444, "mean_inference_ms": 1.2009448302247245, "mean_action_processing_ms": 0.14050191248351618, "mean_env_wait_ms": 0.08194117727301727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018722057342529297, "StateBufferConnector_ms": 0.003000974655151367, "ViewRequirementAgentConnector_ms": 0.12198805809020996}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.20700000000020963, "episode_len_mean": 277.62, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.3, 22.49999999999988, -50.00000000000044, 39.50000000000002, 18.099999999999817, 45.5, -50.00000000000044, 46.5, 43.50000000000001, -50.00000000000044, 45.9, 2.8999999999996007, 45.1, 46.099999999999994, 47.1, 46.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 43.7, 13.699999999999754, -50.00000000000044, 45.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.3, 47.1, 47.9, -50.00000000000044, 46.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.7, 47.9, -50.00000000000044, -50.00000000000044, 25.29999999999992, 46.699999999999996, 47.1, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 44.10000000000001, 41.500000000000014, -50.00000000000044, 38.700000000000024, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.5, 46.5, 46.3, 24.899999999999913, 46.099999999999994, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 26.69999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 43.7, -50.00000000000044, 35.500000000000036], "episode_lengths": [500, 142, 62, 500, 500, 500, 500, 76, 500, 38, 276, 500, 106, 320, 46, 500, 36, 66, 500, 42, 472, 50, 40, 30, 36, 64, 500, 500, 500, 202, 500, 44, 30, 500, 64, 364, 500, 46, 500, 58, 500, 38, 30, 22, 500, 38, 74, 500, 500, 102, 64, 22, 500, 500, 248, 34, 30, 500, 500, 274, 500, 60, 86, 500, 114, 50, 500, 500, 500, 28, 92, 500, 500, 500, 500, 500, 500, 500, 500, 36, 36, 36, 38, 252, 40, 124, 500, 500, 500, 500, 500, 56, 234, 52, 500, 500, 32, 64, 500, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37598884605457444, "mean_inference_ms": 1.2009448302247245, "mean_action_processing_ms": 0.14050191248351618, "mean_env_wait_ms": 0.08194117727301727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018722057342529297, "StateBufferConnector_ms": 0.003000974655151367, "ViewRequirementAgentConnector_ms": 0.12198805809020996}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5378.514941587372, "num_env_steps_trained_throughput_per_sec": 5378.514941587372, "timesteps_total": 552000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 2223.596, "sample_time_ms": 1874.758, "load_time_ms": 12.214, "load_throughput": 982456.666, "learn_time_ms": 326.546, "learn_throughput": 36748.324, "synch_weights_time_ms": 9.246}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 2095, "training_iteration": 46, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-08", "timestamp": 1698247088, "time_this_iter_s": 2.2360939979553223, "time_total_s": 104.53609323501587, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 104.53609323501587, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 51.550000000000004, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404017e-15, "cur_lr": 0.0003, "total_loss": 6.369449106852214, "policy_loss": -0.0007244146739443144, "vf_loss": 6.370221471786499, "vf_explained_var": -1.2218952178955078e-06, "kl": 0.0013750872306900418, "entropy": 0.47900584737459817, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.999999999999826, "episode_len_mean": 240.62, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.699999999999882, -50.00000000000044, 44.10000000000001, 41.500000000000014, -50.00000000000044, 38.700000000000024, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.5, 46.5, 46.3, 24.899999999999913, 46.099999999999994, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 26.69999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 43.7, -50.00000000000044, 35.500000000000036, 42.500000000000014, -50.00000000000044, 44.5, 44.10000000000001, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 44.7, 47.5, 44.5, 46.5, -50.00000000000044, 44.900000000000006, 47.3, -50.00000000000044, 47.5, 43.7, -50.00000000000044, -50.00000000000044, 45.1, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 44.300000000000004, 43.900000000000006, 46.3, 45.5, 47.1, 37.90000000000003, 25.699999999999925, 46.5, 44.7, 44.7, 44.300000000000004, 45.1, 46.699999999999996, 35.70000000000003, 47.1, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 39.50000000000002, 26.89999999999994, 45.9, -50.00000000000044, -50.00000000000044, 40.90000000000002, 1.6999999999995836, 46.5], "episode_lengths": [274, 500, 60, 86, 500, 114, 50, 500, 500, 500, 28, 92, 500, 500, 500, 500, 500, 500, 500, 500, 36, 36, 36, 38, 252, 40, 124, 500, 500, 500, 500, 500, 56, 234, 52, 500, 500, 32, 64, 500, 146, 76, 500, 56, 60, 500, 44, 42, 500, 500, 30, 500, 54, 26, 56, 36, 500, 52, 28, 500, 26, 64, 500, 500, 50, 42, 32, 500, 500, 42, 58, 62, 38, 46, 30, 122, 244, 36, 54, 54, 58, 50, 34, 144, 30, 262, 500, 500, 500, 38, 44, 500, 106, 232, 42, 500, 500, 92, 484, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763150493416018, "mean_inference_ms": 1.19969867699879, "mean_action_processing_ms": 0.1404654423790312, "mean_env_wait_ms": 0.08235422303944835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030010461807250977, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.1349780559539795}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.999999999999826, "episode_len_mean": 240.62, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.699999999999882, -50.00000000000044, 44.10000000000001, 41.500000000000014, -50.00000000000044, 38.700000000000024, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.5, 46.5, 46.3, 24.899999999999913, 46.099999999999994, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 26.69999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 43.7, -50.00000000000044, 35.500000000000036, 42.500000000000014, -50.00000000000044, 44.5, 44.10000000000001, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 44.7, 47.5, 44.5, 46.5, -50.00000000000044, 44.900000000000006, 47.3, -50.00000000000044, 47.5, 43.7, -50.00000000000044, -50.00000000000044, 45.1, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 44.300000000000004, 43.900000000000006, 46.3, 45.5, 47.1, 37.90000000000003, 25.699999999999925, 46.5, 44.7, 44.7, 44.300000000000004, 45.1, 46.699999999999996, 35.70000000000003, 47.1, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 39.50000000000002, 26.89999999999994, 45.9, -50.00000000000044, -50.00000000000044, 40.90000000000002, 1.6999999999995836, 46.5], "episode_lengths": [274, 500, 60, 86, 500, 114, 50, 500, 500, 500, 28, 92, 500, 500, 500, 500, 500, 500, 500, 500, 36, 36, 36, 38, 252, 40, 124, 500, 500, 500, 500, 500, 56, 234, 52, 500, 500, 32, 64, 500, 146, 76, 500, 56, 60, 500, 44, 42, 500, 500, 30, 500, 54, 26, 56, 36, 500, 52, 28, 500, 26, 64, 500, 500, 50, 42, 32, 500, 500, 42, 58, 62, 38, 46, 30, 122, 244, 36, 54, 54, 58, 50, 34, 144, 30, 262, 500, 500, 500, 38, 44, 500, 106, 232, 42, 500, 500, 92, 484, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763150493416018, "mean_inference_ms": 1.19969867699879, "mean_action_processing_ms": 0.1404654423790312, "mean_env_wait_ms": 0.08235422303944835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030010461807250977, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.1349780559539795}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5478.313370380308, "num_env_steps_trained_throughput_per_sec": 5478.313370380308, "timesteps_total": 564000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 2215.744, "sample_time_ms": 1870.988, "load_time_ms": 11.914, "load_throughput": 1007190.944, "learn_time_ms": 322.936, "learn_throughput": 37159.119, "synch_weights_time_ms": 9.176}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 2154, "training_iteration": 47, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-10", "timestamp": 1698247090, "time_this_iter_s": 2.194453239440918, "time_total_s": 106.73054647445679, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 106.73054647445679, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 63.0, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202008e-15, "cur_lr": 0.0003, "total_loss": 6.577293920516968, "policy_loss": -0.0001680785169204076, "vf_loss": 6.577504380544027, "vf_explained_var": 3.973642985026042e-09, "kl": 0.0005032238675084955, "entropy": 0.42318313121795653, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1425.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.285999999999838, "episode_len_mean": 227.8, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 44.7, 47.5, 44.5, 46.5, -50.00000000000044, 44.900000000000006, 47.3, -50.00000000000044, 47.5, 43.7, -50.00000000000044, -50.00000000000044, 45.1, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 44.300000000000004, 43.900000000000006, 46.3, 45.5, 47.1, 37.90000000000003, 25.699999999999925, 46.5, 44.7, 44.7, 44.300000000000004, 45.1, 46.699999999999996, 35.70000000000003, 47.1, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 39.50000000000002, 26.89999999999994, 45.9, -50.00000000000044, -50.00000000000044, 40.90000000000002, 1.6999999999995836, 46.5, -50.00000000000044, 41.100000000000016, 31.300000000000004, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 35.10000000000004, 43.50000000000001, 44.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.900000000000006, 41.30000000000001, -50.00000000000044, 38.90000000000002, 25.699999999999925, 47.5, 44.900000000000006, -50.00000000000044, 45.7, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.699999999999996, 47.1, 47.3, 38.700000000000024, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 42.30000000000001], "episode_lengths": [42, 500, 500, 30, 500, 54, 26, 56, 36, 500, 52, 28, 500, 26, 64, 500, 500, 50, 42, 32, 500, 500, 42, 58, 62, 38, 46, 30, 122, 244, 36, 54, 54, 58, 50, 34, 144, 30, 262, 500, 500, 500, 38, 44, 500, 106, 232, 42, 500, 500, 92, 484, 36, 500, 90, 188, 98, 500, 500, 44, 50, 150, 66, 54, 500, 500, 74, 500, 72, 88, 500, 112, 244, 26, 52, 500, 44, 316, 500, 500, 500, 80, 44, 500, 34, 38, 500, 500, 500, 500, 58, 34, 30, 28, 114, 500, 500, 498, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3766184343286648, "mean_inference_ms": 1.2002676529063638, "mean_action_processing_ms": 0.14034886384675124, "mean_env_wait_ms": 0.0821798638760308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026009559631347656, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.12396836280822754}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.285999999999838, "episode_len_mean": 227.8, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 44.7, 47.5, 44.5, 46.5, -50.00000000000044, 44.900000000000006, 47.3, -50.00000000000044, 47.5, 43.7, -50.00000000000044, -50.00000000000044, 45.1, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 44.300000000000004, 43.900000000000006, 46.3, 45.5, 47.1, 37.90000000000003, 25.699999999999925, 46.5, 44.7, 44.7, 44.300000000000004, 45.1, 46.699999999999996, 35.70000000000003, 47.1, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 39.50000000000002, 26.89999999999994, 45.9, -50.00000000000044, -50.00000000000044, 40.90000000000002, 1.6999999999995836, 46.5, -50.00000000000044, 41.100000000000016, 31.300000000000004, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 35.10000000000004, 43.50000000000001, 44.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.900000000000006, 41.30000000000001, -50.00000000000044, 38.90000000000002, 25.699999999999925, 47.5, 44.900000000000006, -50.00000000000044, 45.7, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.699999999999996, 47.1, 47.3, 38.700000000000024, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 42.30000000000001], "episode_lengths": [42, 500, 500, 30, 500, 54, 26, 56, 36, 500, 52, 28, 500, 26, 64, 500, 500, 50, 42, 32, 500, 500, 42, 58, 62, 38, 46, 30, 122, 244, 36, 54, 54, 58, 50, 34, 144, 30, 262, 500, 500, 500, 38, 44, 500, 106, 232, 42, 500, 500, 92, 484, 36, 500, 90, 188, 98, 500, 500, 44, 50, 150, 66, 54, 500, 500, 74, 500, 72, 88, 500, 112, 244, 26, 52, 500, 44, 316, 500, 500, 500, 80, 44, 500, 34, 38, 500, 500, 500, 500, 58, 34, 30, 28, 114, 500, 500, 498, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3766184343286648, "mean_inference_ms": 1.2002676529063638, "mean_action_processing_ms": 0.14034886384675124, "mean_env_wait_ms": 0.0821798638760308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026009559631347656, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.12396836280822754}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5424.472114729056, "num_env_steps_trained_throughput_per_sec": 5424.472114729056, "timesteps_total": 576000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 2210.142, "sample_time_ms": 1868.446, "load_time_ms": 11.814, "load_throughput": 1015776.984, "learn_time_ms": 319.877, "learn_throughput": 37514.377, "synch_weights_time_ms": 9.174}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2201, "training_iteration": 48, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-12", "timestamp": 1698247092, "time_this_iter_s": 2.2161951065063477, "time_total_s": 108.94674158096313, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 108.94674158096313, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 58.0, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601004e-16, "cur_lr": 0.0003, "total_loss": 5.766139221191406, "policy_loss": -0.00015437602996826172, "vf_loss": 5.766336329778036, "vf_explained_var": -7.152557373046875e-07, "kl": 0.00045113309702173867, "entropy": 0.427321524421374, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1455.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.07699999999979354, "episode_len_mean": 274.78, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 39.50000000000002, 26.89999999999994, 45.9, -50.00000000000044, -50.00000000000044, 40.90000000000002, 1.6999999999995836, 46.5, -50.00000000000044, 41.100000000000016, 31.300000000000004, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 35.10000000000004, 43.50000000000001, 44.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.900000000000006, 41.30000000000001, -50.00000000000044, 38.90000000000002, 25.699999999999925, 47.5, 44.900000000000006, -50.00000000000044, 45.7, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.699999999999996, 47.1, 47.3, 38.700000000000024, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.70000000000002, 45.7, -50.00000000000044, 47.9, 47.3, 45.3, -50.00000000000044, 45.7, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.5, -50.00000000000044, 40.10000000000002, -50.00000000000044, 41.70000000000002], "episode_lengths": [500, 500, 500, 38, 44, 500, 106, 232, 42, 500, 500, 92, 484, 36, 500, 90, 188, 98, 500, 500, 44, 50, 150, 66, 54, 500, 500, 74, 500, 72, 88, 500, 112, 244, 26, 52, 500, 44, 316, 500, 500, 500, 80, 44, 500, 34, 38, 500, 500, 500, 500, 58, 34, 30, 28, 114, 500, 500, 498, 500, 78, 500, 500, 32, 30, 500, 500, 48, 500, 68, 28, 500, 500, 500, 42, 94, 44, 500, 22, 28, 48, 500, 44, 112, 500, 500, 500, 500, 500, 28, 148, 500, 500, 500, 44, 56, 500, 100, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37636029980927554, "mean_inference_ms": 1.2006247802371635, "mean_action_processing_ms": 0.14032536272340765, "mean_env_wait_ms": 0.08177773283559812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700638771057129, "StateBufferConnector_ms": 0.009001970291137695, "ViewRequirementAgentConnector_ms": 0.11299467086791992}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.07699999999979354, "episode_len_mean": 274.78, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 39.50000000000002, 26.89999999999994, 45.9, -50.00000000000044, -50.00000000000044, 40.90000000000002, 1.6999999999995836, 46.5, -50.00000000000044, 41.100000000000016, 31.300000000000004, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 35.10000000000004, 43.50000000000001, 44.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.900000000000006, 41.30000000000001, -50.00000000000044, 38.90000000000002, 25.699999999999925, 47.5, 44.900000000000006, -50.00000000000044, 45.7, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.699999999999996, 47.1, 47.3, 38.700000000000024, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.70000000000002, 45.7, -50.00000000000044, 47.9, 47.3, 45.3, -50.00000000000044, 45.7, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.5, -50.00000000000044, 40.10000000000002, -50.00000000000044, 41.70000000000002], "episode_lengths": [500, 500, 500, 38, 44, 500, 106, 232, 42, 500, 500, 92, 484, 36, 500, 90, 188, 98, 500, 500, 44, 50, 150, 66, 54, 500, 500, 74, 500, 72, 88, 500, 112, 244, 26, 52, 500, 44, 316, 500, 500, 500, 80, 44, 500, 34, 38, 500, 500, 500, 500, 58, 34, 30, 28, 114, 500, 500, 498, 500, 78, 500, 500, 32, 30, 500, 500, 48, 500, 68, 28, 500, 500, 500, 42, 94, 44, 500, 22, 28, 48, 500, 44, 112, 500, 500, 500, 500, 500, 28, 148, 500, 500, 500, 44, 56, 500, 100, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37636029980927554, "mean_inference_ms": 1.2006247802371635, "mean_action_processing_ms": 0.14032536272340765, "mean_env_wait_ms": 0.08177773283559812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700638771057129, "StateBufferConnector_ms": 0.009001970291137695, "ViewRequirementAgentConnector_ms": 0.11299467086791992}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5663.081216142032, "num_env_steps_trained_throughput_per_sec": 5663.081216142032, "timesteps_total": 588000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 2207.473, "sample_time_ms": 1861.894, "load_time_ms": 12.014, "load_throughput": 998869.744, "learn_time_ms": 323.688, "learn_throughput": 37072.752, "synch_weights_time_ms": 9.051}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 2240, "training_iteration": 49, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-14", "timestamp": 1698247094, "time_this_iter_s": 2.123995780944824, "time_total_s": 111.07073736190796, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 111.07073736190796, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 56.0, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.552713678800502e-16, "cur_lr": 0.0003, "total_loss": 6.531643994649252, "policy_loss": -4.735092322031657e-06, "vf_loss": 6.53168740272522, "vf_explained_var": -1.9868214925130207e-08, "kl": 0.00017045559513266065, "entropy": 0.38714649975299836, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1485.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.751000000000237, "episode_len_mean": 303.0, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.699999999999996, 47.1, 47.3, 38.700000000000024, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.70000000000002, 45.7, -50.00000000000044, 47.9, 47.3, 45.3, -50.00000000000044, 45.7, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.5, -50.00000000000044, 40.10000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.899999999999714, 41.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 22.699999999999882, -50.00000000000044, -50.00000000000044, 47.3, 43.7, 20.099999999999845, 46.5, 29.099999999999973, -50.00000000000044, -50.00000000000044, 44.5, 29.099999999999973, 43.10000000000001, 14.499999999999766, 42.500000000000014, 47.9], "episode_lengths": [500, 500, 500, 80, 44, 500, 34, 38, 500, 500, 500, 500, 58, 34, 30, 28, 114, 500, 500, 498, 500, 78, 500, 500, 32, 30, 500, 500, 48, 500, 68, 28, 500, 500, 500, 42, 94, 44, 500, 22, 28, 48, 500, 44, 112, 500, 500, 500, 500, 500, 28, 148, 500, 500, 500, 44, 56, 500, 100, 500, 84, 500, 500, 64, 500, 46, 500, 500, 500, 224, 500, 500, 500, 500, 500, 392, 88, 114, 500, 500, 500, 500, 500, 34, 274, 500, 500, 28, 64, 300, 36, 210, 500, 500, 56, 210, 70, 356, 76, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3758553709405617, "mean_inference_ms": 1.198809576657445, "mean_action_processing_ms": 0.14026031907251324, "mean_env_wait_ms": 0.08190236621919458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600264549255371, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.10299324989318848}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.751000000000237, "episode_len_mean": 303.0, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.699999999999996, 47.1, 47.3, 38.700000000000024, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.70000000000002, 45.7, -50.00000000000044, 47.9, 47.3, 45.3, -50.00000000000044, 45.7, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.5, -50.00000000000044, 40.10000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.899999999999714, 41.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 22.699999999999882, -50.00000000000044, -50.00000000000044, 47.3, 43.7, 20.099999999999845, 46.5, 29.099999999999973, -50.00000000000044, -50.00000000000044, 44.5, 29.099999999999973, 43.10000000000001, 14.499999999999766, 42.500000000000014, 47.9], "episode_lengths": [500, 500, 500, 80, 44, 500, 34, 38, 500, 500, 500, 500, 58, 34, 30, 28, 114, 500, 500, 498, 500, 78, 500, 500, 32, 30, 500, 500, 48, 500, 68, 28, 500, 500, 500, 42, 94, 44, 500, 22, 28, 48, 500, 44, 112, 500, 500, 500, 500, 500, 28, 148, 500, 500, 500, 44, 56, 500, 100, 500, 84, 500, 500, 64, 500, 46, 500, 500, 500, 224, 500, 500, 500, 500, 500, 392, 88, 114, 500, 500, 500, 500, 500, 34, 274, 500, 500, 28, 64, 300, 36, 210, 500, 500, 56, 210, 70, 356, 76, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3758553709405617, "mean_inference_ms": 1.198809576657445, "mean_action_processing_ms": 0.14026031907251324, "mean_env_wait_ms": 0.08190236621919458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600264549255371, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.10299324989318848}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5426.1832530159445, "num_env_steps_trained_throughput_per_sec": 5426.1832530159445, "timesteps_total": 600000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 2197.184, "sample_time_ms": 1849.124, "load_time_ms": 12.414, "load_throughput": 966657.794, "learn_time_ms": 325.664, "learn_throughput": 36847.751, "synch_weights_time_ms": 8.955}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 2279, "training_iteration": 50, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-17", "timestamp": 1698247097, "time_this_iter_s": 2.2162840366363525, "time_total_s": 113.28702139854431, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 113.28702139854431, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 55.5, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.776356839400251e-16, "cur_lr": 0.0003, "total_loss": 6.027828009923299, "policy_loss": -0.0006396788482864698, "vf_loss": 6.028503020604451, "vf_explained_var": -8.106231689453125e-07, "kl": 0.0009108221986300198, "entropy": 0.3527035137017568, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1515.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -8.29400000000025, "episode_len_mean": 313.4, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.9, 47.3, 45.3, -50.00000000000044, 45.7, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.5, -50.00000000000044, 40.10000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.899999999999714, 41.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 22.699999999999882, -50.00000000000044, -50.00000000000044, 47.3, 43.7, 20.099999999999845, 46.5, 29.099999999999973, -50.00000000000044, -50.00000000000044, 44.5, 29.099999999999973, 43.10000000000001, 14.499999999999766, 42.500000000000014, 47.9, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 46.9, 20.699999999999854, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.30000000000001, -50.00000000000044, 47.7, 47.3, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 22, 28, 48, 500, 44, 112, 500, 500, 500, 500, 500, 28, 148, 500, 500, 500, 44, 56, 500, 100, 500, 84, 500, 500, 64, 500, 46, 500, 500, 500, 224, 500, 500, 500, 500, 500, 392, 88, 114, 500, 500, 500, 500, 500, 34, 274, 500, 500, 28, 64, 300, 36, 210, 500, 500, 56, 210, 70, 356, 76, 22, 500, 500, 24, 500, 32, 294, 500, 500, 500, 500, 30, 500, 500, 500, 500, 32, 68, 500, 24, 28, 500, 50, 50, 500, 40, 500, 500, 60, 44, 500, 500, 52, 500, 500, 76, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3755549965808659, "mean_inference_ms": 1.1986879337567584, "mean_action_processing_ms": 0.14010969550993513, "mean_env_wait_ms": 0.08178685471926556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021004676818847656, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.12902569770812988}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -8.29400000000025, "episode_len_mean": 313.4, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.9, 47.3, 45.3, -50.00000000000044, 45.7, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.5, -50.00000000000044, 40.10000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.899999999999714, 41.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 22.699999999999882, -50.00000000000044, -50.00000000000044, 47.3, 43.7, 20.099999999999845, 46.5, 29.099999999999973, -50.00000000000044, -50.00000000000044, 44.5, 29.099999999999973, 43.10000000000001, 14.499999999999766, 42.500000000000014, 47.9, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 46.9, 20.699999999999854, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.30000000000001, -50.00000000000044, 47.7, 47.3, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 22, 28, 48, 500, 44, 112, 500, 500, 500, 500, 500, 28, 148, 500, 500, 500, 44, 56, 500, 100, 500, 84, 500, 500, 64, 500, 46, 500, 500, 500, 224, 500, 500, 500, 500, 500, 392, 88, 114, 500, 500, 500, 500, 500, 34, 274, 500, 500, 28, 64, 300, 36, 210, 500, 500, 56, 210, 70, 356, 76, 22, 500, 500, 24, 500, 32, 294, 500, 500, 500, 500, 30, 500, 500, 500, 500, 32, 68, 500, 24, 28, 500, 50, 50, 500, 40, 500, 500, 60, 44, 500, 500, 52, 500, 500, 76, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3755549965808659, "mean_inference_ms": 1.1986879337567584, "mean_action_processing_ms": 0.14010969550993513, "mean_env_wait_ms": 0.08178685471926556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021004676818847656, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.12902569770812988}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5133.147738332466, "num_env_steps_trained_throughput_per_sec": 5133.147738332466, "timesteps_total": 612000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 2212.878, "sample_time_ms": 1864.327, "load_time_ms": 12.344, "load_throughput": 972126.363, "learn_time_ms": 326.214, "learn_throughput": 36785.681, "synch_weights_time_ms": 8.967}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2317, "training_iteration": 51, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-19", "timestamp": 1698247099, "time_this_iter_s": 2.342745304107666, "time_total_s": 115.62976670265198, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 115.62976670265198, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 62.166666666666664, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001255e-17, "cur_lr": 0.0003, "total_loss": 5.70669576327006, "policy_loss": -0.00029118374610940617, "vf_loss": 5.707019948959351, "vf_explained_var": -3.457069396972656e-07, "kl": 0.0007395292395888949, "entropy": 0.3306293060382207, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1545.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.169000000000242, "episode_len_mean": 307.16, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 10.899999999999714, 41.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 22.699999999999882, -50.00000000000044, -50.00000000000044, 47.3, 43.7, 20.099999999999845, 46.5, 29.099999999999973, -50.00000000000044, -50.00000000000044, 44.5, 29.099999999999973, 43.10000000000001, 14.499999999999766, 42.500000000000014, 47.9, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 46.9, 20.699999999999854, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.30000000000001, -50.00000000000044, 47.7, 47.3, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.1, 47.7, -50.00000000000044, -50.00000000000044, 46.9, 34.70000000000004, 35.500000000000036, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.9], "episode_lengths": [500, 500, 392, 88, 114, 500, 500, 500, 500, 500, 34, 274, 500, 500, 28, 64, 300, 36, 210, 500, 500, 56, 210, 70, 356, 76, 22, 500, 500, 24, 500, 32, 294, 500, 500, 500, 500, 30, 500, 500, 500, 500, 32, 68, 500, 24, 28, 500, 50, 50, 500, 40, 500, 500, 60, 44, 500, 500, 52, 500, 500, 76, 500, 58, 500, 500, 500, 68, 500, 58, 500, 500, 32, 500, 74, 500, 30, 24, 500, 500, 32, 154, 146, 38, 500, 500, 500, 44, 100, 500, 500, 500, 32, 500, 500, 500, 500, 60, 500, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3756455024016777, "mean_inference_ms": 1.1985967087946527, "mean_action_processing_ms": 0.1400911666953458, "mean_env_wait_ms": 0.08193112478265364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021001338958740234, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.1440105438232422}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.169000000000242, "episode_len_mean": 307.16, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 10.899999999999714, 41.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 22.699999999999882, -50.00000000000044, -50.00000000000044, 47.3, 43.7, 20.099999999999845, 46.5, 29.099999999999973, -50.00000000000044, -50.00000000000044, 44.5, 29.099999999999973, 43.10000000000001, 14.499999999999766, 42.500000000000014, 47.9, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 46.9, 20.699999999999854, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.30000000000001, -50.00000000000044, 47.7, 47.3, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.1, 47.7, -50.00000000000044, -50.00000000000044, 46.9, 34.70000000000004, 35.500000000000036, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.9], "episode_lengths": [500, 500, 392, 88, 114, 500, 500, 500, 500, 500, 34, 274, 500, 500, 28, 64, 300, 36, 210, 500, 500, 56, 210, 70, 356, 76, 22, 500, 500, 24, 500, 32, 294, 500, 500, 500, 500, 30, 500, 500, 500, 500, 32, 68, 500, 24, 28, 500, 50, 50, 500, 40, 500, 500, 60, 44, 500, 500, 52, 500, 500, 76, 500, 58, 500, 500, 500, 68, 500, 58, 500, 500, 32, 500, 74, 500, 30, 24, 500, 500, 32, 154, 146, 38, 500, 500, 500, 44, 100, 500, 500, 500, 32, 500, 500, 500, 500, 60, 500, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3756455024016777, "mean_inference_ms": 1.1985967087946527, "mean_action_processing_ms": 0.1400911666953458, "mean_env_wait_ms": 0.08193112478265364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021001338958740234, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.1440105438232422}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5048.635333251683, "num_env_steps_trained_throughput_per_sec": 5048.635333251683, "timesteps_total": 624000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 2227.616, "sample_time_ms": 1866.471, "load_time_ms": 12.445, "load_throughput": 964233.677, "learn_time_ms": 338.746, "learn_throughput": 35424.815, "synch_weights_time_ms": 8.949}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 2352, "training_iteration": 52, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-21", "timestamp": 1698247101, "time_this_iter_s": 2.381652355194092, "time_total_s": 118.01141905784607, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 118.01141905784607, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 51.075, "ram_util_percent": 26.549999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.4408920985006276e-17, "cur_lr": 0.0003, "total_loss": 5.496391232808431, "policy_loss": -0.0007055638047556083, "vf_loss": 5.497136608759562, "vf_explained_var": 8.463859558105468e-07, "kl": 0.000612515869784147, "entropy": 0.3971470445394516, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.080000000000232, "episode_len_mean": 291.28, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 43.30000000000001, -50.00000000000044, 47.7, 47.3, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.1, 47.7, -50.00000000000044, -50.00000000000044, 46.9, 34.70000000000004, 35.500000000000036, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 6.099999999999646, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.7, 25.699999999999925, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.7, 45.7, -50.00000000000044, 42.500000000000014, 47.5, 45.1, -50.00000000000044, 45.3, 45.5, 45.5], "episode_lengths": [500, 32, 68, 500, 24, 28, 500, 50, 50, 500, 40, 500, 500, 60, 44, 500, 500, 52, 500, 500, 76, 500, 58, 500, 500, 500, 68, 500, 58, 500, 500, 32, 500, 74, 500, 30, 24, 500, 500, 32, 154, 146, 38, 500, 500, 500, 44, 100, 500, 500, 500, 32, 500, 500, 500, 500, 60, 500, 32, 500, 500, 30, 500, 78, 500, 500, 96, 42, 44, 500, 500, 60, 500, 440, 40, 500, 500, 42, 500, 500, 44, 244, 34, 500, 500, 500, 500, 500, 500, 48, 44, 44, 500, 76, 26, 50, 500, 48, 46, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37578518266130684, "mean_inference_ms": 1.198823757162303, "mean_action_processing_ms": 0.14002485157296468, "mean_env_wait_ms": 0.08187765896325436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601933479309082, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.13041901588439941}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.080000000000232, "episode_len_mean": 291.28, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 43.30000000000001, -50.00000000000044, 47.7, 47.3, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.1, 47.7, -50.00000000000044, -50.00000000000044, 46.9, 34.70000000000004, 35.500000000000036, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 6.099999999999646, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.7, 25.699999999999925, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.7, 45.7, -50.00000000000044, 42.500000000000014, 47.5, 45.1, -50.00000000000044, 45.3, 45.5, 45.5], "episode_lengths": [500, 32, 68, 500, 24, 28, 500, 50, 50, 500, 40, 500, 500, 60, 44, 500, 500, 52, 500, 500, 76, 500, 58, 500, 500, 500, 68, 500, 58, 500, 500, 32, 500, 74, 500, 30, 24, 500, 500, 32, 154, 146, 38, 500, 500, 500, 44, 100, 500, 500, 500, 32, 500, 500, 500, 500, 60, 500, 32, 500, 500, 30, 500, 78, 500, 500, 96, 42, 44, 500, 500, 60, 500, 440, 40, 500, 500, 42, 500, 500, 44, 244, 34, 500, 500, 500, 500, 500, 500, 48, 44, 44, 500, 76, 26, 50, 500, 48, 46, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37578518266130684, "mean_inference_ms": 1.198823757162303, "mean_action_processing_ms": 0.14002485157296468, "mean_env_wait_ms": 0.08187765896325436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601933479309082, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.13041901588439941}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5477.697479057445, "num_env_steps_trained_throughput_per_sec": 5477.697479057445, "timesteps_total": 636000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 2229.313, "sample_time_ms": 1866.818, "load_time_ms": 12.346, "load_throughput": 971951.777, "learn_time_ms": 340.266, "learn_throughput": 35266.572, "synch_weights_time_ms": 8.977}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 2393, "training_iteration": 53, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-24", "timestamp": 1698247104, "time_this_iter_s": 2.1954104900360107, "time_total_s": 120.20682954788208, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 120.20682954788208, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 58.76666666666667, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503138e-17, "cur_lr": 0.0003, "total_loss": 6.128898588816325, "policy_loss": -0.0002805496255556742, "vf_loss": 6.129218578338623, "vf_explained_var": 4.311402638753255e-07, "kl": 0.0003711389356359026, "entropy": 0.3943823625644048, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1605.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.035000000000244, "episode_len_mean": 305.82, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.70000000000004, 35.500000000000036, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 6.099999999999646, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.7, 25.699999999999925, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.7, 45.7, -50.00000000000044, 42.500000000000014, 47.5, 45.1, -50.00000000000044, 45.3, 45.5, 45.5, -50.00000000000044, 46.9, 45.5, 44.10000000000001, -50.00000000000044, 47.7, -50.00000000000044, 42.30000000000001, -50.00000000000044, 2.0999999999995893, 47.1, 44.10000000000001, 47.7, -50.00000000000044, -50.00000000000044, 45.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007], "episode_lengths": [154, 146, 38, 500, 500, 500, 44, 100, 500, 500, 500, 32, 500, 500, 500, 500, 60, 500, 32, 500, 500, 30, 500, 78, 500, 500, 96, 42, 44, 500, 500, 60, 500, 440, 40, 500, 500, 42, 500, 500, 44, 244, 34, 500, 500, 500, 500, 500, 500, 48, 44, 44, 500, 76, 26, 50, 500, 48, 46, 46, 500, 32, 46, 60, 500, 24, 500, 78, 500, 480, 30, 60, 24, 500, 500, 46, 72, 500, 500, 500, 500, 500, 500, 134, 500, 500, 500, 50, 46, 44, 500, 500, 500, 22, 500, 134, 500, 500, 500, 472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3756315012187638, "mean_inference_ms": 1.1983601902400003, "mean_action_processing_ms": 0.1399448142304143, "mean_env_wait_ms": 0.08181339049072373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028018474578857422, "StateBufferConnector_ms": 0.009998321533203125, "ViewRequirementAgentConnector_ms": 0.10438919067382812}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.035000000000244, "episode_len_mean": 305.82, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.70000000000004, 35.500000000000036, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 6.099999999999646, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.7, 25.699999999999925, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.7, 45.7, -50.00000000000044, 42.500000000000014, 47.5, 45.1, -50.00000000000044, 45.3, 45.5, 45.5, -50.00000000000044, 46.9, 45.5, 44.10000000000001, -50.00000000000044, 47.7, -50.00000000000044, 42.30000000000001, -50.00000000000044, 2.0999999999995893, 47.1, 44.10000000000001, 47.7, -50.00000000000044, -50.00000000000044, 45.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007], "episode_lengths": [154, 146, 38, 500, 500, 500, 44, 100, 500, 500, 500, 32, 500, 500, 500, 500, 60, 500, 32, 500, 500, 30, 500, 78, 500, 500, 96, 42, 44, 500, 500, 60, 500, 440, 40, 500, 500, 42, 500, 500, 44, 244, 34, 500, 500, 500, 500, 500, 500, 48, 44, 44, 500, 76, 26, 50, 500, 48, 46, 46, 500, 32, 46, 60, 500, 24, 500, 78, 500, 480, 30, 60, 24, 500, 500, 46, 72, 500, 500, 500, 500, 500, 500, 134, 500, 500, 500, 50, 46, 44, 500, 500, 500, 22, 500, 134, 500, 500, 500, 472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3756315012187638, "mean_inference_ms": 1.1983601902400003, "mean_action_processing_ms": 0.1399448142304143, "mean_env_wait_ms": 0.08181339049072373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028018474578857422, "StateBufferConnector_ms": 0.009998321533203125, "ViewRequirementAgentConnector_ms": 0.10438919067382812}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5266.668333919488, "num_env_steps_trained_throughput_per_sec": 5266.668333919488, "timesteps_total": 648000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 2225.376, "sample_time_ms": 1866.559, "load_time_ms": 12.442, "load_throughput": 964436.916, "learn_time_ms": 336.643, "learn_throughput": 35646.032, "synch_weights_time_ms": 8.752}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2433, "training_iteration": 54, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-26", "timestamp": 1698247106, "time_this_iter_s": 2.2831692695617676, "time_total_s": 122.48999881744385, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 122.48999881744385, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 55.333333333333336, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251569e-17, "cur_lr": 0.0003, "total_loss": 6.500501203536987, "policy_loss": -5.5188188950220746e-05, "vf_loss": 6.50059544245402, "vf_explained_var": -9.338061014811198e-08, "kl": 0.0002344880909807519, "entropy": 0.39039076765378317, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1635.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.645000000000238, "episode_len_mean": 301.94, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 25.699999999999925, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.7, 45.7, -50.00000000000044, 42.500000000000014, 47.5, 45.1, -50.00000000000044, 45.3, 45.5, 45.5, -50.00000000000044, 46.9, 45.5, 44.10000000000001, -50.00000000000044, 47.7, -50.00000000000044, 42.30000000000001, -50.00000000000044, 2.0999999999995893, 47.1, 44.10000000000001, 47.7, -50.00000000000044, -50.00000000000044, 45.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 46.5, 15.899999999999785, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 47.7, 42.10000000000001, 47.1, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, -50.00000000000044, 46.9, 46.699999999999996, -50.00000000000044, 26.09999999999993, -50.00000000000044, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 15.699999999999783], "episode_lengths": [44, 244, 34, 500, 500, 500, 500, 500, 500, 48, 44, 44, 500, 76, 26, 50, 500, 48, 46, 46, 500, 32, 46, 60, 500, 24, 500, 78, 500, 480, 30, 60, 24, 500, 500, 46, 72, 500, 500, 500, 500, 500, 500, 134, 500, 500, 500, 50, 46, 44, 500, 500, 500, 22, 500, 134, 500, 500, 500, 472, 500, 500, 500, 500, 30, 500, 500, 136, 500, 36, 342, 500, 500, 44, 500, 24, 80, 30, 500, 32, 500, 500, 74, 40, 500, 32, 34, 500, 240, 500, 46, 500, 36, 500, 194, 500, 500, 500, 296, 344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3753007167231877, "mean_inference_ms": 1.198019335890654, "mean_action_processing_ms": 0.1399238733657293, "mean_env_wait_ms": 0.08180756131830384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02901768684387207, "StateBufferConnector_ms": 0.008005619049072266, "ViewRequirementAgentConnector_ms": 0.11396598815917969}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.645000000000238, "episode_len_mean": 301.94, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 25.699999999999925, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.7, 45.7, -50.00000000000044, 42.500000000000014, 47.5, 45.1, -50.00000000000044, 45.3, 45.5, 45.5, -50.00000000000044, 46.9, 45.5, 44.10000000000001, -50.00000000000044, 47.7, -50.00000000000044, 42.30000000000001, -50.00000000000044, 2.0999999999995893, 47.1, 44.10000000000001, 47.7, -50.00000000000044, -50.00000000000044, 45.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 46.5, 15.899999999999785, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 47.7, 42.10000000000001, 47.1, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, -50.00000000000044, 46.9, 46.699999999999996, -50.00000000000044, 26.09999999999993, -50.00000000000044, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 15.699999999999783], "episode_lengths": [44, 244, 34, 500, 500, 500, 500, 500, 500, 48, 44, 44, 500, 76, 26, 50, 500, 48, 46, 46, 500, 32, 46, 60, 500, 24, 500, 78, 500, 480, 30, 60, 24, 500, 500, 46, 72, 500, 500, 500, 500, 500, 500, 134, 500, 500, 500, 50, 46, 44, 500, 500, 500, 22, 500, 134, 500, 500, 500, 472, 500, 500, 500, 500, 30, 500, 500, 136, 500, 36, 342, 500, 500, 44, 500, 24, 80, 30, 500, 32, 500, 500, 74, 40, 500, 32, 34, 500, 240, 500, 46, 500, 36, 500, 194, 500, 500, 500, 296, 344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3753007167231877, "mean_inference_ms": 1.198019335890654, "mean_action_processing_ms": 0.1399238733657293, "mean_env_wait_ms": 0.08180756131830384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02901768684387207, "StateBufferConnector_ms": 0.008005619049072266, "ViewRequirementAgentConnector_ms": 0.11396598815917969}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5307.2072213615, "num_env_steps_trained_throughput_per_sec": 5307.2072213615, "timesteps_total": 660000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 2240.812, "sample_time_ms": 1878.018, "load_time_ms": 12.843, "load_throughput": 934393.156, "learn_time_ms": 340.218, "learn_throughput": 35271.456, "synch_weights_time_ms": 8.855}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 2473, "training_iteration": 55, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-28", "timestamp": 1698247108, "time_this_iter_s": 2.26607608795166, "time_total_s": 124.75607490539551, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 124.75607490539551, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 60.96666666666667, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.5511151231257846e-18, "cur_lr": 0.0003, "total_loss": 6.5383010069529215, "policy_loss": -0.0004151890675226847, "vf_loss": 6.538751967748007, "vf_explained_var": -8.404254913330078e-07, "kl": 0.0006868859671688673, "entropy": 0.35650801956653594, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1665.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6160000000002168, "episode_len_mean": 286.7, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 46.5, 15.899999999999785, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 47.7, 42.10000000000001, 47.1, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, -50.00000000000044, 46.9, 46.699999999999996, -50.00000000000044, 26.09999999999993, -50.00000000000044, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 15.699999999999783, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 42.500000000000014, 30.9, -50.00000000000044, -50.00000000000044, 10.699999999999712, 29.49999999999998, 46.9, -50.00000000000044, 33.500000000000036, 44.300000000000004, 43.7, 41.100000000000016, 37.90000000000003, 45.3, -50.00000000000044, -50.00000000000044, 47.1, 47.1, -50.00000000000044, -50.00000000000044, 47.1, 47.3, 32.50000000000002, -50.00000000000044, -50.00000000000044, 47.7, 42.900000000000006, 45.1, 47.7, 26.299999999999933, 46.9, 37.90000000000003, 46.5, 47.5, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [50, 46, 44, 500, 500, 500, 22, 500, 134, 500, 500, 500, 472, 500, 500, 500, 500, 30, 500, 500, 136, 500, 36, 342, 500, 500, 44, 500, 24, 80, 30, 500, 32, 500, 500, 74, 40, 500, 32, 34, 500, 240, 500, 46, 500, 36, 500, 194, 500, 500, 500, 296, 344, 500, 500, 44, 500, 500, 36, 76, 192, 500, 500, 394, 206, 32, 500, 166, 58, 64, 90, 122, 48, 500, 500, 30, 30, 500, 500, 30, 28, 176, 500, 500, 24, 72, 50, 24, 238, 32, 122, 36, 26, 500, 320, 500, 500, 46, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3751947381639456, "mean_inference_ms": 1.1979113966450554, "mean_action_processing_ms": 0.13985707501641995, "mean_env_wait_ms": 0.0816697308957961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024002552032470703, "StateBufferConnector_ms": 0.007003307342529297, "ViewRequirementAgentConnector_ms": 0.10396742820739746}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6160000000002168, "episode_len_mean": 286.7, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 46.5, 15.899999999999785, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 47.7, 42.10000000000001, 47.1, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, -50.00000000000044, 46.9, 46.699999999999996, -50.00000000000044, 26.09999999999993, -50.00000000000044, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 15.699999999999783, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 42.500000000000014, 30.9, -50.00000000000044, -50.00000000000044, 10.699999999999712, 29.49999999999998, 46.9, -50.00000000000044, 33.500000000000036, 44.300000000000004, 43.7, 41.100000000000016, 37.90000000000003, 45.3, -50.00000000000044, -50.00000000000044, 47.1, 47.1, -50.00000000000044, -50.00000000000044, 47.1, 47.3, 32.50000000000002, -50.00000000000044, -50.00000000000044, 47.7, 42.900000000000006, 45.1, 47.7, 26.299999999999933, 46.9, 37.90000000000003, 46.5, 47.5, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [50, 46, 44, 500, 500, 500, 22, 500, 134, 500, 500, 500, 472, 500, 500, 500, 500, 30, 500, 500, 136, 500, 36, 342, 500, 500, 44, 500, 24, 80, 30, 500, 32, 500, 500, 74, 40, 500, 32, 34, 500, 240, 500, 46, 500, 36, 500, 194, 500, 500, 500, 296, 344, 500, 500, 44, 500, 500, 36, 76, 192, 500, 500, 394, 206, 32, 500, 166, 58, 64, 90, 122, 48, 500, 500, 30, 30, 500, 500, 30, 28, 176, 500, 500, 24, 72, 50, 24, 238, 32, 122, 36, 26, 500, 320, 500, 500, 46, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3751947381639456, "mean_inference_ms": 1.1979113966450554, "mean_action_processing_ms": 0.13985707501641995, "mean_env_wait_ms": 0.0816697308957961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024002552032470703, "StateBufferConnector_ms": 0.007003307342529297, "ViewRequirementAgentConnector_ms": 0.10396742820739746}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5254.095304268236, "num_env_steps_trained_throughput_per_sec": 5254.095304268236, "timesteps_total": 672000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 2246.096, "sample_time_ms": 1895.354, "load_time_ms": 12.244, "load_throughput": 980109.244, "learn_time_ms": 328.562, "learn_throughput": 36522.793, "synch_weights_time_ms": 8.958}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 2520, "training_iteration": 56, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-30", "timestamp": 1698247110, "time_this_iter_s": 2.288677453994751, "time_total_s": 127.04475235939026, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 127.04475235939026, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 57.13333333333333, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7755575615628923e-18, "cur_lr": 0.0003, "total_loss": 5.92919724782308, "policy_loss": -0.0003178777794043223, "vf_loss": 5.929550758997599, "vf_explained_var": -5.503495534261067e-07, "kl": 0.0004528677776616992, "entropy": 0.3566874285538991, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1695.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.2450000000002067, "episode_len_mean": 278.0, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, 26.09999999999993, -50.00000000000044, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 15.699999999999783, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 42.500000000000014, 30.9, -50.00000000000044, -50.00000000000044, 10.699999999999712, 29.49999999999998, 46.9, -50.00000000000044, 33.500000000000036, 44.300000000000004, 43.7, 41.100000000000016, 37.90000000000003, 45.3, -50.00000000000044, -50.00000000000044, 47.1, 47.1, -50.00000000000044, -50.00000000000044, 47.1, 47.3, 32.50000000000002, -50.00000000000044, -50.00000000000044, 47.7, 42.900000000000006, 45.1, 47.7, 26.299999999999933, 46.9, 37.90000000000003, 46.5, 47.5, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 38.10000000000002, 45.1, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.3, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 34.10000000000004, 46.5, 31.500000000000007], "episode_lengths": [34, 500, 240, 500, 46, 500, 36, 500, 194, 500, 500, 500, 296, 344, 500, 500, 44, 500, 500, 36, 76, 192, 500, 500, 394, 206, 32, 500, 166, 58, 64, 90, 122, 48, 500, 500, 30, 30, 500, 500, 30, 28, 176, 500, 500, 24, 72, 50, 24, 238, 32, 122, 36, 26, 500, 320, 500, 500, 46, 500, 500, 120, 50, 30, 500, 40, 500, 28, 34, 500, 44, 500, 500, 34, 500, 500, 500, 100, 500, 76, 500, 28, 500, 148, 500, 500, 500, 32, 500, 500, 40, 500, 48, 500, 500, 500, 64, 160, 36, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3751447615418778, "mean_inference_ms": 1.1986854158225828, "mean_action_processing_ms": 0.13990178977754644, "mean_env_wait_ms": 0.08156138436493217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023005247116088867, "StateBufferConnector_ms": 0.0070035457611083984, "ViewRequirementAgentConnector_ms": 0.10895204544067383}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.2450000000002067, "episode_len_mean": 278.0, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, 26.09999999999993, -50.00000000000044, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 15.699999999999783, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 42.500000000000014, 30.9, -50.00000000000044, -50.00000000000044, 10.699999999999712, 29.49999999999998, 46.9, -50.00000000000044, 33.500000000000036, 44.300000000000004, 43.7, 41.100000000000016, 37.90000000000003, 45.3, -50.00000000000044, -50.00000000000044, 47.1, 47.1, -50.00000000000044, -50.00000000000044, 47.1, 47.3, 32.50000000000002, -50.00000000000044, -50.00000000000044, 47.7, 42.900000000000006, 45.1, 47.7, 26.299999999999933, 46.9, 37.90000000000003, 46.5, 47.5, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 38.10000000000002, 45.1, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.3, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 34.10000000000004, 46.5, 31.500000000000007], "episode_lengths": [34, 500, 240, 500, 46, 500, 36, 500, 194, 500, 500, 500, 296, 344, 500, 500, 44, 500, 500, 36, 76, 192, 500, 500, 394, 206, 32, 500, 166, 58, 64, 90, 122, 48, 500, 500, 30, 30, 500, 500, 30, 28, 176, 500, 500, 24, 72, 50, 24, 238, 32, 122, 36, 26, 500, 320, 500, 500, 46, 500, 500, 120, 50, 30, 500, 40, 500, 28, 34, 500, 44, 500, 500, 34, 500, 500, 500, 100, 500, 76, 500, 28, 500, 148, 500, 500, 500, 32, 500, 500, 40, 500, 48, 500, 500, 500, 64, 160, 36, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3751447615418778, "mean_inference_ms": 1.1986854158225828, "mean_action_processing_ms": 0.13990178977754644, "mean_env_wait_ms": 0.08156138436493217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023005247116088867, "StateBufferConnector_ms": 0.0070035457611083984, "ViewRequirementAgentConnector_ms": 0.10895204544067383}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4929.7021824750855, "num_env_steps_trained_throughput_per_sec": 4929.7021824750855, "timesteps_total": 684000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 2270.573, "sample_time_ms": 1899.101, "load_time_ms": 13.444, "load_throughput": 892560.197, "learn_time_ms": 347.988, "learn_throughput": 34483.975, "synch_weights_time_ms": 8.961}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2559, "training_iteration": 57, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-33", "timestamp": 1698247113, "time_this_iter_s": 2.4392220973968506, "time_total_s": 129.4839744567871, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 129.4839744567871, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 55.775000000000006, "ram_util_percent": 26.625000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3877787807814461e-18, "cur_lr": 0.0003, "total_loss": 6.701143026351929, "policy_loss": -0.0003869401601453622, "vf_loss": 6.701565170288086, "vf_explained_var": 1.3510386149088542e-06, "kl": 0.0004868930028806062, "entropy": 0.3522746354341507, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1725.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.245000000000222, "episode_len_mean": 287.98, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.7, 42.900000000000006, 45.1, 47.7, 26.299999999999933, 46.9, 37.90000000000003, 46.5, 47.5, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 38.10000000000002, 45.1, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.3, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 34.10000000000004, 46.5, 31.500000000000007, -50.00000000000044, 47.1, -50.00000000000044, 24.69999999999991, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 36.10000000000004, 12.499999999999737, 45.9, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 8.899999999999686, 47.5, 45.5, 41.500000000000014, 47.5, -50.00000000000044, 32.700000000000024, 47.3, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 46.5, 47.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 24, 72, 50, 24, 238, 32, 122, 36, 26, 500, 320, 500, 500, 46, 500, 500, 120, 50, 30, 500, 40, 500, 28, 34, 500, 44, 500, 500, 34, 500, 500, 500, 100, 500, 76, 500, 28, 500, 148, 500, 500, 500, 32, 500, 500, 40, 500, 48, 500, 500, 500, 64, 160, 36, 186, 500, 30, 500, 254, 500, 500, 70, 48, 500, 408, 500, 500, 140, 376, 42, 500, 44, 30, 500, 412, 26, 46, 86, 26, 500, 174, 28, 500, 498, 500, 36, 30, 100, 500, 500, 500, 62, 44, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3753455160026535, "mean_inference_ms": 1.1990175138540478, "mean_action_processing_ms": 0.13981263601462415, "mean_env_wait_ms": 0.08180476063260723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026001453399658203, "StateBufferConnector_ms": 0.01099538803100586, "ViewRequirementAgentConnector_ms": 0.11796236038208008}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.245000000000222, "episode_len_mean": 287.98, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.7, 42.900000000000006, 45.1, 47.7, 26.299999999999933, 46.9, 37.90000000000003, 46.5, 47.5, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 38.10000000000002, 45.1, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.3, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 34.10000000000004, 46.5, 31.500000000000007, -50.00000000000044, 47.1, -50.00000000000044, 24.69999999999991, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 36.10000000000004, 12.499999999999737, 45.9, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 8.899999999999686, 47.5, 45.5, 41.500000000000014, 47.5, -50.00000000000044, 32.700000000000024, 47.3, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 46.5, 47.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 24, 72, 50, 24, 238, 32, 122, 36, 26, 500, 320, 500, 500, 46, 500, 500, 120, 50, 30, 500, 40, 500, 28, 34, 500, 44, 500, 500, 34, 500, 500, 500, 100, 500, 76, 500, 28, 500, 148, 500, 500, 500, 32, 500, 500, 40, 500, 48, 500, 500, 500, 64, 160, 36, 186, 500, 30, 500, 254, 500, 500, 70, 48, 500, 408, 500, 500, 140, 376, 42, 500, 44, 30, 500, 412, 26, 46, 86, 26, 500, 174, 28, 500, 498, 500, 36, 30, 100, 500, 500, 500, 62, 44, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3753455160026535, "mean_inference_ms": 1.1990175138540478, "mean_action_processing_ms": 0.13981263601462415, "mean_env_wait_ms": 0.08180476063260723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026001453399658203, "StateBufferConnector_ms": 0.01099538803100586, "ViewRequirementAgentConnector_ms": 0.11796236038208008}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5550.417657182891, "num_env_steps_trained_throughput_per_sec": 5550.417657182891, "timesteps_total": 696000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 2265.553, "sample_time_ms": 1902.802, "load_time_ms": 12.415, "load_throughput": 966548.27, "learn_time_ms": 340.49, "learn_throughput": 35243.323, "synch_weights_time_ms": 8.867}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 2602, "training_iteration": 58, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-35", "timestamp": 1698247115, "time_this_iter_s": 2.166999578475952, "time_total_s": 131.65097403526306, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 131.65097403526306, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 57.800000000000004, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.938893903907231e-19, "cur_lr": 0.0003, "total_loss": 6.241821765899658, "policy_loss": -0.00019385355214277902, "vf_loss": 6.24204797744751, "vf_explained_var": -1.6967455546061197e-06, "kl": 0.00030529362248253497, "entropy": 0.323600930472215, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1755.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.254000000000239, "episode_len_mean": 303.04, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 34.10000000000004, 46.5, 31.500000000000007, -50.00000000000044, 47.1, -50.00000000000044, 24.69999999999991, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 36.10000000000004, 12.499999999999737, 45.9, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 8.899999999999686, 47.5, 45.5, 41.500000000000014, 47.5, -50.00000000000044, 32.700000000000024, 47.3, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 46.5, 47.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.7, 23.499999999999893, 36.70000000000003, 46.3, 44.300000000000004, -50.00000000000044, 46.3, 46.099999999999994, 45.9, -50.00000000000044, 47.5, 47.9, 46.9, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044], "episode_lengths": [148, 500, 500, 500, 32, 500, 500, 40, 500, 48, 500, 500, 500, 64, 160, 36, 186, 500, 30, 500, 254, 500, 500, 70, 48, 500, 408, 500, 500, 140, 376, 42, 500, 44, 30, 500, 412, 26, 46, 86, 26, 500, 174, 28, 500, 498, 500, 36, 30, 100, 500, 500, 500, 62, 44, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 28, 24, 266, 134, 38, 58, 500, 38, 40, 42, 500, 26, 22, 32, 500, 24, 500, 500, 500, 28, 40, 500, 500, 500, 66, 500, 500, 494, 84, 500, 500, 500, 96, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37549555092743125, "mean_inference_ms": 1.198915253202967, "mean_action_processing_ms": 0.13988894043778782, "mean_env_wait_ms": 0.08186719862985069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025001049041748047, "StateBufferConnector_ms": 0.009997844696044922, "ViewRequirementAgentConnector_ms": 0.11899304389953613}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.254000000000239, "episode_len_mean": 303.04, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 34.10000000000004, 46.5, 31.500000000000007, -50.00000000000044, 47.1, -50.00000000000044, 24.69999999999991, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 36.10000000000004, 12.499999999999737, 45.9, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 8.899999999999686, 47.5, 45.5, 41.500000000000014, 47.5, -50.00000000000044, 32.700000000000024, 47.3, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 46.5, 47.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.7, 23.499999999999893, 36.70000000000003, 46.3, 44.300000000000004, -50.00000000000044, 46.3, 46.099999999999994, 45.9, -50.00000000000044, 47.5, 47.9, 46.9, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044], "episode_lengths": [148, 500, 500, 500, 32, 500, 500, 40, 500, 48, 500, 500, 500, 64, 160, 36, 186, 500, 30, 500, 254, 500, 500, 70, 48, 500, 408, 500, 500, 140, 376, 42, 500, 44, 30, 500, 412, 26, 46, 86, 26, 500, 174, 28, 500, 498, 500, 36, 30, 100, 500, 500, 500, 62, 44, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 28, 24, 266, 134, 38, 58, 500, 38, 40, 42, 500, 26, 22, 32, 500, 24, 500, 500, 500, 28, 40, 500, 500, 500, 66, 500, 500, 494, 84, 500, 500, 500, 96, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37549555092743125, "mean_inference_ms": 1.198915253202967, "mean_action_processing_ms": 0.13988894043778782, "mean_env_wait_ms": 0.08186719862985069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025001049041748047, "StateBufferConnector_ms": 0.009997844696044922, "ViewRequirementAgentConnector_ms": 0.11899304389953613}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5469.410446633972, "num_env_steps_trained_throughput_per_sec": 5469.410446633972, "timesteps_total": 708000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 2273.056, "sample_time_ms": 1899.085, "load_time_ms": 13.39, "load_throughput": 896221.995, "learn_time_ms": 350.61, "learn_throughput": 34226.064, "synch_weights_time_ms": 8.993}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 2642, "training_iteration": 59, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-37", "timestamp": 1698247117, "time_this_iter_s": 2.1990203857421875, "time_total_s": 133.84999442100525, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 133.84999442100525, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 55.4, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.4694469519536153e-19, "cur_lr": 0.0003, "total_loss": 6.1809062480926515, "policy_loss": -0.0008325464402635892, "vf_loss": 6.181773535410563, "vf_explained_var": -1.0271867116292318e-06, "kl": 0.000805703101745318, "entropy": 0.3473154495159785, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1785.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.9110000000002247, "episode_len_mean": 284.62, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 47.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.7, 23.499999999999893, 36.70000000000003, 46.3, 44.300000000000004, -50.00000000000044, 46.3, 46.099999999999994, 45.9, -50.00000000000044, 47.5, 47.9, 46.9, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, 47.7, 47.1, 47.5, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.70000000000004, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, 45.9, 46.3, 46.5, 46.699999999999996, -50.00000000000044, 14.299999999999763, 38.700000000000024, 41.90000000000001, 38.700000000000024, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 47.3, 45.3, 47.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 36, 30, 100, 500, 500, 500, 62, 44, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 28, 24, 266, 134, 38, 58, 500, 38, 40, 42, 500, 26, 22, 32, 500, 24, 500, 500, 500, 28, 40, 500, 500, 500, 66, 500, 500, 494, 84, 500, 500, 500, 96, 500, 26, 500, 500, 24, 500, 60, 40, 500, 24, 30, 26, 500, 98, 500, 154, 500, 44, 500, 34, 42, 38, 36, 34, 500, 358, 114, 82, 114, 500, 360, 500, 500, 500, 500, 22, 28, 48, 24, 80, 500, 500, 130, 500, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37573650971290895, "mean_inference_ms": 1.1983474393302371, "mean_action_processing_ms": 0.13968659147846663, "mean_env_wait_ms": 0.08202739865368366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022998809814453125, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.12098407745361328}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.9110000000002247, "episode_len_mean": 284.62, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 47.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.7, 23.499999999999893, 36.70000000000003, 46.3, 44.300000000000004, -50.00000000000044, 46.3, 46.099999999999994, 45.9, -50.00000000000044, 47.5, 47.9, 46.9, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, 47.7, 47.1, 47.5, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.70000000000004, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, 45.9, 46.3, 46.5, 46.699999999999996, -50.00000000000044, 14.299999999999763, 38.700000000000024, 41.90000000000001, 38.700000000000024, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 47.3, 45.3, 47.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 36, 30, 100, 500, 500, 500, 62, 44, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 28, 24, 266, 134, 38, 58, 500, 38, 40, 42, 500, 26, 22, 32, 500, 24, 500, 500, 500, 28, 40, 500, 500, 500, 66, 500, 500, 494, 84, 500, 500, 500, 96, 500, 26, 500, 500, 24, 500, 60, 40, 500, 24, 30, 26, 500, 98, 500, 154, 500, 44, 500, 34, 42, 38, 36, 34, 500, 358, 114, 82, 114, 500, 360, 500, 500, 500, 500, 22, 28, 48, 24, 80, 500, 500, 130, 500, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37573650971290895, "mean_inference_ms": 1.1983474393302371, "mean_action_processing_ms": 0.13968659147846663, "mean_env_wait_ms": 0.08202739865368366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022998809814453125, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.12098407745361328}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5338.976006687026, "num_env_steps_trained_throughput_per_sec": 5338.976006687026, "timesteps_total": 720000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 2276.668, "sample_time_ms": 1912.549, "load_time_ms": 12.489, "load_throughput": 960821.014, "learn_time_ms": 341.559, "learn_throughput": 35132.973, "synch_weights_time_ms": 9.091}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2688, "training_iteration": 60, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-40", "timestamp": 1698247120, "time_this_iter_s": 2.2526204586029053, "time_total_s": 136.10261487960815, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 136.10261487960815, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 60.13333333333333, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768077e-19, "cur_lr": 0.0003, "total_loss": 6.802985795338949, "policy_loss": -0.000665970395008723, "vf_loss": 6.803692515691122, "vf_explained_var": -1.239776611328125e-06, "kl": 0.0005162838572497701, "entropy": 0.4069094936052958, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1815.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.78099999999983, "episode_len_mean": 237.84, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.7, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, 47.7, 47.1, 47.5, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.70000000000004, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, 45.9, 46.3, 46.5, 46.699999999999996, -50.00000000000044, 14.299999999999763, 38.700000000000024, 41.90000000000001, 38.700000000000024, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 47.3, 45.3, 47.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 7.499999999999666, 45.1, 35.30000000000004, 45.7, -50.00000000000044, 41.90000000000001, 38.700000000000024, 44.300000000000004, 46.5, 38.50000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 15.299999999999777, 46.099999999999994, 42.900000000000006, 32.700000000000024, 42.70000000000001, 44.900000000000006, 17.299999999999805, -50.00000000000044, 45.3, 40.90000000000002, 46.099999999999994, 47.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 5.099999999999632, -50.00000000000044, 11.699999999999726, 47.5, 45.3, 44.5, 36.30000000000003, -50.00000000000044, 45.3, -50.00000000000044, 47.1, -50.00000000000044, 44.10000000000001, 47.3, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.5, 46.3, 46.9, -50.00000000000044], "episode_lengths": [500, 24, 500, 60, 40, 500, 24, 30, 26, 500, 98, 500, 154, 500, 44, 500, 34, 42, 38, 36, 34, 500, 358, 114, 82, 114, 500, 360, 500, 500, 500, 500, 22, 28, 48, 24, 80, 500, 500, 130, 500, 40, 500, 500, 500, 134, 426, 50, 148, 44, 500, 82, 114, 58, 36, 116, 70, 500, 500, 500, 160, 348, 40, 72, 174, 74, 52, 328, 500, 48, 92, 40, 28, 500, 40, 500, 450, 500, 384, 26, 48, 56, 138, 500, 48, 500, 30, 500, 60, 28, 500, 30, 500, 500, 500, 22, 36, 38, 32, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37555511782371825, "mean_inference_ms": 1.197619446704333, "mean_action_processing_ms": 0.1394812619332724, "mean_env_wait_ms": 0.0820278251816622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0260007381439209, "StateBufferConnector_ms": 0.007999658584594727, "ViewRequirementAgentConnector_ms": 0.12497663497924805}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.78099999999983, "episode_len_mean": 237.84, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.7, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, 47.7, 47.1, 47.5, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.70000000000004, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, 45.9, 46.3, 46.5, 46.699999999999996, -50.00000000000044, 14.299999999999763, 38.700000000000024, 41.90000000000001, 38.700000000000024, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 47.3, 45.3, 47.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 7.499999999999666, 45.1, 35.30000000000004, 45.7, -50.00000000000044, 41.90000000000001, 38.700000000000024, 44.300000000000004, 46.5, 38.50000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 15.299999999999777, 46.099999999999994, 42.900000000000006, 32.700000000000024, 42.70000000000001, 44.900000000000006, 17.299999999999805, -50.00000000000044, 45.3, 40.90000000000002, 46.099999999999994, 47.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 5.099999999999632, -50.00000000000044, 11.699999999999726, 47.5, 45.3, 44.5, 36.30000000000003, -50.00000000000044, 45.3, -50.00000000000044, 47.1, -50.00000000000044, 44.10000000000001, 47.3, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.5, 46.3, 46.9, -50.00000000000044], "episode_lengths": [500, 24, 500, 60, 40, 500, 24, 30, 26, 500, 98, 500, 154, 500, 44, 500, 34, 42, 38, 36, 34, 500, 358, 114, 82, 114, 500, 360, 500, 500, 500, 500, 22, 28, 48, 24, 80, 500, 500, 130, 500, 40, 500, 500, 500, 134, 426, 50, 148, 44, 500, 82, 114, 58, 36, 116, 70, 500, 500, 500, 160, 348, 40, 72, 174, 74, 52, 328, 500, 48, 92, 40, 28, 500, 40, 500, 450, 500, 384, 26, 48, 56, 138, 500, 48, 500, 30, 500, 60, 28, 500, 30, 500, 500, 500, 22, 36, 38, 32, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37555511782371825, "mean_inference_ms": 1.197619446704333, "mean_action_processing_ms": 0.1394812619332724, "mean_env_wait_ms": 0.0820278251816622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0260007381439209, "StateBufferConnector_ms": 0.007999658584594727, "ViewRequirementAgentConnector_ms": 0.12497663497924805}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5226.775542316024, "num_env_steps_trained_throughput_per_sec": 5226.775542316024, "timesteps_total": 732000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 2272.481, "sample_time_ms": 1893.252, "load_time_ms": 13.189, "load_throughput": 909825.687, "learn_time_ms": 356.012, "learn_throughput": 33706.748, "synch_weights_time_ms": 9.048}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 2744, "training_iteration": 61, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-42", "timestamp": 1698247122, "time_this_iter_s": 2.3008689880371094, "time_total_s": 138.40348386764526, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 138.40348386764526, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 56.800000000000004, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884038e-20, "cur_lr": 0.0003, "total_loss": 6.236751651763916, "policy_loss": -0.0004150517284870148, "vf_loss": 6.237205918629964, "vf_explained_var": -1.7484029134114582e-07, "kl": 0.0004425653137398437, "entropy": 0.39174447655677797, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1845.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6389999999998026, "episode_len_mean": 269.2, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 47.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 7.499999999999666, 45.1, 35.30000000000004, 45.7, -50.00000000000044, 41.90000000000001, 38.700000000000024, 44.300000000000004, 46.5, 38.50000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 15.299999999999777, 46.099999999999994, 42.900000000000006, 32.700000000000024, 42.70000000000001, 44.900000000000006, 17.299999999999805, -50.00000000000044, 45.3, 40.90000000000002, 46.099999999999994, 47.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 5.099999999999632, -50.00000000000044, 11.699999999999726, 47.5, 45.3, 44.5, 36.30000000000003, -50.00000000000044, 45.3, -50.00000000000044, 47.1, -50.00000000000044, 44.10000000000001, 47.3, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.5, 46.3, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 43.7, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 47.7, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 33.70000000000004, 46.3, -50.00000000000044, -50.00000000000044, 22.899999999999885, 44.7, -50.00000000000044], "episode_lengths": [48, 24, 80, 500, 500, 130, 500, 40, 500, 500, 500, 134, 426, 50, 148, 44, 500, 82, 114, 58, 36, 116, 70, 500, 500, 500, 160, 348, 40, 72, 174, 74, 52, 328, 500, 48, 92, 40, 28, 500, 40, 500, 450, 500, 384, 26, 48, 56, 138, 500, 48, 500, 30, 500, 60, 28, 500, 30, 500, 500, 500, 22, 36, 38, 32, 500, 500, 500, 500, 118, 106, 500, 500, 44, 56, 42, 500, 500, 500, 444, 64, 500, 500, 130, 500, 24, 500, 270, 500, 500, 500, 72, 500, 164, 38, 500, 500, 272, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3752234452773067, "mean_inference_ms": 1.1973674421566716, "mean_action_processing_ms": 0.13954926183090563, "mean_env_wait_ms": 0.08184837998107634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022999286651611328, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.12398362159729004}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6389999999998026, "episode_len_mean": 269.2, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 47.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 7.499999999999666, 45.1, 35.30000000000004, 45.7, -50.00000000000044, 41.90000000000001, 38.700000000000024, 44.300000000000004, 46.5, 38.50000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 15.299999999999777, 46.099999999999994, 42.900000000000006, 32.700000000000024, 42.70000000000001, 44.900000000000006, 17.299999999999805, -50.00000000000044, 45.3, 40.90000000000002, 46.099999999999994, 47.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 5.099999999999632, -50.00000000000044, 11.699999999999726, 47.5, 45.3, 44.5, 36.30000000000003, -50.00000000000044, 45.3, -50.00000000000044, 47.1, -50.00000000000044, 44.10000000000001, 47.3, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.5, 46.3, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 43.7, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 47.7, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 33.70000000000004, 46.3, -50.00000000000044, -50.00000000000044, 22.899999999999885, 44.7, -50.00000000000044], "episode_lengths": [48, 24, 80, 500, 500, 130, 500, 40, 500, 500, 500, 134, 426, 50, 148, 44, 500, 82, 114, 58, 36, 116, 70, 500, 500, 500, 160, 348, 40, 72, 174, 74, 52, 328, 500, 48, 92, 40, 28, 500, 40, 500, 450, 500, 384, 26, 48, 56, 138, 500, 48, 500, 30, 500, 60, 28, 500, 30, 500, 500, 500, 22, 36, 38, 32, 500, 500, 500, 500, 118, 106, 500, 500, 44, 56, 42, 500, 500, 500, 444, 64, 500, 500, 130, 500, 24, 500, 270, 500, 500, 500, 72, 500, 164, 38, 500, 500, 272, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3752234452773067, "mean_inference_ms": 1.1973674421566716, "mean_action_processing_ms": 0.13954926183090563, "mean_env_wait_ms": 0.08184837998107634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022999286651611328, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.12398362159729004}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5698.283234689351, "num_env_steps_trained_throughput_per_sec": 5698.283234689351, "timesteps_total": 744000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 2245.382, "sample_time_ms": 1888.833, "load_time_ms": 12.088, "load_throughput": 992689.641, "learn_time_ms": 334.279, "learn_throughput": 35898.204, "synch_weights_time_ms": 9.182}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 2778, "training_iteration": 62, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-44", "timestamp": 1698247124, "time_this_iter_s": 2.1106529235839844, "time_total_s": 140.51413679122925, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 140.51413679122925, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 52.46666666666667, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.336808689942019e-20, "cur_lr": 0.0003, "total_loss": 6.4119970321655275, "policy_loss": -7.75270164012909e-05, "vf_loss": 6.412119881312052, "vf_explained_var": -1.1761983235677084e-06, "kl": 0.00043638049164987554, "entropy": 0.45160791476567586, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1875.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.36100000000020593, "episode_len_mean": 279.16, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 36.30000000000003, -50.00000000000044, 45.3, -50.00000000000044, 47.1, -50.00000000000044, 44.10000000000001, 47.3, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.5, 46.3, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 43.7, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 47.7, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 33.70000000000004, 46.3, -50.00000000000044, -50.00000000000044, 22.899999999999885, 44.7, -50.00000000000044, 30.9, 40.30000000000002, 44.7, 44.10000000000001, 47.3, 44.7, 47.5, 46.9, -50.00000000000044, 46.5, 41.100000000000016, -50.00000000000044, 46.099999999999994, 43.10000000000001, 34.50000000000004, 43.7, 45.7, -50.00000000000044, -50.00000000000044, 32.90000000000003, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 36.70000000000003, 45.3, -50.00000000000044, -50.00000000000044, 17.299999999999805, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 45.9, 32.50000000000002, -50.00000000000044, -50.00000000000044, 20.099999999999845, 47.3, 45.9], "episode_lengths": [56, 138, 500, 48, 500, 30, 500, 60, 28, 500, 30, 500, 500, 500, 22, 36, 38, 32, 500, 500, 500, 500, 118, 106, 500, 500, 44, 56, 42, 500, 500, 500, 444, 64, 500, 500, 130, 500, 24, 500, 270, 500, 500, 500, 72, 500, 164, 38, 500, 500, 272, 54, 500, 192, 98, 54, 60, 28, 54, 26, 32, 500, 36, 90, 500, 40, 70, 156, 64, 44, 500, 500, 172, 48, 500, 500, 500, 164, 500, 500, 500, 46, 134, 48, 500, 500, 328, 78, 500, 500, 500, 500, 350, 42, 176, 500, 500, 300, 28, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37446159955067926, "mean_inference_ms": 1.1964761423935446, "mean_action_processing_ms": 0.13941561824034768, "mean_env_wait_ms": 0.08192530137707467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017345428466796875, "StateBufferConnector_ms": 0.007999658584594727, "ViewRequirementAgentConnector_ms": 0.12574410438537598}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.36100000000020593, "episode_len_mean": 279.16, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 36.30000000000003, -50.00000000000044, 45.3, -50.00000000000044, 47.1, -50.00000000000044, 44.10000000000001, 47.3, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.5, 46.3, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 43.7, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 47.7, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 33.70000000000004, 46.3, -50.00000000000044, -50.00000000000044, 22.899999999999885, 44.7, -50.00000000000044, 30.9, 40.30000000000002, 44.7, 44.10000000000001, 47.3, 44.7, 47.5, 46.9, -50.00000000000044, 46.5, 41.100000000000016, -50.00000000000044, 46.099999999999994, 43.10000000000001, 34.50000000000004, 43.7, 45.7, -50.00000000000044, -50.00000000000044, 32.90000000000003, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 36.70000000000003, 45.3, -50.00000000000044, -50.00000000000044, 17.299999999999805, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 45.9, 32.50000000000002, -50.00000000000044, -50.00000000000044, 20.099999999999845, 47.3, 45.9], "episode_lengths": [56, 138, 500, 48, 500, 30, 500, 60, 28, 500, 30, 500, 500, 500, 22, 36, 38, 32, 500, 500, 500, 500, 118, 106, 500, 500, 44, 56, 42, 500, 500, 500, 444, 64, 500, 500, 130, 500, 24, 500, 270, 500, 500, 500, 72, 500, 164, 38, 500, 500, 272, 54, 500, 192, 98, 54, 60, 28, 54, 26, 32, 500, 36, 90, 500, 40, 70, 156, 64, 44, 500, 500, 172, 48, 500, 500, 500, 164, 500, 500, 500, 46, 134, 48, 500, 500, 328, 78, 500, 500, 500, 500, 350, 42, 176, 500, 500, 300, 28, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37446159955067926, "mean_inference_ms": 1.1964761423935446, "mean_action_processing_ms": 0.13941561824034768, "mean_env_wait_ms": 0.08192530137707467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017345428466796875, "StateBufferConnector_ms": 0.007999658584594727, "ViewRequirementAgentConnector_ms": 0.12574410438537598}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5445.581563225644, "num_env_steps_trained_throughput_per_sec": 5445.581563225644, "timesteps_total": 756000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 2246.674, "sample_time_ms": 1882.865, "load_time_ms": 12.287, "load_throughput": 976628.965, "learn_time_ms": 341.313, "learn_throughput": 35158.346, "synch_weights_time_ms": 9.21}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2825, "training_iteration": 63, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-46", "timestamp": 1698247126, "time_this_iter_s": 2.208622694015503, "time_total_s": 142.72275948524475, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 142.72275948524475, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 51.25, "ram_util_percent": 26.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710096e-20, "cur_lr": 0.0003, "total_loss": 6.073337872823079, "policy_loss": -0.0005319098631540935, "vf_loss": 6.07391718228658, "vf_explained_var": -1.613299051920573e-06, "kl": 0.0012893740734019352, "entropy": 0.47383881111939746, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1905.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7239999999998022, "episode_len_mean": 273.32, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 33.70000000000004, 46.3, -50.00000000000044, -50.00000000000044, 22.899999999999885, 44.7, -50.00000000000044, 30.9, 40.30000000000002, 44.7, 44.10000000000001, 47.3, 44.7, 47.5, 46.9, -50.00000000000044, 46.5, 41.100000000000016, -50.00000000000044, 46.099999999999994, 43.10000000000001, 34.50000000000004, 43.7, 45.7, -50.00000000000044, -50.00000000000044, 32.90000000000003, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 36.70000000000003, 45.3, -50.00000000000044, -50.00000000000044, 17.299999999999805, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 45.9, 32.50000000000002, -50.00000000000044, -50.00000000000044, 20.099999999999845, 47.3, 45.9, -50.00000000000044, 39.90000000000002, 38.50000000000003, 28.29999999999996, 45.9, 34.50000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 47.1, -50.00000000000044, 45.1, 46.099999999999994, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, 30.099999999999987, 39.70000000000002, 46.5], "episode_lengths": [500, 500, 72, 500, 164, 38, 500, 500, 272, 54, 500, 192, 98, 54, 60, 28, 54, 26, 32, 500, 36, 90, 500, 40, 70, 156, 64, 44, 500, 500, 172, 48, 500, 500, 500, 164, 500, 500, 500, 46, 134, 48, 500, 500, 328, 78, 500, 500, 500, 500, 350, 42, 176, 500, 500, 300, 28, 42, 500, 102, 116, 218, 42, 156, 34, 500, 500, 34, 64, 500, 500, 44, 32, 500, 30, 500, 50, 40, 500, 32, 500, 500, 30, 30, 500, 500, 500, 500, 500, 62, 500, 52, 500, 500, 500, 224, 500, 200, 104, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3740708639078906, "mean_inference_ms": 1.1975086559887151, "mean_action_processing_ms": 0.13918245790774406, "mean_env_wait_ms": 0.0815759822317814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023342609405517578, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.11673927307128906}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7239999999998022, "episode_len_mean": 273.32, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 33.70000000000004, 46.3, -50.00000000000044, -50.00000000000044, 22.899999999999885, 44.7, -50.00000000000044, 30.9, 40.30000000000002, 44.7, 44.10000000000001, 47.3, 44.7, 47.5, 46.9, -50.00000000000044, 46.5, 41.100000000000016, -50.00000000000044, 46.099999999999994, 43.10000000000001, 34.50000000000004, 43.7, 45.7, -50.00000000000044, -50.00000000000044, 32.90000000000003, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 36.70000000000003, 45.3, -50.00000000000044, -50.00000000000044, 17.299999999999805, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 45.9, 32.50000000000002, -50.00000000000044, -50.00000000000044, 20.099999999999845, 47.3, 45.9, -50.00000000000044, 39.90000000000002, 38.50000000000003, 28.29999999999996, 45.9, 34.50000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 47.1, -50.00000000000044, 45.1, 46.099999999999994, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, 30.099999999999987, 39.70000000000002, 46.5], "episode_lengths": [500, 500, 72, 500, 164, 38, 500, 500, 272, 54, 500, 192, 98, 54, 60, 28, 54, 26, 32, 500, 36, 90, 500, 40, 70, 156, 64, 44, 500, 500, 172, 48, 500, 500, 500, 164, 500, 500, 500, 46, 134, 48, 500, 500, 328, 78, 500, 500, 500, 500, 350, 42, 176, 500, 500, 300, 28, 42, 500, 102, 116, 218, 42, 156, 34, 500, 500, 34, 64, 500, 500, 44, 32, 500, 30, 500, 50, 40, 500, 32, 500, 500, 30, 30, 500, 500, 500, 500, 500, 62, 500, 52, 500, 500, 500, 224, 500, 200, 104, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3740708639078906, "mean_inference_ms": 1.1975086559887151, "mean_action_processing_ms": 0.13918245790774406, "mean_env_wait_ms": 0.0815759822317814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023342609405517578, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.11673927307128906}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5380.921947434401, "num_env_steps_trained_throughput_per_sec": 5380.921947434401, "timesteps_total": 768000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 2241.837, "sample_time_ms": 1888.228, "load_time_ms": 11.516, "load_throughput": 1042002.7, "learn_time_ms": 331.583, "learn_throughput": 36190.078, "synch_weights_time_ms": 9.511}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 2867, "training_iteration": 64, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-49", "timestamp": 1698247129, "time_this_iter_s": 2.235097885131836, "time_total_s": 144.9578573703766, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 144.9578573703766, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 59.833333333333336, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855048e-20, "cur_lr": 0.0003, "total_loss": 6.704634300867716, "policy_loss": -0.00033673613021771115, "vf_loss": 6.705016231536865, "vf_explained_var": -1.3073285420735677e-06, "kl": 0.0005925972684584243, "entropy": 0.4518606593211492, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1935.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.331999999999816, "episode_len_mean": 257.28, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 20.099999999999845, 47.3, 45.9, -50.00000000000044, 39.90000000000002, 38.50000000000003, 28.29999999999996, 45.9, 34.50000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 47.1, -50.00000000000044, 45.1, 46.099999999999994, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, 30.099999999999987, 39.70000000000002, 46.5, 46.3, 31.70000000000001, 30.29999999999999, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 38.10000000000002, 40.500000000000014, 45.5, 35.30000000000004, -50.00000000000044, 44.300000000000004, 46.099999999999994, 45.7, 46.9, -50.00000000000044, -50.00000000000044, 46.9, 32.50000000000002, 38.700000000000024, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 47.5, 33.90000000000004, 8.099999999999675, 45.7, 25.699999999999925, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.699999999999996, 46.699999999999996, -50.00000000000044, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, 46.5, 39.70000000000002, 44.5, 38.90000000000002, -50.00000000000044, 43.10000000000001], "episode_lengths": [500, 500, 300, 28, 42, 500, 102, 116, 218, 42, 156, 34, 500, 500, 34, 64, 500, 500, 44, 32, 500, 30, 500, 50, 40, 500, 32, 500, 500, 30, 30, 500, 500, 500, 500, 500, 62, 500, 52, 500, 500, 500, 224, 500, 200, 104, 36, 38, 184, 198, 40, 500, 500, 500, 500, 110, 120, 96, 46, 148, 500, 58, 40, 44, 32, 500, 500, 32, 176, 114, 500, 52, 500, 500, 480, 500, 26, 162, 420, 44, 244, 500, 500, 60, 34, 34, 500, 32, 58, 500, 500, 58, 500, 68, 36, 104, 56, 112, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3738182508512342, "mean_inference_ms": 1.1971086943389868, "mean_action_processing_ms": 0.13939312241992977, "mean_env_wait_ms": 0.08131320279993844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025997161865234375, "StateBufferConnector_ms": 0.008000612258911133, "ViewRequirementAgentConnector_ms": 0.0989842414855957}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.331999999999816, "episode_len_mean": 257.28, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 20.099999999999845, 47.3, 45.9, -50.00000000000044, 39.90000000000002, 38.50000000000003, 28.29999999999996, 45.9, 34.50000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 47.1, -50.00000000000044, 45.1, 46.099999999999994, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, 30.099999999999987, 39.70000000000002, 46.5, 46.3, 31.70000000000001, 30.29999999999999, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 38.10000000000002, 40.500000000000014, 45.5, 35.30000000000004, -50.00000000000044, 44.300000000000004, 46.099999999999994, 45.7, 46.9, -50.00000000000044, -50.00000000000044, 46.9, 32.50000000000002, 38.700000000000024, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 47.5, 33.90000000000004, 8.099999999999675, 45.7, 25.699999999999925, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.699999999999996, 46.699999999999996, -50.00000000000044, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, 46.5, 39.70000000000002, 44.5, 38.90000000000002, -50.00000000000044, 43.10000000000001], "episode_lengths": [500, 500, 300, 28, 42, 500, 102, 116, 218, 42, 156, 34, 500, 500, 34, 64, 500, 500, 44, 32, 500, 30, 500, 50, 40, 500, 32, 500, 500, 30, 30, 500, 500, 500, 500, 500, 62, 500, 52, 500, 500, 500, 224, 500, 200, 104, 36, 38, 184, 198, 40, 500, 500, 500, 500, 110, 120, 96, 46, 148, 500, 58, 40, 44, 32, 500, 500, 32, 176, 114, 500, 52, 500, 500, 480, 500, 26, 162, 420, 44, 244, 500, 500, 60, 34, 34, 500, 32, 58, 500, 500, 58, 500, 68, 36, 104, 56, 112, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3738182508512342, "mean_inference_ms": 1.1971086943389868, "mean_action_processing_ms": 0.13939312241992977, "mean_env_wait_ms": 0.08131320279993844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025997161865234375, "StateBufferConnector_ms": 0.008000612258911133, "ViewRequirementAgentConnector_ms": 0.0989842414855957}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5188.570262208539, "num_env_steps_trained_throughput_per_sec": 5188.570262208539, "timesteps_total": 780000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 2247.007, "sample_time_ms": 1879.896, "load_time_ms": 11.616, "load_throughput": 1033043.757, "learn_time_ms": 344.984, "learn_throughput": 34784.262, "synch_weights_time_ms": 9.411}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 2920, "training_iteration": 65, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-51", "timestamp": 1698247131, "time_this_iter_s": 2.3177714347839355, "time_total_s": 147.27562880516052, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 147.27562880516052, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 55.63333333333333, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427524e-21, "cur_lr": 0.0003, "total_loss": 6.330668528874715, "policy_loss": -0.00041345444818337757, "vf_loss": 6.331127595901489, "vf_explained_var": -3.973642985026042e-07, "kl": 0.000616404168189888, "entropy": 0.455174990495046, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1965.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4419999999998083, "episode_len_mean": 266.18, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, 30.099999999999987, 39.70000000000002, 46.5, 46.3, 31.70000000000001, 30.29999999999999, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 38.10000000000002, 40.500000000000014, 45.5, 35.30000000000004, -50.00000000000044, 44.300000000000004, 46.099999999999994, 45.7, 46.9, -50.00000000000044, -50.00000000000044, 46.9, 32.50000000000002, 38.700000000000024, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 47.5, 33.90000000000004, 8.099999999999675, 45.7, 25.699999999999925, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.699999999999996, 46.699999999999996, -50.00000000000044, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, 46.5, 39.70000000000002, 44.5, 38.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.9, 46.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.10000000000001, 44.300000000000004, -50.00000000000044, 44.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 46.9, 46.699999999999996, 8.899999999999686, 4.299999999999621, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.9, 33.30000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.499999999999652, 45.5, 45.1], "episode_lengths": [500, 500, 224, 500, 200, 104, 36, 38, 184, 198, 40, 500, 500, 500, 500, 110, 120, 96, 46, 148, 500, 58, 40, 44, 32, 500, 500, 32, 176, 114, 500, 52, 500, 500, 480, 500, 26, 162, 420, 44, 244, 500, 500, 60, 34, 34, 500, 32, 58, 500, 500, 58, 500, 68, 36, 104, 56, 112, 500, 70, 500, 500, 500, 36, 32, 32, 500, 500, 72, 70, 58, 500, 52, 114, 500, 500, 32, 34, 412, 458, 500, 500, 500, 78, 30, 500, 500, 500, 96, 500, 42, 168, 80, 500, 500, 500, 500, 436, 46, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37396692073929516, "mean_inference_ms": 1.1958193850127432, "mean_action_processing_ms": 0.13928942090659396, "mean_env_wait_ms": 0.08141324909908745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399921417236328, "StateBufferConnector_ms": 0.008998632431030273, "ViewRequirementAgentConnector_ms": 0.09200167655944824}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4419999999998083, "episode_len_mean": 266.18, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, 30.099999999999987, 39.70000000000002, 46.5, 46.3, 31.70000000000001, 30.29999999999999, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 38.10000000000002, 40.500000000000014, 45.5, 35.30000000000004, -50.00000000000044, 44.300000000000004, 46.099999999999994, 45.7, 46.9, -50.00000000000044, -50.00000000000044, 46.9, 32.50000000000002, 38.700000000000024, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 47.5, 33.90000000000004, 8.099999999999675, 45.7, 25.699999999999925, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.699999999999996, 46.699999999999996, -50.00000000000044, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, 46.5, 39.70000000000002, 44.5, 38.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.9, 46.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.10000000000001, 44.300000000000004, -50.00000000000044, 44.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 46.9, 46.699999999999996, 8.899999999999686, 4.299999999999621, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.9, 33.30000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.499999999999652, 45.5, 45.1], "episode_lengths": [500, 500, 224, 500, 200, 104, 36, 38, 184, 198, 40, 500, 500, 500, 500, 110, 120, 96, 46, 148, 500, 58, 40, 44, 32, 500, 500, 32, 176, 114, 500, 52, 500, 500, 480, 500, 26, 162, 420, 44, 244, 500, 500, 60, 34, 34, 500, 32, 58, 500, 500, 58, 500, 68, 36, 104, 56, 112, 500, 70, 500, 500, 500, 36, 32, 32, 500, 500, 72, 70, 58, 500, 52, 114, 500, 500, 32, 34, 412, 458, 500, 500, 500, 78, 30, 500, 500, 500, 96, 500, 42, 168, 80, 500, 500, 500, 500, 436, 46, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37396692073929516, "mean_inference_ms": 1.1958193850127432, "mean_action_processing_ms": 0.13928942090659396, "mean_env_wait_ms": 0.08141324909908745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399921417236328, "StateBufferConnector_ms": 0.008998632431030273, "ViewRequirementAgentConnector_ms": 0.09200167655944824}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5647.36612797592, "num_env_steps_trained_throughput_per_sec": 5647.36612797592, "timesteps_total": 792000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 2231.102, "sample_time_ms": 1866.347, "load_time_ms": 11.4, "load_throughput": 1052677.054, "learn_time_ms": 342.911, "learn_throughput": 34994.517, "synch_weights_time_ms": 9.344}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 2960, "training_iteration": 66, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-53", "timestamp": 1698247133, "time_this_iter_s": 2.1298797130584717, "time_total_s": 149.405508518219, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 149.405508518219, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 57.26666666666666, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.710505431213762e-21, "cur_lr": 0.0003, "total_loss": 6.570016543070476, "policy_loss": -0.00011377671035006642, "vf_loss": 6.570175377527873, "vf_explained_var": -8.940696716308594e-07, "kl": 0.00039241746601419435, "entropy": 0.4499246915181478, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1995.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.762999999999813, "episode_len_mean": 257.98, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, 46.5, 39.70000000000002, 44.5, 38.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.9, 46.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.10000000000001, 44.300000000000004, -50.00000000000044, 44.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 46.9, 46.699999999999996, 8.899999999999686, 4.299999999999621, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.9, 33.30000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.499999999999652, 45.5, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.900000000000006, 46.699999999999996, -50.00000000000044, 44.900000000000006, 42.30000000000001, 40.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, 41.70000000000002, 28.29999999999996, -50.00000000000044, 42.70000000000001, 32.50000000000002, -50.00000000000044, 35.10000000000004, -50.00000000000044, 46.099999999999994, 25.29999999999992, 43.30000000000001, 47.7, -50.00000000000044, 45.7, 44.10000000000001, 43.50000000000001, -50.00000000000044, 36.900000000000034, 45.5, 40.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 45.7, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 12.899999999999743, 34.50000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5], "episode_lengths": [500, 58, 500, 68, 36, 104, 56, 112, 500, 70, 500, 500, 500, 36, 32, 32, 500, 500, 72, 70, 58, 500, 52, 114, 500, 500, 32, 34, 412, 458, 500, 500, 500, 78, 30, 500, 500, 500, 96, 500, 42, 168, 80, 500, 500, 500, 500, 436, 46, 50, 500, 58, 500, 52, 34, 500, 52, 78, 96, 48, 500, 500, 40, 500, 62, 84, 218, 500, 74, 176, 500, 150, 500, 40, 248, 68, 24, 500, 44, 60, 66, 500, 132, 46, 92, 58, 500, 500, 494, 44, 62, 52, 500, 500, 372, 156, 40, 500, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3743290522845909, "mean_inference_ms": 1.1945195525094512, "mean_action_processing_ms": 0.13915386005286237, "mean_env_wait_ms": 0.08176841090165109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299952507019043, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.08699679374694824}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.762999999999813, "episode_len_mean": 257.98, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, 46.5, 39.70000000000002, 44.5, 38.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.9, 46.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.10000000000001, 44.300000000000004, -50.00000000000044, 44.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 46.9, 46.699999999999996, 8.899999999999686, 4.299999999999621, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.9, 33.30000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.499999999999652, 45.5, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.900000000000006, 46.699999999999996, -50.00000000000044, 44.900000000000006, 42.30000000000001, 40.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, 41.70000000000002, 28.29999999999996, -50.00000000000044, 42.70000000000001, 32.50000000000002, -50.00000000000044, 35.10000000000004, -50.00000000000044, 46.099999999999994, 25.29999999999992, 43.30000000000001, 47.7, -50.00000000000044, 45.7, 44.10000000000001, 43.50000000000001, -50.00000000000044, 36.900000000000034, 45.5, 40.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 45.7, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 12.899999999999743, 34.50000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5], "episode_lengths": [500, 58, 500, 68, 36, 104, 56, 112, 500, 70, 500, 500, 500, 36, 32, 32, 500, 500, 72, 70, 58, 500, 52, 114, 500, 500, 32, 34, 412, 458, 500, 500, 500, 78, 30, 500, 500, 500, 96, 500, 42, 168, 80, 500, 500, 500, 500, 436, 46, 50, 500, 58, 500, 52, 34, 500, 52, 78, 96, 48, 500, 500, 40, 500, 62, 84, 218, 500, 74, 176, 500, 150, 500, 40, 248, 68, 24, 500, 44, 60, 66, 500, 132, 46, 92, 58, 500, 500, 494, 44, 62, 52, 500, 500, 372, 156, 40, 500, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3743290522845909, "mean_inference_ms": 1.1945195525094512, "mean_action_processing_ms": 0.13915386005286237, "mean_env_wait_ms": 0.08176841090165109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299952507019043, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.08699679374694824}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5321.204246463175, "num_env_steps_trained_throughput_per_sec": 5321.204246463175, "timesteps_total": 804000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 2213.192, "sample_time_ms": 1859.771, "load_time_ms": 11.699, "load_throughput": 1025742.544, "learn_time_ms": 331.178, "learn_throughput": 36234.325, "synch_weights_time_ms": 9.344}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 3010, "training_iteration": 67, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-55", "timestamp": 1698247135, "time_this_iter_s": 2.2601277828216553, "time_total_s": 151.66563630104065, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 151.66563630104065, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 59.43333333333334, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.355252715606881e-21, "cur_lr": 0.0003, "total_loss": 6.521975469589234, "policy_loss": -0.00029987444480260214, "vf_loss": 6.5223263581593836, "vf_explained_var": -6.556510925292969e-07, "kl": 0.0012438177496505887, "entropy": 0.5099749982357025, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2025.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9889999999998116, "episode_len_mean": 265.72, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.30000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.499999999999652, 45.5, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.900000000000006, 46.699999999999996, -50.00000000000044, 44.900000000000006, 42.30000000000001, 40.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, 41.70000000000002, 28.29999999999996, -50.00000000000044, 42.70000000000001, 32.50000000000002, -50.00000000000044, 35.10000000000004, -50.00000000000044, 46.099999999999994, 25.29999999999992, 43.30000000000001, 47.7, -50.00000000000044, 45.7, 44.10000000000001, 43.50000000000001, -50.00000000000044, 36.900000000000034, 45.5, 40.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 45.7, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 12.899999999999743, 34.50000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.9, 47.1, 39.90000000000002, -50.00000000000044, 24.299999999999905, 47.5, -50.00000000000044, 39.10000000000002, 1.8999999999995865, 41.500000000000014, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, 46.699999999999996, 44.7, 42.30000000000001, 28.29999999999996, 46.5, -50.00000000000044, -50.00000000000044, 45.7, 39.70000000000002, 19.69999999999984, -50.00000000000044, 46.699999999999996], "episode_lengths": [168, 80, 500, 500, 500, 500, 436, 46, 50, 500, 58, 500, 52, 34, 500, 52, 78, 96, 48, 500, 500, 40, 500, 62, 84, 218, 500, 74, 176, 500, 150, 500, 40, 248, 68, 24, 500, 44, 60, 66, 500, 132, 46, 92, 58, 500, 500, 494, 44, 62, 52, 500, 500, 372, 156, 40, 500, 500, 46, 500, 500, 290, 500, 118, 500, 42, 30, 102, 500, 258, 26, 500, 110, 482, 86, 500, 172, 500, 500, 500, 500, 52, 38, 500, 500, 500, 500, 214, 34, 54, 78, 218, 36, 500, 500, 44, 104, 304, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37481882654833315, "mean_inference_ms": 1.195174923834835, "mean_action_processing_ms": 0.13934358926992144, "mean_env_wait_ms": 0.08179395283703583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099752426147461, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.08899855613708496}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9889999999998116, "episode_len_mean": 265.72, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.30000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.499999999999652, 45.5, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.900000000000006, 46.699999999999996, -50.00000000000044, 44.900000000000006, 42.30000000000001, 40.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, 41.70000000000002, 28.29999999999996, -50.00000000000044, 42.70000000000001, 32.50000000000002, -50.00000000000044, 35.10000000000004, -50.00000000000044, 46.099999999999994, 25.29999999999992, 43.30000000000001, 47.7, -50.00000000000044, 45.7, 44.10000000000001, 43.50000000000001, -50.00000000000044, 36.900000000000034, 45.5, 40.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 45.7, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 12.899999999999743, 34.50000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.9, 47.1, 39.90000000000002, -50.00000000000044, 24.299999999999905, 47.5, -50.00000000000044, 39.10000000000002, 1.8999999999995865, 41.500000000000014, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, 46.699999999999996, 44.7, 42.30000000000001, 28.29999999999996, 46.5, -50.00000000000044, -50.00000000000044, 45.7, 39.70000000000002, 19.69999999999984, -50.00000000000044, 46.699999999999996], "episode_lengths": [168, 80, 500, 500, 500, 500, 436, 46, 50, 500, 58, 500, 52, 34, 500, 52, 78, 96, 48, 500, 500, 40, 500, 62, 84, 218, 500, 74, 176, 500, 150, 500, 40, 248, 68, 24, 500, 44, 60, 66, 500, 132, 46, 92, 58, 500, 500, 494, 44, 62, 52, 500, 500, 372, 156, 40, 500, 500, 46, 500, 500, 290, 500, 118, 500, 42, 30, 102, 500, 258, 26, 500, 110, 482, 86, 500, 172, 500, 500, 500, 500, 52, 38, 500, 500, 500, 500, 214, 34, 54, 78, 218, 36, 500, 500, 44, 104, 304, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37481882654833315, "mean_inference_ms": 1.195174923834835, "mean_action_processing_ms": 0.13934358926992144, "mean_env_wait_ms": 0.08179395283703583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099752426147461, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.08899855613708496}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5540.594007525847, "num_env_steps_trained_throughput_per_sec": 5540.594007525847, "timesteps_total": 816000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 2213.575, "sample_time_ms": 1855.648, "load_time_ms": 11.858, "load_throughput": 1011947.709, "learn_time_ms": 335.424, "learn_throughput": 35775.654, "synch_weights_time_ms": 9.344}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 3051, "training_iteration": 68, "trial_id": "9f288_00009", "date": "2023-10-25_16-18-58", "timestamp": 1698247138, "time_this_iter_s": 2.1708319187164307, "time_total_s": 153.83646821975708, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 153.83646821975708, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 55.366666666666674, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034405e-22, "cur_lr": 0.0003, "total_loss": 6.739177799224853, "policy_loss": -0.00044971741735935213, "vf_loss": 6.739675203959147, "vf_explained_var": -1.3629595438639323e-06, "kl": 0.0008104350787107251, "entropy": 0.47739744385083516, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2055.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6190000000002214, "episode_len_mean": 291.74, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 0.6999999999995694, 45.7, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 12.899999999999743, 34.50000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.9, 47.1, 39.90000000000002, -50.00000000000044, 24.299999999999905, 47.5, -50.00000000000044, 39.10000000000002, 1.8999999999995865, 41.500000000000014, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, 46.699999999999996, 44.7, 42.30000000000001, 28.29999999999996, 46.5, -50.00000000000044, -50.00000000000044, 45.7, 39.70000000000002, 19.69999999999984, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.3, 36.70000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 46.099999999999994, 43.7, 46.699999999999996, 8.899999999999686, 43.900000000000006, 46.099999999999994, 43.30000000000001, -50.00000000000044, 47.3, 42.500000000000014, -50.00000000000044, 13.099999999999746, -50.00000000000044, 43.900000000000006, 46.5, -50.00000000000044, 46.3, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 494, 44, 62, 52, 500, 500, 372, 156, 40, 500, 500, 46, 500, 500, 290, 500, 118, 500, 42, 30, 102, 500, 258, 26, 500, 110, 482, 86, 500, 172, 500, 500, 500, 500, 52, 38, 500, 500, 500, 500, 214, 34, 54, 78, 218, 36, 500, 500, 44, 104, 304, 500, 34, 500, 28, 134, 500, 500, 130, 500, 500, 54, 54, 40, 64, 34, 412, 62, 40, 68, 500, 28, 76, 500, 370, 500, 62, 36, 500, 38, 70, 500, 500, 30, 500, 500, 478, 500, 500, 76, 52, 500, 500, 500, 46, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3743348108831426, "mean_inference_ms": 1.1957965000613648, "mean_action_processing_ms": 0.13929431321846164, "mean_env_wait_ms": 0.08144482298776765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993057250976562, "StateBufferConnector_ms": 0.0019989013671875, "ViewRequirementAgentConnector_ms": 0.09699678421020508}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6190000000002214, "episode_len_mean": 291.74, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 0.6999999999995694, 45.7, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 12.899999999999743, 34.50000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.9, 47.1, 39.90000000000002, -50.00000000000044, 24.299999999999905, 47.5, -50.00000000000044, 39.10000000000002, 1.8999999999995865, 41.500000000000014, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, 46.699999999999996, 44.7, 42.30000000000001, 28.29999999999996, 46.5, -50.00000000000044, -50.00000000000044, 45.7, 39.70000000000002, 19.69999999999984, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.3, 36.70000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 46.099999999999994, 43.7, 46.699999999999996, 8.899999999999686, 43.900000000000006, 46.099999999999994, 43.30000000000001, -50.00000000000044, 47.3, 42.500000000000014, -50.00000000000044, 13.099999999999746, -50.00000000000044, 43.900000000000006, 46.5, -50.00000000000044, 46.3, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 494, 44, 62, 52, 500, 500, 372, 156, 40, 500, 500, 46, 500, 500, 290, 500, 118, 500, 42, 30, 102, 500, 258, 26, 500, 110, 482, 86, 500, 172, 500, 500, 500, 500, 52, 38, 500, 500, 500, 500, 214, 34, 54, 78, 218, 36, 500, 500, 44, 104, 304, 500, 34, 500, 28, 134, 500, 500, 130, 500, 500, 54, 54, 40, 64, 34, 412, 62, 40, 68, 500, 28, 76, 500, 370, 500, 62, 36, 500, 38, 70, 500, 500, 30, 500, 500, 478, 500, 500, 76, 52, 500, 500, 500, 46, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3743348108831426, "mean_inference_ms": 1.1957965000613648, "mean_action_processing_ms": 0.13929431321846164, "mean_env_wait_ms": 0.08144482298776765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993057250976562, "StateBufferConnector_ms": 0.0019989013671875, "ViewRequirementAgentConnector_ms": 0.09699678421020508}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5123.4445032472695, "num_env_steps_trained_throughput_per_sec": 5123.4445032472695, "timesteps_total": 828000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 2228.391, "sample_time_ms": 1864.642, "load_time_ms": 11.885, "load_throughput": 1009663.971, "learn_time_ms": 340.826, "learn_throughput": 35208.546, "synch_weights_time_ms": 9.737}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3096, "training_iteration": 69, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-00", "timestamp": 1698247140, "time_this_iter_s": 2.347172498703003, "time_total_s": 156.18364071846008, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 156.18364071846008, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 50.4, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3881317890172025e-22, "cur_lr": 0.0003, "total_loss": 5.912475029627482, "policy_loss": -8.752668897310893e-05, "vf_loss": 5.912608575820923, "vf_explained_var": -1.0887781778971354e-06, "kl": 0.0004066777230569585, "entropy": 0.46138080656528474, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2085.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6660000000002158, "episode_len_mean": 287.2, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, 46.699999999999996, 44.7, 42.30000000000001, 28.29999999999996, 46.5, -50.00000000000044, -50.00000000000044, 45.7, 39.70000000000002, 19.69999999999984, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.3, 36.70000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 46.099999999999994, 43.7, 46.699999999999996, 8.899999999999686, 43.900000000000006, 46.099999999999994, 43.30000000000001, -50.00000000000044, 47.3, 42.500000000000014, -50.00000000000044, 13.099999999999746, -50.00000000000044, 43.900000000000006, 46.5, -50.00000000000044, 46.3, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 26.89999999999994, 37.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 45.7, 36.70000000000003, 37.50000000000003, 43.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 43.10000000000001, 45.7, -50.00000000000044, 45.3, 25.899999999999928, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 52, 38, 500, 500, 500, 500, 214, 34, 54, 78, 218, 36, 500, 500, 44, 104, 304, 500, 34, 500, 28, 134, 500, 500, 130, 500, 500, 54, 54, 40, 64, 34, 412, 62, 40, 68, 500, 28, 76, 500, 370, 500, 62, 36, 500, 38, 70, 500, 500, 30, 500, 500, 478, 500, 500, 76, 52, 500, 500, 500, 46, 500, 500, 500, 80, 44, 500, 500, 500, 190, 500, 232, 126, 500, 500, 40, 86, 500, 44, 134, 126, 64, 48, 500, 500, 500, 500, 500, 362, 500, 70, 44, 500, 48, 242, 500, 48, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3741221126160841, "mean_inference_ms": 1.195233643970901, "mean_action_processing_ms": 0.1392645194757734, "mean_env_wait_ms": 0.08148144243401202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027997970581054688, "StateBufferConnector_ms": 0.0019989013671875, "ViewRequirementAgentConnector_ms": 0.11603355407714844}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6660000000002158, "episode_len_mean": 287.2, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, 46.699999999999996, 44.7, 42.30000000000001, 28.29999999999996, 46.5, -50.00000000000044, -50.00000000000044, 45.7, 39.70000000000002, 19.69999999999984, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.3, 36.70000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 46.099999999999994, 43.7, 46.699999999999996, 8.899999999999686, 43.900000000000006, 46.099999999999994, 43.30000000000001, -50.00000000000044, 47.3, 42.500000000000014, -50.00000000000044, 13.099999999999746, -50.00000000000044, 43.900000000000006, 46.5, -50.00000000000044, 46.3, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 26.89999999999994, 37.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 45.7, 36.70000000000003, 37.50000000000003, 43.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 43.10000000000001, 45.7, -50.00000000000044, 45.3, 25.899999999999928, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 52, 38, 500, 500, 500, 500, 214, 34, 54, 78, 218, 36, 500, 500, 44, 104, 304, 500, 34, 500, 28, 134, 500, 500, 130, 500, 500, 54, 54, 40, 64, 34, 412, 62, 40, 68, 500, 28, 76, 500, 370, 500, 62, 36, 500, 38, 70, 500, 500, 30, 500, 500, 478, 500, 500, 76, 52, 500, 500, 500, 46, 500, 500, 500, 80, 44, 500, 500, 500, 190, 500, 232, 126, 500, 500, 40, 86, 500, 44, 134, 126, 64, 48, 500, 500, 500, 500, 500, 362, 500, 70, 44, 500, 48, 242, 500, 48, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3741221126160841, "mean_inference_ms": 1.195233643970901, "mean_action_processing_ms": 0.1392645194757734, "mean_env_wait_ms": 0.08148144243401202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027997970581054688, "StateBufferConnector_ms": 0.0019989013671875, "ViewRequirementAgentConnector_ms": 0.11603355407714844}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5583.737511469695, "num_env_steps_trained_throughput_per_sec": 5583.737511469695, "timesteps_total": 840000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 2218.538, "sample_time_ms": 1859.679, "load_time_ms": 11.686, "load_throughput": 1026843.29, "learn_time_ms": 336.235, "learn_throughput": 35689.317, "synch_weights_time_ms": 9.634}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 3131, "training_iteration": 70, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-02", "timestamp": 1698247142, "time_this_iter_s": 2.154127597808838, "time_total_s": 158.33776831626892, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 158.33776831626892, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 56.666666666666664, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6940658945086012e-22, "cur_lr": 0.0003, "total_loss": 6.703239758809407, "policy_loss": -0.000317638615767161, "vf_loss": 6.7036079565684, "vf_explained_var": -9.457270304361979e-07, "kl": 0.0008268500086084411, "entropy": 0.5056033134460449, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2115.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -6.782000000000243, "episode_len_mean": 318.32, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 13.099999999999746, -50.00000000000044, 43.900000000000006, 46.5, -50.00000000000044, 46.3, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 26.89999999999994, 37.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 45.7, 36.70000000000003, 37.50000000000003, 43.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 43.10000000000001, 45.7, -50.00000000000044, 45.3, 25.899999999999928, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 25.29999999999992, -50.00000000000044, 38.10000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 43.10000000000001, 42.500000000000014, -50.00000000000044, 45.7, 25.699999999999925, 46.5, 14.09999999999976, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.499999999999638, 17.899999999999814, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, 42.70000000000001, 40.90000000000002, 12.299999999999734, 38.300000000000026, -50.00000000000044, 43.50000000000001], "episode_lengths": [500, 370, 500, 62, 36, 500, 38, 70, 500, 500, 30, 500, 500, 478, 500, 500, 76, 52, 500, 500, 500, 46, 500, 500, 500, 80, 44, 500, 500, 500, 190, 500, 232, 126, 500, 500, 40, 86, 500, 44, 134, 126, 64, 48, 500, 500, 500, 500, 500, 362, 500, 70, 44, 500, 48, 242, 500, 48, 500, 500, 500, 298, 500, 500, 34, 500, 248, 500, 120, 500, 50, 500, 500, 500, 500, 246, 70, 76, 500, 44, 244, 36, 360, 72, 500, 500, 500, 500, 446, 322, 110, 500, 500, 42, 74, 92, 378, 118, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37358151398912637, "mean_inference_ms": 1.1955816607348768, "mean_action_processing_ms": 0.13918395629755498, "mean_env_wait_ms": 0.0814388257390487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02251124382019043, "StateBufferConnector_ms": 0.0025055408477783203, "ViewRequirementAgentConnector_ms": 0.11362385749816895}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -6.782000000000243, "episode_len_mean": 318.32, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 13.099999999999746, -50.00000000000044, 43.900000000000006, 46.5, -50.00000000000044, 46.3, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 26.89999999999994, 37.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 45.7, 36.70000000000003, 37.50000000000003, 43.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 43.10000000000001, 45.7, -50.00000000000044, 45.3, 25.899999999999928, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 25.29999999999992, -50.00000000000044, 38.10000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 43.10000000000001, 42.500000000000014, -50.00000000000044, 45.7, 25.699999999999925, 46.5, 14.09999999999976, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.499999999999638, 17.899999999999814, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, 42.70000000000001, 40.90000000000002, 12.299999999999734, 38.300000000000026, -50.00000000000044, 43.50000000000001], "episode_lengths": [500, 370, 500, 62, 36, 500, 38, 70, 500, 500, 30, 500, 500, 478, 500, 500, 76, 52, 500, 500, 500, 46, 500, 500, 500, 80, 44, 500, 500, 500, 190, 500, 232, 126, 500, 500, 40, 86, 500, 44, 134, 126, 64, 48, 500, 500, 500, 500, 500, 362, 500, 70, 44, 500, 48, 242, 500, 48, 500, 500, 500, 298, 500, 500, 34, 500, 248, 500, 120, 500, 50, 500, 500, 500, 500, 246, 70, 76, 500, 44, 244, 36, 360, 72, 500, 500, 500, 500, 446, 322, 110, 500, 500, 42, 74, 92, 378, 118, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37358151398912637, "mean_inference_ms": 1.1955816607348768, "mean_action_processing_ms": 0.13918395629755498, "mean_env_wait_ms": 0.0814388257390487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02251124382019043, "StateBufferConnector_ms": 0.0025055408477783203, "ViewRequirementAgentConnector_ms": 0.11362385749816895}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5018.74644334292, "num_env_steps_trained_throughput_per_sec": 5018.74644334292, "timesteps_total": 852000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 2228.055, "sample_time_ms": 1868.123, "load_time_ms": 11.666, "load_throughput": 1028639.677, "learn_time_ms": 337.245, "learn_throughput": 35582.406, "synch_weights_time_ms": 9.614}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 3171, "training_iteration": 71, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-05", "timestamp": 1698247145, "time_this_iter_s": 2.396033525466919, "time_total_s": 160.73380184173584, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 160.73380184173584, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 60.6, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543006e-23, "cur_lr": 0.0003, "total_loss": 6.673263374964396, "policy_loss": -0.0014237622419993083, "vf_loss": 6.6747367699941, "vf_explained_var": -8.344650268554688e-07, "kl": 0.0013846530686028775, "entropy": 0.4973803261915843, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2145.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.9380000000002144, "episode_len_mean": 299.94, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 43.10000000000001, 45.7, -50.00000000000044, 45.3, 25.899999999999928, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 25.29999999999992, -50.00000000000044, 38.10000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 43.10000000000001, 42.500000000000014, -50.00000000000044, 45.7, 25.699999999999925, 46.5, 14.09999999999976, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.499999999999638, 17.899999999999814, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, 42.70000000000001, 40.90000000000002, 12.299999999999734, 38.300000000000026, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 15.49999999999978, 44.10000000000001, -50.00000000000044, 42.30000000000001, 35.30000000000004, 41.70000000000002, -50.00000000000044, 41.500000000000014, 45.9, 45.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, 33.500000000000036, 23.29999999999989, 46.9, 12.899999999999743, 25.699999999999925, 37.50000000000003, 46.099999999999994, -50.00000000000044, 39.70000000000002, 31.300000000000004, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 36.50000000000003, -50.00000000000044, 46.5, 22.49999999999988, -50.00000000000044, 45.1, 46.3, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 362, 500, 70, 44, 500, 48, 242, 500, 48, 500, 500, 500, 298, 500, 500, 34, 500, 248, 500, 120, 500, 50, 500, 500, 500, 500, 246, 70, 76, 500, 44, 244, 36, 360, 72, 500, 500, 500, 500, 446, 322, 110, 500, 500, 42, 74, 92, 378, 118, 500, 66, 500, 500, 84, 346, 60, 500, 78, 148, 84, 500, 86, 42, 42, 500, 500, 134, 166, 268, 32, 372, 244, 126, 40, 500, 104, 188, 500, 500, 168, 500, 500, 180, 500, 136, 500, 36, 276, 500, 50, 38, 62, 44, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3738855527336817, "mean_inference_ms": 1.1947672487307428, "mean_action_processing_ms": 0.13921657785006203, "mean_env_wait_ms": 0.08164907824449819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0185089111328125, "StateBufferConnector_ms": 0.004504203796386719, "ViewRequirementAgentConnector_ms": 0.0945887565612793}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.9380000000002144, "episode_len_mean": 299.94, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 43.10000000000001, 45.7, -50.00000000000044, 45.3, 25.899999999999928, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 25.29999999999992, -50.00000000000044, 38.10000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 43.10000000000001, 42.500000000000014, -50.00000000000044, 45.7, 25.699999999999925, 46.5, 14.09999999999976, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.499999999999638, 17.899999999999814, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, 42.70000000000001, 40.90000000000002, 12.299999999999734, 38.300000000000026, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 15.49999999999978, 44.10000000000001, -50.00000000000044, 42.30000000000001, 35.30000000000004, 41.70000000000002, -50.00000000000044, 41.500000000000014, 45.9, 45.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, 33.500000000000036, 23.29999999999989, 46.9, 12.899999999999743, 25.699999999999925, 37.50000000000003, 46.099999999999994, -50.00000000000044, 39.70000000000002, 31.300000000000004, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 36.50000000000003, -50.00000000000044, 46.5, 22.49999999999988, -50.00000000000044, 45.1, 46.3, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 362, 500, 70, 44, 500, 48, 242, 500, 48, 500, 500, 500, 298, 500, 500, 34, 500, 248, 500, 120, 500, 50, 500, 500, 500, 500, 246, 70, 76, 500, 44, 244, 36, 360, 72, 500, 500, 500, 500, 446, 322, 110, 500, 500, 42, 74, 92, 378, 118, 500, 66, 500, 500, 84, 346, 60, 500, 78, 148, 84, 500, 86, 42, 42, 500, 500, 134, 166, 268, 32, 372, 244, 126, 40, 500, 104, 188, 500, 500, 168, 500, 500, 180, 500, 136, 500, 36, 276, 500, 50, 38, 62, 44, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3738855527336817, "mean_inference_ms": 1.1947672487307428, "mean_action_processing_ms": 0.13921657785006203, "mean_env_wait_ms": 0.08164907824449819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0185089111328125, "StateBufferConnector_ms": 0.004504203796386719, "ViewRequirementAgentConnector_ms": 0.0945887565612793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5586.551248352976, "num_env_steps_trained_throughput_per_sec": 5586.551248352976, "timesteps_total": 864000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 2232.267, "sample_time_ms": 1867.799, "load_time_ms": 11.866, "load_throughput": 1011305.19, "learn_time_ms": 341.793, "learn_throughput": 35108.922, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3217, "training_iteration": 72, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-07", "timestamp": 1698247147, "time_this_iter_s": 2.153014898300171, "time_total_s": 162.886816740036, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 162.886816740036, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 57.4, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.235164736271503e-23, "cur_lr": 0.0003, "total_loss": 6.522443993886312, "policy_loss": -9.756926447153091e-05, "vf_loss": 6.522591431935628, "vf_explained_var": -1.0530153910319011e-06, "kl": 0.00037856846698029284, "entropy": 0.4995144893725713, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2175.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.179999999999831, "episode_len_mean": 258.84, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 42.70000000000001, 40.90000000000002, 12.299999999999734, 38.300000000000026, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 15.49999999999978, 44.10000000000001, -50.00000000000044, 42.30000000000001, 35.30000000000004, 41.70000000000002, -50.00000000000044, 41.500000000000014, 45.9, 45.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, 33.500000000000036, 23.29999999999989, 46.9, 12.899999999999743, 25.699999999999925, 37.50000000000003, 46.099999999999994, -50.00000000000044, 39.70000000000002, 31.300000000000004, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 36.50000000000003, -50.00000000000044, 46.5, 22.49999999999988, -50.00000000000044, 45.1, 46.3, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 41.500000000000014, -50.00000000000044, 36.30000000000003, 42.500000000000014, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 2.0999999999995893, -50.00000000000044, 44.7, 40.70000000000002, 47.5, 41.70000000000002, -50.00000000000044, 45.9, 32.100000000000016, -50.00000000000044, 45.7, 30.099999999999987, 25.099999999999916, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 38.300000000000026, 46.5, -50.00000000000044, 46.9, 45.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, 33.500000000000036, 26.09999999999993, 40.70000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.70000000000002, 43.30000000000001, 26.69999999999994], "episode_lengths": [500, 42, 74, 92, 378, 118, 500, 66, 500, 500, 84, 346, 60, 500, 78, 148, 84, 500, 86, 42, 42, 500, 500, 134, 166, 268, 32, 372, 244, 126, 40, 500, 104, 188, 500, 500, 168, 500, 500, 180, 500, 136, 500, 36, 276, 500, 50, 38, 62, 44, 500, 500, 500, 500, 128, 86, 500, 138, 76, 84, 500, 500, 500, 154, 480, 500, 54, 94, 26, 84, 500, 42, 180, 500, 44, 200, 250, 42, 500, 500, 500, 32, 118, 36, 500, 32, 44, 500, 92, 500, 166, 240, 94, 500, 500, 68, 500, 94, 68, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37359842312402336, "mean_inference_ms": 1.1947279870218779, "mean_action_processing_ms": 0.1393649135616919, "mean_env_wait_ms": 0.08152754316769674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024003028869628906, "StateBufferConnector_ms": 0.00699925422668457, "ViewRequirementAgentConnector_ms": 0.09949588775634766}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.179999999999831, "episode_len_mean": 258.84, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 42.70000000000001, 40.90000000000002, 12.299999999999734, 38.300000000000026, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 15.49999999999978, 44.10000000000001, -50.00000000000044, 42.30000000000001, 35.30000000000004, 41.70000000000002, -50.00000000000044, 41.500000000000014, 45.9, 45.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, 33.500000000000036, 23.29999999999989, 46.9, 12.899999999999743, 25.699999999999925, 37.50000000000003, 46.099999999999994, -50.00000000000044, 39.70000000000002, 31.300000000000004, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 36.50000000000003, -50.00000000000044, 46.5, 22.49999999999988, -50.00000000000044, 45.1, 46.3, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 41.500000000000014, -50.00000000000044, 36.30000000000003, 42.500000000000014, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 2.0999999999995893, -50.00000000000044, 44.7, 40.70000000000002, 47.5, 41.70000000000002, -50.00000000000044, 45.9, 32.100000000000016, -50.00000000000044, 45.7, 30.099999999999987, 25.099999999999916, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 38.300000000000026, 46.5, -50.00000000000044, 46.9, 45.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, 33.500000000000036, 26.09999999999993, 40.70000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.70000000000002, 43.30000000000001, 26.69999999999994], "episode_lengths": [500, 42, 74, 92, 378, 118, 500, 66, 500, 500, 84, 346, 60, 500, 78, 148, 84, 500, 86, 42, 42, 500, 500, 134, 166, 268, 32, 372, 244, 126, 40, 500, 104, 188, 500, 500, 168, 500, 500, 180, 500, 136, 500, 36, 276, 500, 50, 38, 62, 44, 500, 500, 500, 500, 128, 86, 500, 138, 76, 84, 500, 500, 500, 154, 480, 500, 54, 94, 26, 84, 500, 42, 180, 500, 44, 200, 250, 42, 500, 500, 500, 32, 118, 36, 500, 32, 44, 500, 92, 500, 166, 240, 94, 500, 500, 68, 500, 94, 68, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37359842312402336, "mean_inference_ms": 1.1947279870218779, "mean_action_processing_ms": 0.1393649135616919, "mean_env_wait_ms": 0.08152754316769674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024003028869628906, "StateBufferConnector_ms": 0.00699925422668457, "ViewRequirementAgentConnector_ms": 0.09949588775634766}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4932.898217540451, "num_env_steps_trained_throughput_per_sec": 4932.898217540451, "timesteps_total": 876000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 2255.169, "sample_time_ms": 1877.278, "load_time_ms": 12.366, "load_throughput": 970431.966, "learn_time_ms": 354.676, "learn_throughput": 33833.663, "synch_weights_time_ms": 9.542}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 3263, "training_iteration": 73, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-09", "timestamp": 1698247149, "time_this_iter_s": 2.4376416206359863, "time_total_s": 165.324458360672, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 165.324458360672, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 57.43333333333334, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357516e-23, "cur_lr": 0.0003, "total_loss": 6.259257078170776, "policy_loss": -0.0007416054606437684, "vf_loss": 6.260045687357585, "vf_explained_var": -1.0410944620768228e-06, "kl": 0.0010945878187451777, "entropy": 0.469752977291743, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2205.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.462999999999822, "episode_len_mean": 260.98, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.49999999999988, -50.00000000000044, 45.1, 46.3, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 41.500000000000014, -50.00000000000044, 36.30000000000003, 42.500000000000014, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 2.0999999999995893, -50.00000000000044, 44.7, 40.70000000000002, 47.5, 41.70000000000002, -50.00000000000044, 45.9, 32.100000000000016, -50.00000000000044, 45.7, 30.099999999999987, 25.099999999999916, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 38.300000000000026, 46.5, -50.00000000000044, 46.9, 45.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, 33.500000000000036, 26.09999999999993, 40.70000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.70000000000002, 43.30000000000001, 26.69999999999994, -50.00000000000044, 45.7, -50.00000000000044, 43.30000000000001, 45.9, 44.900000000000006, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.5, 38.300000000000026, 45.7, -50.00000000000044, 31.70000000000001, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.9, -50.00000000000044, 31.900000000000013, 39.70000000000002, 46.3, 40.90000000000002, 5.499999999999638, 37.70000000000003, 32.700000000000024], "episode_lengths": [276, 500, 50, 38, 62, 44, 500, 500, 500, 500, 128, 86, 500, 138, 76, 84, 500, 500, 500, 154, 480, 500, 54, 94, 26, 84, 500, 42, 180, 500, 44, 200, 250, 42, 500, 500, 500, 32, 118, 36, 500, 32, 44, 500, 92, 500, 166, 240, 94, 500, 500, 68, 500, 94, 68, 234, 500, 44, 500, 68, 42, 52, 500, 200, 500, 500, 42, 500, 54, 500, 58, 500, 500, 88, 500, 500, 94, 56, 118, 44, 500, 184, 24, 500, 500, 500, 70, 120, 500, 98, 500, 32, 500, 182, 104, 38, 92, 446, 124, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37385623002039803, "mean_inference_ms": 1.195285064925889, "mean_action_processing_ms": 0.13948530048945243, "mean_env_wait_ms": 0.08161655320952527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034006595611572266, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.12399077415466309}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.462999999999822, "episode_len_mean": 260.98, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.49999999999988, -50.00000000000044, 45.1, 46.3, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 41.500000000000014, -50.00000000000044, 36.30000000000003, 42.500000000000014, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 2.0999999999995893, -50.00000000000044, 44.7, 40.70000000000002, 47.5, 41.70000000000002, -50.00000000000044, 45.9, 32.100000000000016, -50.00000000000044, 45.7, 30.099999999999987, 25.099999999999916, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 38.300000000000026, 46.5, -50.00000000000044, 46.9, 45.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, 33.500000000000036, 26.09999999999993, 40.70000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.70000000000002, 43.30000000000001, 26.69999999999994, -50.00000000000044, 45.7, -50.00000000000044, 43.30000000000001, 45.9, 44.900000000000006, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.5, 38.300000000000026, 45.7, -50.00000000000044, 31.70000000000001, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.9, -50.00000000000044, 31.900000000000013, 39.70000000000002, 46.3, 40.90000000000002, 5.499999999999638, 37.70000000000003, 32.700000000000024], "episode_lengths": [276, 500, 50, 38, 62, 44, 500, 500, 500, 500, 128, 86, 500, 138, 76, 84, 500, 500, 500, 154, 480, 500, 54, 94, 26, 84, 500, 42, 180, 500, 44, 200, 250, 42, 500, 500, 500, 32, 118, 36, 500, 32, 44, 500, 92, 500, 166, 240, 94, 500, 500, 68, 500, 94, 68, 234, 500, 44, 500, 68, 42, 52, 500, 200, 500, 500, 42, 500, 54, 500, 58, 500, 500, 88, 500, 500, 94, 56, 118, 44, 500, 184, 24, 500, 500, 500, 70, 120, 500, 98, 500, 32, 500, 182, 104, 38, 92, 446, 124, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37385623002039803, "mean_inference_ms": 1.195285064925889, "mean_action_processing_ms": 0.13948530048945243, "mean_env_wait_ms": 0.08161655320952527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034006595611572266, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.12399077415466309}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5445.44664453866, "num_env_steps_trained_throughput_per_sec": 5445.44664453866, "timesteps_total": 888000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 2252.527, "sample_time_ms": 1878.909, "load_time_ms": 12.166, "load_throughput": 986390.259, "learn_time_ms": 350.703, "learn_throughput": 34217.001, "synch_weights_time_ms": 9.342}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 3307, "training_iteration": 74, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-11", "timestamp": 1698247151, "time_this_iter_s": 2.207674264907837, "time_total_s": 167.53213262557983, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 167.53213262557983, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 49.125, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678758e-23, "cur_lr": 0.0003, "total_loss": 6.18743109703064, "policy_loss": -9.455482165018717e-05, "vf_loss": 6.187571493784587, "vf_explained_var": -6.755193074544271e-07, "kl": 0.0002727754115994685, "entropy": 0.45888886948426566, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2235.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.918999999999812, "episode_len_mean": 266.4, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, -50.00000000000044, 33.500000000000036, 26.09999999999993, 40.70000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.70000000000002, 43.30000000000001, 26.69999999999994, -50.00000000000044, 45.7, -50.00000000000044, 43.30000000000001, 45.9, 44.900000000000006, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.5, 38.300000000000026, 45.7, -50.00000000000044, 31.70000000000001, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.9, -50.00000000000044, 31.900000000000013, 39.70000000000002, 46.3, 40.90000000000002, 5.499999999999638, 37.70000000000003, 32.700000000000024, -50.00000000000044, 46.699999999999996, 23.29999999999989, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 24.899999999999913, 26.09999999999993, 45.7, 15.899999999999785, 44.900000000000006, 47.3, 43.30000000000001, 40.30000000000002, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.5, 21.699999999999868, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.900000000000006, 46.699999999999996, 46.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 39.70000000000002], "episode_lengths": [92, 500, 166, 240, 94, 500, 500, 68, 500, 94, 68, 234, 500, 44, 500, 68, 42, 52, 500, 200, 500, 500, 42, 500, 54, 500, 58, 500, 500, 88, 500, 500, 94, 56, 118, 44, 500, 184, 24, 500, 500, 500, 70, 120, 500, 98, 500, 32, 500, 182, 104, 38, 92, 446, 124, 174, 500, 34, 268, 500, 44, 500, 500, 500, 40, 500, 500, 26, 500, 500, 252, 240, 44, 342, 52, 28, 68, 98, 54, 500, 500, 500, 62, 500, 46, 284, 64, 42, 500, 500, 62, 500, 62, 34, 36, 500, 50, 500, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3734573187955012, "mean_inference_ms": 1.1954768940340943, "mean_action_processing_ms": 0.13938287675743863, "mean_env_wait_ms": 0.08146111653674452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500056266784668, "StateBufferConnector_ms": 0.008002758026123047, "ViewRequirementAgentConnector_ms": 0.14399433135986328}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.918999999999812, "episode_len_mean": 266.4, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, -50.00000000000044, 33.500000000000036, 26.09999999999993, 40.70000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.70000000000002, 43.30000000000001, 26.69999999999994, -50.00000000000044, 45.7, -50.00000000000044, 43.30000000000001, 45.9, 44.900000000000006, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.5, 38.300000000000026, 45.7, -50.00000000000044, 31.70000000000001, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.9, -50.00000000000044, 31.900000000000013, 39.70000000000002, 46.3, 40.90000000000002, 5.499999999999638, 37.70000000000003, 32.700000000000024, -50.00000000000044, 46.699999999999996, 23.29999999999989, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 24.899999999999913, 26.09999999999993, 45.7, 15.899999999999785, 44.900000000000006, 47.3, 43.30000000000001, 40.30000000000002, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.5, 21.699999999999868, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.900000000000006, 46.699999999999996, 46.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 39.70000000000002], "episode_lengths": [92, 500, 166, 240, 94, 500, 500, 68, 500, 94, 68, 234, 500, 44, 500, 68, 42, 52, 500, 200, 500, 500, 42, 500, 54, 500, 58, 500, 500, 88, 500, 500, 94, 56, 118, 44, 500, 184, 24, 500, 500, 500, 70, 120, 500, 98, 500, 32, 500, 182, 104, 38, 92, 446, 124, 174, 500, 34, 268, 500, 44, 500, 500, 500, 40, 500, 500, 26, 500, 500, 252, 240, 44, 342, 52, 28, 68, 98, 54, 500, 500, 500, 62, 500, 46, 284, 64, 42, 500, 500, 62, 500, 62, 34, 36, 500, 50, 500, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3734573187955012, "mean_inference_ms": 1.1954768940340943, "mean_action_processing_ms": 0.13938287675743863, "mean_env_wait_ms": 0.08146111653674452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500056266784668, "StateBufferConnector_ms": 0.008002758026123047, "ViewRequirementAgentConnector_ms": 0.14399433135986328}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5037.388650383346, "num_env_steps_trained_throughput_per_sec": 5037.388650383346, "timesteps_total": 900000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 2259.468, "sample_time_ms": 1891.481, "load_time_ms": 11.966, "load_throughput": 1002876.186, "learn_time_ms": 345.291, "learn_throughput": 34753.272, "synch_weights_time_ms": 9.444}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3351, "training_iteration": 75, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-14", "timestamp": 1698247154, "time_this_iter_s": 2.387178897857666, "time_total_s": 169.9193115234375, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 169.9193115234375, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 64.60000000000001, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339379e-24, "cur_lr": 0.0003, "total_loss": 6.8492317994435625, "policy_loss": -0.0003499588618675868, "vf_loss": 6.849629735946655, "vf_explained_var": -1.2199083964029947e-06, "kl": 0.000542520651408059, "entropy": 0.48030870258808134, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2265.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.853999999999819, "episode_len_mean": 252.08, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 40.90000000000002, 5.499999999999638, 37.70000000000003, 32.700000000000024, -50.00000000000044, 46.699999999999996, 23.29999999999989, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 24.899999999999913, 26.09999999999993, 45.7, 15.899999999999785, 44.900000000000006, 47.3, 43.30000000000001, 40.30000000000002, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.5, 21.699999999999868, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.900000000000006, 46.699999999999996, 46.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.5, -50.00000000000044, 43.7, 46.699999999999996, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 40.30000000000002, 43.30000000000001, 45.5, -50.00000000000044, 46.5, 40.10000000000002, 45.7, 45.5, -50.00000000000044, 44.10000000000001, 9.8999999999997, 40.90000000000002, 45.9, -50.00000000000044, 40.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.1, 45.1, 44.10000000000001, 41.90000000000001, 8.699999999999683, -50.00000000000044, 23.499999999999893, 36.900000000000034], "episode_lengths": [38, 92, 446, 124, 174, 500, 34, 268, 500, 44, 500, 500, 500, 40, 500, 500, 26, 500, 500, 252, 240, 44, 342, 52, 28, 68, 98, 54, 500, 500, 500, 62, 500, 46, 284, 64, 42, 500, 500, 62, 500, 62, 34, 36, 500, 50, 500, 500, 104, 500, 500, 28, 500, 36, 500, 64, 34, 500, 42, 500, 500, 38, 38, 500, 36, 500, 500, 500, 84, 98, 68, 46, 500, 36, 100, 44, 46, 500, 60, 402, 92, 42, 500, 100, 64, 500, 500, 60, 64, 500, 122, 500, 50, 50, 60, 82, 414, 500, 266, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37361378494492065, "mean_inference_ms": 1.1955794925581085, "mean_action_processing_ms": 0.13930746000690747, "mean_env_wait_ms": 0.08159507793917518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025996923446655273, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.1430046558380127}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.853999999999819, "episode_len_mean": 252.08, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 40.90000000000002, 5.499999999999638, 37.70000000000003, 32.700000000000024, -50.00000000000044, 46.699999999999996, 23.29999999999989, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 24.899999999999913, 26.09999999999993, 45.7, 15.899999999999785, 44.900000000000006, 47.3, 43.30000000000001, 40.30000000000002, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.5, 21.699999999999868, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.900000000000006, 46.699999999999996, 46.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.5, -50.00000000000044, 43.7, 46.699999999999996, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 40.30000000000002, 43.30000000000001, 45.5, -50.00000000000044, 46.5, 40.10000000000002, 45.7, 45.5, -50.00000000000044, 44.10000000000001, 9.8999999999997, 40.90000000000002, 45.9, -50.00000000000044, 40.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.1, 45.1, 44.10000000000001, 41.90000000000001, 8.699999999999683, -50.00000000000044, 23.499999999999893, 36.900000000000034], "episode_lengths": [38, 92, 446, 124, 174, 500, 34, 268, 500, 44, 500, 500, 500, 40, 500, 500, 26, 500, 500, 252, 240, 44, 342, 52, 28, 68, 98, 54, 500, 500, 500, 62, 500, 46, 284, 64, 42, 500, 500, 62, 500, 62, 34, 36, 500, 50, 500, 500, 104, 500, 500, 28, 500, 36, 500, 64, 34, 500, 42, 500, 500, 38, 38, 500, 36, 500, 500, 500, 84, 98, 68, 46, 500, 36, 100, 44, 46, 500, 60, 402, 92, 42, 500, 100, 64, 500, 500, 60, 64, 500, 122, 500, 50, 50, 60, 82, 414, 500, 266, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37361378494492065, "mean_inference_ms": 1.1955794925581085, "mean_action_processing_ms": 0.13930746000690747, "mean_env_wait_ms": 0.08159507793917518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025996923446655273, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.1430046558380127}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5555.636893784293, "num_env_steps_trained_throughput_per_sec": 5555.636893784293, "timesteps_total": 912000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 2262.976, "sample_time_ms": 1896.286, "load_time_ms": 11.881, "load_throughput": 1009990.167, "learn_time_ms": 344.013, "learn_throughput": 34882.383, "synch_weights_time_ms": 9.51}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 3402, "training_iteration": 76, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-16", "timestamp": 1698247156, "time_this_iter_s": 2.1654465198516846, "time_total_s": 172.08475804328918, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 172.08475804328918, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 59.333333333333336, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.6469779601696894e-24, "cur_lr": 0.0003, "total_loss": 6.3940332412719725, "policy_loss": -0.0007380220418175061, "vf_loss": 6.3948200384775795, "vf_explained_var": -7.987022399902344e-07, "kl": 0.0007658441682944309, "entropy": 0.4872346411148707, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2295.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.224999999999858, "episode_len_mean": 213.44, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, 46.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 40.30000000000002, 43.30000000000001, 45.5, -50.00000000000044, 46.5, 40.10000000000002, 45.7, 45.5, -50.00000000000044, 44.10000000000001, 9.8999999999997, 40.90000000000002, 45.9, -50.00000000000044, 40.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.1, 45.1, 44.10000000000001, 41.90000000000001, 8.699999999999683, -50.00000000000044, 23.499999999999893, 36.900000000000034, -50.00000000000044, 47.1, 44.900000000000006, -50.00000000000044, 22.299999999999876, 42.900000000000006, 45.3, -50.00000000000044, 44.300000000000004, 40.90000000000002, 45.7, 28.499999999999964, 46.9, -50.00000000000044, 47.1, 36.900000000000034, -50.00000000000044, 42.500000000000014, 44.300000000000004, 46.699999999999996, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 45.1, 44.5, 42.10000000000001, 28.09999999999996, 26.499999999999936, -50.00000000000044, 44.900000000000006, 44.7, 43.10000000000001, 44.7, 46.5, 46.699999999999996, 44.10000000000001, -50.00000000000044, 45.5, 32.700000000000024, 44.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.7, -50.00000000000044, 43.7, 47.3, 43.900000000000006, -50.00000000000044, 44.10000000000001, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3], "episode_lengths": [500, 38, 38, 500, 36, 500, 500, 500, 84, 98, 68, 46, 500, 36, 100, 44, 46, 500, 60, 402, 92, 42, 500, 100, 64, 500, 500, 60, 64, 500, 122, 500, 50, 50, 60, 82, 414, 500, 266, 132, 500, 30, 52, 500, 278, 72, 48, 500, 58, 92, 44, 216, 32, 500, 30, 132, 500, 76, 58, 34, 500, 50, 34, 500, 50, 56, 80, 220, 236, 500, 52, 54, 70, 54, 36, 34, 60, 500, 46, 174, 56, 500, 78, 500, 40, 500, 64, 500, 64, 28, 62, 500, 60, 40, 72, 500, 500, 500, 500, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3739917821691801, "mean_inference_ms": 1.1956097811383237, "mean_action_processing_ms": 0.1392732197163642, "mean_env_wait_ms": 0.08161815067334711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02398967742919922, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.11000251770019531}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.224999999999858, "episode_len_mean": 213.44, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, 46.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 40.30000000000002, 43.30000000000001, 45.5, -50.00000000000044, 46.5, 40.10000000000002, 45.7, 45.5, -50.00000000000044, 44.10000000000001, 9.8999999999997, 40.90000000000002, 45.9, -50.00000000000044, 40.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.1, 45.1, 44.10000000000001, 41.90000000000001, 8.699999999999683, -50.00000000000044, 23.499999999999893, 36.900000000000034, -50.00000000000044, 47.1, 44.900000000000006, -50.00000000000044, 22.299999999999876, 42.900000000000006, 45.3, -50.00000000000044, 44.300000000000004, 40.90000000000002, 45.7, 28.499999999999964, 46.9, -50.00000000000044, 47.1, 36.900000000000034, -50.00000000000044, 42.500000000000014, 44.300000000000004, 46.699999999999996, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 45.1, 44.5, 42.10000000000001, 28.09999999999996, 26.499999999999936, -50.00000000000044, 44.900000000000006, 44.7, 43.10000000000001, 44.7, 46.5, 46.699999999999996, 44.10000000000001, -50.00000000000044, 45.5, 32.700000000000024, 44.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.7, -50.00000000000044, 43.7, 47.3, 43.900000000000006, -50.00000000000044, 44.10000000000001, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3], "episode_lengths": [500, 38, 38, 500, 36, 500, 500, 500, 84, 98, 68, 46, 500, 36, 100, 44, 46, 500, 60, 402, 92, 42, 500, 100, 64, 500, 500, 60, 64, 500, 122, 500, 50, 50, 60, 82, 414, 500, 266, 132, 500, 30, 52, 500, 278, 72, 48, 500, 58, 92, 44, 216, 32, 500, 30, 132, 500, 76, 58, 34, 500, 50, 34, 500, 50, 56, 80, 220, 236, 500, 52, 54, 70, 54, 36, 34, 60, 500, 46, 174, 56, 500, 78, 500, 40, 500, 64, 500, 64, 28, 62, 500, 60, 40, 72, 500, 500, 500, 500, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3739917821691801, "mean_inference_ms": 1.1956097811383237, "mean_action_processing_ms": 0.1392732197163642, "mean_env_wait_ms": 0.08161815067334711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02398967742919922, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.11000251770019531}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5258.790031006307, "num_env_steps_trained_throughput_per_sec": 5258.790031006307, "timesteps_total": 924000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 2265.653, "sample_time_ms": 1895.445, "load_time_ms": 10.681, "load_throughput": 1123501.872, "learn_time_ms": 348.826, "learn_throughput": 34401.15, "synch_weights_time_ms": 9.416}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 3462, "training_iteration": 77, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-18", "timestamp": 1698247158, "time_this_iter_s": 2.2868924140930176, "time_total_s": 174.3716504573822, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 174.3716504573822, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 59.4, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848447e-24, "cur_lr": 0.0003, "total_loss": 6.308681710561117, "policy_loss": -0.0005728142956892649, "vf_loss": 6.309302711486817, "vf_explained_var": -1.1205673217773438e-06, "kl": 0.0011852281465432194, "entropy": 0.48239305516084036, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.148999999999837, "episode_len_mean": 234.16, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 22.299999999999876, 42.900000000000006, 45.3, -50.00000000000044, 44.300000000000004, 40.90000000000002, 45.7, 28.499999999999964, 46.9, -50.00000000000044, 47.1, 36.900000000000034, -50.00000000000044, 42.500000000000014, 44.300000000000004, 46.699999999999996, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 45.1, 44.5, 42.10000000000001, 28.09999999999996, 26.499999999999936, -50.00000000000044, 44.900000000000006, 44.7, 43.10000000000001, 44.7, 46.5, 46.699999999999996, 44.10000000000001, -50.00000000000044, 45.5, 32.700000000000024, 44.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.7, -50.00000000000044, 43.7, 47.3, 43.900000000000006, -50.00000000000044, 44.10000000000001, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.3, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 20.899999999999856, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.70000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 12.69999999999974, 20.49999999999985, 17.69999999999981, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.10000000000002, 43.30000000000001, 46.3, 46.699999999999996, -50.00000000000044, 44.10000000000001, 47.3, -50.00000000000044, 46.9, 42.70000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 46.099999999999994, -50.00000000000044], "episode_lengths": [52, 500, 278, 72, 48, 500, 58, 92, 44, 216, 32, 500, 30, 132, 500, 76, 58, 34, 500, 50, 34, 500, 50, 56, 80, 220, 236, 500, 52, 54, 70, 54, 36, 34, 60, 500, 46, 174, 56, 500, 78, 500, 40, 500, 64, 500, 64, 28, 62, 500, 60, 40, 72, 500, 500, 500, 500, 28, 28, 216, 500, 500, 500, 74, 292, 88, 500, 500, 500, 70, 94, 50, 500, 500, 500, 500, 54, 374, 296, 324, 500, 500, 52, 100, 68, 38, 34, 500, 60, 28, 500, 32, 74, 68, 500, 500, 500, 242, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37387526502353347, "mean_inference_ms": 1.1954758424836225, "mean_action_processing_ms": 0.13926442959881224, "mean_env_wait_ms": 0.08157368290279726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02898406982421875, "StateBufferConnector_ms": 0.009589195251464844, "ViewRequirementAgentConnector_ms": 0.10999798774719238}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.148999999999837, "episode_len_mean": 234.16, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 22.299999999999876, 42.900000000000006, 45.3, -50.00000000000044, 44.300000000000004, 40.90000000000002, 45.7, 28.499999999999964, 46.9, -50.00000000000044, 47.1, 36.900000000000034, -50.00000000000044, 42.500000000000014, 44.300000000000004, 46.699999999999996, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 45.1, 44.5, 42.10000000000001, 28.09999999999996, 26.499999999999936, -50.00000000000044, 44.900000000000006, 44.7, 43.10000000000001, 44.7, 46.5, 46.699999999999996, 44.10000000000001, -50.00000000000044, 45.5, 32.700000000000024, 44.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.7, -50.00000000000044, 43.7, 47.3, 43.900000000000006, -50.00000000000044, 44.10000000000001, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.3, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 20.899999999999856, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.70000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 12.69999999999974, 20.49999999999985, 17.69999999999981, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.10000000000002, 43.30000000000001, 46.3, 46.699999999999996, -50.00000000000044, 44.10000000000001, 47.3, -50.00000000000044, 46.9, 42.70000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 46.099999999999994, -50.00000000000044], "episode_lengths": [52, 500, 278, 72, 48, 500, 58, 92, 44, 216, 32, 500, 30, 132, 500, 76, 58, 34, 500, 50, 34, 500, 50, 56, 80, 220, 236, 500, 52, 54, 70, 54, 36, 34, 60, 500, 46, 174, 56, 500, 78, 500, 40, 500, 64, 500, 64, 28, 62, 500, 60, 40, 72, 500, 500, 500, 500, 28, 28, 216, 500, 500, 500, 74, 292, 88, 500, 500, 500, 70, 94, 50, 500, 500, 500, 500, 54, 374, 296, 324, 500, 500, 52, 100, 68, 38, 34, 500, 60, 28, 500, 32, 74, 68, 500, 500, 500, 242, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37387526502353347, "mean_inference_ms": 1.1954758424836225, "mean_action_processing_ms": 0.13926442959881224, "mean_env_wait_ms": 0.08157368290279726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02898406982421875, "StateBufferConnector_ms": 0.009589195251464844, "ViewRequirementAgentConnector_ms": 0.10999798774719238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5309.207486697353, "num_env_steps_trained_throughput_per_sec": 5309.207486697353, "timesteps_total": 936000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 2275.092, "sample_time_ms": 1902.866, "load_time_ms": 10.85, "load_throughput": 1105990.745, "learn_time_ms": 350.7, "learn_throughput": 34217.282, "synch_weights_time_ms": 9.39}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3504, "training_iteration": 78, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-21", "timestamp": 1698247161, "time_this_iter_s": 2.265219211578369, "time_total_s": 176.63686966896057, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 176.63686966896057, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 56.06666666666666, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424224e-25, "cur_lr": 0.0003, "total_loss": 6.884673357009888, "policy_loss": -0.00033102681239446, "vf_loss": 6.885052522023519, "vf_explained_var": -5.165735880533854e-07, "kl": 0.0005228850875444853, "entropy": 0.4814594745635986, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2355.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.263999999999815, "episode_len_mean": 267.98, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.3, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 20.899999999999856, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.70000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 12.69999999999974, 20.49999999999985, 17.69999999999981, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.10000000000002, 43.30000000000001, 46.3, 46.699999999999996, -50.00000000000044, 44.10000000000001, 47.3, -50.00000000000044, 46.9, 42.70000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.5, -50.00000000000044, 11.29999999999972, 46.5, -50.00000000000044, -50.00000000000044, 19.09999999999983, 39.70000000000002, -50.00000000000044, 28.699999999999967, 27.099999999999945, 36.10000000000004, 46.3, 44.900000000000006, 44.300000000000004, 45.9, 38.10000000000002, 45.5, 44.300000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 46.9, 45.1, 39.300000000000026, 39.10000000000002, 31.70000000000001, 9.099999999999689, 21.89999999999987, 37.50000000000003, 21.89999999999987, 34.30000000000004, 37.90000000000003, -50.00000000000044, 45.5, 45.1], "episode_lengths": [500, 60, 40, 72, 500, 500, 500, 500, 28, 28, 216, 500, 500, 500, 74, 292, 88, 500, 500, 500, 70, 94, 50, 500, 500, 500, 500, 54, 374, 296, 324, 500, 500, 52, 100, 68, 38, 34, 500, 60, 28, 500, 32, 74, 68, 500, 500, 500, 242, 40, 500, 500, 500, 176, 500, 156, 500, 46, 500, 388, 36, 500, 500, 310, 104, 500, 214, 230, 140, 38, 52, 58, 42, 120, 46, 58, 130, 500, 500, 500, 364, 500, 500, 58, 500, 76, 32, 50, 108, 110, 184, 410, 282, 126, 282, 158, 122, 500, 46, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.374544073525457, "mean_inference_ms": 1.1964104603460344, "mean_action_processing_ms": 0.13963788865980167, "mean_env_wait_ms": 0.0817168131011973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027992725372314453, "StateBufferConnector_ms": 0.015590906143188477, "ViewRequirementAgentConnector_ms": 0.12602853775024414}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.263999999999815, "episode_len_mean": 267.98, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.3, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 20.899999999999856, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.70000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 12.69999999999974, 20.49999999999985, 17.69999999999981, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.10000000000002, 43.30000000000001, 46.3, 46.699999999999996, -50.00000000000044, 44.10000000000001, 47.3, -50.00000000000044, 46.9, 42.70000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.5, -50.00000000000044, 11.29999999999972, 46.5, -50.00000000000044, -50.00000000000044, 19.09999999999983, 39.70000000000002, -50.00000000000044, 28.699999999999967, 27.099999999999945, 36.10000000000004, 46.3, 44.900000000000006, 44.300000000000004, 45.9, 38.10000000000002, 45.5, 44.300000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 46.9, 45.1, 39.300000000000026, 39.10000000000002, 31.70000000000001, 9.099999999999689, 21.89999999999987, 37.50000000000003, 21.89999999999987, 34.30000000000004, 37.90000000000003, -50.00000000000044, 45.5, 45.1], "episode_lengths": [500, 60, 40, 72, 500, 500, 500, 500, 28, 28, 216, 500, 500, 500, 74, 292, 88, 500, 500, 500, 70, 94, 50, 500, 500, 500, 500, 54, 374, 296, 324, 500, 500, 52, 100, 68, 38, 34, 500, 60, 28, 500, 32, 74, 68, 500, 500, 500, 242, 40, 500, 500, 500, 176, 500, 156, 500, 46, 500, 388, 36, 500, 500, 310, 104, 500, 214, 230, 140, 38, 52, 58, 42, 120, 46, 58, 130, 500, 500, 500, 364, 500, 500, 58, 500, 76, 32, 50, 108, 110, 184, 410, 282, 126, 282, 158, 122, 500, 46, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.374544073525457, "mean_inference_ms": 1.1964104603460344, "mean_action_processing_ms": 0.13963788865980167, "mean_env_wait_ms": 0.0817168131011973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027992725372314453, "StateBufferConnector_ms": 0.015590906143188477, "ViewRequirementAgentConnector_ms": 0.12602853775024414}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4865.116852742674, "num_env_steps_trained_throughput_per_sec": 4865.116852742674, "timesteps_total": 948000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 2287.528, "sample_time_ms": 1917.075, "load_time_ms": 10.886, "load_throughput": 1102347.597, "learn_time_ms": 349.306, "learn_throughput": 34353.851, "synch_weights_time_ms": 8.976}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 3553, "training_iteration": 79, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-23", "timestamp": 1698247163, "time_this_iter_s": 2.4717159271240234, "time_total_s": 179.1085855960846, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 179.1085855960846, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 54.875, "ram_util_percent": 26.424999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.308722450212112e-25, "cur_lr": 0.0003, "total_loss": 6.2969512939453125, "policy_loss": -2.4439386713008086e-05, "vf_loss": 6.297024472554525, "vf_explained_var": -9.179115295410156e-07, "kl": 8.772001275000699e-05, "entropy": 0.48701170484224954, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2385.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.227999999999827, "episode_len_mean": 258.36, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.5, -50.00000000000044, 11.29999999999972, 46.5, -50.00000000000044, -50.00000000000044, 19.09999999999983, 39.70000000000002, -50.00000000000044, 28.699999999999967, 27.099999999999945, 36.10000000000004, 46.3, 44.900000000000006, 44.300000000000004, 45.9, 38.10000000000002, 45.5, 44.300000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 46.9, 45.1, 39.300000000000026, 39.10000000000002, 31.70000000000001, 9.099999999999689, 21.89999999999987, 37.50000000000003, 21.89999999999987, 34.30000000000004, 37.90000000000003, -50.00000000000044, 45.5, 45.1, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 44.5, -50.00000000000044, 45.9, 46.3, 35.900000000000034, 47.5, 37.90000000000003, 45.5, 40.10000000000002, 14.09999999999976, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.9, 46.9, 46.5, 44.900000000000006, 45.5, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 42.70000000000001, 44.5, -50.00000000000044, 40.90000000000002, 29.099999999999973, 23.8999999999999, 46.9, 41.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [68, 500, 500, 500, 242, 40, 500, 500, 500, 176, 500, 156, 500, 46, 500, 388, 36, 500, 500, 310, 104, 500, 214, 230, 140, 38, 52, 58, 42, 120, 46, 58, 130, 500, 500, 500, 364, 500, 500, 58, 500, 76, 32, 50, 108, 110, 184, 410, 282, 126, 282, 158, 122, 500, 46, 50, 500, 500, 212, 500, 500, 500, 500, 260, 56, 500, 42, 38, 142, 26, 122, 46, 100, 360, 500, 500, 36, 500, 70, 500, 42, 32, 36, 52, 46, 88, 500, 500, 500, 64, 74, 56, 500, 92, 210, 262, 32, 88, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37466317855819264, "mean_inference_ms": 1.1973604286851396, "mean_action_processing_ms": 0.13951950804624613, "mean_env_wait_ms": 0.08162481340237321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02349686622619629, "StateBufferConnector_ms": 0.011997699737548828, "ViewRequirementAgentConnector_ms": 0.12208294868469238}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.227999999999827, "episode_len_mean": 258.36, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.5, -50.00000000000044, 11.29999999999972, 46.5, -50.00000000000044, -50.00000000000044, 19.09999999999983, 39.70000000000002, -50.00000000000044, 28.699999999999967, 27.099999999999945, 36.10000000000004, 46.3, 44.900000000000006, 44.300000000000004, 45.9, 38.10000000000002, 45.5, 44.300000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 46.9, 45.1, 39.300000000000026, 39.10000000000002, 31.70000000000001, 9.099999999999689, 21.89999999999987, 37.50000000000003, 21.89999999999987, 34.30000000000004, 37.90000000000003, -50.00000000000044, 45.5, 45.1, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 44.5, -50.00000000000044, 45.9, 46.3, 35.900000000000034, 47.5, 37.90000000000003, 45.5, 40.10000000000002, 14.09999999999976, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.9, 46.9, 46.5, 44.900000000000006, 45.5, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 42.70000000000001, 44.5, -50.00000000000044, 40.90000000000002, 29.099999999999973, 23.8999999999999, 46.9, 41.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [68, 500, 500, 500, 242, 40, 500, 500, 500, 176, 500, 156, 500, 46, 500, 388, 36, 500, 500, 310, 104, 500, 214, 230, 140, 38, 52, 58, 42, 120, 46, 58, 130, 500, 500, 500, 364, 500, 500, 58, 500, 76, 32, 50, 108, 110, 184, 410, 282, 126, 282, 158, 122, 500, 46, 50, 500, 500, 212, 500, 500, 500, 500, 260, 56, 500, 42, 38, 142, 26, 122, 46, 100, 360, 500, 500, 36, 500, 70, 500, 42, 32, 36, 52, 46, 88, 500, 500, 500, 64, 74, 56, 500, 92, 210, 262, 32, 88, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37466317855819264, "mean_inference_ms": 1.1973604286851396, "mean_action_processing_ms": 0.13951950804624613, "mean_env_wait_ms": 0.08162481340237321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02349686622619629, "StateBufferConnector_ms": 0.011997699737548828, "ViewRequirementAgentConnector_ms": 0.12208294868469238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5310.7054534189465, "num_env_steps_trained_throughput_per_sec": 5310.7054534189465, "timesteps_total": 960000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 2298.577, "sample_time_ms": 1919.521, "load_time_ms": 12.076, "load_throughput": 993702.898, "learn_time_ms": 356.763, "learn_throughput": 33635.792, "synch_weights_time_ms": 8.934}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 3597, "training_iteration": 80, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-25", "timestamp": 1698247165, "time_this_iter_s": 2.2635884284973145, "time_total_s": 181.3721740245819, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 181.3721740245819, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 61.300000000000004, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.654361225106056e-25, "cur_lr": 0.0003, "total_loss": 6.780067173639933, "policy_loss": -0.0005849852226674557, "vf_loss": 6.780699284871419, "vf_explained_var": -8.861223856608073e-07, "kl": 0.0008051906439618505, "entropy": 0.4717972964048386, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2415.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.888999999999841, "episode_len_mean": 236.76, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 44.5, -50.00000000000044, 45.9, 46.3, 35.900000000000034, 47.5, 37.90000000000003, 45.5, 40.10000000000002, 14.09999999999976, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.9, 46.9, 46.5, 44.900000000000006, 45.5, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 42.70000000000001, 44.5, -50.00000000000044, 40.90000000000002, 29.099999999999973, 23.8999999999999, 46.9, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, 44.10000000000001, 35.70000000000003, 40.500000000000014, 45.7, 46.5, 43.30000000000001, 23.499999999999893, 43.7, -50.00000000000044, 42.30000000000001, 42.10000000000001, 44.900000000000006, 45.1, 43.50000000000001, 43.30000000000001, 46.099999999999994, -50.00000000000044, 46.3, 38.90000000000002, 43.900000000000006, -50.00000000000044, 6.299999999999649, 45.9, -50.00000000000044, -50.00000000000044, 45.5, 44.10000000000001, 27.299999999999947, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.10000000000002, 37.50000000000003, 46.699999999999996, 43.50000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.3, 44.900000000000006, 41.30000000000001, 35.30000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 212, 500, 500, 500, 500, 260, 56, 500, 42, 38, 142, 26, 122, 46, 100, 360, 500, 500, 36, 500, 70, 500, 42, 32, 36, 52, 46, 88, 500, 500, 500, 64, 74, 56, 500, 92, 210, 262, 32, 88, 500, 500, 60, 500, 40, 60, 144, 96, 44, 36, 68, 266, 64, 500, 78, 80, 52, 50, 66, 68, 40, 500, 38, 112, 62, 500, 438, 42, 500, 500, 46, 60, 228, 500, 26, 500, 500, 62, 110, 126, 34, 66, 500, 106, 500, 500, 500, 500, 196, 500, 500, 102, 500, 38, 52, 88, 148, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3743966099107444, "mean_inference_ms": 1.198019487909897, "mean_action_processing_ms": 0.13922070669929373, "mean_env_wait_ms": 0.08130860335745631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02850508689880371, "StateBufferConnector_ms": 0.005995988845825195, "ViewRequirementAgentConnector_ms": 0.12807703018188477}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.888999999999841, "episode_len_mean": 236.76, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 44.5, -50.00000000000044, 45.9, 46.3, 35.900000000000034, 47.5, 37.90000000000003, 45.5, 40.10000000000002, 14.09999999999976, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.9, 46.9, 46.5, 44.900000000000006, 45.5, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 42.70000000000001, 44.5, -50.00000000000044, 40.90000000000002, 29.099999999999973, 23.8999999999999, 46.9, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, 44.10000000000001, 35.70000000000003, 40.500000000000014, 45.7, 46.5, 43.30000000000001, 23.499999999999893, 43.7, -50.00000000000044, 42.30000000000001, 42.10000000000001, 44.900000000000006, 45.1, 43.50000000000001, 43.30000000000001, 46.099999999999994, -50.00000000000044, 46.3, 38.90000000000002, 43.900000000000006, -50.00000000000044, 6.299999999999649, 45.9, -50.00000000000044, -50.00000000000044, 45.5, 44.10000000000001, 27.299999999999947, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.10000000000002, 37.50000000000003, 46.699999999999996, 43.50000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.3, 44.900000000000006, 41.30000000000001, 35.30000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 212, 500, 500, 500, 500, 260, 56, 500, 42, 38, 142, 26, 122, 46, 100, 360, 500, 500, 36, 500, 70, 500, 42, 32, 36, 52, 46, 88, 500, 500, 500, 64, 74, 56, 500, 92, 210, 262, 32, 88, 500, 500, 60, 500, 40, 60, 144, 96, 44, 36, 68, 266, 64, 500, 78, 80, 52, 50, 66, 68, 40, 500, 38, 112, 62, 500, 438, 42, 500, 500, 46, 60, 228, 500, 26, 500, 500, 62, 110, 126, 34, 66, 500, 106, 500, 500, 500, 500, 196, 500, 500, 102, 500, 38, 52, 88, 148, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3743966099107444, "mean_inference_ms": 1.198019487909897, "mean_action_processing_ms": 0.13922070669929373, "mean_env_wait_ms": 0.08130860335745631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02850508689880371, "StateBufferConnector_ms": 0.005995988845825195, "ViewRequirementAgentConnector_ms": 0.12807703018188477}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5372.376662468245, "num_env_steps_trained_throughput_per_sec": 5372.376662468245, "timesteps_total": 972000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 2282.839, "sample_time_ms": 1920.204, "load_time_ms": 11.299, "load_throughput": 1062003.709, "learn_time_ms": 341.243, "learn_throughput": 35165.507, "synch_weights_time_ms": 8.912}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3654, "training_iteration": 81, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-28", "timestamp": 1698247168, "time_this_iter_s": 2.2388663291931152, "time_total_s": 183.61104035377502, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 183.61104035377502, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 57.366666666666674, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.27180612553028e-26, "cur_lr": 0.0003, "total_loss": 6.544314002990722, "policy_loss": -0.0007098262353489797, "vf_loss": 6.545071840286255, "vf_explained_var": -1.1324882507324219e-06, "kl": 0.0010981091003562445, "entropy": 0.48090349237124125, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2445.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.367999999999809, "episode_len_mean": 266.92, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, 29.099999999999973, 23.8999999999999, 46.9, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, 44.10000000000001, 35.70000000000003, 40.500000000000014, 45.7, 46.5, 43.30000000000001, 23.499999999999893, 43.7, -50.00000000000044, 42.30000000000001, 42.10000000000001, 44.900000000000006, 45.1, 43.50000000000001, 43.30000000000001, 46.099999999999994, -50.00000000000044, 46.3, 38.90000000000002, 43.900000000000006, -50.00000000000044, 6.299999999999649, 45.9, -50.00000000000044, -50.00000000000044, 45.5, 44.10000000000001, 27.299999999999947, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.10000000000002, 37.50000000000003, 46.699999999999996, 43.50000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.3, 44.900000000000006, 41.30000000000001, 35.30000000000004, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 5.299999999999635, 44.7, 41.30000000000001, -50.00000000000044, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 43.50000000000001, 40.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, 35.10000000000004, 20.099999999999845, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [92, 210, 262, 32, 88, 500, 500, 60, 500, 40, 60, 144, 96, 44, 36, 68, 266, 64, 500, 78, 80, 52, 50, 66, 68, 40, 500, 38, 112, 62, 500, 438, 42, 500, 500, 46, 60, 228, 500, 26, 500, 500, 62, 110, 126, 34, 66, 500, 106, 500, 500, 500, 500, 196, 500, 500, 102, 500, 38, 52, 88, 148, 500, 500, 158, 500, 500, 448, 54, 88, 500, 492, 500, 500, 40, 40, 500, 500, 500, 350, 36, 500, 500, 500, 42, 66, 92, 500, 56, 500, 150, 300, 500, 78, 500, 500, 26, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3742320896533135, "mean_inference_ms": 1.1970965055796585, "mean_action_processing_ms": 0.1393351650695112, "mean_env_wait_ms": 0.08151565771440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025528669357299805, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.12500905990600586}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.367999999999809, "episode_len_mean": 266.92, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, 29.099999999999973, 23.8999999999999, 46.9, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, 44.10000000000001, 35.70000000000003, 40.500000000000014, 45.7, 46.5, 43.30000000000001, 23.499999999999893, 43.7, -50.00000000000044, 42.30000000000001, 42.10000000000001, 44.900000000000006, 45.1, 43.50000000000001, 43.30000000000001, 46.099999999999994, -50.00000000000044, 46.3, 38.90000000000002, 43.900000000000006, -50.00000000000044, 6.299999999999649, 45.9, -50.00000000000044, -50.00000000000044, 45.5, 44.10000000000001, 27.299999999999947, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.10000000000002, 37.50000000000003, 46.699999999999996, 43.50000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.3, 44.900000000000006, 41.30000000000001, 35.30000000000004, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 5.299999999999635, 44.7, 41.30000000000001, -50.00000000000044, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 43.50000000000001, 40.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, 35.10000000000004, 20.099999999999845, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [92, 210, 262, 32, 88, 500, 500, 60, 500, 40, 60, 144, 96, 44, 36, 68, 266, 64, 500, 78, 80, 52, 50, 66, 68, 40, 500, 38, 112, 62, 500, 438, 42, 500, 500, 46, 60, 228, 500, 26, 500, 500, 62, 110, 126, 34, 66, 500, 106, 500, 500, 500, 500, 196, 500, 500, 102, 500, 38, 52, 88, 148, 500, 500, 158, 500, 500, 448, 54, 88, 500, 492, 500, 500, 40, 40, 500, 500, 500, 350, 36, 500, 500, 500, 42, 66, 92, 500, 56, 500, 150, 300, 500, 78, 500, 500, 26, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3742320896533135, "mean_inference_ms": 1.1970965055796585, "mean_action_processing_ms": 0.1393351650695112, "mean_env_wait_ms": 0.08151565771440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025528669357299805, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.12500905990600586}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5217.297308727735, "num_env_steps_trained_throughput_per_sec": 5217.297308727735, "timesteps_total": 984000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 2298.041, "sample_time_ms": 1926.888, "load_time_ms": 12.097, "load_throughput": 992010.722, "learn_time_ms": 348.906, "learn_throughput": 34393.216, "synch_weights_time_ms": 8.97}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 3690, "training_iteration": 82, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-30", "timestamp": 1698247170, "time_this_iter_s": 2.3090403079986572, "time_total_s": 185.92008066177368, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 185.92008066177368, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 51.474999999999994, "ram_util_percent": 26.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.13590306276514e-26, "cur_lr": 0.0003, "total_loss": 6.579891347885132, "policy_loss": -0.00045845210552215577, "vf_loss": 6.580398035049439, "vf_explained_var": -1.0311603546142579e-06, "kl": 0.0009321301426401381, "entropy": 0.4825111240148544, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2475.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.9620000000002187, "episode_len_mean": 300.16, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.50000000000003, 46.699999999999996, 43.50000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.3, 44.900000000000006, 41.30000000000001, 35.30000000000004, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 5.299999999999635, 44.7, 41.30000000000001, -50.00000000000044, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 43.50000000000001, 40.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, 35.10000000000004, 20.099999999999845, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.10000000000001, 37.300000000000026, 46.699999999999996, -50.00000000000044, 40.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, 30.9, 36.10000000000004, -50.00000000000044, 38.90000000000002, 33.90000000000004, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.5, 16.499999999999794, 10.499999999999709, 42.30000000000001, 45.3, 47.1, 42.900000000000006, 43.50000000000001, 15.899999999999785, 45.1, 44.10000000000001, 45.5, 34.10000000000004, -50.00000000000044], "episode_lengths": [126, 34, 66, 500, 106, 500, 500, 500, 500, 196, 500, 500, 102, 500, 38, 52, 88, 148, 500, 500, 158, 500, 500, 448, 54, 88, 500, 492, 500, 500, 40, 40, 500, 500, 500, 350, 36, 500, 500, 500, 42, 66, 92, 500, 56, 500, 150, 300, 500, 78, 500, 500, 26, 500, 500, 500, 500, 166, 500, 500, 500, 124, 60, 128, 34, 500, 96, 76, 500, 500, 192, 140, 500, 112, 162, 160, 500, 500, 500, 308, 500, 500, 500, 500, 56, 500, 46, 336, 396, 78, 48, 30, 72, 66, 342, 50, 60, 46, 160, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37442497611424824, "mean_inference_ms": 1.1969749757706598, "mean_action_processing_ms": 0.13979339640956287, "mean_env_wait_ms": 0.0816001849773405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01998758316040039, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.11819791793823242}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.9620000000002187, "episode_len_mean": 300.16, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.50000000000003, 46.699999999999996, 43.50000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.3, 44.900000000000006, 41.30000000000001, 35.30000000000004, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 5.299999999999635, 44.7, 41.30000000000001, -50.00000000000044, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 43.50000000000001, 40.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, 35.10000000000004, 20.099999999999845, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.10000000000001, 37.300000000000026, 46.699999999999996, -50.00000000000044, 40.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, 30.9, 36.10000000000004, -50.00000000000044, 38.90000000000002, 33.90000000000004, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.5, 16.499999999999794, 10.499999999999709, 42.30000000000001, 45.3, 47.1, 42.900000000000006, 43.50000000000001, 15.899999999999785, 45.1, 44.10000000000001, 45.5, 34.10000000000004, -50.00000000000044], "episode_lengths": [126, 34, 66, 500, 106, 500, 500, 500, 500, 196, 500, 500, 102, 500, 38, 52, 88, 148, 500, 500, 158, 500, 500, 448, 54, 88, 500, 492, 500, 500, 40, 40, 500, 500, 500, 350, 36, 500, 500, 500, 42, 66, 92, 500, 56, 500, 150, 300, 500, 78, 500, 500, 26, 500, 500, 500, 500, 166, 500, 500, 500, 124, 60, 128, 34, 500, 96, 76, 500, 500, 192, 140, 500, 112, 162, 160, 500, 500, 500, 308, 500, 500, 500, 500, 56, 500, 46, 336, 396, 78, 48, 30, 72, 66, 342, 50, 60, 46, 160, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37442497611424824, "mean_inference_ms": 1.1969749757706598, "mean_action_processing_ms": 0.13979339640956287, "mean_env_wait_ms": 0.0816001849773405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01998758316040039, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.11819791793823242}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5409.356321646368, "num_env_steps_trained_throughput_per_sec": 5409.356321646368, "timesteps_total": 996000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 2276.614, "sample_time_ms": 1929.41, "load_time_ms": 11.4, "load_throughput": 1052615.412, "learn_time_ms": 325.795, "learn_throughput": 36832.999, "synch_weights_time_ms": 8.829}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 3734, "training_iteration": 83, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-32", "timestamp": 1698247172, "time_this_iter_s": 2.224377393722534, "time_total_s": 188.14445805549622, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 188.14445805549622, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 61.33333333333334, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.06795153138257e-26, "cur_lr": 0.0003, "total_loss": 6.128821722666422, "policy_loss": -0.00037395767867565155, "vf_loss": 6.129246060053507, "vf_explained_var": -8.424123128255208e-07, "kl": 0.001342957428972132, "entropy": 0.5045595159133275, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2505.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.6229999999998036, "episode_len_mean": 279.34, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, -50.00000000000044, 35.10000000000004, 20.099999999999845, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.10000000000001, 37.300000000000026, 46.699999999999996, -50.00000000000044, 40.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, 30.9, 36.10000000000004, -50.00000000000044, 38.90000000000002, 33.90000000000004, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.5, 16.499999999999794, 10.499999999999709, 42.30000000000001, 45.3, 47.1, 42.900000000000006, 43.50000000000001, 15.899999999999785, 45.1, 44.10000000000001, 45.5, 34.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 40.90000000000002, 39.10000000000002, -50.00000000000044, 44.900000000000006, 23.699999999999896, 45.7, 43.10000000000001, -50.00000000000044, 36.50000000000003, -50.00000000000044, 22.699999999999882, 39.90000000000002, 43.7, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, 36.10000000000004, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 33.500000000000036, 46.3, 42.900000000000006, 44.900000000000006, -50.00000000000044, 42.30000000000001], "episode_lengths": [500, 56, 500, 150, 300, 500, 78, 500, 500, 26, 500, 500, 500, 500, 166, 500, 500, 500, 124, 60, 128, 34, 500, 96, 76, 500, 500, 192, 140, 500, 112, 162, 160, 500, 500, 500, 308, 500, 500, 500, 500, 56, 500, 46, 336, 396, 78, 48, 30, 72, 66, 342, 50, 60, 46, 160, 500, 500, 44, 50, 500, 500, 500, 50, 500, 92, 110, 500, 52, 264, 44, 70, 500, 136, 500, 274, 102, 64, 500, 40, 50, 500, 140, 94, 500, 500, 500, 42, 500, 130, 500, 500, 26, 500, 166, 38, 72, 52, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3740042934403563, "mean_inference_ms": 1.1979971460406742, "mean_action_processing_ms": 0.13975408180254192, "mean_env_wait_ms": 0.08136009857711256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024988651275634766, "StateBufferConnector_ms": 0.003997325897216797, "ViewRequirementAgentConnector_ms": 0.11020779609680176}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.6229999999998036, "episode_len_mean": 279.34, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, -50.00000000000044, 35.10000000000004, 20.099999999999845, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.10000000000001, 37.300000000000026, 46.699999999999996, -50.00000000000044, 40.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, 30.9, 36.10000000000004, -50.00000000000044, 38.90000000000002, 33.90000000000004, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.5, 16.499999999999794, 10.499999999999709, 42.30000000000001, 45.3, 47.1, 42.900000000000006, 43.50000000000001, 15.899999999999785, 45.1, 44.10000000000001, 45.5, 34.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 40.90000000000002, 39.10000000000002, -50.00000000000044, 44.900000000000006, 23.699999999999896, 45.7, 43.10000000000001, -50.00000000000044, 36.50000000000003, -50.00000000000044, 22.699999999999882, 39.90000000000002, 43.7, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, 36.10000000000004, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 33.500000000000036, 46.3, 42.900000000000006, 44.900000000000006, -50.00000000000044, 42.30000000000001], "episode_lengths": [500, 56, 500, 150, 300, 500, 78, 500, 500, 26, 500, 500, 500, 500, 166, 500, 500, 500, 124, 60, 128, 34, 500, 96, 76, 500, 500, 192, 140, 500, 112, 162, 160, 500, 500, 500, 308, 500, 500, 500, 500, 56, 500, 46, 336, 396, 78, 48, 30, 72, 66, 342, 50, 60, 46, 160, 500, 500, 44, 50, 500, 500, 500, 50, 500, 92, 110, 500, 52, 264, 44, 70, 500, 136, 500, 274, 102, 64, 500, 40, 50, 500, 140, 94, 500, 500, 500, 42, 500, 130, 500, 500, 26, 500, 166, 38, 72, 52, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3740042934403563, "mean_inference_ms": 1.1979971460406742, "mean_action_processing_ms": 0.13975408180254192, "mean_env_wait_ms": 0.08136009857711256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024988651275634766, "StateBufferConnector_ms": 0.003997325897216797, "ViewRequirementAgentConnector_ms": 0.11020779609680176}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5354.745656845557, "num_env_steps_trained_throughput_per_sec": 5354.745656845557, "timesteps_total": 1008000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 2280.347, "sample_time_ms": 1920.969, "load_time_ms": 11.4, "load_throughput": 1052606.606, "learn_time_ms": 338.068, "learn_throughput": 35495.791, "synch_weights_time_ms": 8.829}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3777, "training_iteration": 84, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-34", "timestamp": 1698247174, "time_this_iter_s": 2.2460007667541504, "time_total_s": 190.39045882225037, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 190.39045882225037, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 58.46666666666667, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.033975765691285e-26, "cur_lr": 0.0003, "total_loss": 6.543368037541708, "policy_loss": -0.00035524082680543265, "vf_loss": 6.543774000803629, "vf_explained_var": -8.50359598795573e-07, "kl": 0.0007673366023709605, "entropy": 0.506625215212504, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2535.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.791999999999815, "episode_len_mean": 262.72, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 45.5, 16.499999999999794, 10.499999999999709, 42.30000000000001, 45.3, 47.1, 42.900000000000006, 43.50000000000001, 15.899999999999785, 45.1, 44.10000000000001, 45.5, 34.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 40.90000000000002, 39.10000000000002, -50.00000000000044, 44.900000000000006, 23.699999999999896, 45.7, 43.10000000000001, -50.00000000000044, 36.50000000000003, -50.00000000000044, 22.699999999999882, 39.90000000000002, 43.7, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, 36.10000000000004, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 33.500000000000036, 46.3, 42.900000000000006, 44.900000000000006, -50.00000000000044, 42.30000000000001, -50.00000000000044, 34.50000000000004, 36.50000000000003, -50.00000000000044, -50.00000000000044, 47.5, 44.7, -50.00000000000044, 44.5, 44.10000000000001, 12.099999999999731, 46.5, -50.00000000000044, -50.00000000000044, 5.499999999999638, -50.00000000000044, 41.500000000000014, 45.1, 47.3, 11.29999999999972, 44.10000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 24.099999999999902, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 2.299999999999592, 45.9, 11.29999999999972, -50.00000000000044, 0.6999999999995694, 47.7, 30.699999999999996, 38.50000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [56, 500, 46, 336, 396, 78, 48, 30, 72, 66, 342, 50, 60, 46, 160, 500, 500, 44, 50, 500, 500, 500, 50, 500, 92, 110, 500, 52, 264, 44, 70, 500, 136, 500, 274, 102, 64, 500, 40, 50, 500, 140, 94, 500, 500, 500, 42, 500, 130, 500, 500, 26, 500, 166, 38, 72, 52, 500, 78, 500, 156, 136, 500, 500, 26, 54, 500, 56, 60, 380, 36, 500, 500, 446, 500, 86, 50, 28, 388, 60, 58, 500, 500, 52, 500, 260, 500, 138, 500, 500, 478, 42, 388, 500, 494, 24, 194, 116, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37405924104483057, "mean_inference_ms": 1.1979129530386736, "mean_action_processing_ms": 0.13970630990015023, "mean_env_wait_ms": 0.08147971173809625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028992414474487305, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.10000920295715332}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.791999999999815, "episode_len_mean": 262.72, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 45.5, 16.499999999999794, 10.499999999999709, 42.30000000000001, 45.3, 47.1, 42.900000000000006, 43.50000000000001, 15.899999999999785, 45.1, 44.10000000000001, 45.5, 34.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 40.90000000000002, 39.10000000000002, -50.00000000000044, 44.900000000000006, 23.699999999999896, 45.7, 43.10000000000001, -50.00000000000044, 36.50000000000003, -50.00000000000044, 22.699999999999882, 39.90000000000002, 43.7, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, 36.10000000000004, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 33.500000000000036, 46.3, 42.900000000000006, 44.900000000000006, -50.00000000000044, 42.30000000000001, -50.00000000000044, 34.50000000000004, 36.50000000000003, -50.00000000000044, -50.00000000000044, 47.5, 44.7, -50.00000000000044, 44.5, 44.10000000000001, 12.099999999999731, 46.5, -50.00000000000044, -50.00000000000044, 5.499999999999638, -50.00000000000044, 41.500000000000014, 45.1, 47.3, 11.29999999999972, 44.10000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 24.099999999999902, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 2.299999999999592, 45.9, 11.29999999999972, -50.00000000000044, 0.6999999999995694, 47.7, 30.699999999999996, 38.50000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [56, 500, 46, 336, 396, 78, 48, 30, 72, 66, 342, 50, 60, 46, 160, 500, 500, 44, 50, 500, 500, 500, 50, 500, 92, 110, 500, 52, 264, 44, 70, 500, 136, 500, 274, 102, 64, 500, 40, 50, 500, 140, 94, 500, 500, 500, 42, 500, 130, 500, 500, 26, 500, 166, 38, 72, 52, 500, 78, 500, 156, 136, 500, 500, 26, 54, 500, 56, 60, 380, 36, 500, 500, 446, 500, 86, 50, 28, 388, 60, 58, 500, 500, 52, 500, 260, 500, 138, 500, 500, 478, 42, 388, 500, 494, 24, 194, 116, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37405924104483057, "mean_inference_ms": 1.1979129530386736, "mean_action_processing_ms": 0.13970630990015023, "mean_env_wait_ms": 0.08147971173809625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028992414474487305, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.10000920295715332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5576.466552710896, "num_env_steps_trained_throughput_per_sec": 5576.466552710896, "timesteps_total": 1020000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 2257.318, "sample_time_ms": 1907.887, "load_time_ms": 11.1, "load_throughput": 1081047.979, "learn_time_ms": 328.403, "learn_throughput": 36540.524, "synch_weights_time_ms": 8.827}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 3818, "training_iteration": 85, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-37", "timestamp": 1698247177, "time_this_iter_s": 2.1558988094329834, "time_total_s": 192.54635763168335, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 192.54635763168335, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 56.36666666666667, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.169878828456425e-27, "cur_lr": 0.0003, "total_loss": 6.921463966369629, "policy_loss": -0.0012529837588469187, "vf_loss": 6.922768783569336, "vf_explained_var": -1.1165936787923178e-06, "kl": 0.0014739973957299906, "entropy": 0.5178498844305675, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2565.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.877999999999831, "episode_len_mean": 251.88, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, -50.00000000000044, 34.50000000000004, 36.50000000000003, -50.00000000000044, -50.00000000000044, 47.5, 44.7, -50.00000000000044, 44.5, 44.10000000000001, 12.099999999999731, 46.5, -50.00000000000044, -50.00000000000044, 5.499999999999638, -50.00000000000044, 41.500000000000014, 45.1, 47.3, 11.29999999999972, 44.10000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 24.099999999999902, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 2.299999999999592, 45.9, 11.29999999999972, -50.00000000000044, 0.6999999999995694, 47.7, 30.699999999999996, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 46.5, 29.49999999999998, 40.10000000000002, 44.10000000000001, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 38.300000000000026, 30.099999999999987, -50.00000000000044, 47.1, 45.3, 43.50000000000001, 39.90000000000002, 44.7, -50.00000000000044, 41.70000000000002, 43.10000000000001, 26.499999999999936, -50.00000000000044, 32.50000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.9, 38.300000000000026, 45.1, 35.900000000000034, 46.699999999999996, 44.5, -50.00000000000044, 46.3, 42.30000000000001, 44.7, 40.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, 4.699999999999626, 40.70000000000002, 40.500000000000014, 44.7, 39.50000000000002, -50.00000000000044, 40.90000000000002, 44.7, 43.50000000000001, -50.00000000000044], "episode_lengths": [500, 78, 500, 156, 136, 500, 500, 26, 54, 500, 56, 60, 380, 36, 500, 500, 446, 500, 86, 50, 28, 388, 60, 58, 500, 500, 52, 500, 260, 500, 138, 500, 500, 478, 42, 388, 500, 494, 24, 194, 116, 500, 500, 500, 500, 146, 36, 206, 100, 60, 24, 500, 500, 500, 170, 500, 500, 52, 118, 200, 500, 30, 48, 66, 102, 54, 500, 84, 70, 236, 500, 176, 120, 500, 500, 40, 42, 118, 50, 142, 34, 56, 500, 38, 78, 54, 92, 46, 500, 500, 454, 94, 96, 54, 106, 500, 92, 54, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3741263725637281, "mean_inference_ms": 1.1971571201893634, "mean_action_processing_ms": 0.13968173999659558, "mean_env_wait_ms": 0.08152209928752395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699541091918945, "StateBufferConnector_ms": 0.006002664566040039, "ViewRequirementAgentConnector_ms": 0.11780381202697754}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.877999999999831, "episode_len_mean": 251.88, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, -50.00000000000044, 34.50000000000004, 36.50000000000003, -50.00000000000044, -50.00000000000044, 47.5, 44.7, -50.00000000000044, 44.5, 44.10000000000001, 12.099999999999731, 46.5, -50.00000000000044, -50.00000000000044, 5.499999999999638, -50.00000000000044, 41.500000000000014, 45.1, 47.3, 11.29999999999972, 44.10000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 24.099999999999902, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 2.299999999999592, 45.9, 11.29999999999972, -50.00000000000044, 0.6999999999995694, 47.7, 30.699999999999996, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 46.5, 29.49999999999998, 40.10000000000002, 44.10000000000001, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 38.300000000000026, 30.099999999999987, -50.00000000000044, 47.1, 45.3, 43.50000000000001, 39.90000000000002, 44.7, -50.00000000000044, 41.70000000000002, 43.10000000000001, 26.499999999999936, -50.00000000000044, 32.50000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.9, 38.300000000000026, 45.1, 35.900000000000034, 46.699999999999996, 44.5, -50.00000000000044, 46.3, 42.30000000000001, 44.7, 40.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, 4.699999999999626, 40.70000000000002, 40.500000000000014, 44.7, 39.50000000000002, -50.00000000000044, 40.90000000000002, 44.7, 43.50000000000001, -50.00000000000044], "episode_lengths": [500, 78, 500, 156, 136, 500, 500, 26, 54, 500, 56, 60, 380, 36, 500, 500, 446, 500, 86, 50, 28, 388, 60, 58, 500, 500, 52, 500, 260, 500, 138, 500, 500, 478, 42, 388, 500, 494, 24, 194, 116, 500, 500, 500, 500, 146, 36, 206, 100, 60, 24, 500, 500, 500, 170, 500, 500, 52, 118, 200, 500, 30, 48, 66, 102, 54, 500, 84, 70, 236, 500, 176, 120, 500, 500, 40, 42, 118, 50, 142, 34, 56, 500, 38, 78, 54, 92, 46, 500, 500, 454, 94, 96, 54, 106, 500, 92, 54, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3741263725637281, "mean_inference_ms": 1.1971571201893634, "mean_action_processing_ms": 0.13968173999659558, "mean_env_wait_ms": 0.08152209928752395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699541091918945, "StateBufferConnector_ms": 0.006002664566040039, "ViewRequirementAgentConnector_ms": 0.11780381202697754}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4786.290792687647, "num_env_steps_trained_throughput_per_sec": 4786.290792687647, "timesteps_total": 1032000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 2292.038, "sample_time_ms": 1915.748, "load_time_ms": 12.2, "load_throughput": 983575.972, "learn_time_ms": 354.293, "learn_throughput": 33870.302, "synch_weights_time_ms": 8.696}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 3875, "training_iteration": 86, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-39", "timestamp": 1698247179, "time_this_iter_s": 2.5121591091156006, "time_total_s": 195.05851674079895, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 195.05851674079895, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 63.166666666666664, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5849394142282123e-27, "cur_lr": 0.0003, "total_loss": 6.4306891123453775, "policy_loss": -0.0001510226322958867, "vf_loss": 6.430888096491496, "vf_explained_var": -1.1841456095377604e-06, "kl": 0.0002894655517385066, "entropy": 0.47923279205958047, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2595.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.300999999999865, "episode_len_mean": 222.68, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 38.300000000000026, 30.099999999999987, -50.00000000000044, 47.1, 45.3, 43.50000000000001, 39.90000000000002, 44.7, -50.00000000000044, 41.70000000000002, 43.10000000000001, 26.499999999999936, -50.00000000000044, 32.50000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.9, 38.300000000000026, 45.1, 35.900000000000034, 46.699999999999996, 44.5, -50.00000000000044, 46.3, 42.30000000000001, 44.7, 40.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, 4.699999999999626, 40.70000000000002, 40.500000000000014, 44.7, 39.50000000000002, -50.00000000000044, 40.90000000000002, 44.7, 43.50000000000001, -50.00000000000044, 29.899999999999984, -50.00000000000044, 38.90000000000002, 45.9, 37.70000000000003, 37.90000000000003, -50.00000000000044, 43.50000000000001, 44.10000000000001, 36.900000000000034, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, 39.90000000000002, 46.3, 44.900000000000006, -50.00000000000044, 35.500000000000036, 45.9, 40.10000000000002, 47.5, 36.30000000000003, 40.70000000000002, -50.00000000000044, 29.099999999999973, 43.50000000000001, 36.30000000000003, 38.10000000000002, 47.1, 38.300000000000026, 41.70000000000002, 46.699999999999996, 46.3, -50.00000000000044, 46.3, -50.00000000000044, 46.099999999999994, 45.5, 43.50000000000001, 43.30000000000001, 40.500000000000014], "episode_lengths": [500, 500, 500, 170, 500, 500, 52, 118, 200, 500, 30, 48, 66, 102, 54, 500, 84, 70, 236, 500, 176, 120, 500, 500, 40, 42, 118, 50, 142, 34, 56, 500, 38, 78, 54, 92, 46, 500, 500, 454, 94, 96, 54, 106, 500, 92, 54, 66, 500, 202, 500, 112, 42, 124, 122, 500, 66, 60, 132, 500, 212, 500, 500, 74, 500, 500, 500, 500, 500, 500, 360, 500, 102, 38, 52, 500, 146, 42, 100, 26, 138, 94, 500, 210, 66, 138, 120, 30, 118, 84, 34, 38, 500, 38, 500, 40, 46, 66, 68, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37417845504899844, "mean_inference_ms": 1.1973952634493683, "mean_action_processing_ms": 0.1400496548441912, "mean_env_wait_ms": 0.08147289324727697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400111198425293, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.12880754470825195}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.300999999999865, "episode_len_mean": 222.68, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 38.300000000000026, 30.099999999999987, -50.00000000000044, 47.1, 45.3, 43.50000000000001, 39.90000000000002, 44.7, -50.00000000000044, 41.70000000000002, 43.10000000000001, 26.499999999999936, -50.00000000000044, 32.50000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.9, 38.300000000000026, 45.1, 35.900000000000034, 46.699999999999996, 44.5, -50.00000000000044, 46.3, 42.30000000000001, 44.7, 40.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, 4.699999999999626, 40.70000000000002, 40.500000000000014, 44.7, 39.50000000000002, -50.00000000000044, 40.90000000000002, 44.7, 43.50000000000001, -50.00000000000044, 29.899999999999984, -50.00000000000044, 38.90000000000002, 45.9, 37.70000000000003, 37.90000000000003, -50.00000000000044, 43.50000000000001, 44.10000000000001, 36.900000000000034, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, 39.90000000000002, 46.3, 44.900000000000006, -50.00000000000044, 35.500000000000036, 45.9, 40.10000000000002, 47.5, 36.30000000000003, 40.70000000000002, -50.00000000000044, 29.099999999999973, 43.50000000000001, 36.30000000000003, 38.10000000000002, 47.1, 38.300000000000026, 41.70000000000002, 46.699999999999996, 46.3, -50.00000000000044, 46.3, -50.00000000000044, 46.099999999999994, 45.5, 43.50000000000001, 43.30000000000001, 40.500000000000014], "episode_lengths": [500, 500, 500, 170, 500, 500, 52, 118, 200, 500, 30, 48, 66, 102, 54, 500, 84, 70, 236, 500, 176, 120, 500, 500, 40, 42, 118, 50, 142, 34, 56, 500, 38, 78, 54, 92, 46, 500, 500, 454, 94, 96, 54, 106, 500, 92, 54, 66, 500, 202, 500, 112, 42, 124, 122, 500, 66, 60, 132, 500, 212, 500, 500, 74, 500, 500, 500, 500, 500, 500, 360, 500, 102, 38, 52, 500, 146, 42, 100, 26, 138, 94, 500, 210, 66, 138, 120, 30, 118, 84, 34, 38, 500, 38, 500, 40, 46, 66, 68, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37417845504899844, "mean_inference_ms": 1.1973952634493683, "mean_action_processing_ms": 0.1400496548441912, "mean_env_wait_ms": 0.08147289324727697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400111198425293, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.12880754470825195}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5655.360809868793, "num_env_steps_trained_throughput_per_sec": 5655.360809868793, "timesteps_total": 1044000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 2276.036, "sample_time_ms": 1917.135, "load_time_ms": 12.1, "load_throughput": 991703.85, "learn_time_ms": 337.063, "learn_throughput": 35601.633, "synch_weights_time_ms": 8.836}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 3926, "training_iteration": 87, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-41", "timestamp": 1698247181, "time_this_iter_s": 2.127685546875, "time_total_s": 197.18620228767395, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 197.18620228767395, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 52.36666666666667, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2924697071141062e-27, "cur_lr": 0.0003, "total_loss": 6.080945078531901, "policy_loss": -0.00026302635669708254, "vf_loss": 6.08125262260437, "vf_explained_var": -1.1682510375976563e-06, "kl": 0.0006669394276438349, "entropy": 0.44583805203437804, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2625.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.708999999999829, "episode_len_mean": 248.52, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, 44.7, 39.50000000000002, -50.00000000000044, 40.90000000000002, 44.7, 43.50000000000001, -50.00000000000044, 29.899999999999984, -50.00000000000044, 38.90000000000002, 45.9, 37.70000000000003, 37.90000000000003, -50.00000000000044, 43.50000000000001, 44.10000000000001, 36.900000000000034, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, 39.90000000000002, 46.3, 44.900000000000006, -50.00000000000044, 35.500000000000036, 45.9, 40.10000000000002, 47.5, 36.30000000000003, 40.70000000000002, -50.00000000000044, 29.099999999999973, 43.50000000000001, 36.30000000000003, 38.10000000000002, 47.1, 38.300000000000026, 41.70000000000002, 46.699999999999996, 46.3, -50.00000000000044, 46.3, -50.00000000000044, 46.099999999999994, 45.5, 43.50000000000001, 43.30000000000001, 40.500000000000014, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.9, 39.50000000000002, 43.900000000000006, 38.90000000000002, 42.900000000000006, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.099999999999994, 43.900000000000006, 44.7, 46.699999999999996, -50.00000000000044, 45.1, -50.00000000000044, 41.500000000000014], "episode_lengths": [96, 54, 106, 500, 92, 54, 66, 500, 202, 500, 112, 42, 124, 122, 500, 66, 60, 132, 500, 212, 500, 500, 74, 500, 500, 500, 500, 500, 500, 360, 500, 102, 38, 52, 500, 146, 42, 100, 26, 138, 94, 500, 210, 66, 138, 120, 30, 118, 84, 34, 38, 500, 38, 500, 40, 46, 66, 68, 96, 500, 40, 500, 50, 500, 500, 500, 500, 52, 38, 500, 500, 500, 500, 500, 258, 500, 500, 500, 38, 500, 32, 106, 62, 112, 72, 500, 100, 500, 42, 500, 500, 120, 40, 62, 54, 34, 500, 50, 500, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3738478130517724, "mean_inference_ms": 1.1971302823204792, "mean_action_processing_ms": 0.1400653597504676, "mean_env_wait_ms": 0.08157758553237975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025005102157592773, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.12400507926940918}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.708999999999829, "episode_len_mean": 248.52, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, 44.7, 39.50000000000002, -50.00000000000044, 40.90000000000002, 44.7, 43.50000000000001, -50.00000000000044, 29.899999999999984, -50.00000000000044, 38.90000000000002, 45.9, 37.70000000000003, 37.90000000000003, -50.00000000000044, 43.50000000000001, 44.10000000000001, 36.900000000000034, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, 39.90000000000002, 46.3, 44.900000000000006, -50.00000000000044, 35.500000000000036, 45.9, 40.10000000000002, 47.5, 36.30000000000003, 40.70000000000002, -50.00000000000044, 29.099999999999973, 43.50000000000001, 36.30000000000003, 38.10000000000002, 47.1, 38.300000000000026, 41.70000000000002, 46.699999999999996, 46.3, -50.00000000000044, 46.3, -50.00000000000044, 46.099999999999994, 45.5, 43.50000000000001, 43.30000000000001, 40.500000000000014, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.9, 39.50000000000002, 43.900000000000006, 38.90000000000002, 42.900000000000006, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.099999999999994, 43.900000000000006, 44.7, 46.699999999999996, -50.00000000000044, 45.1, -50.00000000000044, 41.500000000000014], "episode_lengths": [96, 54, 106, 500, 92, 54, 66, 500, 202, 500, 112, 42, 124, 122, 500, 66, 60, 132, 500, 212, 500, 500, 74, 500, 500, 500, 500, 500, 500, 360, 500, 102, 38, 52, 500, 146, 42, 100, 26, 138, 94, 500, 210, 66, 138, 120, 30, 118, 84, 34, 38, 500, 38, 500, 40, 46, 66, 68, 96, 500, 40, 500, 50, 500, 500, 500, 500, 52, 38, 500, 500, 500, 500, 500, 258, 500, 500, 500, 38, 500, 32, 106, 62, 112, 72, 500, 100, 500, 42, 500, 500, 120, 40, 62, 54, 34, 500, 50, 500, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3738478130517724, "mean_inference_ms": 1.1971302823204792, "mean_action_processing_ms": 0.1400653597504676, "mean_env_wait_ms": 0.08157758553237975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025005102157592773, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.12400507926940918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5879.758266087674, "num_env_steps_trained_throughput_per_sec": 5879.758266087674, "timesteps_total": 1056000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 2254.104, "sample_time_ms": 1909.038, "load_time_ms": 11.731, "load_throughput": 1022911.575, "learn_time_ms": 323.618, "learn_throughput": 37080.717, "synch_weights_time_ms": 8.815}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 3967, "training_iteration": 88, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-43", "timestamp": 1698247183, "time_this_iter_s": 2.0457351207733154, "time_total_s": 199.23193740844727, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 199.23193740844727, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 59.96666666666666, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.462348535570531e-28, "cur_lr": 0.0003, "total_loss": 6.263616561889648, "policy_loss": -0.0008521866053342819, "vf_loss": 6.264514923095703, "vf_explained_var": -1.148382822672526e-06, "kl": 0.001129161059654867, "entropy": 0.4615723540385564, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2655.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9399999999998057, "episode_len_mean": 261.16, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, 38.300000000000026, 41.70000000000002, 46.699999999999996, 46.3, -50.00000000000044, 46.3, -50.00000000000044, 46.099999999999994, 45.5, 43.50000000000001, 43.30000000000001, 40.500000000000014, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.9, 39.50000000000002, 43.900000000000006, 38.90000000000002, 42.900000000000006, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.099999999999994, 43.900000000000006, 44.7, 46.699999999999996, -50.00000000000044, 45.1, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 21.499999999999865, -50.00000000000044, 44.5, -50.00000000000044, 41.90000000000001, -50.00000000000044, 44.900000000000006, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.30000000000002, 45.3, 33.10000000000003, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, -50.00000000000044, 36.10000000000004, 46.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.300000000000004, 45.1, 47.5, 37.50000000000003, 42.900000000000006, 24.69999999999991, -50.00000000000044, 43.10000000000001], "episode_lengths": [30, 118, 84, 34, 38, 500, 38, 500, 40, 46, 66, 68, 96, 500, 40, 500, 50, 500, 500, 500, 500, 52, 38, 500, 500, 500, 500, 500, 258, 500, 500, 500, 38, 500, 32, 106, 62, 112, 72, 500, 100, 500, 42, 500, 500, 120, 40, 62, 54, 34, 500, 50, 500, 86, 500, 54, 32, 500, 286, 500, 56, 500, 82, 500, 52, 26, 500, 500, 500, 500, 68, 98, 48, 170, 500, 28, 500, 500, 500, 500, 500, 34, 500, 34, 42, 500, 500, 140, 36, 500, 500, 68, 58, 50, 26, 126, 72, 254, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37391002381800376, "mean_inference_ms": 1.196971379550061, "mean_action_processing_ms": 0.14010797798636326, "mean_env_wait_ms": 0.0815158386782952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500629425048828, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.1279904842376709}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9399999999998057, "episode_len_mean": 261.16, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, 38.300000000000026, 41.70000000000002, 46.699999999999996, 46.3, -50.00000000000044, 46.3, -50.00000000000044, 46.099999999999994, 45.5, 43.50000000000001, 43.30000000000001, 40.500000000000014, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.9, 39.50000000000002, 43.900000000000006, 38.90000000000002, 42.900000000000006, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.099999999999994, 43.900000000000006, 44.7, 46.699999999999996, -50.00000000000044, 45.1, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 21.499999999999865, -50.00000000000044, 44.5, -50.00000000000044, 41.90000000000001, -50.00000000000044, 44.900000000000006, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.30000000000002, 45.3, 33.10000000000003, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, -50.00000000000044, 36.10000000000004, 46.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.300000000000004, 45.1, 47.5, 37.50000000000003, 42.900000000000006, 24.69999999999991, -50.00000000000044, 43.10000000000001], "episode_lengths": [30, 118, 84, 34, 38, 500, 38, 500, 40, 46, 66, 68, 96, 500, 40, 500, 50, 500, 500, 500, 500, 52, 38, 500, 500, 500, 500, 500, 258, 500, 500, 500, 38, 500, 32, 106, 62, 112, 72, 500, 100, 500, 42, 500, 500, 120, 40, 62, 54, 34, 500, 50, 500, 86, 500, 54, 32, 500, 286, 500, 56, 500, 82, 500, 52, 26, 500, 500, 500, 500, 68, 98, 48, 170, 500, 28, 500, 500, 500, 500, 500, 34, 500, 34, 42, 500, 500, 140, 36, 500, 500, 68, 58, 50, 26, 126, 72, 254, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37391002381800376, "mean_inference_ms": 1.196971379550061, "mean_action_processing_ms": 0.14010797798636326, "mean_env_wait_ms": 0.0815158386782952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500629425048828, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.1279904842376709}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5512.872349036527, "num_env_steps_trained_throughput_per_sec": 5512.872349036527, "timesteps_total": 1068000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 2225.122, "sample_time_ms": 1891.026, "load_time_ms": 10.794, "load_throughput": 1111689.877, "learn_time_ms": 313.564, "learn_throughput": 38269.75, "synch_weights_time_ms": 8.838}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 4013, "training_iteration": 89, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-46", "timestamp": 1698247186, "time_this_iter_s": 2.182722806930542, "time_total_s": 201.4146602153778, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 201.4146602153778, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 60.199999999999996, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.2311742677852654e-28, "cur_lr": 0.0003, "total_loss": 6.011464325586955, "policy_loss": -0.0004913764695326487, "vf_loss": 6.011999702453613, "vf_explained_var": -1.0689099629720052e-06, "kl": 0.0007406141362253038, "entropy": 0.44106481075286863, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2685.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.7069999999998275, "episode_len_mean": 238.56, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 21.499999999999865, -50.00000000000044, 44.5, -50.00000000000044, 41.90000000000001, -50.00000000000044, 44.900000000000006, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.30000000000002, 45.3, 33.10000000000003, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, -50.00000000000044, 36.10000000000004, 46.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.300000000000004, 45.1, 47.5, 37.50000000000003, 42.900000000000006, 24.69999999999991, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 39.10000000000002, -50.00000000000044, 47.3, 45.3, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.1, 43.7, 45.7, 47.7, 42.10000000000001, -50.00000000000044, 46.3, 15.099999999999774, 45.9, 44.300000000000004, 47.3, -50.00000000000044, 42.70000000000001, 44.10000000000001, 43.10000000000001, -50.00000000000044, 40.70000000000002, 35.30000000000004, -50.00000000000044, -50.00000000000044, 47.5, 47.7, 44.900000000000006, 47.7, 45.9, -50.00000000000044, -50.00000000000044, 12.299999999999734, 8.099999999999675, 47.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 22.899999999999885, 40.10000000000002, 39.90000000000002, 40.90000000000002, -50.00000000000044, 47.1], "episode_lengths": [50, 500, 86, 500, 54, 32, 500, 286, 500, 56, 500, 82, 500, 52, 26, 500, 500, 500, 500, 68, 98, 48, 170, 500, 28, 500, 500, 500, 500, 500, 34, 500, 34, 42, 500, 500, 140, 36, 500, 500, 68, 58, 50, 26, 126, 72, 254, 500, 70, 500, 500, 50, 44, 110, 500, 28, 48, 42, 500, 66, 500, 30, 64, 44, 24, 80, 500, 38, 350, 42, 58, 28, 500, 74, 60, 70, 500, 94, 148, 500, 500, 26, 24, 52, 24, 42, 500, 500, 378, 420, 22, 34, 500, 500, 272, 100, 102, 92, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37401828728916103, "mean_inference_ms": 1.1967939082350747, "mean_action_processing_ms": 0.13990253260590424, "mean_env_wait_ms": 0.0815321144679786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025989532470703125, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.11273431777954102}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.7069999999998275, "episode_len_mean": 238.56, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 21.499999999999865, -50.00000000000044, 44.5, -50.00000000000044, 41.90000000000001, -50.00000000000044, 44.900000000000006, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.30000000000002, 45.3, 33.10000000000003, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, -50.00000000000044, 36.10000000000004, 46.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.300000000000004, 45.1, 47.5, 37.50000000000003, 42.900000000000006, 24.69999999999991, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 39.10000000000002, -50.00000000000044, 47.3, 45.3, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.1, 43.7, 45.7, 47.7, 42.10000000000001, -50.00000000000044, 46.3, 15.099999999999774, 45.9, 44.300000000000004, 47.3, -50.00000000000044, 42.70000000000001, 44.10000000000001, 43.10000000000001, -50.00000000000044, 40.70000000000002, 35.30000000000004, -50.00000000000044, -50.00000000000044, 47.5, 47.7, 44.900000000000006, 47.7, 45.9, -50.00000000000044, -50.00000000000044, 12.299999999999734, 8.099999999999675, 47.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 22.899999999999885, 40.10000000000002, 39.90000000000002, 40.90000000000002, -50.00000000000044, 47.1], "episode_lengths": [50, 500, 86, 500, 54, 32, 500, 286, 500, 56, 500, 82, 500, 52, 26, 500, 500, 500, 500, 68, 98, 48, 170, 500, 28, 500, 500, 500, 500, 500, 34, 500, 34, 42, 500, 500, 140, 36, 500, 500, 68, 58, 50, 26, 126, 72, 254, 500, 70, 500, 500, 50, 44, 110, 500, 28, 48, 42, 500, 66, 500, 30, 64, 44, 24, 80, 500, 38, 350, 42, 58, 28, 500, 74, 60, 70, 500, 94, 148, 500, 500, 26, 24, 52, 24, 42, 500, 500, 378, 420, 22, 34, 500, 500, 272, 100, 102, 92, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37401828728916103, "mean_inference_ms": 1.1967939082350747, "mean_action_processing_ms": 0.13990253260590424, "mean_env_wait_ms": 0.0815321144679786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025989532470703125, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.11273431777954102}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5566.636753287172, "num_env_steps_trained_throughput_per_sec": 5566.636753287172, "timesteps_total": 1080000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 2214.734, "sample_time_ms": 1895.299, "load_time_ms": 9.604, "load_throughput": 1249448.23, "learn_time_ms": 300.27, "learn_throughput": 39963.99, "synch_weights_time_ms": 8.859}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4064, "training_iteration": 90, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-48", "timestamp": 1698247188, "time_this_iter_s": 2.1617119312286377, "time_total_s": 203.57637214660645, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 203.57637214660645, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 56.46666666666667, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6155871338926327e-28, "cur_lr": 0.0003, "total_loss": 6.126093260447184, "policy_loss": -0.00041369829947749775, "vf_loss": 6.12654480934143, "vf_explained_var": -8.662541707356771e-07, "kl": 0.0008974558521998687, "entropy": 0.3786423762639364, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2715.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.27299999999982, "episode_len_mean": 242.88, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.50000000000003, 42.900000000000006, 24.69999999999991, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 39.10000000000002, -50.00000000000044, 47.3, 45.3, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.1, 43.7, 45.7, 47.7, 42.10000000000001, -50.00000000000044, 46.3, 15.099999999999774, 45.9, 44.300000000000004, 47.3, -50.00000000000044, 42.70000000000001, 44.10000000000001, 43.10000000000001, -50.00000000000044, 40.70000000000002, 35.30000000000004, -50.00000000000044, -50.00000000000044, 47.5, 47.7, 44.900000000000006, 47.7, 45.9, -50.00000000000044, -50.00000000000044, 12.299999999999734, 8.099999999999675, 47.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 22.899999999999885, 40.10000000000002, 39.90000000000002, 40.90000000000002, -50.00000000000044, 47.1, -50.00000000000044, 46.9, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 47.7, 47.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.3, 47.9, 47.1, 45.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 47.3, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 45.7], "episode_lengths": [126, 72, 254, 500, 70, 500, 500, 50, 44, 110, 500, 28, 48, 42, 500, 66, 500, 30, 64, 44, 24, 80, 500, 38, 350, 42, 58, 28, 500, 74, 60, 70, 500, 94, 148, 500, 500, 26, 24, 52, 24, 42, 500, 500, 378, 420, 22, 34, 500, 500, 272, 100, 102, 92, 500, 30, 500, 32, 188, 500, 500, 38, 500, 24, 28, 28, 500, 500, 500, 500, 36, 500, 500, 500, 66, 500, 46, 70, 500, 500, 500, 40, 48, 22, 30, 44, 42, 500, 500, 500, 500, 38, 28, 64, 500, 500, 500, 500, 100, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3743240226965774, "mean_inference_ms": 1.1967407107092187, "mean_action_processing_ms": 0.13988153425739963, "mean_env_wait_ms": 0.08188705013756857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023974895477294922, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.1207423210144043}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.27299999999982, "episode_len_mean": 242.88, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.50000000000003, 42.900000000000006, 24.69999999999991, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 39.10000000000002, -50.00000000000044, 47.3, 45.3, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.1, 43.7, 45.7, 47.7, 42.10000000000001, -50.00000000000044, 46.3, 15.099999999999774, 45.9, 44.300000000000004, 47.3, -50.00000000000044, 42.70000000000001, 44.10000000000001, 43.10000000000001, -50.00000000000044, 40.70000000000002, 35.30000000000004, -50.00000000000044, -50.00000000000044, 47.5, 47.7, 44.900000000000006, 47.7, 45.9, -50.00000000000044, -50.00000000000044, 12.299999999999734, 8.099999999999675, 47.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 22.899999999999885, 40.10000000000002, 39.90000000000002, 40.90000000000002, -50.00000000000044, 47.1, -50.00000000000044, 46.9, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 47.7, 47.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.3, 47.9, 47.1, 45.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 47.3, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 45.7], "episode_lengths": [126, 72, 254, 500, 70, 500, 500, 50, 44, 110, 500, 28, 48, 42, 500, 66, 500, 30, 64, 44, 24, 80, 500, 38, 350, 42, 58, 28, 500, 74, 60, 70, 500, 94, 148, 500, 500, 26, 24, 52, 24, 42, 500, 500, 378, 420, 22, 34, 500, 500, 272, 100, 102, 92, 500, 30, 500, 32, 188, 500, 500, 38, 500, 24, 28, 28, 500, 500, 500, 500, 36, 500, 500, 500, 66, 500, 46, 70, 500, 500, 500, 40, 48, 22, 30, 44, 42, 500, 500, 500, 500, 38, 28, 64, 500, 500, 500, 500, 100, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3743240226965774, "mean_inference_ms": 1.1967407107092187, "mean_action_processing_ms": 0.13988153425739963, "mean_env_wait_ms": 0.08188705013756857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023974895477294922, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.1207423210144043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5304.273652354977, "num_env_steps_trained_throughput_per_sec": 5304.273652354977, "timesteps_total": 1092000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 2217.602, "sample_time_ms": 1898.425, "load_time_ms": 9.901, "load_throughput": 1211960.962, "learn_time_ms": 299.67, "learn_throughput": 40044.089, "synch_weights_time_ms": 8.905}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 4108, "training_iteration": 91, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-50", "timestamp": 1698247190, "time_this_iter_s": 2.267326593399048, "time_total_s": 205.8436987400055, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 205.8436987400055, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.077935669463164e-29, "cur_lr": 0.0003, "total_loss": 6.3757505734761555, "policy_loss": -0.0007828809320926666, "vf_loss": 6.376571051279703, "vf_explained_var": -8.980433146158854e-07, "kl": 0.0006961545805173349, "entropy": 0.37609054446220397, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2745.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7789999999998014, "episode_len_mean": 257.76, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, 39.90000000000002, 40.90000000000002, -50.00000000000044, 47.1, -50.00000000000044, 46.9, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 47.7, 47.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.3, 47.9, 47.1, 45.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 47.3, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 45.7, -50.00000000000044, 44.300000000000004, 44.7, 30.29999999999999, -50.00000000000044, 46.699999999999996, 33.30000000000003, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 45.7, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 45.9, 38.10000000000002, -50.00000000000044, 39.300000000000026, 47.9, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, 47.1, 46.099999999999994, 46.3, 47.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 46.3, -50.00000000000044, 47.3, 46.699999999999996], "episode_lengths": [100, 102, 92, 500, 30, 500, 32, 188, 500, 500, 38, 500, 24, 28, 28, 500, 500, 500, 500, 36, 500, 500, 500, 66, 500, 46, 70, 500, 500, 500, 40, 48, 22, 30, 44, 42, 500, 500, 500, 500, 38, 28, 64, 500, 500, 500, 500, 100, 44, 500, 58, 54, 198, 500, 34, 168, 500, 500, 308, 500, 40, 500, 500, 36, 46, 44, 500, 50, 34, 500, 42, 120, 500, 108, 22, 52, 500, 38, 500, 500, 500, 44, 500, 38, 30, 40, 38, 26, 500, 500, 52, 500, 500, 40, 36, 500, 38, 500, 28, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.374158299000818, "mean_inference_ms": 1.1969091785109212, "mean_action_processing_ms": 0.13984003570927417, "mean_env_wait_ms": 0.08164014152638868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030981063842773438, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.12672710418701172}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7789999999998014, "episode_len_mean": 257.76, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, 39.90000000000002, 40.90000000000002, -50.00000000000044, 47.1, -50.00000000000044, 46.9, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 47.7, 47.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.3, 47.9, 47.1, 45.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 47.3, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 45.7, -50.00000000000044, 44.300000000000004, 44.7, 30.29999999999999, -50.00000000000044, 46.699999999999996, 33.30000000000003, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 45.7, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 45.9, 38.10000000000002, -50.00000000000044, 39.300000000000026, 47.9, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, 47.1, 46.099999999999994, 46.3, 47.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 46.3, -50.00000000000044, 47.3, 46.699999999999996], "episode_lengths": [100, 102, 92, 500, 30, 500, 32, 188, 500, 500, 38, 500, 24, 28, 28, 500, 500, 500, 500, 36, 500, 500, 500, 66, 500, 46, 70, 500, 500, 500, 40, 48, 22, 30, 44, 42, 500, 500, 500, 500, 38, 28, 64, 500, 500, 500, 500, 100, 44, 500, 58, 54, 198, 500, 34, 168, 500, 500, 308, 500, 40, 500, 500, 36, 46, 44, 500, 50, 34, 500, 42, 120, 500, 108, 22, 52, 500, 38, 500, 500, 500, 44, 500, 38, 30, 40, 38, 26, 500, 500, 52, 500, 500, 40, 36, 500, 38, 500, 28, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.374158299000818, "mean_inference_ms": 1.1969091785109212, "mean_action_processing_ms": 0.13984003570927417, "mean_env_wait_ms": 0.08164014152638868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030981063842773438, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.12672710418701172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5184.2985069338365, "num_env_steps_trained_throughput_per_sec": 5184.2985069338365, "timesteps_total": 1104000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 2219.066, "sample_time_ms": 1895.043, "load_time_ms": 10.005, "load_throughput": 1199443.503, "learn_time_ms": 304.375, "learn_throughput": 39425.116, "synch_weights_time_ms": 8.943}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 4159, "training_iteration": 92, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-52", "timestamp": 1698247192, "time_this_iter_s": 2.319681406021118, "time_total_s": 208.1633801460266, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 208.1633801460266, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 59.79999999999999, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.038967834731582e-29, "cur_lr": 0.0003, "total_loss": 6.41777499516805, "policy_loss": -0.00033852458000183105, "vf_loss": 6.41815512975057, "vf_explained_var": -6.953875223795573e-07, "kl": 0.0006168420049296704, "entropy": 0.41517012466986974, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2775.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.7109999999998164, "episode_len_mean": 248.5, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.10000000000002, 45.7, -50.00000000000044, 44.300000000000004, 44.7, 30.29999999999999, -50.00000000000044, 46.699999999999996, 33.30000000000003, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 45.7, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 45.9, 38.10000000000002, -50.00000000000044, 39.300000000000026, 47.9, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, 47.1, 46.099999999999994, 46.3, 47.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 46.3, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.099999999999994, 42.500000000000014, 39.10000000000002, 38.10000000000002, 46.3, -50.00000000000044, 40.500000000000014, 28.499999999999964, -50.00000000000044, 41.90000000000001, 3.699999999999612, 45.7, -50.00000000000044, 46.5, 46.699999999999996, -50.00000000000044, 31.1, 43.50000000000001, 12.299999999999734, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 14.899999999999771, 45.5, 47.3, -50.00000000000044, 45.3, 43.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 48.1, 46.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 47.7, 6.699999999999655], "episode_lengths": [500, 100, 44, 500, 58, 54, 198, 500, 34, 168, 500, 500, 308, 500, 40, 500, 500, 36, 46, 44, 500, 50, 34, 500, 42, 120, 500, 108, 22, 52, 500, 38, 500, 500, 500, 44, 500, 38, 30, 40, 38, 26, 500, 500, 52, 500, 500, 40, 36, 500, 38, 500, 28, 34, 500, 500, 76, 40, 76, 110, 120, 38, 500, 96, 216, 500, 82, 464, 44, 500, 36, 34, 500, 190, 66, 378, 500, 500, 500, 54, 500, 352, 46, 28, 500, 48, 64, 500, 500, 40, 500, 20, 34, 52, 500, 500, 500, 48, 24, 434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37412343904155854, "mean_inference_ms": 1.1970941217882243, "mean_action_processing_ms": 0.1397588812296552, "mean_env_wait_ms": 0.08139245263106952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02977585792541504, "StateBufferConnector_ms": 0.010005474090576172, "ViewRequirementAgentConnector_ms": 0.11200857162475586}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.7109999999998164, "episode_len_mean": 248.5, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.10000000000002, 45.7, -50.00000000000044, 44.300000000000004, 44.7, 30.29999999999999, -50.00000000000044, 46.699999999999996, 33.30000000000003, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 45.7, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 45.9, 38.10000000000002, -50.00000000000044, 39.300000000000026, 47.9, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, 47.1, 46.099999999999994, 46.3, 47.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 46.3, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.099999999999994, 42.500000000000014, 39.10000000000002, 38.10000000000002, 46.3, -50.00000000000044, 40.500000000000014, 28.499999999999964, -50.00000000000044, 41.90000000000001, 3.699999999999612, 45.7, -50.00000000000044, 46.5, 46.699999999999996, -50.00000000000044, 31.1, 43.50000000000001, 12.299999999999734, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 14.899999999999771, 45.5, 47.3, -50.00000000000044, 45.3, 43.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 48.1, 46.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 47.7, 6.699999999999655], "episode_lengths": [500, 100, 44, 500, 58, 54, 198, 500, 34, 168, 500, 500, 308, 500, 40, 500, 500, 36, 46, 44, 500, 50, 34, 500, 42, 120, 500, 108, 22, 52, 500, 38, 500, 500, 500, 44, 500, 38, 30, 40, 38, 26, 500, 500, 52, 500, 500, 40, 36, 500, 38, 500, 28, 34, 500, 500, 76, 40, 76, 110, 120, 38, 500, 96, 216, 500, 82, 464, 44, 500, 36, 34, 500, 190, 66, 378, 500, 500, 500, 54, 500, 352, 46, 28, 500, 48, 64, 500, 500, 40, 500, 20, 34, 52, 500, 500, 500, 48, 24, 434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37412343904155854, "mean_inference_ms": 1.1970941217882243, "mean_action_processing_ms": 0.1397588812296552, "mean_env_wait_ms": 0.08139245263106952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02977585792541504, "StateBufferConnector_ms": 0.010005474090576172, "ViewRequirementAgentConnector_ms": 0.11200857162475586}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4849.949237639538, "num_env_steps_trained_throughput_per_sec": 4849.949237639538, "timesteps_total": 1116000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 2244.653, "sample_time_ms": 1913.439, "load_time_ms": 11.168, "load_throughput": 1074530.386, "learn_time_ms": 310.353, "learn_throughput": 38665.652, "synch_weights_time_ms": 8.793}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4205, "training_iteration": 93, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-55", "timestamp": 1698247195, "time_this_iter_s": 2.479249954223633, "time_total_s": 210.64263010025024, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 210.64263010025024, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 57.76666666666667, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.019483917365791e-29, "cur_lr": 0.0003, "total_loss": 6.435676908493042, "policy_loss": -0.0006327067812283833, "vf_loss": 6.436354398727417, "vf_explained_var": -1.0053316752115886e-06, "kl": 0.0007758841907313278, "entropy": 0.44730005264282224, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2805.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.373999999999825, "episode_len_mean": 246.9, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 46.5, -50.00000000000044, 46.3, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.099999999999994, 42.500000000000014, 39.10000000000002, 38.10000000000002, 46.3, -50.00000000000044, 40.500000000000014, 28.499999999999964, -50.00000000000044, 41.90000000000001, 3.699999999999612, 45.7, -50.00000000000044, 46.5, 46.699999999999996, -50.00000000000044, 31.1, 43.50000000000001, 12.299999999999734, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 14.899999999999771, 45.5, 47.3, -50.00000000000044, 45.3, 43.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 48.1, 46.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 47.7, 6.699999999999655, 17.099999999999802, 47.1, 43.900000000000006, 39.70000000000002, 45.1, 47.3, 44.7, -50.00000000000044, -50.00000000000044, 47.1, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.30000000000001, 39.90000000000002, -50.00000000000044, 32.90000000000003, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 23.699999999999896, -50.00000000000044, 24.899999999999913, 44.900000000000006, 44.300000000000004, -50.00000000000044, 42.900000000000006, 21.499999999999865, -50.00000000000044, 47.9, 44.900000000000006, 34.900000000000034, 43.30000000000001, 47.3, 29.099999999999973, 31.1, 47.3, 46.3, -50.00000000000044], "episode_lengths": [40, 36, 500, 38, 500, 28, 34, 500, 500, 76, 40, 76, 110, 120, 38, 500, 96, 216, 500, 82, 464, 44, 500, 36, 34, 500, 190, 66, 378, 500, 500, 500, 54, 500, 352, 46, 28, 500, 48, 64, 500, 500, 40, 500, 20, 34, 52, 500, 500, 500, 48, 24, 434, 330, 30, 62, 104, 50, 28, 54, 500, 500, 30, 56, 500, 500, 500, 46, 78, 102, 500, 172, 118, 500, 500, 500, 500, 500, 500, 500, 172, 264, 500, 252, 52, 58, 500, 72, 286, 500, 22, 52, 152, 68, 28, 210, 190, 28, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.374290189581618, "mean_inference_ms": 1.1969154666902988, "mean_action_processing_ms": 0.13977805325006654, "mean_env_wait_ms": 0.08145273419605495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022984743118286133, "StateBufferConnector_ms": 0.008037805557250977, "ViewRequirementAgentConnector_ms": 0.11350154876708984}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.373999999999825, "episode_len_mean": 246.9, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 46.5, -50.00000000000044, 46.3, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.099999999999994, 42.500000000000014, 39.10000000000002, 38.10000000000002, 46.3, -50.00000000000044, 40.500000000000014, 28.499999999999964, -50.00000000000044, 41.90000000000001, 3.699999999999612, 45.7, -50.00000000000044, 46.5, 46.699999999999996, -50.00000000000044, 31.1, 43.50000000000001, 12.299999999999734, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 14.899999999999771, 45.5, 47.3, -50.00000000000044, 45.3, 43.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 48.1, 46.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 47.7, 6.699999999999655, 17.099999999999802, 47.1, 43.900000000000006, 39.70000000000002, 45.1, 47.3, 44.7, -50.00000000000044, -50.00000000000044, 47.1, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.30000000000001, 39.90000000000002, -50.00000000000044, 32.90000000000003, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 23.699999999999896, -50.00000000000044, 24.899999999999913, 44.900000000000006, 44.300000000000004, -50.00000000000044, 42.900000000000006, 21.499999999999865, -50.00000000000044, 47.9, 44.900000000000006, 34.900000000000034, 43.30000000000001, 47.3, 29.099999999999973, 31.1, 47.3, 46.3, -50.00000000000044], "episode_lengths": [40, 36, 500, 38, 500, 28, 34, 500, 500, 76, 40, 76, 110, 120, 38, 500, 96, 216, 500, 82, 464, 44, 500, 36, 34, 500, 190, 66, 378, 500, 500, 500, 54, 500, 352, 46, 28, 500, 48, 64, 500, 500, 40, 500, 20, 34, 52, 500, 500, 500, 48, 24, 434, 330, 30, 62, 104, 50, 28, 54, 500, 500, 30, 56, 500, 500, 500, 46, 78, 102, 500, 172, 118, 500, 500, 500, 500, 500, 500, 500, 172, 264, 500, 252, 52, 58, 500, 72, 286, 500, 22, 52, 152, 68, 28, 210, 190, 28, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.374290189581618, "mean_inference_ms": 1.1969154666902988, "mean_action_processing_ms": 0.13977805325006654, "mean_env_wait_ms": 0.08145273419605495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022984743118286133, "StateBufferConnector_ms": 0.008037805557250977, "ViewRequirementAgentConnector_ms": 0.11350154876708984}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5488.795774954309, "num_env_steps_trained_throughput_per_sec": 5488.795774954309, "timesteps_total": 1128000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 2239.18, "sample_time_ms": 1915.112, "load_time_ms": 11.068, "load_throughput": 1084254.758, "learn_time_ms": 303.311, "learn_throughput": 39563.416, "synch_weights_time_ms": 8.79}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 4252, "training_iteration": 94, "trial_id": "9f288_00009", "date": "2023-10-25_16-19-57", "timestamp": 1698247197, "time_this_iter_s": 2.191269874572754, "time_total_s": 212.833899974823, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 212.833899974823, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 46.9, "ram_util_percent": 26.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0097419586828954e-29, "cur_lr": 0.0003, "total_loss": 6.450451866785685, "policy_loss": -0.00016180189947287242, "vf_loss": 6.450660498936971, "vf_explained_var": -1.0251998901367187e-06, "kl": 0.0004045634490054795, "entropy": 0.4668977697690328, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1689999999998064, "episode_len_mean": 263.9, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 47.7, 6.699999999999655, 17.099999999999802, 47.1, 43.900000000000006, 39.70000000000002, 45.1, 47.3, 44.7, -50.00000000000044, -50.00000000000044, 47.1, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.30000000000001, 39.90000000000002, -50.00000000000044, 32.90000000000003, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 23.699999999999896, -50.00000000000044, 24.899999999999913, 44.900000000000006, 44.300000000000004, -50.00000000000044, 42.900000000000006, 21.499999999999865, -50.00000000000044, 47.9, 44.900000000000006, 34.900000000000034, 43.30000000000001, 47.3, 29.099999999999973, 31.1, 47.3, 46.3, -50.00000000000044, -50.00000000000044, 47.1, 44.5, 45.5, 45.9, 46.5, 45.3, -50.00000000000044, 43.50000000000001, 46.099999999999994, 45.3, -50.00000000000044, 7.699999999999669, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, 43.50000000000001, -50.00000000000044, 45.3, 44.5, 15.299999999999777, 45.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 32.50000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 48, 24, 434, 330, 30, 62, 104, 50, 28, 54, 500, 500, 30, 56, 500, 500, 500, 46, 78, 102, 500, 172, 118, 500, 500, 500, 500, 500, 500, 500, 172, 264, 500, 252, 52, 58, 500, 72, 286, 500, 22, 52, 152, 68, 28, 210, 190, 28, 38, 500, 500, 30, 56, 46, 42, 36, 48, 500, 66, 40, 48, 500, 424, 500, 500, 92, 500, 500, 52, 36, 66, 500, 48, 56, 348, 42, 500, 108, 500, 500, 500, 78, 176, 80, 500, 500, 500, 44, 50, 500, 500, 28, 40, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37412906524868544, "mean_inference_ms": 1.1972525482034349, "mean_action_processing_ms": 0.1395791632239209, "mean_env_wait_ms": 0.08118306606716122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025420188903808594, "StateBufferConnector_ms": 0.005033969879150391, "ViewRequirementAgentConnector_ms": 0.11550593376159668}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1689999999998064, "episode_len_mean": 263.9, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 47.7, 6.699999999999655, 17.099999999999802, 47.1, 43.900000000000006, 39.70000000000002, 45.1, 47.3, 44.7, -50.00000000000044, -50.00000000000044, 47.1, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.30000000000001, 39.90000000000002, -50.00000000000044, 32.90000000000003, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 23.699999999999896, -50.00000000000044, 24.899999999999913, 44.900000000000006, 44.300000000000004, -50.00000000000044, 42.900000000000006, 21.499999999999865, -50.00000000000044, 47.9, 44.900000000000006, 34.900000000000034, 43.30000000000001, 47.3, 29.099999999999973, 31.1, 47.3, 46.3, -50.00000000000044, -50.00000000000044, 47.1, 44.5, 45.5, 45.9, 46.5, 45.3, -50.00000000000044, 43.50000000000001, 46.099999999999994, 45.3, -50.00000000000044, 7.699999999999669, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, 43.50000000000001, -50.00000000000044, 45.3, 44.5, 15.299999999999777, 45.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 32.50000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 48, 24, 434, 330, 30, 62, 104, 50, 28, 54, 500, 500, 30, 56, 500, 500, 500, 46, 78, 102, 500, 172, 118, 500, 500, 500, 500, 500, 500, 500, 172, 264, 500, 252, 52, 58, 500, 72, 286, 500, 22, 52, 152, 68, 28, 210, 190, 28, 38, 500, 500, 30, 56, 46, 42, 36, 48, 500, 66, 40, 48, 500, 424, 500, 500, 92, 500, 500, 52, 36, 66, 500, 48, 56, 348, 42, 500, 108, 500, 500, 500, 78, 176, 80, 500, 500, 500, 44, 50, 500, 500, 28, 40, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37412906524868544, "mean_inference_ms": 1.1972525482034349, "mean_action_processing_ms": 0.1395791632239209, "mean_env_wait_ms": 0.08118306606716122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025420188903808594, "StateBufferConnector_ms": 0.005033969879150391, "ViewRequirementAgentConnector_ms": 0.11550593376159668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5021.423707088086, "num_env_steps_trained_throughput_per_sec": 5021.423707088086, "timesteps_total": 1140000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 2262.966, "sample_time_ms": 1916.956, "load_time_ms": 11.571, "load_throughput": 1037051.762, "learn_time_ms": 324.751, "learn_throughput": 36951.353, "synch_weights_time_ms": 8.787}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 4299, "training_iteration": 95, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-00", "timestamp": 1698247200, "time_this_iter_s": 2.39475679397583, "time_total_s": 215.22865676879883, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 215.22865676879883, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 56.4, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.048709793414477e-30, "cur_lr": 0.0003, "total_loss": 6.389492972691854, "policy_loss": -0.00030099737147490184, "vf_loss": 6.389842144648234, "vf_explained_var": -1.0371208190917968e-06, "kl": 0.0007959973471088233, "entropy": 0.48093775113423665, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2865.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.0289999999998076, "episode_len_mean": 265.3, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.499999999999865, -50.00000000000044, 47.9, 44.900000000000006, 34.900000000000034, 43.30000000000001, 47.3, 29.099999999999973, 31.1, 47.3, 46.3, -50.00000000000044, -50.00000000000044, 47.1, 44.5, 45.5, 45.9, 46.5, 45.3, -50.00000000000044, 43.50000000000001, 46.099999999999994, 45.3, -50.00000000000044, 7.699999999999669, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, 43.50000000000001, -50.00000000000044, 45.3, 44.5, 15.299999999999777, 45.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 32.50000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.9, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.30000000000001, 27.899999999999956, 41.70000000000002, 39.70000000000002, -50.00000000000044, 44.900000000000006, 37.70000000000003, 6.699999999999655, -50.00000000000044, 45.3, 33.500000000000036, -50.00000000000044, 42.900000000000006, 24.299999999999905, 27.299999999999947, 42.500000000000014, 42.900000000000006, -50.00000000000044, 43.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 18.099999999999817, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [286, 500, 22, 52, 152, 68, 28, 210, 190, 28, 38, 500, 500, 30, 56, 46, 42, 36, 48, 500, 66, 40, 48, 500, 424, 500, 500, 92, 500, 500, 52, 36, 66, 500, 48, 56, 348, 42, 500, 108, 500, 500, 500, 78, 176, 80, 500, 500, 500, 44, 50, 500, 500, 28, 40, 500, 500, 500, 500, 500, 500, 32, 42, 32, 500, 500, 500, 500, 500, 50, 88, 222, 84, 104, 500, 52, 124, 434, 500, 48, 166, 500, 72, 258, 228, 76, 72, 500, 68, 40, 500, 500, 54, 320, 500, 110, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3742865683926811, "mean_inference_ms": 1.197036339597552, "mean_action_processing_ms": 0.13951461877691357, "mean_env_wait_ms": 0.08117692486176946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021741867065429688, "StateBufferConnector_ms": 0.0010335445404052734, "ViewRequirementAgentConnector_ms": 0.10959148406982422}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.0289999999998076, "episode_len_mean": 265.3, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.499999999999865, -50.00000000000044, 47.9, 44.900000000000006, 34.900000000000034, 43.30000000000001, 47.3, 29.099999999999973, 31.1, 47.3, 46.3, -50.00000000000044, -50.00000000000044, 47.1, 44.5, 45.5, 45.9, 46.5, 45.3, -50.00000000000044, 43.50000000000001, 46.099999999999994, 45.3, -50.00000000000044, 7.699999999999669, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, 43.50000000000001, -50.00000000000044, 45.3, 44.5, 15.299999999999777, 45.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 32.50000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.9, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.30000000000001, 27.899999999999956, 41.70000000000002, 39.70000000000002, -50.00000000000044, 44.900000000000006, 37.70000000000003, 6.699999999999655, -50.00000000000044, 45.3, 33.500000000000036, -50.00000000000044, 42.900000000000006, 24.299999999999905, 27.299999999999947, 42.500000000000014, 42.900000000000006, -50.00000000000044, 43.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 18.099999999999817, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [286, 500, 22, 52, 152, 68, 28, 210, 190, 28, 38, 500, 500, 30, 56, 46, 42, 36, 48, 500, 66, 40, 48, 500, 424, 500, 500, 92, 500, 500, 52, 36, 66, 500, 48, 56, 348, 42, 500, 108, 500, 500, 500, 78, 176, 80, 500, 500, 500, 44, 50, 500, 500, 28, 40, 500, 500, 500, 500, 500, 500, 32, 42, 32, 500, 500, 500, 500, 500, 50, 88, 222, 84, 104, 500, 52, 124, 434, 500, 48, 166, 500, 72, 258, 228, 76, 72, 500, 68, 40, 500, 500, 54, 320, 500, 110, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3742865683926811, "mean_inference_ms": 1.197036339597552, "mean_action_processing_ms": 0.13951461877691357, "mean_env_wait_ms": 0.08117692486176946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021741867065429688, "StateBufferConnector_ms": 0.0010335445404052734, "ViewRequirementAgentConnector_ms": 0.10959148406982422}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5827.041519292572, "num_env_steps_trained_throughput_per_sec": 5827.041519292572, "timesteps_total": 1152000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 2218.186, "sample_time_ms": 1904.067, "load_time_ms": 10.661, "load_throughput": 1125640.138, "learn_time_ms": 293.772, "learn_throughput": 40847.984, "synch_weights_time_ms": 8.786}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4340, "training_iteration": 96, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-02", "timestamp": 1698247202, "time_this_iter_s": 2.0643627643585205, "time_total_s": 217.29301953315735, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 217.29301953315735, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 56.4, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5243548967072386e-30, "cur_lr": 0.0003, "total_loss": 6.073207521438599, "policy_loss": -0.00040621133521199224, "vf_loss": 6.073656145731608, "vf_explained_var": -1.1761983235677084e-06, "kl": 0.0009459840140910576, "entropy": 0.42396978040536243, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2895.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.2970000000002138, "episode_len_mean": 288.5, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 32.50000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.9, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.30000000000001, 27.899999999999956, 41.70000000000002, 39.70000000000002, -50.00000000000044, 44.900000000000006, 37.70000000000003, 6.699999999999655, -50.00000000000044, 45.3, 33.500000000000036, -50.00000000000044, 42.900000000000006, 24.299999999999905, 27.299999999999947, 42.500000000000014, 42.900000000000006, -50.00000000000044, 43.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 18.099999999999817, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 35.70000000000003, 47.3, 47.3, 47.5, 26.299999999999933, -50.00000000000044, 47.5, 47.9, -50.00000000000044, 45.1, -50.00000000000044, 19.499999999999837, -50.00000000000044, 43.10000000000001, 32.100000000000016, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.300000000000004, 30.099999999999987, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 25.899999999999928], "episode_lengths": [500, 78, 176, 80, 500, 500, 500, 44, 50, 500, 500, 28, 40, 500, 500, 500, 500, 500, 500, 32, 42, 32, 500, 500, 500, 500, 500, 50, 88, 222, 84, 104, 500, 52, 124, 434, 500, 48, 166, 500, 72, 258, 228, 76, 72, 500, 68, 40, 500, 500, 54, 320, 500, 110, 500, 500, 500, 500, 78, 500, 144, 28, 28, 26, 238, 500, 26, 22, 500, 50, 500, 306, 500, 70, 180, 28, 500, 500, 42, 500, 58, 200, 500, 46, 500, 500, 500, 500, 500, 54, 500, 36, 94, 500, 500, 42, 500, 500, 40, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3741823106560819, "mean_inference_ms": 1.1962685765275145, "mean_action_processing_ms": 0.13959984188750613, "mean_env_wait_ms": 0.08138134710662276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021311283111572266, "StateBufferConnector_ms": 0.003993988037109375, "ViewRequirementAgentConnector_ms": 0.10885238647460938}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.2970000000002138, "episode_len_mean": 288.5, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 32.50000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.9, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.30000000000001, 27.899999999999956, 41.70000000000002, 39.70000000000002, -50.00000000000044, 44.900000000000006, 37.70000000000003, 6.699999999999655, -50.00000000000044, 45.3, 33.500000000000036, -50.00000000000044, 42.900000000000006, 24.299999999999905, 27.299999999999947, 42.500000000000014, 42.900000000000006, -50.00000000000044, 43.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 18.099999999999817, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 35.70000000000003, 47.3, 47.3, 47.5, 26.299999999999933, -50.00000000000044, 47.5, 47.9, -50.00000000000044, 45.1, -50.00000000000044, 19.499999999999837, -50.00000000000044, 43.10000000000001, 32.100000000000016, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.300000000000004, 30.099999999999987, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 25.899999999999928], "episode_lengths": [500, 78, 176, 80, 500, 500, 500, 44, 50, 500, 500, 28, 40, 500, 500, 500, 500, 500, 500, 32, 42, 32, 500, 500, 500, 500, 500, 50, 88, 222, 84, 104, 500, 52, 124, 434, 500, 48, 166, 500, 72, 258, 228, 76, 72, 500, 68, 40, 500, 500, 54, 320, 500, 110, 500, 500, 500, 500, 78, 500, 144, 28, 28, 26, 238, 500, 26, 22, 500, 50, 500, 306, 500, 70, 180, 28, 500, 500, 42, 500, 58, 200, 500, 46, 500, 500, 500, 500, 500, 54, 500, 36, 94, 500, 500, 42, 500, 500, 40, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3741823106560819, "mean_inference_ms": 1.1962685765275145, "mean_action_processing_ms": 0.13959984188750613, "mean_env_wait_ms": 0.08138134710662276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021311283111572266, "StateBufferConnector_ms": 0.003993988037109375, "ViewRequirementAgentConnector_ms": 0.10885238647460938}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5534.855748215306, "num_env_steps_trained_throughput_per_sec": 5534.855748215306, "timesteps_total": 1164000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 2222.806, "sample_time_ms": 1901.11, "load_time_ms": 10.861, "load_throughput": 1104856.953, "learn_time_ms": 301.093, "learn_throughput": 39854.826, "synch_weights_time_ms": 8.842}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 4382, "training_iteration": 97, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-04", "timestamp": 1698247204, "time_this_iter_s": 2.173537254333496, "time_total_s": 219.46655678749084, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 219.46655678749084, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 57.800000000000004, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2621774483536193e-30, "cur_lr": 0.0003, "total_loss": 6.662611103057861, "policy_loss": -0.0003932526800781488, "vf_loss": 6.66304349899292, "vf_explained_var": -1.0212262471516927e-06, "kl": 0.0009138096651402824, "entropy": 0.39156876802444457, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2925.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3659999999998034, "episode_len_mean": 266.92, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 18.099999999999817, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 35.70000000000003, 47.3, 47.3, 47.5, 26.299999999999933, -50.00000000000044, 47.5, 47.9, -50.00000000000044, 45.1, -50.00000000000044, 19.499999999999837, -50.00000000000044, 43.10000000000001, 32.100000000000016, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.300000000000004, 30.099999999999987, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 25.899999999999928, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.30000000000001, 20.699999999999854, 30.29999999999999, 2.499999999999595, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.900000000000006, 44.5, 47.3, 46.5, 47.3, -50.00000000000044, 47.3, 45.3, 45.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, 38.700000000000024, 47.3, 46.099999999999994, 47.1, 44.300000000000004, 30.29999999999999, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 29.69999999999998, 46.099999999999994, 46.9, 13.299999999999748, -50.00000000000044, 47.9, 45.9, 44.300000000000004, 39.300000000000026], "episode_lengths": [54, 320, 500, 110, 500, 500, 500, 500, 78, 500, 144, 28, 28, 26, 238, 500, 26, 22, 500, 50, 500, 306, 500, 70, 180, 28, 500, 500, 42, 500, 58, 200, 500, 46, 500, 500, 500, 500, 500, 54, 500, 36, 94, 500, 500, 42, 500, 500, 40, 242, 500, 36, 500, 500, 48, 500, 500, 70, 500, 78, 294, 198, 476, 500, 500, 500, 500, 500, 90, 52, 56, 28, 36, 28, 500, 28, 48, 42, 500, 500, 116, 114, 28, 40, 30, 58, 198, 500, 500, 64, 500, 204, 40, 32, 368, 500, 22, 42, 58, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37373355380332357, "mean_inference_ms": 1.1960944183391304, "mean_action_processing_ms": 0.1396714701727927, "mean_env_wait_ms": 0.08125782875967566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020293474197387695, "StateBufferConnector_ms": 0.0067501068115234375, "ViewRequirementAgentConnector_ms": 0.09204626083374023}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3659999999998034, "episode_len_mean": 266.92, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 18.099999999999817, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 35.70000000000003, 47.3, 47.3, 47.5, 26.299999999999933, -50.00000000000044, 47.5, 47.9, -50.00000000000044, 45.1, -50.00000000000044, 19.499999999999837, -50.00000000000044, 43.10000000000001, 32.100000000000016, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.300000000000004, 30.099999999999987, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 25.899999999999928, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.30000000000001, 20.699999999999854, 30.29999999999999, 2.499999999999595, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.900000000000006, 44.5, 47.3, 46.5, 47.3, -50.00000000000044, 47.3, 45.3, 45.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, 38.700000000000024, 47.3, 46.099999999999994, 47.1, 44.300000000000004, 30.29999999999999, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 29.69999999999998, 46.099999999999994, 46.9, 13.299999999999748, -50.00000000000044, 47.9, 45.9, 44.300000000000004, 39.300000000000026], "episode_lengths": [54, 320, 500, 110, 500, 500, 500, 500, 78, 500, 144, 28, 28, 26, 238, 500, 26, 22, 500, 50, 500, 306, 500, 70, 180, 28, 500, 500, 42, 500, 58, 200, 500, 46, 500, 500, 500, 500, 500, 54, 500, 36, 94, 500, 500, 42, 500, 500, 40, 242, 500, 36, 500, 500, 48, 500, 500, 70, 500, 78, 294, 198, 476, 500, 500, 500, 500, 500, 90, 52, 56, 28, 36, 28, 500, 28, 48, 42, 500, 500, 116, 114, 28, 40, 30, 58, 198, 500, 500, 64, 500, 204, 40, 32, 368, 500, 22, 42, 58, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37373355380332357, "mean_inference_ms": 1.1960944183391304, "mean_action_processing_ms": 0.1396714701727927, "mean_env_wait_ms": 0.08125782875967566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020293474197387695, "StateBufferConnector_ms": 0.0067501068115234375, "ViewRequirementAgentConnector_ms": 0.09204626083374023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4997.9775387340505, "num_env_steps_trained_throughput_per_sec": 4997.9775387340505, "timesteps_total": 1176000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 2258.813, "sample_time_ms": 1915.531, "load_time_ms": 11.863, "load_throughput": 1011577.551, "learn_time_ms": 321.731, "learn_throughput": 37298.279, "synch_weights_time_ms": 8.889}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 4432, "training_iteration": 98, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-06", "timestamp": 1698247206, "time_this_iter_s": 2.4069697856903076, "time_total_s": 221.87352657318115, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 221.87352657318115, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 58.666666666666664, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.3108872417680965e-31, "cur_lr": 0.0003, "total_loss": 6.646428696314493, "policy_loss": -0.0006258974472681682, "vf_loss": 6.647100083033243, "vf_explained_var": -1.2516975402832031e-06, "kl": 0.0007439956980950531, "entropy": 0.4546329478422801, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2955.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.918999999999824, "episode_len_mean": 246.46, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.899999999999928, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.30000000000001, 20.699999999999854, 30.29999999999999, 2.499999999999595, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.900000000000006, 44.5, 47.3, 46.5, 47.3, -50.00000000000044, 47.3, 45.3, 45.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, 38.700000000000024, 47.3, 46.099999999999994, 47.1, 44.300000000000004, 30.29999999999999, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 29.69999999999998, 46.099999999999994, 46.9, 13.299999999999748, -50.00000000000044, 47.9, 45.9, 44.300000000000004, 39.300000000000026, 19.299999999999834, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 4.299999999999621, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 43.7, 43.50000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, 47.7, -50.00000000000044, 44.10000000000001, 41.90000000000001, 22.699999999999882, 38.10000000000002, -50.00000000000044, 34.900000000000034, 47.7, 45.1, 35.500000000000036, 46.699999999999996, -50.00000000000044, 46.099999999999994, 10.499999999999709, -50.00000000000044, 46.5, 46.5, 45.5, 43.7, 46.3, 47.5, 47.1, -50.00000000000044, 40.90000000000002, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044], "episode_lengths": [242, 500, 36, 500, 500, 48, 500, 500, 70, 500, 78, 294, 198, 476, 500, 500, 500, 500, 500, 90, 52, 56, 28, 36, 28, 500, 28, 48, 42, 500, 500, 116, 114, 28, 40, 30, 58, 198, 500, 500, 64, 500, 204, 40, 32, 368, 500, 22, 42, 58, 108, 308, 38, 66, 500, 500, 500, 112, 458, 82, 500, 500, 500, 30, 64, 66, 30, 500, 500, 500, 474, 24, 500, 60, 82, 274, 120, 500, 152, 24, 50, 146, 34, 500, 40, 396, 500, 36, 36, 46, 64, 38, 26, 30, 500, 92, 500, 276, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3739745285618517, "mean_inference_ms": 1.1956559426855398, "mean_action_processing_ms": 0.13969544800764067, "mean_env_wait_ms": 0.08135430146959485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300572395324707, "StateBufferConnector_ms": 0.0069332122802734375, "ViewRequirementAgentConnector_ms": 0.09164905548095703}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.918999999999824, "episode_len_mean": 246.46, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.899999999999928, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.30000000000001, 20.699999999999854, 30.29999999999999, 2.499999999999595, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.900000000000006, 44.5, 47.3, 46.5, 47.3, -50.00000000000044, 47.3, 45.3, 45.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, 38.700000000000024, 47.3, 46.099999999999994, 47.1, 44.300000000000004, 30.29999999999999, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 29.69999999999998, 46.099999999999994, 46.9, 13.299999999999748, -50.00000000000044, 47.9, 45.9, 44.300000000000004, 39.300000000000026, 19.299999999999834, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 4.299999999999621, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 43.7, 43.50000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, 47.7, -50.00000000000044, 44.10000000000001, 41.90000000000001, 22.699999999999882, 38.10000000000002, -50.00000000000044, 34.900000000000034, 47.7, 45.1, 35.500000000000036, 46.699999999999996, -50.00000000000044, 46.099999999999994, 10.499999999999709, -50.00000000000044, 46.5, 46.5, 45.5, 43.7, 46.3, 47.5, 47.1, -50.00000000000044, 40.90000000000002, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044], "episode_lengths": [242, 500, 36, 500, 500, 48, 500, 500, 70, 500, 78, 294, 198, 476, 500, 500, 500, 500, 500, 90, 52, 56, 28, 36, 28, 500, 28, 48, 42, 500, 500, 116, 114, 28, 40, 30, 58, 198, 500, 500, 64, 500, 204, 40, 32, 368, 500, 22, 42, 58, 108, 308, 38, 66, 500, 500, 500, 112, 458, 82, 500, 500, 500, 30, 64, 66, 30, 500, 500, 500, 474, 24, 500, 60, 82, 274, 120, 500, 152, 24, 50, 146, 34, 500, 40, 396, 500, 36, 36, 46, 64, 38, 26, 30, 500, 92, 500, 276, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3739745285618517, "mean_inference_ms": 1.1956559426855398, "mean_action_processing_ms": 0.13969544800764067, "mean_env_wait_ms": 0.08135430146959485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300572395324707, "StateBufferConnector_ms": 0.0069332122802734375, "ViewRequirementAgentConnector_ms": 0.09164905548095703}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5702.966204488098, "num_env_steps_trained_throughput_per_sec": 5702.966204488098, "timesteps_total": 1188000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 2251.558, "sample_time_ms": 1921.435, "load_time_ms": 11.563, "load_throughput": 1037821.574, "learn_time_ms": 308.975, "learn_throughput": 38838.138, "synch_weights_time_ms": 8.785}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4481, "training_iteration": 99, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-08", "timestamp": 1698247208, "time_this_iter_s": 2.1091690063476562, "time_total_s": 223.9826955795288, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 223.9826955795288, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 50.6, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.1554436208840483e-31, "cur_lr": 0.0003, "total_loss": 6.741246112187704, "policy_loss": -0.0006224707079430422, "vf_loss": 6.741909090677897, "vf_explained_var": -7.708867390950521e-07, "kl": 0.0007639308442226896, "entropy": 0.4068691035111745, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2985.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.066999999999806, "episode_len_mean": 264.96, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, 29.69999999999998, 46.099999999999994, 46.9, 13.299999999999748, -50.00000000000044, 47.9, 45.9, 44.300000000000004, 39.300000000000026, 19.299999999999834, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 4.299999999999621, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 43.7, 43.50000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, 47.7, -50.00000000000044, 44.10000000000001, 41.90000000000001, 22.699999999999882, 38.10000000000002, -50.00000000000044, 34.900000000000034, 47.7, 45.1, 35.500000000000036, 46.699999999999996, -50.00000000000044, 46.099999999999994, 10.499999999999709, -50.00000000000044, 46.5, 46.5, 45.5, 43.7, 46.3, 47.5, 47.1, -50.00000000000044, 40.90000000000002, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.1, 38.90000000000002, 23.699999999999896, 0.8999999999995723, 29.49999999999998, 43.10000000000001, 27.699999999999953, 44.900000000000006, -50.00000000000044, 0.8999999999995723, 43.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 19.299999999999834, 47.1, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, 43.7], "episode_lengths": [64, 500, 204, 40, 32, 368, 500, 22, 42, 58, 108, 308, 38, 66, 500, 500, 500, 112, 458, 82, 500, 500, 500, 30, 64, 66, 30, 500, 500, 500, 474, 24, 500, 60, 82, 274, 120, 500, 152, 24, 50, 146, 34, 500, 40, 396, 500, 36, 36, 46, 64, 38, 26, 30, 500, 92, 500, 276, 500, 500, 500, 184, 34, 500, 500, 30, 112, 264, 492, 206, 70, 224, 52, 500, 492, 70, 56, 500, 500, 384, 500, 500, 500, 500, 500, 500, 42, 500, 38, 500, 308, 30, 22, 500, 500, 500, 34, 500, 76, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3739570246390283, "mean_inference_ms": 1.195764319264714, "mean_action_processing_ms": 0.13981713033148913, "mean_env_wait_ms": 0.08142720045841235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02581191062927246, "StateBufferConnector_ms": 0.0051763057708740234, "ViewRequirementAgentConnector_ms": 0.10252523422241211}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.066999999999806, "episode_len_mean": 264.96, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, 29.69999999999998, 46.099999999999994, 46.9, 13.299999999999748, -50.00000000000044, 47.9, 45.9, 44.300000000000004, 39.300000000000026, 19.299999999999834, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 4.299999999999621, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 43.7, 43.50000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, 47.7, -50.00000000000044, 44.10000000000001, 41.90000000000001, 22.699999999999882, 38.10000000000002, -50.00000000000044, 34.900000000000034, 47.7, 45.1, 35.500000000000036, 46.699999999999996, -50.00000000000044, 46.099999999999994, 10.499999999999709, -50.00000000000044, 46.5, 46.5, 45.5, 43.7, 46.3, 47.5, 47.1, -50.00000000000044, 40.90000000000002, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.1, 38.90000000000002, 23.699999999999896, 0.8999999999995723, 29.49999999999998, 43.10000000000001, 27.699999999999953, 44.900000000000006, -50.00000000000044, 0.8999999999995723, 43.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 19.299999999999834, 47.1, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, 43.7], "episode_lengths": [64, 500, 204, 40, 32, 368, 500, 22, 42, 58, 108, 308, 38, 66, 500, 500, 500, 112, 458, 82, 500, 500, 500, 30, 64, 66, 30, 500, 500, 500, 474, 24, 500, 60, 82, 274, 120, 500, 152, 24, 50, 146, 34, 500, 40, 396, 500, 36, 36, 46, 64, 38, 26, 30, 500, 92, 500, 276, 500, 500, 500, 184, 34, 500, 500, 30, 112, 264, 492, 206, 70, 224, 52, 500, 492, 70, 56, 500, 500, 384, 500, 500, 500, 500, 500, 500, 42, 500, 38, 500, 308, 30, 22, 500, 500, 500, 34, 500, 76, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3739570246390283, "mean_inference_ms": 1.195764319264714, "mean_action_processing_ms": 0.13981713033148913, "mean_env_wait_ms": 0.08142720045841235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02581191062927246, "StateBufferConnector_ms": 0.0051763057708740234, "ViewRequirementAgentConnector_ms": 0.10252523422241211}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5659.541327916783, "num_env_steps_trained_throughput_per_sec": 5659.541327916783, "timesteps_total": 1200000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 2248.019, "sample_time_ms": 1910.334, "load_time_ms": 11.862, "load_throughput": 1011660.915, "learn_time_ms": 315.915, "learn_throughput": 37984.857, "synch_weights_time_ms": 9.008}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "episodes_total": 4521, "training_iteration": 100, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-11", "timestamp": 1698247211, "time_this_iter_s": 2.1253151893615723, "time_total_s": 226.10801076889038, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 226.10801076889038, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 58.633333333333326, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5777218104420241e-31, "cur_lr": 0.0003, "total_loss": 6.119499317804972, "policy_loss": -1.1016676823298137e-05, "vf_loss": 6.119553931554159, "vf_explained_var": -8.702278137207031e-07, "kl": 0.0006318704611004477, "entropy": 0.4359037468830744, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3015.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5279999999997909, "episode_len_mean": 275.3, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.500000000000036, 46.699999999999996, -50.00000000000044, 46.099999999999994, 10.499999999999709, -50.00000000000044, 46.5, 46.5, 45.5, 43.7, 46.3, 47.5, 47.1, -50.00000000000044, 40.90000000000002, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.1, 38.90000000000002, 23.699999999999896, 0.8999999999995723, 29.49999999999998, 43.10000000000001, 27.699999999999953, 44.900000000000006, -50.00000000000044, 0.8999999999995723, 43.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 19.299999999999834, 47.1, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 46.5, -50.00000000000044, 45.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 44.300000000000004, 47.3, 1.8999999999995865, 46.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 45.5, 27.099999999999945, 48.1, 41.90000000000001, 40.10000000000002, 47.7, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 14.09999999999976, -50.00000000000044, -50.00000000000044], "episode_lengths": [146, 34, 500, 40, 396, 500, 36, 36, 46, 64, 38, 26, 30, 500, 92, 500, 276, 500, 500, 500, 184, 34, 500, 500, 30, 112, 264, 492, 206, 70, 224, 52, 500, 492, 70, 56, 500, 500, 384, 500, 500, 500, 500, 500, 500, 42, 500, 38, 500, 308, 30, 22, 500, 500, 500, 34, 500, 76, 64, 500, 500, 500, 500, 500, 28, 36, 500, 44, 90, 500, 500, 42, 36, 58, 28, 482, 32, 500, 500, 42, 500, 52, 42, 500, 46, 230, 20, 82, 100, 24, 500, 30, 500, 500, 500, 42, 40, 360, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3741101335620675, "mean_inference_ms": 1.1952191925355011, "mean_action_processing_ms": 0.13986238853286187, "mean_env_wait_ms": 0.08138085556271375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022182703018188477, "StateBufferConnector_ms": 0.0050313472747802734, "ViewRequirementAgentConnector_ms": 0.10405111312866211}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5279999999997909, "episode_len_mean": 275.3, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.500000000000036, 46.699999999999996, -50.00000000000044, 46.099999999999994, 10.499999999999709, -50.00000000000044, 46.5, 46.5, 45.5, 43.7, 46.3, 47.5, 47.1, -50.00000000000044, 40.90000000000002, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.1, 38.90000000000002, 23.699999999999896, 0.8999999999995723, 29.49999999999998, 43.10000000000001, 27.699999999999953, 44.900000000000006, -50.00000000000044, 0.8999999999995723, 43.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 19.299999999999834, 47.1, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 46.5, -50.00000000000044, 45.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 44.300000000000004, 47.3, 1.8999999999995865, 46.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 45.5, 27.099999999999945, 48.1, 41.90000000000001, 40.10000000000002, 47.7, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 14.09999999999976, -50.00000000000044, -50.00000000000044], "episode_lengths": [146, 34, 500, 40, 396, 500, 36, 36, 46, 64, 38, 26, 30, 500, 92, 500, 276, 500, 500, 500, 184, 34, 500, 500, 30, 112, 264, 492, 206, 70, 224, 52, 500, 492, 70, 56, 500, 500, 384, 500, 500, 500, 500, 500, 500, 42, 500, 38, 500, 308, 30, 22, 500, 500, 500, 34, 500, 76, 64, 500, 500, 500, 500, 500, 28, 36, 500, 44, 90, 500, 500, 42, 36, 58, 28, 482, 32, 500, 500, 42, 500, 52, 42, 500, 46, 230, 20, 82, 100, 24, 500, 30, 500, 500, 500, 42, 40, 360, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3741101335620675, "mean_inference_ms": 1.1952191925355011, "mean_action_processing_ms": 0.13986238853286187, "mean_env_wait_ms": 0.08138085556271375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022182703018188477, "StateBufferConnector_ms": 0.0050313472747802734, "ViewRequirementAgentConnector_ms": 0.10405111312866211}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5151.01750500578, "num_env_steps_trained_throughput_per_sec": 5151.01750500578, "timesteps_total": 1212000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 2254.75, "sample_time_ms": 1900.774, "load_time_ms": 12.395, "load_throughput": 968122.965, "learn_time_ms": 331.673, "learn_throughput": 36180.169, "synch_weights_time_ms": 9.008}, "counters": {"num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "episodes_total": 4562, "training_iteration": 101, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-13", "timestamp": 1698247213, "time_this_iter_s": 2.334636926651001, "time_total_s": 228.44264769554138, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 228.44264769554138, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 50.575, "ram_util_percent": 26.424999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.888609052210121e-32, "cur_lr": 0.0003, "total_loss": 6.6493812243143715, "policy_loss": -0.0001101041833559672, "vf_loss": 6.649538135528564, "vf_explained_var": -9.61621602376302e-07, "kl": 0.0004087487100112715, "entropy": 0.4667411118745804, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3045.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.6290000000002203, "episode_len_mean": 281.84, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 19.299999999999834, 47.1, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 46.5, -50.00000000000044, 45.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 44.300000000000004, 47.3, 1.8999999999995865, 46.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 45.5, 27.099999999999945, 48.1, 41.90000000000001, 40.10000000000002, 47.7, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 41.500000000000014, 46.5, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.5, 7.899999999999672, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, 46.699999999999996, 25.099999999999916, -50.00000000000044, 42.70000000000001, 27.299999999999947, 45.1, 46.699999999999996, -50.00000000000044, 13.499999999999751, 44.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 17.899999999999814, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, -50.00000000000044], "episode_lengths": [500, 500, 42, 500, 38, 500, 308, 30, 22, 500, 500, 500, 34, 500, 76, 64, 500, 500, 500, 500, 500, 28, 36, 500, 44, 90, 500, 500, 42, 36, 58, 28, 482, 32, 500, 500, 42, 500, 52, 42, 500, 46, 230, 20, 82, 100, 24, 500, 30, 500, 500, 500, 42, 40, 360, 500, 500, 500, 64, 40, 500, 500, 500, 492, 86, 36, 132, 500, 500, 46, 422, 500, 500, 500, 500, 500, 34, 44, 34, 250, 500, 74, 228, 50, 34, 500, 366, 52, 60, 500, 500, 76, 322, 56, 500, 500, 500, 48, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3736670166231363, "mean_inference_ms": 1.194537577938689, "mean_action_processing_ms": 0.13989183499117838, "mean_env_wait_ms": 0.08119653180216818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019376039505004883, "StateBufferConnector_ms": 0.010024309158325195, "ViewRequirementAgentConnector_ms": 0.12538433074951172}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.6290000000002203, "episode_len_mean": 281.84, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 19.299999999999834, 47.1, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 46.5, -50.00000000000044, 45.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 44.300000000000004, 47.3, 1.8999999999995865, 46.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 45.5, 27.099999999999945, 48.1, 41.90000000000001, 40.10000000000002, 47.7, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 41.500000000000014, 46.5, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.5, 7.899999999999672, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, 46.699999999999996, 25.099999999999916, -50.00000000000044, 42.70000000000001, 27.299999999999947, 45.1, 46.699999999999996, -50.00000000000044, 13.499999999999751, 44.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 17.899999999999814, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, -50.00000000000044], "episode_lengths": [500, 500, 42, 500, 38, 500, 308, 30, 22, 500, 500, 500, 34, 500, 76, 64, 500, 500, 500, 500, 500, 28, 36, 500, 44, 90, 500, 500, 42, 36, 58, 28, 482, 32, 500, 500, 42, 500, 52, 42, 500, 46, 230, 20, 82, 100, 24, 500, 30, 500, 500, 500, 42, 40, 360, 500, 500, 500, 64, 40, 500, 500, 500, 492, 86, 36, 132, 500, 500, 46, 422, 500, 500, 500, 500, 500, 34, 44, 34, 250, 500, 74, 228, 50, 34, 500, 366, 52, 60, 500, 500, 76, 322, 56, 500, 500, 500, 48, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3736670166231363, "mean_inference_ms": 1.194537577938689, "mean_action_processing_ms": 0.13989183499117838, "mean_env_wait_ms": 0.08119653180216818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019376039505004883, "StateBufferConnector_ms": 0.010024309158325195, "ViewRequirementAgentConnector_ms": 0.12538433074951172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5418.272296246314, "num_env_steps_trained_throughput_per_sec": 5418.272296246314, "timesteps_total": 1224000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 2244.754, "sample_time_ms": 1902.275, "load_time_ms": 11.698, "load_throughput": 1025842.894, "learn_time_ms": 320.77, "learn_throughput": 37409.971, "synch_weights_time_ms": 9.112}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4605, "training_iteration": 102, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-15", "timestamp": 1698247215, "time_this_iter_s": 2.2187249660491943, "time_total_s": 230.66137266159058, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 230.66137266159058, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 56.699999999999996, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.9443045261050603e-32, "cur_lr": 0.0003, "total_loss": 6.197524976730347, "policy_loss": -0.0007387038320302963, "vf_loss": 6.198306353886922, "vf_explained_var": -1.0689099629720052e-06, "kl": 0.0009831800685617508, "entropy": 0.42794061402479805, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3075.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.2089999999998002, "episode_len_mean": 273.5, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.90000000000001, 40.10000000000002, 47.7, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 41.500000000000014, 46.5, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.5, 7.899999999999672, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, 46.699999999999996, 25.099999999999916, -50.00000000000044, 42.70000000000001, 27.299999999999947, 45.1, 46.699999999999996, -50.00000000000044, 13.499999999999751, 44.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 17.899999999999814, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.5, -50.00000000000044, -50.00000000000044, 22.099999999999874, 46.3, -50.00000000000044, 39.90000000000002, 26.299999999999933, 46.099999999999994, 46.5, 40.70000000000002, 45.5, 45.5, 15.699999999999783, 28.09999999999996, 45.7, 41.30000000000001, 45.3, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 47.5, 42.900000000000006, -50.00000000000044, 37.10000000000003, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 32.90000000000003, 36.900000000000034], "episode_lengths": [82, 100, 24, 500, 30, 500, 500, 500, 42, 40, 360, 500, 500, 500, 64, 40, 500, 500, 500, 492, 86, 36, 132, 500, 500, 46, 422, 500, 500, 500, 500, 500, 34, 44, 34, 250, 500, 74, 228, 50, 34, 500, 366, 52, 60, 500, 500, 76, 322, 56, 500, 500, 500, 48, 38, 500, 500, 70, 26, 500, 500, 280, 38, 500, 102, 238, 40, 36, 94, 46, 46, 344, 220, 44, 88, 48, 352, 500, 500, 500, 156, 500, 68, 500, 500, 26, 72, 500, 130, 40, 90, 500, 500, 500, 42, 500, 500, 48, 172, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37322056498321826, "mean_inference_ms": 1.1946494694441028, "mean_action_processing_ms": 0.13963573432717474, "mean_env_wait_ms": 0.08108298244093158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02378249168395996, "StateBufferConnector_ms": 0.013991355895996094, "ViewRequirementAgentConnector_ms": 0.12985825538635254}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.2089999999998002, "episode_len_mean": 273.5, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.90000000000001, 40.10000000000002, 47.7, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 41.500000000000014, 46.5, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.5, 7.899999999999672, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, 46.699999999999996, 25.099999999999916, -50.00000000000044, 42.70000000000001, 27.299999999999947, 45.1, 46.699999999999996, -50.00000000000044, 13.499999999999751, 44.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 17.899999999999814, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.5, -50.00000000000044, -50.00000000000044, 22.099999999999874, 46.3, -50.00000000000044, 39.90000000000002, 26.299999999999933, 46.099999999999994, 46.5, 40.70000000000002, 45.5, 45.5, 15.699999999999783, 28.09999999999996, 45.7, 41.30000000000001, 45.3, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 47.5, 42.900000000000006, -50.00000000000044, 37.10000000000003, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 32.90000000000003, 36.900000000000034], "episode_lengths": [82, 100, 24, 500, 30, 500, 500, 500, 42, 40, 360, 500, 500, 500, 64, 40, 500, 500, 500, 492, 86, 36, 132, 500, 500, 46, 422, 500, 500, 500, 500, 500, 34, 44, 34, 250, 500, 74, 228, 50, 34, 500, 366, 52, 60, 500, 500, 76, 322, 56, 500, 500, 500, 48, 38, 500, 500, 70, 26, 500, 500, 280, 38, 500, 102, 238, 40, 36, 94, 46, 46, 344, 220, 44, 88, 48, 352, 500, 500, 500, 156, 500, 68, 500, 500, 26, 72, 500, 130, 40, 90, 500, 500, 500, 42, 500, 500, 48, 172, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37322056498321826, "mean_inference_ms": 1.1946494694441028, "mean_action_processing_ms": 0.13963573432717474, "mean_env_wait_ms": 0.08108298244093158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02378249168395996, "StateBufferConnector_ms": 0.013991355895996094, "ViewRequirementAgentConnector_ms": 0.12985825538635254}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5117.732775244528, "num_env_steps_trained_throughput_per_sec": 5117.732775244528, "timesteps_total": 1236000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 2231.808, "sample_time_ms": 1879.959, "load_time_ms": 11.431, "load_throughput": 1049741.651, "learn_time_ms": 330.268, "learn_throughput": 36334.113, "synch_weights_time_ms": 9.35}, "counters": {"num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "episodes_total": 4649, "training_iteration": 103, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-18", "timestamp": 1698247218, "time_this_iter_s": 2.3497209548950195, "time_total_s": 233.0110936164856, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 233.0110936164856, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 58.366666666666674, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9721522630525302e-32, "cur_lr": 0.0003, "total_loss": 6.486879777908325, "policy_loss": -0.0004550761232773463, "vf_loss": 6.487374607721964, "vf_explained_var": -9.377797444661458e-07, "kl": 0.0008440754613097568, "entropy": 0.39792715907096865, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3105.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.1730000000002136, "episode_len_mean": 287.28, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 46.699999999999996, -50.00000000000044, 13.499999999999751, 44.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 17.899999999999814, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.5, -50.00000000000044, -50.00000000000044, 22.099999999999874, 46.3, -50.00000000000044, 39.90000000000002, 26.299999999999933, 46.099999999999994, 46.5, 40.70000000000002, 45.5, 45.5, 15.699999999999783, 28.09999999999996, 45.7, 41.30000000000001, 45.3, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 47.5, 42.900000000000006, -50.00000000000044, 37.10000000000003, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 32.90000000000003, 36.900000000000034, -50.00000000000044, 45.1, 45.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 10.299999999999706, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 44.900000000000006, 46.3, 41.90000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, 5.299999999999635, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 31.500000000000007], "episode_lengths": [50, 34, 500, 366, 52, 60, 500, 500, 76, 322, 56, 500, 500, 500, 48, 38, 500, 500, 70, 26, 500, 500, 280, 38, 500, 102, 238, 40, 36, 94, 46, 46, 344, 220, 44, 88, 48, 352, 500, 500, 500, 156, 500, 68, 500, 500, 26, 72, 500, 130, 40, 90, 500, 500, 500, 42, 500, 500, 48, 172, 132, 500, 50, 44, 76, 500, 500, 500, 40, 500, 398, 48, 500, 500, 78, 500, 500, 500, 54, 500, 52, 38, 82, 40, 500, 500, 188, 500, 500, 448, 166, 500, 500, 500, 500, 500, 500, 500, 50, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.372860774866904, "mean_inference_ms": 1.1951111132317331, "mean_action_processing_ms": 0.13952104331022339, "mean_env_wait_ms": 0.08111706790368041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021784067153930664, "StateBufferConnector_ms": 0.008005142211914062, "ViewRequirementAgentConnector_ms": 0.11969876289367676}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.1730000000002136, "episode_len_mean": 287.28, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 46.699999999999996, -50.00000000000044, 13.499999999999751, 44.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 17.899999999999814, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.5, -50.00000000000044, -50.00000000000044, 22.099999999999874, 46.3, -50.00000000000044, 39.90000000000002, 26.299999999999933, 46.099999999999994, 46.5, 40.70000000000002, 45.5, 45.5, 15.699999999999783, 28.09999999999996, 45.7, 41.30000000000001, 45.3, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 47.5, 42.900000000000006, -50.00000000000044, 37.10000000000003, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 32.90000000000003, 36.900000000000034, -50.00000000000044, 45.1, 45.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 10.299999999999706, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 44.900000000000006, 46.3, 41.90000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, 5.299999999999635, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 31.500000000000007], "episode_lengths": [50, 34, 500, 366, 52, 60, 500, 500, 76, 322, 56, 500, 500, 500, 48, 38, 500, 500, 70, 26, 500, 500, 280, 38, 500, 102, 238, 40, 36, 94, 46, 46, 344, 220, 44, 88, 48, 352, 500, 500, 500, 156, 500, 68, 500, 500, 26, 72, 500, 130, 40, 90, 500, 500, 500, 42, 500, 500, 48, 172, 132, 500, 50, 44, 76, 500, 500, 500, 40, 500, 398, 48, 500, 500, 78, 500, 500, 500, 54, 500, 52, 38, 82, 40, 500, 500, 188, 500, 500, 448, 166, 500, 500, 500, 500, 500, 500, 500, 50, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.372860774866904, "mean_inference_ms": 1.1951111132317331, "mean_action_processing_ms": 0.13952104331022339, "mean_env_wait_ms": 0.08111706790368041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021784067153930664, "StateBufferConnector_ms": 0.008005142211914062, "ViewRequirementAgentConnector_ms": 0.11969876289367676}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5506.277366385523, "num_env_steps_trained_throughput_per_sec": 5506.277366385523, "timesteps_total": 1248000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 2231.114, "sample_time_ms": 1880.702, "load_time_ms": 11.832, "load_throughput": 1014188.666, "learn_time_ms": 328.328, "learn_throughput": 36548.863, "synch_weights_time_ms": 9.453}, "counters": {"num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "episodes_total": 4688, "training_iteration": 104, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-20", "timestamp": 1698247220, "time_this_iter_s": 2.1833295822143555, "time_total_s": 235.19442319869995, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 235.19442319869995, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 55.43333333333334, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.860761315262651e-33, "cur_lr": 0.0003, "total_loss": 6.69073224067688, "policy_loss": -0.00012333889802296956, "vf_loss": 6.690898927052816, "vf_explained_var": -7.987022399902344e-07, "kl": 0.00025870190491635486, "entropy": 0.43504814902941386, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3135.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.185000000000224, "episode_len_mean": 297.36, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.5, 42.900000000000006, -50.00000000000044, 37.10000000000003, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 32.90000000000003, 36.900000000000034, -50.00000000000044, 45.1, 45.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 10.299999999999706, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 44.900000000000006, 46.3, 41.90000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, 5.299999999999635, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 31.500000000000007, 19.69999999999984, 31.500000000000007, 47.3, -50.00000000000044, 45.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 42.900000000000006, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 23.8999999999999, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 46.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 25.099999999999916, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 26, 72, 500, 130, 40, 90, 500, 500, 500, 42, 500, 500, 48, 172, 132, 500, 50, 44, 76, 500, 500, 500, 40, 500, 398, 48, 500, 500, 78, 500, 500, 500, 54, 500, 52, 38, 82, 40, 500, 500, 188, 500, 500, 448, 166, 500, 500, 500, 500, 500, 500, 500, 50, 186, 304, 186, 28, 500, 42, 500, 34, 500, 46, 72, 42, 40, 500, 500, 144, 500, 500, 56, 500, 30, 262, 134, 500, 500, 52, 42, 500, 34, 52, 500, 500, 500, 48, 250, 86, 500, 500, 96, 48, 66, 500, 500, 252, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3729329876801873, "mean_inference_ms": 1.1950225470131632, "mean_action_processing_ms": 0.13935736888887315, "mean_env_wait_ms": 0.08128745553423636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02226710319519043, "StateBufferConnector_ms": 0.0067899227142333984, "ViewRequirementAgentConnector_ms": 0.1001732349395752}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.185000000000224, "episode_len_mean": 297.36, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.5, 42.900000000000006, -50.00000000000044, 37.10000000000003, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 32.90000000000003, 36.900000000000034, -50.00000000000044, 45.1, 45.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 10.299999999999706, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 44.900000000000006, 46.3, 41.90000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, 5.299999999999635, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 31.500000000000007, 19.69999999999984, 31.500000000000007, 47.3, -50.00000000000044, 45.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 42.900000000000006, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 23.8999999999999, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 46.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 25.099999999999916, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 26, 72, 500, 130, 40, 90, 500, 500, 500, 42, 500, 500, 48, 172, 132, 500, 50, 44, 76, 500, 500, 500, 40, 500, 398, 48, 500, 500, 78, 500, 500, 500, 54, 500, 52, 38, 82, 40, 500, 500, 188, 500, 500, 448, 166, 500, 500, 500, 500, 500, 500, 500, 50, 186, 304, 186, 28, 500, 42, 500, 34, 500, 46, 72, 42, 40, 500, 500, 144, 500, 500, 56, 500, 30, 262, 134, 500, 500, 52, 42, 500, 34, 52, 500, 500, 500, 48, 250, 86, 500, 500, 96, 48, 66, 500, 500, 252, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3729329876801873, "mean_inference_ms": 1.1950225470131632, "mean_action_processing_ms": 0.13935736888887315, "mean_env_wait_ms": 0.08128745553423636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02226710319519043, "StateBufferConnector_ms": 0.0067899227142333984, "ViewRequirementAgentConnector_ms": 0.1001732349395752}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5168.09921932734, "num_env_steps_trained_throughput_per_sec": 5168.09921932734, "timesteps_total": 1260000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 2224.332, "sample_time_ms": 1884.64, "load_time_ms": 12.14, "load_throughput": 988505.742, "learn_time_ms": 317.285, "learn_throughput": 37820.851, "synch_weights_time_ms": 9.368}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4733, "training_iteration": 105, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-22", "timestamp": 1698247222, "time_this_iter_s": 2.326934814453125, "time_total_s": 237.52135801315308, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 237.52135801315308, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 57.96666666666667, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.9303806576313254e-33, "cur_lr": 0.0003, "total_loss": 6.4235996087392175, "policy_loss": -0.0004360627382993698, "vf_loss": 6.424075857798258, "vf_explained_var": -1.0093053181966146e-06, "kl": 0.0006466466787859559, "entropy": 0.40263145565986636, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3165.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.3440000000002101, "episode_len_mean": 283.98, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 31.500000000000007, 19.69999999999984, 31.500000000000007, 47.3, -50.00000000000044, 45.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 42.900000000000006, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 23.8999999999999, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 46.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 25.099999999999916, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 31.500000000000007, 36.50000000000003, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 38.90000000000002, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 47.5, 46.699999999999996, -50.00000000000044, 44.5, 21.299999999999862, -50.00000000000044, 44.900000000000006, 40.90000000000002, -50.00000000000044, 36.50000000000003, 30.9, 45.1, -50.00000000000044, 6.099999999999646, 46.099999999999994, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.5], "episode_lengths": [166, 500, 500, 500, 500, 500, 500, 500, 50, 186, 304, 186, 28, 500, 42, 500, 34, 500, 46, 72, 42, 40, 500, 500, 144, 500, 500, 56, 500, 30, 262, 134, 500, 500, 52, 42, 500, 34, 52, 500, 500, 500, 48, 250, 86, 500, 500, 96, 48, 66, 500, 500, 252, 500, 500, 500, 500, 500, 54, 186, 136, 100, 500, 500, 500, 34, 46, 28, 500, 500, 500, 44, 40, 500, 112, 24, 500, 500, 500, 154, 26, 34, 500, 56, 288, 500, 52, 92, 500, 136, 192, 50, 500, 440, 40, 70, 80, 500, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3733623650524391, "mean_inference_ms": 1.1945231812454986, "mean_action_processing_ms": 0.13951114113908836, "mean_env_wait_ms": 0.08143188603954098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02255725860595703, "StateBufferConnector_ms": 0.0067784786224365234, "ViewRequirementAgentConnector_ms": 0.11662507057189941}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.3440000000002101, "episode_len_mean": 283.98, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 31.500000000000007, 19.69999999999984, 31.500000000000007, 47.3, -50.00000000000044, 45.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 42.900000000000006, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 23.8999999999999, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 46.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 25.099999999999916, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 31.500000000000007, 36.50000000000003, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 38.90000000000002, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 47.5, 46.699999999999996, -50.00000000000044, 44.5, 21.299999999999862, -50.00000000000044, 44.900000000000006, 40.90000000000002, -50.00000000000044, 36.50000000000003, 30.9, 45.1, -50.00000000000044, 6.099999999999646, 46.099999999999994, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.5], "episode_lengths": [166, 500, 500, 500, 500, 500, 500, 500, 50, 186, 304, 186, 28, 500, 42, 500, 34, 500, 46, 72, 42, 40, 500, 500, 144, 500, 500, 56, 500, 30, 262, 134, 500, 500, 52, 42, 500, 34, 52, 500, 500, 500, 48, 250, 86, 500, 500, 96, 48, 66, 500, 500, 252, 500, 500, 500, 500, 500, 54, 186, 136, 100, 500, 500, 500, 34, 46, 28, 500, 500, 500, 44, 40, 500, 112, 24, 500, 500, 500, 154, 26, 34, 500, 56, 288, 500, 52, 92, 500, 136, 192, 50, 500, 440, 40, 70, 80, 500, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3733623650524391, "mean_inference_ms": 1.1945231812454986, "mean_action_processing_ms": 0.13951114113908836, "mean_env_wait_ms": 0.08143188603954098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02255725860595703, "StateBufferConnector_ms": 0.0067784786224365234, "ViewRequirementAgentConnector_ms": 0.11662507057189941}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5464.354855940307, "num_env_steps_trained_throughput_per_sec": 5464.354855940307, "timesteps_total": 1272000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 2238.0, "sample_time_ms": 1890.455, "load_time_ms": 12.25, "load_throughput": 979586.575, "learn_time_ms": 324.399, "learn_throughput": 36991.432, "synch_weights_time_ms": 9.896}, "counters": {"num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "episodes_total": 4778, "training_iteration": 106, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-24", "timestamp": 1698247224, "time_this_iter_s": 2.2010629177093506, "time_total_s": 239.72242093086243, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 239.72242093086243, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 49.2, "ram_util_percent": 26.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4651903288156627e-33, "cur_lr": 0.0003, "total_loss": 6.684600210189819, "policy_loss": -0.0003617065027356148, "vf_loss": 6.685005219777425, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.0006651886059131584, "entropy": 0.433214870095253, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3195.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.249999999999816, "episode_len_mean": 258.12, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 31.500000000000007, 36.50000000000003, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 38.90000000000002, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 47.5, 46.699999999999996, -50.00000000000044, 44.5, 21.299999999999862, -50.00000000000044, 44.900000000000006, 40.90000000000002, -50.00000000000044, 36.50000000000003, 30.9, 45.1, -50.00000000000044, 6.099999999999646, 46.099999999999994, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 40.500000000000014, 46.3, -50.00000000000044, 44.300000000000004, 3.899999999999615, 47.1, 33.10000000000003, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 10.299999999999706, 46.5, -50.00000000000044, 44.900000000000006, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 42.900000000000006, 36.50000000000003, -50.00000000000044, 45.5, 13.299999999999748, 45.5, 10.299999999999706, 44.10000000000001, 32.50000000000002, -50.00000000000044, 33.10000000000003, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 28.699999999999967, 43.10000000000001, 47.1, 44.7, 44.7, 45.9, -50.00000000000044, 46.3, 45.7, 45.9, 45.3, 46.699999999999996, 23.699999999999896], "episode_lengths": [500, 500, 252, 500, 500, 500, 500, 500, 54, 186, 136, 100, 500, 500, 500, 34, 46, 28, 500, 500, 500, 44, 40, 500, 112, 24, 500, 500, 500, 154, 26, 34, 500, 56, 288, 500, 52, 92, 500, 136, 192, 50, 500, 440, 40, 70, 80, 500, 500, 36, 500, 96, 38, 500, 58, 462, 30, 170, 500, 42, 500, 500, 500, 70, 398, 36, 500, 52, 92, 500, 36, 500, 72, 136, 500, 46, 368, 46, 398, 60, 176, 500, 170, 500, 24, 500, 500, 214, 70, 30, 54, 54, 42, 500, 38, 44, 42, 48, 34, 264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3731632581763887, "mean_inference_ms": 1.1941108563821095, "mean_action_processing_ms": 0.13972712793335196, "mean_env_wait_ms": 0.08143391007009719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02336716651916504, "StateBufferConnector_ms": 0.010001420974731445, "ViewRequirementAgentConnector_ms": 0.11698579788208008}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.249999999999816, "episode_len_mean": 258.12, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 31.500000000000007, 36.50000000000003, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 38.90000000000002, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 47.5, 46.699999999999996, -50.00000000000044, 44.5, 21.299999999999862, -50.00000000000044, 44.900000000000006, 40.90000000000002, -50.00000000000044, 36.50000000000003, 30.9, 45.1, -50.00000000000044, 6.099999999999646, 46.099999999999994, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 40.500000000000014, 46.3, -50.00000000000044, 44.300000000000004, 3.899999999999615, 47.1, 33.10000000000003, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 10.299999999999706, 46.5, -50.00000000000044, 44.900000000000006, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 42.900000000000006, 36.50000000000003, -50.00000000000044, 45.5, 13.299999999999748, 45.5, 10.299999999999706, 44.10000000000001, 32.50000000000002, -50.00000000000044, 33.10000000000003, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 28.699999999999967, 43.10000000000001, 47.1, 44.7, 44.7, 45.9, -50.00000000000044, 46.3, 45.7, 45.9, 45.3, 46.699999999999996, 23.699999999999896], "episode_lengths": [500, 500, 252, 500, 500, 500, 500, 500, 54, 186, 136, 100, 500, 500, 500, 34, 46, 28, 500, 500, 500, 44, 40, 500, 112, 24, 500, 500, 500, 154, 26, 34, 500, 56, 288, 500, 52, 92, 500, 136, 192, 50, 500, 440, 40, 70, 80, 500, 500, 36, 500, 96, 38, 500, 58, 462, 30, 170, 500, 42, 500, 500, 500, 70, 398, 36, 500, 52, 92, 500, 36, 500, 72, 136, 500, 46, 368, 46, 398, 60, 176, 500, 170, 500, 24, 500, 500, 214, 70, 30, 54, 54, 42, 500, 38, 44, 42, 48, 34, 264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3731632581763887, "mean_inference_ms": 1.1941108563821095, "mean_action_processing_ms": 0.13972712793335196, "mean_env_wait_ms": 0.08143391007009719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02336716651916504, "StateBufferConnector_ms": 0.010001420974731445, "ViewRequirementAgentConnector_ms": 0.11698579788208008}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4981.851234103609, "num_env_steps_trained_throughput_per_sec": 4981.851234103609, "timesteps_total": 1284000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 2262.067, "sample_time_ms": 1892.697, "load_time_ms": 12.701, "load_throughput": 944787.191, "learn_time_ms": 345.804, "learn_throughput": 34701.717, "synch_weights_time_ms": 9.765}, "counters": {"num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "episodes_total": 4828, "training_iteration": 107, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-27", "timestamp": 1698247227, "time_this_iter_s": 2.4137420654296875, "time_total_s": 242.13616299629211, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 242.13616299629211, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 57.96666666666666, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2325951644078314e-33, "cur_lr": 0.0003, "total_loss": 6.137839221954346, "policy_loss": -0.0003010313957929611, "vf_loss": 6.138180160522461, "vf_explained_var": -8.940696716308594e-07, "kl": 0.00043885680410464073, "entropy": 0.3997839689254761, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3225.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.41499999999983, "episode_len_mean": 241.5, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 40.500000000000014, 46.3, -50.00000000000044, 44.300000000000004, 3.899999999999615, 47.1, 33.10000000000003, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 10.299999999999706, 46.5, -50.00000000000044, 44.900000000000006, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 42.900000000000006, 36.50000000000003, -50.00000000000044, 45.5, 13.299999999999748, 45.5, 10.299999999999706, 44.10000000000001, 32.50000000000002, -50.00000000000044, 33.10000000000003, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 28.699999999999967, 43.10000000000001, 47.1, 44.7, 44.7, 45.9, -50.00000000000044, 46.3, 45.7, 45.9, 45.3, 46.699999999999996, 23.699999999999896, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 39.50000000000002, -50.00000000000044, 45.3, 47.3, 39.70000000000002, 37.90000000000003, 46.3, 46.9, 43.50000000000001, 9.299999999999692, 47.3, 35.500000000000036, -50.00000000000044, 36.30000000000003, 36.10000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 17.69999999999981, 47.5, 39.50000000000002], "episode_lengths": [40, 70, 80, 500, 500, 36, 500, 96, 38, 500, 58, 462, 30, 170, 500, 42, 500, 500, 500, 70, 398, 36, 500, 52, 92, 500, 36, 500, 72, 136, 500, 46, 368, 46, 398, 60, 176, 500, 170, 500, 24, 500, 500, 214, 70, 30, 54, 54, 42, 500, 38, 44, 42, 48, 34, 264, 500, 126, 500, 58, 500, 500, 500, 500, 500, 60, 500, 500, 500, 32, 26, 500, 80, 500, 46, 500, 30, 106, 500, 48, 28, 104, 122, 38, 32, 66, 408, 28, 146, 500, 138, 140, 64, 500, 500, 500, 32, 324, 26, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37305324045073507, "mean_inference_ms": 1.1943685867091127, "mean_action_processing_ms": 0.13982232259990063, "mean_env_wait_ms": 0.08146123545546238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025298595428466797, "StateBufferConnector_ms": 0.010000467300415039, "ViewRequirementAgentConnector_ms": 0.11770391464233398}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.41499999999983, "episode_len_mean": 241.5, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 40.500000000000014, 46.3, -50.00000000000044, 44.300000000000004, 3.899999999999615, 47.1, 33.10000000000003, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 10.299999999999706, 46.5, -50.00000000000044, 44.900000000000006, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 42.900000000000006, 36.50000000000003, -50.00000000000044, 45.5, 13.299999999999748, 45.5, 10.299999999999706, 44.10000000000001, 32.50000000000002, -50.00000000000044, 33.10000000000003, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 28.699999999999967, 43.10000000000001, 47.1, 44.7, 44.7, 45.9, -50.00000000000044, 46.3, 45.7, 45.9, 45.3, 46.699999999999996, 23.699999999999896, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 39.50000000000002, -50.00000000000044, 45.3, 47.3, 39.70000000000002, 37.90000000000003, 46.3, 46.9, 43.50000000000001, 9.299999999999692, 47.3, 35.500000000000036, -50.00000000000044, 36.30000000000003, 36.10000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 17.69999999999981, 47.5, 39.50000000000002], "episode_lengths": [40, 70, 80, 500, 500, 36, 500, 96, 38, 500, 58, 462, 30, 170, 500, 42, 500, 500, 500, 70, 398, 36, 500, 52, 92, 500, 36, 500, 72, 136, 500, 46, 368, 46, 398, 60, 176, 500, 170, 500, 24, 500, 500, 214, 70, 30, 54, 54, 42, 500, 38, 44, 42, 48, 34, 264, 500, 126, 500, 58, 500, 500, 500, 500, 500, 60, 500, 500, 500, 32, 26, 500, 80, 500, 46, 500, 30, 106, 500, 48, 28, 104, 122, 38, 32, 66, 408, 28, 146, 500, 138, 140, 64, 500, 500, 500, 32, 324, 26, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37305324045073507, "mean_inference_ms": 1.1943685867091127, "mean_action_processing_ms": 0.13982232259990063, "mean_env_wait_ms": 0.08146123545546238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025298595428466797, "StateBufferConnector_ms": 0.010000467300415039, "ViewRequirementAgentConnector_ms": 0.11770391464233398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5327.881916069289, "num_env_steps_trained_throughput_per_sec": 5327.881916069289, "timesteps_total": 1296000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 2247.2, "sample_time_ms": 1888.025, "load_time_ms": 11.901, "load_throughput": 1008343.11, "learn_time_ms": 336.236, "learn_throughput": 35689.193, "synch_weights_time_ms": 9.839}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4872, "training_iteration": 108, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-29", "timestamp": 1698247229, "time_this_iter_s": 2.2573134899139404, "time_total_s": 244.39347648620605, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 244.39347648620605, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 60.23333333333333, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.162975822039157e-34, "cur_lr": 0.0003, "total_loss": 6.4686434427897135, "policy_loss": -0.0003625671068827311, "vf_loss": 6.469044399261475, "vf_explained_var": -9.894371032714845e-07, "kl": 0.0005549273168497848, "entropy": 0.38403083781401315, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.024999999999809, "episode_len_mean": 265.34, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 28.699999999999967, 43.10000000000001, 47.1, 44.7, 44.7, 45.9, -50.00000000000044, 46.3, 45.7, 45.9, 45.3, 46.699999999999996, 23.699999999999896, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 39.50000000000002, -50.00000000000044, 45.3, 47.3, 39.70000000000002, 37.90000000000003, 46.3, 46.9, 43.50000000000001, 9.299999999999692, 47.3, 35.500000000000036, -50.00000000000044, 36.30000000000003, 36.10000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 17.69999999999981, 47.5, 39.50000000000002, -50.00000000000044, 28.29999999999996, -50.00000000000044, 33.70000000000004, 36.900000000000034, 47.5, 44.300000000000004, -50.00000000000044, 38.10000000000002, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, 34.900000000000034, 45.1, 32.30000000000002, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 30.099999999999987, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 21.299999999999862, 47.1, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 214, 70, 30, 54, 54, 42, 500, 38, 44, 42, 48, 34, 264, 500, 126, 500, 58, 500, 500, 500, 500, 500, 60, 500, 500, 500, 32, 26, 500, 80, 500, 46, 500, 30, 106, 500, 48, 28, 104, 122, 38, 32, 66, 408, 28, 146, 500, 138, 140, 64, 500, 500, 500, 32, 324, 26, 106, 500, 218, 500, 164, 132, 26, 58, 500, 120, 500, 50, 34, 500, 500, 246, 500, 500, 500, 42, 500, 50, 152, 50, 178, 500, 500, 496, 500, 200, 500, 74, 500, 500, 288, 30, 36, 500, 500, 42, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37331978001534993, "mean_inference_ms": 1.1945305366664123, "mean_action_processing_ms": 0.139723000664778, "mean_env_wait_ms": 0.081557561667128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021997928619384766, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.12942838668823242}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.024999999999809, "episode_len_mean": 265.34, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 28.699999999999967, 43.10000000000001, 47.1, 44.7, 44.7, 45.9, -50.00000000000044, 46.3, 45.7, 45.9, 45.3, 46.699999999999996, 23.699999999999896, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 39.50000000000002, -50.00000000000044, 45.3, 47.3, 39.70000000000002, 37.90000000000003, 46.3, 46.9, 43.50000000000001, 9.299999999999692, 47.3, 35.500000000000036, -50.00000000000044, 36.30000000000003, 36.10000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 17.69999999999981, 47.5, 39.50000000000002, -50.00000000000044, 28.29999999999996, -50.00000000000044, 33.70000000000004, 36.900000000000034, 47.5, 44.300000000000004, -50.00000000000044, 38.10000000000002, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, 34.900000000000034, 45.1, 32.30000000000002, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 30.099999999999987, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 21.299999999999862, 47.1, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 214, 70, 30, 54, 54, 42, 500, 38, 44, 42, 48, 34, 264, 500, 126, 500, 58, 500, 500, 500, 500, 500, 60, 500, 500, 500, 32, 26, 500, 80, 500, 46, 500, 30, 106, 500, 48, 28, 104, 122, 38, 32, 66, 408, 28, 146, 500, 138, 140, 64, 500, 500, 500, 32, 324, 26, 106, 500, 218, 500, 164, 132, 26, 58, 500, 120, 500, 50, 34, 500, 500, 246, 500, 500, 500, 42, 500, 50, 152, 50, 178, 500, 500, 496, 500, 200, 500, 74, 500, 500, 288, 30, 36, 500, 500, 42, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37331978001534993, "mean_inference_ms": 1.1945305366664123, "mean_action_processing_ms": 0.139723000664778, "mean_env_wait_ms": 0.081557561667128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021997928619384766, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.12942838668823242}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4952.588171485204, "num_env_steps_trained_throughput_per_sec": 4952.588171485204, "timesteps_total": 1308000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 2279.081, "sample_time_ms": 1892.029, "load_time_ms": 12.925, "load_throughput": 928412.362, "learn_time_ms": 362.934, "learn_throughput": 33063.844, "synch_weights_time_ms": 9.942}, "counters": {"num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "episodes_total": 4913, "training_iteration": 109, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-31", "timestamp": 1698247231, "time_this_iter_s": 2.42769193649292, "time_total_s": 246.82116842269897, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 246.82116842269897, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 47.95, "ram_util_percent": 26.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0814879110195784e-34, "cur_lr": 0.0003, "total_loss": 6.277612415949504, "policy_loss": -0.0002820141448561723, "vf_loss": 6.277934137980143, "vf_explained_var": -1.1841456095377604e-06, "kl": 0.00045056933796179993, "entropy": 0.39737045764923096, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3285.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.10800000000020489, "episode_len_mean": 281.64, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.90000000000003, 46.3, 46.9, 43.50000000000001, 9.299999999999692, 47.3, 35.500000000000036, -50.00000000000044, 36.30000000000003, 36.10000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 17.69999999999981, 47.5, 39.50000000000002, -50.00000000000044, 28.29999999999996, -50.00000000000044, 33.70000000000004, 36.900000000000034, 47.5, 44.300000000000004, -50.00000000000044, 38.10000000000002, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, 34.900000000000034, 45.1, 32.30000000000002, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 30.099999999999987, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 21.299999999999862, 47.1, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.5, 11.29999999999972, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 29.899999999999984, 45.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 30.9, 46.699999999999996, 46.5, -50.00000000000044, -50.00000000000044, 47.3, 44.5, 47.5, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [122, 38, 32, 66, 408, 28, 146, 500, 138, 140, 64, 500, 500, 500, 32, 324, 26, 106, 500, 218, 500, 164, 132, 26, 58, 500, 120, 500, 50, 34, 500, 500, 246, 500, 500, 500, 42, 500, 50, 152, 50, 178, 500, 500, 496, 500, 200, 500, 74, 500, 500, 288, 30, 36, 500, 500, 42, 500, 500, 500, 28, 500, 36, 388, 500, 500, 36, 72, 202, 44, 40, 500, 500, 500, 500, 500, 116, 192, 34, 36, 500, 500, 28, 56, 26, 66, 500, 90, 500, 46, 500, 500, 76, 500, 148, 500, 48, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3736405561822338, "mean_inference_ms": 1.19446610572036, "mean_action_processing_ms": 0.13954448505812955, "mean_env_wait_ms": 0.08158455374816509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025002002716064453, "StateBufferConnector_ms": 0.005005359649658203, "ViewRequirementAgentConnector_ms": 0.12472748756408691}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.10800000000020489, "episode_len_mean": 281.64, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.90000000000003, 46.3, 46.9, 43.50000000000001, 9.299999999999692, 47.3, 35.500000000000036, -50.00000000000044, 36.30000000000003, 36.10000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 17.69999999999981, 47.5, 39.50000000000002, -50.00000000000044, 28.29999999999996, -50.00000000000044, 33.70000000000004, 36.900000000000034, 47.5, 44.300000000000004, -50.00000000000044, 38.10000000000002, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, 34.900000000000034, 45.1, 32.30000000000002, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 30.099999999999987, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 21.299999999999862, 47.1, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.5, 11.29999999999972, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 29.899999999999984, 45.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 30.9, 46.699999999999996, 46.5, -50.00000000000044, -50.00000000000044, 47.3, 44.5, 47.5, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [122, 38, 32, 66, 408, 28, 146, 500, 138, 140, 64, 500, 500, 500, 32, 324, 26, 106, 500, 218, 500, 164, 132, 26, 58, 500, 120, 500, 50, 34, 500, 500, 246, 500, 500, 500, 42, 500, 50, 152, 50, 178, 500, 500, 496, 500, 200, 500, 74, 500, 500, 288, 30, 36, 500, 500, 42, 500, 500, 500, 28, 500, 36, 388, 500, 500, 36, 72, 202, 44, 40, 500, 500, 500, 500, 500, 116, 192, 34, 36, 500, 500, 28, 56, 26, 66, 500, 90, 500, 46, 500, 500, 76, 500, 148, 500, 48, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3736405561822338, "mean_inference_ms": 1.19446610572036, "mean_action_processing_ms": 0.13954448505812955, "mean_env_wait_ms": 0.08158455374816509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025002002716064453, "StateBufferConnector_ms": 0.005005359649658203, "ViewRequirementAgentConnector_ms": 0.12472748756408691}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5325.004887883381, "num_env_steps_trained_throughput_per_sec": 5325.004887883381, "timesteps_total": 1320000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 2292.401, "sample_time_ms": 1901.921, "load_time_ms": 13.026, "load_throughput": 921236.206, "learn_time_ms": 366.424, "learn_throughput": 32748.922, "synch_weights_time_ms": 9.779}, "counters": {"num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "episodes_total": 4954, "training_iteration": 110, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-34", "timestamp": 1698247234, "time_this_iter_s": 2.258308172225952, "time_total_s": 249.07947659492493, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 249.07947659492493, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 60.86666666666667, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5407439555097892e-34, "cur_lr": 0.0003, "total_loss": 5.811957200368245, "policy_loss": -0.00024757981300354003, "vf_loss": 5.812244685490926, "vf_explained_var": -8.900960286458333e-07, "kl": 0.0006269414729407192, "entropy": 0.39841456909974415, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3315.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.42900000000023, "episode_len_mean": 299.8, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 34.900000000000034, 45.1, 32.30000000000002, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 30.099999999999987, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 21.299999999999862, 47.1, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.5, 11.29999999999972, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 29.899999999999984, 45.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 30.9, 46.699999999999996, 46.5, -50.00000000000044, -50.00000000000044, 47.3, 44.5, 47.5, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.900000000000006, 45.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 47.1, -50.00000000000044, 42.30000000000001, 45.5, 19.899999999999842, 42.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.699999999999669, -50.00000000000044, 27.699999999999953, 46.5, -50.00000000000044, 45.5, 46.099999999999994], "episode_lengths": [50, 152, 50, 178, 500, 500, 496, 500, 200, 500, 74, 500, 500, 288, 30, 36, 500, 500, 42, 500, 500, 500, 28, 500, 36, 388, 500, 500, 36, 72, 202, 44, 40, 500, 500, 500, 500, 500, 116, 192, 34, 36, 500, 500, 28, 56, 26, 66, 500, 90, 500, 46, 500, 500, 76, 500, 148, 500, 48, 500, 500, 500, 500, 500, 246, 40, 500, 500, 500, 500, 24, 500, 500, 60, 62, 44, 60, 500, 500, 500, 214, 500, 30, 500, 78, 46, 302, 72, 500, 28, 500, 500, 500, 424, 500, 224, 36, 500, 46, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3736544157300955, "mean_inference_ms": 1.194568867596895, "mean_action_processing_ms": 0.13971735274382546, "mean_env_wait_ms": 0.08149670226923648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027006149291992188, "StateBufferConnector_ms": 0.005002498626708984, "ViewRequirementAgentConnector_ms": 0.1199638843536377}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.42900000000023, "episode_len_mean": 299.8, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 34.900000000000034, 45.1, 32.30000000000002, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 30.099999999999987, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 21.299999999999862, 47.1, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.5, 11.29999999999972, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 29.899999999999984, 45.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 30.9, 46.699999999999996, 46.5, -50.00000000000044, -50.00000000000044, 47.3, 44.5, 47.5, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.900000000000006, 45.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 47.1, -50.00000000000044, 42.30000000000001, 45.5, 19.899999999999842, 42.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.699999999999669, -50.00000000000044, 27.699999999999953, 46.5, -50.00000000000044, 45.5, 46.099999999999994], "episode_lengths": [50, 152, 50, 178, 500, 500, 496, 500, 200, 500, 74, 500, 500, 288, 30, 36, 500, 500, 42, 500, 500, 500, 28, 500, 36, 388, 500, 500, 36, 72, 202, 44, 40, 500, 500, 500, 500, 500, 116, 192, 34, 36, 500, 500, 28, 56, 26, 66, 500, 90, 500, 46, 500, 500, 76, 500, 148, 500, 48, 500, 500, 500, 500, 500, 246, 40, 500, 500, 500, 500, 24, 500, 500, 60, 62, 44, 60, 500, 500, 500, 214, 500, 30, 500, 78, 46, 302, 72, 500, 28, 500, 500, 500, 424, 500, 224, 36, 500, 46, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3736544157300955, "mean_inference_ms": 1.194568867596895, "mean_action_processing_ms": 0.13971735274382546, "mean_env_wait_ms": 0.08149670226923648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027006149291992188, "StateBufferConnector_ms": 0.005002498626708984, "ViewRequirementAgentConnector_ms": 0.1199638843536377}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5189.615623232014, "num_env_steps_trained_throughput_per_sec": 5189.615623232014, "timesteps_total": 1332000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 2290.668, "sample_time_ms": 1904.676, "load_time_ms": 13.093, "load_throughput": 916512.305, "learn_time_ms": 361.791, "learn_throughput": 33168.346, "synch_weights_time_ms": 9.858}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 4992, "training_iteration": 111, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-36", "timestamp": 1698247236, "time_this_iter_s": 2.3170323371887207, "time_total_s": 251.39650893211365, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 251.39650893211365, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.703719777548946e-35, "cur_lr": 0.0003, "total_loss": 6.016945823033651, "policy_loss": -0.00014289220174153647, "vf_loss": 6.017131042480469, "vf_explained_var": -9.854634602864584e-07, "kl": 0.00041222530550536857, "entropy": 0.42268522282441456, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3345.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.209000000000227, "episode_len_mean": 297.6, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 46.5, -50.00000000000044, -50.00000000000044, 47.3, 44.5, 47.5, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.900000000000006, 45.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 47.1, -50.00000000000044, 42.30000000000001, 45.5, 19.899999999999842, 42.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.699999999999669, -50.00000000000044, 27.699999999999953, 46.5, -50.00000000000044, 45.5, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.50000000000002, -50.00000000000044, 36.30000000000003, 7.499999999999666, 39.50000000000002, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 18.29999999999982, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 16.499999999999794, 33.90000000000004, 44.10000000000001, 29.69999999999998, -50.00000000000044], "episode_lengths": [34, 36, 500, 500, 28, 56, 26, 66, 500, 90, 500, 46, 500, 500, 76, 500, 148, 500, 48, 500, 500, 500, 500, 500, 246, 40, 500, 500, 500, 500, 24, 500, 500, 60, 62, 44, 60, 500, 500, 500, 214, 500, 30, 500, 78, 46, 302, 72, 500, 28, 500, 500, 500, 424, 500, 224, 36, 500, 46, 40, 62, 500, 500, 66, 74, 500, 500, 500, 500, 34, 106, 500, 138, 426, 106, 84, 500, 34, 500, 36, 500, 34, 500, 34, 318, 82, 500, 500, 500, 52, 500, 500, 500, 82, 500, 336, 162, 60, 204, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3733328663888025, "mean_inference_ms": 1.1945085026367976, "mean_action_processing_ms": 0.1398972055428669, "mean_env_wait_ms": 0.08141772228242486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02901744842529297, "StateBufferConnector_ms": 0.007994651794433594, "ViewRequirementAgentConnector_ms": 0.10725021362304688}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.209000000000227, "episode_len_mean": 297.6, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 46.5, -50.00000000000044, -50.00000000000044, 47.3, 44.5, 47.5, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.900000000000006, 45.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 47.1, -50.00000000000044, 42.30000000000001, 45.5, 19.899999999999842, 42.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.699999999999669, -50.00000000000044, 27.699999999999953, 46.5, -50.00000000000044, 45.5, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.50000000000002, -50.00000000000044, 36.30000000000003, 7.499999999999666, 39.50000000000002, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 18.29999999999982, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 16.499999999999794, 33.90000000000004, 44.10000000000001, 29.69999999999998, -50.00000000000044], "episode_lengths": [34, 36, 500, 500, 28, 56, 26, 66, 500, 90, 500, 46, 500, 500, 76, 500, 148, 500, 48, 500, 500, 500, 500, 500, 246, 40, 500, 500, 500, 500, 24, 500, 500, 60, 62, 44, 60, 500, 500, 500, 214, 500, 30, 500, 78, 46, 302, 72, 500, 28, 500, 500, 500, 424, 500, 224, 36, 500, 46, 40, 62, 500, 500, 66, 74, 500, 500, 500, 500, 34, 106, 500, 138, 426, 106, 84, 500, 34, 500, 36, 500, 34, 500, 34, 318, 82, 500, 500, 500, 52, 500, 500, 500, 82, 500, 336, 162, 60, 204, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3733328663888025, "mean_inference_ms": 1.1945085026367976, "mean_action_processing_ms": 0.1398972055428669, "mean_env_wait_ms": 0.08141772228242486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02901744842529297, "StateBufferConnector_ms": 0.007994651794433594, "ViewRequirementAgentConnector_ms": 0.10725021362304688}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5441.088657761, "num_env_steps_trained_throughput_per_sec": 5441.088657761, "timesteps_total": 1344000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 2289.74, "sample_time_ms": 1903.977, "load_time_ms": 12.891, "load_throughput": 930888.43, "learn_time_ms": 361.881, "learn_throughput": 33160.097, "synch_weights_time_ms": 9.742}, "counters": {"num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "episodes_total": 5032, "training_iteration": 112, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-38", "timestamp": 1698247238, "time_this_iter_s": 2.210440158843994, "time_total_s": 253.60694909095764, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 253.60694909095764, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 58.26666666666667, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.851859888774473e-35, "cur_lr": 0.0003, "total_loss": 6.493465820948283, "policy_loss": -0.000565983746976902, "vf_loss": 6.494072341918946, "vf_explained_var": -1.0013580322265625e-06, "kl": 0.0010124006107503191, "entropy": 0.4054311315218608, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3375.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.0479999999997905, "episode_len_mean": 280.08, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.699999999999669, -50.00000000000044, 27.699999999999953, 46.5, -50.00000000000044, 45.5, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.50000000000002, -50.00000000000044, 36.30000000000003, 7.499999999999666, 39.50000000000002, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 18.29999999999982, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 16.499999999999794, 33.90000000000004, 44.10000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.5, 45.9, -50.00000000000044, 46.3, 31.70000000000001, 15.099999999999774, 46.5, -50.00000000000044, 32.700000000000024, -50.00000000000044, 45.1, 37.90000000000003, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.9, 40.90000000000002, 46.5, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, 45.3, 44.900000000000006, -50.00000000000044, 45.9, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 2.499999999999595, 37.50000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [72, 500, 28, 500, 500, 500, 424, 500, 224, 36, 500, 46, 40, 62, 500, 500, 66, 74, 500, 500, 500, 500, 34, 106, 500, 138, 426, 106, 84, 500, 34, 500, 36, 500, 34, 500, 34, 318, 82, 500, 500, 500, 52, 500, 500, 500, 82, 500, 336, 162, 60, 204, 500, 500, 500, 52, 56, 500, 60, 500, 36, 42, 500, 38, 184, 350, 36, 500, 174, 500, 50, 122, 166, 500, 500, 500, 38, 32, 92, 36, 500, 38, 500, 500, 62, 500, 72, 48, 52, 500, 42, 54, 34, 500, 500, 476, 126, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3727967550416546, "mean_inference_ms": 1.1949234361519487, "mean_action_processing_ms": 0.1396547441426281, "mean_env_wait_ms": 0.08119093738356221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021016836166381836, "StateBufferConnector_ms": 0.006989479064941406, "ViewRequirementAgentConnector_ms": 0.12024378776550293}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.0479999999997905, "episode_len_mean": 280.08, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.699999999999669, -50.00000000000044, 27.699999999999953, 46.5, -50.00000000000044, 45.5, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.50000000000002, -50.00000000000044, 36.30000000000003, 7.499999999999666, 39.50000000000002, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 18.29999999999982, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 16.499999999999794, 33.90000000000004, 44.10000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.5, 45.9, -50.00000000000044, 46.3, 31.70000000000001, 15.099999999999774, 46.5, -50.00000000000044, 32.700000000000024, -50.00000000000044, 45.1, 37.90000000000003, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.9, 40.90000000000002, 46.5, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, 45.3, 44.900000000000006, -50.00000000000044, 45.9, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 2.499999999999595, 37.50000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [72, 500, 28, 500, 500, 500, 424, 500, 224, 36, 500, 46, 40, 62, 500, 500, 66, 74, 500, 500, 500, 500, 34, 106, 500, 138, 426, 106, 84, 500, 34, 500, 36, 500, 34, 500, 34, 318, 82, 500, 500, 500, 52, 500, 500, 500, 82, 500, 336, 162, 60, 204, 500, 500, 500, 52, 56, 500, 60, 500, 36, 42, 500, 38, 184, 350, 36, 500, 174, 500, 50, 122, 166, 500, 500, 500, 38, 32, 92, 36, 500, 38, 500, 500, 62, 500, 72, 48, 52, 500, 42, 54, 34, 500, 500, 476, 126, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3727967550416546, "mean_inference_ms": 1.1949234361519487, "mean_action_processing_ms": 0.1396547441426281, "mean_env_wait_ms": 0.08119093738356221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021016836166381836, "StateBufferConnector_ms": 0.006989479064941406, "ViewRequirementAgentConnector_ms": 0.12024378776550293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5145.995380104636, "num_env_steps_trained_throughput_per_sec": 5145.995380104636, "timesteps_total": 1356000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 2288.452, "sample_time_ms": 1904.082, "load_time_ms": 12.885, "load_throughput": 931329.391, "learn_time_ms": 360.511, "learn_throughput": 33286.058, "synch_weights_time_ms": 9.653}, "counters": {"num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "episodes_total": 5079, "training_iteration": 113, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-41", "timestamp": 1698247241, "time_this_iter_s": 2.336909532546997, "time_total_s": 255.94385862350464, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 255.94385862350464, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 56.03333333333333, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9259299443872365e-35, "cur_lr": 0.0003, "total_loss": 5.841857035954793, "policy_loss": -0.0006688981006542842, "vf_loss": 5.842564439773559, "vf_explained_var": -1.0887781778971354e-06, "kl": 0.000565114702453684, "entropy": 0.38492070833841957, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3405.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.3859999999997962, "episode_len_mean": 276.7, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 16.499999999999794, 33.90000000000004, 44.10000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.5, 45.9, -50.00000000000044, 46.3, 31.70000000000001, 15.099999999999774, 46.5, -50.00000000000044, 32.700000000000024, -50.00000000000044, 45.1, 37.90000000000003, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.9, 40.90000000000002, 46.5, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, 45.3, 44.900000000000006, -50.00000000000044, 45.9, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 2.499999999999595, 37.50000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.9, 47.3, 35.500000000000036, 46.5, -50.00000000000044, -50.00000000000044, 23.29999999999989, 46.699999999999996, -50.00000000000044, 46.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 46.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.900000000000006, -50.00000000000044, 18.899999999999828, 46.699999999999996, -50.00000000000044, 46.3, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.10000000000001, 40.500000000000014, 45.5, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 52, 500, 500, 500, 82, 500, 336, 162, 60, 204, 500, 500, 500, 52, 56, 500, 60, 500, 36, 42, 500, 38, 184, 350, 36, 500, 174, 500, 50, 122, 166, 500, 500, 500, 38, 32, 92, 36, 500, 38, 500, 500, 62, 500, 72, 48, 52, 500, 42, 54, 34, 500, 500, 476, 126, 40, 500, 500, 500, 500, 88, 42, 28, 146, 36, 500, 500, 268, 34, 500, 32, 500, 70, 500, 500, 26, 500, 38, 500, 34, 500, 52, 500, 312, 34, 500, 38, 272, 500, 500, 500, 106, 70, 96, 46, 500, 298, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37326830453736903, "mean_inference_ms": 1.1955887375024594, "mean_action_processing_ms": 0.13955686423190009, "mean_env_wait_ms": 0.08121208919810494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018005847930908203, "StateBufferConnector_ms": 0.005507469177246094, "ViewRequirementAgentConnector_ms": 0.1351633071899414}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.3859999999997962, "episode_len_mean": 276.7, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 16.499999999999794, 33.90000000000004, 44.10000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.5, 45.9, -50.00000000000044, 46.3, 31.70000000000001, 15.099999999999774, 46.5, -50.00000000000044, 32.700000000000024, -50.00000000000044, 45.1, 37.90000000000003, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.9, 40.90000000000002, 46.5, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, 45.3, 44.900000000000006, -50.00000000000044, 45.9, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 2.499999999999595, 37.50000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.9, 47.3, 35.500000000000036, 46.5, -50.00000000000044, -50.00000000000044, 23.29999999999989, 46.699999999999996, -50.00000000000044, 46.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 46.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.900000000000006, -50.00000000000044, 18.899999999999828, 46.699999999999996, -50.00000000000044, 46.3, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.10000000000001, 40.500000000000014, 45.5, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 52, 500, 500, 500, 82, 500, 336, 162, 60, 204, 500, 500, 500, 52, 56, 500, 60, 500, 36, 42, 500, 38, 184, 350, 36, 500, 174, 500, 50, 122, 166, 500, 500, 500, 38, 32, 92, 36, 500, 38, 500, 500, 62, 500, 72, 48, 52, 500, 42, 54, 34, 500, 500, 476, 126, 40, 500, 500, 500, 500, 88, 42, 28, 146, 36, 500, 500, 268, 34, 500, 32, 500, 70, 500, 500, 26, 500, 38, 500, 34, 500, 52, 500, 312, 34, 500, 38, 272, 500, 500, 500, 106, 70, 96, 46, 500, 298, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37326830453736903, "mean_inference_ms": 1.1955887375024594, "mean_action_processing_ms": 0.13955686423190009, "mean_env_wait_ms": 0.08121208919810494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018005847930908203, "StateBufferConnector_ms": 0.005507469177246094, "ViewRequirementAgentConnector_ms": 0.1351633071899414}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5359.847505457643, "num_env_steps_trained_throughput_per_sec": 5359.847505457643, "timesteps_total": 1368000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 2294.406, "sample_time_ms": 1910.083, "load_time_ms": 12.571, "load_throughput": 954556.192, "learn_time_ms": 360.928, "learn_throughput": 33247.586, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5120, "training_iteration": 114, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-43", "timestamp": 1698247243, "time_this_iter_s": 2.244163990020752, "time_total_s": 258.1880226135254, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 258.1880226135254, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 51.900000000000006, "ram_util_percent": 26.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.629649721936182e-36, "cur_lr": 0.0003, "total_loss": 6.40197803179423, "policy_loss": -0.0006792062272628148, "vf_loss": 6.4027008533477785, "vf_explained_var": -1.049041748046875e-06, "kl": 0.000810245331376791, "entropy": 0.43662995994091036, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3435.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6920000000002136, "episode_len_mean": 287.46, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, 45.3, 44.900000000000006, -50.00000000000044, 45.9, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 2.499999999999595, 37.50000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.9, 47.3, 35.500000000000036, 46.5, -50.00000000000044, -50.00000000000044, 23.29999999999989, 46.699999999999996, -50.00000000000044, 46.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 46.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.900000000000006, -50.00000000000044, 18.899999999999828, 46.699999999999996, -50.00000000000044, 46.3, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.10000000000001, 40.500000000000014, 45.5, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 47.5, 40.30000000000002, 45.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.70000000000003, 44.7, -50.00000000000044, 44.10000000000001, 44.5, -50.00000000000044, 22.099999999999874, -50.00000000000044, 45.9, 38.50000000000003, 46.099999999999994, 28.09999999999996, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 38.90000000000002, -50.00000000000044], "episode_lengths": [500, 62, 500, 72, 48, 52, 500, 42, 54, 34, 500, 500, 476, 126, 40, 500, 500, 500, 500, 88, 42, 28, 146, 36, 500, 500, 268, 34, 500, 32, 500, 70, 500, 500, 26, 500, 38, 500, 34, 500, 52, 500, 312, 34, 500, 38, 272, 500, 500, 500, 106, 70, 96, 46, 500, 298, 500, 500, 44, 76, 500, 26, 98, 42, 500, 60, 500, 500, 500, 226, 106, 500, 500, 500, 186, 500, 500, 58, 500, 134, 54, 500, 60, 56, 500, 280, 500, 42, 116, 40, 220, 500, 500, 372, 500, 500, 166, 500, 112, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37342972477689323, "mean_inference_ms": 1.1957272696037426, "mean_action_processing_ms": 0.1394120365630635, "mean_env_wait_ms": 0.08128678616210185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600836753845215, "StateBufferConnector_ms": 0.0035092830657958984, "ViewRequirementAgentConnector_ms": 0.13072419166564941}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6920000000002136, "episode_len_mean": 287.46, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, 45.3, 44.900000000000006, -50.00000000000044, 45.9, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 2.499999999999595, 37.50000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.9, 47.3, 35.500000000000036, 46.5, -50.00000000000044, -50.00000000000044, 23.29999999999989, 46.699999999999996, -50.00000000000044, 46.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 46.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.900000000000006, -50.00000000000044, 18.899999999999828, 46.699999999999996, -50.00000000000044, 46.3, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.10000000000001, 40.500000000000014, 45.5, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 47.5, 40.30000000000002, 45.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.70000000000003, 44.7, -50.00000000000044, 44.10000000000001, 44.5, -50.00000000000044, 22.099999999999874, -50.00000000000044, 45.9, 38.50000000000003, 46.099999999999994, 28.09999999999996, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 38.90000000000002, -50.00000000000044], "episode_lengths": [500, 62, 500, 72, 48, 52, 500, 42, 54, 34, 500, 500, 476, 126, 40, 500, 500, 500, 500, 88, 42, 28, 146, 36, 500, 500, 268, 34, 500, 32, 500, 70, 500, 500, 26, 500, 38, 500, 34, 500, 52, 500, 312, 34, 500, 38, 272, 500, 500, 500, 106, 70, 96, 46, 500, 298, 500, 500, 44, 76, 500, 26, 98, 42, 500, 60, 500, 500, 500, 226, 106, 500, 500, 500, 186, 500, 500, 58, 500, 134, 54, 500, 60, 56, 500, 280, 500, 42, 116, 40, 220, 500, 500, 372, 500, 500, 166, 500, 112, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37342972477689323, "mean_inference_ms": 1.1957272696037426, "mean_action_processing_ms": 0.1394120365630635, "mean_env_wait_ms": 0.08128678616210185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600836753845215, "StateBufferConnector_ms": 0.0035092830657958984, "ViewRequirementAgentConnector_ms": 0.13072419166564941}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5140.830235794287, "num_env_steps_trained_throughput_per_sec": 5140.830235794287, "timesteps_total": 1380000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 2295.637, "sample_time_ms": 1909.418, "load_time_ms": 12.615, "load_throughput": 951272.694, "learn_time_ms": 362.831, "learn_throughput": 33073.254, "synch_weights_time_ms": 9.752}, "counters": {"num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "episodes_total": 5162, "training_iteration": 115, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-45", "timestamp": 1698247245, "time_this_iter_s": 2.339251756668091, "time_total_s": 260.5272743701935, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 260.5272743701935, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 60.666666666666664, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.814824860968091e-36, "cur_lr": 0.0003, "total_loss": 6.535133918126424, "policy_loss": -5.1188344756762186e-05, "vf_loss": 6.535227823257446, "vf_explained_var": -1.045068105061849e-06, "kl": 0.00016077786298348922, "entropy": 0.4262048651774724, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3465.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.912999999999807, "episode_len_mean": 276.46, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.50000000000002, 43.10000000000001, 40.500000000000014, 45.5, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 47.5, 40.30000000000002, 45.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.70000000000003, 44.7, -50.00000000000044, 44.10000000000001, 44.5, -50.00000000000044, 22.099999999999874, -50.00000000000044, 45.9, 38.50000000000003, 46.099999999999994, 28.09999999999996, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 38.90000000000002, -50.00000000000044, 23.699999999999896, -50.00000000000044, 42.900000000000006, -50.00000000000044, 20.899999999999856, 43.900000000000006, 47.1, 42.70000000000001, 15.299999999999777, 43.30000000000001, -50.00000000000044, 43.900000000000006, 9.8999999999997, 46.9, 33.90000000000004, 31.500000000000007, -50.00000000000044, 8.299999999999677, 47.5, 42.900000000000006, -50.00000000000044, 32.50000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.10000000000001, -50.00000000000044, 36.900000000000034, 31.900000000000013, -50.00000000000044, 47.3, 27.699999999999953, -50.00000000000044, 46.699999999999996, 47.3, -50.00000000000044, 43.900000000000006, 39.70000000000002, 46.9], "episode_lengths": [500, 106, 70, 96, 46, 500, 298, 500, 500, 44, 76, 500, 26, 98, 42, 500, 60, 500, 500, 500, 226, 106, 500, 500, 500, 186, 500, 500, 58, 500, 134, 54, 500, 60, 56, 500, 280, 500, 42, 116, 40, 220, 500, 500, 372, 500, 500, 166, 500, 112, 500, 264, 500, 72, 500, 292, 62, 30, 74, 348, 68, 500, 62, 402, 32, 162, 186, 500, 418, 26, 72, 500, 176, 500, 82, 500, 38, 500, 500, 74, 500, 52, 500, 500, 500, 68, 70, 500, 132, 182, 500, 28, 224, 500, 34, 28, 500, 62, 104, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37368965704545204, "mean_inference_ms": 1.195685325471005, "mean_action_processing_ms": 0.13964529852657226, "mean_env_wait_ms": 0.08148913494919183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028001070022583008, "StateBufferConnector_ms": 0.002000093460083008, "ViewRequirementAgentConnector_ms": 0.12479043006896973}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.912999999999807, "episode_len_mean": 276.46, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.50000000000002, 43.10000000000001, 40.500000000000014, 45.5, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 47.5, 40.30000000000002, 45.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.70000000000003, 44.7, -50.00000000000044, 44.10000000000001, 44.5, -50.00000000000044, 22.099999999999874, -50.00000000000044, 45.9, 38.50000000000003, 46.099999999999994, 28.09999999999996, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 38.90000000000002, -50.00000000000044, 23.699999999999896, -50.00000000000044, 42.900000000000006, -50.00000000000044, 20.899999999999856, 43.900000000000006, 47.1, 42.70000000000001, 15.299999999999777, 43.30000000000001, -50.00000000000044, 43.900000000000006, 9.8999999999997, 46.9, 33.90000000000004, 31.500000000000007, -50.00000000000044, 8.299999999999677, 47.5, 42.900000000000006, -50.00000000000044, 32.50000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.10000000000001, -50.00000000000044, 36.900000000000034, 31.900000000000013, -50.00000000000044, 47.3, 27.699999999999953, -50.00000000000044, 46.699999999999996, 47.3, -50.00000000000044, 43.900000000000006, 39.70000000000002, 46.9], "episode_lengths": [500, 106, 70, 96, 46, 500, 298, 500, 500, 44, 76, 500, 26, 98, 42, 500, 60, 500, 500, 500, 226, 106, 500, 500, 500, 186, 500, 500, 58, 500, 134, 54, 500, 60, 56, 500, 280, 500, 42, 116, 40, 220, 500, 500, 372, 500, 500, 166, 500, 112, 500, 264, 500, 72, 500, 292, 62, 30, 74, 348, 68, 500, 62, 402, 32, 162, 186, 500, 418, 26, 72, 500, 176, 500, 82, 500, 38, 500, 500, 74, 500, 52, 500, 500, 500, 68, 70, 500, 132, 182, 500, 28, 224, 500, 34, 28, 500, 62, 104, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37368965704545204, "mean_inference_ms": 1.195685325471005, "mean_action_processing_ms": 0.13964529852657226, "mean_env_wait_ms": 0.08148913494919183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028001070022583008, "StateBufferConnector_ms": 0.002000093460083008, "ViewRequirementAgentConnector_ms": 0.12479043006896973}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4863.356336490723, "num_env_steps_trained_throughput_per_sec": 4863.356336490723, "timesteps_total": 1392000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 2322.776, "sample_time_ms": 1933.561, "load_time_ms": 12.709, "load_throughput": 944175.735, "learn_time_ms": 366.158, "learn_throughput": 32772.728, "synch_weights_time_ms": 9.326}, "counters": {"num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "episodes_total": 5211, "training_iteration": 116, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-48", "timestamp": 1698247248, "time_this_iter_s": 2.4722015857696533, "time_total_s": 262.99947595596313, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 262.99947595596313, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 57.03333333333334, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4074124304840456e-36, "cur_lr": 0.0003, "total_loss": 6.6903276443481445, "policy_loss": -0.0007231218119462331, "vf_loss": 6.691095701853434, "vf_explained_var": -1.0927518208821614e-06, "kl": 0.000824197077105282, "entropy": 0.4497060755888621, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3495.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.32599999999985, "episode_len_mean": 227.42, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 47.1, 42.70000000000001, 15.299999999999777, 43.30000000000001, -50.00000000000044, 43.900000000000006, 9.8999999999997, 46.9, 33.90000000000004, 31.500000000000007, -50.00000000000044, 8.299999999999677, 47.5, 42.900000000000006, -50.00000000000044, 32.50000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.10000000000001, -50.00000000000044, 36.900000000000034, 31.900000000000013, -50.00000000000044, 47.3, 27.699999999999953, -50.00000000000044, 46.699999999999996, 47.3, -50.00000000000044, 43.900000000000006, 39.70000000000002, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.9, 44.10000000000001, 46.099999999999994, 42.30000000000001, 47.5, 25.29999999999992, 46.699999999999996, 45.7, 11.699999999999726, 43.50000000000001, 47.3, 47.1, 44.10000000000001, -50.00000000000044, 37.50000000000003, 37.10000000000003, -50.00000000000044, 40.70000000000002, 45.3, 46.9, 43.30000000000001, 43.900000000000006, 43.50000000000001, 44.900000000000006, 43.30000000000001, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 16.09999999999979, 47.5, -50.00000000000044, -50.00000000000044, 47.7, 46.3, 47.5, 46.3, 43.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 31.70000000000001, 42.70000000000001, 34.900000000000034, 47.1, 43.50000000000001], "episode_lengths": [62, 30, 74, 348, 68, 500, 62, 402, 32, 162, 186, 500, 418, 26, 72, 500, 176, 500, 82, 500, 38, 500, 500, 74, 500, 52, 500, 500, 500, 68, 70, 500, 132, 182, 500, 28, 224, 500, 34, 28, 500, 62, 104, 32, 500, 500, 500, 500, 26, 42, 60, 40, 78, 26, 248, 34, 44, 384, 66, 28, 30, 60, 500, 126, 130, 500, 94, 48, 32, 68, 62, 66, 52, 68, 500, 280, 500, 500, 500, 500, 500, 80, 340, 26, 500, 500, 24, 38, 26, 38, 70, 500, 74, 500, 500, 184, 74, 152, 30, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3736373319723954, "mean_inference_ms": 1.195500597994653, "mean_action_processing_ms": 0.1398549841198896, "mean_env_wait_ms": 0.08125362720945722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022994518280029297, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.11841273307800293}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.32599999999985, "episode_len_mean": 227.42, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 47.1, 42.70000000000001, 15.299999999999777, 43.30000000000001, -50.00000000000044, 43.900000000000006, 9.8999999999997, 46.9, 33.90000000000004, 31.500000000000007, -50.00000000000044, 8.299999999999677, 47.5, 42.900000000000006, -50.00000000000044, 32.50000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.10000000000001, -50.00000000000044, 36.900000000000034, 31.900000000000013, -50.00000000000044, 47.3, 27.699999999999953, -50.00000000000044, 46.699999999999996, 47.3, -50.00000000000044, 43.900000000000006, 39.70000000000002, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.9, 44.10000000000001, 46.099999999999994, 42.30000000000001, 47.5, 25.29999999999992, 46.699999999999996, 45.7, 11.699999999999726, 43.50000000000001, 47.3, 47.1, 44.10000000000001, -50.00000000000044, 37.50000000000003, 37.10000000000003, -50.00000000000044, 40.70000000000002, 45.3, 46.9, 43.30000000000001, 43.900000000000006, 43.50000000000001, 44.900000000000006, 43.30000000000001, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 16.09999999999979, 47.5, -50.00000000000044, -50.00000000000044, 47.7, 46.3, 47.5, 46.3, 43.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 31.70000000000001, 42.70000000000001, 34.900000000000034, 47.1, 43.50000000000001], "episode_lengths": [62, 30, 74, 348, 68, 500, 62, 402, 32, 162, 186, 500, 418, 26, 72, 500, 176, 500, 82, 500, 38, 500, 500, 74, 500, 52, 500, 500, 500, 68, 70, 500, 132, 182, 500, 28, 224, 500, 34, 28, 500, 62, 104, 32, 500, 500, 500, 500, 26, 42, 60, 40, 78, 26, 248, 34, 44, 384, 66, 28, 30, 60, 500, 126, 130, 500, 94, 48, 32, 68, 62, 66, 52, 68, 500, 280, 500, 500, 500, 500, 500, 80, 340, 26, 500, 500, 24, 38, 26, 38, 70, 500, 74, 500, 500, 184, 74, 152, 30, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3736373319723954, "mean_inference_ms": 1.195500597994653, "mean_action_processing_ms": 0.1398549841198896, "mean_env_wait_ms": 0.08125362720945722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022994518280029297, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.11841273307800293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4492.389384669913, "num_env_steps_trained_throughput_per_sec": 4492.389384669913, "timesteps_total": 1404000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 2349.02, "sample_time_ms": 1961.901, "load_time_ms": 13.165, "load_throughput": 911534.399, "learn_time_ms": 363.577, "learn_throughput": 33005.416, "synch_weights_time_ms": 9.356}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5267, "training_iteration": 117, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-51", "timestamp": 1698247251, "time_this_iter_s": 2.6759276390075684, "time_total_s": 265.6754035949707, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 265.6754035949707, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 46.875, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2037062152420228e-36, "cur_lr": 0.0003, "total_loss": 5.746149667104086, "policy_loss": -0.00038603097200393675, "vf_loss": 5.7465765635172525, "vf_explained_var": -9.258588155110677e-07, "kl": 0.0007805115475169563, "entropy": 0.4086632072925568, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3525.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.767999999999837, "episode_len_mean": 232.96, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, 39.70000000000002, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.9, 44.10000000000001, 46.099999999999994, 42.30000000000001, 47.5, 25.29999999999992, 46.699999999999996, 45.7, 11.699999999999726, 43.50000000000001, 47.3, 47.1, 44.10000000000001, -50.00000000000044, 37.50000000000003, 37.10000000000003, -50.00000000000044, 40.70000000000002, 45.3, 46.9, 43.30000000000001, 43.900000000000006, 43.50000000000001, 44.900000000000006, 43.30000000000001, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 16.09999999999979, 47.5, -50.00000000000044, -50.00000000000044, 47.7, 46.3, 47.5, 46.3, 43.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 31.70000000000001, 42.70000000000001, 34.900000000000034, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 47.3, 45.1, -50.00000000000044, 46.3, 46.699999999999996, 46.699999999999996, 42.30000000000001, -50.00000000000044, 36.30000000000003, 28.29999999999996, 40.90000000000002, -50.00000000000044, 38.300000000000026, 43.50000000000001, 42.10000000000001, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 35.70000000000003, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044], "episode_lengths": [500, 62, 104, 32, 500, 500, 500, 500, 26, 42, 60, 40, 78, 26, 248, 34, 44, 384, 66, 28, 30, 60, 500, 126, 130, 500, 94, 48, 32, 68, 62, 66, 52, 68, 500, 280, 500, 500, 500, 500, 500, 80, 340, 26, 500, 500, 24, 38, 26, 38, 70, 500, 74, 500, 500, 184, 74, 152, 30, 66, 500, 500, 28, 50, 500, 38, 34, 34, 78, 500, 138, 218, 92, 500, 118, 66, 80, 36, 500, 500, 42, 500, 70, 500, 40, 500, 84, 500, 500, 52, 46, 500, 500, 500, 170, 144, 500, 500, 26, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37334775810528176, "mean_inference_ms": 1.19557059900665, "mean_action_processing_ms": 0.13966617747016052, "mean_env_wait_ms": 0.08125880131125245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024002552032470703, "StateBufferConnector_ms": 0.0050029754638671875, "ViewRequirementAgentConnector_ms": 0.13340020179748535}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.767999999999837, "episode_len_mean": 232.96, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, 39.70000000000002, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.9, 44.10000000000001, 46.099999999999994, 42.30000000000001, 47.5, 25.29999999999992, 46.699999999999996, 45.7, 11.699999999999726, 43.50000000000001, 47.3, 47.1, 44.10000000000001, -50.00000000000044, 37.50000000000003, 37.10000000000003, -50.00000000000044, 40.70000000000002, 45.3, 46.9, 43.30000000000001, 43.900000000000006, 43.50000000000001, 44.900000000000006, 43.30000000000001, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 16.09999999999979, 47.5, -50.00000000000044, -50.00000000000044, 47.7, 46.3, 47.5, 46.3, 43.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 31.70000000000001, 42.70000000000001, 34.900000000000034, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 47.3, 45.1, -50.00000000000044, 46.3, 46.699999999999996, 46.699999999999996, 42.30000000000001, -50.00000000000044, 36.30000000000003, 28.29999999999996, 40.90000000000002, -50.00000000000044, 38.300000000000026, 43.50000000000001, 42.10000000000001, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 35.70000000000003, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044], "episode_lengths": [500, 62, 104, 32, 500, 500, 500, 500, 26, 42, 60, 40, 78, 26, 248, 34, 44, 384, 66, 28, 30, 60, 500, 126, 130, 500, 94, 48, 32, 68, 62, 66, 52, 68, 500, 280, 500, 500, 500, 500, 500, 80, 340, 26, 500, 500, 24, 38, 26, 38, 70, 500, 74, 500, 500, 184, 74, 152, 30, 66, 500, 500, 28, 50, 500, 38, 34, 34, 78, 500, 138, 218, 92, 500, 118, 66, 80, 36, 500, 500, 42, 500, 70, 500, 40, 500, 84, 500, 500, 52, 46, 500, 500, 500, 170, 144, 500, 500, 26, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37334775810528176, "mean_inference_ms": 1.19557059900665, "mean_action_processing_ms": 0.13966617747016052, "mean_env_wait_ms": 0.08125880131125245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024002552032470703, "StateBufferConnector_ms": 0.0050029754638671875, "ViewRequirementAgentConnector_ms": 0.13340020179748535}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5468.061612270307, "num_env_steps_trained_throughput_per_sec": 5468.061612270307, "timesteps_total": 1416000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 2343.246, "sample_time_ms": 1956.032, "load_time_ms": 13.364, "load_throughput": 897955.234, "learn_time_ms": 363.486, "learn_throughput": 33013.666, "synch_weights_time_ms": 9.361}, "counters": {"num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "episodes_total": 5307, "training_iteration": 118, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-53", "timestamp": 1698247253, "time_this_iter_s": 2.199558973312378, "time_total_s": 267.8749625682831, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 267.8749625682831, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 54.1, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.018531076210114e-37, "cur_lr": 0.0003, "total_loss": 6.97907198270162, "policy_loss": 2.7522196372350057e-05, "vf_loss": 6.9790884812672935, "vf_explained_var": -1.1006991068522134e-06, "kl": 8.797239492347823e-05, "entropy": 0.44113147258758545, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3555.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.885999999999828, "episode_len_mean": 241.78, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 47.3, 45.1, -50.00000000000044, 46.3, 46.699999999999996, 46.699999999999996, 42.30000000000001, -50.00000000000044, 36.30000000000003, 28.29999999999996, 40.90000000000002, -50.00000000000044, 38.300000000000026, 43.50000000000001, 42.10000000000001, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 35.70000000000003, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 4.099999999999618, 43.10000000000001, 46.9, 47.3, 46.699999999999996, -50.00000000000044, 47.5, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.5, 44.7, 45.1, 42.70000000000001, 44.7, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, 46.5, 42.500000000000014, 32.90000000000003, 37.10000000000003, 33.90000000000004, 1.4999999999995808, 36.900000000000034, -50.00000000000044, 44.900000000000006, 18.099999999999817, 47.1, 47.3, 45.7, 45.9, 21.299999999999862, 45.1, -50.00000000000044, 47.7, -50.00000000000044, 47.1, 47.1, -50.00000000000044, 46.699999999999996, 43.30000000000001, -50.00000000000044, 36.70000000000003, 46.9, 5.6999999999996405, 42.500000000000014, -50.00000000000044], "episode_lengths": [30, 66, 500, 500, 28, 50, 500, 38, 34, 34, 78, 500, 138, 218, 92, 500, 118, 66, 80, 36, 500, 500, 42, 500, 70, 500, 40, 500, 84, 500, 500, 52, 46, 500, 500, 500, 170, 144, 500, 500, 26, 500, 500, 460, 70, 32, 28, 34, 500, 26, 500, 92, 500, 500, 34, 500, 52, 500, 56, 54, 50, 74, 54, 500, 48, 500, 500, 500, 500, 314, 36, 76, 172, 130, 162, 486, 132, 500, 52, 320, 30, 28, 44, 42, 288, 50, 500, 24, 500, 30, 30, 500, 34, 68, 500, 134, 32, 444, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3730992039301264, "mean_inference_ms": 1.1959048884602228, "mean_action_processing_ms": 0.13934099852020482, "mean_env_wait_ms": 0.08119115702716244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701401710510254, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.126997709274292}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.885999999999828, "episode_len_mean": 241.78, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 47.3, 45.1, -50.00000000000044, 46.3, 46.699999999999996, 46.699999999999996, 42.30000000000001, -50.00000000000044, 36.30000000000003, 28.29999999999996, 40.90000000000002, -50.00000000000044, 38.300000000000026, 43.50000000000001, 42.10000000000001, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 35.70000000000003, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 4.099999999999618, 43.10000000000001, 46.9, 47.3, 46.699999999999996, -50.00000000000044, 47.5, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.5, 44.7, 45.1, 42.70000000000001, 44.7, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, 46.5, 42.500000000000014, 32.90000000000003, 37.10000000000003, 33.90000000000004, 1.4999999999995808, 36.900000000000034, -50.00000000000044, 44.900000000000006, 18.099999999999817, 47.1, 47.3, 45.7, 45.9, 21.299999999999862, 45.1, -50.00000000000044, 47.7, -50.00000000000044, 47.1, 47.1, -50.00000000000044, 46.699999999999996, 43.30000000000001, -50.00000000000044, 36.70000000000003, 46.9, 5.6999999999996405, 42.500000000000014, -50.00000000000044], "episode_lengths": [30, 66, 500, 500, 28, 50, 500, 38, 34, 34, 78, 500, 138, 218, 92, 500, 118, 66, 80, 36, 500, 500, 42, 500, 70, 500, 40, 500, 84, 500, 500, 52, 46, 500, 500, 500, 170, 144, 500, 500, 26, 500, 500, 460, 70, 32, 28, 34, 500, 26, 500, 92, 500, 500, 34, 500, 52, 500, 56, 54, 50, 74, 54, 500, 48, 500, 500, 500, 500, 314, 36, 76, 172, 130, 162, 486, 132, 500, 52, 320, 30, 28, 44, 42, 288, 50, 500, 24, 500, 30, 30, 500, 34, 68, 500, 134, 32, 444, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3730992039301264, "mean_inference_ms": 1.1959048884602228, "mean_action_processing_ms": 0.13934099852020482, "mean_env_wait_ms": 0.08119115702716244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701401710510254, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.126997709274292}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5021.538432068232, "num_env_steps_trained_throughput_per_sec": 5021.538432068232, "timesteps_total": 1428000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 2339.816, "sample_time_ms": 1955.399, "load_time_ms": 13.74, "load_throughput": 873361.49, "learn_time_ms": 360.496, "learn_throughput": 33287.442, "synch_weights_time_ms": 9.33}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "episodes_total": 5365, "training_iteration": 119, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-55", "timestamp": 1698247255, "time_this_iter_s": 2.3936774730682373, "time_total_s": 270.2686400413513, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 270.2686400413513, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 51.85, "ram_util_percent": 26.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.009265538105057e-37, "cur_lr": 0.0003, "total_loss": 6.936299753189087, "policy_loss": -0.0005194843746721744, "vf_loss": 6.9368632157643635, "vf_explained_var": -1.0013580322265625e-06, "kl": 0.0010814883048340107, "entropy": 0.4398700088262558, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3585.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.93999999999985, "episode_len_mean": 221.3, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, -50.00000000000044, 44.5, 44.7, 45.1, 42.70000000000001, 44.7, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, 46.5, 42.500000000000014, 32.90000000000003, 37.10000000000003, 33.90000000000004, 1.4999999999995808, 36.900000000000034, -50.00000000000044, 44.900000000000006, 18.099999999999817, 47.1, 47.3, 45.7, 45.9, 21.299999999999862, 45.1, -50.00000000000044, 47.7, -50.00000000000044, 47.1, 47.1, -50.00000000000044, 46.699999999999996, 43.30000000000001, -50.00000000000044, 36.70000000000003, 46.9, 5.6999999999996405, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, 45.3, -50.00000000000044, 30.099999999999987, 46.9, 41.100000000000016, 44.300000000000004, 42.70000000000001, 23.699999999999896, -50.00000000000044, 41.90000000000001, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 31.500000000000007, 47.7, -50.00000000000044, 43.30000000000001, 46.099999999999994, -50.00000000000044, 45.7, 43.30000000000001, 46.3, -50.00000000000044, 45.5, 47.3, 45.3, 45.1, 42.500000000000014, 41.90000000000001, 38.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, 18.899999999999828, 34.900000000000034, 38.300000000000026, 7.09999999999966, -50.00000000000044, -50.00000000000044, 45.9, 44.5, -50.00000000000044, -50.00000000000044, 47.1, 30.29999999999999, 42.10000000000001, 46.699999999999996], "episode_lengths": [500, 52, 500, 56, 54, 50, 74, 54, 500, 48, 500, 500, 500, 500, 314, 36, 76, 172, 130, 162, 486, 132, 500, 52, 320, 30, 28, 44, 42, 288, 50, 500, 24, 500, 30, 30, 500, 34, 68, 500, 134, 32, 444, 76, 500, 500, 90, 500, 500, 500, 38, 40, 48, 500, 200, 32, 90, 58, 74, 264, 500, 82, 32, 500, 500, 42, 186, 24, 500, 68, 40, 500, 44, 68, 38, 500, 46, 28, 48, 50, 76, 82, 112, 56, 500, 500, 312, 152, 118, 430, 500, 500, 42, 56, 500, 500, 30, 198, 80, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3734474543647897, "mean_inference_ms": 1.1956741344725357, "mean_action_processing_ms": 0.13957414733409512, "mean_env_wait_ms": 0.08136737019521666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030008554458618164, "StateBufferConnector_ms": 0.0019986629486083984, "ViewRequirementAgentConnector_ms": 0.11100506782531738}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.93999999999985, "episode_len_mean": 221.3, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, -50.00000000000044, 44.5, 44.7, 45.1, 42.70000000000001, 44.7, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, 46.5, 42.500000000000014, 32.90000000000003, 37.10000000000003, 33.90000000000004, 1.4999999999995808, 36.900000000000034, -50.00000000000044, 44.900000000000006, 18.099999999999817, 47.1, 47.3, 45.7, 45.9, 21.299999999999862, 45.1, -50.00000000000044, 47.7, -50.00000000000044, 47.1, 47.1, -50.00000000000044, 46.699999999999996, 43.30000000000001, -50.00000000000044, 36.70000000000003, 46.9, 5.6999999999996405, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, 45.3, -50.00000000000044, 30.099999999999987, 46.9, 41.100000000000016, 44.300000000000004, 42.70000000000001, 23.699999999999896, -50.00000000000044, 41.90000000000001, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 31.500000000000007, 47.7, -50.00000000000044, 43.30000000000001, 46.099999999999994, -50.00000000000044, 45.7, 43.30000000000001, 46.3, -50.00000000000044, 45.5, 47.3, 45.3, 45.1, 42.500000000000014, 41.90000000000001, 38.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, 18.899999999999828, 34.900000000000034, 38.300000000000026, 7.09999999999966, -50.00000000000044, -50.00000000000044, 45.9, 44.5, -50.00000000000044, -50.00000000000044, 47.1, 30.29999999999999, 42.10000000000001, 46.699999999999996], "episode_lengths": [500, 52, 500, 56, 54, 50, 74, 54, 500, 48, 500, 500, 500, 500, 314, 36, 76, 172, 130, 162, 486, 132, 500, 52, 320, 30, 28, 44, 42, 288, 50, 500, 24, 500, 30, 30, 500, 34, 68, 500, 134, 32, 444, 76, 500, 500, 90, 500, 500, 500, 38, 40, 48, 500, 200, 32, 90, 58, 74, 264, 500, 82, 32, 500, 500, 42, 186, 24, 500, 68, 40, 500, 44, 68, 38, 500, 46, 28, 48, 50, 76, 82, 112, 56, 500, 500, 312, 152, 118, 430, 500, 500, 42, 56, 500, 500, 30, 198, 80, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3734474543647897, "mean_inference_ms": 1.1956741344725357, "mean_action_processing_ms": 0.13957414733409512, "mean_env_wait_ms": 0.08136737019521666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030008554458618164, "StateBufferConnector_ms": 0.0019986629486083984, "ViewRequirementAgentConnector_ms": 0.11100506782531738}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5672.981846150794, "num_env_steps_trained_throughput_per_sec": 5672.981846150794, "timesteps_total": 1440000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 2325.993, "sample_time_ms": 1952.033, "load_time_ms": 13.339, "load_throughput": 899605.138, "learn_time_ms": 350.476, "learn_throughput": 34239.13, "synch_weights_time_ms": 9.293}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5420, "training_iteration": 120, "trial_id": "9f288_00009", "date": "2023-10-25_16-20-57", "timestamp": 1698247257, "time_this_iter_s": 2.1201722621917725, "time_total_s": 272.3888123035431, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 272.3888123035431, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 61.29999999999999, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5046327690525285e-37, "cur_lr": 0.0003, "total_loss": 6.406279023488363, "policy_loss": -0.0006349024673302969, "vf_loss": 6.406955655415853, "vf_explained_var": -8.384386698404948e-07, "kl": 0.0007282377554849025, "entropy": 0.4166793912649155, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3615.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.881999999999834, "episode_len_mean": 241.84, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, 45.3, -50.00000000000044, 30.099999999999987, 46.9, 41.100000000000016, 44.300000000000004, 42.70000000000001, 23.699999999999896, -50.00000000000044, 41.90000000000001, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 31.500000000000007, 47.7, -50.00000000000044, 43.30000000000001, 46.099999999999994, -50.00000000000044, 45.7, 43.30000000000001, 46.3, -50.00000000000044, 45.5, 47.3, 45.3, 45.1, 42.500000000000014, 41.90000000000001, 38.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, 18.899999999999828, 34.900000000000034, 38.300000000000026, 7.09999999999966, -50.00000000000044, -50.00000000000044, 45.9, 44.5, -50.00000000000044, -50.00000000000044, 47.1, 30.29999999999999, 42.10000000000001, 46.699999999999996, 34.30000000000004, 44.10000000000001, -50.00000000000044, 43.900000000000006, 26.09999999999993, 46.9, -50.00000000000044, 43.50000000000001, 37.90000000000003, -50.00000000000044, 45.9, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.10000000000001, 45.5, 45.1, 37.10000000000003, -50.00000000000044, 45.3, 47.7, 46.099999999999994, 28.699999999999967, -50.00000000000044, -50.00000000000044, 12.099999999999731, 46.5, 3.699999999999612, 44.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 10.699999999999712, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 8.699999999999683], "episode_lengths": [500, 500, 90, 500, 500, 500, 38, 40, 48, 500, 200, 32, 90, 58, 74, 264, 500, 82, 32, 500, 500, 42, 186, 24, 500, 68, 40, 500, 44, 68, 38, 500, 46, 28, 48, 50, 76, 82, 112, 56, 500, 500, 312, 152, 118, 430, 500, 500, 42, 56, 500, 500, 30, 198, 80, 34, 158, 60, 500, 62, 240, 32, 500, 66, 122, 500, 42, 62, 102, 500, 500, 500, 84, 80, 46, 50, 130, 500, 48, 24, 40, 214, 500, 500, 380, 36, 464, 54, 500, 122, 500, 500, 394, 96, 500, 500, 54, 500, 500, 414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37363228220458455, "mean_inference_ms": 1.1959573472909024, "mean_action_processing_ms": 0.1395096736868136, "mean_env_wait_ms": 0.08157708521533641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600168228149414, "StateBufferConnector_ms": 0.0019986629486083984, "ViewRequirementAgentConnector_ms": 0.10199499130249023}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.881999999999834, "episode_len_mean": 241.84, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, 45.3, -50.00000000000044, 30.099999999999987, 46.9, 41.100000000000016, 44.300000000000004, 42.70000000000001, 23.699999999999896, -50.00000000000044, 41.90000000000001, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 31.500000000000007, 47.7, -50.00000000000044, 43.30000000000001, 46.099999999999994, -50.00000000000044, 45.7, 43.30000000000001, 46.3, -50.00000000000044, 45.5, 47.3, 45.3, 45.1, 42.500000000000014, 41.90000000000001, 38.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, 18.899999999999828, 34.900000000000034, 38.300000000000026, 7.09999999999966, -50.00000000000044, -50.00000000000044, 45.9, 44.5, -50.00000000000044, -50.00000000000044, 47.1, 30.29999999999999, 42.10000000000001, 46.699999999999996, 34.30000000000004, 44.10000000000001, -50.00000000000044, 43.900000000000006, 26.09999999999993, 46.9, -50.00000000000044, 43.50000000000001, 37.90000000000003, -50.00000000000044, 45.9, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.10000000000001, 45.5, 45.1, 37.10000000000003, -50.00000000000044, 45.3, 47.7, 46.099999999999994, 28.699999999999967, -50.00000000000044, -50.00000000000044, 12.099999999999731, 46.5, 3.699999999999612, 44.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 10.699999999999712, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 8.699999999999683], "episode_lengths": [500, 500, 90, 500, 500, 500, 38, 40, 48, 500, 200, 32, 90, 58, 74, 264, 500, 82, 32, 500, 500, 42, 186, 24, 500, 68, 40, 500, 44, 68, 38, 500, 46, 28, 48, 50, 76, 82, 112, 56, 500, 500, 312, 152, 118, 430, 500, 500, 42, 56, 500, 500, 30, 198, 80, 34, 158, 60, 500, 62, 240, 32, 500, 66, 122, 500, 42, 62, 102, 500, 500, 500, 84, 80, 46, 50, 130, 500, 48, 24, 40, 214, 500, 500, 380, 36, 464, 54, 500, 122, 500, 500, 394, 96, 500, 500, 54, 500, 500, 414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37363228220458455, "mean_inference_ms": 1.1959573472909024, "mean_action_processing_ms": 0.1395096736868136, "mean_env_wait_ms": 0.08157708521533641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600168228149414, "StateBufferConnector_ms": 0.0019986629486083984, "ViewRequirementAgentConnector_ms": 0.10199499130249023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5318.977952696991, "num_env_steps_trained_throughput_per_sec": 5318.977952696991, "timesteps_total": 1452000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 2320.369, "sample_time_ms": 1959.477, "load_time_ms": 12.439, "load_throughput": 964738.237, "learn_time_ms": 338.331, "learn_throughput": 35468.189, "synch_weights_time_ms": 9.271}, "counters": {"num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "episodes_total": 5464, "training_iteration": 121, "trial_id": "9f288_00009", "date": "2023-10-25_16-21-00", "timestamp": 1698247260, "time_this_iter_s": 2.2601051330566406, "time_total_s": 274.64891743659973, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 274.64891743659973, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 64.39999999999999, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.523163845262643e-38, "cur_lr": 0.0003, "total_loss": 6.162499682108561, "policy_loss": -0.0004079366723696391, "vf_loss": 6.1629528840382894, "vf_explained_var": -9.338061014811198e-07, "kl": 0.0006606271974921659, "entropy": 0.4527189493179321, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3645.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.02700000000020914, "episode_len_mean": 285.84, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 45.1, 42.500000000000014, 41.90000000000001, 38.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, 18.899999999999828, 34.900000000000034, 38.300000000000026, 7.09999999999966, -50.00000000000044, -50.00000000000044, 45.9, 44.5, -50.00000000000044, -50.00000000000044, 47.1, 30.29999999999999, 42.10000000000001, 46.699999999999996, 34.30000000000004, 44.10000000000001, -50.00000000000044, 43.900000000000006, 26.09999999999993, 46.9, -50.00000000000044, 43.50000000000001, 37.90000000000003, -50.00000000000044, 45.9, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.10000000000001, 45.5, 45.1, 37.10000000000003, -50.00000000000044, 45.3, 47.7, 46.099999999999994, 28.699999999999967, -50.00000000000044, -50.00000000000044, 12.099999999999731, 46.5, 3.699999999999612, 44.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 10.699999999999712, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.9, 40.90000000000002, -50.00000000000044, 44.300000000000004, 42.10000000000001, -50.00000000000044, 40.30000000000002, 45.5], "episode_lengths": [48, 50, 76, 82, 112, 56, 500, 500, 312, 152, 118, 430, 500, 500, 42, 56, 500, 500, 30, 198, 80, 34, 158, 60, 500, 62, 240, 32, 500, 66, 122, 500, 42, 62, 102, 500, 500, 500, 84, 80, 46, 50, 130, 500, 48, 24, 40, 214, 500, 500, 380, 36, 464, 54, 500, 122, 500, 500, 394, 96, 500, 500, 54, 500, 500, 414, 500, 232, 500, 500, 468, 500, 28, 500, 500, 500, 500, 500, 500, 50, 500, 500, 500, 500, 500, 182, 124, 500, 500, 42, 500, 500, 32, 92, 500, 58, 80, 500, 98, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3736750321651604, "mean_inference_ms": 1.196072940911503, "mean_action_processing_ms": 0.13991070657942753, "mean_env_wait_ms": 0.08166271793363482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100275993347168, "StateBufferConnector_ms": 0.002813577651977539, "ViewRequirementAgentConnector_ms": 0.09699773788452148}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.02700000000020914, "episode_len_mean": 285.84, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 45.1, 42.500000000000014, 41.90000000000001, 38.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, 18.899999999999828, 34.900000000000034, 38.300000000000026, 7.09999999999966, -50.00000000000044, -50.00000000000044, 45.9, 44.5, -50.00000000000044, -50.00000000000044, 47.1, 30.29999999999999, 42.10000000000001, 46.699999999999996, 34.30000000000004, 44.10000000000001, -50.00000000000044, 43.900000000000006, 26.09999999999993, 46.9, -50.00000000000044, 43.50000000000001, 37.90000000000003, -50.00000000000044, 45.9, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.10000000000001, 45.5, 45.1, 37.10000000000003, -50.00000000000044, 45.3, 47.7, 46.099999999999994, 28.699999999999967, -50.00000000000044, -50.00000000000044, 12.099999999999731, 46.5, 3.699999999999612, 44.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 10.699999999999712, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.9, 40.90000000000002, -50.00000000000044, 44.300000000000004, 42.10000000000001, -50.00000000000044, 40.30000000000002, 45.5], "episode_lengths": [48, 50, 76, 82, 112, 56, 500, 500, 312, 152, 118, 430, 500, 500, 42, 56, 500, 500, 30, 198, 80, 34, 158, 60, 500, 62, 240, 32, 500, 66, 122, 500, 42, 62, 102, 500, 500, 500, 84, 80, 46, 50, 130, 500, 48, 24, 40, 214, 500, 500, 380, 36, 464, 54, 500, 122, 500, 500, 394, 96, 500, 500, 54, 500, 500, 414, 500, 232, 500, 500, 468, 500, 28, 500, 500, 500, 500, 500, 500, 50, 500, 500, 500, 500, 500, 182, 124, 500, 500, 42, 500, 500, 32, 92, 500, 58, 80, 500, 98, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3736750321651604, "mean_inference_ms": 1.196072940911503, "mean_action_processing_ms": 0.13991070657942753, "mean_env_wait_ms": 0.08166271793363482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100275993347168, "StateBufferConnector_ms": 0.002813577651977539, "ViewRequirementAgentConnector_ms": 0.09699773788452148}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5220.597835861812, "num_env_steps_trained_throughput_per_sec": 5220.597835861812, "timesteps_total": 1464000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 2329.684, "sample_time_ms": 1962.362, "load_time_ms": 13.038, "load_throughput": 920420.823, "learn_time_ms": 344.17, "learn_throughput": 34866.452, "synch_weights_time_ms": 9.288}, "counters": {"num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "episodes_total": 5498, "training_iteration": 122, "trial_id": "9f288_00009", "date": "2023-10-25_16-21-02", "timestamp": 1698247262, "time_this_iter_s": 2.303584098815918, "time_total_s": 276.95250153541565, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 276.95250153541565, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 62.133333333333326, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7615819226313213e-38, "cur_lr": 0.0003, "total_loss": 6.197530746459961, "policy_loss": -0.0005901721616586049, "vf_loss": 6.198169263203939, "vf_explained_var": -7.907549540201823e-07, "kl": 0.0007634147061025942, "entropy": 0.4833020369211833, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3675.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.2410000000002235, "episode_len_mean": 297.94, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 12.099999999999731, 46.5, 3.699999999999612, 44.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 10.699999999999712, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.9, 40.90000000000002, -50.00000000000044, 44.300000000000004, 42.10000000000001, -50.00000000000044, 40.30000000000002, 45.5, -50.00000000000044, 45.1, -50.00000000000044, 22.49999999999988, 43.10000000000001, 41.70000000000002, 45.1, 45.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 42.70000000000001, 47.1, 44.7, 46.9, 46.9, -50.00000000000044, 39.70000000000002, 37.70000000000003, 47.3, 35.900000000000034, 46.699999999999996, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 46.3, 44.900000000000006, 46.099999999999994, 31.500000000000007, 28.29999999999996, -50.00000000000044, 43.7, 41.500000000000014, -50.00000000000044, 34.50000000000004, -50.00000000000044, 42.30000000000001], "episode_lengths": [500, 380, 36, 464, 54, 500, 122, 500, 500, 394, 96, 500, 500, 54, 500, 500, 414, 500, 232, 500, 500, 468, 500, 28, 500, 500, 500, 500, 500, 500, 50, 500, 500, 500, 500, 500, 182, 124, 500, 500, 42, 500, 500, 32, 92, 500, 58, 80, 500, 98, 46, 500, 50, 500, 276, 70, 84, 50, 48, 72, 500, 500, 500, 76, 500, 500, 500, 50, 50, 500, 74, 30, 54, 32, 32, 500, 104, 124, 28, 142, 34, 500, 122, 500, 500, 500, 500, 228, 38, 52, 40, 186, 218, 500, 64, 86, 500, 156, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.373941765830207, "mean_inference_ms": 1.1965107809651974, "mean_action_processing_ms": 0.13966264269789147, "mean_env_wait_ms": 0.08184615029631065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025998353958129883, "StateBufferConnector_ms": 0.0038139820098876953, "ViewRequirementAgentConnector_ms": 0.10599064826965332}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.2410000000002235, "episode_len_mean": 297.94, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 12.099999999999731, 46.5, 3.699999999999612, 44.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 10.699999999999712, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.9, 40.90000000000002, -50.00000000000044, 44.300000000000004, 42.10000000000001, -50.00000000000044, 40.30000000000002, 45.5, -50.00000000000044, 45.1, -50.00000000000044, 22.49999999999988, 43.10000000000001, 41.70000000000002, 45.1, 45.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 42.70000000000001, 47.1, 44.7, 46.9, 46.9, -50.00000000000044, 39.70000000000002, 37.70000000000003, 47.3, 35.900000000000034, 46.699999999999996, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 46.3, 44.900000000000006, 46.099999999999994, 31.500000000000007, 28.29999999999996, -50.00000000000044, 43.7, 41.500000000000014, -50.00000000000044, 34.50000000000004, -50.00000000000044, 42.30000000000001], "episode_lengths": [500, 380, 36, 464, 54, 500, 122, 500, 500, 394, 96, 500, 500, 54, 500, 500, 414, 500, 232, 500, 500, 468, 500, 28, 500, 500, 500, 500, 500, 500, 50, 500, 500, 500, 500, 500, 182, 124, 500, 500, 42, 500, 500, 32, 92, 500, 58, 80, 500, 98, 46, 500, 50, 500, 276, 70, 84, 50, 48, 72, 500, 500, 500, 76, 500, 500, 500, 50, 50, 500, 74, 30, 54, 32, 32, 500, 104, 124, 28, 142, 34, 500, 122, 500, 500, 500, 500, 228, 38, 52, 40, 186, 218, 500, 64, 86, 500, 156, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.373941765830207, "mean_inference_ms": 1.1965107809651974, "mean_action_processing_ms": 0.13966264269789147, "mean_env_wait_ms": 0.08184615029631065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025998353958129883, "StateBufferConnector_ms": 0.0038139820098876953, "ViewRequirementAgentConnector_ms": 0.10599064826965332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5488.398355039221, "num_env_steps_trained_throughput_per_sec": 5488.398355039221, "timesteps_total": 1476000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 2315.136, "sample_time_ms": 1958.282, "load_time_ms": 12.444, "load_throughput": 964344.524, "learn_time_ms": 334.368, "learn_throughput": 35888.651, "synch_weights_time_ms": 9.288}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5547, "training_iteration": 123, "trial_id": "9f288_00009", "date": "2023-10-25_16-21-04", "timestamp": 1698247264, "time_this_iter_s": 2.191429615020752, "time_total_s": 279.1439311504364, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 279.1439311504364, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 57.13333333333333, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8807909613156606e-38, "cur_lr": 0.0003, "total_loss": 6.3974213123321535, "policy_loss": -0.0008681165985763073, "vf_loss": 6.398337761561076, "vf_explained_var": -1.045068105061849e-06, "kl": 0.0011242286884680652, "entropy": 0.4826682835817337, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3705.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.541999999999854, "episode_len_mean": 215.26, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 42.70000000000001, 47.1, 44.7, 46.9, 46.9, -50.00000000000044, 39.70000000000002, 37.70000000000003, 47.3, 35.900000000000034, 46.699999999999996, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 46.3, 44.900000000000006, 46.099999999999994, 31.500000000000007, 28.29999999999996, -50.00000000000044, 43.7, 41.500000000000014, -50.00000000000044, 34.50000000000004, -50.00000000000044, 42.30000000000001, 40.70000000000002, -50.00000000000044, 46.3, 46.099999999999994, 45.7, 46.9, 45.5, 46.099999999999994, 38.300000000000026, 44.7, -50.00000000000044, 39.70000000000002, 44.7, 41.30000000000001, 45.5, 26.89999999999994, -50.00000000000044, -50.00000000000044, 34.70000000000004, 34.70000000000004, 28.89999999999997, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.1, 44.10000000000001, 41.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 45.5, -50.00000000000044, 35.70000000000003, 47.5, 45.7, -50.00000000000044, 44.10000000000001, 45.1, 43.900000000000006, 47.1, 46.9, 45.1, 43.10000000000001, -50.00000000000044, 46.699999999999996, 42.900000000000006, 46.9, 42.500000000000014, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 3.899999999999615, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.1, 45.7], "episode_lengths": [500, 500, 76, 500, 500, 500, 50, 50, 500, 74, 30, 54, 32, 32, 500, 104, 124, 28, 142, 34, 500, 122, 500, 500, 500, 500, 228, 38, 52, 40, 186, 218, 500, 64, 86, 500, 156, 500, 78, 94, 500, 38, 40, 44, 32, 46, 40, 118, 54, 500, 104, 54, 88, 46, 232, 500, 500, 154, 154, 212, 500, 46, 500, 500, 50, 60, 88, 500, 38, 500, 46, 500, 144, 26, 44, 500, 60, 50, 62, 30, 32, 50, 70, 500, 34, 72, 32, 76, 500, 52, 500, 500, 36, 462, 44, 500, 80, 500, 50, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37369438407448624, "mean_inference_ms": 1.1969364770434516, "mean_action_processing_ms": 0.1395889674258502, "mean_env_wait_ms": 0.08152641759655328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030757904052734375, "StateBufferConnector_ms": 0.010000467300415039, "ViewRequirementAgentConnector_ms": 0.12801861763000488}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.541999999999854, "episode_len_mean": 215.26, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 42.70000000000001, 47.1, 44.7, 46.9, 46.9, -50.00000000000044, 39.70000000000002, 37.70000000000003, 47.3, 35.900000000000034, 46.699999999999996, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 46.3, 44.900000000000006, 46.099999999999994, 31.500000000000007, 28.29999999999996, -50.00000000000044, 43.7, 41.500000000000014, -50.00000000000044, 34.50000000000004, -50.00000000000044, 42.30000000000001, 40.70000000000002, -50.00000000000044, 46.3, 46.099999999999994, 45.7, 46.9, 45.5, 46.099999999999994, 38.300000000000026, 44.7, -50.00000000000044, 39.70000000000002, 44.7, 41.30000000000001, 45.5, 26.89999999999994, -50.00000000000044, -50.00000000000044, 34.70000000000004, 34.70000000000004, 28.89999999999997, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.1, 44.10000000000001, 41.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 45.5, -50.00000000000044, 35.70000000000003, 47.5, 45.7, -50.00000000000044, 44.10000000000001, 45.1, 43.900000000000006, 47.1, 46.9, 45.1, 43.10000000000001, -50.00000000000044, 46.699999999999996, 42.900000000000006, 46.9, 42.500000000000014, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 3.899999999999615, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.1, 45.7], "episode_lengths": [500, 500, 76, 500, 500, 500, 50, 50, 500, 74, 30, 54, 32, 32, 500, 104, 124, 28, 142, 34, 500, 122, 500, 500, 500, 500, 228, 38, 52, 40, 186, 218, 500, 64, 86, 500, 156, 500, 78, 94, 500, 38, 40, 44, 32, 46, 40, 118, 54, 500, 104, 54, 88, 46, 232, 500, 500, 154, 154, 212, 500, 46, 500, 500, 50, 60, 88, 500, 38, 500, 46, 500, 144, 26, 44, 500, 60, 50, 62, 30, 32, 50, 70, 500, 34, 72, 32, 76, 500, 52, 500, 500, 36, 462, 44, 500, 80, 500, 50, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37369438407448624, "mean_inference_ms": 1.1969364770434516, "mean_action_processing_ms": 0.1395889674258502, "mean_env_wait_ms": 0.08152641759655328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030757904052734375, "StateBufferConnector_ms": 0.010000467300415039, "ViewRequirementAgentConnector_ms": 0.12801861763000488}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5028.404409545483, "num_env_steps_trained_throughput_per_sec": 5028.404409545483, "timesteps_total": 1488000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 2329.893, "sample_time_ms": 1954.165, "load_time_ms": 13.557, "load_throughput": 885174.611, "learn_time_ms": 352.09, "learn_throughput": 34082.211, "synch_weights_time_ms": 9.227}, "counters": {"num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "episodes_total": 5608, "training_iteration": 124, "trial_id": "9f288_00009", "date": "2023-10-25_16-21-07", "timestamp": 1698247267, "time_this_iter_s": 2.3912322521209717, "time_total_s": 281.5351634025574, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 281.5351634025574, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 50.525000000000006, "ram_util_percent": 26.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.403954806578303e-39, "cur_lr": 0.0003, "total_loss": 6.542438157399496, "policy_loss": -0.0006165904303391775, "vf_loss": 6.543101406097412, "vf_explained_var": -9.49700673421224e-07, "kl": 0.0010538970705738393, "entropy": 0.4666784584522247, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3735.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.69799999999984, "episode_len_mean": 233.68, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, 39.70000000000002, 44.7, 41.30000000000001, 45.5, 26.89999999999994, -50.00000000000044, -50.00000000000044, 34.70000000000004, 34.70000000000004, 28.89999999999997, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.1, 44.10000000000001, 41.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 45.5, -50.00000000000044, 35.70000000000003, 47.5, 45.7, -50.00000000000044, 44.10000000000001, 45.1, 43.900000000000006, 47.1, 46.9, 45.1, 43.10000000000001, -50.00000000000044, 46.699999999999996, 42.900000000000006, 46.9, 42.500000000000014, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 3.899999999999615, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.1, 45.7, -50.00000000000044, 46.699999999999996, 46.5, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 26.09999999999993, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, 46.5, 40.70000000000002, 46.099999999999994, 41.500000000000014, 42.70000000000001, 27.699999999999953, 41.70000000000002, -50.00000000000044, 5.099999999999632, -50.00000000000044, 36.900000000000034, 44.7, 44.10000000000001, -50.00000000000044, 43.900000000000006, 46.699999999999996, 45.3, 46.9, 41.30000000000001, 22.699999999999882, 46.3, 1.099999999999575, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036], "episode_lengths": [54, 500, 104, 54, 88, 46, 232, 500, 500, 154, 154, 212, 500, 46, 500, 500, 50, 60, 88, 500, 38, 500, 46, 500, 144, 26, 44, 500, 60, 50, 62, 30, 32, 50, 70, 500, 34, 72, 32, 76, 500, 52, 500, 500, 36, 462, 44, 500, 80, 500, 50, 44, 500, 34, 36, 84, 500, 500, 500, 76, 500, 30, 500, 500, 500, 48, 240, 500, 194, 500, 500, 36, 36, 94, 40, 86, 74, 224, 84, 500, 450, 500, 132, 54, 60, 500, 62, 34, 48, 32, 88, 274, 38, 490, 500, 48, 500, 500, 500, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37308144511732527, "mean_inference_ms": 1.1961013801755473, "mean_action_processing_ms": 0.13949419406717575, "mean_env_wait_ms": 0.08144662111141511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0327603816986084, "StateBufferConnector_ms": 0.01000070571899414, "ViewRequirementAgentConnector_ms": 0.13102483749389648}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.69799999999984, "episode_len_mean": 233.68, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, 39.70000000000002, 44.7, 41.30000000000001, 45.5, 26.89999999999994, -50.00000000000044, -50.00000000000044, 34.70000000000004, 34.70000000000004, 28.89999999999997, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.1, 44.10000000000001, 41.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 45.5, -50.00000000000044, 35.70000000000003, 47.5, 45.7, -50.00000000000044, 44.10000000000001, 45.1, 43.900000000000006, 47.1, 46.9, 45.1, 43.10000000000001, -50.00000000000044, 46.699999999999996, 42.900000000000006, 46.9, 42.500000000000014, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 3.899999999999615, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.1, 45.7, -50.00000000000044, 46.699999999999996, 46.5, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 26.09999999999993, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, 46.5, 40.70000000000002, 46.099999999999994, 41.500000000000014, 42.70000000000001, 27.699999999999953, 41.70000000000002, -50.00000000000044, 5.099999999999632, -50.00000000000044, 36.900000000000034, 44.7, 44.10000000000001, -50.00000000000044, 43.900000000000006, 46.699999999999996, 45.3, 46.9, 41.30000000000001, 22.699999999999882, 46.3, 1.099999999999575, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036], "episode_lengths": [54, 500, 104, 54, 88, 46, 232, 500, 500, 154, 154, 212, 500, 46, 500, 500, 50, 60, 88, 500, 38, 500, 46, 500, 144, 26, 44, 500, 60, 50, 62, 30, 32, 50, 70, 500, 34, 72, 32, 76, 500, 52, 500, 500, 36, 462, 44, 500, 80, 500, 50, 44, 500, 34, 36, 84, 500, 500, 500, 76, 500, 30, 500, 500, 500, 48, 240, 500, 194, 500, 500, 36, 36, 94, 40, 86, 74, 224, 84, 500, 450, 500, 132, 54, 60, 500, 62, 34, 48, 32, 88, 274, 38, 490, 500, 48, 500, 500, 500, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37308144511732527, "mean_inference_ms": 1.1961013801755473, "mean_action_processing_ms": 0.13949419406717575, "mean_env_wait_ms": 0.08144662111141511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0327603816986084, "StateBufferConnector_ms": 0.01000070571899414, "ViewRequirementAgentConnector_ms": 0.13102483749389648}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5597.01291874611, "num_env_steps_trained_throughput_per_sec": 5597.01291874611, "timesteps_total": 1500000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 2310.868, "sample_time_ms": 1953.758, "load_time_ms": 12.302, "load_throughput": 975440.329, "learn_time_ms": 334.689, "learn_throughput": 35854.202, "synch_weights_time_ms": 9.165}, "counters": {"num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": true, "episodes_total": 5656, "training_iteration": 125, "trial_id": "9f288_00009", "date": "2023-10-25_16-21-09", "timestamp": 1698247269, "time_this_iter_s": 2.1489994525909424, "time_total_s": 283.6841628551483, "pid": 632, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 283.6841628551483, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 58.199999999999996, "ram_util_percent": 26.433333333333334}}
