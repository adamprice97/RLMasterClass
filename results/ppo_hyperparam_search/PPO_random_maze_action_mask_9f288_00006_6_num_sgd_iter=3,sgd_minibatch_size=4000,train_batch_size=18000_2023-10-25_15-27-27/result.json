{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0003, "total_loss": 9.459987878799438, "policy_loss": 0.004047093912959099, "vf_loss": 9.455438693364462, "vf_explained_var": 9.353458881378174e-05, "kl": 0.0028765868665440917, "entropy": 0.7280070583025614, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 6.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 43.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -31.28108108108146, "episode_len_mean": 448.2162162162162, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 23.29999999999989, 26.89999999999994, 0.49999999999956657, 9.8999999999997, -50.00000000000044, 5.499999999999638, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 498, 500, 86, 500, 500, 500, 218, 500, 500, 268, 232, 496, 402, 500, 446, 64, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 374, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4122813901862264, "mean_inference_ms": 1.3316938530534386, "mean_action_processing_ms": 0.15460712688996983, "mean_env_wait_ms": 0.08867517491198504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024343181300807645, "StateBufferConnector_ms": 0.005359263033480258, "ViewRequirementAgentConnector_ms": 0.11345438055090003}}, "episode_reward_max": 43.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -31.28108108108146, "episode_len_mean": 448.2162162162162, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 23.29999999999989, 26.89999999999994, 0.49999999999956657, 9.8999999999997, -50.00000000000044, 5.499999999999638, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 498, 500, 86, 500, 500, 500, 218, 500, 500, 268, 232, 496, 402, 500, 446, 64, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 374, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4122813901862264, "mean_inference_ms": 1.3316938530534386, "mean_action_processing_ms": 0.15460712688996983, "mean_env_wait_ms": 0.08867517491198504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024343181300807645, "StateBufferConnector_ms": 0.005359263033480258, "ViewRequirementAgentConnector_ms": 0.11345438055090003}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5572.272095112348, "num_env_steps_trained_throughput_per_sec": 5572.272095112348, "timesteps_total": 18000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 3230.28, "sample_time_ms": 3128.005, "load_time_ms": 10.008, "load_throughput": 1798586.621, "learn_time_ms": 80.251, "learn_throughput": 224295.664, "synch_weights_time_ms": 11.016}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 37, "training_iteration": 1, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-08", "timestamp": 1698245948, "time_this_iter_s": 3.235290288925171, "time_total_s": 3.235290288925171, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 3.235290288925171, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 69.46, "ram_util_percent": 27.619999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 9.20352872212728, "policy_loss": -0.04202549485489726, "vf_loss": 9.245332400004068, "vf_explained_var": -7.667144139607747e-05, "kl": 0.0029386523433364196, "entropy": 0.7187467664480209, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 18.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 43.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -12.638043478261142, "episode_len_mean": 371.4347826086956, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 23.29999999999989, 26.89999999999994, 0.49999999999956657, 9.8999999999997, -50.00000000000044, 5.499999999999638, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, -50.00000000000044, 15.49999999999978, 36.900000000000034, -50.00000000000044, 35.500000000000036, -50.00000000000044, 35.500000000000036, 15.899999999999785, 33.10000000000003, 31.70000000000001, 28.29999999999996, 31.300000000000004, 26.89999999999994, 27.49999999999995, -50.00000000000044, 37.10000000000003, 38.50000000000003, 40.30000000000002, -50.00000000000044, 42.10000000000001, 22.699999999999882, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 31.70000000000001, 20.299999999999848, -50.00000000000044, 30.699999999999996, -50.00000000000044, 28.699999999999967, -50.00000000000044, 36.50000000000003, 43.50000000000001, 33.90000000000004, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 34.70000000000004, 10.499999999999709, 31.900000000000013, -50.00000000000044, 38.50000000000003, -50.00000000000044, 16.699999999999797, 39.70000000000002, -50.00000000000044, 9.8999999999997, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.699999999999783, -50.00000000000044, 26.299999999999933, -50.00000000000044], "episode_lengths": [500, 500, 500, 498, 500, 86, 500, 500, 500, 218, 500, 500, 268, 232, 496, 402, 500, 446, 64, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 374, 500, 500, 346, 132, 500, 146, 500, 146, 342, 170, 184, 218, 188, 232, 226, 500, 130, 116, 98, 500, 80, 274, 500, 500, 198, 500, 184, 298, 500, 194, 500, 214, 500, 136, 66, 162, 468, 500, 500, 154, 396, 182, 500, 116, 500, 334, 104, 500, 402, 370, 500, 500, 500, 344, 500, 238, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40646456933707603, "mean_inference_ms": 1.2984899104343386, "mean_action_processing_ms": 0.15015352376985308, "mean_env_wait_ms": 0.0876063845881804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01738719318224036, "StateBufferConnector_ms": 0.004329629566358483, "ViewRequirementAgentConnector_ms": 0.11682665866354237}}, "episode_reward_max": 43.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -12.638043478261142, "episode_len_mean": 371.4347826086956, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 23.29999999999989, 26.89999999999994, 0.49999999999956657, 9.8999999999997, -50.00000000000044, 5.499999999999638, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, -50.00000000000044, 15.49999999999978, 36.900000000000034, -50.00000000000044, 35.500000000000036, -50.00000000000044, 35.500000000000036, 15.899999999999785, 33.10000000000003, 31.70000000000001, 28.29999999999996, 31.300000000000004, 26.89999999999994, 27.49999999999995, -50.00000000000044, 37.10000000000003, 38.50000000000003, 40.30000000000002, -50.00000000000044, 42.10000000000001, 22.699999999999882, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 31.70000000000001, 20.299999999999848, -50.00000000000044, 30.699999999999996, -50.00000000000044, 28.699999999999967, -50.00000000000044, 36.50000000000003, 43.50000000000001, 33.90000000000004, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 34.70000000000004, 10.499999999999709, 31.900000000000013, -50.00000000000044, 38.50000000000003, -50.00000000000044, 16.699999999999797, 39.70000000000002, -50.00000000000044, 9.8999999999997, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.699999999999783, -50.00000000000044, 26.299999999999933, -50.00000000000044], "episode_lengths": [500, 500, 500, 498, 500, 86, 500, 500, 500, 218, 500, 500, 268, 232, 496, 402, 500, 446, 64, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 374, 500, 500, 346, 132, 500, 146, 500, 146, 342, 170, 184, 218, 188, 232, 226, 500, 130, 116, 98, 500, 80, 274, 500, 500, 198, 500, 184, 298, 500, 194, 500, 214, 500, 136, 66, 162, 468, 500, 500, 154, 396, 182, 500, 116, 500, 334, 104, 500, 402, 370, 500, 500, 500, 344, 500, 238, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40646456933707603, "mean_inference_ms": 1.2984899104343386, "mean_action_processing_ms": 0.15015352376985308, "mean_env_wait_ms": 0.0876063845881804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01738719318224036, "StateBufferConnector_ms": 0.004329629566358483, "ViewRequirementAgentConnector_ms": 0.11682665866354237}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5726.368420334067, "num_env_steps_trained_throughput_per_sec": 5726.368420334067, "timesteps_total": 36000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 3186.817, "sample_time_ms": 3002.502, "load_time_ms": 17.283, "load_throughput": 1041466.544, "learn_time_ms": 155.523, "learn_throughput": 115738.462, "synch_weights_time_ms": 10.509}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 92, "training_iteration": 2, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-11", "timestamp": 1698245951, "time_this_iter_s": 3.14809250831604, "time_total_s": 6.383382797241211, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.383382797241211, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 61.61999999999999, "ram_util_percent": 27.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0003, "total_loss": 9.073586781819662, "policy_loss": -0.054212670986695834, "vf_loss": 9.127748092015585, "vf_explained_var": 1.2169281641642252e-05, "kl": 0.0024358187890740624, "entropy": 0.7068563302357992, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 30.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.34000000000021124, "episode_len_mean": 324.04, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.29999999999996, 31.300000000000004, 26.89999999999994, 27.49999999999995, -50.00000000000044, 37.10000000000003, 38.50000000000003, 40.30000000000002, -50.00000000000044, 42.10000000000001, 22.699999999999882, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 31.70000000000001, 20.299999999999848, -50.00000000000044, 30.699999999999996, -50.00000000000044, 28.699999999999967, -50.00000000000044, 36.50000000000003, 43.50000000000001, 33.90000000000004, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 34.70000000000004, 10.499999999999709, 31.900000000000013, -50.00000000000044, 38.50000000000003, -50.00000000000044, 16.699999999999797, 39.70000000000002, -50.00000000000044, 9.8999999999997, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.699999999999783, -50.00000000000044, 26.299999999999933, -50.00000000000044, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 28.89999999999997, 32.700000000000024, 44.300000000000004, -50.00000000000044, 16.09999999999979, 16.29999999999979, 38.10000000000002, -50.00000000000044, 28.09999999999996, 3.699999999999612, 4.499999999999623, -50.00000000000044, -50.00000000000044, 21.09999999999986, 22.49999999999988, 43.30000000000001, 6.099999999999646, 33.90000000000004, 18.099999999999817, 33.90000000000004, 32.50000000000002, 30.29999999999999, 31.300000000000004, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 22.49999999999988, 31.500000000000007, 31.1, 26.69999999999994, 35.30000000000004, 40.90000000000002, 46.9, -50.00000000000044, 41.70000000000002, 43.10000000000001, -50.00000000000044, 21.499999999999865, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044], "episode_lengths": [218, 188, 232, 226, 500, 130, 116, 98, 500, 80, 274, 500, 500, 198, 500, 184, 298, 500, 194, 500, 214, 500, 136, 66, 162, 468, 500, 500, 154, 396, 182, 500, 116, 500, 334, 104, 500, 402, 370, 500, 500, 500, 344, 500, 238, 500, 444, 500, 500, 150, 500, 212, 174, 58, 500, 340, 338, 120, 500, 220, 464, 456, 500, 500, 290, 276, 68, 440, 162, 320, 162, 176, 198, 188, 500, 500, 170, 500, 276, 186, 190, 234, 148, 92, 32, 500, 84, 70, 500, 286, 494, 500, 500, 62, 500, 270, 500, 500, 432, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4019769576042234, "mean_inference_ms": 1.2800790962019277, "mean_action_processing_ms": 0.14839881575057276, "mean_env_wait_ms": 0.0878122426177008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017983198165893555, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.12650632858276367}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.34000000000021124, "episode_len_mean": 324.04, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.29999999999996, 31.300000000000004, 26.89999999999994, 27.49999999999995, -50.00000000000044, 37.10000000000003, 38.50000000000003, 40.30000000000002, -50.00000000000044, 42.10000000000001, 22.699999999999882, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 31.70000000000001, 20.299999999999848, -50.00000000000044, 30.699999999999996, -50.00000000000044, 28.699999999999967, -50.00000000000044, 36.50000000000003, 43.50000000000001, 33.90000000000004, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 34.70000000000004, 10.499999999999709, 31.900000000000013, -50.00000000000044, 38.50000000000003, -50.00000000000044, 16.699999999999797, 39.70000000000002, -50.00000000000044, 9.8999999999997, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.699999999999783, -50.00000000000044, 26.299999999999933, -50.00000000000044, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 28.89999999999997, 32.700000000000024, 44.300000000000004, -50.00000000000044, 16.09999999999979, 16.29999999999979, 38.10000000000002, -50.00000000000044, 28.09999999999996, 3.699999999999612, 4.499999999999623, -50.00000000000044, -50.00000000000044, 21.09999999999986, 22.49999999999988, 43.30000000000001, 6.099999999999646, 33.90000000000004, 18.099999999999817, 33.90000000000004, 32.50000000000002, 30.29999999999999, 31.300000000000004, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 22.49999999999988, 31.500000000000007, 31.1, 26.69999999999994, 35.30000000000004, 40.90000000000002, 46.9, -50.00000000000044, 41.70000000000002, 43.10000000000001, -50.00000000000044, 21.499999999999865, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044], "episode_lengths": [218, 188, 232, 226, 500, 130, 116, 98, 500, 80, 274, 500, 500, 198, 500, 184, 298, 500, 194, 500, 214, 500, 136, 66, 162, 468, 500, 500, 154, 396, 182, 500, 116, 500, 334, 104, 500, 402, 370, 500, 500, 500, 344, 500, 238, 500, 444, 500, 500, 150, 500, 212, 174, 58, 500, 340, 338, 120, 500, 220, 464, 456, 500, 500, 290, 276, 68, 440, 162, 320, 162, 176, 198, 188, 500, 500, 170, 500, 276, 186, 190, 234, 148, 92, 32, 500, 84, 70, 500, 286, 494, 500, 500, 62, 500, 270, 500, 500, 432, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4019769576042234, "mean_inference_ms": 1.2800790962019277, "mean_action_processing_ms": 0.14839881575057276, "mean_env_wait_ms": 0.0878122426177008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017983198165893555, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.12650632858276367}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5481.025216899779, "num_env_steps_trained_throughput_per_sec": 5481.025216899779, "timesteps_total": 54000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 3219.23, "sample_time_ms": 3003.042, "load_time_ms": 18.532, "load_throughput": 971286.756, "learn_time_ms": 186.66, "learn_throughput": 96431.825, "synch_weights_time_ms": 9.996}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 146, "training_iteration": 3, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-15", "timestamp": 1698245955, "time_this_iter_s": 3.289055585861206, "time_total_s": 9.672438383102417, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 9.672438383102417, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 74.675, "ram_util_percent": 27.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0003, "total_loss": 9.169935703277588, "policy_loss": 0.02504567219875753, "vf_loss": 9.144908746083578, "vf_explained_var": 2.9832124710083008e-05, "kl": 0.0019219101710821935, "entropy": 0.6665167113145193, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 42.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.413999999999819, "episode_len_mean": 296.54, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 21.09999999999986, 22.49999999999988, 43.30000000000001, 6.099999999999646, 33.90000000000004, 18.099999999999817, 33.90000000000004, 32.50000000000002, 30.29999999999999, 31.300000000000004, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 22.49999999999988, 31.500000000000007, 31.1, 26.69999999999994, 35.30000000000004, 40.90000000000002, 46.9, -50.00000000000044, 41.70000000000002, 43.10000000000001, -50.00000000000044, 21.499999999999865, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 30.699999999999996, 38.10000000000002, -50.00000000000044, 39.50000000000002, -50.00000000000044, 27.699999999999953, 43.50000000000001, 31.1, 4.899999999999629, -50.00000000000044, 41.30000000000001, -50.00000000000044, 25.499999999999922, 37.90000000000003, 31.1, -50.00000000000044, 39.90000000000002, 27.299999999999947, 39.70000000000002, 41.30000000000001, 22.099999999999874, 24.899999999999913, -50.00000000000044, 14.299999999999763, 0.49999999999956657, -50.00000000000044, 5.899999999999643, 38.300000000000026, 32.90000000000003, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 35.10000000000004, 38.10000000000002, 16.29999999999979, 42.500000000000014, -50.00000000000044, 41.90000000000001, -50.00000000000044, 33.10000000000003, 39.90000000000002, 19.499999999999837, 35.30000000000004, 33.500000000000036, 18.29999999999982, 4.699999999999626, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 30.099999999999987, 30.499999999999993, -50.00000000000044, 40.70000000000002, 41.70000000000002, -50.00000000000044, 40.90000000000002, 27.099999999999945], "episode_lengths": [500, 500, 290, 276, 68, 440, 162, 320, 162, 176, 198, 188, 500, 500, 170, 500, 276, 186, 190, 234, 148, 92, 32, 500, 84, 70, 500, 286, 494, 500, 500, 62, 500, 270, 500, 500, 432, 500, 500, 194, 120, 500, 106, 500, 224, 66, 190, 452, 500, 88, 500, 246, 122, 190, 500, 102, 228, 104, 88, 280, 252, 500, 358, 496, 500, 442, 118, 172, 500, 500, 116, 500, 150, 120, 338, 76, 500, 82, 500, 170, 102, 306, 148, 166, 318, 454, 500, 98, 500, 500, 170, 500, 200, 196, 500, 94, 84, 500, 92, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3997064207125412, "mean_inference_ms": 1.2776802304355102, "mean_action_processing_ms": 0.14816710295041502, "mean_env_wait_ms": 0.08757041273693339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02398967742919922, "StateBufferConnector_ms": 0.00799870491027832, "ViewRequirementAgentConnector_ms": 0.12595796585083008}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.413999999999819, "episode_len_mean": 296.54, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 21.09999999999986, 22.49999999999988, 43.30000000000001, 6.099999999999646, 33.90000000000004, 18.099999999999817, 33.90000000000004, 32.50000000000002, 30.29999999999999, 31.300000000000004, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 22.49999999999988, 31.500000000000007, 31.1, 26.69999999999994, 35.30000000000004, 40.90000000000002, 46.9, -50.00000000000044, 41.70000000000002, 43.10000000000001, -50.00000000000044, 21.499999999999865, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 30.699999999999996, 38.10000000000002, -50.00000000000044, 39.50000000000002, -50.00000000000044, 27.699999999999953, 43.50000000000001, 31.1, 4.899999999999629, -50.00000000000044, 41.30000000000001, -50.00000000000044, 25.499999999999922, 37.90000000000003, 31.1, -50.00000000000044, 39.90000000000002, 27.299999999999947, 39.70000000000002, 41.30000000000001, 22.099999999999874, 24.899999999999913, -50.00000000000044, 14.299999999999763, 0.49999999999956657, -50.00000000000044, 5.899999999999643, 38.300000000000026, 32.90000000000003, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 35.10000000000004, 38.10000000000002, 16.29999999999979, 42.500000000000014, -50.00000000000044, 41.90000000000001, -50.00000000000044, 33.10000000000003, 39.90000000000002, 19.499999999999837, 35.30000000000004, 33.500000000000036, 18.29999999999982, 4.699999999999626, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 30.099999999999987, 30.499999999999993, -50.00000000000044, 40.70000000000002, 41.70000000000002, -50.00000000000044, 40.90000000000002, 27.099999999999945], "episode_lengths": [500, 500, 290, 276, 68, 440, 162, 320, 162, 176, 198, 188, 500, 500, 170, 500, 276, 186, 190, 234, 148, 92, 32, 500, 84, 70, 500, 286, 494, 500, 500, 62, 500, 270, 500, 500, 432, 500, 500, 194, 120, 500, 106, 500, 224, 66, 190, 452, 500, 88, 500, 246, 122, 190, 500, 102, 228, 104, 88, 280, 252, 500, 358, 496, 500, 442, 118, 172, 500, 500, 116, 500, 150, 120, 338, 76, 500, 82, 500, 170, 102, 306, 148, 166, 318, 454, 500, 98, 500, 500, 170, 500, 200, 196, 500, 94, 84, 500, 92, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3997064207125412, "mean_inference_ms": 1.2776802304355102, "mean_action_processing_ms": 0.14816710295041502, "mean_env_wait_ms": 0.08757041273693339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02398967742919922, "StateBufferConnector_ms": 0.00799870491027832, "ViewRequirementAgentConnector_ms": 0.12595796585083008}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5708.801883498885, "num_env_steps_trained_throughput_per_sec": 5708.801883498885, "timesteps_total": 72000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 3202.679, "sample_time_ms": 2983.311, "load_time_ms": 17.399, "load_throughput": 1034527.263, "learn_time_ms": 190.971, "learn_throughput": 94255.052, "synch_weights_time_ms": 9.997}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 208, "training_iteration": 4, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-18", "timestamp": 1698245958, "time_this_iter_s": 3.158024549484253, "time_total_s": 12.83046293258667, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 12.83046293258667, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 61.620000000000005, "ram_util_percent": 27.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0003, "total_loss": 9.091034253438314, "policy_loss": -0.022974518302362412, "vf_loss": 9.114054123560587, "vf_explained_var": -7.286667823791504e-06, "kl": 0.0014224677326026836, "entropy": 0.6378098428249359, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 54.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.435999999999872, "episode_len_mean": 236.38, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.499999999999837, 35.30000000000004, 33.500000000000036, 18.29999999999982, 4.699999999999626, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 30.099999999999987, 30.499999999999993, -50.00000000000044, 40.70000000000002, 41.70000000000002, -50.00000000000044, 40.90000000000002, 27.099999999999945, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 42.70000000000001, -50.00000000000044, 46.3, 40.30000000000002, 25.29999999999992, 40.30000000000002, 35.10000000000004, 43.7, 16.499999999999794, -50.00000000000044, 41.70000000000002, 26.09999999999993, 38.90000000000002, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.7, 41.90000000000001, 38.700000000000024, 33.500000000000036, -50.00000000000044, 28.29999999999996, 36.900000000000034, 41.30000000000001, 32.50000000000002, 17.899999999999814, 35.30000000000004, 34.70000000000004, 39.300000000000026, 21.89999999999987, 36.900000000000034, 46.099999999999994, 45.5, 45.1, -50.00000000000044, 17.899999999999814, 41.30000000000001, 38.10000000000002, 31.500000000000007, 41.90000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 37.300000000000026, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.30000000000001, 26.299999999999933, 16.8999999999998, 38.90000000000002, 35.500000000000036, 43.900000000000006, 44.900000000000006, -50.00000000000044, 11.499999999999723, 44.5, -50.00000000000044, 43.10000000000001, 36.50000000000003, 40.30000000000002, 40.10000000000002, 40.10000000000002, 39.10000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.70000000000002, 45.7, 42.900000000000006, 37.50000000000003], "episode_lengths": [306, 148, 166, 318, 454, 500, 98, 500, 500, 170, 500, 200, 196, 500, 94, 84, 500, 92, 230, 500, 50, 500, 500, 500, 500, 500, 264, 74, 500, 38, 98, 248, 98, 150, 64, 336, 500, 84, 240, 112, 124, 500, 500, 44, 82, 114, 166, 500, 218, 132, 88, 176, 322, 148, 154, 108, 282, 132, 40, 46, 50, 500, 322, 88, 120, 186, 82, 500, 500, 104, 128, 130, 500, 500, 40, 78, 238, 332, 112, 146, 62, 52, 500, 386, 56, 500, 70, 136, 98, 100, 100, 110, 110, 500, 500, 68, 104, 44, 72, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39747582367517736, "mean_inference_ms": 1.2729898624383174, "mean_action_processing_ms": 0.14745787865330498, "mean_env_wait_ms": 0.08638802136592981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027411937713623047, "StateBufferConnector_ms": 0.008002758026123047, "ViewRequirementAgentConnector_ms": 0.09928488731384277}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.435999999999872, "episode_len_mean": 236.38, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.499999999999837, 35.30000000000004, 33.500000000000036, 18.29999999999982, 4.699999999999626, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 30.099999999999987, 30.499999999999993, -50.00000000000044, 40.70000000000002, 41.70000000000002, -50.00000000000044, 40.90000000000002, 27.099999999999945, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 42.70000000000001, -50.00000000000044, 46.3, 40.30000000000002, 25.29999999999992, 40.30000000000002, 35.10000000000004, 43.7, 16.499999999999794, -50.00000000000044, 41.70000000000002, 26.09999999999993, 38.90000000000002, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.7, 41.90000000000001, 38.700000000000024, 33.500000000000036, -50.00000000000044, 28.29999999999996, 36.900000000000034, 41.30000000000001, 32.50000000000002, 17.899999999999814, 35.30000000000004, 34.70000000000004, 39.300000000000026, 21.89999999999987, 36.900000000000034, 46.099999999999994, 45.5, 45.1, -50.00000000000044, 17.899999999999814, 41.30000000000001, 38.10000000000002, 31.500000000000007, 41.90000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 37.300000000000026, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.30000000000001, 26.299999999999933, 16.8999999999998, 38.90000000000002, 35.500000000000036, 43.900000000000006, 44.900000000000006, -50.00000000000044, 11.499999999999723, 44.5, -50.00000000000044, 43.10000000000001, 36.50000000000003, 40.30000000000002, 40.10000000000002, 40.10000000000002, 39.10000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.70000000000002, 45.7, 42.900000000000006, 37.50000000000003], "episode_lengths": [306, 148, 166, 318, 454, 500, 98, 500, 500, 170, 500, 200, 196, 500, 94, 84, 500, 92, 230, 500, 50, 500, 500, 500, 500, 500, 264, 74, 500, 38, 98, 248, 98, 150, 64, 336, 500, 84, 240, 112, 124, 500, 500, 44, 82, 114, 166, 500, 218, 132, 88, 176, 322, 148, 154, 108, 282, 132, 40, 46, 50, 500, 322, 88, 120, 186, 82, 500, 500, 104, 128, 130, 500, 500, 40, 78, 238, 332, 112, 146, 62, 52, 500, 386, 56, 500, 70, 136, 98, 100, 100, 110, 110, 500, 500, 68, 104, 44, 72, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39747582367517736, "mean_inference_ms": 1.2729898624383174, "mean_action_processing_ms": 0.14745787865330498, "mean_env_wait_ms": 0.08638802136592981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027411937713623047, "StateBufferConnector_ms": 0.008002758026123047, "ViewRequirementAgentConnector_ms": 0.09928488731384277}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5283.2184737173475, "num_env_steps_trained_throughput_per_sec": 5283.2184737173475, "timesteps_total": 90000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 3243.546, "sample_time_ms": 2982.68, "load_time_ms": 19.794, "load_throughput": 909367.059, "learn_time_ms": 229.933, "learn_throughput": 78283.698, "synch_weights_time_ms": 9.939}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 289, "training_iteration": 5, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-21", "timestamp": 1698245961, "time_this_iter_s": 3.413015604019165, "time_total_s": 16.243478536605835, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 16.243478536605835, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 59.519999999999996, "ram_util_percent": 27.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0003, "total_loss": 8.922927538553873, "policy_loss": -0.020768616038064163, "vf_loss": 8.943746964136759, "vf_explained_var": 1.2089808781941732e-05, "kl": 0.001107725868214023, "entropy": 0.5795177767674128, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 66.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.251999999999848, "episode_len_mean": 248.16, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.10000000000002, 31.500000000000007, 41.90000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 37.300000000000026, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.30000000000001, 26.299999999999933, 16.8999999999998, 38.90000000000002, 35.500000000000036, 43.900000000000006, 44.900000000000006, -50.00000000000044, 11.499999999999723, 44.5, -50.00000000000044, 43.10000000000001, 36.50000000000003, 40.30000000000002, 40.10000000000002, 40.10000000000002, 39.10000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.70000000000002, 45.7, 42.900000000000006, 37.50000000000003, -50.00000000000044, 39.300000000000026, 46.9, 43.7, 43.900000000000006, 28.699999999999967, 30.9, 43.50000000000001, 38.50000000000003, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.70000000000002, 34.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, 37.90000000000003, 42.30000000000001, 41.70000000000002, 42.30000000000001, 25.499999999999922, 12.899999999999743, 44.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 34.10000000000004, 38.50000000000003, 40.500000000000014, -50.00000000000044, 45.9, 1.099999999999575, 44.300000000000004, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.30000000000001, 29.299999999999976, 43.900000000000006, 39.300000000000026, -50.00000000000044, 39.70000000000002, -50.00000000000044, 8.49999999999968, 42.500000000000014, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.7], "episode_lengths": [120, 186, 82, 500, 500, 104, 128, 130, 500, 500, 40, 78, 238, 332, 112, 146, 62, 52, 500, 386, 56, 500, 70, 136, 98, 100, 100, 110, 110, 500, 500, 68, 104, 44, 72, 126, 500, 108, 32, 64, 62, 214, 192, 66, 116, 500, 210, 500, 500, 108, 94, 152, 62, 500, 500, 122, 78, 84, 78, 246, 372, 56, 500, 500, 84, 500, 160, 116, 96, 500, 42, 490, 58, 102, 500, 500, 500, 500, 500, 60, 500, 68, 208, 62, 108, 500, 104, 500, 416, 76, 500, 130, 500, 500, 500, 342, 500, 500, 144, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39690691868297034, "mean_inference_ms": 1.2759000945598766, "mean_action_processing_ms": 0.14849476006520887, "mean_env_wait_ms": 0.08624422241616805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016413450241088867, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.10432934761047363}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.251999999999848, "episode_len_mean": 248.16, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.10000000000002, 31.500000000000007, 41.90000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 37.300000000000026, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.30000000000001, 26.299999999999933, 16.8999999999998, 38.90000000000002, 35.500000000000036, 43.900000000000006, 44.900000000000006, -50.00000000000044, 11.499999999999723, 44.5, -50.00000000000044, 43.10000000000001, 36.50000000000003, 40.30000000000002, 40.10000000000002, 40.10000000000002, 39.10000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.70000000000002, 45.7, 42.900000000000006, 37.50000000000003, -50.00000000000044, 39.300000000000026, 46.9, 43.7, 43.900000000000006, 28.699999999999967, 30.9, 43.50000000000001, 38.50000000000003, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.70000000000002, 34.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, 37.90000000000003, 42.30000000000001, 41.70000000000002, 42.30000000000001, 25.499999999999922, 12.899999999999743, 44.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 34.10000000000004, 38.50000000000003, 40.500000000000014, -50.00000000000044, 45.9, 1.099999999999575, 44.300000000000004, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.30000000000001, 29.299999999999976, 43.900000000000006, 39.300000000000026, -50.00000000000044, 39.70000000000002, -50.00000000000044, 8.49999999999968, 42.500000000000014, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.7], "episode_lengths": [120, 186, 82, 500, 500, 104, 128, 130, 500, 500, 40, 78, 238, 332, 112, 146, 62, 52, 500, 386, 56, 500, 70, 136, 98, 100, 100, 110, 110, 500, 500, 68, 104, 44, 72, 126, 500, 108, 32, 64, 62, 214, 192, 66, 116, 500, 210, 500, 500, 108, 94, 152, 62, 500, 500, 122, 78, 84, 78, 246, 372, 56, 500, 500, 84, 500, 160, 116, 96, 500, 42, 490, 58, 102, 500, 500, 500, 500, 500, 60, 500, 68, 208, 62, 108, 500, 104, 500, 416, 76, 500, 130, 500, 500, 500, 342, 500, 500, 144, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39690691868297034, "mean_inference_ms": 1.2759000945598766, "mean_action_processing_ms": 0.14849476006520887, "mean_env_wait_ms": 0.08624422241616805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016413450241088867, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.10432934761047363}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5617.247297436954, "num_env_steps_trained_throughput_per_sec": 5617.247297436954, "timesteps_total": 108000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3237.025, "sample_time_ms": 2982.101, "load_time_ms": 18.83, "load_throughput": 955936.463, "learn_time_ms": 224.883, "learn_throughput": 80041.622, "synch_weights_time_ms": 9.878}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 353, "training_iteration": 6, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-25", "timestamp": 1698245965, "time_this_iter_s": 3.2091245651245117, "time_total_s": 19.452603101730347, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 19.452603101730347, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 70.3, "ram_util_percent": 27.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0003, "total_loss": 8.914755741755167, "policy_loss": 0.003169360260168711, "vf_loss": 8.911639054616293, "vf_explained_var": 8.692344029744466e-07, "kl": 8.760150830274445e-05, "entropy": 0.5278509904940923, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 78.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.905999999999836, "episode_len_mean": 251.58, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, 29.299999999999976, 43.900000000000006, 39.300000000000026, -50.00000000000044, 39.70000000000002, -50.00000000000044, 8.49999999999968, 42.500000000000014, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.7, 38.300000000000026, 45.1, 39.90000000000002, 46.3, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 33.10000000000003, 47.1, 46.099999999999994, -50.00000000000044, 45.1, 37.70000000000003, 44.5, -50.00000000000044, -50.00000000000044, 38.300000000000026, 44.10000000000001, -50.00000000000044, 40.90000000000002, 22.299999999999876, -50.00000000000044, 33.500000000000036, 25.29999999999992, -50.00000000000044, 43.50000000000001, -50.00000000000044, 41.500000000000014, 42.30000000000001, 35.500000000000036, 42.30000000000001, 43.900000000000006, 46.9, 44.300000000000004, 42.30000000000001, 34.70000000000004, 41.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 40.500000000000014, 29.69999999999998, 38.90000000000002, 39.50000000000002, -50.00000000000044, 44.900000000000006, 43.900000000000006, 40.500000000000014, 44.300000000000004, 44.5, 26.69999999999994, 25.699999999999925, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.900000000000034, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.10000000000001, 17.899999999999814], "episode_lengths": [68, 208, 62, 108, 500, 104, 500, 416, 76, 500, 130, 500, 500, 500, 342, 500, 500, 144, 44, 118, 50, 102, 38, 82, 500, 500, 70, 170, 30, 40, 500, 50, 124, 56, 500, 500, 118, 60, 500, 92, 278, 500, 166, 248, 500, 66, 500, 86, 78, 146, 78, 62, 32, 58, 78, 154, 88, 500, 64, 500, 500, 500, 76, 500, 96, 204, 112, 106, 500, 52, 62, 96, 58, 56, 234, 244, 500, 500, 192, 500, 500, 44, 500, 74, 500, 500, 500, 102, 500, 74, 500, 40, 500, 132, 40, 500, 500, 88, 70, 322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39752968205657835, "mean_inference_ms": 1.2740448521134977, "mean_action_processing_ms": 0.14739535739998375, "mean_env_wait_ms": 0.0859340539665168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02898573875427246, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.10229730606079102}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.905999999999836, "episode_len_mean": 251.58, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, 29.299999999999976, 43.900000000000006, 39.300000000000026, -50.00000000000044, 39.70000000000002, -50.00000000000044, 8.49999999999968, 42.500000000000014, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.7, 38.300000000000026, 45.1, 39.90000000000002, 46.3, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 33.10000000000003, 47.1, 46.099999999999994, -50.00000000000044, 45.1, 37.70000000000003, 44.5, -50.00000000000044, -50.00000000000044, 38.300000000000026, 44.10000000000001, -50.00000000000044, 40.90000000000002, 22.299999999999876, -50.00000000000044, 33.500000000000036, 25.29999999999992, -50.00000000000044, 43.50000000000001, -50.00000000000044, 41.500000000000014, 42.30000000000001, 35.500000000000036, 42.30000000000001, 43.900000000000006, 46.9, 44.300000000000004, 42.30000000000001, 34.70000000000004, 41.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 40.500000000000014, 29.69999999999998, 38.90000000000002, 39.50000000000002, -50.00000000000044, 44.900000000000006, 43.900000000000006, 40.500000000000014, 44.300000000000004, 44.5, 26.69999999999994, 25.699999999999925, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.900000000000034, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.10000000000001, 17.899999999999814], "episode_lengths": [68, 208, 62, 108, 500, 104, 500, 416, 76, 500, 130, 500, 500, 500, 342, 500, 500, 144, 44, 118, 50, 102, 38, 82, 500, 500, 70, 170, 30, 40, 500, 50, 124, 56, 500, 500, 118, 60, 500, 92, 278, 500, 166, 248, 500, 66, 500, 86, 78, 146, 78, 62, 32, 58, 78, 154, 88, 500, 64, 500, 500, 500, 76, 500, 96, 204, 112, 106, 500, 52, 62, 96, 58, 56, 234, 244, 500, 500, 192, 500, 500, 44, 500, 74, 500, 500, 500, 102, 500, 74, 500, 40, 500, 132, 40, 500, 500, 88, 70, 322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39752968205657835, "mean_inference_ms": 1.2740448521134977, "mean_action_processing_ms": 0.14739535739998375, "mean_env_wait_ms": 0.0859340539665168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02898573875427246, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.10229730606079102}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5450.587899881693, "num_env_steps_trained_throughput_per_sec": 5450.587899881693, "timesteps_total": 126000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 3246.221, "sample_time_ms": 2977.03, "load_time_ms": 19.197, "load_throughput": 937645.471, "learn_time_ms": 238.992, "learn_throughput": 75316.261, "synch_weights_time_ms": 9.716}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 434, "training_iteration": 7, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-28", "timestamp": 1698245968, "time_this_iter_s": 3.307156801223755, "time_total_s": 22.7597599029541, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 22.7597599029541, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 62.25999999999999, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0003, "total_loss": 8.886872212092081, "policy_loss": -0.0029094961549465856, "vf_loss": 8.889838377634684, "vf_explained_var": 1.8924474716186523e-06, "kl": 4.0340213556551895e-05, "entropy": 0.5597401708364487, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 90.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.890999999999834, "episode_len_mean": 256.72, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 26.69999999999994, 25.699999999999925, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.900000000000034, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.10000000000001, 17.899999999999814, 32.90000000000003, -50.00000000000044, 40.70000000000002, 41.30000000000001, 23.29999999999989, 44.300000000000004, 36.70000000000003, 42.10000000000001, 41.500000000000014, 40.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.50000000000001, -50.00000000000044, 40.500000000000014, 6.099999999999646, 45.5, -50.00000000000044, 40.90000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 41.500000000000014, -50.00000000000044, 41.100000000000016, 36.70000000000003, 38.50000000000003, 43.30000000000001, 47.1, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, 42.70000000000001, 35.70000000000003, -50.00000000000044, 43.7, 46.099999999999994, 41.30000000000001, 42.30000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.50000000000001, 38.10000000000002, 40.500000000000014, 43.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.10000000000001, -50.00000000000044, 38.10000000000002, 42.10000000000001, 22.099999999999874, 41.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.10000000000002, 31.1, 36.50000000000003], "episode_lengths": [56, 234, 244, 500, 500, 192, 500, 500, 44, 500, 74, 500, 500, 500, 102, 500, 74, 500, 40, 500, 132, 40, 500, 500, 88, 70, 322, 172, 500, 94, 88, 268, 58, 134, 80, 86, 96, 74, 500, 500, 500, 56, 66, 500, 96, 440, 46, 500, 92, 68, 500, 500, 50, 500, 86, 500, 90, 134, 116, 68, 30, 500, 120, 500, 500, 310, 500, 74, 144, 500, 64, 40, 88, 78, 500, 116, 500, 66, 120, 96, 64, 86, 500, 500, 70, 80, 500, 120, 80, 280, 84, 168, 500, 500, 500, 500, 98, 100, 190, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3964858057367172, "mean_inference_ms": 1.2753143170634043, "mean_action_processing_ms": 0.14799234406953643, "mean_env_wait_ms": 0.08674733178000629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02999138832092285, "StateBufferConnector_ms": 0.01000070571899414, "ViewRequirementAgentConnector_ms": 0.10302329063415527}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.890999999999834, "episode_len_mean": 256.72, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 26.69999999999994, 25.699999999999925, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.900000000000034, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.10000000000001, 17.899999999999814, 32.90000000000003, -50.00000000000044, 40.70000000000002, 41.30000000000001, 23.29999999999989, 44.300000000000004, 36.70000000000003, 42.10000000000001, 41.500000000000014, 40.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.50000000000001, -50.00000000000044, 40.500000000000014, 6.099999999999646, 45.5, -50.00000000000044, 40.90000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 41.500000000000014, -50.00000000000044, 41.100000000000016, 36.70000000000003, 38.50000000000003, 43.30000000000001, 47.1, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, 42.70000000000001, 35.70000000000003, -50.00000000000044, 43.7, 46.099999999999994, 41.30000000000001, 42.30000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.50000000000001, 38.10000000000002, 40.500000000000014, 43.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.10000000000001, -50.00000000000044, 38.10000000000002, 42.10000000000001, 22.099999999999874, 41.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.10000000000002, 31.1, 36.50000000000003], "episode_lengths": [56, 234, 244, 500, 500, 192, 500, 500, 44, 500, 74, 500, 500, 500, 102, 500, 74, 500, 40, 500, 132, 40, 500, 500, 88, 70, 322, 172, 500, 94, 88, 268, 58, 134, 80, 86, 96, 74, 500, 500, 500, 56, 66, 500, 96, 440, 46, 500, 92, 68, 500, 500, 50, 500, 86, 500, 90, 134, 116, 68, 30, 500, 120, 500, 500, 310, 500, 74, 144, 500, 64, 40, 88, 78, 500, 116, 500, 66, 120, 96, 64, 86, 500, 500, 70, 80, 500, 120, 80, 280, 84, 168, 500, 500, 500, 500, 98, 100, 190, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3964858057367172, "mean_inference_ms": 1.2753143170634043, "mean_action_processing_ms": 0.14799234406953643, "mean_env_wait_ms": 0.08674733178000629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02999138832092285, "StateBufferConnector_ms": 0.01000070571899414, "ViewRequirementAgentConnector_ms": 0.10302329063415527}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5626.2226824701, "num_env_steps_trained_throughput_per_sec": 5626.2226824701, "timesteps_total": 144000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3240.356, "sample_time_ms": 2978.234, "load_time_ms": 18.521, "load_throughput": 971858.252, "learn_time_ms": 232.475, "learn_throughput": 77427.835, "synch_weights_time_ms": 9.877}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 507, "training_iteration": 8, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-31", "timestamp": 1698245971, "time_this_iter_s": 3.20530366897583, "time_total_s": 25.96506357192993, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 25.96506357192993, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 66.4, "ram_util_percent": 25.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0003, "total_loss": 8.814230839411417, "policy_loss": 0.026250139557911705, "vf_loss": 8.788038810094198, "vf_explained_var": 9.278456370035807e-06, "kl": 0.00022805007389929224, "entropy": 0.5841003408034643, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 102.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.4199999999998445, "episode_len_mean": 246.44, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.70000000000003, -50.00000000000044, 43.7, 46.099999999999994, 41.30000000000001, 42.30000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.50000000000001, 38.10000000000002, 40.500000000000014, 43.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.10000000000001, -50.00000000000044, 38.10000000000002, 42.10000000000001, 22.099999999999874, 41.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.10000000000002, 31.1, 36.50000000000003, -50.00000000000044, 42.900000000000006, 46.099999999999994, 39.50000000000002, -50.00000000000044, 44.10000000000001, 45.5, -50.00000000000044, 41.90000000000001, 24.899999999999913, 36.70000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, 30.699999999999996, 33.70000000000004, 44.10000000000001, 43.10000000000001, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.5, -50.00000000000044, 40.10000000000002, 42.70000000000001, -50.00000000000044, 43.900000000000006, 39.10000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 26.499999999999936, 40.10000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 40.70000000000002, 44.900000000000006, 42.900000000000006, 26.89999999999994, 42.500000000000014, -50.00000000000044, 42.70000000000001, 45.9, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 32.50000000000002, -50.00000000000044, -50.00000000000044, 30.699999999999996, 41.500000000000014, 43.30000000000001, 45.1, 41.500000000000014, -50.00000000000044, 44.300000000000004, 44.900000000000006], "episode_lengths": [144, 500, 64, 40, 88, 78, 500, 116, 500, 66, 120, 96, 64, 86, 500, 500, 70, 80, 500, 120, 80, 280, 84, 168, 500, 500, 500, 500, 98, 100, 190, 136, 500, 72, 40, 106, 500, 60, 46, 500, 82, 252, 134, 500, 500, 122, 194, 164, 60, 70, 212, 500, 500, 500, 130, 36, 500, 100, 74, 500, 62, 110, 58, 500, 500, 236, 100, 500, 68, 500, 500, 62, 500, 94, 52, 72, 232, 76, 500, 74, 42, 126, 500, 500, 500, 500, 500, 500, 88, 176, 500, 500, 194, 86, 68, 50, 86, 500, 58, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39667696294584415, "mean_inference_ms": 1.2736926460790048, "mean_action_processing_ms": 0.14846413647405718, "mean_env_wait_ms": 0.08728403439258674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019002914428710938, "StateBufferConnector_ms": 0.006003856658935547, "ViewRequirementAgentConnector_ms": 0.12184405326843262}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.4199999999998445, "episode_len_mean": 246.44, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.70000000000003, -50.00000000000044, 43.7, 46.099999999999994, 41.30000000000001, 42.30000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.50000000000001, 38.10000000000002, 40.500000000000014, 43.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.10000000000001, -50.00000000000044, 38.10000000000002, 42.10000000000001, 22.099999999999874, 41.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.10000000000002, 31.1, 36.50000000000003, -50.00000000000044, 42.900000000000006, 46.099999999999994, 39.50000000000002, -50.00000000000044, 44.10000000000001, 45.5, -50.00000000000044, 41.90000000000001, 24.899999999999913, 36.70000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, 30.699999999999996, 33.70000000000004, 44.10000000000001, 43.10000000000001, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.5, -50.00000000000044, 40.10000000000002, 42.70000000000001, -50.00000000000044, 43.900000000000006, 39.10000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 26.499999999999936, 40.10000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 40.70000000000002, 44.900000000000006, 42.900000000000006, 26.89999999999994, 42.500000000000014, -50.00000000000044, 42.70000000000001, 45.9, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 32.50000000000002, -50.00000000000044, -50.00000000000044, 30.699999999999996, 41.500000000000014, 43.30000000000001, 45.1, 41.500000000000014, -50.00000000000044, 44.300000000000004, 44.900000000000006], "episode_lengths": [144, 500, 64, 40, 88, 78, 500, 116, 500, 66, 120, 96, 64, 86, 500, 500, 70, 80, 500, 120, 80, 280, 84, 168, 500, 500, 500, 500, 98, 100, 190, 136, 500, 72, 40, 106, 500, 60, 46, 500, 82, 252, 134, 500, 500, 122, 194, 164, 60, 70, 212, 500, 500, 500, 130, 36, 500, 100, 74, 500, 62, 110, 58, 500, 500, 236, 100, 500, 68, 500, 500, 62, 500, 94, 52, 72, 232, 76, 500, 74, 42, 126, 500, 500, 500, 500, 500, 500, 88, 176, 500, 500, 194, 86, 68, 50, 86, 500, 58, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39667696294584415, "mean_inference_ms": 1.2736926460790048, "mean_action_processing_ms": 0.14846413647405718, "mean_env_wait_ms": 0.08728403439258674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019002914428710938, "StateBufferConnector_ms": 0.006003856658935547, "ViewRequirementAgentConnector_ms": 0.12184405326843262}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5388.172828682768, "num_env_steps_trained_throughput_per_sec": 5388.172828682768, "timesteps_total": 162000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 3251.389, "sample_time_ms": 2977.235, "load_time_ms": 18.909, "load_throughput": 951935.454, "learn_time_ms": 244.244, "learn_throughput": 73696.805, "synch_weights_time_ms": 9.779}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "done": false, "episodes_total": 575, "training_iteration": 9, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-35", "timestamp": 1698245975, "time_this_iter_s": 3.3455305099487305, "time_total_s": 29.310594081878662, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 29.310594081878662, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 67.75999999999999, "ram_util_percent": 25.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0003, "total_loss": 8.801351626714071, "policy_loss": 0.010300682236750921, "vf_loss": 8.791110277175903, "vf_explained_var": 2.0613272984822593e-06, "kl": 0.0006784382760069244, "entropy": 0.5961625923713049, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 114.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.321999999999859, "episode_len_mean": 237.5, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 32.50000000000002, -50.00000000000044, -50.00000000000044, 30.699999999999996, 41.500000000000014, 43.30000000000001, 45.1, 41.500000000000014, -50.00000000000044, 44.300000000000004, 44.900000000000006, -50.00000000000044, 40.90000000000002, 42.10000000000001, 42.30000000000001, 42.500000000000014, 8.49999999999968, 40.30000000000002, 42.900000000000006, 41.500000000000014, 35.30000000000004, 43.10000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 6.099999999999646, 26.09999999999993, 43.900000000000006, 44.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.499999999999666, 40.500000000000014, -50.00000000000044, 40.90000000000002, 44.7, 39.90000000000002, 36.10000000000004, -50.00000000000044, 43.7, 44.900000000000006, 14.899999999999771, -50.00000000000044, 45.7, -50.00000000000044, 11.899999999999729, 44.900000000000006, -50.00000000000044, -50.00000000000044, 7.299999999999663, 33.90000000000004, 32.700000000000024, 43.900000000000006, 46.699999999999996, 41.70000000000002, 34.10000000000004, 28.89999999999997, 42.500000000000014, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 38.90000000000002, 35.500000000000036, -50.00000000000044, 25.499999999999922, 40.500000000000014, 43.7, -50.00000000000044, 42.900000000000006, 39.90000000000002, 29.299999999999976, 35.10000000000004, 45.9, 30.499999999999993, 27.49999999999995, 10.699999999999712, 37.300000000000026, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.7, 30.499999999999993, 45.3, -50.00000000000044, 39.50000000000002, 38.10000000000002, 44.5, 20.299999999999848, 44.5], "episode_lengths": [500, 500, 500, 500, 500, 88, 176, 500, 500, 194, 86, 68, 50, 86, 500, 58, 52, 500, 92, 80, 78, 76, 416, 98, 72, 86, 148, 70, 58, 500, 500, 440, 240, 62, 60, 70, 500, 500, 500, 426, 96, 500, 92, 54, 102, 140, 500, 64, 52, 352, 500, 44, 500, 382, 52, 500, 500, 428, 162, 174, 62, 34, 84, 160, 212, 76, 500, 182, 500, 500, 112, 146, 500, 246, 96, 64, 500, 72, 102, 208, 150, 42, 196, 226, 394, 128, 36, 68, 500, 500, 96, 54, 196, 48, 500, 106, 120, 56, 298, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39636156746768314, "mean_inference_ms": 1.269677493656843, "mean_action_processing_ms": 0.14799531060482543, "mean_env_wait_ms": 0.08785921150343831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022027015686035156, "StateBufferConnector_ms": 0.010996103286743164, "ViewRequirementAgentConnector_ms": 0.11266183853149414}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.321999999999859, "episode_len_mean": 237.5, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 32.50000000000002, -50.00000000000044, -50.00000000000044, 30.699999999999996, 41.500000000000014, 43.30000000000001, 45.1, 41.500000000000014, -50.00000000000044, 44.300000000000004, 44.900000000000006, -50.00000000000044, 40.90000000000002, 42.10000000000001, 42.30000000000001, 42.500000000000014, 8.49999999999968, 40.30000000000002, 42.900000000000006, 41.500000000000014, 35.30000000000004, 43.10000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 6.099999999999646, 26.09999999999993, 43.900000000000006, 44.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.499999999999666, 40.500000000000014, -50.00000000000044, 40.90000000000002, 44.7, 39.90000000000002, 36.10000000000004, -50.00000000000044, 43.7, 44.900000000000006, 14.899999999999771, -50.00000000000044, 45.7, -50.00000000000044, 11.899999999999729, 44.900000000000006, -50.00000000000044, -50.00000000000044, 7.299999999999663, 33.90000000000004, 32.700000000000024, 43.900000000000006, 46.699999999999996, 41.70000000000002, 34.10000000000004, 28.89999999999997, 42.500000000000014, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 38.90000000000002, 35.500000000000036, -50.00000000000044, 25.499999999999922, 40.500000000000014, 43.7, -50.00000000000044, 42.900000000000006, 39.90000000000002, 29.299999999999976, 35.10000000000004, 45.9, 30.499999999999993, 27.49999999999995, 10.699999999999712, 37.300000000000026, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.7, 30.499999999999993, 45.3, -50.00000000000044, 39.50000000000002, 38.10000000000002, 44.5, 20.299999999999848, 44.5], "episode_lengths": [500, 500, 500, 500, 500, 88, 176, 500, 500, 194, 86, 68, 50, 86, 500, 58, 52, 500, 92, 80, 78, 76, 416, 98, 72, 86, 148, 70, 58, 500, 500, 440, 240, 62, 60, 70, 500, 500, 500, 426, 96, 500, 92, 54, 102, 140, 500, 64, 52, 352, 500, 44, 500, 382, 52, 500, 500, 428, 162, 174, 62, 34, 84, 160, 212, 76, 500, 182, 500, 500, 112, 146, 500, 246, 96, 64, 500, 72, 102, 208, 150, 42, 196, 226, 394, 128, 36, 68, 500, 500, 96, 54, 196, 48, 500, 106, 120, 56, 298, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39636156746768314, "mean_inference_ms": 1.269677493656843, "mean_action_processing_ms": 0.14799531060482543, "mean_env_wait_ms": 0.08785921150343831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022027015686035156, "StateBufferConnector_ms": 0.010996103286743164, "ViewRequirementAgentConnector_ms": 0.11266183853149414}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5867.021031060505, "num_env_steps_trained_throughput_per_sec": 5867.021031060505, "timesteps_total": 180000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3233.049, "sample_time_ms": 2976.717, "load_time_ms": 17.818, "load_throughput": 1010221.266, "learn_time_ms": 227.627, "learn_throughput": 79076.796, "synch_weights_time_ms": 9.689}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 658, "training_iteration": 10, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-38", "timestamp": 1698245978, "time_this_iter_s": 3.0739951133728027, "time_total_s": 32.384589195251465, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 32.384589195251465, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 61.65, "ram_util_percent": 25.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0003, "total_loss": 8.58622113863627, "policy_loss": -0.013841399302085241, "vf_loss": 8.6001185576121, "vf_explained_var": 5.960464477539063e-08, "kl": 0.0005927192913759427, "entropy": 0.5607602546612421, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 126.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.200999999999857, "episode_len_mean": 233.7, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 25.499999999999922, 40.500000000000014, 43.7, -50.00000000000044, 42.900000000000006, 39.90000000000002, 29.299999999999976, 35.10000000000004, 45.9, 30.499999999999993, 27.49999999999995, 10.699999999999712, 37.300000000000026, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.7, 30.499999999999993, 45.3, -50.00000000000044, 39.50000000000002, 38.10000000000002, 44.5, 20.299999999999848, 44.5, 0.2999999999995637, 43.10000000000001, 46.5, 44.10000000000001, -50.00000000000044, 32.700000000000024, 45.7, -50.00000000000044, 40.90000000000002, 45.1, 46.099999999999994, 19.69999999999984, 40.500000000000014, 6.8999999999996575, 44.7, 44.300000000000004, 35.30000000000004, -50.00000000000044, 40.30000000000002, -50.00000000000044, 40.10000000000002, 37.10000000000003, 40.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.30000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 23.8999999999999, 45.7, 46.699999999999996, 43.50000000000001, 29.299999999999976, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.7, 22.099999999999874, 31.500000000000007, 45.9, 37.90000000000003, -50.00000000000044, 45.3, 23.699999999999896, 47.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.900000000000034, -50.00000000000044, 21.09999999999986, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 35.70000000000003, 47.1, 46.099999999999994, 43.10000000000001, 44.7], "episode_lengths": [500, 246, 96, 64, 500, 72, 102, 208, 150, 42, 196, 226, 394, 128, 36, 68, 500, 500, 96, 54, 196, 48, 500, 106, 120, 56, 298, 56, 498, 70, 36, 60, 500, 174, 44, 500, 92, 50, 40, 304, 96, 432, 54, 58, 148, 500, 98, 500, 100, 130, 96, 500, 48, 500, 138, 500, 500, 86, 78, 116, 500, 500, 500, 500, 500, 500, 118, 500, 262, 44, 34, 66, 208, 500, 116, 500, 64, 280, 186, 42, 122, 500, 48, 264, 26, 500, 40, 500, 152, 500, 290, 500, 66, 500, 500, 144, 30, 40, 70, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39640697168936745, "mean_inference_ms": 1.272422906453995, "mean_action_processing_ms": 0.1492922568902779, "mean_env_wait_ms": 0.08801184132776406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03203940391540527, "StateBufferConnector_ms": 0.010013103485107422, "ViewRequirementAgentConnector_ms": 0.12702727317810059}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.200999999999857, "episode_len_mean": 233.7, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 25.499999999999922, 40.500000000000014, 43.7, -50.00000000000044, 42.900000000000006, 39.90000000000002, 29.299999999999976, 35.10000000000004, 45.9, 30.499999999999993, 27.49999999999995, 10.699999999999712, 37.300000000000026, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.7, 30.499999999999993, 45.3, -50.00000000000044, 39.50000000000002, 38.10000000000002, 44.5, 20.299999999999848, 44.5, 0.2999999999995637, 43.10000000000001, 46.5, 44.10000000000001, -50.00000000000044, 32.700000000000024, 45.7, -50.00000000000044, 40.90000000000002, 45.1, 46.099999999999994, 19.69999999999984, 40.500000000000014, 6.8999999999996575, 44.7, 44.300000000000004, 35.30000000000004, -50.00000000000044, 40.30000000000002, -50.00000000000044, 40.10000000000002, 37.10000000000003, 40.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.30000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 23.8999999999999, 45.7, 46.699999999999996, 43.50000000000001, 29.299999999999976, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.7, 22.099999999999874, 31.500000000000007, 45.9, 37.90000000000003, -50.00000000000044, 45.3, 23.699999999999896, 47.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.900000000000034, -50.00000000000044, 21.09999999999986, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 35.70000000000003, 47.1, 46.099999999999994, 43.10000000000001, 44.7], "episode_lengths": [500, 246, 96, 64, 500, 72, 102, 208, 150, 42, 196, 226, 394, 128, 36, 68, 500, 500, 96, 54, 196, 48, 500, 106, 120, 56, 298, 56, 498, 70, 36, 60, 500, 174, 44, 500, 92, 50, 40, 304, 96, 432, 54, 58, 148, 500, 98, 500, 100, 130, 96, 500, 48, 500, 138, 500, 500, 86, 78, 116, 500, 500, 500, 500, 500, 500, 118, 500, 262, 44, 34, 66, 208, 500, 116, 500, 64, 280, 186, 42, 122, 500, 48, 264, 26, 500, 40, 500, 152, 500, 290, 500, 66, 500, 500, 144, 30, 40, 70, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39640697168936745, "mean_inference_ms": 1.272422906453995, "mean_action_processing_ms": 0.1492922568902779, "mean_env_wait_ms": 0.08801184132776406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03203940391540527, "StateBufferConnector_ms": 0.010013103485107422, "ViewRequirementAgentConnector_ms": 0.12702727317810059}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5367.667840151614, "num_env_steps_trained_throughput_per_sec": 5367.667840151614, "timesteps_total": 198000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 198000, "timers": {"training_iteration_time_ms": 3245.363, "sample_time_ms": 2973.318, "load_time_ms": 19.093, "load_throughput": 942753.256, "learn_time_ms": 242.179, "learn_throughput": 74325.127, "synch_weights_time_ms": 9.474}, "counters": {"num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "done": false, "episodes_total": 730, "training_iteration": 11, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-41", "timestamp": 1698245981, "time_this_iter_s": 3.3584113121032715, "time_total_s": 35.743000507354736, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 35.743000507354736, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 70.46, "ram_util_percent": 25.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0003, "total_loss": 8.3306565284729, "policy_loss": -0.02508801935861508, "vf_loss": 8.355793039004007, "vf_explained_var": 5.359450976053874e-06, "kl": 0.00013068021517407638, "entropy": 0.48493735988934833, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 138.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.5919999999998145, "episode_len_mean": 274.68, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 23.8999999999999, 45.7, 46.699999999999996, 43.50000000000001, 29.299999999999976, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.7, 22.099999999999874, 31.500000000000007, 45.9, 37.90000000000003, -50.00000000000044, 45.3, 23.699999999999896, 47.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.900000000000034, -50.00000000000044, 21.09999999999986, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 35.70000000000003, 47.1, 46.099999999999994, 43.10000000000001, 44.7, -50.00000000000044, 35.10000000000004, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.500000000000014, 45.7, -50.00000000000044, 33.500000000000036, 39.300000000000026, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 21.499999999999865, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 19.499999999999837, 42.70000000000001, 32.700000000000024, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 43.7, 39.300000000000026, 46.699999999999996, -50.00000000000044, 39.70000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.500000000000014, 34.50000000000004, 7.299999999999663, 47.1, 43.30000000000001, 36.900000000000034, 15.899999999999785, 39.300000000000026, 38.300000000000026, 32.700000000000024, 33.500000000000036, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001], "episode_lengths": [500, 500, 500, 500, 500, 118, 500, 262, 44, 34, 66, 208, 500, 116, 500, 64, 280, 186, 42, 122, 500, 48, 264, 26, 500, 40, 500, 152, 500, 290, 500, 66, 500, 500, 144, 30, 40, 70, 54, 500, 150, 62, 500, 500, 500, 500, 48, 500, 86, 44, 500, 166, 108, 500, 56, 500, 500, 500, 54, 500, 286, 238, 500, 500, 500, 122, 500, 306, 74, 174, 118, 500, 500, 32, 500, 48, 64, 108, 34, 500, 104, 500, 76, 500, 76, 156, 428, 30, 68, 132, 342, 108, 118, 174, 166, 280, 500, 500, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39636893796509753, "mean_inference_ms": 1.2718698541623832, "mean_action_processing_ms": 0.14918755301422115, "mean_env_wait_ms": 0.08766486647269799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029988527297973633, "StateBufferConnector_ms": 0.00800633430480957, "ViewRequirementAgentConnector_ms": 0.12685060501098633}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.5919999999998145, "episode_len_mean": 274.68, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 23.8999999999999, 45.7, 46.699999999999996, 43.50000000000001, 29.299999999999976, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.7, 22.099999999999874, 31.500000000000007, 45.9, 37.90000000000003, -50.00000000000044, 45.3, 23.699999999999896, 47.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.900000000000034, -50.00000000000044, 21.09999999999986, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 35.70000000000003, 47.1, 46.099999999999994, 43.10000000000001, 44.7, -50.00000000000044, 35.10000000000004, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.500000000000014, 45.7, -50.00000000000044, 33.500000000000036, 39.300000000000026, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 21.499999999999865, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 19.499999999999837, 42.70000000000001, 32.700000000000024, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 43.7, 39.300000000000026, 46.699999999999996, -50.00000000000044, 39.70000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.500000000000014, 34.50000000000004, 7.299999999999663, 47.1, 43.30000000000001, 36.900000000000034, 15.899999999999785, 39.300000000000026, 38.300000000000026, 32.700000000000024, 33.500000000000036, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001], "episode_lengths": [500, 500, 500, 500, 500, 118, 500, 262, 44, 34, 66, 208, 500, 116, 500, 64, 280, 186, 42, 122, 500, 48, 264, 26, 500, 40, 500, 152, 500, 290, 500, 66, 500, 500, 144, 30, 40, 70, 54, 500, 150, 62, 500, 500, 500, 500, 48, 500, 86, 44, 500, 166, 108, 500, 56, 500, 500, 500, 54, 500, 286, 238, 500, 500, 500, 122, 500, 306, 74, 174, 118, 500, 500, 32, 500, 48, 64, 108, 34, 500, 104, 500, 76, 500, 76, 156, 428, 30, 68, 132, 342, 108, 118, 174, 166, 280, 500, 500, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39636893796509753, "mean_inference_ms": 1.2718698541623832, "mean_action_processing_ms": 0.14918755301422115, "mean_env_wait_ms": 0.08766486647269799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029988527297973633, "StateBufferConnector_ms": 0.00800633430480957, "ViewRequirementAgentConnector_ms": 0.12685060501098633}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5846.111412030306, "num_env_steps_trained_throughput_per_sec": 5846.111412030306, "timesteps_total": 216000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3238.924, "sample_time_ms": 2968.933, "load_time_ms": 18.537, "load_throughput": 971028.579, "learn_time_ms": 240.214, "learn_throughput": 74933.314, "synch_weights_time_ms": 9.741}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 791, "training_iteration": 12, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-44", "timestamp": 1698245984, "time_this_iter_s": 3.0842840671539307, "time_total_s": 38.82728457450867, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 38.82728457450867, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 58.02, "ram_util_percent": 25.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0003, "total_loss": 7.775324463844299, "policy_loss": -0.029990156491597492, "vf_loss": 7.805362780888875, "vf_explained_var": 1.9123156865437827e-06, "kl": 2.2680018984052214e-05, "entropy": 0.4837496479352315, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 150.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1159999999998045, "episode_len_mean": 279.42, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 19.499999999999837, 42.70000000000001, 32.700000000000024, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 43.7, 39.300000000000026, 46.699999999999996, -50.00000000000044, 39.70000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.500000000000014, 34.50000000000004, 7.299999999999663, 47.1, 43.30000000000001, 36.900000000000034, 15.899999999999785, 39.300000000000026, 38.300000000000026, 32.700000000000024, 33.500000000000036, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 33.500000000000036, 37.70000000000003, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 17.299999999999805, 26.09999999999993, 41.30000000000001, 46.5, 46.9, 22.899999999999885, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 40.30000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 8.099999999999675, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.900000000000006, 47.3, 32.30000000000002, -50.00000000000044, 45.1, 38.300000000000026, 43.7, 44.7, 32.30000000000002, 46.099999999999994, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.30000000000001], "episode_lengths": [500, 500, 122, 500, 306, 74, 174, 118, 500, 500, 32, 500, 48, 64, 108, 34, 500, 104, 500, 76, 500, 76, 156, 428, 30, 68, 132, 342, 108, 118, 174, 166, 280, 500, 500, 500, 66, 500, 166, 124, 500, 500, 86, 500, 500, 500, 26, 500, 500, 58, 328, 240, 88, 36, 32, 272, 500, 500, 58, 500, 42, 98, 42, 500, 500, 500, 500, 500, 62, 420, 500, 500, 500, 500, 500, 78, 52, 28, 178, 500, 50, 118, 64, 54, 178, 40, 118, 500, 500, 76, 500, 500, 124, 500, 58, 500, 500, 76, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3952797211967618, "mean_inference_ms": 1.2665255755653262, "mean_action_processing_ms": 0.14838954366552748, "mean_env_wait_ms": 0.08727057980714491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799391746520996, "StateBufferConnector_ms": 0.004745006561279297, "ViewRequirementAgentConnector_ms": 0.12456274032592773}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1159999999998045, "episode_len_mean": 279.42, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 19.499999999999837, 42.70000000000001, 32.700000000000024, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 43.7, 39.300000000000026, 46.699999999999996, -50.00000000000044, 39.70000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.500000000000014, 34.50000000000004, 7.299999999999663, 47.1, 43.30000000000001, 36.900000000000034, 15.899999999999785, 39.300000000000026, 38.300000000000026, 32.700000000000024, 33.500000000000036, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 33.500000000000036, 37.70000000000003, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 17.299999999999805, 26.09999999999993, 41.30000000000001, 46.5, 46.9, 22.899999999999885, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 40.30000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 8.099999999999675, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.900000000000006, 47.3, 32.30000000000002, -50.00000000000044, 45.1, 38.300000000000026, 43.7, 44.7, 32.30000000000002, 46.099999999999994, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.30000000000001], "episode_lengths": [500, 500, 122, 500, 306, 74, 174, 118, 500, 500, 32, 500, 48, 64, 108, 34, 500, 104, 500, 76, 500, 76, 156, 428, 30, 68, 132, 342, 108, 118, 174, 166, 280, 500, 500, 500, 66, 500, 166, 124, 500, 500, 86, 500, 500, 500, 26, 500, 500, 58, 328, 240, 88, 36, 32, 272, 500, 500, 58, 500, 42, 98, 42, 500, 500, 500, 500, 500, 62, 420, 500, 500, 500, 500, 500, 78, 52, 28, 178, 500, 50, 118, 64, 54, 178, 40, 118, 500, 500, 76, 500, 500, 124, 500, 58, 500, 500, 76, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3952797211967618, "mean_inference_ms": 1.2665255755653262, "mean_action_processing_ms": 0.14838954366552748, "mean_env_wait_ms": 0.08727057980714491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799391746520996, "StateBufferConnector_ms": 0.004745006561279297, "ViewRequirementAgentConnector_ms": 0.12456274032592773}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5998.9201582147, "num_env_steps_trained_throughput_per_sec": 5998.9201582147, "timesteps_total": 234000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 234000, "timers": {"training_iteration_time_ms": 3210.572, "sample_time_ms": 2950.265, "load_time_ms": 17.51, "load_throughput": 1027997.489, "learn_time_ms": 231.354, "learn_throughput": 77802.912, "synch_weights_time_ms": 9.744}, "counters": {"num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "done": false, "episodes_total": 854, "training_iteration": 13, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-47", "timestamp": 1698245987, "time_this_iter_s": 3.0052013397216797, "time_total_s": 41.83248591423035, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 41.83248591423035, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 66.8, "ram_util_percent": 25.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0003, "total_loss": 6.949768900871277, "policy_loss": -0.004864624390999476, "vf_loss": 6.954682509104411, "vf_explained_var": -5.960464477539062e-07, "kl": 1.6074385186174805e-05, "entropy": 0.49038399507602054, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 162.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.976000000000237, "episode_len_mean": 310.26, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 40.30000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 8.099999999999675, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.900000000000006, 47.3, 32.30000000000002, -50.00000000000044, 45.1, 38.300000000000026, 43.7, 44.7, 32.30000000000002, 46.099999999999994, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.30000000000001, 41.500000000000014, -50.00000000000044, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.3, 46.3, 34.900000000000034, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 41.500000000000014, 38.50000000000003, 0.49999999999956657, -50.00000000000044, 41.30000000000001, 40.90000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.10000000000002, 32.90000000000003, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 0.2999999999995637, 19.899999999999842, 45.9, 35.500000000000036, 40.500000000000014, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044], "episode_lengths": [500, 58, 500, 42, 98, 42, 500, 500, 500, 500, 500, 62, 420, 500, 500, 500, 500, 500, 78, 52, 28, 178, 500, 50, 118, 64, 54, 178, 40, 118, 500, 500, 76, 500, 500, 124, 500, 58, 500, 500, 76, 500, 68, 86, 500, 472, 500, 500, 42, 500, 500, 500, 500, 500, 500, 500, 36, 48, 38, 152, 42, 500, 500, 500, 500, 64, 500, 86, 116, 496, 500, 88, 92, 60, 500, 500, 500, 500, 62, 500, 500, 100, 172, 88, 500, 500, 94, 498, 302, 42, 146, 96, 500, 60, 500, 500, 88, 500, 278, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39436366872935014, "mean_inference_ms": 1.2608493419346645, "mean_action_processing_ms": 0.14758435329975772, "mean_env_wait_ms": 0.0871305621855747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020788192749023438, "StateBufferConnector_ms": 0.0047452449798583984, "ViewRequirementAgentConnector_ms": 0.09355449676513672}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.976000000000237, "episode_len_mean": 310.26, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 40.30000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 8.099999999999675, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.900000000000006, 47.3, 32.30000000000002, -50.00000000000044, 45.1, 38.300000000000026, 43.7, 44.7, 32.30000000000002, 46.099999999999994, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.30000000000001, 41.500000000000014, -50.00000000000044, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.3, 46.3, 34.900000000000034, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 41.500000000000014, 38.50000000000003, 0.49999999999956657, -50.00000000000044, 41.30000000000001, 40.90000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.10000000000002, 32.90000000000003, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 0.2999999999995637, 19.899999999999842, 45.9, 35.500000000000036, 40.500000000000014, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044], "episode_lengths": [500, 58, 500, 42, 98, 42, 500, 500, 500, 500, 500, 62, 420, 500, 500, 500, 500, 500, 78, 52, 28, 178, 500, 50, 118, 64, 54, 178, 40, 118, 500, 500, 76, 500, 500, 124, 500, 58, 500, 500, 76, 500, 68, 86, 500, 472, 500, 500, 42, 500, 500, 500, 500, 500, 500, 500, 36, 48, 38, 152, 42, 500, 500, 500, 500, 64, 500, 86, 116, 496, 500, 88, 92, 60, 500, 500, 500, 500, 62, 500, 500, 100, 172, 88, 500, 500, 94, 498, 302, 42, 146, 96, 500, 60, 500, 500, 88, 500, 278, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39436366872935014, "mean_inference_ms": 1.2608493419346645, "mean_action_processing_ms": 0.14758435329975772, "mean_env_wait_ms": 0.0871305621855747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020788192749023438, "StateBufferConnector_ms": 0.0047452449798583984, "ViewRequirementAgentConnector_ms": 0.09355449676513672}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 6014.468188093933, "num_env_steps_trained_throughput_per_sec": 6014.468188093933, "timesteps_total": 252000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3194.548, "sample_time_ms": 2941.237, "load_time_ms": 17.979, "load_throughput": 1001141.366, "learn_time_ms": 223.788, "learn_throughput": 80433.387, "synch_weights_time_ms": 9.745}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 911, "training_iteration": 14, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-50", "timestamp": 1698245990, "time_this_iter_s": 2.998495101928711, "time_total_s": 44.83098101615906, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 44.83098101615906, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 63.5, "ram_util_percent": 24.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0003, "total_loss": 6.731406410535176, "policy_loss": 0.030742400636275608, "vf_loss": 6.700715223948161, "vf_explained_var": -7.450580596923828e-08, "kl": 0.00011777373090075353, "entropy": 0.5137749960025152, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 174.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7739999999998037, "episode_len_mean": 282.86, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, 41.500000000000014, 38.50000000000003, 0.49999999999956657, -50.00000000000044, 41.30000000000001, 40.90000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.10000000000002, 32.90000000000003, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 0.2999999999995637, 19.899999999999842, 45.9, 35.500000000000036, 40.500000000000014, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, 44.5, 42.500000000000014, 30.9, -50.00000000000044, 35.900000000000034, 45.3, -50.00000000000044, 0.2999999999995637, 38.700000000000024, 26.69999999999994, 44.10000000000001, 37.300000000000026, 26.69999999999994, 37.10000000000003, 37.70000000000003, 44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 41.500000000000014, 44.7, -50.00000000000044, 44.7, 45.5, 44.10000000000001, 44.900000000000006, 43.900000000000006, 27.099999999999945, 2.499999999999595, 38.700000000000024, 42.10000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 8.099999999999675, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 41.30000000000001, 18.29999999999982, 44.7, 41.500000000000014, 34.900000000000034], "episode_lengths": [64, 500, 86, 116, 496, 500, 88, 92, 60, 500, 500, 500, 500, 62, 500, 500, 100, 172, 88, 500, 500, 94, 498, 302, 42, 146, 96, 500, 60, 500, 500, 88, 500, 278, 500, 500, 56, 76, 192, 500, 142, 48, 500, 498, 114, 234, 60, 128, 234, 130, 124, 58, 70, 500, 500, 68, 500, 500, 500, 500, 500, 40, 500, 500, 40, 500, 500, 500, 150, 86, 54, 500, 54, 46, 60, 52, 62, 230, 476, 114, 80, 500, 500, 86, 500, 500, 50, 420, 500, 34, 500, 500, 500, 194, 500, 88, 318, 54, 86, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39422502861764824, "mean_inference_ms": 1.25699186170713, "mean_action_processing_ms": 0.14704540087081208, "mean_env_wait_ms": 0.08638245174970045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027031898498535156, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.11677074432373047}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7739999999998037, "episode_len_mean": 282.86, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, 41.500000000000014, 38.50000000000003, 0.49999999999956657, -50.00000000000044, 41.30000000000001, 40.90000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.10000000000002, 32.90000000000003, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 0.2999999999995637, 19.899999999999842, 45.9, 35.500000000000036, 40.500000000000014, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, 44.5, 42.500000000000014, 30.9, -50.00000000000044, 35.900000000000034, 45.3, -50.00000000000044, 0.2999999999995637, 38.700000000000024, 26.69999999999994, 44.10000000000001, 37.300000000000026, 26.69999999999994, 37.10000000000003, 37.70000000000003, 44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 41.500000000000014, 44.7, -50.00000000000044, 44.7, 45.5, 44.10000000000001, 44.900000000000006, 43.900000000000006, 27.099999999999945, 2.499999999999595, 38.700000000000024, 42.10000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 8.099999999999675, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 41.30000000000001, 18.29999999999982, 44.7, 41.500000000000014, 34.900000000000034], "episode_lengths": [64, 500, 86, 116, 496, 500, 88, 92, 60, 500, 500, 500, 500, 62, 500, 500, 100, 172, 88, 500, 500, 94, 498, 302, 42, 146, 96, 500, 60, 500, 500, 88, 500, 278, 500, 500, 56, 76, 192, 500, 142, 48, 500, 498, 114, 234, 60, 128, 234, 130, 124, 58, 70, 500, 500, 68, 500, 500, 500, 500, 500, 40, 500, 500, 40, 500, 500, 500, 150, 86, 54, 500, 54, 46, 60, 52, 62, 230, 476, 114, 80, 500, 500, 86, 500, 500, 50, 420, 500, 34, 500, 500, 500, 194, 500, 88, 318, 54, 86, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39422502861764824, "mean_inference_ms": 1.25699186170713, "mean_action_processing_ms": 0.14704540087081208, "mean_env_wait_ms": 0.08638245174970045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027031898498535156, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.11677074432373047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5990.76835327387, "num_env_steps_trained_throughput_per_sec": 5990.76835327387, "timesteps_total": 270000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 3154.309, "sample_time_ms": 2932.643, "load_time_ms": 15.724, "load_throughput": 1144712.796, "learn_time_ms": 194.507, "learn_throughput": 92541.678, "synch_weights_time_ms": 9.636}, "counters": {"num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 976, "training_iteration": 15, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-53", "timestamp": 1698245993, "time_this_iter_s": 3.009622097015381, "time_total_s": 47.84060311317444, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 47.84060311317444, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 65.375, "ram_util_percent": 24.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 0.0003, "total_loss": 6.7687381108601885, "policy_loss": -0.02573288622079417, "vf_loss": 6.794524073600769, "vf_explained_var": 1.7384688059488931e-07, "kl": 0.00026751156640140533, "entropy": 0.5303163205583891, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 186.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.566999999999837, "episode_len_mean": 250.02, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, 44.7, -50.00000000000044, 44.7, 45.5, 44.10000000000001, 44.900000000000006, 43.900000000000006, 27.099999999999945, 2.499999999999595, 38.700000000000024, 42.10000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 8.099999999999675, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 41.30000000000001, 18.29999999999982, 44.7, 41.500000000000014, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 8.899999999999686, 43.900000000000006, 30.699999999999996, 27.49999999999995, 43.10000000000001, 45.7, 42.70000000000001, 34.70000000000004, -50.00000000000044, 37.50000000000003, -50.00000000000044, 37.50000000000003, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 35.70000000000003, 28.499999999999964, 40.30000000000002, 45.9, 29.099999999999973, 29.099999999999973, -50.00000000000044, 21.09999999999986, 43.50000000000001, 42.500000000000014, 44.10000000000001, 32.700000000000024, 21.699999999999868, 40.90000000000002, 46.3, -50.00000000000044, 45.3, 40.70000000000002, 40.90000000000002, 41.500000000000014, 37.10000000000003, 33.90000000000004, -50.00000000000044, 44.900000000000006, 42.30000000000001, 44.5, -50.00000000000044, 46.5, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 45.5, 0.09999999999956088, 40.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, 8.299999999999677, 15.099999999999774, -50.00000000000044, 39.70000000000002, 45.5, 5.499999999999638, -50.00000000000044, -50.00000000000044], "episode_lengths": [86, 54, 500, 54, 46, 60, 52, 62, 230, 476, 114, 80, 500, 500, 86, 500, 500, 50, 420, 500, 34, 500, 500, 500, 194, 500, 88, 318, 54, 86, 152, 500, 500, 500, 46, 412, 62, 194, 226, 70, 44, 74, 154, 500, 126, 500, 126, 54, 34, 500, 500, 144, 216, 98, 42, 210, 210, 500, 290, 66, 76, 60, 174, 284, 92, 38, 500, 48, 94, 92, 86, 130, 162, 500, 52, 78, 56, 500, 36, 126, 500, 500, 500, 64, 500, 500, 46, 500, 96, 54, 500, 500, 418, 350, 500, 104, 46, 446, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39413230258763365, "mean_inference_ms": 1.2562418895534109, "mean_action_processing_ms": 0.14689039273350907, "mean_env_wait_ms": 0.08661574509485251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02983570098876953, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.11598634719848633}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.566999999999837, "episode_len_mean": 250.02, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, 44.7, -50.00000000000044, 44.7, 45.5, 44.10000000000001, 44.900000000000006, 43.900000000000006, 27.099999999999945, 2.499999999999595, 38.700000000000024, 42.10000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 8.099999999999675, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 41.30000000000001, 18.29999999999982, 44.7, 41.500000000000014, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 8.899999999999686, 43.900000000000006, 30.699999999999996, 27.49999999999995, 43.10000000000001, 45.7, 42.70000000000001, 34.70000000000004, -50.00000000000044, 37.50000000000003, -50.00000000000044, 37.50000000000003, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 35.70000000000003, 28.499999999999964, 40.30000000000002, 45.9, 29.099999999999973, 29.099999999999973, -50.00000000000044, 21.09999999999986, 43.50000000000001, 42.500000000000014, 44.10000000000001, 32.700000000000024, 21.699999999999868, 40.90000000000002, 46.3, -50.00000000000044, 45.3, 40.70000000000002, 40.90000000000002, 41.500000000000014, 37.10000000000003, 33.90000000000004, -50.00000000000044, 44.900000000000006, 42.30000000000001, 44.5, -50.00000000000044, 46.5, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 45.5, 0.09999999999956088, 40.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, 8.299999999999677, 15.099999999999774, -50.00000000000044, 39.70000000000002, 45.5, 5.499999999999638, -50.00000000000044, -50.00000000000044], "episode_lengths": [86, 54, 500, 54, 46, 60, 52, 62, 230, 476, 114, 80, 500, 500, 86, 500, 500, 50, 420, 500, 34, 500, 500, 500, 194, 500, 88, 318, 54, 86, 152, 500, 500, 500, 46, 412, 62, 194, 226, 70, 44, 74, 154, 500, 126, 500, 126, 54, 34, 500, 500, 144, 216, 98, 42, 210, 210, 500, 290, 66, 76, 60, 174, 284, 92, 38, 500, 48, 94, 92, 86, 130, 162, 500, 52, 78, 56, 500, 36, 126, 500, 500, 500, 64, 500, 500, 46, 500, 96, 54, 500, 500, 418, 350, 500, 104, 46, 446, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39413230258763365, "mean_inference_ms": 1.2562418895534109, "mean_action_processing_ms": 0.14689039273350907, "mean_env_wait_ms": 0.08661574509485251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02983570098876953, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.11598634719848633}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5488.961583107333, "num_env_steps_trained_throughput_per_sec": 5488.961583107333, "timesteps_total": 288000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 3161.798, "sample_time_ms": 2931.897, "load_time_ms": 15.514, "load_throughput": 1160275.033, "learn_time_ms": 202.857, "learn_throughput": 88732.606, "synch_weights_time_ms": 9.731}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1045, "training_iteration": 16, "trial_id": "9f288_00006", "date": "2023-10-25_15-59-57", "timestamp": 1698245997, "time_this_iter_s": 3.2843081951141357, "time_total_s": 51.124911308288574, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 51.124911308288574, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 65.46000000000001, "ram_util_percent": 24.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 0.0003, "total_loss": 6.669492880503337, "policy_loss": -0.039759488155444465, "vf_loss": 6.709307312965393, "vf_explained_var": 7.847944895426432e-07, "kl": 0.00016759724121110745, "entropy": 0.5478400588035583, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 198.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.2819999999998004, "episode_len_mean": 277.76, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, 41.500000000000014, 37.10000000000003, 33.90000000000004, -50.00000000000044, 44.900000000000006, 42.30000000000001, 44.5, -50.00000000000044, 46.5, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 45.5, 0.09999999999956088, 40.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, 8.299999999999677, 15.099999999999774, -50.00000000000044, 39.70000000000002, 45.5, 5.499999999999638, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 42.70000000000001, 46.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, 46.099999999999994, 45.3, 36.10000000000004, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 34.70000000000004, 42.500000000000014, 23.8999999999999, -50.00000000000044, 38.90000000000002, 26.69999999999994, 44.300000000000004, -50.00000000000044, 43.30000000000001, 42.500000000000014, 32.50000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 27.099999999999945, 46.3, -50.00000000000044, 42.70000000000001, 44.7, 8.299999999999677, 42.900000000000006, -50.00000000000044, 42.10000000000001, 43.7, 45.3, -50.00000000000044, 45.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 37.70000000000003], "episode_lengths": [92, 86, 130, 162, 500, 52, 78, 56, 500, 36, 126, 500, 500, 500, 64, 500, 500, 46, 500, 96, 54, 500, 500, 418, 350, 500, 104, 46, 446, 500, 500, 500, 110, 500, 114, 500, 500, 112, 500, 74, 36, 500, 50, 500, 500, 68, 66, 40, 48, 140, 66, 56, 500, 500, 500, 500, 100, 154, 76, 262, 500, 112, 234, 58, 500, 68, 76, 176, 500, 72, 500, 500, 230, 38, 500, 74, 54, 418, 72, 500, 80, 64, 48, 500, 44, 500, 60, 500, 500, 500, 96, 500, 36, 500, 500, 500, 500, 500, 28, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3953932223746508, "mean_inference_ms": 1.259784152787238, "mean_action_processing_ms": 0.1476291364390839, "mean_env_wait_ms": 0.08660975929816918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699756622314453, "StateBufferConnector_ms": 0.008999824523925781, "ViewRequirementAgentConnector_ms": 0.1130061149597168}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.2819999999998004, "episode_len_mean": 277.76, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, 41.500000000000014, 37.10000000000003, 33.90000000000004, -50.00000000000044, 44.900000000000006, 42.30000000000001, 44.5, -50.00000000000044, 46.5, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 45.5, 0.09999999999956088, 40.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, 8.299999999999677, 15.099999999999774, -50.00000000000044, 39.70000000000002, 45.5, 5.499999999999638, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 42.70000000000001, 46.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, 46.099999999999994, 45.3, 36.10000000000004, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 34.70000000000004, 42.500000000000014, 23.8999999999999, -50.00000000000044, 38.90000000000002, 26.69999999999994, 44.300000000000004, -50.00000000000044, 43.30000000000001, 42.500000000000014, 32.50000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 27.099999999999945, 46.3, -50.00000000000044, 42.70000000000001, 44.7, 8.299999999999677, 42.900000000000006, -50.00000000000044, 42.10000000000001, 43.7, 45.3, -50.00000000000044, 45.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 37.70000000000003], "episode_lengths": [92, 86, 130, 162, 500, 52, 78, 56, 500, 36, 126, 500, 500, 500, 64, 500, 500, 46, 500, 96, 54, 500, 500, 418, 350, 500, 104, 46, 446, 500, 500, 500, 110, 500, 114, 500, 500, 112, 500, 74, 36, 500, 50, 500, 500, 68, 66, 40, 48, 140, 66, 56, 500, 500, 500, 500, 100, 154, 76, 262, 500, 112, 234, 58, 500, 68, 76, 176, 500, 72, 500, 500, 230, 38, 500, 74, 54, 418, 72, 500, 80, 64, 48, 500, 44, 500, 60, 500, 500, 500, 96, 500, 36, 500, 500, 500, 500, 500, 28, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3953932223746508, "mean_inference_ms": 1.259784152787238, "mean_action_processing_ms": 0.1476291364390839, "mean_env_wait_ms": 0.08660975929816918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699756622314453, "StateBufferConnector_ms": 0.008999824523925781, "ViewRequirementAgentConnector_ms": 0.1130061149597168}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5630.594947837317, "num_env_steps_trained_throughput_per_sec": 5630.594947837317, "timesteps_total": 306000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 306000, "timers": {"training_iteration_time_ms": 3151.341, "sample_time_ms": 2946.019, "load_time_ms": 14.173, "load_throughput": 1269977.106, "learn_time_ms": 179.338, "learn_throughput": 100369.014, "synch_weights_time_ms": 10.011}, "counters": {"num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "done": false, "episodes_total": 1114, "training_iteration": 17, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-00", "timestamp": 1698246000, "time_this_iter_s": 3.2021539211273193, "time_total_s": 54.327065229415894, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 54.327065229415894, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 67.27499999999999, "ram_util_percent": 25.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 0.0003, "total_loss": 7.324969093004863, "policy_loss": 0.008258152132232984, "vf_loss": 7.316762646039327, "vf_explained_var": 3.526608149210612e-07, "kl": 0.00043261993353027606, "entropy": 0.5169030850132307, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 210.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.803999999999826, "episode_len_mean": 262.62, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 44.7, 8.299999999999677, 42.900000000000006, -50.00000000000044, 42.10000000000001, 43.7, 45.3, -50.00000000000044, 45.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 37.70000000000003, 28.29999999999996, 36.50000000000003, 41.90000000000001, 40.10000000000002, 39.50000000000002, 40.30000000000002, 46.3, 46.5, -50.00000000000044, 45.5, 45.3, 19.09999999999983, 41.500000000000014, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 36.900000000000034, 1.099999999999575, 32.50000000000002, -50.00000000000044, -50.00000000000044, 45.7, 27.699999999999953, 43.10000000000001, 22.099999999999874, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 41.100000000000016, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.699999999999996, 44.900000000000006, 45.7, 26.69999999999994, 21.499999999999865, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 29.299999999999976, 41.100000000000016, 27.899999999999956, -50.00000000000044, -50.00000000000044, 45.7, 5.6999999999996405, 5.299999999999635, -50.00000000000044, 17.899999999999814, -50.00000000000044, 37.70000000000003, 42.500000000000014, -50.00000000000044, 9.8999999999997, -50.00000000000044, 43.10000000000001, 36.30000000000003, 26.09999999999993, 44.10000000000001, 45.3, -50.00000000000044, 30.499999999999993, 40.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, 41.90000000000001, 41.100000000000016, 43.900000000000006, 43.30000000000001, 39.50000000000002], "episode_lengths": [500, 74, 54, 418, 72, 500, 80, 64, 48, 500, 44, 500, 60, 500, 500, 500, 96, 500, 36, 500, 500, 500, 500, 500, 28, 124, 218, 136, 82, 100, 106, 98, 38, 36, 500, 46, 48, 310, 86, 500, 162, 500, 500, 132, 490, 176, 500, 500, 44, 224, 70, 280, 70, 500, 500, 88, 90, 500, 120, 500, 34, 52, 44, 234, 286, 500, 500, 472, 208, 90, 222, 500, 500, 44, 444, 448, 500, 322, 500, 124, 76, 500, 402, 500, 70, 138, 240, 60, 48, 500, 196, 100, 500, 52, 500, 82, 90, 62, 68, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3966387655494516, "mean_inference_ms": 1.2646752955125595, "mean_action_processing_ms": 0.14864502668226048, "mean_env_wait_ms": 0.08757940998177852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500485420227051, "StateBufferConnector_ms": 0.010996818542480469, "ViewRequirementAgentConnector_ms": 0.1080024242401123}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.803999999999826, "episode_len_mean": 262.62, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 44.7, 8.299999999999677, 42.900000000000006, -50.00000000000044, 42.10000000000001, 43.7, 45.3, -50.00000000000044, 45.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 37.70000000000003, 28.29999999999996, 36.50000000000003, 41.90000000000001, 40.10000000000002, 39.50000000000002, 40.30000000000002, 46.3, 46.5, -50.00000000000044, 45.5, 45.3, 19.09999999999983, 41.500000000000014, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 36.900000000000034, 1.099999999999575, 32.50000000000002, -50.00000000000044, -50.00000000000044, 45.7, 27.699999999999953, 43.10000000000001, 22.099999999999874, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 41.100000000000016, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.699999999999996, 44.900000000000006, 45.7, 26.69999999999994, 21.499999999999865, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 29.299999999999976, 41.100000000000016, 27.899999999999956, -50.00000000000044, -50.00000000000044, 45.7, 5.6999999999996405, 5.299999999999635, -50.00000000000044, 17.899999999999814, -50.00000000000044, 37.70000000000003, 42.500000000000014, -50.00000000000044, 9.8999999999997, -50.00000000000044, 43.10000000000001, 36.30000000000003, 26.09999999999993, 44.10000000000001, 45.3, -50.00000000000044, 30.499999999999993, 40.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, 41.90000000000001, 41.100000000000016, 43.900000000000006, 43.30000000000001, 39.50000000000002], "episode_lengths": [500, 74, 54, 418, 72, 500, 80, 64, 48, 500, 44, 500, 60, 500, 500, 500, 96, 500, 36, 500, 500, 500, 500, 500, 28, 124, 218, 136, 82, 100, 106, 98, 38, 36, 500, 46, 48, 310, 86, 500, 162, 500, 500, 132, 490, 176, 500, 500, 44, 224, 70, 280, 70, 500, 500, 88, 90, 500, 120, 500, 34, 52, 44, 234, 286, 500, 500, 472, 208, 90, 222, 500, 500, 44, 444, 448, 500, 322, 500, 124, 76, 500, 402, 500, 70, 138, 240, 60, 48, 500, 196, 100, 500, 52, 500, 82, 90, 62, 68, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3966387655494516, "mean_inference_ms": 1.2646752955125595, "mean_action_processing_ms": 0.14864502668226048, "mean_env_wait_ms": 0.08757940998177852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500485420227051, "StateBufferConnector_ms": 0.010996818542480469, "ViewRequirementAgentConnector_ms": 0.1080024242401123}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5478.722650008276, "num_env_steps_trained_throughput_per_sec": 5478.722650008276, "timesteps_total": 324000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 3159.854, "sample_time_ms": 2965.91, "load_time_ms": 13.596, "load_throughput": 1323947.987, "learn_time_ms": 168.602, "learn_throughput": 106760.396, "synch_weights_time_ms": 9.847}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1188, "training_iteration": 18, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-03", "timestamp": 1698246003, "time_this_iter_s": 3.2902514934539795, "time_total_s": 57.61731672286987, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 57.61731672286987, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 77.52000000000001, "ram_util_percent": 25.419999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 0.0003, "total_loss": 6.65824814637502, "policy_loss": 0.02350042387843132, "vf_loss": 6.634803811709086, "vf_explained_var": -3.973642985026042e-07, "kl": 0.0005031987356526694, "entropy": 0.5611702104409536, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 222.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.522999999999829, "episode_len_mean": 260.44, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.8999999999996007, 29.299999999999976, 41.100000000000016, 27.899999999999956, -50.00000000000044, -50.00000000000044, 45.7, 5.6999999999996405, 5.299999999999635, -50.00000000000044, 17.899999999999814, -50.00000000000044, 37.70000000000003, 42.500000000000014, -50.00000000000044, 9.8999999999997, -50.00000000000044, 43.10000000000001, 36.30000000000003, 26.09999999999993, 44.10000000000001, 45.3, -50.00000000000044, 30.499999999999993, 40.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, 41.90000000000001, 41.100000000000016, 43.900000000000006, 43.30000000000001, 39.50000000000002, -50.00000000000044, 45.9, 43.50000000000001, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.10000000000001, 44.10000000000001, 45.7, -50.00000000000044, 44.300000000000004, 39.50000000000002, -50.00000000000044, 29.69999999999998, 33.500000000000036, 42.10000000000001, -50.00000000000044, 44.10000000000001, 8.099999999999675, 6.8999999999996575, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 35.500000000000036, 37.70000000000003, 41.500000000000014, -50.00000000000044, 3.2999999999996064, 41.70000000000002, 40.500000000000014, -50.00000000000044, 42.30000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 37.70000000000003, 46.3, 28.699999999999967, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.7, 21.499999999999865, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 34.900000000000034, 46.099999999999994, 34.70000000000004, 31.70000000000001, 40.10000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.5, 42.70000000000001], "episode_lengths": [472, 208, 90, 222, 500, 500, 44, 444, 448, 500, 322, 500, 124, 76, 500, 402, 500, 70, 138, 240, 60, 48, 500, 196, 100, 500, 52, 500, 82, 90, 62, 68, 106, 500, 42, 66, 48, 500, 70, 500, 60, 60, 44, 500, 58, 106, 500, 204, 166, 80, 500, 60, 420, 432, 500, 500, 500, 82, 66, 500, 500, 146, 124, 86, 500, 468, 84, 96, 500, 78, 74, 500, 500, 58, 124, 38, 214, 88, 500, 500, 76, 500, 44, 286, 322, 500, 500, 500, 60, 500, 152, 40, 154, 184, 100, 500, 100, 500, 46, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3973666432728804, "mean_inference_ms": 1.2682660646895736, "mean_action_processing_ms": 0.14904467819209555, "mean_env_wait_ms": 0.08763075816684843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027001619338989258, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.1169736385345459}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.522999999999829, "episode_len_mean": 260.44, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.8999999999996007, 29.299999999999976, 41.100000000000016, 27.899999999999956, -50.00000000000044, -50.00000000000044, 45.7, 5.6999999999996405, 5.299999999999635, -50.00000000000044, 17.899999999999814, -50.00000000000044, 37.70000000000003, 42.500000000000014, -50.00000000000044, 9.8999999999997, -50.00000000000044, 43.10000000000001, 36.30000000000003, 26.09999999999993, 44.10000000000001, 45.3, -50.00000000000044, 30.499999999999993, 40.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, 41.90000000000001, 41.100000000000016, 43.900000000000006, 43.30000000000001, 39.50000000000002, -50.00000000000044, 45.9, 43.50000000000001, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.10000000000001, 44.10000000000001, 45.7, -50.00000000000044, 44.300000000000004, 39.50000000000002, -50.00000000000044, 29.69999999999998, 33.500000000000036, 42.10000000000001, -50.00000000000044, 44.10000000000001, 8.099999999999675, 6.8999999999996575, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 35.500000000000036, 37.70000000000003, 41.500000000000014, -50.00000000000044, 3.2999999999996064, 41.70000000000002, 40.500000000000014, -50.00000000000044, 42.30000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 37.70000000000003, 46.3, 28.699999999999967, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.7, 21.499999999999865, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 34.900000000000034, 46.099999999999994, 34.70000000000004, 31.70000000000001, 40.10000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.5, 42.70000000000001], "episode_lengths": [472, 208, 90, 222, 500, 500, 44, 444, 448, 500, 322, 500, 124, 76, 500, 402, 500, 70, 138, 240, 60, 48, 500, 196, 100, 500, 52, 500, 82, 90, 62, 68, 106, 500, 42, 66, 48, 500, 70, 500, 60, 60, 44, 500, 58, 106, 500, 204, 166, 80, 500, 60, 420, 432, 500, 500, 500, 82, 66, 500, 500, 146, 124, 86, 500, 468, 84, 96, 500, 78, 74, 500, 500, 58, 124, 38, 214, 88, 500, 500, 76, 500, 44, 286, 322, 500, 500, 500, 60, 500, 152, 40, 154, 184, 100, 500, 100, 500, 46, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3973666432728804, "mean_inference_ms": 1.2682660646895736, "mean_action_processing_ms": 0.14904467819209555, "mean_env_wait_ms": 0.08763075816684843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027001619338989258, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.1169736385345459}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5261.601435608073, "num_env_steps_trained_throughput_per_sec": 5261.601435608073, "timesteps_total": 342000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 342000, "timers": {"training_iteration_time_ms": 3167.99, "sample_time_ms": 2978.683, "load_time_ms": 13.567, "load_throughput": 1326781.893, "learn_time_ms": 163.995, "learn_throughput": 109759.713, "synch_weights_time_ms": 9.846}, "counters": {"num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "done": false, "episodes_total": 1255, "training_iteration": 19, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-07", "timestamp": 1698246007, "time_this_iter_s": 3.426729202270508, "time_total_s": 61.04404592514038, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 61.04404592514038, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 71.5, "ram_util_percent": 25.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 0.0003, "total_loss": 7.314212163289388, "policy_loss": -0.009121538450320562, "vf_loss": 7.323393066724141, "vf_explained_var": -3.476937611897787e-08, "kl": 0.00024556765824475707, "entropy": 0.5956540952126185, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 234.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.573999999999828, "episode_len_mean": 264.92, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 37.70000000000003, 46.3, 28.699999999999967, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.7, 21.499999999999865, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 34.900000000000034, 46.099999999999994, 34.70000000000004, 31.70000000000001, 40.10000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.5, 42.70000000000001, 9.299999999999692, 46.099999999999994, 6.8999999999996575, 7.699999999999669, 37.70000000000003, 42.900000000000006, -50.00000000000044, 40.70000000000002, 44.300000000000004, 25.899999999999928, -50.00000000000044, 30.699999999999996, 42.900000000000006, 46.699999999999996, -50.00000000000044, 40.90000000000002, -50.00000000000044, 44.7, 44.10000000000001, 46.699999999999996, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, 43.10000000000001, 6.499999999999652, -50.00000000000044, 36.10000000000004, 41.70000000000002, 39.50000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 32.90000000000003, 40.30000000000002, -50.00000000000044, 41.30000000000001, 42.10000000000001, 28.699999999999967, -50.00000000000044, 22.099999999999874, 38.90000000000002, 31.500000000000007, 41.70000000000002, 32.50000000000002, 23.29999999999989, -50.00000000000044, -50.00000000000044, 14.899999999999771, -50.00000000000044, 14.499999999999766, -50.00000000000044, 40.10000000000002, -50.00000000000044, 16.699999999999797, 45.1, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 28.89999999999997, -50.00000000000044, -50.00000000000044, 34.70000000000004, 43.30000000000001], "episode_lengths": [500, 78, 74, 500, 500, 58, 124, 38, 214, 88, 500, 500, 76, 500, 44, 286, 322, 500, 500, 500, 60, 500, 152, 40, 154, 184, 100, 500, 100, 500, 46, 74, 408, 40, 432, 424, 124, 72, 500, 94, 58, 242, 500, 194, 72, 34, 500, 92, 500, 54, 60, 34, 500, 88, 46, 500, 70, 436, 500, 140, 84, 106, 500, 86, 500, 44, 500, 172, 98, 500, 88, 80, 214, 500, 280, 112, 186, 84, 176, 268, 500, 500, 352, 500, 356, 500, 100, 500, 334, 50, 86, 500, 500, 500, 176, 212, 500, 500, 154, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39975016179245493, "mean_inference_ms": 1.273609527787284, "mean_action_processing_ms": 0.1492101103518944, "mean_env_wait_ms": 0.08783860072621877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028973817825317383, "StateBufferConnector_ms": 0.008073568344116211, "ViewRequirementAgentConnector_ms": 0.13472652435302734}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.573999999999828, "episode_len_mean": 264.92, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 37.70000000000003, 46.3, 28.699999999999967, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.7, 21.499999999999865, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 34.900000000000034, 46.099999999999994, 34.70000000000004, 31.70000000000001, 40.10000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.5, 42.70000000000001, 9.299999999999692, 46.099999999999994, 6.8999999999996575, 7.699999999999669, 37.70000000000003, 42.900000000000006, -50.00000000000044, 40.70000000000002, 44.300000000000004, 25.899999999999928, -50.00000000000044, 30.699999999999996, 42.900000000000006, 46.699999999999996, -50.00000000000044, 40.90000000000002, -50.00000000000044, 44.7, 44.10000000000001, 46.699999999999996, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, 43.10000000000001, 6.499999999999652, -50.00000000000044, 36.10000000000004, 41.70000000000002, 39.50000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 32.90000000000003, 40.30000000000002, -50.00000000000044, 41.30000000000001, 42.10000000000001, 28.699999999999967, -50.00000000000044, 22.099999999999874, 38.90000000000002, 31.500000000000007, 41.70000000000002, 32.50000000000002, 23.29999999999989, -50.00000000000044, -50.00000000000044, 14.899999999999771, -50.00000000000044, 14.499999999999766, -50.00000000000044, 40.10000000000002, -50.00000000000044, 16.699999999999797, 45.1, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 28.89999999999997, -50.00000000000044, -50.00000000000044, 34.70000000000004, 43.30000000000001], "episode_lengths": [500, 78, 74, 500, 500, 58, 124, 38, 214, 88, 500, 500, 76, 500, 44, 286, 322, 500, 500, 500, 60, 500, 152, 40, 154, 184, 100, 500, 100, 500, 46, 74, 408, 40, 432, 424, 124, 72, 500, 94, 58, 242, 500, 194, 72, 34, 500, 92, 500, 54, 60, 34, 500, 88, 46, 500, 70, 436, 500, 140, 84, 106, 500, 86, 500, 44, 500, 172, 98, 500, 88, 80, 214, 500, 280, 112, 186, 84, 176, 268, 500, 500, 352, 500, 356, 500, 100, 500, 334, 50, 86, 500, 500, 500, 176, 212, 500, 500, 154, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39975016179245493, "mean_inference_ms": 1.273609527787284, "mean_action_processing_ms": 0.1492101103518944, "mean_env_wait_ms": 0.08783860072621877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028973817825317383, "StateBufferConnector_ms": 0.008073568344116211, "ViewRequirementAgentConnector_ms": 0.13472652435302734}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5387.3946158216595, "num_env_steps_trained_throughput_per_sec": 5387.3946158216595, "timesteps_total": 360000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 3195.304, "sample_time_ms": 3005.81, "load_time_ms": 13.739, "load_throughput": 1310117.255, "learn_time_ms": 164.291, "learn_throughput": 109561.692, "synch_weights_time_ms": 9.562}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1323, "training_iteration": 20, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-10", "timestamp": 1698246010, "time_this_iter_s": 3.5462217330932617, "time_total_s": 64.59026765823364, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 64.59026765823364, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 70.52000000000001, "ram_util_percent": 25.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0003, "total_loss": 7.126242280006409, "policy_loss": -0.031085953426857788, "vf_loss": 7.157385349273682, "vf_explained_var": -1.3460715611775715e-06, "kl": 0.0014083493594796437, "entropy": 0.5684474805990855, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 246.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.781999999999854, "episode_len_mean": 252.88, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.90000000000002, 31.500000000000007, 41.70000000000002, 32.50000000000002, 23.29999999999989, -50.00000000000044, -50.00000000000044, 14.899999999999771, -50.00000000000044, 14.499999999999766, -50.00000000000044, 40.10000000000002, -50.00000000000044, 16.699999999999797, 45.1, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 28.89999999999997, -50.00000000000044, -50.00000000000044, 34.70000000000004, 43.30000000000001, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, 40.70000000000002, 41.70000000000002, 26.89999999999994, 44.7, 43.30000000000001, 41.70000000000002, -50.00000000000044, 20.299999999999848, 44.900000000000006, 44.10000000000001, -50.00000000000044, 28.499999999999964, 38.300000000000026, -50.00000000000044, 39.70000000000002, 45.9, 38.10000000000002, 41.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, 42.30000000000001, 31.500000000000007, 37.10000000000003, 38.90000000000002, 4.299999999999621, 26.69999999999994, 37.90000000000003, 42.70000000000001, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, 10.099999999999703, 42.70000000000001, 28.499999999999964, -50.00000000000044, 29.099999999999973, 38.90000000000002, 37.10000000000003, -50.00000000000044, 39.70000000000002, 34.10000000000004, -50.00000000000044, 41.90000000000001, 34.10000000000004, 45.3, 38.50000000000003, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.50000000000001, -50.00000000000044, 29.299999999999976, 31.300000000000004, 32.100000000000016, 3.899999999999615, 34.70000000000004, 38.700000000000024, 42.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, 36.70000000000003, -50.00000000000044, 28.499999999999964], "episode_lengths": [112, 186, 84, 176, 268, 500, 500, 352, 500, 356, 500, 100, 500, 334, 50, 86, 500, 500, 500, 176, 212, 500, 500, 154, 68, 500, 46, 70, 500, 94, 84, 232, 54, 68, 84, 500, 298, 52, 60, 500, 216, 118, 500, 104, 42, 120, 84, 60, 500, 500, 152, 78, 186, 130, 112, 458, 234, 122, 74, 500, 46, 54, 500, 500, 400, 74, 216, 500, 210, 112, 130, 500, 104, 160, 500, 82, 160, 48, 116, 158, 500, 500, 500, 74, 66, 500, 208, 188, 180, 462, 154, 114, 80, 84, 500, 500, 112, 134, 500, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40093098711507297, "mean_inference_ms": 1.277336706478244, "mean_action_processing_ms": 0.15009690799592787, "mean_env_wait_ms": 0.08808436523731732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03696393966674805, "StateBufferConnector_ms": 0.0060765743255615234, "ViewRequirementAgentConnector_ms": 0.13449954986572266}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.781999999999854, "episode_len_mean": 252.88, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.90000000000002, 31.500000000000007, 41.70000000000002, 32.50000000000002, 23.29999999999989, -50.00000000000044, -50.00000000000044, 14.899999999999771, -50.00000000000044, 14.499999999999766, -50.00000000000044, 40.10000000000002, -50.00000000000044, 16.699999999999797, 45.1, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 28.89999999999997, -50.00000000000044, -50.00000000000044, 34.70000000000004, 43.30000000000001, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, 40.70000000000002, 41.70000000000002, 26.89999999999994, 44.7, 43.30000000000001, 41.70000000000002, -50.00000000000044, 20.299999999999848, 44.900000000000006, 44.10000000000001, -50.00000000000044, 28.499999999999964, 38.300000000000026, -50.00000000000044, 39.70000000000002, 45.9, 38.10000000000002, 41.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, 42.30000000000001, 31.500000000000007, 37.10000000000003, 38.90000000000002, 4.299999999999621, 26.69999999999994, 37.90000000000003, 42.70000000000001, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, 10.099999999999703, 42.70000000000001, 28.499999999999964, -50.00000000000044, 29.099999999999973, 38.90000000000002, 37.10000000000003, -50.00000000000044, 39.70000000000002, 34.10000000000004, -50.00000000000044, 41.90000000000001, 34.10000000000004, 45.3, 38.50000000000003, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.50000000000001, -50.00000000000044, 29.299999999999976, 31.300000000000004, 32.100000000000016, 3.899999999999615, 34.70000000000004, 38.700000000000024, 42.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, 36.70000000000003, -50.00000000000044, 28.499999999999964], "episode_lengths": [112, 186, 84, 176, 268, 500, 500, 352, 500, 356, 500, 100, 500, 334, 50, 86, 500, 500, 500, 176, 212, 500, 500, 154, 68, 500, 46, 70, 500, 94, 84, 232, 54, 68, 84, 500, 298, 52, 60, 500, 216, 118, 500, 104, 42, 120, 84, 60, 500, 500, 152, 78, 186, 130, 112, 458, 234, 122, 74, 500, 46, 54, 500, 500, 400, 74, 216, 500, 210, 112, 130, 500, 104, 160, 500, 82, 160, 48, 116, 158, 500, 500, 500, 74, 66, 500, 208, 188, 180, 462, 154, 114, 80, 84, 500, 500, 112, 134, 500, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40093098711507297, "mean_inference_ms": 1.277336706478244, "mean_action_processing_ms": 0.15009690799592787, "mean_env_wait_ms": 0.08808436523731732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03696393966674805, "StateBufferConnector_ms": 0.0060765743255615234, "ViewRequirementAgentConnector_ms": 0.13449954986572266}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5238.047537393453, "num_env_steps_trained_throughput_per_sec": 5238.047537393453, "timesteps_total": 378000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 378000, "timers": {"training_iteration_time_ms": 3203.602, "sample_time_ms": 3012.819, "load_time_ms": 13.41, "load_throughput": 1342241.708, "learn_time_ms": 165.522, "learn_throughput": 108746.574, "synch_weights_time_ms": 9.871}, "counters": {"num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "done": false, "episodes_total": 1398, "training_iteration": 21, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-14", "timestamp": 1698246014, "time_this_iter_s": 3.442394733428955, "time_total_s": 68.0326623916626, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.0326623916626, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 69.48, "ram_util_percent": 25.640000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 0.0003, "total_loss": 6.575685779253642, "policy_loss": 0.059019322196642555, "vf_loss": 6.516719897588094, "vf_explained_var": -7.301568984985352e-07, "kl": 0.0010596358435274549, "entropy": 0.5357164045174917, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 258.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.749999999999834, "episode_len_mean": 253.14, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, 34.10000000000004, -50.00000000000044, 41.90000000000001, 34.10000000000004, 45.3, 38.50000000000003, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.50000000000001, -50.00000000000044, 29.299999999999976, 31.300000000000004, 32.100000000000016, 3.899999999999615, 34.70000000000004, 38.700000000000024, 42.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, 36.70000000000003, -50.00000000000044, 28.499999999999964, 4.299999999999621, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 25.699999999999925, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.70000000000003, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 28.09999999999996, 43.50000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.10000000000002, 43.30000000000001, -50.00000000000044, 45.9, 46.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 0.8999999999995723, 46.5, 44.7, 44.10000000000001, 36.900000000000034, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 42.30000000000001, 41.500000000000014, 34.10000000000004, 44.300000000000004, 43.900000000000006, 41.30000000000001, -50.00000000000044, 41.500000000000014, 34.30000000000004, -50.00000000000044, 44.5, 41.30000000000001, 42.900000000000006, 44.7, 42.900000000000006, 40.90000000000002, 45.5, -50.00000000000044, 45.1, 45.9], "episode_lengths": [500, 104, 160, 500, 82, 160, 48, 116, 158, 500, 500, 500, 74, 66, 500, 208, 188, 180, 462, 154, 114, 80, 84, 500, 500, 112, 134, 500, 216, 458, 500, 36, 500, 48, 244, 500, 500, 86, 40, 500, 500, 52, 144, 500, 500, 146, 500, 60, 500, 500, 220, 66, 500, 68, 500, 110, 68, 500, 42, 32, 500, 50, 500, 500, 96, 500, 500, 500, 44, 492, 36, 54, 60, 132, 56, 500, 500, 500, 126, 500, 78, 86, 160, 58, 62, 88, 500, 86, 158, 500, 56, 88, 72, 54, 72, 92, 46, 500, 50, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40460346677410597, "mean_inference_ms": 1.2906880370903366, "mean_action_processing_ms": 0.15203887429460583, "mean_env_wait_ms": 0.08915811910266394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03898763656616211, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.13872814178466797}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.749999999999834, "episode_len_mean": 253.14, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, 34.10000000000004, -50.00000000000044, 41.90000000000001, 34.10000000000004, 45.3, 38.50000000000003, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.50000000000001, -50.00000000000044, 29.299999999999976, 31.300000000000004, 32.100000000000016, 3.899999999999615, 34.70000000000004, 38.700000000000024, 42.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, 36.70000000000003, -50.00000000000044, 28.499999999999964, 4.299999999999621, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 25.699999999999925, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.70000000000003, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 28.09999999999996, 43.50000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.10000000000002, 43.30000000000001, -50.00000000000044, 45.9, 46.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 0.8999999999995723, 46.5, 44.7, 44.10000000000001, 36.900000000000034, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 42.30000000000001, 41.500000000000014, 34.10000000000004, 44.300000000000004, 43.900000000000006, 41.30000000000001, -50.00000000000044, 41.500000000000014, 34.30000000000004, -50.00000000000044, 44.5, 41.30000000000001, 42.900000000000006, 44.7, 42.900000000000006, 40.90000000000002, 45.5, -50.00000000000044, 45.1, 45.9], "episode_lengths": [500, 104, 160, 500, 82, 160, 48, 116, 158, 500, 500, 500, 74, 66, 500, 208, 188, 180, 462, 154, 114, 80, 84, 500, 500, 112, 134, 500, 216, 458, 500, 36, 500, 48, 244, 500, 500, 86, 40, 500, 500, 52, 144, 500, 500, 146, 500, 60, 500, 500, 220, 66, 500, 68, 500, 110, 68, 500, 42, 32, 500, 50, 500, 500, 96, 500, 500, 500, 44, 492, 36, 54, 60, 132, 56, 500, 500, 500, 126, 500, 78, 86, 160, 58, 62, 88, 500, 86, 158, 500, 56, 88, 72, 54, 72, 92, 46, 500, 50, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40460346677410597, "mean_inference_ms": 1.2906880370903366, "mean_action_processing_ms": 0.15203887429460583, "mean_env_wait_ms": 0.08915811910266394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03898763656616211, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.13872814178466797}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4287.016690113553, "num_env_steps_trained_throughput_per_sec": 4287.016690113553, "timesteps_total": 396000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 3315.578, "sample_time_ms": 3112.957, "load_time_ms": 14.911, "load_throughput": 1207196.604, "learn_time_ms": 176.275, "learn_throughput": 102113.056, "synch_weights_time_ms": 9.556}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1469, "training_iteration": 22, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-18", "timestamp": 1698246018, "time_this_iter_s": 4.203420877456665, "time_total_s": 72.23608326911926, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 72.23608326911926, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 85.11666666666666, "ram_util_percent": 26.08333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 0.0003, "total_loss": 6.760898152987163, "policy_loss": -0.02307926615079244, "vf_loss": 6.784029642740886, "vf_explained_var": -8.394320805867513e-07, "kl": 0.0001752019051176982, "entropy": 0.5222293039162954, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 270.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.731999999999857, "episode_len_mean": 223.38, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.50000000000003, -50.00000000000044, 42.30000000000001, 41.500000000000014, 34.10000000000004, 44.300000000000004, 43.900000000000006, 41.30000000000001, -50.00000000000044, 41.500000000000014, 34.30000000000004, -50.00000000000044, 44.5, 41.30000000000001, 42.900000000000006, 44.7, 42.900000000000006, 40.90000000000002, 45.5, -50.00000000000044, 45.1, 45.9, 29.49999999999998, 35.70000000000003, -50.00000000000044, 3.899999999999615, 45.3, 34.70000000000004, 41.30000000000001, -50.00000000000044, 40.10000000000002, 44.7, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 41.30000000000001, 33.70000000000004, 41.70000000000002, -50.00000000000044, 43.900000000000006, 46.3, 40.500000000000014, 39.70000000000002, 44.10000000000001, -50.00000000000044, 43.30000000000001, 43.900000000000006, -50.00000000000044, 42.10000000000001, 43.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 44.7, 42.70000000000001, 45.7, 44.5, 25.29999999999992, 37.300000000000026, -50.00000000000044, 40.90000000000002, 44.10000000000001, 11.499999999999723, 21.499999999999865, 47.5, 42.70000000000001, 46.5, 46.699999999999996, 34.70000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, 43.7, -50.00000000000044, 29.69999999999998, 29.099999999999973, 38.700000000000024, -50.00000000000044, -50.00000000000044, 5.099999999999632, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.9, -50.00000000000044, 45.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 16.29999999999979], "episode_lengths": [500, 126, 500, 78, 86, 160, 58, 62, 88, 500, 86, 158, 500, 56, 88, 72, 54, 72, 92, 46, 500, 50, 42, 206, 144, 500, 462, 48, 154, 88, 500, 100, 54, 500, 500, 28, 500, 88, 164, 84, 500, 62, 38, 96, 104, 60, 500, 68, 62, 500, 80, 62, 500, 54, 500, 54, 74, 44, 56, 248, 128, 500, 92, 60, 386, 286, 26, 74, 36, 34, 154, 500, 60, 500, 500, 50, 500, 34, 64, 500, 204, 210, 114, 500, 500, 450, 48, 500, 500, 500, 30, 500, 32, 500, 42, 58, 500, 500, 72, 338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4065697662290148, "mean_inference_ms": 1.2944734080432203, "mean_action_processing_ms": 0.15236356835202325, "mean_env_wait_ms": 0.09028446782166659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03599667549133301, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.1310136318206787}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.731999999999857, "episode_len_mean": 223.38, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.50000000000003, -50.00000000000044, 42.30000000000001, 41.500000000000014, 34.10000000000004, 44.300000000000004, 43.900000000000006, 41.30000000000001, -50.00000000000044, 41.500000000000014, 34.30000000000004, -50.00000000000044, 44.5, 41.30000000000001, 42.900000000000006, 44.7, 42.900000000000006, 40.90000000000002, 45.5, -50.00000000000044, 45.1, 45.9, 29.49999999999998, 35.70000000000003, -50.00000000000044, 3.899999999999615, 45.3, 34.70000000000004, 41.30000000000001, -50.00000000000044, 40.10000000000002, 44.7, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 41.30000000000001, 33.70000000000004, 41.70000000000002, -50.00000000000044, 43.900000000000006, 46.3, 40.500000000000014, 39.70000000000002, 44.10000000000001, -50.00000000000044, 43.30000000000001, 43.900000000000006, -50.00000000000044, 42.10000000000001, 43.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 44.7, 42.70000000000001, 45.7, 44.5, 25.29999999999992, 37.300000000000026, -50.00000000000044, 40.90000000000002, 44.10000000000001, 11.499999999999723, 21.499999999999865, 47.5, 42.70000000000001, 46.5, 46.699999999999996, 34.70000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, 43.7, -50.00000000000044, 29.69999999999998, 29.099999999999973, 38.700000000000024, -50.00000000000044, -50.00000000000044, 5.099999999999632, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.9, -50.00000000000044, 45.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 16.29999999999979], "episode_lengths": [500, 126, 500, 78, 86, 160, 58, 62, 88, 500, 86, 158, 500, 56, 88, 72, 54, 72, 92, 46, 500, 50, 42, 206, 144, 500, 462, 48, 154, 88, 500, 100, 54, 500, 500, 28, 500, 88, 164, 84, 500, 62, 38, 96, 104, 60, 500, 68, 62, 500, 80, 62, 500, 54, 500, 54, 74, 44, 56, 248, 128, 500, 92, 60, 386, 286, 26, 74, 36, 34, 154, 500, 60, 500, 500, 50, 500, 34, 64, 500, 204, 210, 114, 500, 500, 450, 48, 500, 500, 500, 30, 500, 32, 500, 42, 58, 500, 500, 72, 338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4065697662290148, "mean_inference_ms": 1.2944734080432203, "mean_action_processing_ms": 0.15236356835202325, "mean_env_wait_ms": 0.09028446782166659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03599667549133301, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.1310136318206787}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5436.645049938157, "num_env_steps_trained_throughput_per_sec": 5436.645049938157, "timesteps_total": 414000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 414000, "timers": {"training_iteration_time_ms": 3346.61, "sample_time_ms": 3138.645, "load_time_ms": 15.41, "load_throughput": 1168056.861, "learn_time_ms": 181.276, "learn_throughput": 99296.147, "synch_weights_time_ms": 9.6}, "counters": {"num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "done": false, "episodes_total": 1546, "training_iteration": 23, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-21", "timestamp": 1698246021, "time_this_iter_s": 3.3164730072021484, "time_total_s": 75.55255627632141, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 75.55255627632141, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 70.85, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 0.0003, "total_loss": 6.488993922869365, "policy_loss": -0.04062327494223913, "vf_loss": 6.52966586748759, "vf_explained_var": -8.940696716308594e-07, "kl": 0.0006339663972359707, "entropy": 0.4855441202720006, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 282.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.8650000000002099, "episode_len_mean": 284.2, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.300000000000026, -50.00000000000044, 40.90000000000002, 44.10000000000001, 11.499999999999723, 21.499999999999865, 47.5, 42.70000000000001, 46.5, 46.699999999999996, 34.70000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, 43.7, -50.00000000000044, 29.69999999999998, 29.099999999999973, 38.700000000000024, -50.00000000000044, -50.00000000000044, 5.099999999999632, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.9, -50.00000000000044, 45.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 16.29999999999979, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.7, -50.00000000000044, 16.699999999999797, -50.00000000000044, 41.500000000000014, 31.500000000000007, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, 46.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.3, 33.90000000000004, -50.00000000000044, -50.00000000000044, 45.7, 24.69999999999991, -50.00000000000044, 46.5, 45.1, 46.099999999999994, 29.49999999999998, 46.099999999999994, 45.1, 40.500000000000014, 36.70000000000003, 40.90000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044], "episode_lengths": [128, 500, 92, 60, 386, 286, 26, 74, 36, 34, 154, 500, 60, 500, 500, 50, 500, 34, 64, 500, 204, 210, 114, 500, 500, 450, 48, 500, 500, 500, 30, 500, 32, 500, 42, 58, 500, 500, 72, 338, 500, 82, 500, 500, 500, 88, 500, 500, 46, 500, 500, 82, 64, 500, 334, 500, 86, 186, 46, 500, 500, 500, 500, 112, 500, 500, 46, 40, 38, 500, 500, 76, 500, 38, 500, 500, 500, 500, 144, 500, 500, 48, 162, 500, 500, 44, 254, 500, 36, 50, 40, 206, 40, 50, 96, 134, 92, 500, 78, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4071957737991923, "mean_inference_ms": 1.2974186717961078, "mean_action_processing_ms": 0.15240364276779164, "mean_env_wait_ms": 0.09050243252217412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03555464744567871, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.12546110153198242}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.8650000000002099, "episode_len_mean": 284.2, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.300000000000026, -50.00000000000044, 40.90000000000002, 44.10000000000001, 11.499999999999723, 21.499999999999865, 47.5, 42.70000000000001, 46.5, 46.699999999999996, 34.70000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, 43.7, -50.00000000000044, 29.69999999999998, 29.099999999999973, 38.700000000000024, -50.00000000000044, -50.00000000000044, 5.099999999999632, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.9, -50.00000000000044, 45.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 16.29999999999979, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.7, -50.00000000000044, 16.699999999999797, -50.00000000000044, 41.500000000000014, 31.500000000000007, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, 46.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.3, 33.90000000000004, -50.00000000000044, -50.00000000000044, 45.7, 24.69999999999991, -50.00000000000044, 46.5, 45.1, 46.099999999999994, 29.49999999999998, 46.099999999999994, 45.1, 40.500000000000014, 36.70000000000003, 40.90000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044], "episode_lengths": [128, 500, 92, 60, 386, 286, 26, 74, 36, 34, 154, 500, 60, 500, 500, 50, 500, 34, 64, 500, 204, 210, 114, 500, 500, 450, 48, 500, 500, 500, 30, 500, 32, 500, 42, 58, 500, 500, 72, 338, 500, 82, 500, 500, 500, 88, 500, 500, 46, 500, 500, 82, 64, 500, 334, 500, 86, 186, 46, 500, 500, 500, 500, 112, 500, 500, 46, 40, 38, 500, 500, 76, 500, 38, 500, 500, 500, 500, 144, 500, 500, 48, 162, 500, 500, 44, 254, 500, 36, 50, 40, 206, 40, 50, 96, 134, 92, 500, 78, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4071957737991923, "mean_inference_ms": 1.2974186717961078, "mean_action_processing_ms": 0.15240364276779164, "mean_env_wait_ms": 0.09050243252217412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03555464744567871, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.12546110153198242}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5348.573381448018, "num_env_steps_trained_throughput_per_sec": 5348.573381448018, "timesteps_total": 432000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 3383.87, "sample_time_ms": 3168.328, "load_time_ms": 14.891, "load_throughput": 1208752.494, "learn_time_ms": 189.43, "learn_throughput": 95021.705, "synch_weights_time_ms": 9.542}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1606, "training_iteration": 24, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-25", "timestamp": 1698246025, "time_this_iter_s": 3.371379852294922, "time_total_s": 78.92393612861633, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 78.92393612861633, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 71.62, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 0.0003, "total_loss": 6.726054310798645, "policy_loss": 0.05299484970358511, "vf_loss": 6.673105597496033, "vf_explained_var": -1.6937653223673503e-06, "kl": 0.000158781291380213, "entropy": 0.46053002029657364, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 294.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.212999999999824, "episode_len_mean": 253.5, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.3, 33.90000000000004, -50.00000000000044, -50.00000000000044, 45.7, 24.69999999999991, -50.00000000000044, 46.5, 45.1, 46.099999999999994, 29.49999999999998, 46.099999999999994, 45.1, 40.500000000000014, 36.70000000000003, 40.90000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 41.500000000000014, 43.900000000000006, 46.5, -50.00000000000044, 34.70000000000004, 40.30000000000002, -50.00000000000044, 45.7, -50.00000000000044, 43.7, 45.7, 45.3, 45.3, 46.5, 40.90000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.900000000000006, 25.699999999999925, -50.00000000000044, 44.5, 47.1, 37.300000000000026, 20.899999999999856, 44.10000000000001, 42.500000000000014, -50.00000000000044, 46.9, 8.699999999999683, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 37.70000000000003, 45.9, 41.90000000000001, 12.099999999999731, -50.00000000000044, 14.09999999999976, -50.00000000000044, 21.09999999999986, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.500000000000014, 4.499999999999623, -50.00000000000044, -50.00000000000044, 44.5, 44.7, 43.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.9, 38.700000000000024, 29.099999999999973, 45.3, 46.699999999999996, 41.30000000000001, 47.1, 40.90000000000002], "episode_lengths": [500, 500, 500, 500, 144, 500, 500, 48, 162, 500, 500, 44, 254, 500, 36, 50, 40, 206, 40, 50, 96, 134, 92, 500, 78, 500, 500, 32, 500, 86, 62, 36, 500, 154, 98, 500, 44, 500, 64, 44, 48, 48, 36, 92, 72, 500, 500, 500, 500, 114, 500, 62, 244, 500, 56, 30, 128, 292, 60, 76, 500, 32, 414, 500, 500, 500, 500, 42, 500, 124, 42, 82, 380, 500, 360, 500, 290, 500, 500, 60, 76, 456, 500, 500, 56, 54, 62, 500, 76, 500, 144, 500, 32, 114, 210, 48, 34, 88, 30, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40677825194570716, "mean_inference_ms": 1.2975707138574126, "mean_action_processing_ms": 0.1530000052900259, "mean_env_wait_ms": 0.08948918256525648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023294448852539062, "StateBufferConnector_ms": 0.00872659683227539, "ViewRequirementAgentConnector_ms": 0.12922906875610352}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.212999999999824, "episode_len_mean": 253.5, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.3, 33.90000000000004, -50.00000000000044, -50.00000000000044, 45.7, 24.69999999999991, -50.00000000000044, 46.5, 45.1, 46.099999999999994, 29.49999999999998, 46.099999999999994, 45.1, 40.500000000000014, 36.70000000000003, 40.90000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 41.500000000000014, 43.900000000000006, 46.5, -50.00000000000044, 34.70000000000004, 40.30000000000002, -50.00000000000044, 45.7, -50.00000000000044, 43.7, 45.7, 45.3, 45.3, 46.5, 40.90000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.900000000000006, 25.699999999999925, -50.00000000000044, 44.5, 47.1, 37.300000000000026, 20.899999999999856, 44.10000000000001, 42.500000000000014, -50.00000000000044, 46.9, 8.699999999999683, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 37.70000000000003, 45.9, 41.90000000000001, 12.099999999999731, -50.00000000000044, 14.09999999999976, -50.00000000000044, 21.09999999999986, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.500000000000014, 4.499999999999623, -50.00000000000044, -50.00000000000044, 44.5, 44.7, 43.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.9, 38.700000000000024, 29.099999999999973, 45.3, 46.699999999999996, 41.30000000000001, 47.1, 40.90000000000002], "episode_lengths": [500, 500, 500, 500, 144, 500, 500, 48, 162, 500, 500, 44, 254, 500, 36, 50, 40, 206, 40, 50, 96, 134, 92, 500, 78, 500, 500, 32, 500, 86, 62, 36, 500, 154, 98, 500, 44, 500, 64, 44, 48, 48, 36, 92, 72, 500, 500, 500, 500, 114, 500, 62, 244, 500, 56, 30, 128, 292, 60, 76, 500, 32, 414, 500, 500, 500, 500, 42, 500, 124, 42, 82, 380, 500, 360, 500, 290, 500, 500, 60, 76, 456, 500, 500, 56, 54, 62, 500, 76, 500, 144, 500, 32, 114, 210, 48, 34, 88, 30, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40677825194570716, "mean_inference_ms": 1.2975707138574126, "mean_action_processing_ms": 0.1530000052900259, "mean_env_wait_ms": 0.08948918256525648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023294448852539062, "StateBufferConnector_ms": 0.00872659683227539, "ViewRequirementAgentConnector_ms": 0.12922906875610352}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5549.984540386347, "num_env_steps_trained_throughput_per_sec": 5549.984540386347, "timesteps_total": 450000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 3407.733, "sample_time_ms": 3176.231, "load_time_ms": 16.009, "load_throughput": 1124357.71, "learn_time_ms": 204.133, "learn_throughput": 88177.688, "synch_weights_time_ms": 9.581}, "counters": {"num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "episodes_total": 1680, "training_iteration": 25, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-28", "timestamp": 1698246028, "time_this_iter_s": 3.24825119972229, "time_total_s": 82.17218732833862, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 82.17218732833862, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 65.03999999999999, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 0.0003, "total_loss": 6.264786918958028, "policy_loss": -0.02185819794734319, "vf_loss": 6.28669027487437, "vf_explained_var": -4.867712656656901e-07, "kl": 0.00014249695887021593, "entropy": 0.45124170929193497, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 306.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.391999999999822, "episode_len_mean": 256.7, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 37.70000000000003, 45.9, 41.90000000000001, 12.099999999999731, -50.00000000000044, 14.09999999999976, -50.00000000000044, 21.09999999999986, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.500000000000014, 4.499999999999623, -50.00000000000044, -50.00000000000044, 44.5, 44.7, 43.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.9, 38.700000000000024, 29.099999999999973, 45.3, 46.699999999999996, 41.30000000000001, 47.1, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 45.7, 42.500000000000014, 46.3, 45.1, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, 36.50000000000003, 45.3, 33.70000000000004, 41.90000000000001, -50.00000000000044, 46.9, 42.30000000000001, -50.00000000000044, 47.5, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 34.10000000000004, 44.300000000000004, 45.9, -50.00000000000044, 44.900000000000006, 45.7, 47.1, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.300000000000026, 46.5, 26.89999999999994, 32.30000000000002, 47.3, 45.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, 46.699999999999996, 31.70000000000001, 48.1, -50.00000000000044, 42.900000000000006, -50.00000000000044, 20.899999999999856, -50.00000000000044], "episode_lengths": [500, 500, 42, 500, 124, 42, 82, 380, 500, 360, 500, 290, 500, 500, 60, 76, 456, 500, 500, 56, 54, 62, 500, 76, 500, 144, 500, 32, 114, 210, 48, 34, 88, 30, 92, 500, 500, 66, 500, 50, 500, 500, 500, 192, 500, 44, 76, 38, 50, 122, 500, 500, 500, 214, 136, 48, 164, 82, 500, 32, 78, 500, 26, 60, 32, 500, 500, 160, 58, 42, 500, 52, 44, 30, 500, 102, 500, 58, 500, 108, 36, 232, 178, 28, 44, 500, 500, 72, 500, 362, 500, 500, 34, 184, 20, 500, 72, 500, 292, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40604715318618295, "mean_inference_ms": 1.294315769631952, "mean_action_processing_ms": 0.1524293634366293, "mean_env_wait_ms": 0.08991492108965665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01600050926208496, "StateBufferConnector_ms": 0.0065021514892578125, "ViewRequirementAgentConnector_ms": 0.14038729667663574}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.391999999999822, "episode_len_mean": 256.7, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 37.70000000000003, 45.9, 41.90000000000001, 12.099999999999731, -50.00000000000044, 14.09999999999976, -50.00000000000044, 21.09999999999986, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.500000000000014, 4.499999999999623, -50.00000000000044, -50.00000000000044, 44.5, 44.7, 43.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.9, 38.700000000000024, 29.099999999999973, 45.3, 46.699999999999996, 41.30000000000001, 47.1, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 45.7, 42.500000000000014, 46.3, 45.1, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, 36.50000000000003, 45.3, 33.70000000000004, 41.90000000000001, -50.00000000000044, 46.9, 42.30000000000001, -50.00000000000044, 47.5, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 34.10000000000004, 44.300000000000004, 45.9, -50.00000000000044, 44.900000000000006, 45.7, 47.1, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.300000000000026, 46.5, 26.89999999999994, 32.30000000000002, 47.3, 45.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, 46.699999999999996, 31.70000000000001, 48.1, -50.00000000000044, 42.900000000000006, -50.00000000000044, 20.899999999999856, -50.00000000000044], "episode_lengths": [500, 500, 42, 500, 124, 42, 82, 380, 500, 360, 500, 290, 500, 500, 60, 76, 456, 500, 500, 56, 54, 62, 500, 76, 500, 144, 500, 32, 114, 210, 48, 34, 88, 30, 92, 500, 500, 66, 500, 50, 500, 500, 500, 192, 500, 44, 76, 38, 50, 122, 500, 500, 500, 214, 136, 48, 164, 82, 500, 32, 78, 500, 26, 60, 32, 500, 500, 160, 58, 42, 500, 52, 44, 30, 500, 102, 500, 58, 500, 108, 36, 232, 178, 28, 44, 500, 500, 72, 500, 362, 500, 500, 34, 184, 20, 500, 72, 500, 292, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40604715318618295, "mean_inference_ms": 1.294315769631952, "mean_action_processing_ms": 0.1524293634366293, "mean_env_wait_ms": 0.08991492108965665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01600050926208496, "StateBufferConnector_ms": 0.0065021514892578125, "ViewRequirementAgentConnector_ms": 0.14038729667663574}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5789.601741815913, "num_env_steps_trained_throughput_per_sec": 5789.601741815913, "timesteps_total": 468000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 3390.704, "sample_time_ms": 3164.056, "load_time_ms": 17.562, "load_throughput": 1024962.014, "learn_time_ms": 197.907, "learn_throughput": 90951.879, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1745, "training_iteration": 26, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-31", "timestamp": 1698246031, "time_this_iter_s": 3.1140213012695312, "time_total_s": 85.28620862960815, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 85.28620862960815, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 63.6, "ram_util_percent": 26.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 0.0003, "total_loss": 6.427139679590861, "policy_loss": 0.01846981979906559, "vf_loss": 6.408709009488423, "vf_explained_var": -3.973642985026042e-07, "kl": 0.00010919958671943657, "entropy": 0.3933748925725619, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 318.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.491999999999809, "episode_len_mean": 265.66, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.300000000000026, 46.5, 26.89999999999994, 32.30000000000002, 47.3, 45.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, 46.699999999999996, 31.70000000000001, 48.1, -50.00000000000044, 42.900000000000006, -50.00000000000044, 20.899999999999856, -50.00000000000044, 29.899999999999984, 45.5, -50.00000000000044, 45.3, -50.00000000000044, 32.90000000000003, 45.1, 43.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.5, 46.3, -50.00000000000044, 43.900000000000006, 46.699999999999996, 42.70000000000001, 45.3, 45.1, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, 22.49999999999988, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, 44.900000000000006, 42.10000000000001, -50.00000000000044, 44.7, 46.5, 12.69999999999974, -50.00000000000044, 42.70000000000001, 44.300000000000004, 42.900000000000006, 45.5, 44.7, -50.00000000000044, 43.7, 47.7, 42.900000000000006, 26.499999999999936, -50.00000000000044, 45.7, 44.900000000000006, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 32.100000000000016, 42.70000000000001], "episode_lengths": [500, 102, 500, 58, 500, 108, 36, 232, 178, 28, 44, 500, 500, 72, 500, 362, 500, 500, 34, 184, 20, 500, 72, 500, 292, 500, 202, 46, 500, 48, 500, 172, 50, 68, 500, 38, 500, 500, 500, 38, 36, 38, 500, 62, 34, 74, 48, 50, 44, 500, 500, 500, 500, 56, 500, 500, 158, 276, 500, 100, 500, 500, 38, 52, 80, 500, 54, 36, 374, 500, 74, 58, 72, 46, 54, 500, 64, 24, 72, 236, 500, 44, 52, 162, 500, 500, 500, 500, 500, 500, 500, 500, 140, 500, 30, 500, 500, 90, 180, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40674021322362464, "mean_inference_ms": 1.2966027118404366, "mean_action_processing_ms": 0.15321492221903987, "mean_env_wait_ms": 0.08963456090996337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599954605102539, "StateBufferConnector_ms": 0.01399374008178711, "ViewRequirementAgentConnector_ms": 0.14952659606933594}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.491999999999809, "episode_len_mean": 265.66, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.300000000000026, 46.5, 26.89999999999994, 32.30000000000002, 47.3, 45.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, 46.699999999999996, 31.70000000000001, 48.1, -50.00000000000044, 42.900000000000006, -50.00000000000044, 20.899999999999856, -50.00000000000044, 29.899999999999984, 45.5, -50.00000000000044, 45.3, -50.00000000000044, 32.90000000000003, 45.1, 43.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.5, 46.3, -50.00000000000044, 43.900000000000006, 46.699999999999996, 42.70000000000001, 45.3, 45.1, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, 22.49999999999988, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, 44.900000000000006, 42.10000000000001, -50.00000000000044, 44.7, 46.5, 12.69999999999974, -50.00000000000044, 42.70000000000001, 44.300000000000004, 42.900000000000006, 45.5, 44.7, -50.00000000000044, 43.7, 47.7, 42.900000000000006, 26.499999999999936, -50.00000000000044, 45.7, 44.900000000000006, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 32.100000000000016, 42.70000000000001], "episode_lengths": [500, 102, 500, 58, 500, 108, 36, 232, 178, 28, 44, 500, 500, 72, 500, 362, 500, 500, 34, 184, 20, 500, 72, 500, 292, 500, 202, 46, 500, 48, 500, 172, 50, 68, 500, 38, 500, 500, 500, 38, 36, 38, 500, 62, 34, 74, 48, 50, 44, 500, 500, 500, 500, 56, 500, 500, 158, 276, 500, 100, 500, 500, 38, 52, 80, 500, 54, 36, 374, 500, 74, 58, 72, 46, 54, 500, 64, 24, 72, 236, 500, 44, 52, 162, 500, 500, 500, 500, 500, 500, 500, 500, 140, 500, 30, 500, 500, 90, 180, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40674021322362464, "mean_inference_ms": 1.2966027118404366, "mean_action_processing_ms": 0.15321492221903987, "mean_env_wait_ms": 0.08963456090996337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599954605102539, "StateBufferConnector_ms": 0.01399374008178711, "ViewRequirementAgentConnector_ms": 0.14952659606933594}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5103.16560299841, "num_env_steps_trained_throughput_per_sec": 5103.16560299841, "timesteps_total": 486000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 486000, "timers": {"training_iteration_time_ms": 3423.745, "sample_time_ms": 3177.627, "load_time_ms": 18.779, "load_throughput": 958494.795, "learn_time_ms": 216.34, "learn_throughput": 83202.351, "synch_weights_time_ms": 9.121}, "counters": {"num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "done": false, "episodes_total": 1819, "training_iteration": 27, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-35", "timestamp": 1698246035, "time_this_iter_s": 3.5319910049438477, "time_total_s": 88.818199634552, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 88.818199634552, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 71.86000000000001, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 0.0003, "total_loss": 5.981370290120442, "policy_loss": 0.0008507557213306427, "vf_loss": 5.980561256408691, "vf_explained_var": 8.742014567057291e-07, "kl": 5.113796596341776e-05, "entropy": 0.41769006351629895, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 330.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.740999999999797, "episode_len_mean": 278.16, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.30000000000004, 22.49999999999988, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, 44.900000000000006, 42.10000000000001, -50.00000000000044, 44.7, 46.5, 12.69999999999974, -50.00000000000044, 42.70000000000001, 44.300000000000004, 42.900000000000006, 45.5, 44.7, -50.00000000000044, 43.7, 47.7, 42.900000000000006, 26.499999999999936, -50.00000000000044, 45.7, 44.900000000000006, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 32.100000000000016, 42.70000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 41.30000000000001, 46.699999999999996, 45.5, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 4.499999999999623, 23.699999999999896, -50.00000000000044, 10.299999999999706, 46.699999999999996, 44.900000000000006, -50.00000000000044, 44.300000000000004, 44.5, -50.00000000000044, -50.00000000000044, 45.1, 29.099999999999973, 46.3, 38.10000000000002, -50.00000000000044, 20.899999999999856, -50.00000000000044, 47.3, 45.3, -50.00000000000044, 23.8999999999999, 31.900000000000013, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, 28.499999999999964, -50.00000000000044, -50.00000000000044, 46.5], "episode_lengths": [158, 276, 500, 100, 500, 500, 38, 52, 80, 500, 54, 36, 374, 500, 74, 58, 72, 46, 54, 500, 64, 24, 72, 236, 500, 44, 52, 162, 500, 500, 500, 500, 500, 500, 500, 500, 140, 500, 30, 500, 500, 90, 180, 74, 500, 68, 500, 500, 74, 500, 40, 500, 500, 500, 500, 50, 280, 500, 500, 500, 38, 88, 34, 46, 500, 500, 28, 500, 456, 264, 500, 398, 34, 52, 500, 58, 56, 500, 500, 50, 210, 38, 120, 500, 292, 500, 28, 48, 500, 262, 182, 48, 34, 500, 500, 48, 216, 500, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40596148197631704, "mean_inference_ms": 1.297163724669443, "mean_action_processing_ms": 0.15279295583030192, "mean_env_wait_ms": 0.08992846600303045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023938894271850586, "StateBufferConnector_ms": 0.008500814437866211, "ViewRequirementAgentConnector_ms": 0.13480353355407715}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.740999999999797, "episode_len_mean": 278.16, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.30000000000004, 22.49999999999988, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, 44.900000000000006, 42.10000000000001, -50.00000000000044, 44.7, 46.5, 12.69999999999974, -50.00000000000044, 42.70000000000001, 44.300000000000004, 42.900000000000006, 45.5, 44.7, -50.00000000000044, 43.7, 47.7, 42.900000000000006, 26.499999999999936, -50.00000000000044, 45.7, 44.900000000000006, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 32.100000000000016, 42.70000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 41.30000000000001, 46.699999999999996, 45.5, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 4.499999999999623, 23.699999999999896, -50.00000000000044, 10.299999999999706, 46.699999999999996, 44.900000000000006, -50.00000000000044, 44.300000000000004, 44.5, -50.00000000000044, -50.00000000000044, 45.1, 29.099999999999973, 46.3, 38.10000000000002, -50.00000000000044, 20.899999999999856, -50.00000000000044, 47.3, 45.3, -50.00000000000044, 23.8999999999999, 31.900000000000013, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, 28.499999999999964, -50.00000000000044, -50.00000000000044, 46.5], "episode_lengths": [158, 276, 500, 100, 500, 500, 38, 52, 80, 500, 54, 36, 374, 500, 74, 58, 72, 46, 54, 500, 64, 24, 72, 236, 500, 44, 52, 162, 500, 500, 500, 500, 500, 500, 500, 500, 140, 500, 30, 500, 500, 90, 180, 74, 500, 68, 500, 500, 74, 500, 40, 500, 500, 500, 500, 50, 280, 500, 500, 500, 38, 88, 34, 46, 500, 500, 28, 500, 456, 264, 500, 398, 34, 52, 500, 58, 56, 500, 500, 50, 210, 38, 120, 500, 292, 500, 28, 48, 500, 262, 182, 48, 34, 500, 500, 48, 216, 500, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40596148197631704, "mean_inference_ms": 1.297163724669443, "mean_action_processing_ms": 0.15279295583030192, "mean_env_wait_ms": 0.08992846600303045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023938894271850586, "StateBufferConnector_ms": 0.008500814437866211, "ViewRequirementAgentConnector_ms": 0.13480353355407715}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5815.9421467707925, "num_env_steps_trained_throughput_per_sec": 5815.9421467707925, "timesteps_total": 504000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 3404.795, "sample_time_ms": 3150.022, "load_time_ms": 19.216, "load_throughput": 936714.12, "learn_time_ms": 224.655, "learn_throughput": 80122.954, "synch_weights_time_ms": 9.124}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1875, "training_iteration": 28, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-38", "timestamp": 1698246038, "time_this_iter_s": 3.099940538406372, "time_total_s": 91.91814017295837, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 91.91814017295837, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 60.339999999999996, "ram_util_percent": 26.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 0.0003, "total_loss": 6.190743168195088, "policy_loss": 0.0015062040959795315, "vf_loss": 6.189280112584432, "vf_explained_var": -4.967053731282552e-07, "kl": 4.203639285623358e-05, "entropy": 0.431145283083121, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 342.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4509999999998004, "episode_len_mean": 271.06, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.699999999999896, -50.00000000000044, 10.299999999999706, 46.699999999999996, 44.900000000000006, -50.00000000000044, 44.300000000000004, 44.5, -50.00000000000044, -50.00000000000044, 45.1, 29.099999999999973, 46.3, 38.10000000000002, -50.00000000000044, 20.899999999999856, -50.00000000000044, 47.3, 45.3, -50.00000000000044, 23.8999999999999, 31.900000000000013, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, 28.499999999999964, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, 43.7, 42.70000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 38.700000000000024, 32.700000000000024, 25.699999999999925, 24.69999999999991, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 28.499999999999964, 42.10000000000001, 29.69999999999998, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.7, 47.1, -50.00000000000044, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 43.900000000000006, 46.9, 44.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.3, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.1, -50.00000000000044, 45.3, 46.699999999999996, 46.5], "episode_lengths": [264, 500, 398, 34, 52, 500, 58, 56, 500, 500, 50, 210, 38, 120, 500, 292, 500, 28, 48, 500, 262, 182, 48, 34, 500, 500, 48, 216, 500, 500, 36, 500, 500, 52, 32, 64, 74, 500, 58, 500, 500, 114, 174, 244, 254, 38, 500, 500, 90, 500, 42, 38, 500, 500, 500, 500, 500, 44, 500, 216, 80, 204, 500, 92, 500, 44, 30, 500, 500, 36, 38, 500, 36, 500, 500, 52, 32, 500, 500, 48, 500, 62, 32, 54, 500, 92, 500, 48, 500, 348, 500, 500, 500, 500, 122, 30, 500, 48, 34, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4050589755892567, "mean_inference_ms": 1.2945761868241028, "mean_action_processing_ms": 0.15228013600156778, "mean_env_wait_ms": 0.0893436556289602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028437376022338867, "StateBufferConnector_ms": 0.005503416061401367, "ViewRequirementAgentConnector_ms": 0.11305594444274902}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4509999999998004, "episode_len_mean": 271.06, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.699999999999896, -50.00000000000044, 10.299999999999706, 46.699999999999996, 44.900000000000006, -50.00000000000044, 44.300000000000004, 44.5, -50.00000000000044, -50.00000000000044, 45.1, 29.099999999999973, 46.3, 38.10000000000002, -50.00000000000044, 20.899999999999856, -50.00000000000044, 47.3, 45.3, -50.00000000000044, 23.8999999999999, 31.900000000000013, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, 28.499999999999964, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, 43.7, 42.70000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 38.700000000000024, 32.700000000000024, 25.699999999999925, 24.69999999999991, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 28.499999999999964, 42.10000000000001, 29.69999999999998, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.7, 47.1, -50.00000000000044, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 43.900000000000006, 46.9, 44.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.3, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.1, -50.00000000000044, 45.3, 46.699999999999996, 46.5], "episode_lengths": [264, 500, 398, 34, 52, 500, 58, 56, 500, 500, 50, 210, 38, 120, 500, 292, 500, 28, 48, 500, 262, 182, 48, 34, 500, 500, 48, 216, 500, 500, 36, 500, 500, 52, 32, 64, 74, 500, 58, 500, 500, 114, 174, 244, 254, 38, 500, 500, 90, 500, 42, 38, 500, 500, 500, 500, 500, 44, 500, 216, 80, 204, 500, 92, 500, 44, 30, 500, 500, 36, 38, 500, 36, 500, 500, 52, 32, 500, 500, 48, 500, 62, 32, 54, 500, 92, 500, 48, 500, 348, 500, 500, 500, 500, 122, 30, 500, 48, 34, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4050589755892567, "mean_inference_ms": 1.2945761868241028, "mean_action_processing_ms": 0.15228013600156778, "mean_env_wait_ms": 0.0893436556289602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028437376022338867, "StateBufferConnector_ms": 0.005503416061401367, "ViewRequirementAgentConnector_ms": 0.11305594444274902}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5868.505474799366, "num_env_steps_trained_throughput_per_sec": 5868.505474799366, "timesteps_total": 522000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 522000, "timers": {"training_iteration_time_ms": 3369.416, "sample_time_ms": 3123.75, "load_time_ms": 18.978, "load_throughput": 948463.087, "learn_time_ms": 215.715, "learn_throughput": 83443.376, "synch_weights_time_ms": 9.196}, "counters": {"num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "done": false, "episodes_total": 1944, "training_iteration": 29, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-41", "timestamp": 1698246041, "time_this_iter_s": 3.0727458000183105, "time_total_s": 94.99088597297668, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 94.99088597297668, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 65.525, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 0.0003, "total_loss": 6.361773133277893, "policy_loss": -0.0531294954319795, "vf_loss": 6.4149467547734575, "vf_explained_var": 7.947285970052083e-08, "kl": 0.00014924806900840082, "entropy": 0.44208475947380066, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 354.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.694000000000214, "episode_len_mean": 287.48, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 28.499999999999964, 42.10000000000001, 29.69999999999998, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.7, 47.1, -50.00000000000044, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 43.900000000000006, 46.9, 44.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.3, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.1, -50.00000000000044, 45.3, 46.699999999999996, 46.5, -50.00000000000044, 46.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 45.9, 12.899999999999743, 44.900000000000006, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 38.90000000000002, 6.699999999999655, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 45.7, 43.10000000000001, 32.30000000000002, 46.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.299999999999862, 41.500000000000014, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.300000000000004, 30.699999999999996, 45.7, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 28.699999999999967, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044], "episode_lengths": [500, 216, 80, 204, 500, 92, 500, 44, 30, 500, 500, 36, 38, 500, 36, 500, 500, 52, 32, 500, 500, 48, 500, 62, 32, 54, 500, 92, 500, 48, 500, 348, 500, 500, 500, 500, 122, 30, 500, 48, 34, 36, 500, 32, 66, 500, 500, 500, 334, 500, 500, 42, 372, 52, 70, 500, 500, 500, 206, 112, 434, 92, 500, 500, 500, 228, 44, 70, 178, 32, 62, 500, 500, 500, 288, 86, 46, 500, 500, 500, 132, 58, 194, 44, 122, 500, 500, 40, 214, 72, 500, 500, 156, 500, 30, 500, 500, 500, 26, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4046190341358528, "mean_inference_ms": 1.2922581141451905, "mean_action_processing_ms": 0.15166031729781493, "mean_env_wait_ms": 0.08986562556473425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028795480728149414, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.11292004585266113}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.694000000000214, "episode_len_mean": 287.48, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 28.499999999999964, 42.10000000000001, 29.69999999999998, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.7, 47.1, -50.00000000000044, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 43.900000000000006, 46.9, 44.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.3, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.1, -50.00000000000044, 45.3, 46.699999999999996, 46.5, -50.00000000000044, 46.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 45.9, 12.899999999999743, 44.900000000000006, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 38.90000000000002, 6.699999999999655, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 45.7, 43.10000000000001, 32.30000000000002, 46.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.299999999999862, 41.500000000000014, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.300000000000004, 30.699999999999996, 45.7, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 28.699999999999967, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044], "episode_lengths": [500, 216, 80, 204, 500, 92, 500, 44, 30, 500, 500, 36, 38, 500, 36, 500, 500, 52, 32, 500, 500, 48, 500, 62, 32, 54, 500, 92, 500, 48, 500, 348, 500, 500, 500, 500, 122, 30, 500, 48, 34, 36, 500, 32, 66, 500, 500, 500, 334, 500, 500, 42, 372, 52, 70, 500, 500, 500, 206, 112, 434, 92, 500, 500, 500, 228, 44, 70, 178, 32, 62, 500, 500, 500, 288, 86, 46, 500, 500, 500, 132, 58, 194, 44, 122, 500, 500, 40, 214, 72, 500, 500, 156, 500, 30, 500, 500, 500, 26, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4046190341358528, "mean_inference_ms": 1.2922581141451905, "mean_action_processing_ms": 0.15166031729781493, "mean_env_wait_ms": 0.08986562556473425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028795480728149414, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.11292004585266113}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5706.917378304038, "num_env_steps_trained_throughput_per_sec": 5706.917378304038, "timesteps_total": 540000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 3350.709, "sample_time_ms": 3088.347, "load_time_ms": 19.847, "load_throughput": 906953.89, "learn_time_ms": 231.305, "learn_throughput": 77819.36, "synch_weights_time_ms": 9.434}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2002, "training_iteration": 30, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-44", "timestamp": 1698246044, "time_this_iter_s": 3.160067558288574, "time_total_s": 98.15095353126526, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 98.15095353126526, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 64.25, "ram_util_percent": 26.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 0.0003, "total_loss": 6.668677767117818, "policy_loss": -0.05053703005736073, "vf_loss": 6.719258824984233, "vf_explained_var": -8.593002955118815e-07, "kl": 0.0003347368132295969, "entropy": 0.4418942754467328, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 366.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.3310000000002062, "episode_len_mean": 288.86, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.299999999999947, 45.7, 43.10000000000001, 32.30000000000002, 46.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.299999999999862, 41.500000000000014, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.300000000000004, 30.699999999999996, 45.7, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 28.699999999999967, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 32.700000000000024, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.500000000000014, 46.3, 45.9, 45.3, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 37.90000000000003, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 37.70000000000003, -50.00000000000044, 36.70000000000003, 44.5, 31.1, 43.30000000000001, 45.7, -50.00000000000044, 43.30000000000001, 44.7, 42.70000000000001, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 30.9, -50.00000000000044, 36.70000000000003, 22.099999999999874, -50.00000000000044, 5.099999999999632, 47.3, -50.00000000000044, 30.699999999999996, 7.899999999999672, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [228, 44, 70, 178, 32, 62, 500, 500, 500, 288, 86, 46, 500, 500, 500, 132, 58, 194, 44, 122, 500, 500, 40, 214, 72, 500, 500, 156, 500, 30, 500, 500, 500, 26, 500, 172, 500, 500, 500, 500, 94, 174, 500, 100, 500, 76, 38, 42, 48, 92, 500, 500, 50, 500, 500, 500, 500, 114, 122, 500, 500, 290, 500, 124, 500, 134, 56, 190, 68, 44, 500, 68, 54, 74, 42, 500, 50, 500, 54, 500, 50, 192, 500, 134, 280, 500, 450, 28, 500, 194, 422, 500, 500, 42, 500, 500, 102, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40411457063610134, "mean_inference_ms": 1.2903705810984731, "mean_action_processing_ms": 0.15155466295568687, "mean_env_wait_ms": 0.08949379642714149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03652834892272949, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.13000750541687012}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.3310000000002062, "episode_len_mean": 288.86, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.299999999999947, 45.7, 43.10000000000001, 32.30000000000002, 46.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.299999999999862, 41.500000000000014, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.300000000000004, 30.699999999999996, 45.7, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 28.699999999999967, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 32.700000000000024, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.500000000000014, 46.3, 45.9, 45.3, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 37.90000000000003, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 37.70000000000003, -50.00000000000044, 36.70000000000003, 44.5, 31.1, 43.30000000000001, 45.7, -50.00000000000044, 43.30000000000001, 44.7, 42.70000000000001, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 30.9, -50.00000000000044, 36.70000000000003, 22.099999999999874, -50.00000000000044, 5.099999999999632, 47.3, -50.00000000000044, 30.699999999999996, 7.899999999999672, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [228, 44, 70, 178, 32, 62, 500, 500, 500, 288, 86, 46, 500, 500, 500, 132, 58, 194, 44, 122, 500, 500, 40, 214, 72, 500, 500, 156, 500, 30, 500, 500, 500, 26, 500, 172, 500, 500, 500, 500, 94, 174, 500, 100, 500, 76, 38, 42, 48, 92, 500, 500, 50, 500, 500, 500, 500, 114, 122, 500, 500, 290, 500, 124, 500, 134, 56, 190, 68, 44, 500, 68, 54, 74, 42, 500, 50, 500, 54, 500, 50, 192, 500, 134, 280, 500, 450, 28, 500, 194, 422, 500, 500, 42, 500, 500, 102, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40411457063610134, "mean_inference_ms": 1.2903705810984731, "mean_action_processing_ms": 0.15155466295568687, "mean_env_wait_ms": 0.08949379642714149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03652834892272949, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.13000750541687012}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5656.011158971974, "num_env_steps_trained_throughput_per_sec": 5656.011158971974, "timesteps_total": 558000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 558000, "timers": {"training_iteration_time_ms": 3325.315, "sample_time_ms": 3070.717, "load_time_ms": 18.994, "load_throughput": 947670.185, "learn_time_ms": 224.803, "learn_throughput": 80069.972, "synch_weights_time_ms": 9.204}, "counters": {"num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "done": false, "episodes_total": 2067, "training_iteration": 31, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-47", "timestamp": 1698246047, "time_this_iter_s": 3.1881885528564453, "time_total_s": 101.3391420841217, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 101.3391420841217, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 63.660000000000004, "ram_util_percent": 26.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 0.0003, "total_loss": 6.753827293713887, "policy_loss": -0.02132977731525898, "vf_loss": 6.775206844011943, "vf_explained_var": -3.625949223836263e-07, "kl": 5.494238531866813e-05, "entropy": 0.4981563265124957, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 378.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8049999999998083, "episode_len_mean": 267.56, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 42.70000000000001, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 30.9, -50.00000000000044, 36.70000000000003, 22.099999999999874, -50.00000000000044, 5.099999999999632, 47.3, -50.00000000000044, 30.699999999999996, 7.899999999999672, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 41.90000000000001, 41.90000000000001, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.699999999999996, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, -50.00000000000044, 40.10000000000002, 38.300000000000026, 45.9, 47.9, 43.10000000000001, 15.099999999999774, 45.1, -50.00000000000044, 39.300000000000026, 43.900000000000006, 38.700000000000024, 21.299999999999862, -50.00000000000044, 4.899999999999629, 40.90000000000002, 41.90000000000001, -50.00000000000044, 47.3, 27.899999999999956, 45.1, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 41.500000000000014, -50.00000000000044, 45.9, 18.899999999999828, -50.00000000000044, 45.7, 44.7, 9.299999999999692, -50.00000000000044, 44.5, 45.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 36.900000000000034, 38.90000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.7], "episode_lengths": [54, 74, 42, 500, 50, 500, 54, 500, 50, 192, 500, 134, 280, 500, 450, 28, 500, 194, 422, 500, 500, 42, 500, 500, 102, 500, 500, 500, 500, 38, 82, 82, 54, 500, 500, 80, 34, 356, 500, 500, 500, 70, 120, 500, 100, 118, 42, 22, 70, 350, 50, 500, 108, 62, 114, 288, 500, 452, 92, 82, 500, 28, 222, 50, 98, 500, 500, 500, 56, 86, 500, 42, 312, 500, 44, 54, 408, 500, 56, 44, 44, 500, 500, 500, 38, 500, 500, 66, 500, 36, 132, 112, 500, 66, 500, 80, 500, 500, 104, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4038705439167262, "mean_inference_ms": 1.2893925392678063, "mean_action_processing_ms": 0.15176347806033763, "mean_env_wait_ms": 0.08914557581953904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024018287658691406, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.13833880424499512}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8049999999998083, "episode_len_mean": 267.56, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 42.70000000000001, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 30.9, -50.00000000000044, 36.70000000000003, 22.099999999999874, -50.00000000000044, 5.099999999999632, 47.3, -50.00000000000044, 30.699999999999996, 7.899999999999672, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 41.90000000000001, 41.90000000000001, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.699999999999996, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, -50.00000000000044, 40.10000000000002, 38.300000000000026, 45.9, 47.9, 43.10000000000001, 15.099999999999774, 45.1, -50.00000000000044, 39.300000000000026, 43.900000000000006, 38.700000000000024, 21.299999999999862, -50.00000000000044, 4.899999999999629, 40.90000000000002, 41.90000000000001, -50.00000000000044, 47.3, 27.899999999999956, 45.1, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 41.500000000000014, -50.00000000000044, 45.9, 18.899999999999828, -50.00000000000044, 45.7, 44.7, 9.299999999999692, -50.00000000000044, 44.5, 45.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 36.900000000000034, 38.90000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.7], "episode_lengths": [54, 74, 42, 500, 50, 500, 54, 500, 50, 192, 500, 134, 280, 500, 450, 28, 500, 194, 422, 500, 500, 42, 500, 500, 102, 500, 500, 500, 500, 38, 82, 82, 54, 500, 500, 80, 34, 356, 500, 500, 500, 70, 120, 500, 100, 118, 42, 22, 70, 350, 50, 500, 108, 62, 114, 288, 500, 452, 92, 82, 500, 28, 222, 50, 98, 500, 500, 500, 56, 86, 500, 42, 312, 500, 44, 54, 408, 500, 56, 44, 44, 500, 500, 500, 38, 500, 500, 66, 500, 36, 132, 112, 500, 66, 500, 80, 500, 500, 104, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4038705439167262, "mean_inference_ms": 1.2893925392678063, "mean_action_processing_ms": 0.15176347806033763, "mean_env_wait_ms": 0.08914557581953904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024018287658691406, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.13833880424499512}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5770.343933185893, "num_env_steps_trained_throughput_per_sec": 5770.343933185893, "timesteps_total": 576000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 3217.383, "sample_time_ms": 2989.044, "load_time_ms": 16.394, "load_throughput": 1097969.372, "learn_time_ms": 201.096, "learn_throughput": 89509.473, "synch_weights_time_ms": 9.251}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2139, "training_iteration": 32, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-50", "timestamp": 1698246050, "time_this_iter_s": 3.1253979206085205, "time_total_s": 104.46454000473022, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 104.46454000473022, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 63.55, "ram_util_percent": 26.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 0.0003, "total_loss": 6.539686838785808, "policy_loss": -0.060339683356384434, "vf_loss": 6.6000739733378095, "vf_explained_var": -2.115964889526367e-06, "kl": 0.00012683990798271574, "entropy": 0.47453998774290085, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 390.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6419999999998107, "episode_len_mean": 264.18, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, 41.500000000000014, -50.00000000000044, 45.9, 18.899999999999828, -50.00000000000044, 45.7, 44.7, 9.299999999999692, -50.00000000000044, 44.5, 45.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 36.900000000000034, 38.90000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.7, -50.00000000000044, 41.90000000000001, 44.7, 28.499999999999964, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 36.50000000000003, 43.7, 45.9, 45.3, 39.90000000000002, 47.1, -50.00000000000044, 45.3, 16.499999999999794, 21.699999999999868, 46.3, 44.300000000000004, 7.899999999999672, -50.00000000000044, 37.10000000000003, 33.500000000000036, 43.7, 42.30000000000001, -50.00000000000044, 19.299999999999834, -50.00000000000044, 42.10000000000001, 42.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.1, 41.30000000000001, 45.1, 44.300000000000004, 43.7, -50.00000000000044, 13.499999999999751, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 27.699999999999953, -50.00000000000044, -50.00000000000044, 45.3, 40.90000000000002, 44.5, 44.300000000000004, -50.00000000000044, 42.10000000000001, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 56, 86, 500, 42, 312, 500, 44, 54, 408, 500, 56, 44, 44, 500, 500, 500, 38, 500, 500, 66, 500, 36, 132, 112, 500, 66, 500, 80, 500, 500, 104, 44, 500, 82, 54, 216, 46, 500, 500, 500, 44, 500, 136, 64, 42, 48, 102, 30, 500, 48, 336, 284, 38, 58, 422, 500, 130, 166, 64, 78, 500, 308, 500, 80, 72, 500, 42, 500, 86, 500, 500, 36, 500, 50, 88, 50, 58, 64, 500, 366, 500, 500, 500, 96, 224, 500, 500, 48, 92, 56, 58, 500, 80, 152, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4038493538469327, "mean_inference_ms": 1.2883792459671275, "mean_action_processing_ms": 0.15132344249717794, "mean_env_wait_ms": 0.08931811275669581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031493425369262695, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.1274106502532959}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6419999999998107, "episode_len_mean": 264.18, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, 41.500000000000014, -50.00000000000044, 45.9, 18.899999999999828, -50.00000000000044, 45.7, 44.7, 9.299999999999692, -50.00000000000044, 44.5, 45.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 36.900000000000034, 38.90000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.7, -50.00000000000044, 41.90000000000001, 44.7, 28.499999999999964, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 36.50000000000003, 43.7, 45.9, 45.3, 39.90000000000002, 47.1, -50.00000000000044, 45.3, 16.499999999999794, 21.699999999999868, 46.3, 44.300000000000004, 7.899999999999672, -50.00000000000044, 37.10000000000003, 33.500000000000036, 43.7, 42.30000000000001, -50.00000000000044, 19.299999999999834, -50.00000000000044, 42.10000000000001, 42.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.1, 41.30000000000001, 45.1, 44.300000000000004, 43.7, -50.00000000000044, 13.499999999999751, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 27.699999999999953, -50.00000000000044, -50.00000000000044, 45.3, 40.90000000000002, 44.5, 44.300000000000004, -50.00000000000044, 42.10000000000001, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 56, 86, 500, 42, 312, 500, 44, 54, 408, 500, 56, 44, 44, 500, 500, 500, 38, 500, 500, 66, 500, 36, 132, 112, 500, 66, 500, 80, 500, 500, 104, 44, 500, 82, 54, 216, 46, 500, 500, 500, 44, 500, 136, 64, 42, 48, 102, 30, 500, 48, 336, 284, 38, 58, 422, 500, 130, 166, 64, 78, 500, 308, 500, 80, 72, 500, 42, 500, 86, 500, 500, 36, 500, 50, 88, 50, 58, 64, 500, 366, 500, 500, 500, 96, 224, 500, 500, 48, 92, 56, 58, 500, 80, 152, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4038493538469327, "mean_inference_ms": 1.2883792459671275, "mean_action_processing_ms": 0.15132344249717794, "mean_env_wait_ms": 0.08931811275669581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031493425369262695, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.1274106502532959}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5593.977033695467, "num_env_steps_trained_throughput_per_sec": 5593.977033695467, "timesteps_total": 594000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 594000, "timers": {"training_iteration_time_ms": 3208.071, "sample_time_ms": 2976.014, "load_time_ms": 16.758, "load_throughput": 1074106.925, "learn_time_ms": 204.441, "learn_throughput": 88045.126, "synch_weights_time_ms": 9.26}, "counters": {"num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "done": false, "episodes_total": 2206, "training_iteration": 33, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-54", "timestamp": 1698246054, "time_this_iter_s": 3.224745512008667, "time_total_s": 107.68928551673889, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 107.68928551673889, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 68.64000000000001, "ram_util_percent": 26.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 0.0003, "total_loss": 6.6178462107976275, "policy_loss": -0.005444770057996114, "vf_loss": 6.623337427775065, "vf_explained_var": -6.655851999918619e-07, "kl": 0.00037402852194882524, "entropy": 0.4633336067199707, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 402.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.2529999999997996, "episode_len_mean": 273.04, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.1, 41.30000000000001, 45.1, 44.300000000000004, 43.7, -50.00000000000044, 13.499999999999751, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 27.699999999999953, -50.00000000000044, -50.00000000000044, 45.3, 40.90000000000002, 44.5, 44.300000000000004, -50.00000000000044, 42.10000000000001, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 17.299999999999805, 45.9, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 46.3, -50.00000000000044, 25.699999999999925, -50.00000000000044, 44.5, 23.8999999999999, 44.900000000000006, 47.3, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, 10.299999999999706, -50.00000000000044, 41.90000000000001, -50.00000000000044, 47.5, 45.3, -50.00000000000044, 9.699999999999697, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.7, -50.00000000000044, 45.7, 40.500000000000014, -50.00000000000044, 35.30000000000004, 44.10000000000001, 42.500000000000014, 43.7, 44.5, 38.300000000000026, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 44.300000000000004, 45.9, -50.00000000000044, 46.5, 46.9, 44.900000000000006, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044], "episode_lengths": [500, 500, 36, 500, 50, 88, 50, 58, 64, 500, 366, 500, 500, 500, 96, 224, 500, 500, 48, 92, 56, 58, 500, 80, 152, 500, 500, 500, 500, 500, 500, 88, 328, 42, 500, 48, 72, 500, 500, 118, 500, 38, 500, 244, 500, 56, 262, 52, 28, 500, 96, 500, 500, 96, 398, 500, 82, 500, 26, 48, 500, 404, 500, 40, 500, 500, 260, 500, 56, 500, 500, 52, 54, 500, 44, 96, 500, 148, 60, 76, 64, 56, 118, 238, 500, 500, 500, 44, 32, 500, 58, 42, 500, 36, 32, 52, 500, 50, 52, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4037049449691627, "mean_inference_ms": 1.288810637468497, "mean_action_processing_ms": 0.1511545469948866, "mean_env_wait_ms": 0.08915265269918284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030019760131835938, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.14473438262939453}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.2529999999997996, "episode_len_mean": 273.04, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.1, 41.30000000000001, 45.1, 44.300000000000004, 43.7, -50.00000000000044, 13.499999999999751, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 27.699999999999953, -50.00000000000044, -50.00000000000044, 45.3, 40.90000000000002, 44.5, 44.300000000000004, -50.00000000000044, 42.10000000000001, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 17.299999999999805, 45.9, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 46.3, -50.00000000000044, 25.699999999999925, -50.00000000000044, 44.5, 23.8999999999999, 44.900000000000006, 47.3, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, 10.299999999999706, -50.00000000000044, 41.90000000000001, -50.00000000000044, 47.5, 45.3, -50.00000000000044, 9.699999999999697, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.7, -50.00000000000044, 45.7, 40.500000000000014, -50.00000000000044, 35.30000000000004, 44.10000000000001, 42.500000000000014, 43.7, 44.5, 38.300000000000026, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 44.300000000000004, 45.9, -50.00000000000044, 46.5, 46.9, 44.900000000000006, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044], "episode_lengths": [500, 500, 36, 500, 50, 88, 50, 58, 64, 500, 366, 500, 500, 500, 96, 224, 500, 500, 48, 92, 56, 58, 500, 80, 152, 500, 500, 500, 500, 500, 500, 88, 328, 42, 500, 48, 72, 500, 500, 118, 500, 38, 500, 244, 500, 56, 262, 52, 28, 500, 96, 500, 500, 96, 398, 500, 82, 500, 26, 48, 500, 404, 500, 40, 500, 500, 260, 500, 56, 500, 500, 52, 54, 500, 44, 96, 500, 148, 60, 76, 64, 56, 118, 238, 500, 500, 500, 44, 32, 500, 58, 42, 500, 36, 32, 52, 500, 50, 52, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4037049449691627, "mean_inference_ms": 1.288810637468497, "mean_action_processing_ms": 0.1511545469948866, "mean_env_wait_ms": 0.08915265269918284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030019760131835938, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.14473438262939453}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5556.044520198885, "num_env_steps_trained_throughput_per_sec": 5556.044520198885, "timesteps_total": 612000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 3195.504, "sample_time_ms": 2967.334, "load_time_ms": 16.639, "load_throughput": 1081782.206, "learn_time_ms": 200.642, "learn_throughput": 89711.89, "synch_weights_time_ms": 9.289}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2276, "training_iteration": 34, "trial_id": "9f288_00006", "date": "2023-10-25_16-00-57", "timestamp": 1698246057, "time_this_iter_s": 3.2447125911712646, "time_total_s": 110.93399810791016, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 110.93399810791016, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 62.739999999999995, "ram_util_percent": 26.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693484e-11, "cur_lr": 0.0003, "total_loss": 6.429624438285828, "policy_loss": 0.06807959141830604, "vf_loss": 6.361592411994934, "vf_explained_var": -1.6490618387858074e-06, "kl": 5.732496974530932e-05, "entropy": 0.47516296803951263, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 414.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.216999999999798, "episode_len_mean": 273.42, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.5, 45.3, -50.00000000000044, 9.699999999999697, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.7, -50.00000000000044, 45.7, 40.500000000000014, -50.00000000000044, 35.30000000000004, 44.10000000000001, 42.500000000000014, 43.7, 44.5, 38.300000000000026, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 44.300000000000004, 45.9, -50.00000000000044, 46.5, 46.9, 44.900000000000006, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 30.9, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 16.09999999999979, 19.899999999999842, 46.3, 45.7, 13.699999999999754, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 43.10000000000001, 2.8999999999996007, 46.9, -50.00000000000044, 36.30000000000003, -50.00000000000044, 45.1, 44.900000000000006, 7.499999999999666, 46.3, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 0.8999999999995723, 44.5, -50.00000000000044, -50.00000000000044, 45.3, 37.10000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.70000000000001, 21.09999999999986, -50.00000000000044, 35.70000000000003, 43.7, 33.90000000000004, 43.30000000000001, 40.500000000000014], "episode_lengths": [26, 48, 500, 404, 500, 40, 500, 500, 260, 500, 56, 500, 500, 52, 54, 500, 44, 96, 500, 148, 60, 76, 64, 56, 118, 238, 500, 500, 500, 44, 32, 500, 58, 42, 500, 36, 32, 52, 500, 50, 52, 500, 500, 500, 500, 54, 500, 500, 500, 42, 192, 68, 500, 500, 64, 340, 302, 38, 44, 364, 500, 500, 44, 500, 70, 472, 32, 500, 138, 500, 50, 52, 426, 38, 500, 46, 500, 500, 500, 500, 500, 500, 28, 492, 56, 500, 500, 48, 130, 500, 76, 500, 74, 290, 500, 144, 64, 162, 68, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4039833727613759, "mean_inference_ms": 1.2896659171023364, "mean_action_processing_ms": 0.15085537612537311, "mean_env_wait_ms": 0.08957300051674881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030397891998291016, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.1374807357788086}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.216999999999798, "episode_len_mean": 273.42, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.5, 45.3, -50.00000000000044, 9.699999999999697, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.7, -50.00000000000044, 45.7, 40.500000000000014, -50.00000000000044, 35.30000000000004, 44.10000000000001, 42.500000000000014, 43.7, 44.5, 38.300000000000026, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 44.300000000000004, 45.9, -50.00000000000044, 46.5, 46.9, 44.900000000000006, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 30.9, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 16.09999999999979, 19.899999999999842, 46.3, 45.7, 13.699999999999754, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 43.10000000000001, 2.8999999999996007, 46.9, -50.00000000000044, 36.30000000000003, -50.00000000000044, 45.1, 44.900000000000006, 7.499999999999666, 46.3, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 0.8999999999995723, 44.5, -50.00000000000044, -50.00000000000044, 45.3, 37.10000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.70000000000001, 21.09999999999986, -50.00000000000044, 35.70000000000003, 43.7, 33.90000000000004, 43.30000000000001, 40.500000000000014], "episode_lengths": [26, 48, 500, 404, 500, 40, 500, 500, 260, 500, 56, 500, 500, 52, 54, 500, 44, 96, 500, 148, 60, 76, 64, 56, 118, 238, 500, 500, 500, 44, 32, 500, 58, 42, 500, 36, 32, 52, 500, 50, 52, 500, 500, 500, 500, 54, 500, 500, 500, 42, 192, 68, 500, 500, 64, 340, 302, 38, 44, 364, 500, 500, 44, 500, 70, 472, 32, 500, 138, 500, 50, 52, 426, 38, 500, 46, 500, 500, 500, 500, 500, 500, 28, 492, 56, 500, 500, 48, 130, 500, 76, 500, 74, 290, 500, 144, 64, 162, 68, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4039833727613759, "mean_inference_ms": 1.2896659171023364, "mean_action_processing_ms": 0.15085537612537311, "mean_env_wait_ms": 0.08957300051674881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030397891998291016, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.1374807357788086}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4981.818524948298, "num_env_steps_trained_throughput_per_sec": 4981.818524948298, "timesteps_total": 630000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 3232.493, "sample_time_ms": 2990.055, "load_time_ms": 17.339, "load_throughput": 1038115.544, "learn_time_ms": 214.31, "learn_throughput": 83990.518, "synch_weights_time_ms": 9.389}, "counters": {"num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 2334, "training_iteration": 35, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-00", "timestamp": 1698246060, "time_this_iter_s": 3.6201369762420654, "time_total_s": 114.55413508415222, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 114.55413508415222, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 70.36, "ram_util_percent": 26.439999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346742e-12, "cur_lr": 0.0003, "total_loss": 6.842074791590373, "policy_loss": -0.008747231370459, "vf_loss": 6.850867589314778, "vf_explained_var": -2.304712931315104e-06, "kl": 4.72545527957872e-05, "entropy": 0.4569083775083224, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 426.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.17499999999983, "episode_len_mean": 243.92, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 0.8999999999995723, 44.5, -50.00000000000044, -50.00000000000044, 45.3, 37.10000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.70000000000001, 21.09999999999986, -50.00000000000044, 35.70000000000003, 43.7, 33.90000000000004, 43.30000000000001, 40.500000000000014, 32.700000000000024, 46.5, 43.7, 45.1, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.5, 46.9, 21.499999999999865, 5.499999999999638, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.900000000000006, -50.00000000000044, 45.7, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 40.70000000000002, 46.099999999999994, 44.300000000000004, 12.499999999999737, 42.30000000000001, 35.70000000000003, 43.900000000000006, -50.00000000000044, 46.5, 39.300000000000026, 43.10000000000001, 47.3, -50.00000000000044, -50.00000000000044, 43.7, 45.5, -50.00000000000044, 44.7, 30.29999999999999, 46.9, -50.00000000000044, 43.7, 46.3, 9.8999999999997, -50.00000000000044, 47.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.5, 42.30000000000001, 46.5, 36.10000000000004, 44.300000000000004, 39.10000000000002, 45.7, 44.900000000000006, 46.699999999999996, 37.50000000000003, 21.699999999999868, -50.00000000000044, -50.00000000000044, 37.90000000000003, 46.699999999999996, -50.00000000000044, 8.899999999999686, 44.5], "episode_lengths": [500, 500, 500, 28, 492, 56, 500, 500, 48, 130, 500, 76, 500, 74, 290, 500, 144, 64, 162, 68, 96, 174, 36, 64, 50, 500, 500, 44, 500, 52, 500, 408, 500, 500, 500, 40, 500, 56, 32, 286, 446, 500, 500, 98, 52, 500, 44, 480, 500, 500, 48, 56, 500, 94, 40, 58, 376, 78, 144, 62, 500, 36, 108, 70, 28, 500, 500, 64, 46, 500, 54, 198, 32, 500, 64, 38, 402, 500, 26, 500, 58, 500, 36, 78, 36, 140, 58, 110, 44, 52, 34, 126, 284, 500, 500, 122, 34, 500, 412, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4075690741722763, "mean_inference_ms": 1.2993143934714937, "mean_action_processing_ms": 0.1526071373006382, "mean_env_wait_ms": 0.09029941776535033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045387983322143555, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.16101813316345215}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.17499999999983, "episode_len_mean": 243.92, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 0.8999999999995723, 44.5, -50.00000000000044, -50.00000000000044, 45.3, 37.10000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.70000000000001, 21.09999999999986, -50.00000000000044, 35.70000000000003, 43.7, 33.90000000000004, 43.30000000000001, 40.500000000000014, 32.700000000000024, 46.5, 43.7, 45.1, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.5, 46.9, 21.499999999999865, 5.499999999999638, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.900000000000006, -50.00000000000044, 45.7, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 40.70000000000002, 46.099999999999994, 44.300000000000004, 12.499999999999737, 42.30000000000001, 35.70000000000003, 43.900000000000006, -50.00000000000044, 46.5, 39.300000000000026, 43.10000000000001, 47.3, -50.00000000000044, -50.00000000000044, 43.7, 45.5, -50.00000000000044, 44.7, 30.29999999999999, 46.9, -50.00000000000044, 43.7, 46.3, 9.8999999999997, -50.00000000000044, 47.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.5, 42.30000000000001, 46.5, 36.10000000000004, 44.300000000000004, 39.10000000000002, 45.7, 44.900000000000006, 46.699999999999996, 37.50000000000003, 21.699999999999868, -50.00000000000044, -50.00000000000044, 37.90000000000003, 46.699999999999996, -50.00000000000044, 8.899999999999686, 44.5], "episode_lengths": [500, 500, 500, 28, 492, 56, 500, 500, 48, 130, 500, 76, 500, 74, 290, 500, 144, 64, 162, 68, 96, 174, 36, 64, 50, 500, 500, 44, 500, 52, 500, 408, 500, 500, 500, 40, 500, 56, 32, 286, 446, 500, 500, 98, 52, 500, 44, 480, 500, 500, 48, 56, 500, 94, 40, 58, 376, 78, 144, 62, 500, 36, 108, 70, 28, 500, 500, 64, 46, 500, 54, 198, 32, 500, 64, 38, 402, 500, 26, 500, 58, 500, 36, 78, 36, 140, 58, 110, 44, 52, 34, 126, 284, 500, 500, 122, 34, 500, 412, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4075690741722763, "mean_inference_ms": 1.2993143934714937, "mean_action_processing_ms": 0.1526071373006382, "mean_env_wait_ms": 0.09029941776535033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045387983322143555, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.16101813316345215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4235.27012082929, "num_env_steps_trained_throughput_per_sec": 4235.27012082929, "timesteps_total": 648000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 3346.593, "sample_time_ms": 3108.794, "load_time_ms": 16.097, "load_throughput": 1118247.477, "learn_time_ms": 210.53, "learn_throughput": 85498.622, "synch_weights_time_ms": 9.673}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2413, "training_iteration": 36, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-05", "timestamp": 1698246065, "time_this_iter_s": 4.25602388381958, "time_total_s": 118.8101589679718, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 118.8101589679718, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 88.16666666666667, "ram_util_percent": 27.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.910383045673371e-12, "cur_lr": 0.0003, "total_loss": 6.593133052190145, "policy_loss": -0.011552391884227594, "vf_loss": 6.604734381039937, "vf_explained_var": 6.20881716410319e-07, "kl": 0.0003928766736294165, "entropy": 0.4901663934191068, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 438.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.06499999999984, "episode_len_mean": 235.02, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 43.7, 46.3, 9.8999999999997, -50.00000000000044, 47.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.5, 42.30000000000001, 46.5, 36.10000000000004, 44.300000000000004, 39.10000000000002, 45.7, 44.900000000000006, 46.699999999999996, 37.50000000000003, 21.699999999999868, -50.00000000000044, -50.00000000000044, 37.90000000000003, 46.699999999999996, -50.00000000000044, 8.899999999999686, 44.5, -50.00000000000044, 23.699999999999896, 45.7, -50.00000000000044, 39.70000000000002, -50.00000000000044, 12.499999999999737, 15.899999999999785, 42.900000000000006, -50.00000000000044, -50.00000000000044, 30.699999999999996, 36.900000000000034, 43.7, 46.5, 45.7, 34.10000000000004, -50.00000000000044, 43.900000000000006, 46.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 34.50000000000004, 38.50000000000003, 20.899999999999856, 46.5, 21.299999999999862, 39.50000000000002, -50.00000000000044, 46.3, 46.5, 42.500000000000014, -50.00000000000044, 45.3, 31.900000000000013, 44.5, 43.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.30000000000001, -50.00000000000044, 47.1, 45.5, 43.7, -50.00000000000044, 38.90000000000002, 47.1, 45.7, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, 46.9, -50.00000000000044, 10.499999999999709, 45.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1], "episode_lengths": [32, 500, 64, 38, 402, 500, 26, 500, 58, 500, 36, 78, 36, 140, 58, 110, 44, 52, 34, 126, 284, 500, 500, 122, 34, 500, 412, 56, 500, 264, 44, 500, 104, 500, 376, 342, 72, 500, 500, 194, 132, 64, 36, 44, 160, 500, 62, 36, 500, 62, 500, 500, 156, 116, 292, 36, 288, 106, 500, 38, 36, 76, 500, 48, 182, 56, 62, 500, 60, 500, 500, 60, 500, 500, 500, 34, 68, 500, 30, 46, 64, 500, 112, 30, 44, 500, 44, 74, 500, 500, 46, 32, 500, 396, 48, 38, 500, 500, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4088946630506506, "mean_inference_ms": 1.305422205106947, "mean_action_processing_ms": 0.1532699170683483, "mean_env_wait_ms": 0.09014639487479689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03201413154602051, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.15252900123596191}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.06499999999984, "episode_len_mean": 235.02, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 43.7, 46.3, 9.8999999999997, -50.00000000000044, 47.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.5, 42.30000000000001, 46.5, 36.10000000000004, 44.300000000000004, 39.10000000000002, 45.7, 44.900000000000006, 46.699999999999996, 37.50000000000003, 21.699999999999868, -50.00000000000044, -50.00000000000044, 37.90000000000003, 46.699999999999996, -50.00000000000044, 8.899999999999686, 44.5, -50.00000000000044, 23.699999999999896, 45.7, -50.00000000000044, 39.70000000000002, -50.00000000000044, 12.499999999999737, 15.899999999999785, 42.900000000000006, -50.00000000000044, -50.00000000000044, 30.699999999999996, 36.900000000000034, 43.7, 46.5, 45.7, 34.10000000000004, -50.00000000000044, 43.900000000000006, 46.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 34.50000000000004, 38.50000000000003, 20.899999999999856, 46.5, 21.299999999999862, 39.50000000000002, -50.00000000000044, 46.3, 46.5, 42.500000000000014, -50.00000000000044, 45.3, 31.900000000000013, 44.5, 43.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.30000000000001, -50.00000000000044, 47.1, 45.5, 43.7, -50.00000000000044, 38.90000000000002, 47.1, 45.7, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, 46.9, -50.00000000000044, 10.499999999999709, 45.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1], "episode_lengths": [32, 500, 64, 38, 402, 500, 26, 500, 58, 500, 36, 78, 36, 140, 58, 110, 44, 52, 34, 126, 284, 500, 500, 122, 34, 500, 412, 56, 500, 264, 44, 500, 104, 500, 376, 342, 72, 500, 500, 194, 132, 64, 36, 44, 160, 500, 62, 36, 500, 62, 500, 500, 156, 116, 292, 36, 288, 106, 500, 38, 36, 76, 500, 48, 182, 56, 62, 500, 60, 500, 500, 60, 500, 500, 500, 34, 68, 500, 30, 46, 64, 500, 112, 30, 44, 500, 44, 74, 500, 500, 46, 32, 500, 396, 48, 38, 500, 500, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4088946630506506, "mean_inference_ms": 1.305422205106947, "mean_action_processing_ms": 0.1532699170683483, "mean_env_wait_ms": 0.09014639487479689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03201413154602051, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.15252900123596191}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4794.952822435491, "num_env_steps_trained_throughput_per_sec": 4794.952822435491, "timesteps_total": 666000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 666000, "timers": {"training_iteration_time_ms": 3369.265, "sample_time_ms": 3123.778, "load_time_ms": 16.67, "load_throughput": 1079766.248, "learn_time_ms": 217.692, "learn_throughput": 82685.767, "synch_weights_time_ms": 9.726}, "counters": {"num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "done": false, "episodes_total": 2485, "training_iteration": 37, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-09", "timestamp": 1698246069, "time_this_iter_s": 3.7592337131500244, "time_total_s": 122.56939268112183, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 122.56939268112183, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 74.84, "ram_util_percent": 27.579999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366855e-12, "cur_lr": 0.0003, "total_loss": 6.59156580766042, "policy_loss": -0.03735206485725939, "vf_loss": 6.628966848055522, "vf_explained_var": -3.6756197611490887e-07, "kl": 0.000430400339287947, "entropy": 0.48919468621412915, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 450.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.404999999999818, "episode_len_mean": 251.56, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.30000000000001, -50.00000000000044, 47.1, 45.5, 43.7, -50.00000000000044, 38.90000000000002, 47.1, 45.7, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, 46.9, -50.00000000000044, 10.499999999999709, 45.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.1, -50.00000000000044, 44.10000000000001, 30.699999999999996, 41.500000000000014, 41.70000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 37.50000000000003, 46.3, 43.50000000000001, -50.00000000000044, 45.3, -50.00000000000044, 42.30000000000001, 43.50000000000001, 27.49999999999995, -50.00000000000044, 31.1, -50.00000000000044, 38.10000000000002, 46.699999999999996, -50.00000000000044, 43.50000000000001, -50.00000000000044, 7.499999999999666, 36.900000000000034, 44.5, 44.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, 43.7, 40.500000000000014, 42.500000000000014, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, 46.699999999999996, 42.900000000000006, 36.30000000000003, 43.50000000000001, -50.00000000000044, 44.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, 43.50000000000001, 39.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016], "episode_lengths": [500, 60, 500, 500, 500, 34, 68, 500, 30, 46, 64, 500, 112, 30, 44, 500, 44, 74, 500, 500, 46, 32, 500, 396, 48, 38, 500, 500, 500, 50, 500, 256, 500, 500, 500, 104, 50, 500, 60, 194, 86, 84, 500, 500, 90, 126, 38, 66, 500, 48, 500, 78, 66, 226, 500, 190, 500, 120, 34, 500, 66, 500, 426, 132, 56, 54, 52, 500, 500, 458, 500, 52, 58, 500, 64, 96, 76, 500, 48, 72, 500, 34, 72, 138, 66, 500, 52, 78, 500, 500, 500, 30, 40, 500, 66, 110, 38, 500, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4100552903485341, "mean_inference_ms": 1.3095225767416585, "mean_action_processing_ms": 0.15369388637028228, "mean_env_wait_ms": 0.09030188315510859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039022207260131836, "StateBufferConnector_ms": 0.005979776382446289, "ViewRequirementAgentConnector_ms": 0.1515212059020996}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.404999999999818, "episode_len_mean": 251.56, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.30000000000001, -50.00000000000044, 47.1, 45.5, 43.7, -50.00000000000044, 38.90000000000002, 47.1, 45.7, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, 46.9, -50.00000000000044, 10.499999999999709, 45.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.1, -50.00000000000044, 44.10000000000001, 30.699999999999996, 41.500000000000014, 41.70000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 37.50000000000003, 46.3, 43.50000000000001, -50.00000000000044, 45.3, -50.00000000000044, 42.30000000000001, 43.50000000000001, 27.49999999999995, -50.00000000000044, 31.1, -50.00000000000044, 38.10000000000002, 46.699999999999996, -50.00000000000044, 43.50000000000001, -50.00000000000044, 7.499999999999666, 36.900000000000034, 44.5, 44.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, 43.7, 40.500000000000014, 42.500000000000014, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, 46.699999999999996, 42.900000000000006, 36.30000000000003, 43.50000000000001, -50.00000000000044, 44.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, 43.50000000000001, 39.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016], "episode_lengths": [500, 60, 500, 500, 500, 34, 68, 500, 30, 46, 64, 500, 112, 30, 44, 500, 44, 74, 500, 500, 46, 32, 500, 396, 48, 38, 500, 500, 500, 50, 500, 256, 500, 500, 500, 104, 50, 500, 60, 194, 86, 84, 500, 500, 90, 126, 38, 66, 500, 48, 500, 78, 66, 226, 500, 190, 500, 120, 34, 500, 66, 500, 426, 132, 56, 54, 52, 500, 500, 458, 500, 52, 58, 500, 64, 96, 76, 500, 48, 72, 500, 34, 72, 138, 66, 500, 52, 78, 500, 500, 500, 30, 40, 500, 66, 110, 38, 500, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4100552903485341, "mean_inference_ms": 1.3095225767416585, "mean_action_processing_ms": 0.15369388637028228, "mean_env_wait_ms": 0.09030188315510859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039022207260131836, "StateBufferConnector_ms": 0.005979776382446289, "ViewRequirementAgentConnector_ms": 0.1515212059020996}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5003.796849119603, "num_env_steps_trained_throughput_per_sec": 5003.796849119603, "timesteps_total": 684000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 3419.498, "sample_time_ms": 3169.248, "load_time_ms": 17.165, "load_throughput": 1048635.714, "learn_time_ms": 221.799, "learn_throughput": 81154.597, "synch_weights_time_ms": 9.887}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2555, "training_iteration": 38, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-12", "timestamp": 1698246072, "time_this_iter_s": 3.6022675037384033, "time_total_s": 126.17166018486023, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 126.17166018486023, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 71.94, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183427e-13, "cur_lr": 0.0003, "total_loss": 6.446887890497844, "policy_loss": -0.01915390168627103, "vf_loss": 6.466093301773071, "vf_explained_var": -1.5596548716227214e-06, "kl": 0.0004400404599588607, "entropy": 0.5159432763854662, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 462.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9769999999998125, "episode_len_mean": 265.84, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.499999999999666, 36.900000000000034, 44.5, 44.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, 43.7, 40.500000000000014, 42.500000000000014, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, 46.699999999999996, 42.900000000000006, 36.30000000000003, 43.50000000000001, -50.00000000000044, 44.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, 43.50000000000001, 39.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 39.70000000000002, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 36.50000000000003, -50.00000000000044, 42.500000000000014, 20.099999999999845, 46.099999999999994, 14.09999999999976, -50.00000000000044, 35.900000000000034, 44.5, -50.00000000000044, 41.90000000000001, 19.899999999999842, 40.30000000000002, 33.70000000000004, -50.00000000000044, 17.299999999999805, 44.10000000000001, 43.7, 14.09999999999976, 25.29999999999992, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 36.900000000000034, 36.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.9, 41.70000000000002, 46.699999999999996, -50.00000000000044], "episode_lengths": [426, 132, 56, 54, 52, 500, 500, 458, 500, 52, 58, 500, 64, 96, 76, 500, 48, 72, 500, 34, 72, 138, 66, 500, 52, 78, 500, 500, 500, 30, 40, 500, 66, 110, 38, 500, 500, 90, 78, 50, 500, 500, 54, 104, 500, 396, 500, 500, 70, 500, 500, 80, 500, 500, 104, 500, 500, 500, 54, 500, 500, 30, 500, 136, 500, 76, 300, 40, 360, 500, 142, 56, 500, 82, 302, 98, 164, 500, 328, 60, 64, 360, 248, 56, 500, 144, 500, 500, 40, 132, 136, 54, 500, 500, 500, 78, 32, 84, 34, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4112172408100103, "mean_inference_ms": 1.3117276865074203, "mean_action_processing_ms": 0.15398703791122953, "mean_env_wait_ms": 0.0910493870625491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03802752494812012, "StateBufferConnector_ms": 0.007990360260009766, "ViewRequirementAgentConnector_ms": 0.14498686790466309}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9769999999998125, "episode_len_mean": 265.84, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.499999999999666, 36.900000000000034, 44.5, 44.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, 43.7, 40.500000000000014, 42.500000000000014, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, 46.699999999999996, 42.900000000000006, 36.30000000000003, 43.50000000000001, -50.00000000000044, 44.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, 43.50000000000001, 39.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 39.70000000000002, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 36.50000000000003, -50.00000000000044, 42.500000000000014, 20.099999999999845, 46.099999999999994, 14.09999999999976, -50.00000000000044, 35.900000000000034, 44.5, -50.00000000000044, 41.90000000000001, 19.899999999999842, 40.30000000000002, 33.70000000000004, -50.00000000000044, 17.299999999999805, 44.10000000000001, 43.7, 14.09999999999976, 25.29999999999992, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 36.900000000000034, 36.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.9, 41.70000000000002, 46.699999999999996, -50.00000000000044], "episode_lengths": [426, 132, 56, 54, 52, 500, 500, 458, 500, 52, 58, 500, 64, 96, 76, 500, 48, 72, 500, 34, 72, 138, 66, 500, 52, 78, 500, 500, 500, 30, 40, 500, 66, 110, 38, 500, 500, 90, 78, 50, 500, 500, 54, 104, 500, 396, 500, 500, 70, 500, 500, 80, 500, 500, 104, 500, 500, 500, 54, 500, 500, 30, 500, 136, 500, 76, 300, 40, 360, 500, 142, 56, 500, 82, 302, 98, 164, 500, 328, 60, 64, 360, 248, 56, 500, 144, 500, 500, 40, 132, 136, 54, 500, 500, 500, 78, 32, 84, 34, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4112172408100103, "mean_inference_ms": 1.3117276865074203, "mean_action_processing_ms": 0.15398703791122953, "mean_env_wait_ms": 0.0910493870625491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03802752494812012, "StateBufferConnector_ms": 0.007990360260009766, "ViewRequirementAgentConnector_ms": 0.14498686790466309}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4986.94150412381, "num_env_steps_trained_throughput_per_sec": 4986.94150412381, "timesteps_total": 702000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 702000, "timers": {"training_iteration_time_ms": 3473.719, "sample_time_ms": 3216.965, "load_time_ms": 17.38, "load_throughput": 1035657.61, "learn_time_ms": 227.524, "learn_throughput": 79112.643, "synch_weights_time_ms": 10.35}, "counters": {"num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "done": false, "episodes_total": 2617, "training_iteration": 39, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-16", "timestamp": 1698246076, "time_this_iter_s": 3.6164278984069824, "time_total_s": 129.7880880832672, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 129.7880880832672, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 71.82000000000001, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917137e-13, "cur_lr": 0.0003, "total_loss": 7.1837490399678545, "policy_loss": 0.003929223244388898, "vf_loss": 7.179873426755269, "vf_explained_var": -5.662441253662109e-07, "kl": 0.00013817967783798699, "entropy": 0.5364701350529989, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 474.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.309999999999837, "episode_len_mean": 247.56, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.29999999999992, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 36.900000000000034, 36.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.9, 41.70000000000002, 46.699999999999996, -50.00000000000044, 1.8999999999995865, 41.500000000000014, 43.7, 45.3, 46.5, 42.30000000000001, -50.00000000000044, 40.70000000000002, 35.10000000000004, 34.10000000000004, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 22.49999999999988, 44.10000000000001, 43.10000000000001, 43.900000000000006, 43.50000000000001, 37.10000000000003, 44.5, 43.900000000000006, 42.70000000000001, 44.900000000000006, -50.00000000000044, 37.300000000000026, 44.10000000000001, -50.00000000000044, 17.899999999999814, 39.50000000000002, 15.699999999999783, 42.10000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, 39.300000000000026, 41.90000000000001, -50.00000000000044, 46.5, 24.899999999999913, 47.3, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.900000000000006, 44.900000000000006, 47.1, 37.50000000000003, 37.70000000000003, 20.699999999999854, 46.099999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.0999999999996035, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.10000000000001, 24.499999999999908, 40.90000000000002, 28.89999999999997], "episode_lengths": [248, 56, 500, 144, 500, 500, 40, 132, 136, 54, 500, 500, 500, 78, 32, 84, 34, 500, 482, 86, 64, 48, 36, 78, 500, 94, 150, 160, 500, 36, 500, 48, 250, 500, 500, 500, 58, 276, 60, 70, 62, 66, 130, 56, 62, 74, 52, 500, 128, 60, 500, 322, 106, 344, 80, 126, 500, 500, 78, 500, 500, 500, 62, 500, 500, 500, 272, 108, 82, 500, 36, 252, 28, 52, 500, 36, 500, 500, 68, 62, 52, 30, 126, 124, 294, 40, 78, 500, 500, 500, 470, 500, 500, 500, 84, 500, 60, 256, 92, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4121541279518498, "mean_inference_ms": 1.3123654764714727, "mean_action_processing_ms": 0.1540625018293624, "mean_env_wait_ms": 0.0910954311056474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03681039810180664, "StateBufferConnector_ms": 0.0050127506256103516, "ViewRequirementAgentConnector_ms": 0.13129496574401855}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.309999999999837, "episode_len_mean": 247.56, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.29999999999992, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 36.900000000000034, 36.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.9, 41.70000000000002, 46.699999999999996, -50.00000000000044, 1.8999999999995865, 41.500000000000014, 43.7, 45.3, 46.5, 42.30000000000001, -50.00000000000044, 40.70000000000002, 35.10000000000004, 34.10000000000004, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 22.49999999999988, 44.10000000000001, 43.10000000000001, 43.900000000000006, 43.50000000000001, 37.10000000000003, 44.5, 43.900000000000006, 42.70000000000001, 44.900000000000006, -50.00000000000044, 37.300000000000026, 44.10000000000001, -50.00000000000044, 17.899999999999814, 39.50000000000002, 15.699999999999783, 42.10000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, 39.300000000000026, 41.90000000000001, -50.00000000000044, 46.5, 24.899999999999913, 47.3, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.900000000000006, 44.900000000000006, 47.1, 37.50000000000003, 37.70000000000003, 20.699999999999854, 46.099999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.0999999999996035, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.10000000000001, 24.499999999999908, 40.90000000000002, 28.89999999999997], "episode_lengths": [248, 56, 500, 144, 500, 500, 40, 132, 136, 54, 500, 500, 500, 78, 32, 84, 34, 500, 482, 86, 64, 48, 36, 78, 500, 94, 150, 160, 500, 36, 500, 48, 250, 500, 500, 500, 58, 276, 60, 70, 62, 66, 130, 56, 62, 74, 52, 500, 128, 60, 500, 322, 106, 344, 80, 126, 500, 500, 78, 500, 500, 500, 62, 500, 500, 500, 272, 108, 82, 500, 36, 252, 28, 52, 500, 36, 500, 500, 68, 62, 52, 30, 126, 124, 294, 40, 78, 500, 500, 500, 470, 500, 500, 500, 84, 500, 60, 256, 92, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4121541279518498, "mean_inference_ms": 1.3123654764714727, "mean_action_processing_ms": 0.1540625018293624, "mean_env_wait_ms": 0.0910954311056474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03681039810180664, "StateBufferConnector_ms": 0.0050127506256103516, "ViewRequirementAgentConnector_ms": 0.13129496574401855}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5496.817309016153, "num_env_steps_trained_throughput_per_sec": 5496.817309016153, "timesteps_total": 720000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 3485.774, "sample_time_ms": 3236.315, "load_time_ms": 16.716, "load_throughput": 1076790.913, "learn_time_ms": 220.764, "learn_throughput": 81534.93, "synch_weights_time_ms": 10.379}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2699, "training_iteration": 40, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-19", "timestamp": 1698246079, "time_this_iter_s": 3.2795748710632324, "time_total_s": 133.06766295433044, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 133.06766295433044, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 68.06000000000002, "ram_util_percent": 26.46}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 0.0003, "total_loss": 7.363572637240092, "policy_loss": 0.058664094656705856, "vf_loss": 7.304962873458862, "vf_explained_var": -2.692143122355143e-06, "kl": 0.00020291590026270492, "entropy": 0.5435476998488108, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 486.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.080999999999856, "episode_len_mean": 234.92, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 43.900000000000006, 44.900000000000006, 47.1, 37.50000000000003, 37.70000000000003, 20.699999999999854, 46.099999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.0999999999996035, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.10000000000001, 24.499999999999908, 40.90000000000002, 28.89999999999997, 46.3, 46.099999999999994, 27.699999999999953, 37.10000000000003, 2.299999999999592, -50.00000000000044, -50.00000000000044, 46.3, 36.50000000000003, 15.699999999999783, -50.00000000000044, 45.7, 44.10000000000001, -50.00000000000044, 15.699999999999783, 46.9, 13.299999999999748, 45.5, -50.00000000000044, 42.30000000000001, 42.30000000000001, 44.5, 41.500000000000014, -50.00000000000044, 24.099999999999902, -50.00000000000044, 38.300000000000026, 32.30000000000002, 46.699999999999996, 44.900000000000006, 38.90000000000002, 4.099999999999618, 18.29999999999982, -50.00000000000044, -50.00000000000044, 31.900000000000013, 43.30000000000001, 12.899999999999743, 40.10000000000002, -50.00000000000044, 43.50000000000001, 46.5, 43.30000000000001, -50.00000000000044, 36.50000000000003, 42.500000000000014, 47.1, 35.900000000000034, -50.00000000000044, 37.10000000000003, 24.099999999999902, 44.300000000000004, 39.50000000000002, 9.299999999999692, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 36.50000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 41.70000000000002, 44.10000000000001, 39.50000000000002, -50.00000000000044, 45.7, 39.10000000000002, 42.900000000000006, 34.10000000000004, 39.70000000000002, 40.10000000000002, 45.7, 36.50000000000003, 43.900000000000006], "episode_lengths": [500, 68, 62, 52, 30, 126, 124, 294, 40, 78, 500, 500, 500, 470, 500, 500, 500, 84, 500, 60, 256, 92, 212, 38, 40, 224, 130, 478, 500, 500, 38, 136, 344, 500, 44, 60, 500, 344, 32, 368, 46, 500, 78, 78, 56, 86, 500, 260, 500, 118, 178, 34, 52, 112, 460, 318, 500, 500, 182, 68, 372, 100, 500, 66, 36, 68, 500, 136, 76, 30, 142, 500, 130, 260, 58, 106, 408, 500, 500, 154, 500, 136, 500, 102, 500, 500, 80, 84, 60, 106, 500, 44, 110, 72, 160, 104, 100, 44, 136, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41121787425547646, "mean_inference_ms": 1.3117036748367636, "mean_action_processing_ms": 0.15333280117154502, "mean_env_wait_ms": 0.09075686576328425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025658845901489258, "StateBufferConnector_ms": 0.006676673889160156, "ViewRequirementAgentConnector_ms": 0.12857913970947266}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.080999999999856, "episode_len_mean": 234.92, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 43.900000000000006, 44.900000000000006, 47.1, 37.50000000000003, 37.70000000000003, 20.699999999999854, 46.099999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.0999999999996035, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.10000000000001, 24.499999999999908, 40.90000000000002, 28.89999999999997, 46.3, 46.099999999999994, 27.699999999999953, 37.10000000000003, 2.299999999999592, -50.00000000000044, -50.00000000000044, 46.3, 36.50000000000003, 15.699999999999783, -50.00000000000044, 45.7, 44.10000000000001, -50.00000000000044, 15.699999999999783, 46.9, 13.299999999999748, 45.5, -50.00000000000044, 42.30000000000001, 42.30000000000001, 44.5, 41.500000000000014, -50.00000000000044, 24.099999999999902, -50.00000000000044, 38.300000000000026, 32.30000000000002, 46.699999999999996, 44.900000000000006, 38.90000000000002, 4.099999999999618, 18.29999999999982, -50.00000000000044, -50.00000000000044, 31.900000000000013, 43.30000000000001, 12.899999999999743, 40.10000000000002, -50.00000000000044, 43.50000000000001, 46.5, 43.30000000000001, -50.00000000000044, 36.50000000000003, 42.500000000000014, 47.1, 35.900000000000034, -50.00000000000044, 37.10000000000003, 24.099999999999902, 44.300000000000004, 39.50000000000002, 9.299999999999692, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 36.50000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 41.70000000000002, 44.10000000000001, 39.50000000000002, -50.00000000000044, 45.7, 39.10000000000002, 42.900000000000006, 34.10000000000004, 39.70000000000002, 40.10000000000002, 45.7, 36.50000000000003, 43.900000000000006], "episode_lengths": [500, 68, 62, 52, 30, 126, 124, 294, 40, 78, 500, 500, 500, 470, 500, 500, 500, 84, 500, 60, 256, 92, 212, 38, 40, 224, 130, 478, 500, 500, 38, 136, 344, 500, 44, 60, 500, 344, 32, 368, 46, 500, 78, 78, 56, 86, 500, 260, 500, 118, 178, 34, 52, 112, 460, 318, 500, 500, 182, 68, 372, 100, 500, 66, 36, 68, 500, 136, 76, 30, 142, 500, 130, 260, 58, 106, 408, 500, 500, 154, 500, 136, 500, 102, 500, 500, 80, 84, 60, 106, 500, 44, 110, 72, 160, 104, 100, 44, 136, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41121787425547646, "mean_inference_ms": 1.3117036748367636, "mean_action_processing_ms": 0.15333280117154502, "mean_env_wait_ms": 0.09075686576328425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025658845901489258, "StateBufferConnector_ms": 0.006676673889160156, "ViewRequirementAgentConnector_ms": 0.12857913970947266}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5646.153367523495, "num_env_steps_trained_throughput_per_sec": 5646.153367523495, "timesteps_total": 738000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 738000, "timers": {"training_iteration_time_ms": 3486.33, "sample_time_ms": 3231.273, "load_time_ms": 17.587, "load_throughput": 1023455.845, "learn_time_ms": 225.553, "learn_throughput": 79803.889, "synch_weights_time_ms": 10.317}, "counters": {"num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "done": false, "episodes_total": 2776, "training_iteration": 41, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-22", "timestamp": 1698246082, "time_this_iter_s": 3.1937577724456787, "time_total_s": 136.26142072677612, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 136.26142072677612, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 66.10000000000001, "ram_util_percent": 26.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 0.0003, "total_loss": 6.832622090975444, "policy_loss": 0.09391640250881512, "vf_loss": 6.738757888476054, "vf_explained_var": 1.4404455820719402e-06, "kl": 0.00027182207293208194, "entropy": 0.5218970477581024, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 498.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.93999999999987, "episode_len_mean": 231.32, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, 39.50000000000002, 9.299999999999692, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 36.50000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 41.70000000000002, 44.10000000000001, 39.50000000000002, -50.00000000000044, 45.7, 39.10000000000002, 42.900000000000006, 34.10000000000004, 39.70000000000002, 40.10000000000002, 45.7, 36.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.10000000000001, 24.499999999999908, 33.10000000000003, 7.499999999999666, 37.10000000000003, 41.100000000000016, -50.00000000000044, 41.90000000000001, 43.30000000000001, 41.500000000000014, 46.9, 22.899999999999885, 31.300000000000004, -50.00000000000044, 44.7, 25.899999999999928, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 30.499999999999993, 44.5, 45.3, 44.900000000000006, -50.00000000000044, 44.5, 45.1, 28.499999999999964, 39.10000000000002, 46.5, 20.49999999999985, 43.30000000000001, -50.00000000000044, 45.5, 9.8999999999997, -50.00000000000044, 38.90000000000002, 33.30000000000003, 45.7, -50.00000000000044, 39.70000000000002, 46.9, -50.00000000000044, 46.5, -50.00000000000044, 45.1, 44.300000000000004, 36.900000000000034, 40.30000000000002, -50.00000000000044, 26.89999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, 33.500000000000036, 33.10000000000003, -50.00000000000044, 46.099999999999994, 32.100000000000016, 39.50000000000002, 19.499999999999837, 35.10000000000004, 34.10000000000004, 37.50000000000003, 42.10000000000001], "episode_lengths": [58, 106, 408, 500, 500, 154, 500, 136, 500, 102, 500, 500, 80, 84, 60, 106, 500, 44, 110, 72, 160, 104, 100, 44, 136, 62, 500, 500, 150, 70, 256, 170, 426, 130, 90, 500, 82, 68, 86, 32, 272, 188, 500, 54, 242, 104, 500, 500, 500, 500, 140, 500, 500, 204, 500, 196, 56, 48, 52, 500, 56, 50, 216, 110, 36, 296, 68, 500, 46, 402, 500, 112, 168, 44, 500, 104, 32, 500, 36, 500, 50, 58, 132, 98, 500, 232, 60, 500, 500, 166, 170, 500, 40, 180, 106, 306, 150, 160, 126, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41046837493217736, "mean_inference_ms": 1.3086800031308568, "mean_action_processing_ms": 0.15272971897699103, "mean_env_wait_ms": 0.09074023565832341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019974946975708008, "StateBufferConnector_ms": 0.005255460739135742, "ViewRequirementAgentConnector_ms": 0.09992194175720215}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.93999999999987, "episode_len_mean": 231.32, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, 39.50000000000002, 9.299999999999692, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 36.50000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 41.70000000000002, 44.10000000000001, 39.50000000000002, -50.00000000000044, 45.7, 39.10000000000002, 42.900000000000006, 34.10000000000004, 39.70000000000002, 40.10000000000002, 45.7, 36.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.10000000000001, 24.499999999999908, 33.10000000000003, 7.499999999999666, 37.10000000000003, 41.100000000000016, -50.00000000000044, 41.90000000000001, 43.30000000000001, 41.500000000000014, 46.9, 22.899999999999885, 31.300000000000004, -50.00000000000044, 44.7, 25.899999999999928, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 30.499999999999993, 44.5, 45.3, 44.900000000000006, -50.00000000000044, 44.5, 45.1, 28.499999999999964, 39.10000000000002, 46.5, 20.49999999999985, 43.30000000000001, -50.00000000000044, 45.5, 9.8999999999997, -50.00000000000044, 38.90000000000002, 33.30000000000003, 45.7, -50.00000000000044, 39.70000000000002, 46.9, -50.00000000000044, 46.5, -50.00000000000044, 45.1, 44.300000000000004, 36.900000000000034, 40.30000000000002, -50.00000000000044, 26.89999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, 33.500000000000036, 33.10000000000003, -50.00000000000044, 46.099999999999994, 32.100000000000016, 39.50000000000002, 19.499999999999837, 35.10000000000004, 34.10000000000004, 37.50000000000003, 42.10000000000001], "episode_lengths": [58, 106, 408, 500, 500, 154, 500, 136, 500, 102, 500, 500, 80, 84, 60, 106, 500, 44, 110, 72, 160, 104, 100, 44, 136, 62, 500, 500, 150, 70, 256, 170, 426, 130, 90, 500, 82, 68, 86, 32, 272, 188, 500, 54, 242, 104, 500, 500, 500, 500, 140, 500, 500, 204, 500, 196, 56, 48, 52, 500, 56, 50, 216, 110, 36, 296, 68, 500, 46, 402, 500, 112, 168, 44, 500, 104, 32, 500, 36, 500, 50, 58, 132, 98, 500, 232, 60, 500, 500, 166, 170, 500, 40, 180, 106, 306, 150, 160, 126, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41046837493217736, "mean_inference_ms": 1.3086800031308568, "mean_action_processing_ms": 0.15272971897699103, "mean_env_wait_ms": 0.09074023565832341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019974946975708008, "StateBufferConnector_ms": 0.005255460739135742, "ViewRequirementAgentConnector_ms": 0.09992194175720215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5913.060068755135, "num_env_steps_trained_throughput_per_sec": 5913.060068755135, "timesteps_total": 756000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 3478.801, "sample_time_ms": 3214.212, "load_time_ms": 17.987, "load_throughput": 1000703.458, "learn_time_ms": 234.485, "learn_throughput": 76763.986, "synch_weights_time_ms": 10.217}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2850, "training_iteration": 42, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-25", "timestamp": 1698246085, "time_this_iter_s": 3.0494544506073, "time_total_s": 139.31087517738342, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 139.31087517738342, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 57.48, "ram_util_percent": 26.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864642e-14, "cur_lr": 0.0003, "total_loss": 6.592011133829753, "policy_loss": -0.009555586303273836, "vf_loss": 6.601622502009074, "vf_explained_var": -6.457169850667318e-07, "kl": 0.0005797111020537926, "entropy": 0.558710590004921, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 510.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.762999999999838, "episode_len_mean": 258.02, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, 46.5, 20.49999999999985, 43.30000000000001, -50.00000000000044, 45.5, 9.8999999999997, -50.00000000000044, 38.90000000000002, 33.30000000000003, 45.7, -50.00000000000044, 39.70000000000002, 46.9, -50.00000000000044, 46.5, -50.00000000000044, 45.1, 44.300000000000004, 36.900000000000034, 40.30000000000002, -50.00000000000044, 26.89999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, 33.500000000000036, 33.10000000000003, -50.00000000000044, 46.099999999999994, 32.100000000000016, 39.50000000000002, 19.499999999999837, 35.10000000000004, 34.10000000000004, 37.50000000000003, 42.10000000000001, -50.00000000000044, 39.70000000000002, 43.10000000000001, 43.7, 36.70000000000003, 41.90000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 27.099999999999945, 39.70000000000002, 42.70000000000001, 45.1, -50.00000000000044, 41.100000000000016, 42.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 18.099999999999817, 41.70000000000002, 39.90000000000002, 22.699999999999882, 28.499999999999964, 46.699999999999996, 20.49999999999985, 30.099999999999987, 31.1, 31.1, 30.29999999999999, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 28.699999999999967, 47.3, -50.00000000000044, 40.30000000000002, 31.1, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 20.49999999999985, 37.300000000000026], "episode_lengths": [110, 36, 296, 68, 500, 46, 402, 500, 112, 168, 44, 500, 104, 32, 500, 36, 500, 50, 58, 132, 98, 500, 232, 60, 500, 500, 166, 170, 500, 40, 180, 106, 306, 150, 160, 126, 80, 500, 104, 70, 64, 134, 82, 74, 500, 500, 500, 500, 28, 500, 230, 104, 74, 50, 500, 90, 78, 500, 48, 500, 320, 84, 102, 274, 216, 34, 296, 200, 190, 190, 198, 500, 500, 34, 500, 500, 214, 28, 500, 98, 190, 500, 90, 500, 62, 500, 500, 500, 500, 76, 140, 500, 500, 500, 500, 500, 44, 500, 296, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41043291061411724, "mean_inference_ms": 1.3072117551699127, "mean_action_processing_ms": 0.15308421737907135, "mean_env_wait_ms": 0.09064482848947784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030843019485473633, "StateBufferConnector_ms": 0.00450444221496582, "ViewRequirementAgentConnector_ms": 0.13089251518249512}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.762999999999838, "episode_len_mean": 258.02, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, 46.5, 20.49999999999985, 43.30000000000001, -50.00000000000044, 45.5, 9.8999999999997, -50.00000000000044, 38.90000000000002, 33.30000000000003, 45.7, -50.00000000000044, 39.70000000000002, 46.9, -50.00000000000044, 46.5, -50.00000000000044, 45.1, 44.300000000000004, 36.900000000000034, 40.30000000000002, -50.00000000000044, 26.89999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, 33.500000000000036, 33.10000000000003, -50.00000000000044, 46.099999999999994, 32.100000000000016, 39.50000000000002, 19.499999999999837, 35.10000000000004, 34.10000000000004, 37.50000000000003, 42.10000000000001, -50.00000000000044, 39.70000000000002, 43.10000000000001, 43.7, 36.70000000000003, 41.90000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 27.099999999999945, 39.70000000000002, 42.70000000000001, 45.1, -50.00000000000044, 41.100000000000016, 42.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 18.099999999999817, 41.70000000000002, 39.90000000000002, 22.699999999999882, 28.499999999999964, 46.699999999999996, 20.49999999999985, 30.099999999999987, 31.1, 31.1, 30.29999999999999, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 28.699999999999967, 47.3, -50.00000000000044, 40.30000000000002, 31.1, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 20.49999999999985, 37.300000000000026], "episode_lengths": [110, 36, 296, 68, 500, 46, 402, 500, 112, 168, 44, 500, 104, 32, 500, 36, 500, 50, 58, 132, 98, 500, 232, 60, 500, 500, 166, 170, 500, 40, 180, 106, 306, 150, 160, 126, 80, 500, 104, 70, 64, 134, 82, 74, 500, 500, 500, 500, 28, 500, 230, 104, 74, 50, 500, 90, 78, 500, 48, 500, 320, 84, 102, 274, 216, 34, 296, 200, 190, 190, 198, 500, 500, 34, 500, 500, 214, 28, 500, 98, 190, 500, 90, 500, 62, 500, 500, 500, 500, 76, 140, 500, 500, 500, 500, 500, 44, 500, 296, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41043291061411724, "mean_inference_ms": 1.3072117551699127, "mean_action_processing_ms": 0.15308421737907135, "mean_env_wait_ms": 0.09064482848947784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030843019485473633, "StateBufferConnector_ms": 0.00450444221496582, "ViewRequirementAgentConnector_ms": 0.13089251518249512}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5621.6282225015175, "num_env_steps_trained_throughput_per_sec": 5621.6282225015175, "timesteps_total": 774000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 774000, "timers": {"training_iteration_time_ms": 3477.218, "sample_time_ms": 3223.056, "load_time_ms": 17.388, "load_throughput": 1035204.607, "learn_time_ms": 224.643, "learn_throughput": 80127.036, "synch_weights_time_ms": 10.232}, "counters": {"num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "done": false, "episodes_total": 2913, "training_iteration": 43, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-29", "timestamp": 1698246089, "time_this_iter_s": 3.2074973583221436, "time_total_s": 142.51837253570557, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 142.51837253570557, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 70.825, "ram_util_percent": 26.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.273736754432321e-14, "cur_lr": 0.0003, "total_loss": 6.477774461110433, "policy_loss": 0.07523282772550981, "vf_loss": 6.402596195538838, "vf_explained_var": -1.4156103134155273e-06, "kl": 7.83911229594499e-05, "entropy": 0.5464751124382019, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 522.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.778000000000221, "episode_len_mean": 308.3, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.099999999999817, 41.70000000000002, 39.90000000000002, 22.699999999999882, 28.499999999999964, 46.699999999999996, 20.49999999999985, 30.099999999999987, 31.1, 31.1, 30.29999999999999, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 28.699999999999967, 47.3, -50.00000000000044, 40.30000000000002, 31.1, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 20.49999999999985, 37.300000000000026, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, 44.300000000000004, -50.00000000000044, 42.900000000000006, 41.70000000000002, 42.900000000000006, 42.500000000000014, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.10000000000001, 40.30000000000002, -50.00000000000044, 31.1, 45.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 44.10000000000001, 27.49999999999995, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.5, 45.9, 44.10000000000001, 24.299999999999905, -50.00000000000044, 42.10000000000001, 38.10000000000002, 20.099999999999845, -50.00000000000044], "episode_lengths": [320, 84, 102, 274, 216, 34, 296, 200, 190, 190, 198, 500, 500, 34, 500, 500, 214, 28, 500, 98, 190, 500, 90, 500, 62, 500, 500, 500, 500, 76, 140, 500, 500, 500, 500, 500, 44, 500, 296, 128, 500, 500, 104, 64, 58, 500, 72, 84, 72, 76, 194, 500, 500, 500, 500, 500, 144, 296, 500, 500, 500, 500, 32, 70, 98, 500, 190, 48, 42, 500, 500, 500, 500, 500, 278, 500, 60, 226, 500, 52, 500, 36, 500, 500, 500, 500, 500, 500, 500, 500, 134, 36, 42, 60, 258, 500, 80, 120, 300, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4108349211732735, "mean_inference_ms": 1.3078241263566697, "mean_action_processing_ms": 0.15320236663280196, "mean_env_wait_ms": 0.09119509093334865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026021242141723633, "StateBufferConnector_ms": 0.005995273590087891, "ViewRequirementAgentConnector_ms": 0.16263866424560547}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.778000000000221, "episode_len_mean": 308.3, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.099999999999817, 41.70000000000002, 39.90000000000002, 22.699999999999882, 28.499999999999964, 46.699999999999996, 20.49999999999985, 30.099999999999987, 31.1, 31.1, 30.29999999999999, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 28.699999999999967, 47.3, -50.00000000000044, 40.30000000000002, 31.1, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 20.49999999999985, 37.300000000000026, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, 44.300000000000004, -50.00000000000044, 42.900000000000006, 41.70000000000002, 42.900000000000006, 42.500000000000014, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.10000000000001, 40.30000000000002, -50.00000000000044, 31.1, 45.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 44.10000000000001, 27.49999999999995, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.5, 45.9, 44.10000000000001, 24.299999999999905, -50.00000000000044, 42.10000000000001, 38.10000000000002, 20.099999999999845, -50.00000000000044], "episode_lengths": [320, 84, 102, 274, 216, 34, 296, 200, 190, 190, 198, 500, 500, 34, 500, 500, 214, 28, 500, 98, 190, 500, 90, 500, 62, 500, 500, 500, 500, 76, 140, 500, 500, 500, 500, 500, 44, 500, 296, 128, 500, 500, 104, 64, 58, 500, 72, 84, 72, 76, 194, 500, 500, 500, 500, 500, 144, 296, 500, 500, 500, 500, 32, 70, 98, 500, 190, 48, 42, 500, 500, 500, 500, 500, 278, 500, 60, 226, 500, 52, 500, 36, 500, 500, 500, 500, 500, 500, 500, 500, 134, 36, 42, 60, 258, 500, 80, 120, 300, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4108349211732735, "mean_inference_ms": 1.3078241263566697, "mean_action_processing_ms": 0.15320236663280196, "mean_env_wait_ms": 0.09119509093334865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026021242141723633, "StateBufferConnector_ms": 0.005995273590087891, "ViewRequirementAgentConnector_ms": 0.16263866424560547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5143.479052633451, "num_env_steps_trained_throughput_per_sec": 5143.479052633451, "timesteps_total": 792000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 3503.204, "sample_time_ms": 3240.578, "load_time_ms": 18.064, "load_throughput": 996483.444, "learn_time_ms": 232.245, "learn_throughput": 77504.307, "synch_weights_time_ms": 10.419}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 2973, "training_iteration": 44, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-32", "timestamp": 1698246092, "time_this_iter_s": 3.5055787563323975, "time_total_s": 146.02395129203796, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 146.02395129203796, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 74.05999999999999, "ram_util_percent": 26.419999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161605e-14, "cur_lr": 0.0003, "total_loss": 6.598885695139567, "policy_loss": -0.0038121084993084273, "vf_loss": 6.602752606074016, "vf_explained_var": -1.4454126358032227e-06, "kl": 0.000952639322918003, "entropy": 0.5482665151357651, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 534.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3839999999998098, "episode_len_mean": 276.74, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.1, 45.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 44.10000000000001, 27.49999999999995, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.5, 45.9, 44.10000000000001, 24.299999999999905, -50.00000000000044, 42.10000000000001, 38.10000000000002, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 43.900000000000006, 15.699999999999783, 35.70000000000003, 43.10000000000001, 44.7, 43.30000000000001, -50.00000000000044, 41.30000000000001, 25.099999999999916, 43.900000000000006, -50.00000000000044, 44.5, 46.699999999999996, 41.100000000000016, -50.00000000000044, 28.699999999999967, 33.30000000000003, 31.1, 41.500000000000014, 35.30000000000004, 34.900000000000034, 33.30000000000003, -50.00000000000044, 43.50000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 30.29999999999999, 47.5, 37.300000000000026, 46.699999999999996, 41.30000000000001, 19.09999999999983, 46.099999999999994, 33.500000000000036, 45.9, -50.00000000000044, 43.50000000000001, 42.900000000000006, 39.300000000000026, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [190, 48, 42, 500, 500, 500, 500, 500, 278, 500, 60, 226, 500, 52, 500, 36, 500, 500, 500, 500, 500, 500, 500, 500, 134, 36, 42, 60, 258, 500, 80, 120, 300, 500, 500, 500, 116, 500, 90, 500, 500, 192, 500, 62, 344, 144, 70, 54, 68, 500, 88, 250, 62, 500, 56, 34, 90, 500, 214, 168, 190, 86, 148, 152, 168, 500, 66, 36, 500, 500, 500, 110, 40, 500, 500, 62, 500, 500, 500, 80, 500, 500, 66, 198, 26, 128, 34, 88, 310, 40, 166, 42, 500, 66, 72, 108, 128, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4111452687233841, "mean_inference_ms": 1.3101010980464474, "mean_action_processing_ms": 0.15370398246734987, "mean_env_wait_ms": 0.09118225720244322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799248695373535, "StateBufferConnector_ms": 0.005997419357299805, "ViewRequirementAgentConnector_ms": 0.14560866355895996}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3839999999998098, "episode_len_mean": 276.74, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.1, 45.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 44.10000000000001, 27.49999999999995, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.5, 45.9, 44.10000000000001, 24.299999999999905, -50.00000000000044, 42.10000000000001, 38.10000000000002, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 43.900000000000006, 15.699999999999783, 35.70000000000003, 43.10000000000001, 44.7, 43.30000000000001, -50.00000000000044, 41.30000000000001, 25.099999999999916, 43.900000000000006, -50.00000000000044, 44.5, 46.699999999999996, 41.100000000000016, -50.00000000000044, 28.699999999999967, 33.30000000000003, 31.1, 41.500000000000014, 35.30000000000004, 34.900000000000034, 33.30000000000003, -50.00000000000044, 43.50000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 30.29999999999999, 47.5, 37.300000000000026, 46.699999999999996, 41.30000000000001, 19.09999999999983, 46.099999999999994, 33.500000000000036, 45.9, -50.00000000000044, 43.50000000000001, 42.900000000000006, 39.300000000000026, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [190, 48, 42, 500, 500, 500, 500, 500, 278, 500, 60, 226, 500, 52, 500, 36, 500, 500, 500, 500, 500, 500, 500, 500, 134, 36, 42, 60, 258, 500, 80, 120, 300, 500, 500, 500, 116, 500, 90, 500, 500, 192, 500, 62, 344, 144, 70, 54, 68, 500, 88, 250, 62, 500, 56, 34, 90, 500, 214, 168, 190, 86, 148, 152, 168, 500, 66, 36, 500, 500, 500, 110, 40, 500, 500, 62, 500, 500, 500, 80, 500, 500, 66, 198, 26, 128, 34, 88, 310, 40, 166, 42, 500, 66, 72, 108, 128, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4111452687233841, "mean_inference_ms": 1.3101010980464474, "mean_action_processing_ms": 0.15370398246734987, "mean_env_wait_ms": 0.09118225720244322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799248695373535, "StateBufferConnector_ms": 0.005997419357299805, "ViewRequirementAgentConnector_ms": 0.14560866355895996}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5062.203285446416, "num_env_steps_trained_throughput_per_sec": 5062.203285446416, "timesteps_total": 810000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 810000, "timers": {"training_iteration_time_ms": 3497.467, "sample_time_ms": 3250.927, "load_time_ms": 17.407, "load_throughput": 1034090.121, "learn_time_ms": 216.615, "learn_throughput": 83096.89, "synch_weights_time_ms": 10.52}, "counters": {"num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "done": false, "episodes_total": 3039, "training_iteration": 45, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-36", "timestamp": 1698246096, "time_this_iter_s": 3.5617618560791016, "time_total_s": 149.58571314811707, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 149.58571314811707, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 71.94, "ram_util_percent": 26.559999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860808026e-15, "cur_lr": 0.0003, "total_loss": 7.029638489087422, "policy_loss": 0.016351998473207157, "vf_loss": 7.0133408308029175, "vf_explained_var": 1.44044558207194e-07, "kl": 0.00012317315661410552, "entropy": 0.5419100721677145, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 546.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.951999999999845, "episode_len_mean": 241.16, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 30.29999999999999, 47.5, 37.300000000000026, 46.699999999999996, 41.30000000000001, 19.09999999999983, 46.099999999999994, 33.500000000000036, 45.9, -50.00000000000044, 43.50000000000001, 42.900000000000006, 39.300000000000026, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 19.09999999999983, 16.499999999999794, 43.30000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 39.50000000000002, 47.3, -50.00000000000044, 41.500000000000014, 8.299999999999677, 44.300000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 21.09999999999986, -50.00000000000044, -50.00000000000044, 44.10000000000001, 31.500000000000007, 47.3, 10.299999999999706, 44.10000000000001, 44.7, 44.7, -50.00000000000044, 41.70000000000002, 37.70000000000003, 45.1, 44.7, 43.7, 42.30000000000001, 45.5, 27.899999999999956, 45.1, -50.00000000000044, 38.90000000000002, 42.10000000000001, 45.3, -50.00000000000044, 40.70000000000002, 22.699999999999882, 46.3, 31.900000000000013, -50.00000000000044, 31.70000000000001, -50.00000000000044, 35.10000000000004, 40.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.70000000000002, 25.899999999999928, 16.29999999999979, 45.1, -50.00000000000044, 45.5, -50.00000000000044, 45.3, 40.500000000000014, 40.30000000000002, 33.70000000000004, 42.10000000000001], "episode_lengths": [500, 80, 500, 500, 66, 198, 26, 128, 34, 88, 310, 40, 166, 42, 500, 66, 72, 108, 128, 500, 500, 500, 212, 310, 336, 68, 500, 500, 126, 500, 500, 50, 500, 106, 28, 500, 86, 418, 58, 72, 500, 500, 500, 500, 500, 500, 36, 290, 500, 500, 60, 186, 28, 398, 60, 54, 54, 500, 84, 124, 50, 54, 64, 78, 46, 222, 50, 500, 112, 80, 48, 500, 94, 274, 38, 182, 500, 184, 500, 150, 96, 74, 500, 500, 70, 500, 88, 500, 104, 242, 338, 50, 500, 46, 500, 48, 96, 98, 164, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4112730266061317, "mean_inference_ms": 1.311781532318918, "mean_action_processing_ms": 0.15370407633352412, "mean_env_wait_ms": 0.09102760984251851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700018882751465, "StateBufferConnector_ms": 0.008000850677490234, "ViewRequirementAgentConnector_ms": 0.13652300834655762}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.951999999999845, "episode_len_mean": 241.16, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 30.29999999999999, 47.5, 37.300000000000026, 46.699999999999996, 41.30000000000001, 19.09999999999983, 46.099999999999994, 33.500000000000036, 45.9, -50.00000000000044, 43.50000000000001, 42.900000000000006, 39.300000000000026, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 19.09999999999983, 16.499999999999794, 43.30000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 39.50000000000002, 47.3, -50.00000000000044, 41.500000000000014, 8.299999999999677, 44.300000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 21.09999999999986, -50.00000000000044, -50.00000000000044, 44.10000000000001, 31.500000000000007, 47.3, 10.299999999999706, 44.10000000000001, 44.7, 44.7, -50.00000000000044, 41.70000000000002, 37.70000000000003, 45.1, 44.7, 43.7, 42.30000000000001, 45.5, 27.899999999999956, 45.1, -50.00000000000044, 38.90000000000002, 42.10000000000001, 45.3, -50.00000000000044, 40.70000000000002, 22.699999999999882, 46.3, 31.900000000000013, -50.00000000000044, 31.70000000000001, -50.00000000000044, 35.10000000000004, 40.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.70000000000002, 25.899999999999928, 16.29999999999979, 45.1, -50.00000000000044, 45.5, -50.00000000000044, 45.3, 40.500000000000014, 40.30000000000002, 33.70000000000004, 42.10000000000001], "episode_lengths": [500, 80, 500, 500, 66, 198, 26, 128, 34, 88, 310, 40, 166, 42, 500, 66, 72, 108, 128, 500, 500, 500, 212, 310, 336, 68, 500, 500, 126, 500, 500, 50, 500, 106, 28, 500, 86, 418, 58, 72, 500, 500, 500, 500, 500, 500, 36, 290, 500, 500, 60, 186, 28, 398, 60, 54, 54, 500, 84, 124, 50, 54, 64, 78, 46, 222, 50, 500, 112, 80, 48, 500, 94, 274, 38, 182, 500, 184, 500, 150, 96, 74, 500, 500, 70, 500, 88, 500, 104, 242, 338, 50, 500, 46, 500, 48, 96, 98, 164, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4112730266061317, "mean_inference_ms": 1.311781532318918, "mean_action_processing_ms": 0.15370407633352412, "mean_env_wait_ms": 0.09102760984251851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700018882751465, "StateBufferConnector_ms": 0.008000850677490234, "ViewRequirementAgentConnector_ms": 0.13652300834655762}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5354.788003937, "num_env_steps_trained_throughput_per_sec": 5354.788003937, "timesteps_total": 828000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 3408.612, "sample_time_ms": 3158.452, "load_time_ms": 17.943, "load_throughput": 1003179.348, "learn_time_ms": 219.927, "learn_throughput": 81845.188, "synch_weights_time_ms": 10.324}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3117, "training_iteration": 46, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-39", "timestamp": 1698246099, "time_this_iter_s": 3.3674774169921875, "time_total_s": 152.95319056510925, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 152.95319056510925, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 68.86000000000001, "ram_util_percent": 26.619999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404013e-15, "cur_lr": 0.0003, "total_loss": 6.921090801556905, "policy_loss": -0.0002412830169002215, "vf_loss": 6.921389659245809, "vf_explained_var": -1.6490618387858074e-06, "kl": 0.0007516578372149437, "entropy": 0.5757322361071905, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 558.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.6809999999998375, "episode_len_mean": 248.84, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 40.70000000000002, 22.699999999999882, 46.3, 31.900000000000013, -50.00000000000044, 31.70000000000001, -50.00000000000044, 35.10000000000004, 40.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.70000000000002, 25.899999999999928, 16.29999999999979, 45.1, -50.00000000000044, 45.5, -50.00000000000044, 45.3, 40.500000000000014, 40.30000000000002, 33.70000000000004, 42.10000000000001, -50.00000000000044, 43.900000000000006, 44.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 42.30000000000001, 41.70000000000002, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 20.899999999999856, 46.099999999999994, 45.9, 37.300000000000026, 42.70000000000001, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 44.900000000000006, 44.10000000000001, 43.7, 40.90000000000002, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 28.89999999999997, 31.500000000000007, 0.8999999999995723, 45.7, 44.7, 39.10000000000002, 43.50000000000001, 45.1, 46.5, 34.10000000000004, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.500000000000014, 40.30000000000002, -50.00000000000044, 44.900000000000006, 20.899999999999856, 33.30000000000003, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.500000000000014], "episode_lengths": [48, 500, 94, 274, 38, 182, 500, 184, 500, 150, 96, 74, 500, 500, 70, 500, 88, 500, 104, 242, 338, 50, 500, 46, 500, 48, 96, 98, 164, 80, 500, 62, 52, 500, 42, 500, 60, 500, 500, 152, 500, 500, 154, 500, 78, 84, 48, 500, 70, 500, 292, 40, 42, 128, 74, 136, 500, 500, 500, 208, 52, 60, 64, 92, 500, 48, 52, 500, 48, 500, 80, 500, 212, 186, 492, 44, 54, 110, 66, 50, 36, 160, 278, 500, 500, 500, 500, 500, 50, 500, 76, 98, 500, 52, 292, 168, 500, 500, 102, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41271642716838863, "mean_inference_ms": 1.3163743999707582, "mean_action_processing_ms": 0.1544234492922593, "mean_env_wait_ms": 0.091366758477355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699445724487305, "StateBufferConnector_ms": 0.006004810333251953, "ViewRequirementAgentConnector_ms": 0.13500428199768066}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.6809999999998375, "episode_len_mean": 248.84, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 40.70000000000002, 22.699999999999882, 46.3, 31.900000000000013, -50.00000000000044, 31.70000000000001, -50.00000000000044, 35.10000000000004, 40.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.70000000000002, 25.899999999999928, 16.29999999999979, 45.1, -50.00000000000044, 45.5, -50.00000000000044, 45.3, 40.500000000000014, 40.30000000000002, 33.70000000000004, 42.10000000000001, -50.00000000000044, 43.900000000000006, 44.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 42.30000000000001, 41.70000000000002, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 20.899999999999856, 46.099999999999994, 45.9, 37.300000000000026, 42.70000000000001, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 44.900000000000006, 44.10000000000001, 43.7, 40.90000000000002, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 28.89999999999997, 31.500000000000007, 0.8999999999995723, 45.7, 44.7, 39.10000000000002, 43.50000000000001, 45.1, 46.5, 34.10000000000004, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.500000000000014, 40.30000000000002, -50.00000000000044, 44.900000000000006, 20.899999999999856, 33.30000000000003, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.500000000000014], "episode_lengths": [48, 500, 94, 274, 38, 182, 500, 184, 500, 150, 96, 74, 500, 500, 70, 500, 88, 500, 104, 242, 338, 50, 500, 46, 500, 48, 96, 98, 164, 80, 500, 62, 52, 500, 42, 500, 60, 500, 500, 152, 500, 500, 154, 500, 78, 84, 48, 500, 70, 500, 292, 40, 42, 128, 74, 136, 500, 500, 500, 208, 52, 60, 64, 92, 500, 48, 52, 500, 48, 500, 80, 500, 212, 186, 492, 44, 54, 110, 66, 50, 36, 160, 278, 500, 500, 500, 500, 500, 50, 500, 76, 98, 500, 52, 292, 168, 500, 500, 102, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41271642716838863, "mean_inference_ms": 1.3163743999707582, "mean_action_processing_ms": 0.1544234492922593, "mean_env_wait_ms": 0.091366758477355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699445724487305, "StateBufferConnector_ms": 0.006004810333251953, "ViewRequirementAgentConnector_ms": 0.13500428199768066}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4631.019990850516, "num_env_steps_trained_throughput_per_sec": 4631.019990850516, "timesteps_total": 846000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 846000, "timers": {"training_iteration_time_ms": 3421.901, "sample_time_ms": 3188.829, "load_time_ms": 16.93, "load_throughput": 1063224.876, "learn_time_ms": 203.697, "learn_throughput": 88366.528, "synch_weights_time_ms": 10.479}, "counters": {"num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "done": false, "episodes_total": 3187, "training_iteration": 47, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-43", "timestamp": 1698246103, "time_this_iter_s": 3.892829179763794, "time_total_s": 156.84601974487305, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 156.84601974487305, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 81.86, "ram_util_percent": 26.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 0.0003, "total_loss": 6.660120765368144, "policy_loss": 0.047332074493169785, "vf_loss": 6.61284605662028, "vf_explained_var": -7.003545761108398e-07, "kl": 8.36651739390959e-05, "entropy": 0.5732603619496027, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 570.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.820999999999816, "episode_len_mean": 277.4, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 44.10000000000001, 43.7, 40.90000000000002, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 28.89999999999997, 31.500000000000007, 0.8999999999995723, 45.7, 44.7, 39.10000000000002, 43.50000000000001, 45.1, 46.5, 34.10000000000004, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.500000000000014, 40.30000000000002, -50.00000000000044, 44.900000000000006, 20.899999999999856, 33.30000000000003, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, 31.70000000000001, -50.00000000000044, 37.90000000000003, 37.90000000000003, -50.00000000000044, 28.699999999999967, 27.699999999999953, 32.700000000000024, 0.8999999999995723, 37.50000000000003, 30.9, 31.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003, 43.10000000000001, 34.50000000000004, 20.49999999999985, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.900000000000006, 34.70000000000004, 35.70000000000003, -50.00000000000044, -50.00000000000044, 42.10000000000001, 31.300000000000004, 43.50000000000001, -50.00000000000044, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, 26.299999999999933, 45.9, 37.70000000000003, -50.00000000000044, 24.299999999999905, 40.90000000000002], "episode_lengths": [52, 60, 64, 92, 500, 48, 52, 500, 48, 500, 80, 500, 212, 186, 492, 44, 54, 110, 66, 50, 36, 160, 278, 500, 500, 500, 500, 500, 50, 500, 76, 98, 500, 52, 292, 168, 500, 500, 102, 76, 500, 500, 232, 500, 184, 500, 122, 122, 500, 214, 224, 174, 492, 126, 192, 184, 500, 500, 58, 500, 500, 500, 120, 500, 500, 144, 70, 156, 296, 72, 500, 500, 500, 86, 52, 154, 144, 500, 500, 80, 188, 66, 500, 40, 52, 500, 500, 30, 500, 500, 500, 500, 314, 500, 238, 42, 124, 500, 258, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4135587839719554, "mean_inference_ms": 1.319530323106595, "mean_action_processing_ms": 0.1546228968394638, "mean_env_wait_ms": 0.09154648891451249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600358963012695, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.13703513145446777}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.820999999999816, "episode_len_mean": 277.4, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 44.10000000000001, 43.7, 40.90000000000002, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 28.89999999999997, 31.500000000000007, 0.8999999999995723, 45.7, 44.7, 39.10000000000002, 43.50000000000001, 45.1, 46.5, 34.10000000000004, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.500000000000014, 40.30000000000002, -50.00000000000044, 44.900000000000006, 20.899999999999856, 33.30000000000003, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, 31.70000000000001, -50.00000000000044, 37.90000000000003, 37.90000000000003, -50.00000000000044, 28.699999999999967, 27.699999999999953, 32.700000000000024, 0.8999999999995723, 37.50000000000003, 30.9, 31.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003, 43.10000000000001, 34.50000000000004, 20.49999999999985, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.900000000000006, 34.70000000000004, 35.70000000000003, -50.00000000000044, -50.00000000000044, 42.10000000000001, 31.300000000000004, 43.50000000000001, -50.00000000000044, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, 26.299999999999933, 45.9, 37.70000000000003, -50.00000000000044, 24.299999999999905, 40.90000000000002], "episode_lengths": [52, 60, 64, 92, 500, 48, 52, 500, 48, 500, 80, 500, 212, 186, 492, 44, 54, 110, 66, 50, 36, 160, 278, 500, 500, 500, 500, 500, 50, 500, 76, 98, 500, 52, 292, 168, 500, 500, 102, 76, 500, 500, 232, 500, 184, 500, 122, 122, 500, 214, 224, 174, 492, 126, 192, 184, 500, 500, 58, 500, 500, 500, 120, 500, 500, 144, 70, 156, 296, 72, 500, 500, 500, 86, 52, 154, 144, 500, 500, 80, 188, 66, 500, 40, 52, 500, 500, 30, 500, 500, 500, 500, 314, 500, 238, 42, 124, 500, 258, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4135587839719554, "mean_inference_ms": 1.319530323106595, "mean_action_processing_ms": 0.1546228968394638, "mean_env_wait_ms": 0.09154648891451249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600358963012695, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.13703513145446777}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4940.754250041687, "num_env_steps_trained_throughput_per_sec": 4940.754250041687, "timesteps_total": 864000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 3426.491, "sample_time_ms": 3180.258, "load_time_ms": 17.497, "load_throughput": 1028749.707, "learn_time_ms": 216.244, "learn_throughput": 83239.255, "synch_weights_time_ms": 10.525}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3247, "training_iteration": 48, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-47", "timestamp": 1698246107, "time_this_iter_s": 3.653890371322632, "time_total_s": 160.49991011619568, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 160.49991011619568, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 69.06666666666666, "ram_util_percent": 27.049999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601003e-16, "cur_lr": 0.0003, "total_loss": 7.330118695894877, "policy_loss": 1.1767260730266571e-05, "vf_loss": 7.330167094866435, "vf_explained_var": -2.632538477579753e-07, "kl": 4.752516388369562e-05, "entropy": 0.5993971427281698, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 582.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.72199999999984, "episode_len_mean": 253.46, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 34.70000000000004, 35.70000000000003, -50.00000000000044, -50.00000000000044, 42.10000000000001, 31.300000000000004, 43.50000000000001, -50.00000000000044, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, 26.299999999999933, 45.9, 37.70000000000003, -50.00000000000044, 24.299999999999905, 40.90000000000002, -50.00000000000044, 11.099999999999717, 4.899999999999629, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 24.69999999999991, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.5, -50.00000000000044, 46.5, 35.900000000000034, 39.50000000000002, 35.500000000000036, 9.499999999999694, 35.900000000000034, 42.30000000000001, 41.500000000000014, -50.00000000000044, 40.500000000000014, 42.30000000000001, 26.299999999999933, 43.30000000000001, 42.70000000000001, 34.900000000000034, 26.499999999999936, -50.00000000000044, 43.7, 45.7, 40.70000000000002, 43.10000000000001, -50.00000000000044, 35.10000000000004, 22.49999999999988, 46.699999999999996, 35.30000000000004, -50.00000000000044, 42.30000000000001, 40.70000000000002, 42.70000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 32.100000000000016, 38.10000000000002, -50.00000000000044, 43.900000000000006, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.3, 27.699999999999953, 38.300000000000026, 41.100000000000016, -50.00000000000044, 43.50000000000001, 42.30000000000001, 23.099999999999888, 40.70000000000002, 5.299999999999635, 40.70000000000002, 39.300000000000026, 8.699999999999683, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996], "episode_lengths": [52, 154, 144, 500, 500, 80, 188, 66, 500, 40, 52, 500, 500, 30, 500, 500, 500, 500, 314, 500, 238, 42, 124, 500, 258, 92, 500, 390, 452, 56, 500, 500, 500, 76, 254, 500, 500, 98, 56, 500, 36, 142, 106, 146, 406, 142, 78, 86, 500, 96, 78, 238, 68, 74, 152, 236, 500, 64, 44, 94, 70, 500, 150, 276, 34, 148, 500, 78, 94, 74, 500, 122, 500, 180, 120, 500, 62, 160, 500, 500, 500, 500, 76, 48, 224, 118, 90, 500, 66, 78, 270, 94, 448, 94, 108, 414, 74, 500, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41385590027934016, "mean_inference_ms": 1.320134071282189, "mean_action_processing_ms": 0.15483949397486513, "mean_env_wait_ms": 0.09157525609210954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03007960319519043, "StateBufferConnector_ms": 0.009002685546875, "ViewRequirementAgentConnector_ms": 0.14202880859375}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.72199999999984, "episode_len_mean": 253.46, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 34.70000000000004, 35.70000000000003, -50.00000000000044, -50.00000000000044, 42.10000000000001, 31.300000000000004, 43.50000000000001, -50.00000000000044, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, 26.299999999999933, 45.9, 37.70000000000003, -50.00000000000044, 24.299999999999905, 40.90000000000002, -50.00000000000044, 11.099999999999717, 4.899999999999629, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 24.69999999999991, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.5, -50.00000000000044, 46.5, 35.900000000000034, 39.50000000000002, 35.500000000000036, 9.499999999999694, 35.900000000000034, 42.30000000000001, 41.500000000000014, -50.00000000000044, 40.500000000000014, 42.30000000000001, 26.299999999999933, 43.30000000000001, 42.70000000000001, 34.900000000000034, 26.499999999999936, -50.00000000000044, 43.7, 45.7, 40.70000000000002, 43.10000000000001, -50.00000000000044, 35.10000000000004, 22.49999999999988, 46.699999999999996, 35.30000000000004, -50.00000000000044, 42.30000000000001, 40.70000000000002, 42.70000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 32.100000000000016, 38.10000000000002, -50.00000000000044, 43.900000000000006, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.3, 27.699999999999953, 38.300000000000026, 41.100000000000016, -50.00000000000044, 43.50000000000001, 42.30000000000001, 23.099999999999888, 40.70000000000002, 5.299999999999635, 40.70000000000002, 39.300000000000026, 8.699999999999683, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996], "episode_lengths": [52, 154, 144, 500, 500, 80, 188, 66, 500, 40, 52, 500, 500, 30, 500, 500, 500, 500, 314, 500, 238, 42, 124, 500, 258, 92, 500, 390, 452, 56, 500, 500, 500, 76, 254, 500, 500, 98, 56, 500, 36, 142, 106, 146, 406, 142, 78, 86, 500, 96, 78, 238, 68, 74, 152, 236, 500, 64, 44, 94, 70, 500, 150, 276, 34, 148, 500, 78, 94, 74, 500, 122, 500, 180, 120, 500, 62, 160, 500, 500, 500, 500, 76, 48, 224, 118, 90, 500, 66, 78, 270, 94, 448, 94, 108, 414, 74, 500, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41385590027934016, "mean_inference_ms": 1.320134071282189, "mean_action_processing_ms": 0.15483949397486513, "mean_env_wait_ms": 0.09157525609210954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03007960319519043, "StateBufferConnector_ms": 0.009002685546875, "ViewRequirementAgentConnector_ms": 0.14202880859375}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5182.2921668232275, "num_env_steps_trained_throughput_per_sec": 5182.2921668232275, "timesteps_total": 882000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 882000, "timers": {"training_iteration_time_ms": 3412.885, "sample_time_ms": 3168.725, "load_time_ms": 17.203, "load_throughput": 1046298.847, "learn_time_ms": 215.051, "learn_throughput": 83701.258, "synch_weights_time_ms": 10.039}, "counters": {"num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "done": false, "episodes_total": 3321, "training_iteration": 49, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-50", "timestamp": 1698246110, "time_this_iter_s": 3.478365182876587, "time_total_s": 163.97827529907227, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 163.97827529907227, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 78.275, "ram_util_percent": 26.950000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788005016e-16, "cur_lr": 0.0003, "total_loss": 7.41287362575531, "policy_loss": -0.030897515670706827, "vf_loss": 7.443835298220317, "vf_explained_var": -8.344650268554688e-07, "kl": 0.00010034914542611517, "entropy": 0.6422216296195984, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 594.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.456999999999862, "episode_len_mean": 241.16, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.3, 27.699999999999953, 38.300000000000026, 41.100000000000016, -50.00000000000044, 43.50000000000001, 42.30000000000001, 23.099999999999888, 40.70000000000002, 5.299999999999635, 40.70000000000002, 39.300000000000026, 8.699999999999683, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 31.300000000000004, -50.00000000000044, 42.30000000000001, 41.30000000000001, 45.3, -50.00000000000044, 46.9, 43.7, 18.29999999999982, 39.90000000000002, 45.9, 10.899999999999714, 15.899999999999785, -50.00000000000044, -50.00000000000044, 30.29999999999999, 45.1, 29.69999999999998, 35.30000000000004, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.90000000000002, -50.00000000000044, 42.500000000000014, 40.10000000000002, -50.00000000000044, 43.10000000000001, 26.69999999999994, 38.300000000000026, -50.00000000000044, 38.300000000000026, -50.00000000000044, 31.900000000000013, 28.699999999999967, 40.30000000000002, 27.899999999999956, 19.499999999999837, 28.699999999999967, 39.50000000000002, 37.50000000000003, 45.7, 38.50000000000003, 26.69999999999994, -50.00000000000044, 39.50000000000002, 46.3, 42.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 40.30000000000002, 24.499999999999908, 44.900000000000006, 43.7, -50.00000000000044, 27.899999999999956, 42.70000000000001, 24.499999999999908, 17.099999999999802, 26.89999999999994, 35.10000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, 24.299999999999905, 28.499999999999964, -50.00000000000044, 41.100000000000016, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.900000000000006, 32.50000000000002], "episode_lengths": [62, 160, 500, 500, 500, 500, 76, 48, 224, 118, 90, 500, 66, 78, 270, 94, 448, 94, 108, 414, 74, 500, 500, 34, 500, 188, 500, 78, 88, 48, 500, 32, 64, 318, 102, 42, 392, 342, 500, 500, 198, 50, 204, 148, 500, 500, 136, 92, 500, 76, 100, 500, 70, 234, 118, 500, 118, 500, 182, 214, 98, 222, 306, 214, 106, 126, 44, 116, 234, 500, 106, 38, 80, 500, 42, 500, 98, 256, 52, 64, 500, 222, 74, 256, 330, 232, 150, 108, 500, 500, 258, 216, 500, 90, 70, 500, 500, 68, 72, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41381723698177125, "mean_inference_ms": 1.3204105309418117, "mean_action_processing_ms": 0.15491080335915822, "mean_env_wait_ms": 0.09128034609067331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025081396102905273, "StateBufferConnector_ms": 0.0049953460693359375, "ViewRequirementAgentConnector_ms": 0.12225890159606934}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.456999999999862, "episode_len_mean": 241.16, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.3, 27.699999999999953, 38.300000000000026, 41.100000000000016, -50.00000000000044, 43.50000000000001, 42.30000000000001, 23.099999999999888, 40.70000000000002, 5.299999999999635, 40.70000000000002, 39.300000000000026, 8.699999999999683, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 31.300000000000004, -50.00000000000044, 42.30000000000001, 41.30000000000001, 45.3, -50.00000000000044, 46.9, 43.7, 18.29999999999982, 39.90000000000002, 45.9, 10.899999999999714, 15.899999999999785, -50.00000000000044, -50.00000000000044, 30.29999999999999, 45.1, 29.69999999999998, 35.30000000000004, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.90000000000002, -50.00000000000044, 42.500000000000014, 40.10000000000002, -50.00000000000044, 43.10000000000001, 26.69999999999994, 38.300000000000026, -50.00000000000044, 38.300000000000026, -50.00000000000044, 31.900000000000013, 28.699999999999967, 40.30000000000002, 27.899999999999956, 19.499999999999837, 28.699999999999967, 39.50000000000002, 37.50000000000003, 45.7, 38.50000000000003, 26.69999999999994, -50.00000000000044, 39.50000000000002, 46.3, 42.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 40.30000000000002, 24.499999999999908, 44.900000000000006, 43.7, -50.00000000000044, 27.899999999999956, 42.70000000000001, 24.499999999999908, 17.099999999999802, 26.89999999999994, 35.10000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, 24.299999999999905, 28.499999999999964, -50.00000000000044, 41.100000000000016, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.900000000000006, 32.50000000000002], "episode_lengths": [62, 160, 500, 500, 500, 500, 76, 48, 224, 118, 90, 500, 66, 78, 270, 94, 448, 94, 108, 414, 74, 500, 500, 34, 500, 188, 500, 78, 88, 48, 500, 32, 64, 318, 102, 42, 392, 342, 500, 500, 198, 50, 204, 148, 500, 500, 136, 92, 500, 76, 100, 500, 70, 234, 118, 500, 118, 500, 182, 214, 98, 222, 306, 214, 106, 126, 44, 116, 234, 500, 106, 38, 80, 500, 42, 500, 98, 256, 52, 64, 500, 222, 74, 256, 330, 232, 150, 108, 500, 500, 258, 216, 500, 90, 70, 500, 500, 68, 72, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41381723698177125, "mean_inference_ms": 1.3204105309418117, "mean_action_processing_ms": 0.15491080335915822, "mean_env_wait_ms": 0.09128034609067331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025081396102905273, "StateBufferConnector_ms": 0.0049953460693359375, "ViewRequirementAgentConnector_ms": 0.12225890159606934}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5525.861679025249, "num_env_steps_trained_throughput_per_sec": 5525.861679025249, "timesteps_total": 900000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 3411.164, "sample_time_ms": 3161.171, "load_time_ms": 17.926, "load_throughput": 1004103.957, "learn_time_ms": 220.202, "learn_throughput": 81743.182, "synch_weights_time_ms": 9.998}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3397, "training_iteration": 50, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-54", "timestamp": 1698246114, "time_this_iter_s": 3.2624104022979736, "time_total_s": 167.24068570137024, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 167.24068570137024, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 66.52, "ram_util_percent": 26.940000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002508e-16, "cur_lr": 0.0003, "total_loss": 6.787693460782369, "policy_loss": -0.02470364181014399, "vf_loss": 6.812458833058675, "vf_explained_var": -2.4934609731038413e-06, "kl": 0.0004554341667504976, "entropy": 0.6160069753726324, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 606.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.822999999999848, "episode_len_mean": 247.44, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.50000000000002, 46.3, 42.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 40.30000000000002, 24.499999999999908, 44.900000000000006, 43.7, -50.00000000000044, 27.899999999999956, 42.70000000000001, 24.499999999999908, 17.099999999999802, 26.89999999999994, 35.10000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, 24.299999999999905, 28.499999999999964, -50.00000000000044, 41.100000000000016, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.900000000000006, 32.50000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 31.70000000000001, 44.900000000000006, 43.30000000000001, 41.30000000000001, 46.5, 29.69999999999998, 44.10000000000001, 32.30000000000002, -50.00000000000044, 37.50000000000003, -50.00000000000044, 46.5, 10.899999999999714, -50.00000000000044, 43.50000000000001, 34.30000000000004, 42.900000000000006, 28.499999999999964, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 28.499999999999964, -50.00000000000044, 41.90000000000001, 41.70000000000002, 45.5, -50.00000000000044, 39.70000000000002, 34.30000000000004, 43.50000000000001, 41.100000000000016, 40.500000000000014, 43.7, 42.30000000000001, 44.300000000000004, 43.7, 45.9, 34.70000000000004, 38.700000000000024, 39.70000000000002, 32.700000000000024, 41.100000000000016, -50.00000000000044, -50.00000000000044, 16.29999999999979, 41.90000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001], "episode_lengths": [106, 38, 80, 500, 42, 500, 98, 256, 52, 64, 500, 222, 74, 256, 330, 232, 150, 108, 500, 500, 258, 216, 500, 90, 70, 500, 500, 68, 72, 176, 500, 68, 500, 500, 184, 52, 68, 88, 36, 204, 60, 178, 500, 126, 500, 36, 392, 500, 66, 158, 72, 216, 500, 48, 500, 500, 500, 500, 70, 500, 500, 322, 500, 500, 500, 124, 216, 500, 82, 84, 46, 500, 104, 158, 66, 90, 96, 64, 78, 58, 64, 42, 154, 114, 104, 174, 90, 500, 500, 338, 82, 500, 56, 500, 500, 82, 106, 500, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4142835010014258, "mean_inference_ms": 1.323853160321066, "mean_action_processing_ms": 0.15493065274303497, "mean_env_wait_ms": 0.09103445956286489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033997535705566406, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.11019182205200195}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.822999999999848, "episode_len_mean": 247.44, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.50000000000002, 46.3, 42.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 40.30000000000002, 24.499999999999908, 44.900000000000006, 43.7, -50.00000000000044, 27.899999999999956, 42.70000000000001, 24.499999999999908, 17.099999999999802, 26.89999999999994, 35.10000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, 24.299999999999905, 28.499999999999964, -50.00000000000044, 41.100000000000016, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.900000000000006, 32.50000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 31.70000000000001, 44.900000000000006, 43.30000000000001, 41.30000000000001, 46.5, 29.69999999999998, 44.10000000000001, 32.30000000000002, -50.00000000000044, 37.50000000000003, -50.00000000000044, 46.5, 10.899999999999714, -50.00000000000044, 43.50000000000001, 34.30000000000004, 42.900000000000006, 28.499999999999964, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 28.499999999999964, -50.00000000000044, 41.90000000000001, 41.70000000000002, 45.5, -50.00000000000044, 39.70000000000002, 34.30000000000004, 43.50000000000001, 41.100000000000016, 40.500000000000014, 43.7, 42.30000000000001, 44.300000000000004, 43.7, 45.9, 34.70000000000004, 38.700000000000024, 39.70000000000002, 32.700000000000024, 41.100000000000016, -50.00000000000044, -50.00000000000044, 16.29999999999979, 41.90000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001], "episode_lengths": [106, 38, 80, 500, 42, 500, 98, 256, 52, 64, 500, 222, 74, 256, 330, 232, 150, 108, 500, 500, 258, 216, 500, 90, 70, 500, 500, 68, 72, 176, 500, 68, 500, 500, 184, 52, 68, 88, 36, 204, 60, 178, 500, 126, 500, 36, 392, 500, 66, 158, 72, 216, 500, 48, 500, 500, 500, 500, 70, 500, 500, 322, 500, 500, 500, 124, 216, 500, 82, 84, 46, 500, 104, 158, 66, 90, 96, 64, 78, 58, 64, 42, 154, 114, 104, 174, 90, 500, 500, 338, 82, 500, 56, 500, 500, 82, 106, 500, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4142835010014258, "mean_inference_ms": 1.323853160321066, "mean_action_processing_ms": 0.15493065274303497, "mean_env_wait_ms": 0.09103445956286489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033997535705566406, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.11019182205200195}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4990.008214952165, "num_env_steps_trained_throughput_per_sec": 4990.008214952165, "timesteps_total": 918000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 918000, "timers": {"training_iteration_time_ms": 3453.083, "sample_time_ms": 3208.102, "load_time_ms": 17.319, "load_throughput": 1039347.461, "learn_time_ms": 215.552, "learn_throughput": 83506.497, "synch_weights_time_ms": 10.044}, "counters": {"num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "done": false, "episodes_total": 3467, "training_iteration": 51, "trial_id": "9f288_00006", "date": "2023-10-25_16-01-57", "timestamp": 1698246117, "time_this_iter_s": 3.6112077236175537, "time_total_s": 170.8518934249878, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 170.8518934249878, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 75.54, "ram_util_percent": 26.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001254e-17, "cur_lr": 0.0003, "total_loss": 6.84540859858195, "policy_loss": -0.0038955947384238243, "vf_loss": 6.849359631538391, "vf_explained_var": -7.698933283487955e-07, "kl": 0.0012427149974125011, "entropy": 0.555179643134276, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 618.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.188999999999862, "episode_len_mean": 233.82, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 40.500000000000014, 43.7, 42.30000000000001, 44.300000000000004, 43.7, 45.9, 34.70000000000004, 38.700000000000024, 39.70000000000002, 32.700000000000024, 41.100000000000016, -50.00000000000044, -50.00000000000044, 16.29999999999979, 41.90000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.5, 44.5, 47.1, 43.50000000000001, 44.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 41.90000000000001, 42.900000000000006, -50.00000000000044, 43.30000000000001, 40.500000000000014, 45.9, -50.00000000000044, 18.29999999999982, 36.10000000000004, 43.7, 44.300000000000004, 21.89999999999987, -50.00000000000044, -50.00000000000044, 36.50000000000003, 20.699999999999854, 28.89999999999997, 40.30000000000002, -50.00000000000044, -50.00000000000044, 21.699999999999868, 30.699999999999996, 39.300000000000026, 33.10000000000003, 44.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, 42.500000000000014, -50.00000000000044, 46.699999999999996, 40.30000000000002, 24.299999999999905, -50.00000000000044, 42.500000000000014, 32.90000000000003, -50.00000000000044, 33.70000000000004, 2.299999999999592, 43.7, 46.9, 43.7, -50.00000000000044, 38.90000000000002, 38.90000000000002, 40.500000000000014, 38.50000000000003, 28.499999999999964, 35.70000000000003, 12.69999999999974, 40.90000000000002, 41.500000000000014, 30.29999999999999, 33.30000000000003, 39.300000000000026, 42.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [90, 96, 64, 78, 58, 64, 42, 154, 114, 104, 174, 90, 500, 500, 338, 82, 500, 56, 500, 500, 82, 106, 500, 500, 70, 500, 46, 56, 30, 66, 56, 68, 500, 500, 56, 500, 66, 500, 82, 72, 500, 68, 96, 42, 500, 318, 140, 64, 58, 282, 500, 500, 136, 294, 212, 98, 500, 500, 284, 194, 108, 170, 54, 500, 52, 500, 500, 500, 500, 342, 76, 500, 34, 98, 258, 500, 76, 172, 500, 164, 478, 64, 32, 64, 500, 112, 112, 96, 116, 216, 144, 374, 92, 86, 198, 168, 108, 72, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4155825606864768, "mean_inference_ms": 1.3249648041071507, "mean_action_processing_ms": 0.15566223828999706, "mean_env_wait_ms": 0.09135496251838347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036998748779296875, "StateBufferConnector_ms": 0.0050084590911865234, "ViewRequirementAgentConnector_ms": 0.1640012264251709}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.188999999999862, "episode_len_mean": 233.82, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 40.500000000000014, 43.7, 42.30000000000001, 44.300000000000004, 43.7, 45.9, 34.70000000000004, 38.700000000000024, 39.70000000000002, 32.700000000000024, 41.100000000000016, -50.00000000000044, -50.00000000000044, 16.29999999999979, 41.90000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.5, 44.5, 47.1, 43.50000000000001, 44.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 41.90000000000001, 42.900000000000006, -50.00000000000044, 43.30000000000001, 40.500000000000014, 45.9, -50.00000000000044, 18.29999999999982, 36.10000000000004, 43.7, 44.300000000000004, 21.89999999999987, -50.00000000000044, -50.00000000000044, 36.50000000000003, 20.699999999999854, 28.89999999999997, 40.30000000000002, -50.00000000000044, -50.00000000000044, 21.699999999999868, 30.699999999999996, 39.300000000000026, 33.10000000000003, 44.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, 42.500000000000014, -50.00000000000044, 46.699999999999996, 40.30000000000002, 24.299999999999905, -50.00000000000044, 42.500000000000014, 32.90000000000003, -50.00000000000044, 33.70000000000004, 2.299999999999592, 43.7, 46.9, 43.7, -50.00000000000044, 38.90000000000002, 38.90000000000002, 40.500000000000014, 38.50000000000003, 28.499999999999964, 35.70000000000003, 12.69999999999974, 40.90000000000002, 41.500000000000014, 30.29999999999999, 33.30000000000003, 39.300000000000026, 42.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [90, 96, 64, 78, 58, 64, 42, 154, 114, 104, 174, 90, 500, 500, 338, 82, 500, 56, 500, 500, 82, 106, 500, 500, 70, 500, 46, 56, 30, 66, 56, 68, 500, 500, 56, 500, 66, 500, 82, 72, 500, 68, 96, 42, 500, 318, 140, 64, 58, 282, 500, 500, 136, 294, 212, 98, 500, 500, 284, 194, 108, 170, 54, 500, 52, 500, 500, 500, 500, 342, 76, 500, 34, 98, 258, 500, 76, 172, 500, 164, 478, 64, 32, 64, 500, 112, 112, 96, 116, 216, 144, 374, 92, 86, 198, 168, 108, 72, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4155825606864768, "mean_inference_ms": 1.3249648041071507, "mean_action_processing_ms": 0.15566223828999706, "mean_env_wait_ms": 0.09135496251838347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036998748779296875, "StateBufferConnector_ms": 0.0050084590911865234, "ViewRequirementAgentConnector_ms": 0.1640012264251709}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5128.755223693224, "num_env_steps_trained_throughput_per_sec": 5128.755223693224, "timesteps_total": 936000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 3499.635, "sample_time_ms": 3263.445, "load_time_ms": 17.119, "load_throughput": 1051490.967, "learn_time_ms": 207.261, "learn_throughput": 86847.133, "synch_weights_time_ms": 10.044}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3542, "training_iteration": 52, "trial_id": "9f288_00006", "date": "2023-10-25_16-02-01", "timestamp": 1698246121, "time_this_iter_s": 3.515624523162842, "time_total_s": 174.36751794815063, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 174.36751794815063, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 76.04, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.440892098500627e-17, "cur_lr": 0.0003, "total_loss": 6.785904924074809, "policy_loss": 0.0030928965037067733, "vf_loss": 6.782864212989807, "vf_explained_var": -6.953875223795573e-07, "kl": 0.0007529732487986015, "entropy": 0.5208610023061434, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 630.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.806999999999842, "episode_len_mean": 247.62, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, -50.00000000000044, 46.699999999999996, 40.30000000000002, 24.299999999999905, -50.00000000000044, 42.500000000000014, 32.90000000000003, -50.00000000000044, 33.70000000000004, 2.299999999999592, 43.7, 46.9, 43.7, -50.00000000000044, 38.90000000000002, 38.90000000000002, 40.500000000000014, 38.50000000000003, 28.499999999999964, 35.70000000000003, 12.69999999999974, 40.90000000000002, 41.500000000000014, 30.29999999999999, 33.30000000000003, 39.300000000000026, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, 31.1, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.7, -50.00000000000044, 37.10000000000003, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 30.099999999999987, 34.70000000000004, -50.00000000000044, 46.9, 13.899999999999757, 44.10000000000001, -50.00000000000044, 28.499999999999964, -50.00000000000044, 45.5, -50.00000000000044, 27.699999999999953, 44.5, -50.00000000000044, 6.499999999999652, 46.3, 35.500000000000036, 41.30000000000001, 44.5, 42.70000000000001, 45.9, 2.299999999999592, -50.00000000000044, 35.500000000000036, 16.29999999999979, 44.900000000000006, 43.900000000000006, -50.00000000000044, 11.699999999999726, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.9, 35.10000000000004, 25.699999999999925, 26.299999999999933, 43.7, -50.00000000000044, 45.9, 46.5, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 42.10000000000001, 25.29999999999992], "episode_lengths": [76, 500, 34, 98, 258, 500, 76, 172, 500, 164, 478, 64, 32, 64, 500, 112, 112, 96, 116, 216, 144, 374, 92, 86, 198, 168, 108, 72, 500, 500, 72, 52, 190, 98, 500, 500, 500, 500, 32, 500, 50, 500, 500, 500, 52, 54, 500, 130, 38, 500, 500, 500, 44, 200, 154, 500, 32, 362, 60, 500, 216, 500, 46, 500, 224, 56, 500, 436, 38, 146, 88, 56, 74, 42, 478, 500, 146, 338, 52, 62, 500, 384, 500, 500, 48, 500, 42, 150, 244, 238, 64, 500, 42, 36, 500, 500, 42, 116, 80, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41523004469937136, "mean_inference_ms": 1.3246667252380206, "mean_action_processing_ms": 0.15560335050864435, "mean_env_wait_ms": 0.09158265301539062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03193330764770508, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.11804413795471191}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.806999999999842, "episode_len_mean": 247.62, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, -50.00000000000044, 46.699999999999996, 40.30000000000002, 24.299999999999905, -50.00000000000044, 42.500000000000014, 32.90000000000003, -50.00000000000044, 33.70000000000004, 2.299999999999592, 43.7, 46.9, 43.7, -50.00000000000044, 38.90000000000002, 38.90000000000002, 40.500000000000014, 38.50000000000003, 28.499999999999964, 35.70000000000003, 12.69999999999974, 40.90000000000002, 41.500000000000014, 30.29999999999999, 33.30000000000003, 39.300000000000026, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, 31.1, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.7, -50.00000000000044, 37.10000000000003, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 30.099999999999987, 34.70000000000004, -50.00000000000044, 46.9, 13.899999999999757, 44.10000000000001, -50.00000000000044, 28.499999999999964, -50.00000000000044, 45.5, -50.00000000000044, 27.699999999999953, 44.5, -50.00000000000044, 6.499999999999652, 46.3, 35.500000000000036, 41.30000000000001, 44.5, 42.70000000000001, 45.9, 2.299999999999592, -50.00000000000044, 35.500000000000036, 16.29999999999979, 44.900000000000006, 43.900000000000006, -50.00000000000044, 11.699999999999726, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.9, 35.10000000000004, 25.699999999999925, 26.299999999999933, 43.7, -50.00000000000044, 45.9, 46.5, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 42.10000000000001, 25.29999999999992], "episode_lengths": [76, 500, 34, 98, 258, 500, 76, 172, 500, 164, 478, 64, 32, 64, 500, 112, 112, 96, 116, 216, 144, 374, 92, 86, 198, 168, 108, 72, 500, 500, 72, 52, 190, 98, 500, 500, 500, 500, 32, 500, 50, 500, 500, 500, 52, 54, 500, 130, 38, 500, 500, 500, 44, 200, 154, 500, 32, 362, 60, 500, 216, 500, 46, 500, 224, 56, 500, 436, 38, 146, 88, 56, 74, 42, 478, 500, 146, 338, 52, 62, 500, 384, 500, 500, 48, 500, 42, 150, 244, 238, 64, 500, 42, 36, 500, 500, 42, 116, 80, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41523004469937136, "mean_inference_ms": 1.3246667252380206, "mean_action_processing_ms": 0.15560335050864435, "mean_env_wait_ms": 0.09158265301539062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03193330764770508, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.11804413795471191}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4950.787654066457, "num_env_steps_trained_throughput_per_sec": 4950.787654066457, "timesteps_total": 954000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 954000, "timers": {"training_iteration_time_ms": 3543.021, "sample_time_ms": 3263.406, "load_time_ms": 17.729, "load_throughput": 1015294.095, "learn_time_ms": 218.626, "learn_throughput": 82332.395, "synch_weights_time_ms": 41.493}, "counters": {"num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "done": false, "episodes_total": 3612, "training_iteration": 53, "trial_id": "9f288_00006", "date": "2023-10-25_16-02-04", "timestamp": 1698246124, "time_this_iter_s": 3.6407835483551025, "time_total_s": 178.00830149650574, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 178.00830149650574, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 68.14, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 0.0003, "total_loss": 6.719752192497253, "policy_loss": -0.007501638183991115, "vf_loss": 6.727307001749675, "vf_explained_var": -7.251898447672526e-07, "kl": 0.0003243736479721093, "entropy": 0.5316983312368393, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 642.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.406999999999831, "episode_len_mean": 261.6, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.699999999999953, 44.5, -50.00000000000044, 6.499999999999652, 46.3, 35.500000000000036, 41.30000000000001, 44.5, 42.70000000000001, 45.9, 2.299999999999592, -50.00000000000044, 35.500000000000036, 16.29999999999979, 44.900000000000006, 43.900000000000006, -50.00000000000044, 11.699999999999726, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.9, 35.10000000000004, 25.699999999999925, 26.299999999999933, 43.7, -50.00000000000044, 45.9, 46.5, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 42.10000000000001, 25.29999999999992, 26.89999999999994, 39.90000000000002, 38.300000000000026, 44.5, 23.099999999999888, 28.499999999999964, 33.30000000000003, 43.900000000000006, -50.00000000000044, 38.90000000000002, 43.7, 45.3, -50.00000000000044, 46.5, 32.90000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.900000000000006, 8.099999999999675, -50.00000000000044, 35.10000000000004, 46.5, -50.00000000000044, 45.5, 46.699999999999996, 36.900000000000034, 38.300000000000026, 43.50000000000001, 44.10000000000001, 41.90000000000001, 35.70000000000003, 13.099999999999746, -50.00000000000044, -50.00000000000044, 27.699999999999953, 43.50000000000001, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 27.099999999999945, 36.30000000000003, -50.00000000000044, -50.00000000000044, 28.699999999999967, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 32.700000000000024, 0.09999999999956088], "episode_lengths": [500, 224, 56, 500, 436, 38, 146, 88, 56, 74, 42, 478, 500, 146, 338, 52, 62, 500, 384, 500, 500, 48, 500, 42, 150, 244, 238, 64, 500, 42, 36, 500, 500, 42, 116, 80, 248, 232, 102, 118, 56, 270, 216, 168, 62, 500, 112, 64, 48, 500, 36, 172, 500, 34, 500, 500, 70, 500, 72, 420, 500, 150, 36, 500, 46, 34, 132, 118, 66, 60, 82, 144, 370, 500, 500, 224, 66, 500, 274, 500, 500, 500, 104, 500, 500, 94, 500, 500, 230, 138, 500, 500, 214, 76, 500, 500, 106, 500, 174, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41677414755050557, "mean_inference_ms": 1.3288548687765203, "mean_action_processing_ms": 0.1560038838196548, "mean_env_wait_ms": 0.09191031998774575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03174185752868652, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.16207289695739746}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.406999999999831, "episode_len_mean": 261.6, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.699999999999953, 44.5, -50.00000000000044, 6.499999999999652, 46.3, 35.500000000000036, 41.30000000000001, 44.5, 42.70000000000001, 45.9, 2.299999999999592, -50.00000000000044, 35.500000000000036, 16.29999999999979, 44.900000000000006, 43.900000000000006, -50.00000000000044, 11.699999999999726, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.9, 35.10000000000004, 25.699999999999925, 26.299999999999933, 43.7, -50.00000000000044, 45.9, 46.5, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 42.10000000000001, 25.29999999999992, 26.89999999999994, 39.90000000000002, 38.300000000000026, 44.5, 23.099999999999888, 28.499999999999964, 33.30000000000003, 43.900000000000006, -50.00000000000044, 38.90000000000002, 43.7, 45.3, -50.00000000000044, 46.5, 32.90000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.900000000000006, 8.099999999999675, -50.00000000000044, 35.10000000000004, 46.5, -50.00000000000044, 45.5, 46.699999999999996, 36.900000000000034, 38.300000000000026, 43.50000000000001, 44.10000000000001, 41.90000000000001, 35.70000000000003, 13.099999999999746, -50.00000000000044, -50.00000000000044, 27.699999999999953, 43.50000000000001, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 27.099999999999945, 36.30000000000003, -50.00000000000044, -50.00000000000044, 28.699999999999967, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 32.700000000000024, 0.09999999999956088], "episode_lengths": [500, 224, 56, 500, 436, 38, 146, 88, 56, 74, 42, 478, 500, 146, 338, 52, 62, 500, 384, 500, 500, 48, 500, 42, 150, 244, 238, 64, 500, 42, 36, 500, 500, 42, 116, 80, 248, 232, 102, 118, 56, 270, 216, 168, 62, 500, 112, 64, 48, 500, 36, 172, 500, 34, 500, 500, 70, 500, 72, 420, 500, 150, 36, 500, 46, 34, 132, 118, 66, 60, 82, 144, 370, 500, 500, 224, 66, 500, 274, 500, 500, 500, 104, 500, 500, 94, 500, 500, 230, 138, 500, 500, 214, 76, 500, 500, 106, 500, 174, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41677414755050557, "mean_inference_ms": 1.3288548687765203, "mean_action_processing_ms": 0.1560038838196548, "mean_env_wait_ms": 0.09191031998774575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03174185752868652, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.16207289695739746}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4445.540511329648, "num_env_steps_trained_throughput_per_sec": 4445.540511329648, "timesteps_total": 972000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 3597.964, "sample_time_ms": 3333.297, "load_time_ms": 17.321, "load_throughput": 1039192.954, "learn_time_ms": 204.144, "learn_throughput": 88173.188, "synch_weights_time_ms": 41.535}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3675, "training_iteration": 54, "trial_id": "9f288_00006", "date": "2023-10-25_16-02-08", "timestamp": 1698246128, "time_this_iter_s": 4.055999040603638, "time_total_s": 182.06430053710938, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 182.06430053710938, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 80.48333333333333, "ram_util_percent": 27.416666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 0.0003, "total_loss": 6.437256495157878, "policy_loss": -0.023205588571727276, "vf_loss": 6.460516889890035, "vf_explained_var": -1.430511474609375e-06, "kl": 0.0002603514027022709, "entropy": 0.5457185258467993, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 654.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.2470000000001994, "episode_len_mean": 288.04, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.300000000000026, 43.50000000000001, 44.10000000000001, 41.90000000000001, 35.70000000000003, 13.099999999999746, -50.00000000000044, -50.00000000000044, 27.699999999999953, 43.50000000000001, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 27.099999999999945, 36.30000000000003, -50.00000000000044, -50.00000000000044, 28.699999999999967, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 32.700000000000024, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 32.30000000000002, 44.7, -50.00000000000044, 45.3, 42.30000000000001, 43.7, 34.10000000000004, -50.00000000000044, 30.29999999999999, 39.90000000000002, 36.70000000000003, 41.70000000000002, 33.30000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 18.29999999999982, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 31.300000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 46.3, 40.70000000000002, -50.00000000000044, -50.00000000000044, 47.9, 46.3, 40.30000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 45.3, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 44.7, 39.50000000000002, 29.299999999999976, -50.00000000000044, 45.1, 29.099999999999973, -50.00000000000044, 42.900000000000006], "episode_lengths": [118, 66, 60, 82, 144, 370, 500, 500, 224, 66, 500, 274, 500, 500, 500, 104, 500, 500, 94, 500, 500, 230, 138, 500, 500, 214, 76, 500, 500, 106, 500, 174, 500, 500, 500, 178, 54, 500, 48, 78, 64, 160, 500, 198, 102, 134, 84, 168, 90, 500, 500, 500, 476, 500, 500, 80, 48, 500, 126, 500, 500, 68, 318, 500, 500, 50, 500, 500, 188, 80, 500, 500, 500, 56, 62, 38, 94, 500, 500, 22, 38, 98, 48, 500, 500, 500, 148, 48, 500, 66, 54, 500, 54, 106, 208, 500, 50, 210, 500, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41900626539271996, "mean_inference_ms": 1.3362512603210188, "mean_action_processing_ms": 0.15695845229465316, "mean_env_wait_ms": 0.09247143473662751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03451871871948242, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.1761326789855957}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.2470000000001994, "episode_len_mean": 288.04, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.300000000000026, 43.50000000000001, 44.10000000000001, 41.90000000000001, 35.70000000000003, 13.099999999999746, -50.00000000000044, -50.00000000000044, 27.699999999999953, 43.50000000000001, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 27.099999999999945, 36.30000000000003, -50.00000000000044, -50.00000000000044, 28.699999999999967, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 32.700000000000024, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 32.30000000000002, 44.7, -50.00000000000044, 45.3, 42.30000000000001, 43.7, 34.10000000000004, -50.00000000000044, 30.29999999999999, 39.90000000000002, 36.70000000000003, 41.70000000000002, 33.30000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 18.29999999999982, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 31.300000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 46.3, 40.70000000000002, -50.00000000000044, -50.00000000000044, 47.9, 46.3, 40.30000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 45.3, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 44.7, 39.50000000000002, 29.299999999999976, -50.00000000000044, 45.1, 29.099999999999973, -50.00000000000044, 42.900000000000006], "episode_lengths": [118, 66, 60, 82, 144, 370, 500, 500, 224, 66, 500, 274, 500, 500, 500, 104, 500, 500, 94, 500, 500, 230, 138, 500, 500, 214, 76, 500, 500, 106, 500, 174, 500, 500, 500, 178, 54, 500, 48, 78, 64, 160, 500, 198, 102, 134, 84, 168, 90, 500, 500, 500, 476, 500, 500, 80, 48, 500, 126, 500, 500, 68, 318, 500, 500, 50, 500, 500, 188, 80, 500, 500, 500, 56, 62, 38, 94, 500, 500, 22, 38, 98, 48, 500, 500, 500, 148, 48, 500, 66, 54, 500, 54, 106, 208, 500, 50, 210, 500, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41900626539271996, "mean_inference_ms": 1.3362512603210188, "mean_action_processing_ms": 0.15695845229465316, "mean_env_wait_ms": 0.09247143473662751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03451871871948242, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.1761326789855957}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3871.9209761137045, "num_env_steps_trained_throughput_per_sec": 3871.9209761137045, "timesteps_total": 990000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 990000, "timers": {"training_iteration_time_ms": 3707.273, "sample_time_ms": 3401.261, "load_time_ms": 18.578, "load_throughput": 968886.436, "learn_time_ms": 211.058, "learn_throughput": 85284.615, "synch_weights_time_ms": 74.709}, "counters": {"num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "done": false, "episodes_total": 3742, "training_iteration": 55, "trial_id": "9f288_00006", "date": "2023-10-25_16-02-13", "timestamp": 1698246133, "time_this_iter_s": 4.654855251312256, "time_total_s": 186.71915578842163, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 186.71915578842163, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 85.10000000000001, "ram_util_percent": 28.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125784e-18, "cur_lr": 0.0003, "total_loss": 6.67483377456665, "policy_loss": -0.033117362298071384, "vf_loss": 6.708004315694173, "vf_explained_var": -5.414088567097982e-07, "kl": 6.357335169937528e-05, "entropy": 0.5284778426090876, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 666.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.402999999999812, "episode_len_mean": 271.56, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 31.300000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 46.3, 40.70000000000002, -50.00000000000044, -50.00000000000044, 47.9, 46.3, 40.30000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 45.3, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 44.7, 39.50000000000002, 29.299999999999976, -50.00000000000044, 45.1, 29.099999999999973, -50.00000000000044, 42.900000000000006, 40.70000000000002, 10.699999999999712, -50.00000000000044, -50.00000000000044, 28.699999999999967, 35.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, 44.900000000000006, 40.500000000000014, 41.90000000000001, 10.299999999999706, 10.299999999999706, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.500000000000014, 27.699999999999953, -50.00000000000044, 40.70000000000002, -50.00000000000044, 39.300000000000026, 40.30000000000002, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 36.10000000000004, 36.900000000000034, 44.300000000000004, 46.9, 37.70000000000003, 45.7, 40.30000000000002, 45.1, 22.699999999999882, 45.1, 38.50000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.5], "episode_lengths": [500, 500, 188, 80, 500, 500, 500, 56, 62, 38, 94, 500, 500, 22, 38, 98, 48, 500, 500, 500, 148, 48, 500, 66, 54, 500, 54, 106, 208, 500, 50, 210, 500, 72, 94, 394, 500, 500, 214, 144, 500, 56, 500, 52, 96, 82, 398, 398, 500, 500, 52, 76, 224, 500, 94, 500, 108, 98, 500, 214, 500, 500, 500, 68, 48, 100, 500, 500, 146, 500, 500, 238, 500, 140, 132, 58, 32, 124, 44, 98, 50, 274, 50, 116, 500, 80, 500, 500, 500, 500, 42, 98, 500, 500, 32, 500, 500, 500, 116, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42107713707266753, "mean_inference_ms": 1.344999263290437, "mean_action_processing_ms": 0.15799047117399423, "mean_env_wait_ms": 0.09297570680845263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044008493423461914, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.18703579902648926}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.402999999999812, "episode_len_mean": 271.56, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 31.300000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 46.3, 40.70000000000002, -50.00000000000044, -50.00000000000044, 47.9, 46.3, 40.30000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 45.3, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 44.7, 39.50000000000002, 29.299999999999976, -50.00000000000044, 45.1, 29.099999999999973, -50.00000000000044, 42.900000000000006, 40.70000000000002, 10.699999999999712, -50.00000000000044, -50.00000000000044, 28.699999999999967, 35.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, 44.900000000000006, 40.500000000000014, 41.90000000000001, 10.299999999999706, 10.299999999999706, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.500000000000014, 27.699999999999953, -50.00000000000044, 40.70000000000002, -50.00000000000044, 39.300000000000026, 40.30000000000002, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 36.10000000000004, 36.900000000000034, 44.300000000000004, 46.9, 37.70000000000003, 45.7, 40.30000000000002, 45.1, 22.699999999999882, 45.1, 38.50000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.5], "episode_lengths": [500, 500, 188, 80, 500, 500, 500, 56, 62, 38, 94, 500, 500, 22, 38, 98, 48, 500, 500, 500, 148, 48, 500, 66, 54, 500, 54, 106, 208, 500, 50, 210, 500, 72, 94, 394, 500, 500, 214, 144, 500, 56, 500, 52, 96, 82, 398, 398, 500, 500, 52, 76, 224, 500, 94, 500, 108, 98, 500, 214, 500, 500, 500, 68, 48, 100, 500, 500, 146, 500, 500, 238, 500, 140, 132, 58, 32, 124, 44, 98, 50, 274, 50, 116, 500, 80, 500, 500, 500, 500, 42, 98, 500, 500, 32, 500, 500, 500, 116, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42107713707266753, "mean_inference_ms": 1.344999263290437, "mean_action_processing_ms": 0.15799047117399423, "mean_env_wait_ms": 0.09297570680845263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044008493423461914, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.18703579902648926}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4020.923348888348, "num_env_steps_trained_throughput_per_sec": 4020.923348888348, "timesteps_total": 1008000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 3818.767, "sample_time_ms": 3522.089, "load_time_ms": 17.842, "load_throughput": 1008875.354, "learn_time_ms": 202.06, "learn_throughput": 89082.374, "synch_weights_time_ms": 75.007}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3808, "training_iteration": 56, "trial_id": "9f288_00006", "date": "2023-10-25_16-02-18", "timestamp": 1698246138, "time_this_iter_s": 4.484585762023926, "time_total_s": 191.20374155044556, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 191.20374155044556, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 82.87142857142855, "ram_util_percent": 28.61428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.775557561562892e-18, "cur_lr": 0.0003, "total_loss": 7.099191427230835, "policy_loss": -0.02403022558428347, "vf_loss": 7.123272736867269, "vf_explained_var": -1.3262033462524414e-06, "kl": 6.741553793136272e-05, "entropy": 0.5102639868855476, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 678.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.105999999999842, "episode_len_mean": 239.62, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 40.30000000000002, 45.1, 22.699999999999882, 45.1, 38.50000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.5, 46.099999999999994, 42.10000000000001, 45.3, -50.00000000000044, 46.3, 44.900000000000006, -50.00000000000044, 44.5, 34.50000000000004, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 34.10000000000004, 41.90000000000001, 22.899999999999885, 43.10000000000001, 41.90000000000001, -50.00000000000044, 45.1, 44.7, 33.500000000000036, 44.300000000000004, 44.5, 26.299999999999933, 10.299999999999706, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 24.69999999999991, 1.099999999999575, 35.500000000000036, -50.00000000000044, 46.099999999999994, 16.29999999999979, 44.10000000000001, 44.5, 44.900000000000006, 24.899999999999913, -50.00000000000044, 41.30000000000001, 10.099999999999703, 46.099999999999994, -50.00000000000044, 29.49999999999998, 39.300000000000026, 44.5, 46.5, 44.900000000000006, -50.00000000000044, 44.900000000000006, 39.300000000000026, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 45.5, 46.3, 44.7, 17.099999999999802, 30.099999999999987, 43.7, -50.00000000000044, 46.3, 43.7, -50.00000000000044, -50.00000000000044, 41.500000000000014, 34.900000000000034, -50.00000000000044, -50.00000000000044, 25.899999999999928, 41.90000000000001], "episode_lengths": [44, 98, 50, 274, 50, 116, 500, 80, 500, 500, 500, 500, 42, 98, 500, 500, 32, 500, 500, 500, 116, 36, 40, 80, 48, 500, 38, 52, 500, 56, 156, 40, 72, 500, 500, 82, 500, 500, 160, 82, 272, 70, 82, 500, 50, 54, 166, 58, 56, 238, 398, 500, 500, 500, 500, 242, 254, 490, 146, 500, 40, 338, 60, 56, 52, 252, 500, 88, 400, 40, 500, 206, 108, 56, 36, 52, 500, 52, 108, 76, 500, 500, 28, 46, 38, 54, 330, 200, 64, 500, 38, 64, 500, 500, 86, 152, 500, 500, 242, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42292513853028835, "mean_inference_ms": 1.3502838689215884, "mean_action_processing_ms": 0.15866347905858622, "mean_env_wait_ms": 0.09297729662995163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600025177001953, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.16402888298034668}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.105999999999842, "episode_len_mean": 239.62, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 40.30000000000002, 45.1, 22.699999999999882, 45.1, 38.50000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.5, 46.099999999999994, 42.10000000000001, 45.3, -50.00000000000044, 46.3, 44.900000000000006, -50.00000000000044, 44.5, 34.50000000000004, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 34.10000000000004, 41.90000000000001, 22.899999999999885, 43.10000000000001, 41.90000000000001, -50.00000000000044, 45.1, 44.7, 33.500000000000036, 44.300000000000004, 44.5, 26.299999999999933, 10.299999999999706, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 24.69999999999991, 1.099999999999575, 35.500000000000036, -50.00000000000044, 46.099999999999994, 16.29999999999979, 44.10000000000001, 44.5, 44.900000000000006, 24.899999999999913, -50.00000000000044, 41.30000000000001, 10.099999999999703, 46.099999999999994, -50.00000000000044, 29.49999999999998, 39.300000000000026, 44.5, 46.5, 44.900000000000006, -50.00000000000044, 44.900000000000006, 39.300000000000026, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 45.5, 46.3, 44.7, 17.099999999999802, 30.099999999999987, 43.7, -50.00000000000044, 46.3, 43.7, -50.00000000000044, -50.00000000000044, 41.500000000000014, 34.900000000000034, -50.00000000000044, -50.00000000000044, 25.899999999999928, 41.90000000000001], "episode_lengths": [44, 98, 50, 274, 50, 116, 500, 80, 500, 500, 500, 500, 42, 98, 500, 500, 32, 500, 500, 500, 116, 36, 40, 80, 48, 500, 38, 52, 500, 56, 156, 40, 72, 500, 500, 82, 500, 500, 160, 82, 272, 70, 82, 500, 50, 54, 166, 58, 56, 238, 398, 500, 500, 500, 500, 242, 254, 490, 146, 500, 40, 338, 60, 56, 52, 252, 500, 88, 400, 40, 500, 206, 108, 56, 36, 52, 500, 52, 108, 76, 500, 500, 28, 46, 38, 54, 330, 200, 64, 500, 38, 64, 500, 500, 86, 152, 500, 500, 242, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42292513853028835, "mean_inference_ms": 1.3502838689215884, "mean_action_processing_ms": 0.15866347905858622, "mean_env_wait_ms": 0.09297729662995163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600025177001953, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.16402888298034668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4855.905161704162, "num_env_steps_trained_throughput_per_sec": 4855.905161704162, "timesteps_total": 1026000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1026000, "timers": {"training_iteration_time_ms": 3800.767, "sample_time_ms": 3506.275, "load_time_ms": 17.464, "load_throughput": 1030714.575, "learn_time_ms": 200.073, "learn_throughput": 89967.235, "synch_weights_time_ms": 75.086}, "counters": {"num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "done": false, "episodes_total": 3886, "training_iteration": 57, "trial_id": "9f288_00006", "date": "2023-10-25_16-02-21", "timestamp": 1698246141, "time_this_iter_s": 3.711827278137207, "time_total_s": 194.91556882858276, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 194.91556882858276, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 84.18, "ram_util_percent": 28.580000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.387778780781446e-18, "cur_lr": 0.0003, "total_loss": 6.816725770632426, "policy_loss": -0.01869192284842332, "vf_loss": 6.835470636685689, "vf_explained_var": -1.1622905731201172e-06, "kl": 0.000369980785682363, "entropy": 0.5315707524617513, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 690.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.149999999999864, "episode_len_mean": 229.22, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.300000000000026, 44.5, 46.5, 44.900000000000006, -50.00000000000044, 44.900000000000006, 39.300000000000026, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 45.5, 46.3, 44.7, 17.099999999999802, 30.099999999999987, 43.7, -50.00000000000044, 46.3, 43.7, -50.00000000000044, -50.00000000000044, 41.500000000000014, 34.900000000000034, -50.00000000000044, -50.00000000000044, 25.899999999999928, 41.90000000000001, 41.90000000000001, 40.30000000000002, 36.30000000000003, -50.00000000000044, 45.9, 42.900000000000006, 40.500000000000014, 33.90000000000004, 45.3, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.500000000000014, 38.300000000000026, -50.00000000000044, 40.70000000000002, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.10000000000002, 44.10000000000001, 36.10000000000004, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 6.299999999999649, 41.30000000000001, 42.70000000000001, 41.90000000000001, 34.30000000000004, 46.099999999999994, 40.10000000000002, 42.900000000000006, 46.9, 11.29999999999972, 24.899999999999913, 46.699999999999996, 35.500000000000036, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.7, 20.699999999999854, 40.70000000000002, 45.7, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 47.1, 26.499999999999936, 26.89999999999994, 29.899999999999984, 26.299999999999933, 24.899999999999913, 46.699999999999996, 43.10000000000001, 27.49999999999995, 43.900000000000006, -50.00000000000044, 0.49999999999956657], "episode_lengths": [108, 56, 36, 52, 500, 52, 108, 76, 500, 500, 28, 46, 38, 54, 330, 200, 64, 500, 38, 64, 500, 500, 86, 152, 500, 500, 242, 82, 82, 98, 138, 500, 42, 72, 96, 162, 48, 136, 500, 500, 500, 116, 500, 84, 500, 86, 118, 500, 94, 216, 500, 500, 500, 58, 100, 60, 140, 52, 500, 38, 500, 500, 438, 88, 74, 82, 158, 40, 100, 72, 32, 388, 252, 34, 146, 80, 500, 500, 24, 294, 94, 44, 500, 348, 500, 500, 500, 108, 30, 236, 232, 202, 238, 252, 34, 70, 226, 62, 500, 496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42353477343349, "mean_inference_ms": 1.3519009980171228, "mean_action_processing_ms": 0.15898096096472483, "mean_env_wait_ms": 0.0933815231191627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0319979190826416, "StateBufferConnector_ms": 0.009003877639770508, "ViewRequirementAgentConnector_ms": 0.16002154350280762}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.149999999999864, "episode_len_mean": 229.22, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.300000000000026, 44.5, 46.5, 44.900000000000006, -50.00000000000044, 44.900000000000006, 39.300000000000026, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 45.5, 46.3, 44.7, 17.099999999999802, 30.099999999999987, 43.7, -50.00000000000044, 46.3, 43.7, -50.00000000000044, -50.00000000000044, 41.500000000000014, 34.900000000000034, -50.00000000000044, -50.00000000000044, 25.899999999999928, 41.90000000000001, 41.90000000000001, 40.30000000000002, 36.30000000000003, -50.00000000000044, 45.9, 42.900000000000006, 40.500000000000014, 33.90000000000004, 45.3, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.500000000000014, 38.300000000000026, -50.00000000000044, 40.70000000000002, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.10000000000002, 44.10000000000001, 36.10000000000004, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 6.299999999999649, 41.30000000000001, 42.70000000000001, 41.90000000000001, 34.30000000000004, 46.099999999999994, 40.10000000000002, 42.900000000000006, 46.9, 11.29999999999972, 24.899999999999913, 46.699999999999996, 35.500000000000036, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.7, 20.699999999999854, 40.70000000000002, 45.7, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 47.1, 26.499999999999936, 26.89999999999994, 29.899999999999984, 26.299999999999933, 24.899999999999913, 46.699999999999996, 43.10000000000001, 27.49999999999995, 43.900000000000006, -50.00000000000044, 0.49999999999956657], "episode_lengths": [108, 56, 36, 52, 500, 52, 108, 76, 500, 500, 28, 46, 38, 54, 330, 200, 64, 500, 38, 64, 500, 500, 86, 152, 500, 500, 242, 82, 82, 98, 138, 500, 42, 72, 96, 162, 48, 136, 500, 500, 500, 116, 500, 84, 500, 86, 118, 500, 94, 216, 500, 500, 500, 58, 100, 60, 140, 52, 500, 38, 500, 500, 438, 88, 74, 82, 158, 40, 100, 72, 32, 388, 252, 34, 146, 80, 500, 500, 24, 294, 94, 44, 500, 348, 500, 500, 500, 108, 30, 236, 232, 202, 238, 252, 34, 70, 226, 62, 500, 496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42353477343349, "mean_inference_ms": 1.3519009980171228, "mean_action_processing_ms": 0.15898096096472483, "mean_env_wait_ms": 0.0933815231191627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0319979190826416, "StateBufferConnector_ms": 0.009003877639770508, "ViewRequirementAgentConnector_ms": 0.16002154350280762}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4852.867819523837, "num_env_steps_trained_throughput_per_sec": 4852.867819523837, "timesteps_total": 1044000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 3807.364, "sample_time_ms": 3521.447, "load_time_ms": 17.202, "load_throughput": 1046364.103, "learn_time_ms": 191.732, "learn_throughput": 93881.228, "synch_weights_time_ms": 75.039}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 3958, "training_iteration": 58, "trial_id": "9f288_00006", "date": "2023-10-25_16-02-25", "timestamp": 1698246145, "time_this_iter_s": 3.714146614074707, "time_total_s": 198.62971544265747, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 198.62971544265747, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 77.06, "ram_util_percent": 28.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.93889390390723e-19, "cur_lr": 0.0003, "total_loss": 6.70348338286082, "policy_loss": -0.03400662851830324, "vf_loss": 6.737542827924092, "vf_explained_var": -9.288390477498373e-07, "kl": 0.00015776230376710979, "entropy": 0.5266171991825104, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 702.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.791999999999834, "episode_len_mean": 252.74, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.500000000000036, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.7, 20.699999999999854, 40.70000000000002, 45.7, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 47.1, 26.499999999999936, 26.89999999999994, 29.899999999999984, 26.299999999999933, 24.899999999999913, 46.699999999999996, 43.10000000000001, 27.49999999999995, 43.900000000000006, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 40.70000000000002, 39.10000000000002, 42.10000000000001, 42.30000000000001, 32.100000000000016, -50.00000000000044, 41.90000000000001, -50.00000000000044, 38.10000000000002, 45.3, 45.9, 45.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 40.10000000000002, 0.2999999999995637, 36.900000000000034, 28.09999999999996, 43.50000000000001, -50.00000000000044, 45.5, 47.1, 45.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, 45.9, -50.00000000000044, 46.699999999999996, 34.900000000000034, 39.50000000000002, -50.00000000000044, 41.70000000000002, 40.30000000000002, 46.3, 45.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 28.89999999999997, 41.100000000000016, -50.00000000000044, 32.50000000000002, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, 40.10000000000002, 46.5, -50.00000000000044, 44.300000000000004, 41.500000000000014, 26.89999999999994, 13.499999999999751, 45.3, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 21.499999999999865], "episode_lengths": [146, 80, 500, 500, 24, 294, 94, 44, 500, 348, 500, 500, 500, 108, 30, 236, 232, 202, 238, 252, 34, 70, 226, 62, 500, 496, 500, 94, 110, 80, 78, 180, 500, 82, 500, 120, 48, 42, 48, 500, 500, 38, 500, 56, 500, 500, 100, 498, 132, 220, 66, 500, 46, 30, 46, 500, 42, 500, 500, 134, 42, 500, 34, 152, 106, 500, 84, 98, 38, 46, 62, 500, 500, 56, 212, 90, 500, 176, 208, 500, 500, 500, 500, 500, 54, 38, 500, 100, 36, 500, 58, 86, 232, 366, 48, 500, 60, 500, 500, 286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42418796156370925, "mean_inference_ms": 1.3529651558839735, "mean_action_processing_ms": 0.15928650291448165, "mean_env_wait_ms": 0.09380570311064662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027992963790893555, "StateBufferConnector_ms": 0.010996818542480469, "ViewRequirementAgentConnector_ms": 0.14669489860534668}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.791999999999834, "episode_len_mean": 252.74, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.500000000000036, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.7, 20.699999999999854, 40.70000000000002, 45.7, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 47.1, 26.499999999999936, 26.89999999999994, 29.899999999999984, 26.299999999999933, 24.899999999999913, 46.699999999999996, 43.10000000000001, 27.49999999999995, 43.900000000000006, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 40.70000000000002, 39.10000000000002, 42.10000000000001, 42.30000000000001, 32.100000000000016, -50.00000000000044, 41.90000000000001, -50.00000000000044, 38.10000000000002, 45.3, 45.9, 45.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 40.10000000000002, 0.2999999999995637, 36.900000000000034, 28.09999999999996, 43.50000000000001, -50.00000000000044, 45.5, 47.1, 45.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, 45.9, -50.00000000000044, 46.699999999999996, 34.900000000000034, 39.50000000000002, -50.00000000000044, 41.70000000000002, 40.30000000000002, 46.3, 45.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 28.89999999999997, 41.100000000000016, -50.00000000000044, 32.50000000000002, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, 40.10000000000002, 46.5, -50.00000000000044, 44.300000000000004, 41.500000000000014, 26.89999999999994, 13.499999999999751, 45.3, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 21.499999999999865], "episode_lengths": [146, 80, 500, 500, 24, 294, 94, 44, 500, 348, 500, 500, 500, 108, 30, 236, 232, 202, 238, 252, 34, 70, 226, 62, 500, 496, 500, 94, 110, 80, 78, 180, 500, 82, 500, 120, 48, 42, 48, 500, 500, 38, 500, 56, 500, 500, 100, 498, 132, 220, 66, 500, 46, 30, 46, 500, 42, 500, 500, 134, 42, 500, 34, 152, 106, 500, 84, 98, 38, 46, 62, 500, 500, 56, 212, 90, 500, 176, 208, 500, 500, 500, 500, 500, 54, 38, 500, 100, 36, 500, 58, 86, 232, 366, 48, 500, 60, 500, 500, 286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42418796156370925, "mean_inference_ms": 1.3529651558839735, "mean_action_processing_ms": 0.15928650291448165, "mean_env_wait_ms": 0.09380570311064662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027992963790893555, "StateBufferConnector_ms": 0.010996818542480469, "ViewRequirementAgentConnector_ms": 0.14669489860534668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4743.902796878822, "num_env_steps_trained_throughput_per_sec": 4743.902796878822, "timesteps_total": 1062000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1062000, "timers": {"training_iteration_time_ms": 3839.462, "sample_time_ms": 3546.343, "load_time_ms": 19.947, "load_throughput": 902397.613, "learn_time_ms": 195.538, "learn_throughput": 92053.743, "synch_weights_time_ms": 75.49}, "counters": {"num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "done": false, "episodes_total": 4032, "training_iteration": 59, "trial_id": "9f288_00006", "date": "2023-10-25_16-02-29", "timestamp": 1698246149, "time_this_iter_s": 3.8014678955078125, "time_total_s": 202.43118333816528, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 202.43118333816528, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 76.96000000000001, "ram_util_percent": 28.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953615e-19, "cur_lr": 0.0003, "total_loss": 6.80651052792867, "policy_loss": -0.006530474871397018, "vf_loss": 6.813094735145569, "vf_explained_var": -2.076228459676107e-06, "kl": 0.00028998502411707133, "entropy": 0.5378308718403181, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 714.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.710999999999814, "episode_len_mean": 268.5, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 45.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 28.89999999999997, 41.100000000000016, -50.00000000000044, 32.50000000000002, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, 40.10000000000002, 46.5, -50.00000000000044, 44.300000000000004, 41.500000000000014, 26.89999999999994, 13.499999999999751, 45.3, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, 8.699999999999683, 44.7, -50.00000000000044, 33.70000000000004, 39.50000000000002, 45.3, 46.3, 40.90000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.7, 38.300000000000026, 36.70000000000003, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 32.700000000000024, 38.90000000000002, 47.1, 29.899999999999984, 0.09999999999956088, 44.7, 45.7, 36.30000000000003, 41.30000000000001, 39.90000000000002, 45.5, 37.50000000000003, 14.299999999999763, -50.00000000000044, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 41.90000000000001, 39.10000000000002, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996], "episode_lengths": [38, 46, 62, 500, 500, 56, 212, 90, 500, 176, 208, 500, 500, 500, 500, 500, 54, 38, 500, 100, 36, 500, 58, 86, 232, 366, 48, 500, 60, 500, 500, 286, 500, 500, 62, 500, 56, 500, 414, 54, 500, 164, 106, 48, 38, 92, 500, 500, 100, 500, 54, 118, 134, 500, 116, 500, 500, 414, 500, 174, 112, 30, 202, 500, 54, 44, 138, 88, 102, 46, 126, 358, 500, 60, 32, 500, 500, 500, 82, 500, 226, 500, 500, 48, 38, 140, 500, 500, 500, 138, 500, 82, 110, 80, 500, 46, 500, 500, 38, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4250068586289092, "mean_inference_ms": 1.356109031028119, "mean_action_processing_ms": 0.15946237339356673, "mean_env_wait_ms": 0.09411887311729777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025994062423706055, "StateBufferConnector_ms": 0.011989355087280273, "ViewRequirementAgentConnector_ms": 0.16454863548278809}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.710999999999814, "episode_len_mean": 268.5, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 45.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 28.89999999999997, 41.100000000000016, -50.00000000000044, 32.50000000000002, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, 40.10000000000002, 46.5, -50.00000000000044, 44.300000000000004, 41.500000000000014, 26.89999999999994, 13.499999999999751, 45.3, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, 8.699999999999683, 44.7, -50.00000000000044, 33.70000000000004, 39.50000000000002, 45.3, 46.3, 40.90000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.7, 38.300000000000026, 36.70000000000003, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 32.700000000000024, 38.90000000000002, 47.1, 29.899999999999984, 0.09999999999956088, 44.7, 45.7, 36.30000000000003, 41.30000000000001, 39.90000000000002, 45.5, 37.50000000000003, 14.299999999999763, -50.00000000000044, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 41.90000000000001, 39.10000000000002, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996], "episode_lengths": [38, 46, 62, 500, 500, 56, 212, 90, 500, 176, 208, 500, 500, 500, 500, 500, 54, 38, 500, 100, 36, 500, 58, 86, 232, 366, 48, 500, 60, 500, 500, 286, 500, 500, 62, 500, 56, 500, 414, 54, 500, 164, 106, 48, 38, 92, 500, 500, 100, 500, 54, 118, 134, 500, 116, 500, 500, 414, 500, 174, 112, 30, 202, 500, 54, 44, 138, 88, 102, 46, 126, 358, 500, 60, 32, 500, 500, 500, 82, 500, 226, 500, 500, 48, 38, 140, 500, 500, 500, 138, 500, 82, 110, 80, 500, 46, 500, 500, 38, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4250068586289092, "mean_inference_ms": 1.356109031028119, "mean_action_processing_ms": 0.15946237339356673, "mean_env_wait_ms": 0.09411887311729777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025994062423706055, "StateBufferConnector_ms": 0.011989355087280273, "ViewRequirementAgentConnector_ms": 0.16454863548278809}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4353.426578588035, "num_env_steps_trained_throughput_per_sec": 4353.426578588035, "timesteps_total": 1080000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 3927.189, "sample_time_ms": 3625.748, "load_time_ms": 19.828, "load_throughput": 907801.244, "learn_time_ms": 203.717, "learn_throughput": 88357.944, "synch_weights_time_ms": 75.851}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4100, "training_iteration": 60, "trial_id": "9f288_00006", "date": "2023-10-25_16-02-33", "timestamp": 1698246153, "time_this_iter_s": 4.139672517776489, "time_total_s": 206.57085585594177, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 206.57085585594177, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 88.06666666666666, "ram_util_percent": 28.650000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 0.0003, "total_loss": 6.515282432238261, "policy_loss": 0.08414655834591638, "vf_loss": 6.431187152862549, "vf_explained_var": -1.8974145253499348e-06, "kl": 0.0002693716978683369, "entropy": 0.5131248310208321, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 726.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.560999999999818, "episode_len_mean": 270.0, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, 45.5, 37.50000000000003, 14.299999999999763, -50.00000000000044, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 41.90000000000001, 39.10000000000002, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 25.499999999999922, 45.5, 47.1, 37.90000000000003, 44.7, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.900000000000006, 32.100000000000016, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 29.299999999999976, 40.90000000000002, -50.00000000000044, 18.499999999999822, 38.10000000000002, 37.300000000000026, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 34.70000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.5, 18.499999999999822, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, 10.299999999999706, 43.30000000000001, 41.30000000000001, -50.00000000000044, 40.500000000000014, 25.699999999999925, -50.00000000000044, -50.00000000000044, 45.5, 43.900000000000006, 6.299999999999649, 34.30000000000004, 42.500000000000014, 40.10000000000002, 29.69999999999998, 15.699999999999783, 41.70000000000002, 38.90000000000002], "episode_lengths": [102, 46, 126, 358, 500, 60, 32, 500, 500, 500, 82, 500, 226, 500, 500, 48, 38, 140, 500, 500, 500, 138, 500, 82, 110, 80, 500, 46, 500, 500, 38, 34, 500, 78, 500, 500, 246, 46, 30, 122, 54, 500, 500, 110, 72, 180, 500, 500, 54, 500, 500, 114, 60, 500, 500, 110, 208, 92, 500, 316, 120, 128, 62, 500, 500, 64, 48, 500, 154, 86, 500, 500, 46, 316, 162, 500, 500, 500, 500, 44, 500, 74, 398, 68, 88, 500, 96, 244, 500, 500, 46, 62, 438, 158, 76, 100, 204, 344, 84, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4264579556395309, "mean_inference_ms": 1.3626014453498203, "mean_action_processing_ms": 0.15983548616563614, "mean_env_wait_ms": 0.09430164570436336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032006263732910156, "StateBufferConnector_ms": 0.01399993896484375, "ViewRequirementAgentConnector_ms": 0.17304229736328125}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.560999999999818, "episode_len_mean": 270.0, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, 45.5, 37.50000000000003, 14.299999999999763, -50.00000000000044, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 41.90000000000001, 39.10000000000002, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 25.499999999999922, 45.5, 47.1, 37.90000000000003, 44.7, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.900000000000006, 32.100000000000016, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 29.299999999999976, 40.90000000000002, -50.00000000000044, 18.499999999999822, 38.10000000000002, 37.300000000000026, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 34.70000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.5, 18.499999999999822, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, 10.299999999999706, 43.30000000000001, 41.30000000000001, -50.00000000000044, 40.500000000000014, 25.699999999999925, -50.00000000000044, -50.00000000000044, 45.5, 43.900000000000006, 6.299999999999649, 34.30000000000004, 42.500000000000014, 40.10000000000002, 29.69999999999998, 15.699999999999783, 41.70000000000002, 38.90000000000002], "episode_lengths": [102, 46, 126, 358, 500, 60, 32, 500, 500, 500, 82, 500, 226, 500, 500, 48, 38, 140, 500, 500, 500, 138, 500, 82, 110, 80, 500, 46, 500, 500, 38, 34, 500, 78, 500, 500, 246, 46, 30, 122, 54, 500, 500, 110, 72, 180, 500, 500, 54, 500, 500, 114, 60, 500, 500, 110, 208, 92, 500, 316, 120, 128, 62, 500, 500, 64, 48, 500, 154, 86, 500, 500, 46, 316, 162, 500, 500, 500, 500, 44, 500, 74, 398, 68, 88, 500, 96, 244, 500, 500, 46, 62, 438, 158, 76, 100, 204, 344, 84, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4264579556395309, "mean_inference_ms": 1.3626014453498203, "mean_action_processing_ms": 0.15983548616563614, "mean_env_wait_ms": 0.09430164570436336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032006263732910156, "StateBufferConnector_ms": 0.01399993896484375, "ViewRequirementAgentConnector_ms": 0.17304229736328125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4315.08663097961, "num_env_steps_trained_throughput_per_sec": 4315.08663097961, "timesteps_total": 1098000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1098000, "timers": {"training_iteration_time_ms": 3983.609, "sample_time_ms": 3670.309, "load_time_ms": 20.371, "load_throughput": 883627.324, "learn_time_ms": 215.034, "learn_throughput": 83707.606, "synch_weights_time_ms": 76.05}, "counters": {"num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "done": false, "episodes_total": 4168, "training_iteration": 61, "trial_id": "9f288_00006", "date": "2023-10-25_16-02-37", "timestamp": 1698246157, "time_this_iter_s": 4.177712440490723, "time_total_s": 210.7485682964325, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 210.7485682964325, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 84.55, "ram_util_percent": 28.916666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884037e-20, "cur_lr": 0.0003, "total_loss": 6.871718366940816, "policy_loss": -0.03153991016248862, "vf_loss": 6.903307755788167, "vf_explained_var": -7.649262746175131e-07, "kl": 0.0001627347835864157, "entropy": 0.4967488721013069, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 738.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.156999999999822, "episode_len_mean": 264.08, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.5, 18.499999999999822, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, 10.299999999999706, 43.30000000000001, 41.30000000000001, -50.00000000000044, 40.500000000000014, 25.699999999999925, -50.00000000000044, -50.00000000000044, 45.5, 43.900000000000006, 6.299999999999649, 34.30000000000004, 42.500000000000014, 40.10000000000002, 29.69999999999998, 15.699999999999783, 41.70000000000002, 38.90000000000002, 43.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.5, 45.9, 41.500000000000014, 38.700000000000024, 41.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 18.899999999999828, 43.10000000000001, -50.00000000000044, 40.30000000000002, 15.49999999999978, 45.7, -50.00000000000044, -50.00000000000044, 27.099999999999945, 42.500000000000014, -50.00000000000044, 40.90000000000002, 46.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, 23.29999999999989, 47.1, 32.100000000000016, 42.70000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, 14.09999999999976, 46.5, 29.49999999999998, -50.00000000000044, 23.099999999999888, 6.299999999999649, 46.099999999999994, 43.900000000000006, 5.099999999999632, 33.10000000000003, 45.9, -50.00000000000044, 43.50000000000001, 28.09999999999996, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.5, -50.00000000000044, 46.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 36.70000000000003], "episode_lengths": [500, 500, 46, 316, 162, 500, 500, 500, 500, 44, 500, 74, 398, 68, 88, 500, 96, 244, 500, 500, 46, 62, 438, 158, 76, 100, 204, 344, 84, 112, 62, 88, 500, 500, 500, 68, 56, 42, 86, 114, 88, 54, 500, 500, 40, 500, 80, 500, 500, 312, 70, 500, 98, 346, 44, 500, 500, 230, 76, 500, 92, 36, 34, 500, 500, 268, 30, 180, 74, 500, 28, 500, 500, 42, 360, 36, 206, 500, 270, 438, 40, 62, 450, 170, 42, 500, 66, 220, 500, 500, 120, 56, 500, 38, 102, 500, 500, 200, 500, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4270566742988776, "mean_inference_ms": 1.3661038061393491, "mean_action_processing_ms": 0.1601571657572346, "mean_env_wait_ms": 0.09448006830637791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998136520385742, "StateBufferConnector_ms": 0.010998964309692383, "ViewRequirementAgentConnector_ms": 0.1500105857849121}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.156999999999822, "episode_len_mean": 264.08, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.5, 18.499999999999822, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, 10.299999999999706, 43.30000000000001, 41.30000000000001, -50.00000000000044, 40.500000000000014, 25.699999999999925, -50.00000000000044, -50.00000000000044, 45.5, 43.900000000000006, 6.299999999999649, 34.30000000000004, 42.500000000000014, 40.10000000000002, 29.69999999999998, 15.699999999999783, 41.70000000000002, 38.90000000000002, 43.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.5, 45.9, 41.500000000000014, 38.700000000000024, 41.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 18.899999999999828, 43.10000000000001, -50.00000000000044, 40.30000000000002, 15.49999999999978, 45.7, -50.00000000000044, -50.00000000000044, 27.099999999999945, 42.500000000000014, -50.00000000000044, 40.90000000000002, 46.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, 23.29999999999989, 47.1, 32.100000000000016, 42.70000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, 14.09999999999976, 46.5, 29.49999999999998, -50.00000000000044, 23.099999999999888, 6.299999999999649, 46.099999999999994, 43.900000000000006, 5.099999999999632, 33.10000000000003, 45.9, -50.00000000000044, 43.50000000000001, 28.09999999999996, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.5, -50.00000000000044, 46.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 36.70000000000003], "episode_lengths": [500, 500, 46, 316, 162, 500, 500, 500, 500, 44, 500, 74, 398, 68, 88, 500, 96, 244, 500, 500, 46, 62, 438, 158, 76, 100, 204, 344, 84, 112, 62, 88, 500, 500, 500, 68, 56, 42, 86, 114, 88, 54, 500, 500, 40, 500, 80, 500, 500, 312, 70, 500, 98, 346, 44, 500, 500, 230, 76, 500, 92, 36, 34, 500, 500, 268, 30, 180, 74, 500, 28, 500, 500, 42, 360, 36, 206, 500, 270, 438, 40, 62, 450, 170, 42, 500, 66, 220, 500, 500, 120, 56, 500, 38, 102, 500, 500, 200, 500, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4270566742988776, "mean_inference_ms": 1.3661038061393491, "mean_action_processing_ms": 0.1601571657572346, "mean_env_wait_ms": 0.09448006830637791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998136520385742, "StateBufferConnector_ms": 0.010998964309692383, "ViewRequirementAgentConnector_ms": 0.1500105857849121}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4823.896145386236, "num_env_steps_trained_throughput_per_sec": 4823.896145386236, "timesteps_total": 1116000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 4005.689, "sample_time_ms": 3679.068, "load_time_ms": 20.889, "load_throughput": 861711.473, "learn_time_ms": 227.718, "learn_throughput": 79044.979, "synch_weights_time_ms": 76.269}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4238, "training_iteration": 62, "trial_id": "9f288_00006", "date": "2023-10-25_16-02-41", "timestamp": 1698246161, "time_this_iter_s": 3.737421751022339, "time_total_s": 214.48599004745483, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 214.48599004745483, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 79.94000000000001, "ram_util_percent": 29.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.3368086899420186e-20, "cur_lr": 0.0003, "total_loss": 6.051544785499573, "policy_loss": 0.03429984115064144, "vf_loss": 6.0172916650772095, "vf_explained_var": -2.1557013193766275e-06, "kl": 0.00017811441279036444, "entropy": 0.4678007438778877, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 750.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.935999999999815, "episode_len_mean": 261.26, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.29999999999989, 47.1, 32.100000000000016, 42.70000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, 14.09999999999976, 46.5, 29.49999999999998, -50.00000000000044, 23.099999999999888, 6.299999999999649, 46.099999999999994, 43.900000000000006, 5.099999999999632, 33.10000000000003, 45.9, -50.00000000000044, 43.50000000000001, 28.09999999999996, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.5, -50.00000000000044, 46.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 36.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.10000000000001, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.69999999999991, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 45.9, 21.299999999999862, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.30000000000003, 45.7, -50.00000000000044, 47.7, 45.7, 38.90000000000002, -50.00000000000044, 37.50000000000003, 45.3, -50.00000000000044, 47.3, -50.00000000000044, 46.3, 34.900000000000034, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.5, 45.7, 46.3, -50.00000000000044, 43.10000000000001, 44.900000000000006, 45.1, 45.9, -50.00000000000044, 44.5], "episode_lengths": [268, 30, 180, 74, 500, 28, 500, 500, 42, 360, 36, 206, 500, 270, 438, 40, 62, 450, 170, 42, 500, 66, 220, 500, 500, 120, 56, 500, 38, 102, 500, 500, 200, 500, 134, 500, 56, 500, 500, 132, 60, 500, 54, 40, 500, 44, 500, 500, 500, 254, 500, 36, 30, 500, 494, 500, 40, 500, 500, 500, 306, 42, 288, 500, 500, 82, 62, 108, 500, 500, 52, 138, 44, 500, 24, 44, 112, 500, 126, 48, 500, 28, 500, 38, 152, 78, 500, 500, 94, 500, 36, 44, 38, 500, 70, 52, 50, 42, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42846569157296843, "mean_inference_ms": 1.3709672420325587, "mean_action_processing_ms": 0.16074768641847187, "mean_env_wait_ms": 0.09481772286917478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03898811340332031, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.18036770820617676}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.935999999999815, "episode_len_mean": 261.26, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.29999999999989, 47.1, 32.100000000000016, 42.70000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, 14.09999999999976, 46.5, 29.49999999999998, -50.00000000000044, 23.099999999999888, 6.299999999999649, 46.099999999999994, 43.900000000000006, 5.099999999999632, 33.10000000000003, 45.9, -50.00000000000044, 43.50000000000001, 28.09999999999996, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.5, -50.00000000000044, 46.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 36.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.10000000000001, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.69999999999991, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 45.9, 21.299999999999862, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.30000000000003, 45.7, -50.00000000000044, 47.7, 45.7, 38.90000000000002, -50.00000000000044, 37.50000000000003, 45.3, -50.00000000000044, 47.3, -50.00000000000044, 46.3, 34.900000000000034, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.5, 45.7, 46.3, -50.00000000000044, 43.10000000000001, 44.900000000000006, 45.1, 45.9, -50.00000000000044, 44.5], "episode_lengths": [268, 30, 180, 74, 500, 28, 500, 500, 42, 360, 36, 206, 500, 270, 438, 40, 62, 450, 170, 42, 500, 66, 220, 500, 500, 120, 56, 500, 38, 102, 500, 500, 200, 500, 134, 500, 56, 500, 500, 132, 60, 500, 54, 40, 500, 44, 500, 500, 500, 254, 500, 36, 30, 500, 494, 500, 40, 500, 500, 500, 306, 42, 288, 500, 500, 82, 62, 108, 500, 500, 52, 138, 44, 500, 24, 44, 112, 500, 126, 48, 500, 28, 500, 38, 152, 78, 500, 500, 94, 500, 36, 44, 38, 500, 70, 52, 50, 42, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42846569157296843, "mean_inference_ms": 1.3709672420325587, "mean_action_processing_ms": 0.16074768641847187, "mean_env_wait_ms": 0.09481772286917478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03898811340332031, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.18036770820617676}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4058.931203005882, "num_env_steps_trained_throughput_per_sec": 4058.931203005882, "timesteps_total": 1134000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1134000, "timers": {"training_iteration_time_ms": 4085.577, "sample_time_ms": 3791.275, "load_time_ms": 21.436, "load_throughput": 839691.161, "learn_time_ms": 225.357, "learn_throughput": 79873.324, "synch_weights_time_ms": 45.806}, "counters": {"num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "done": false, "episodes_total": 4303, "training_iteration": 63, "trial_id": "9f288_00006", "date": "2023-10-25_16-02-46", "timestamp": 1698246166, "time_this_iter_s": 4.441655158996582, "time_total_s": 218.92764520645142, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 218.92764520645142, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 84.37142857142855, "ram_util_percent": 29.542857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 0.0003, "total_loss": 6.403254310290019, "policy_loss": -0.029936081749231864, "vf_loss": 6.433235247929891, "vf_explained_var": -1.0182460149129231e-06, "kl": 0.00019023235533192442, "entropy": 0.45043982068697613, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 762.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4209999999998115, "episode_len_mean": 261.38, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.90000000000001, 43.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.30000000000003, 45.7, -50.00000000000044, 47.7, 45.7, 38.90000000000002, -50.00000000000044, 37.50000000000003, 45.3, -50.00000000000044, 47.3, -50.00000000000044, 46.3, 34.900000000000034, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.5, 45.7, 46.3, -50.00000000000044, 43.10000000000001, 44.900000000000006, 45.1, 45.9, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.30000000000002, 37.90000000000003, 45.1, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 34.50000000000004, 37.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, 18.899999999999828, 5.6999999999996405, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, 41.30000000000001, -50.00000000000044, 45.3, 10.699999999999712, 46.3, 39.90000000000002, 30.9, 40.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.7, 22.299999999999876, 45.3, 44.300000000000004, 25.899999999999928, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044], "episode_lengths": [500, 500, 82, 62, 108, 500, 500, 52, 138, 44, 500, 24, 44, 112, 500, 126, 48, 500, 28, 500, 38, 152, 78, 500, 500, 94, 500, 36, 44, 38, 500, 70, 52, 50, 42, 500, 56, 500, 500, 52, 98, 122, 50, 46, 44, 500, 500, 500, 36, 156, 124, 50, 500, 500, 500, 500, 22, 500, 500, 312, 444, 98, 500, 500, 34, 500, 500, 56, 88, 500, 48, 394, 38, 102, 192, 96, 60, 500, 500, 50, 500, 54, 278, 48, 58, 242, 500, 42, 500, 500, 198, 500, 168, 500, 500, 36, 500, 500, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4311328394673339, "mean_inference_ms": 1.3796444699398729, "mean_action_processing_ms": 0.16183951267731267, "mean_env_wait_ms": 0.09543863974729469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04540705680847168, "StateBufferConnector_ms": 0.009963035583496094, "ViewRequirementAgentConnector_ms": 0.20130133628845215}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4209999999998115, "episode_len_mean": 261.38, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.90000000000001, 43.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.30000000000003, 45.7, -50.00000000000044, 47.7, 45.7, 38.90000000000002, -50.00000000000044, 37.50000000000003, 45.3, -50.00000000000044, 47.3, -50.00000000000044, 46.3, 34.900000000000034, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.5, 45.7, 46.3, -50.00000000000044, 43.10000000000001, 44.900000000000006, 45.1, 45.9, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.30000000000002, 37.90000000000003, 45.1, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 34.50000000000004, 37.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, 18.899999999999828, 5.6999999999996405, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, 41.30000000000001, -50.00000000000044, 45.3, 10.699999999999712, 46.3, 39.90000000000002, 30.9, 40.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.7, 22.299999999999876, 45.3, 44.300000000000004, 25.899999999999928, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044], "episode_lengths": [500, 500, 82, 62, 108, 500, 500, 52, 138, 44, 500, 24, 44, 112, 500, 126, 48, 500, 28, 500, 38, 152, 78, 500, 500, 94, 500, 36, 44, 38, 500, 70, 52, 50, 42, 500, 56, 500, 500, 52, 98, 122, 50, 46, 44, 500, 500, 500, 36, 156, 124, 50, 500, 500, 500, 500, 22, 500, 500, 312, 444, 98, 500, 500, 34, 500, 500, 56, 88, 500, 48, 394, 38, 102, 192, 96, 60, 500, 500, 50, 500, 54, 278, 48, 58, 242, 500, 42, 500, 500, 198, 500, 168, 500, 500, 36, 500, 500, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4311328394673339, "mean_inference_ms": 1.3796444699398729, "mean_action_processing_ms": 0.16183951267731267, "mean_env_wait_ms": 0.09543863974729469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04540705680847168, "StateBufferConnector_ms": 0.009963035583496094, "ViewRequirementAgentConnector_ms": 0.20130133628845215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3631.7286520082303, "num_env_steps_trained_throughput_per_sec": 3631.7286520082303, "timesteps_total": 1152000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 4176.308, "sample_time_ms": 3859.026, "load_time_ms": 24.136, "load_throughput": 745761.581, "learn_time_ms": 244.946, "learn_throughput": 73485.491, "synch_weights_time_ms": 46.298}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4366, "training_iteration": 64, "trial_id": "9f288_00006", "date": "2023-10-25_16-02-51", "timestamp": 1698246171, "time_this_iter_s": 4.962314605712891, "time_total_s": 223.8899598121643, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 223.8899598121643, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 94.65000000000002, "ram_util_percent": 29.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855046e-20, "cur_lr": 0.0003, "total_loss": 6.538058519363403, "policy_loss": -0.0013188814821963508, "vf_loss": 6.539425293604533, "vf_explained_var": -6.556510925292969e-07, "kl": 0.00018986161212453112, "entropy": 0.48078324397404987, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 774.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.029999999999825, "episode_len_mean": 250.3, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 44.7, 22.299999999999876, 45.3, 44.300000000000004, 25.899999999999928, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 46.099999999999994, 45.9, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.10000000000001, 45.5, 46.099999999999994, 46.5, 39.50000000000002, 43.50000000000001, -50.00000000000044, 46.5, 46.9, 45.3, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 28.499999999999964, -50.00000000000044, 46.5, 37.10000000000003, 45.1, 46.3, -50.00000000000044, 47.7, 32.90000000000003, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 42.10000000000001, 45.3, 46.099999999999994, 41.100000000000016, -50.00000000000044, 45.9, 42.500000000000014, 41.500000000000014, 30.9, 47.5, -50.00000000000044, 45.9, 46.099999999999994, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.10000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 27.299999999999947, -50.00000000000044, 43.30000000000001, 40.70000000000002, -50.00000000000044, 42.10000000000001, 41.500000000000014], "episode_lengths": [50, 500, 54, 278, 48, 58, 242, 500, 42, 500, 500, 198, 500, 168, 500, 500, 36, 500, 500, 84, 500, 500, 500, 132, 500, 40, 42, 500, 84, 500, 60, 46, 40, 36, 106, 66, 500, 36, 32, 48, 500, 32, 500, 54, 216, 500, 36, 130, 50, 38, 500, 24, 172, 500, 500, 112, 500, 80, 48, 40, 90, 500, 42, 76, 86, 192, 26, 500, 42, 40, 138, 500, 500, 500, 48, 80, 500, 500, 42, 500, 72, 500, 64, 500, 500, 78, 500, 70, 188, 500, 500, 500, 42, 228, 500, 68, 94, 500, 80, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4332495725521707, "mean_inference_ms": 1.3852433925041934, "mean_action_processing_ms": 0.1626414169581809, "mean_env_wait_ms": 0.09603927353502831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03389096260070801, "StateBufferConnector_ms": 0.012003660202026367, "ViewRequirementAgentConnector_ms": 0.15598750114440918}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.029999999999825, "episode_len_mean": 250.3, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 44.7, 22.299999999999876, 45.3, 44.300000000000004, 25.899999999999928, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 46.099999999999994, 45.9, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.10000000000001, 45.5, 46.099999999999994, 46.5, 39.50000000000002, 43.50000000000001, -50.00000000000044, 46.5, 46.9, 45.3, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 28.499999999999964, -50.00000000000044, 46.5, 37.10000000000003, 45.1, 46.3, -50.00000000000044, 47.7, 32.90000000000003, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 42.10000000000001, 45.3, 46.099999999999994, 41.100000000000016, -50.00000000000044, 45.9, 42.500000000000014, 41.500000000000014, 30.9, 47.5, -50.00000000000044, 45.9, 46.099999999999994, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.10000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 27.299999999999947, -50.00000000000044, 43.30000000000001, 40.70000000000002, -50.00000000000044, 42.10000000000001, 41.500000000000014], "episode_lengths": [50, 500, 54, 278, 48, 58, 242, 500, 42, 500, 500, 198, 500, 168, 500, 500, 36, 500, 500, 84, 500, 500, 500, 132, 500, 40, 42, 500, 84, 500, 60, 46, 40, 36, 106, 66, 500, 36, 32, 48, 500, 32, 500, 54, 216, 500, 36, 130, 50, 38, 500, 24, 172, 500, 500, 112, 500, 80, 48, 40, 90, 500, 42, 76, 86, 192, 26, 500, 42, 40, 138, 500, 500, 500, 48, 80, 500, 500, 42, 500, 72, 500, 64, 500, 500, 78, 500, 70, 188, 500, 500, 500, 42, 228, 500, 68, 94, 500, 80, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4332495725521707, "mean_inference_ms": 1.3852433925041934, "mean_action_processing_ms": 0.1626414169581809, "mean_env_wait_ms": 0.09603927353502831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03389096260070801, "StateBufferConnector_ms": 0.012003660202026367, "ViewRequirementAgentConnector_ms": 0.15598750114440918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4258.9621436102425, "num_env_steps_trained_throughput_per_sec": 4258.9621436102425, "timesteps_total": 1170000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1170000, "timers": {"training_iteration_time_ms": 4134.061, "sample_time_ms": 3838.062, "load_time_ms": 25.336, "load_throughput": 710438.736, "learn_time_ms": 254.038, "learn_throughput": 70855.548, "synch_weights_time_ms": 14.623}, "counters": {"num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "done": false, "episodes_total": 4445, "training_iteration": 65, "trial_id": "9f288_00006", "date": "2023-10-25_16-02-55", "timestamp": 1698246175, "time_this_iter_s": 4.239381790161133, "time_total_s": 228.12934160232544, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 228.12934160232544, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 83.56666666666668, "ram_util_percent": 29.933333333333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427523e-21, "cur_lr": 0.0003, "total_loss": 6.604372501373291, "policy_loss": 0.040468575743337475, "vf_loss": 6.563952922821045, "vf_explained_var": -7.053216298421224e-07, "kl": 0.0003768341637548171, "entropy": 0.48843320459127426, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 786.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.445999999999828, "episode_len_mean": 246.16, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.10000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 27.299999999999947, -50.00000000000044, 43.30000000000001, 40.70000000000002, -50.00000000000044, 42.10000000000001, 41.500000000000014, 42.70000000000001, 29.69999999999998, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.500000000000014, 41.90000000000001, 32.30000000000002, 39.300000000000026, -50.00000000000044, 43.7, 40.30000000000002, 47.7, -50.00000000000044, 43.7, 44.300000000000004, 47.3, 45.7, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.5, 43.900000000000006, -50.00000000000044, 14.299999999999763, 43.50000000000001, 44.5, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.3, 32.50000000000002, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 40.10000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 4.299999999999621, 43.900000000000006, 44.5, 37.70000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 39.300000000000026, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 44.5, -50.00000000000044, 44.7, 43.50000000000001, 45.3, 45.3, -50.00000000000044, 46.9, 43.900000000000006, 24.899999999999913, 44.5, -50.00000000000044, 45.5, 46.5], "episode_lengths": [500, 42, 500, 72, 500, 64, 500, 500, 78, 500, 70, 188, 500, 500, 500, 42, 228, 500, 68, 94, 500, 80, 86, 74, 204, 52, 500, 500, 500, 500, 62, 76, 82, 178, 108, 500, 64, 98, 24, 500, 64, 58, 28, 44, 138, 500, 500, 500, 500, 34, 26, 62, 500, 358, 66, 56, 82, 500, 500, 58, 500, 38, 176, 198, 500, 500, 500, 36, 500, 100, 72, 500, 500, 458, 62, 56, 124, 70, 500, 500, 44, 108, 56, 500, 54, 500, 56, 500, 54, 66, 48, 48, 500, 32, 62, 252, 56, 500, 46, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4361809668011152, "mean_inference_ms": 1.394326944071592, "mean_action_processing_ms": 0.16410657799709105, "mean_env_wait_ms": 0.09687669231266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048114776611328125, "StateBufferConnector_ms": 0.007996320724487305, "ViewRequirementAgentConnector_ms": 0.21114873886108398}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.445999999999828, "episode_len_mean": 246.16, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.10000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 27.299999999999947, -50.00000000000044, 43.30000000000001, 40.70000000000002, -50.00000000000044, 42.10000000000001, 41.500000000000014, 42.70000000000001, 29.69999999999998, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.500000000000014, 41.90000000000001, 32.30000000000002, 39.300000000000026, -50.00000000000044, 43.7, 40.30000000000002, 47.7, -50.00000000000044, 43.7, 44.300000000000004, 47.3, 45.7, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.5, 43.900000000000006, -50.00000000000044, 14.299999999999763, 43.50000000000001, 44.5, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.3, 32.50000000000002, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 40.10000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 4.299999999999621, 43.900000000000006, 44.5, 37.70000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 39.300000000000026, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 44.5, -50.00000000000044, 44.7, 43.50000000000001, 45.3, 45.3, -50.00000000000044, 46.9, 43.900000000000006, 24.899999999999913, 44.5, -50.00000000000044, 45.5, 46.5], "episode_lengths": [500, 42, 500, 72, 500, 64, 500, 500, 78, 500, 70, 188, 500, 500, 500, 42, 228, 500, 68, 94, 500, 80, 86, 74, 204, 52, 500, 500, 500, 500, 62, 76, 82, 178, 108, 500, 64, 98, 24, 500, 64, 58, 28, 44, 138, 500, 500, 500, 500, 34, 26, 62, 500, 358, 66, 56, 82, 500, 500, 58, 500, 38, 176, 198, 500, 500, 500, 36, 500, 100, 72, 500, 500, 458, 62, 56, 124, 70, 500, 500, 44, 108, 56, 500, 54, 500, 56, 500, 54, 66, 48, 48, 500, 32, 62, 252, 56, 500, 46, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4361809668011152, "mean_inference_ms": 1.394326944071592, "mean_action_processing_ms": 0.16410657799709105, "mean_env_wait_ms": 0.09687669231266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048114776611328125, "StateBufferConnector_ms": 0.007996320724487305, "ViewRequirementAgentConnector_ms": 0.21114873886108398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3019.9279921058437, "num_env_steps_trained_throughput_per_sec": 3019.9279921058437, "timesteps_total": 1188000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 4282.46, "sample_time_ms": 3983.059, "load_time_ms": 26.437, "load_throughput": 680873.856, "learn_time_ms": 255.469, "learn_throughput": 70458.538, "synch_weights_time_ms": 15.563}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4522, "training_iteration": 66, "trial_id": "9f288_00006", "date": "2023-10-25_16-03-01", "timestamp": 1698246181, "time_this_iter_s": 5.971491098403931, "time_total_s": 234.10083270072937, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 234.10083270072937, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 94.32222222222224, "ram_util_percent": 30.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137616e-21, "cur_lr": 0.0003, "total_loss": 6.5093032121658325, "policy_loss": -0.029636985311905544, "vf_loss": 6.538990616798401, "vf_explained_var": -1.2069940567016602e-06, "kl": 0.000630565765872948, "entropy": 0.5041469410061836, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 798.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.639999999999848, "episode_len_mean": 234.28, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 4.299999999999621, 43.900000000000006, 44.5, 37.70000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 39.300000000000026, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 44.5, -50.00000000000044, 44.7, 43.50000000000001, 45.3, 45.3, -50.00000000000044, 46.9, 43.900000000000006, 24.899999999999913, 44.5, -50.00000000000044, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 28.499999999999964, 24.899999999999913, 37.70000000000003, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 41.30000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 33.30000000000003, 42.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 44.5, -50.00000000000044, 46.9, 40.10000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, 43.7, 45.5, 38.700000000000024, 41.500000000000014, 26.09999999999993, 45.1, 39.10000000000002, 47.1, 40.70000000000002, -50.00000000000044, 46.099999999999994, 9.299999999999692, 32.30000000000002, 41.90000000000001, 33.30000000000003, 43.10000000000001, 19.499999999999837, 42.500000000000014, 47.3, 40.90000000000002, 45.7, 44.300000000000004, 45.7, 27.099999999999945, 40.70000000000002, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 4.899999999999629, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 43.7, 44.5], "episode_lengths": [500, 500, 458, 62, 56, 124, 70, 500, 500, 44, 108, 56, 500, 54, 500, 56, 500, 54, 66, 48, 48, 500, 32, 62, 252, 56, 500, 46, 36, 500, 500, 216, 252, 124, 176, 500, 500, 500, 500, 158, 88, 106, 500, 500, 168, 72, 78, 500, 500, 500, 192, 56, 500, 32, 100, 500, 40, 500, 500, 54, 74, 500, 64, 46, 114, 86, 240, 50, 110, 30, 94, 500, 40, 408, 178, 82, 168, 70, 306, 76, 28, 92, 44, 58, 44, 230, 94, 500, 38, 38, 500, 452, 500, 74, 500, 500, 180, 500, 64, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4385285877846469, "mean_inference_ms": 1.404267175782412, "mean_action_processing_ms": 0.16521560081799436, "mean_env_wait_ms": 0.09754934060658821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04808235168457031, "StateBufferConnector_ms": 0.0069904327392578125, "ViewRequirementAgentConnector_ms": 0.2112119197845459}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.639999999999848, "episode_len_mean": 234.28, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 4.299999999999621, 43.900000000000006, 44.5, 37.70000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 39.300000000000026, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 44.5, -50.00000000000044, 44.7, 43.50000000000001, 45.3, 45.3, -50.00000000000044, 46.9, 43.900000000000006, 24.899999999999913, 44.5, -50.00000000000044, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 28.499999999999964, 24.899999999999913, 37.70000000000003, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 41.30000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 33.30000000000003, 42.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 44.5, -50.00000000000044, 46.9, 40.10000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, 43.7, 45.5, 38.700000000000024, 41.500000000000014, 26.09999999999993, 45.1, 39.10000000000002, 47.1, 40.70000000000002, -50.00000000000044, 46.099999999999994, 9.299999999999692, 32.30000000000002, 41.90000000000001, 33.30000000000003, 43.10000000000001, 19.499999999999837, 42.500000000000014, 47.3, 40.90000000000002, 45.7, 44.300000000000004, 45.7, 27.099999999999945, 40.70000000000002, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 4.899999999999629, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 43.7, 44.5], "episode_lengths": [500, 500, 458, 62, 56, 124, 70, 500, 500, 44, 108, 56, 500, 54, 500, 56, 500, 54, 66, 48, 48, 500, 32, 62, 252, 56, 500, 46, 36, 500, 500, 216, 252, 124, 176, 500, 500, 500, 500, 158, 88, 106, 500, 500, 168, 72, 78, 500, 500, 500, 192, 56, 500, 32, 100, 500, 40, 500, 500, 54, 74, 500, 64, 46, 114, 86, 240, 50, 110, 30, 94, 500, 40, 408, 178, 82, 168, 70, 306, 76, 28, 92, 44, 58, 44, 230, 94, 500, 38, 38, 500, 452, 500, 74, 500, 500, 180, 500, 64, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4385285877846469, "mean_inference_ms": 1.404267175782412, "mean_action_processing_ms": 0.16521560081799436, "mean_env_wait_ms": 0.09754934060658821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04808235168457031, "StateBufferConnector_ms": 0.0069904327392578125, "ViewRequirementAgentConnector_ms": 0.2112119197845459}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3552.508253623515, "num_env_steps_trained_throughput_per_sec": 3552.508253623515, "timesteps_total": 1206000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1206000, "timers": {"training_iteration_time_ms": 4418.461, "sample_time_ms": 4096.065, "load_time_ms": 29.345, "load_throughput": 613401.127, "learn_time_ms": 274.624, "learn_throughput": 65544.102, "synch_weights_time_ms": 16.496}, "counters": {"num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "done": false, "episodes_total": 4593, "training_iteration": 67, "trial_id": "9f288_00006", "date": "2023-10-25_16-03-06", "timestamp": 1698246186, "time_this_iter_s": 5.075842618942261, "time_total_s": 239.17667531967163, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 239.17667531967163, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 92.78571428571429, "ram_util_percent": 31.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 0.0003, "total_loss": 6.909571528434753, "policy_loss": -0.009192653621236483, "vf_loss": 6.918817520141602, "vf_explained_var": -4.520018895467122e-07, "kl": 7.364979452025484e-05, "entropy": 0.5332801217834154, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 810.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.005999999999844, "episode_len_mean": 240.62, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.30000000000002, 41.90000000000001, 33.30000000000003, 43.10000000000001, 19.499999999999837, 42.500000000000014, 47.3, 40.90000000000002, 45.7, 44.300000000000004, 45.7, 27.099999999999945, 40.70000000000002, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 4.899999999999629, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 43.7, 44.5, -50.00000000000044, 35.70000000000003, 43.900000000000006, 33.500000000000036, 42.900000000000006, -50.00000000000044, 43.900000000000006, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 45.7, -50.00000000000044, 39.300000000000026, 44.900000000000006, 46.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, 39.10000000000002, 41.70000000000002, 47.1, 17.899999999999814, -50.00000000000044, 41.30000000000001, -50.00000000000044, 4.699999999999626, 40.30000000000002, 26.09999999999993, 39.90000000000002, 35.900000000000034, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 44.7, 40.10000000000002, 28.29999999999996, 45.1, 44.900000000000006, 42.30000000000001, 42.70000000000001, 45.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.30000000000001, -50.00000000000044, 37.10000000000003, 46.3, 19.69999999999984, 45.9, -50.00000000000044, 39.90000000000002, 9.8999999999997, 46.5, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.7, 42.900000000000006, 44.5, -50.00000000000044], "episode_lengths": [178, 82, 168, 70, 306, 76, 28, 92, 44, 58, 44, 230, 94, 500, 38, 38, 500, 452, 500, 74, 500, 500, 180, 500, 64, 56, 500, 144, 62, 166, 72, 500, 62, 500, 182, 500, 500, 500, 500, 212, 44, 500, 108, 52, 36, 500, 78, 500, 46, 500, 110, 84, 30, 322, 500, 88, 500, 454, 98, 240, 102, 142, 46, 500, 500, 500, 372, 500, 500, 54, 100, 218, 50, 52, 78, 74, 46, 500, 106, 500, 500, 80, 68, 500, 130, 38, 304, 42, 500, 102, 402, 36, 102, 500, 500, 84, 44, 72, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44109295539361193, "mean_inference_ms": 1.4117785299939158, "mean_action_processing_ms": 0.16608510594181333, "mean_env_wait_ms": 0.09781488287153017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0469973087310791, "StateBufferConnector_ms": 0.009995222091674805, "ViewRequirementAgentConnector_ms": 0.18248200416564941}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.005999999999844, "episode_len_mean": 240.62, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.30000000000002, 41.90000000000001, 33.30000000000003, 43.10000000000001, 19.499999999999837, 42.500000000000014, 47.3, 40.90000000000002, 45.7, 44.300000000000004, 45.7, 27.099999999999945, 40.70000000000002, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 4.899999999999629, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 43.7, 44.5, -50.00000000000044, 35.70000000000003, 43.900000000000006, 33.500000000000036, 42.900000000000006, -50.00000000000044, 43.900000000000006, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 45.7, -50.00000000000044, 39.300000000000026, 44.900000000000006, 46.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, 39.10000000000002, 41.70000000000002, 47.1, 17.899999999999814, -50.00000000000044, 41.30000000000001, -50.00000000000044, 4.699999999999626, 40.30000000000002, 26.09999999999993, 39.90000000000002, 35.900000000000034, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 44.7, 40.10000000000002, 28.29999999999996, 45.1, 44.900000000000006, 42.30000000000001, 42.70000000000001, 45.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.30000000000001, -50.00000000000044, 37.10000000000003, 46.3, 19.69999999999984, 45.9, -50.00000000000044, 39.90000000000002, 9.8999999999997, 46.5, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.7, 42.900000000000006, 44.5, -50.00000000000044], "episode_lengths": [178, 82, 168, 70, 306, 76, 28, 92, 44, 58, 44, 230, 94, 500, 38, 38, 500, 452, 500, 74, 500, 500, 180, 500, 64, 56, 500, 144, 62, 166, 72, 500, 62, 500, 182, 500, 500, 500, 500, 212, 44, 500, 108, 52, 36, 500, 78, 500, 46, 500, 110, 84, 30, 322, 500, 88, 500, 454, 98, 240, 102, 142, 46, 500, 500, 500, 372, 500, 500, 54, 100, 218, 50, 52, 78, 74, 46, 500, 106, 500, 500, 80, 68, 500, 130, 38, 304, 42, 500, 102, 402, 36, 102, 500, 500, 84, 44, 72, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44109295539361193, "mean_inference_ms": 1.4117785299939158, "mean_action_processing_ms": 0.16608510594181333, "mean_env_wait_ms": 0.09781488287153017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0469973087310791, "StateBufferConnector_ms": 0.009995222091674805, "ViewRequirementAgentConnector_ms": 0.18248200416564941}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3823.5105661567977, "num_env_steps_trained_throughput_per_sec": 3823.5105661567977, "timesteps_total": 1224000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 4518.318, "sample_time_ms": 4183.259, "load_time_ms": 31.206, "load_throughput": 576820.748, "learn_time_ms": 284.346, "learn_throughput": 63303.184, "synch_weights_time_ms": 17.599}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4667, "training_iteration": 68, "trial_id": "9f288_00006", "date": "2023-10-25_16-03-11", "timestamp": 1698246191, "time_this_iter_s": 4.71623158454895, "time_total_s": 243.89290690422058, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 243.89290690422058, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 92.48333333333335, "ram_util_percent": 30.916666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 0.0003, "total_loss": 6.398346225420634, "policy_loss": 0.04098987206816673, "vf_loss": 6.357408205668132, "vf_explained_var": -2.125898996988932e-06, "kl": 0.00017808785946963704, "entropy": 0.5180293743809065, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 822.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.5699999999998235, "episode_len_mean": 254.92, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.7, 40.10000000000002, 28.29999999999996, 45.1, 44.900000000000006, 42.30000000000001, 42.70000000000001, 45.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.30000000000001, -50.00000000000044, 37.10000000000003, 46.3, 19.69999999999984, 45.9, -50.00000000000044, 39.90000000000002, 9.8999999999997, 46.5, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.7, 42.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.9, -50.00000000000044, 42.30000000000001, 46.9, -50.00000000000044, 30.29999999999999, 10.499999999999709, -50.00000000000044, 44.5, 17.299999999999805, 45.9, -50.00000000000044, 33.70000000000004, -50.00000000000044, 46.3, 44.900000000000006, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, 22.699999999999882, 44.300000000000004, 44.10000000000001, 39.90000000000002, 46.9, 40.30000000000002, 43.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 34.70000000000004, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 41.100000000000016, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.5, 45.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 45.3, 42.900000000000006, 17.69999999999981, -50.00000000000044, 33.70000000000004], "episode_lengths": [500, 500, 54, 100, 218, 50, 52, 78, 74, 46, 500, 106, 500, 500, 80, 68, 500, 130, 38, 304, 42, 500, 102, 402, 36, 102, 500, 500, 84, 44, 72, 56, 500, 500, 70, 500, 32, 500, 78, 32, 500, 198, 396, 500, 56, 328, 42, 500, 164, 500, 38, 52, 104, 500, 500, 98, 274, 58, 60, 102, 32, 98, 68, 500, 72, 500, 500, 500, 90, 154, 44, 500, 500, 500, 88, 52, 500, 500, 56, 90, 62, 500, 500, 112, 56, 46, 48, 500, 500, 500, 500, 500, 500, 196, 500, 48, 72, 324, 500, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44266042238375564, "mean_inference_ms": 1.4170396333230166, "mean_action_processing_ms": 0.16695856252477473, "mean_env_wait_ms": 0.09856176371399929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049978017807006836, "StateBufferConnector_ms": 0.01400899887084961, "ViewRequirementAgentConnector_ms": 0.18273425102233887}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.5699999999998235, "episode_len_mean": 254.92, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.7, 40.10000000000002, 28.29999999999996, 45.1, 44.900000000000006, 42.30000000000001, 42.70000000000001, 45.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.30000000000001, -50.00000000000044, 37.10000000000003, 46.3, 19.69999999999984, 45.9, -50.00000000000044, 39.90000000000002, 9.8999999999997, 46.5, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.7, 42.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.9, -50.00000000000044, 42.30000000000001, 46.9, -50.00000000000044, 30.29999999999999, 10.499999999999709, -50.00000000000044, 44.5, 17.299999999999805, 45.9, -50.00000000000044, 33.70000000000004, -50.00000000000044, 46.3, 44.900000000000006, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, 22.699999999999882, 44.300000000000004, 44.10000000000001, 39.90000000000002, 46.9, 40.30000000000002, 43.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 34.70000000000004, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 41.100000000000016, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.5, 45.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 45.3, 42.900000000000006, 17.69999999999981, -50.00000000000044, 33.70000000000004], "episode_lengths": [500, 500, 54, 100, 218, 50, 52, 78, 74, 46, 500, 106, 500, 500, 80, 68, 500, 130, 38, 304, 42, 500, 102, 402, 36, 102, 500, 500, 84, 44, 72, 56, 500, 500, 70, 500, 32, 500, 78, 32, 500, 198, 396, 500, 56, 328, 42, 500, 164, 500, 38, 52, 104, 500, 500, 98, 274, 58, 60, 102, 32, 98, 68, 500, 72, 500, 500, 500, 90, 154, 44, 500, 500, 500, 88, 52, 500, 500, 56, 90, 62, 500, 500, 112, 56, 46, 48, 500, 500, 500, 500, 500, 500, 196, 500, 48, 72, 324, 500, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44266042238375564, "mean_inference_ms": 1.4170396333230166, "mean_action_processing_ms": 0.16695856252477473, "mean_env_wait_ms": 0.09856176371399929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049978017807006836, "StateBufferConnector_ms": 0.01400899887084961, "ViewRequirementAgentConnector_ms": 0.18273425102233887}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3884.6547192983144, "num_env_steps_trained_throughput_per_sec": 3884.6547192983144, "timesteps_total": 1242000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1242000, "timers": {"training_iteration_time_ms": 4602.245, "sample_time_ms": 4261.538, "load_time_ms": 30.406, "load_throughput": 591994.957, "learn_time_ms": 290.512, "learn_throughput": 61959.623, "synch_weights_time_ms": 17.882}, "counters": {"num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "done": false, "episodes_total": 4734, "training_iteration": 69, "trial_id": "9f288_00006", "date": "2023-10-25_16-03-15", "timestamp": 1698246195, "time_this_iter_s": 4.6396191120147705, "time_total_s": 248.53252601623535, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 248.53252601623535, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 87.28571428571429, "ram_util_percent": 30.97142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.388131789017202e-22, "cur_lr": 0.0003, "total_loss": 6.360620299975078, "policy_loss": -0.04256874384979407, "vf_loss": 6.403235673904419, "vf_explained_var": -1.0232130686442058e-06, "kl": 0.0005329437457154048, "entropy": 0.4667231763402621, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 834.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1749999999998035, "episode_len_mean": 273.82, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.100000000000016, 34.70000000000004, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 41.100000000000016, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.5, 45.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 45.3, 42.900000000000006, 17.69999999999981, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.9, 41.90000000000001, 46.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.9, -50.00000000000044, 28.499999999999964, 46.099999999999994, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, 29.69999999999998, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 33.30000000000003, 42.10000000000001, 45.7, 46.9, 45.3, -50.00000000000044, -50.00000000000044, 45.9, 39.300000000000026, 21.299999999999862, 45.5, 12.899999999999743, 44.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, 39.90000000000002, 44.5, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.9, 43.7, 41.90000000000001, 31.500000000000007, -50.00000000000044, 27.699999999999953, 42.500000000000014, 45.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 90, 154, 44, 500, 500, 500, 88, 52, 500, 500, 56, 90, 62, 500, 500, 112, 56, 46, 48, 500, 500, 500, 500, 500, 500, 196, 500, 48, 72, 324, 500, 164, 500, 500, 98, 500, 500, 44, 82, 500, 500, 32, 82, 38, 500, 52, 500, 22, 500, 216, 40, 86, 500, 500, 48, 204, 500, 496, 500, 168, 80, 44, 32, 48, 500, 500, 42, 108, 288, 46, 372, 56, 500, 500, 110, 102, 56, 58, 500, 36, 500, 500, 42, 500, 42, 64, 82, 186, 500, 224, 76, 44, 90, 500, 500, 144, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44425311180825594, "mean_inference_ms": 1.422842876796314, "mean_action_processing_ms": 0.16762503886392963, "mean_env_wait_ms": 0.09941706171963709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0450129508972168, "StateBufferConnector_ms": 0.010949850082397461, "ViewRequirementAgentConnector_ms": 0.2057032585144043}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1749999999998035, "episode_len_mean": 273.82, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.100000000000016, 34.70000000000004, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 41.100000000000016, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.5, 45.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 45.3, 42.900000000000006, 17.69999999999981, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.9, 41.90000000000001, 46.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.9, -50.00000000000044, 28.499999999999964, 46.099999999999994, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, 29.69999999999998, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 33.30000000000003, 42.10000000000001, 45.7, 46.9, 45.3, -50.00000000000044, -50.00000000000044, 45.9, 39.300000000000026, 21.299999999999862, 45.5, 12.899999999999743, 44.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, 39.90000000000002, 44.5, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.9, 43.7, 41.90000000000001, 31.500000000000007, -50.00000000000044, 27.699999999999953, 42.500000000000014, 45.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 90, 154, 44, 500, 500, 500, 88, 52, 500, 500, 56, 90, 62, 500, 500, 112, 56, 46, 48, 500, 500, 500, 500, 500, 500, 196, 500, 48, 72, 324, 500, 164, 500, 500, 98, 500, 500, 44, 82, 500, 500, 32, 82, 38, 500, 52, 500, 22, 500, 216, 40, 86, 500, 500, 48, 204, 500, 496, 500, 168, 80, 44, 32, 48, 500, 500, 42, 108, 288, 46, 372, 56, 500, 500, 110, 102, 56, 58, 500, 36, 500, 500, 42, 500, 42, 64, 82, 186, 500, 224, 76, 44, 90, 500, 500, 144, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44425311180825594, "mean_inference_ms": 1.422842876796314, "mean_action_processing_ms": 0.16762503886392963, "mean_env_wait_ms": 0.09941706171963709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0450129508972168, "StateBufferConnector_ms": 0.010949850082397461, "ViewRequirementAgentConnector_ms": 0.2057032585144043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3784.274115329891, "num_env_steps_trained_throughput_per_sec": 3784.274115329891, "timesteps_total": 1260000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 4664.43, "sample_time_ms": 4315.555, "load_time_ms": 32.586, "load_throughput": 552392.099, "learn_time_ms": 295.621, "learn_throughput": 60888.795, "synch_weights_time_ms": 18.461}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4800, "training_iteration": 70, "trial_id": "9f288_00006", "date": "2023-10-25_16-03-20", "timestamp": 1698246200, "time_this_iter_s": 4.762526512145996, "time_total_s": 253.29505252838135, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 253.29505252838135, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 85.19999999999997, "ram_util_percent": 30.95714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.694065894508601e-22, "cur_lr": 0.0003, "total_loss": 6.688481688499451, "policy_loss": 0.005574456028019388, "vf_loss": 6.682954788208008, "vf_explained_var": -1.1225541432698567e-06, "kl": 0.0008747633697569294, "entropy": 0.476983721057574, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 846.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9799999999998112, "episode_len_mean": 260.8, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.10000000000002, 39.90000000000002, 44.5, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.9, 43.7, 41.90000000000001, 31.500000000000007, -50.00000000000044, 27.699999999999953, 42.500000000000014, 45.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.9, -50.00000000000044, 36.900000000000034, 47.1, 46.9, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.90000000000002, -50.00000000000044, 47.3, 43.7, 46.099999999999994, -50.00000000000044, 41.30000000000001, 21.89999999999987, 44.7, -50.00000000000044, 45.9, 42.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 8.699999999999683, 4.899999999999629, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.1, 45.1, 46.3, 45.3, 46.099999999999994, 47.5, -50.00000000000044, 43.50000000000001, 19.499999999999837, 15.49999999999978, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.900000000000006, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 2.0999999999995893, 42.70000000000001, 39.50000000000002, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 47.9, 44.7, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.10000000000001, -50.00000000000044, 35.10000000000004], "episode_lengths": [500, 110, 102, 56, 58, 500, 36, 500, 500, 42, 500, 42, 64, 82, 186, 500, 224, 76, 44, 90, 500, 500, 144, 500, 500, 500, 60, 42, 500, 132, 30, 32, 500, 124, 500, 500, 60, 92, 500, 28, 64, 40, 500, 88, 282, 54, 500, 42, 76, 500, 42, 500, 500, 414, 452, 500, 500, 68, 500, 30, 50, 38, 48, 40, 26, 500, 66, 306, 346, 500, 500, 500, 500, 500, 126, 52, 500, 34, 44, 500, 34, 500, 500, 480, 74, 106, 50, 50, 500, 500, 22, 54, 500, 86, 500, 500, 110, 80, 500, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4469793372162616, "mean_inference_ms": 1.4308577508013882, "mean_action_processing_ms": 0.16858901468343165, "mean_env_wait_ms": 0.09984328288461936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04799962043762207, "StateBufferConnector_ms": 0.011197805404663086, "ViewRequirementAgentConnector_ms": 0.19736146926879883}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9799999999998112, "episode_len_mean": 260.8, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.10000000000002, 39.90000000000002, 44.5, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.9, 43.7, 41.90000000000001, 31.500000000000007, -50.00000000000044, 27.699999999999953, 42.500000000000014, 45.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.9, -50.00000000000044, 36.900000000000034, 47.1, 46.9, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.90000000000002, -50.00000000000044, 47.3, 43.7, 46.099999999999994, -50.00000000000044, 41.30000000000001, 21.89999999999987, 44.7, -50.00000000000044, 45.9, 42.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 8.699999999999683, 4.899999999999629, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.1, 45.1, 46.3, 45.3, 46.099999999999994, 47.5, -50.00000000000044, 43.50000000000001, 19.499999999999837, 15.49999999999978, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.900000000000006, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 2.0999999999995893, 42.70000000000001, 39.50000000000002, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 47.9, 44.7, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.10000000000001, -50.00000000000044, 35.10000000000004], "episode_lengths": [500, 110, 102, 56, 58, 500, 36, 500, 500, 42, 500, 42, 64, 82, 186, 500, 224, 76, 44, 90, 500, 500, 144, 500, 500, 500, 60, 42, 500, 132, 30, 32, 500, 124, 500, 500, 60, 92, 500, 28, 64, 40, 500, 88, 282, 54, 500, 42, 76, 500, 42, 500, 500, 414, 452, 500, 500, 68, 500, 30, 50, 38, 48, 40, 26, 500, 66, 306, 346, 500, 500, 500, 500, 500, 126, 52, 500, 34, 44, 500, 34, 500, 500, 480, 74, 106, 50, 50, 500, 500, 22, 54, 500, 86, 500, 500, 110, 80, 500, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4469793372162616, "mean_inference_ms": 1.4308577508013882, "mean_action_processing_ms": 0.16858901468343165, "mean_env_wait_ms": 0.09984328288461936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04799962043762207, "StateBufferConnector_ms": 0.011197805404663086, "ViewRequirementAgentConnector_ms": 0.19736146926879883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3729.4975492181725, "num_env_steps_trained_throughput_per_sec": 3729.4975492181725, "timesteps_total": 1278000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1278000, "timers": {"training_iteration_time_ms": 4729.928, "sample_time_ms": 4370.486, "load_time_ms": 34.886, "load_throughput": 515973.658, "learn_time_ms": 303.204, "learn_throughput": 59366.039, "synch_weights_time_ms": 19.045}, "counters": {"num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "done": false, "episodes_total": 4875, "training_iteration": 71, "trial_id": "9f288_00006", "date": "2023-10-25_16-03-25", "timestamp": 1698246205, "time_this_iter_s": 4.832895278930664, "time_total_s": 258.127947807312, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 258.127947807312, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 94.58333333333333, "ram_util_percent": 31.066666666666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 0.0003, "total_loss": 6.807709256807963, "policy_loss": -0.03496366102869312, "vf_loss": 6.842718402544658, "vf_explained_var": 2.086162567138672e-07, "kl": 2.717332713094341e-05, "entropy": 0.4545311356584231, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 858.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.787999999999816, "episode_len_mean": 262.74, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.49999999999978, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.900000000000006, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 2.0999999999995893, 42.70000000000001, 39.50000000000002, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 47.9, 44.7, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.10000000000001, -50.00000000000044, 35.10000000000004, 22.699999999999882, 33.30000000000003, 31.500000000000007, 33.500000000000036, 6.8999999999996575, 46.699999999999996, 45.7, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.3, 44.7, 41.500000000000014, 44.7, -50.00000000000044, 35.500000000000036, 47.5, -50.00000000000044, -50.00000000000044, 45.3, 43.50000000000001, -50.00000000000044, 41.90000000000001, 31.900000000000013, -50.00000000000044, 47.3, 35.10000000000004, -50.00000000000044, 20.099999999999845, 45.1, -50.00000000000044, -50.00000000000044, 14.699999999999768, 41.90000000000001, 46.099999999999994, 47.5, 34.70000000000004, 45.9, 46.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 37.50000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.5, 34.70000000000004, -50.00000000000044, 38.50000000000003, 46.3, 46.3, 14.899999999999771, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 46.5, 47.5, 44.900000000000006], "episode_lengths": [346, 500, 500, 500, 500, 500, 126, 52, 500, 34, 44, 500, 34, 500, 500, 480, 74, 106, 50, 50, 500, 500, 22, 54, 500, 86, 500, 500, 110, 80, 500, 150, 274, 168, 186, 166, 432, 34, 44, 500, 466, 500, 500, 500, 90, 500, 48, 54, 86, 54, 500, 146, 26, 500, 500, 48, 66, 500, 82, 182, 500, 28, 150, 500, 300, 50, 500, 500, 354, 82, 40, 26, 154, 42, 38, 500, 80, 500, 70, 500, 500, 58, 126, 500, 152, 500, 56, 154, 500, 116, 38, 38, 352, 500, 500, 106, 500, 36, 26, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4482743887245675, "mean_inference_ms": 1.4354357937324003, "mean_action_processing_ms": 0.1691999820557986, "mean_env_wait_ms": 0.10033226426420631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04783177375793457, "StateBufferConnector_ms": 0.019204378128051758, "ViewRequirementAgentConnector_ms": 0.19010519981384277}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.787999999999816, "episode_len_mean": 262.74, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.49999999999978, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.900000000000006, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 2.0999999999995893, 42.70000000000001, 39.50000000000002, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 47.9, 44.7, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.10000000000001, -50.00000000000044, 35.10000000000004, 22.699999999999882, 33.30000000000003, 31.500000000000007, 33.500000000000036, 6.8999999999996575, 46.699999999999996, 45.7, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.3, 44.7, 41.500000000000014, 44.7, -50.00000000000044, 35.500000000000036, 47.5, -50.00000000000044, -50.00000000000044, 45.3, 43.50000000000001, -50.00000000000044, 41.90000000000001, 31.900000000000013, -50.00000000000044, 47.3, 35.10000000000004, -50.00000000000044, 20.099999999999845, 45.1, -50.00000000000044, -50.00000000000044, 14.699999999999768, 41.90000000000001, 46.099999999999994, 47.5, 34.70000000000004, 45.9, 46.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 37.50000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.5, 34.70000000000004, -50.00000000000044, 38.50000000000003, 46.3, 46.3, 14.899999999999771, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 46.5, 47.5, 44.900000000000006], "episode_lengths": [346, 500, 500, 500, 500, 500, 126, 52, 500, 34, 44, 500, 34, 500, 500, 480, 74, 106, 50, 50, 500, 500, 22, 54, 500, 86, 500, 500, 110, 80, 500, 150, 274, 168, 186, 166, 432, 34, 44, 500, 466, 500, 500, 500, 90, 500, 48, 54, 86, 54, 500, 146, 26, 500, 500, 48, 66, 500, 82, 182, 500, 28, 150, 500, 300, 50, 500, 500, 354, 82, 40, 26, 154, 42, 38, 500, 80, 500, 70, 500, 500, 58, 126, 500, 152, 500, 56, 154, 500, 116, 38, 38, 352, 500, 500, 106, 500, 36, 26, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4482743887245675, "mean_inference_ms": 1.4354357937324003, "mean_action_processing_ms": 0.1691999820557986, "mean_env_wait_ms": 0.10033226426420631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04783177375793457, "StateBufferConnector_ms": 0.019204378128051758, "ViewRequirementAgentConnector_ms": 0.19010519981384277}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3807.048297630177, "num_env_steps_trained_throughput_per_sec": 3807.048297630177, "timesteps_total": 1296000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 4829.693, "sample_time_ms": 4453.869, "load_time_ms": 37.572, "load_throughput": 479086.216, "learn_time_ms": 316.386, "learn_throughput": 56892.576, "synch_weights_time_ms": 19.503}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4943, "training_iteration": 72, "trial_id": "9f288_00006", "date": "2023-10-25_16-03-30", "timestamp": 1698246210, "time_this_iter_s": 4.7350640296936035, "time_total_s": 262.8630118370056, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 262.8630118370056, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 86.08571428571429, "ram_util_percent": 31.04285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 0.0003, "total_loss": 6.360390464464824, "policy_loss": 0.01904011145234108, "vf_loss": 6.341395417849223, "vf_explained_var": -5.712111790974935e-07, "kl": 3.045310662900628e-05, "entropy": 0.4493662590781848, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 870.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.131999999999824, "episode_len_mean": 249.3, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.699999999999768, 41.90000000000001, 46.099999999999994, 47.5, 34.70000000000004, 45.9, 46.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 37.50000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.5, 34.70000000000004, -50.00000000000044, 38.50000000000003, 46.3, 46.3, 14.899999999999771, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 46.5, 47.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, 46.699999999999996, 45.3, 46.9, 45.9, -50.00000000000044, 32.50000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 35.10000000000004, 28.699999999999967, 44.5, 42.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 47.7, 46.099999999999994, 38.10000000000002, 46.9, -50.00000000000044, 41.30000000000001, 12.899999999999743, 4.899999999999629, 43.900000000000006, 44.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 48.1, 46.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.7, 45.7, 32.90000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.500000000000014, 46.699999999999996, -50.00000000000044, 32.90000000000003, -50.00000000000044, 41.70000000000002, 29.099999999999973], "episode_lengths": [354, 82, 40, 26, 154, 42, 38, 500, 80, 500, 70, 500, 500, 58, 126, 500, 152, 500, 56, 154, 500, 116, 38, 38, 352, 500, 500, 106, 500, 36, 26, 52, 500, 500, 500, 500, 500, 500, 128, 32, 500, 500, 500, 500, 218, 34, 48, 32, 42, 500, 176, 500, 38, 500, 500, 34, 34, 150, 214, 56, 72, 500, 90, 500, 24, 40, 120, 32, 500, 88, 372, 452, 62, 52, 500, 54, 500, 30, 500, 500, 20, 38, 38, 500, 500, 500, 28, 54, 44, 172, 500, 40, 500, 76, 34, 500, 172, 500, 84, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4496620923075667, "mean_inference_ms": 1.44050202162433, "mean_action_processing_ms": 0.1698181300221731, "mean_env_wait_ms": 0.10100801775747892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04696774482727051, "StateBufferConnector_ms": 0.009003877639770508, "ViewRequirementAgentConnector_ms": 0.1749889850616455}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.131999999999824, "episode_len_mean": 249.3, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.699999999999768, 41.90000000000001, 46.099999999999994, 47.5, 34.70000000000004, 45.9, 46.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 37.50000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.5, 34.70000000000004, -50.00000000000044, 38.50000000000003, 46.3, 46.3, 14.899999999999771, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 46.5, 47.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, 46.699999999999996, 45.3, 46.9, 45.9, -50.00000000000044, 32.50000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 35.10000000000004, 28.699999999999967, 44.5, 42.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 47.7, 46.099999999999994, 38.10000000000002, 46.9, -50.00000000000044, 41.30000000000001, 12.899999999999743, 4.899999999999629, 43.900000000000006, 44.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 48.1, 46.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.7, 45.7, 32.90000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.500000000000014, 46.699999999999996, -50.00000000000044, 32.90000000000003, -50.00000000000044, 41.70000000000002, 29.099999999999973], "episode_lengths": [354, 82, 40, 26, 154, 42, 38, 500, 80, 500, 70, 500, 500, 58, 126, 500, 152, 500, 56, 154, 500, 116, 38, 38, 352, 500, 500, 106, 500, 36, 26, 52, 500, 500, 500, 500, 500, 500, 128, 32, 500, 500, 500, 500, 218, 34, 48, 32, 42, 500, 176, 500, 38, 500, 500, 34, 34, 150, 214, 56, 72, 500, 90, 500, 24, 40, 120, 32, 500, 88, 372, 452, 62, 52, 500, 54, 500, 30, 500, 500, 20, 38, 38, 500, 500, 500, 28, 54, 44, 172, 500, 40, 500, 76, 34, 500, 172, 500, 84, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4496620923075667, "mean_inference_ms": 1.44050202162433, "mean_action_processing_ms": 0.1698181300221731, "mean_env_wait_ms": 0.10100801775747892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04696774482727051, "StateBufferConnector_ms": 0.009003877639770508, "ViewRequirementAgentConnector_ms": 0.1749889850616455}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3901.8880550628073, "num_env_steps_trained_throughput_per_sec": 3901.8880550628073, "timesteps_total": 1314000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1314000, "timers": {"training_iteration_time_ms": 4847.542, "sample_time_ms": 4456.816, "load_time_ms": 39.174, "load_throughput": 459490.575, "learn_time_ms": 329.897, "learn_throughput": 54562.548, "synch_weights_time_ms": 19.148}, "counters": {"num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "done": false, "episodes_total": 5011, "training_iteration": 73, "trial_id": "9f288_00006", "date": "2023-10-25_16-03-34", "timestamp": 1698246214, "time_this_iter_s": 4.619067430496216, "time_total_s": 267.48207926750183, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 267.48207926750183, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 87.71666666666668, "ram_util_percent": 31.016666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357513e-23, "cur_lr": 0.0003, "total_loss": 6.3354387283325195, "policy_loss": -0.003194198633233706, "vf_loss": 6.338674227396647, "vf_explained_var": 2.7318795522054035e-07, "kl": 4.2405999185035625e-05, "entropy": 0.41425702969233197, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 882.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.349999999999816, "episode_len_mean": 247.1, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 48.1, 46.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.7, 45.7, 32.90000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.500000000000014, 46.699999999999996, -50.00000000000044, 32.90000000000003, -50.00000000000044, 41.70000000000002, 29.099999999999973, -50.00000000000044, 47.5, -50.00000000000044, 47.7, -50.00000000000044, 47.3, 46.9, 43.50000000000001, 45.9, -50.00000000000044, -50.00000000000044, 46.3, 46.3, 46.3, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 46.699999999999996, 19.499999999999837, 46.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.7, 46.3, -50.00000000000044, 18.29999999999982, 45.7, -50.00000000000044, 46.699999999999996, 45.1, 36.70000000000003, 47.9, 45.3, -50.00000000000044, 45.5, 40.10000000000002, 16.499999999999794, 46.699999999999996, 45.5, 46.699999999999996, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.900000000000006, 14.499999999999766, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 47.5, 47.1, 43.900000000000006, -50.00000000000044, 44.300000000000004, 42.70000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.9], "episode_lengths": [500, 54, 500, 30, 500, 500, 20, 38, 38, 500, 500, 500, 28, 54, 44, 172, 500, 40, 500, 76, 34, 500, 172, 500, 84, 210, 500, 26, 500, 24, 500, 28, 32, 66, 42, 500, 500, 38, 38, 38, 500, 48, 500, 40, 500, 500, 500, 500, 292, 500, 34, 306, 36, 54, 500, 500, 500, 70, 500, 44, 38, 500, 318, 44, 500, 34, 50, 134, 22, 48, 500, 46, 100, 336, 34, 46, 34, 500, 90, 500, 72, 356, 500, 52, 500, 64, 42, 500, 500, 26, 30, 62, 500, 58, 74, 500, 118, 500, 500, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4520907003176758, "mean_inference_ms": 1.4478121000842716, "mean_action_processing_ms": 0.1709897100386039, "mean_env_wait_ms": 0.1015090168623932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04583907127380371, "StateBufferConnector_ms": 0.014989376068115234, "ViewRequirementAgentConnector_ms": 0.20300817489624023}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.349999999999816, "episode_len_mean": 247.1, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 48.1, 46.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.7, 45.7, 32.90000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.500000000000014, 46.699999999999996, -50.00000000000044, 32.90000000000003, -50.00000000000044, 41.70000000000002, 29.099999999999973, -50.00000000000044, 47.5, -50.00000000000044, 47.7, -50.00000000000044, 47.3, 46.9, 43.50000000000001, 45.9, -50.00000000000044, -50.00000000000044, 46.3, 46.3, 46.3, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 46.699999999999996, 19.499999999999837, 46.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.7, 46.3, -50.00000000000044, 18.29999999999982, 45.7, -50.00000000000044, 46.699999999999996, 45.1, 36.70000000000003, 47.9, 45.3, -50.00000000000044, 45.5, 40.10000000000002, 16.499999999999794, 46.699999999999996, 45.5, 46.699999999999996, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.900000000000006, 14.499999999999766, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 47.5, 47.1, 43.900000000000006, -50.00000000000044, 44.300000000000004, 42.70000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.9], "episode_lengths": [500, 54, 500, 30, 500, 500, 20, 38, 38, 500, 500, 500, 28, 54, 44, 172, 500, 40, 500, 76, 34, 500, 172, 500, 84, 210, 500, 26, 500, 24, 500, 28, 32, 66, 42, 500, 500, 38, 38, 38, 500, 48, 500, 40, 500, 500, 500, 500, 292, 500, 34, 306, 36, 54, 500, 500, 500, 70, 500, 44, 38, 500, 318, 44, 500, 34, 50, 134, 22, 48, 500, 46, 100, 336, 34, 46, 34, 500, 90, 500, 72, 356, 500, 52, 500, 64, 42, 500, 500, 26, 30, 62, 500, 58, 74, 500, 118, 500, 500, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4520907003176758, "mean_inference_ms": 1.4478121000842716, "mean_action_processing_ms": 0.1709897100386039, "mean_env_wait_ms": 0.1015090168623932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04583907127380371, "StateBufferConnector_ms": 0.014989376068115234, "ViewRequirementAgentConnector_ms": 0.20300817489624023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3612.7233754665954, "num_env_steps_trained_throughput_per_sec": 3612.7233754665954, "timesteps_total": 1332000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 4850.149, "sample_time_ms": 4453.763, "load_time_ms": 38.974, "load_throughput": 461847.783, "learn_time_ms": 335.649, "learn_throughput": 53627.414, "synch_weights_time_ms": 19.457}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5085, "training_iteration": 74, "trial_id": "9f288_00006", "date": "2023-10-25_16-03-39", "timestamp": 1698246219, "time_this_iter_s": 4.990390777587891, "time_total_s": 272.4724700450897, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 272.4724700450897, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 90.35714285714288, "ram_util_percent": 31.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678756e-23, "cur_lr": 0.0003, "total_loss": 6.311128218968709, "policy_loss": -0.011638976943989595, "vf_loss": 6.3228081067403155, "vf_explained_var": -1.817941665649414e-06, "kl": 0.00028070204100316687, "entropy": 0.409304474790891, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 894.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.341999999999813, "episode_len_mean": 247.18, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, 16.499999999999794, 46.699999999999996, 45.5, 46.699999999999996, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.900000000000006, 14.499999999999766, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 47.5, 47.1, 43.900000000000006, -50.00000000000044, 44.300000000000004, 42.70000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 47.9, 46.099999999999994, -50.00000000000044, 43.50000000000001, 45.5, 44.7, 47.1, 45.7, 45.7, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 29.49999999999998, 45.9, 42.10000000000001, 6.299999999999649, -50.00000000000044, 46.5, 45.1, -50.00000000000044, 47.7, 30.699999999999996, 44.900000000000006, 46.699999999999996, 46.3, 45.7, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 41.90000000000001, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.3, -50.00000000000044, 46.3, 12.499999999999737, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 47.9, 47.1, 44.7, -50.00000000000044, -50.00000000000044, 47.1], "episode_lengths": [100, 336, 34, 46, 34, 500, 90, 500, 72, 356, 500, 52, 500, 64, 42, 500, 500, 26, 30, 62, 500, 58, 74, 500, 118, 500, 500, 32, 500, 22, 40, 500, 66, 46, 54, 30, 44, 44, 56, 500, 500, 32, 500, 46, 500, 500, 500, 26, 206, 42, 80, 438, 500, 36, 50, 500, 24, 194, 52, 34, 38, 44, 500, 28, 500, 500, 500, 500, 46, 82, 500, 54, 54, 500, 102, 500, 48, 500, 38, 376, 500, 500, 32, 40, 500, 34, 500, 500, 248, 500, 500, 500, 30, 500, 22, 30, 54, 500, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45397009083538875, "mean_inference_ms": 1.4535980229113377, "mean_action_processing_ms": 0.17170274108258016, "mean_env_wait_ms": 0.1018382524909869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04284524917602539, "StateBufferConnector_ms": 0.011998891830444336, "ViewRequirementAgentConnector_ms": 0.19878363609313965}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.341999999999813, "episode_len_mean": 247.18, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, 16.499999999999794, 46.699999999999996, 45.5, 46.699999999999996, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.900000000000006, 14.499999999999766, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 47.5, 47.1, 43.900000000000006, -50.00000000000044, 44.300000000000004, 42.70000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 47.9, 46.099999999999994, -50.00000000000044, 43.50000000000001, 45.5, 44.7, 47.1, 45.7, 45.7, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 29.49999999999998, 45.9, 42.10000000000001, 6.299999999999649, -50.00000000000044, 46.5, 45.1, -50.00000000000044, 47.7, 30.699999999999996, 44.900000000000006, 46.699999999999996, 46.3, 45.7, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 41.90000000000001, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.3, -50.00000000000044, 46.3, 12.499999999999737, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 47.9, 47.1, 44.7, -50.00000000000044, -50.00000000000044, 47.1], "episode_lengths": [100, 336, 34, 46, 34, 500, 90, 500, 72, 356, 500, 52, 500, 64, 42, 500, 500, 26, 30, 62, 500, 58, 74, 500, 118, 500, 500, 32, 500, 22, 40, 500, 66, 46, 54, 30, 44, 44, 56, 500, 500, 32, 500, 46, 500, 500, 500, 26, 206, 42, 80, 438, 500, 36, 50, 500, 24, 194, 52, 34, 38, 44, 500, 28, 500, 500, 500, 500, 46, 82, 500, 54, 54, 500, 102, 500, 48, 500, 38, 376, 500, 500, 32, 40, 500, 34, 500, 500, 248, 500, 500, 500, 30, 500, 22, 30, 54, 500, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45397009083538875, "mean_inference_ms": 1.4535980229113377, "mean_action_processing_ms": 0.17170274108258016, "mean_env_wait_ms": 0.1018382524909869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04284524917602539, "StateBufferConnector_ms": 0.011998891830444336, "ViewRequirementAgentConnector_ms": 0.19878363609313965}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3807.1179857805687, "num_env_steps_trained_throughput_per_sec": 3807.1179857805687, "timesteps_total": 1350000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1350000, "timers": {"training_iteration_time_ms": 4900.31, "sample_time_ms": 4508.118, "load_time_ms": 38.674, "load_throughput": 465430.729, "learn_time_ms": 332.642, "learn_throughput": 54112.158, "synch_weights_time_ms": 18.668}, "counters": {"num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "done": false, "episodes_total": 5157, "training_iteration": 75, "trial_id": "9f288_00006", "date": "2023-10-25_16-03-44", "timestamp": 1698246224, "time_this_iter_s": 4.734102725982666, "time_total_s": 277.2065727710724, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 277.2065727710724, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 87.05714285714286, "ram_util_percent": 31.128571428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339378e-24, "cur_lr": 0.0003, "total_loss": 6.106752514839172, "policy_loss": 0.03703336510807276, "vf_loss": 6.069759686787923, "vf_explained_var": -8.046627044677734e-07, "kl": 0.0006583553079716845, "entropy": 0.4062817916274071, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 906.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.438000000000235, "episode_len_mean": 294.86, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 45.7, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 41.90000000000001, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.3, -50.00000000000044, 46.3, 12.499999999999737, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 47.9, 47.1, 44.7, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 41.90000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 47.3, 32.90000000000003, -50.00000000000044, 46.5, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 47.9, 46.699999999999996, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, 46.9, 28.89999999999997, -50.00000000000044, 46.3, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.900000000000006, 38.300000000000026, -50.00000000000044, 8.099999999999675, 47.1, -50.00000000000044], "episode_lengths": [38, 44, 500, 28, 500, 500, 500, 500, 46, 82, 500, 54, 54, 500, 102, 500, 48, 500, 38, 376, 500, 500, 32, 40, 500, 34, 500, 500, 248, 500, 500, 500, 30, 500, 22, 30, 54, 500, 500, 30, 500, 82, 38, 500, 500, 500, 26, 500, 28, 172, 500, 36, 500, 30, 500, 500, 500, 500, 500, 500, 500, 28, 500, 78, 500, 60, 500, 84, 500, 28, 500, 500, 500, 40, 50, 500, 500, 22, 34, 46, 44, 500, 500, 500, 34, 500, 38, 32, 212, 500, 38, 500, 146, 500, 62, 118, 500, 420, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45496037930185523, "mean_inference_ms": 1.4578335428938345, "mean_action_processing_ms": 0.17202673573504085, "mean_env_wait_ms": 0.10204407320863236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04053211212158203, "StateBufferConnector_ms": 0.0062067508697509766, "ViewRequirementAgentConnector_ms": 0.17745447158813477}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.438000000000235, "episode_len_mean": 294.86, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 45.7, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 41.90000000000001, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.3, -50.00000000000044, 46.3, 12.499999999999737, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 47.9, 47.1, 44.7, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 41.90000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 47.3, 32.90000000000003, -50.00000000000044, 46.5, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 47.9, 46.699999999999996, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, 46.9, 28.89999999999997, -50.00000000000044, 46.3, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.900000000000006, 38.300000000000026, -50.00000000000044, 8.099999999999675, 47.1, -50.00000000000044], "episode_lengths": [38, 44, 500, 28, 500, 500, 500, 500, 46, 82, 500, 54, 54, 500, 102, 500, 48, 500, 38, 376, 500, 500, 32, 40, 500, 34, 500, 500, 248, 500, 500, 500, 30, 500, 22, 30, 54, 500, 500, 30, 500, 82, 38, 500, 500, 500, 26, 500, 28, 172, 500, 36, 500, 30, 500, 500, 500, 500, 500, 500, 500, 28, 500, 78, 500, 60, 500, 84, 500, 28, 500, 500, 500, 40, 50, 500, 500, 22, 34, 46, 44, 500, 500, 500, 34, 500, 38, 32, 212, 500, 38, 500, 146, 500, 62, 118, 500, 420, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45496037930185523, "mean_inference_ms": 1.4578335428938345, "mean_action_processing_ms": 0.17202673573504085, "mean_env_wait_ms": 0.10204407320863236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04053211212158203, "StateBufferConnector_ms": 0.0062067508697509766, "ViewRequirementAgentConnector_ms": 0.17745447158813477}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3888.4077173726173, "num_env_steps_trained_throughput_per_sec": 3888.4077173726173, "timesteps_total": 1368000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 4767.183, "sample_time_ms": 4353.095, "load_time_ms": 40.41, "load_throughput": 445437.254, "learn_time_ms": 353.203, "learn_throughput": 50962.155, "synch_weights_time_ms": 18.468}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5217, "training_iteration": 76, "trial_id": "9f288_00006", "date": "2023-10-25_16-03-49", "timestamp": 1698246229, "time_this_iter_s": 4.63614296913147, "time_total_s": 281.84271574020386, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 281.84271574020386, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 89.06666666666666, "ram_util_percent": 31.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.646977960169689e-24, "cur_lr": 0.0003, "total_loss": 6.684016029040019, "policy_loss": -0.014493905667526027, "vf_loss": 6.698549707730611, "vf_explained_var": -1.718600591023763e-06, "kl": 0.0001695809191536076, "entropy": 0.3969120755791664, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 918.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4589999999998025, "episode_len_mean": 261.0, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 47.9, 46.699999999999996, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, 46.9, 28.89999999999997, -50.00000000000044, 46.3, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.900000000000006, 38.300000000000026, -50.00000000000044, 8.099999999999675, 47.1, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 46.099999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, 9.299999999999692, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, 42.900000000000006, 45.3, 41.90000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 44.900000000000006, 47.1, -50.00000000000044, 47.3, 41.90000000000001, 14.499999999999766, -50.00000000000044, 47.1, 44.5, 34.30000000000004, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 44.7, 46.099999999999994, 37.70000000000003, 46.5, 46.099999999999994, 14.09999999999976, -50.00000000000044, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, 45.9, -50.00000000000044, 45.9, 45.5, 47.5, 43.30000000000001, -50.00000000000044, 8.699999999999683, 47.1, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 18.899999999999828, 46.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 40, 50, 500, 500, 22, 34, 46, 44, 500, 500, 500, 34, 500, 38, 32, 212, 500, 38, 500, 146, 500, 62, 118, 500, 420, 30, 500, 500, 238, 500, 40, 78, 500, 500, 36, 408, 500, 46, 58, 500, 72, 48, 82, 500, 28, 500, 500, 500, 26, 52, 30, 500, 28, 82, 356, 500, 30, 56, 158, 500, 58, 500, 500, 500, 248, 54, 40, 124, 36, 40, 360, 500, 500, 28, 34, 500, 42, 500, 42, 46, 26, 68, 500, 414, 30, 500, 500, 134, 500, 32, 500, 500, 42, 36, 312, 36, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4565402030301203, "mean_inference_ms": 1.462471384445435, "mean_action_processing_ms": 0.17281183670857417, "mean_env_wait_ms": 0.10233735550229031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04051828384399414, "StateBufferConnector_ms": 0.005996227264404297, "ViewRequirementAgentConnector_ms": 0.21150565147399902}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4589999999998025, "episode_len_mean": 261.0, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 47.9, 46.699999999999996, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, 46.9, 28.89999999999997, -50.00000000000044, 46.3, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.900000000000006, 38.300000000000026, -50.00000000000044, 8.099999999999675, 47.1, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 46.099999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, 9.299999999999692, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, 42.900000000000006, 45.3, 41.90000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 44.900000000000006, 47.1, -50.00000000000044, 47.3, 41.90000000000001, 14.499999999999766, -50.00000000000044, 47.1, 44.5, 34.30000000000004, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 44.7, 46.099999999999994, 37.70000000000003, 46.5, 46.099999999999994, 14.09999999999976, -50.00000000000044, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, 45.9, -50.00000000000044, 45.9, 45.5, 47.5, 43.30000000000001, -50.00000000000044, 8.699999999999683, 47.1, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 18.899999999999828, 46.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 40, 50, 500, 500, 22, 34, 46, 44, 500, 500, 500, 34, 500, 38, 32, 212, 500, 38, 500, 146, 500, 62, 118, 500, 420, 30, 500, 500, 238, 500, 40, 78, 500, 500, 36, 408, 500, 46, 58, 500, 72, 48, 82, 500, 28, 500, 500, 500, 26, 52, 30, 500, 28, 82, 356, 500, 30, 56, 158, 500, 58, 500, 500, 500, 248, 54, 40, 124, 36, 40, 360, 500, 500, 28, 34, 500, 42, 500, 42, 46, 26, 68, 500, 414, 30, 500, 500, 134, 500, 32, 500, 500, 42, 36, 312, 36, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4565402030301203, "mean_inference_ms": 1.462471384445435, "mean_action_processing_ms": 0.17281183670857417, "mean_env_wait_ms": 0.10233735550229031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04051828384399414, "StateBufferConnector_ms": 0.005996227264404297, "ViewRequirementAgentConnector_ms": 0.21150565147399902}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3853.95049789603, "num_env_steps_trained_throughput_per_sec": 3853.95049789603, "timesteps_total": 1386000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1386000, "timers": {"training_iteration_time_ms": 4727.552, "sample_time_ms": 4313.366, "load_time_ms": 40.308, "load_throughput": 446557.529, "learn_time_ms": 353.525, "learn_throughput": 50915.805, "synch_weights_time_ms": 18.446}, "counters": {"num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "done": false, "episodes_total": 5288, "training_iteration": 77, "trial_id": "9f288_00006", "date": "2023-10-25_16-03-54", "timestamp": 1698246234, "time_this_iter_s": 4.677530765533447, "time_total_s": 286.5202465057373, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 286.5202465057373, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 86.88571428571427, "ram_util_percent": 31.071428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848445e-24, "cur_lr": 0.0003, "total_loss": 5.779361963272095, "policy_loss": 0.004520497440050046, "vf_loss": 5.774878104527791, "vf_explained_var": -9.735425313313801e-07, "kl": 6.24839049943778e-05, "entropy": 0.3651006246606509, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 930.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.069000000000244, "episode_len_mean": 306.16, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.5, 44.900000000000006, 47.1, -50.00000000000044, 47.3, 41.90000000000001, 14.499999999999766, -50.00000000000044, 47.1, 44.5, 34.30000000000004, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 44.7, 46.099999999999994, 37.70000000000003, 46.5, 46.099999999999994, 14.09999999999976, -50.00000000000044, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, 45.9, -50.00000000000044, 45.9, 45.5, 47.5, 43.30000000000001, -50.00000000000044, 8.699999999999683, 47.1, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 18.899999999999828, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 46.3, 45.7, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 26, 52, 30, 500, 28, 82, 356, 500, 30, 56, 158, 500, 58, 500, 500, 500, 248, 54, 40, 124, 36, 40, 360, 500, 500, 28, 34, 500, 42, 500, 42, 46, 26, 68, 500, 414, 30, 500, 500, 134, 500, 32, 500, 500, 42, 36, 312, 36, 500, 500, 500, 500, 102, 500, 38, 500, 500, 44, 500, 500, 500, 500, 500, 500, 500, 500, 186, 38, 44, 32, 500, 500, 500, 94, 500, 500, 500, 28, 60, 500, 100, 500, 500, 500, 500, 500, 500, 74, 34, 500, 500, 28, 500, 500, 500, 114, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576724440689134, "mean_inference_ms": 1.465776538460737, "mean_action_processing_ms": 0.17341124252328324, "mean_env_wait_ms": 0.10296088966769608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042005300521850586, "StateBufferConnector_ms": 0.009996652603149414, "ViewRequirementAgentConnector_ms": 0.196882963180542}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.069000000000244, "episode_len_mean": 306.16, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.5, 44.900000000000006, 47.1, -50.00000000000044, 47.3, 41.90000000000001, 14.499999999999766, -50.00000000000044, 47.1, 44.5, 34.30000000000004, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 44.7, 46.099999999999994, 37.70000000000003, 46.5, 46.099999999999994, 14.09999999999976, -50.00000000000044, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, 45.9, -50.00000000000044, 45.9, 45.5, 47.5, 43.30000000000001, -50.00000000000044, 8.699999999999683, 47.1, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 18.899999999999828, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 46.3, 45.7, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 26, 52, 30, 500, 28, 82, 356, 500, 30, 56, 158, 500, 58, 500, 500, 500, 248, 54, 40, 124, 36, 40, 360, 500, 500, 28, 34, 500, 42, 500, 42, 46, 26, 68, 500, 414, 30, 500, 500, 134, 500, 32, 500, 500, 42, 36, 312, 36, 500, 500, 500, 500, 102, 500, 38, 500, 500, 44, 500, 500, 500, 500, 500, 500, 500, 500, 186, 38, 44, 32, 500, 500, 500, 94, 500, 500, 500, 28, 60, 500, 100, 500, 500, 500, 500, 500, 500, 74, 34, 500, 500, 28, 500, 500, 500, 114, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576724440689134, "mean_inference_ms": 1.465776538460737, "mean_action_processing_ms": 0.17341124252328324, "mean_env_wait_ms": 0.10296088966769608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042005300521850586, "StateBufferConnector_ms": 0.009996652603149414, "ViewRequirementAgentConnector_ms": 0.196882963180542}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3961.3705688750097, "num_env_steps_trained_throughput_per_sec": 3961.3705688750097, "timesteps_total": 1404000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 4711.169, "sample_time_ms": 4297.618, "load_time_ms": 40.508, "load_throughput": 444351.875, "learn_time_ms": 352.968, "learn_throughput": 50996.169, "synch_weights_time_ms": 18.119}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5336, "training_iteration": 78, "trial_id": "9f288_00006", "date": "2023-10-25_16-03-58", "timestamp": 1698246238, "time_this_iter_s": 4.55087947845459, "time_total_s": 291.0711259841919, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 291.0711259841919, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 88.90000000000002, "ram_util_percent": 31.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424223e-25, "cur_lr": 0.0003, "total_loss": 6.057856917381287, "policy_loss": -0.03803830151446164, "vf_loss": 6.095932245254517, "vf_explained_var": -1.9073486328125e-06, "kl": 0.00013627442602389314, "entropy": 0.37093643844127655, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 942.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -9.06400000000025, "episode_len_mean": 311.08, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 46.3, 45.7, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.9, 44.5, -50.00000000000044, 45.7, 44.5, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 32.30000000000002, 47.7, -50.00000000000044, 44.7, -50.00000000000044, 42.900000000000006, 42.70000000000001, 47.3, 46.9, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.300000000000026, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 45.1, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 46.699999999999996, 47.9, 13.699999999999754, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 36.900000000000034, 47.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 186, 38, 44, 32, 500, 500, 500, 94, 500, 500, 500, 28, 60, 500, 100, 500, 500, 500, 500, 500, 500, 74, 34, 500, 500, 28, 500, 500, 500, 114, 500, 500, 500, 58, 22, 56, 500, 44, 56, 34, 500, 30, 500, 258, 500, 500, 26, 500, 500, 500, 30, 500, 500, 178, 24, 500, 54, 500, 72, 74, 28, 32, 500, 62, 500, 128, 500, 84, 500, 500, 24, 500, 50, 116, 500, 500, 42, 46, 34, 22, 364, 500, 500, 500, 34, 500, 500, 132, 22, 500, 40, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4593695951580822, "mean_inference_ms": 1.4709988354932872, "mean_action_processing_ms": 0.1737846837551723, "mean_env_wait_ms": 0.10320522923356018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035532236099243164, "StateBufferConnector_ms": 0.009998798370361328, "ViewRequirementAgentConnector_ms": 0.17653584480285645}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -9.06400000000025, "episode_len_mean": 311.08, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 46.3, 45.7, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.9, 44.5, -50.00000000000044, 45.7, 44.5, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 32.30000000000002, 47.7, -50.00000000000044, 44.7, -50.00000000000044, 42.900000000000006, 42.70000000000001, 47.3, 46.9, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.300000000000026, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 45.1, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 46.699999999999996, 47.9, 13.699999999999754, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 36.900000000000034, 47.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 186, 38, 44, 32, 500, 500, 500, 94, 500, 500, 500, 28, 60, 500, 100, 500, 500, 500, 500, 500, 500, 74, 34, 500, 500, 28, 500, 500, 500, 114, 500, 500, 500, 58, 22, 56, 500, 44, 56, 34, 500, 30, 500, 258, 500, 500, 26, 500, 500, 500, 30, 500, 500, 178, 24, 500, 54, 500, 72, 74, 28, 32, 500, 62, 500, 128, 500, 84, 500, 500, 24, 500, 50, 116, 500, 500, 42, 46, 34, 22, 364, 500, 500, 500, 34, 500, 500, 132, 22, 500, 40, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4593695951580822, "mean_inference_ms": 1.4709988354932872, "mean_action_processing_ms": 0.1737846837551723, "mean_env_wait_ms": 0.10320522923356018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035532236099243164, "StateBufferConnector_ms": 0.009998798370361328, "ViewRequirementAgentConnector_ms": 0.17653584480285645}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3835.2375544406073, "num_env_steps_trained_throughput_per_sec": 3835.2375544406073, "timesteps_total": 1422000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1422000, "timers": {"training_iteration_time_ms": 4717.139, "sample_time_ms": 4303.799, "load_time_ms": 40.808, "load_throughput": 441087.038, "learn_time_ms": 352.439, "learn_throughput": 51072.606, "synch_weights_time_ms": 18.337}, "counters": {"num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "done": false, "episodes_total": 5400, "training_iteration": 79, "trial_id": "9f288_00006", "date": "2023-10-25_16-04-03", "timestamp": 1698246243, "time_this_iter_s": 4.699320316314697, "time_total_s": 295.7704463005066, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 295.7704463005066, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 86.62857142857142, "ram_util_percent": 31.02857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 0.0003, "total_loss": 5.999681234359741, "policy_loss": -0.006780310533940792, "vf_loss": 6.006498614947001, "vf_explained_var": -1.44044558207194e-07, "kl": 0.00028100700894147695, "entropy": 0.3696347375710805, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 954.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.096000000000222, "episode_len_mean": 291.48, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.30000000000002, 47.7, -50.00000000000044, 44.7, -50.00000000000044, 42.900000000000006, 42.70000000000001, 47.3, 46.9, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.300000000000026, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 45.1, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 46.699999999999996, 47.9, 13.699999999999754, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 36.900000000000034, 47.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 8.699999999999683, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.3, -50.00000000000044, 42.70000000000001, 47.7, -50.00000000000044, 45.7, 46.9, 46.699999999999996, -50.00000000000044, 47.7, 45.7, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 22.299999999999876, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 38.700000000000024, 38.10000000000002, 37.300000000000026, 21.299999999999862, 47.1, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 32.50000000000002, -50.00000000000044, 47.9, -50.00000000000044, 5.299999999999635, -50.00000000000044, 45.3, -50.00000000000044], "episode_lengths": [178, 24, 500, 54, 500, 72, 74, 28, 32, 500, 62, 500, 128, 500, 84, 500, 500, 24, 500, 50, 116, 500, 500, 42, 46, 34, 22, 364, 500, 500, 500, 34, 500, 500, 132, 22, 500, 40, 500, 500, 500, 500, 500, 500, 500, 138, 500, 414, 274, 500, 500, 500, 500, 500, 124, 500, 500, 500, 40, 28, 500, 74, 24, 500, 44, 32, 34, 500, 24, 44, 34, 40, 500, 500, 242, 500, 278, 42, 500, 500, 500, 112, 500, 114, 120, 128, 288, 30, 30, 500, 40, 500, 176, 500, 22, 500, 448, 500, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46053791792603815, "mean_inference_ms": 1.4753843957392845, "mean_action_processing_ms": 0.17438879516342048, "mean_env_wait_ms": 0.10366978636078979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299450874328613, "StateBufferConnector_ms": 0.008988380432128906, "ViewRequirementAgentConnector_ms": 0.18760347366333008}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.096000000000222, "episode_len_mean": 291.48, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.30000000000002, 47.7, -50.00000000000044, 44.7, -50.00000000000044, 42.900000000000006, 42.70000000000001, 47.3, 46.9, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.300000000000026, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 45.1, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 46.699999999999996, 47.9, 13.699999999999754, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 36.900000000000034, 47.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 8.699999999999683, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.3, -50.00000000000044, 42.70000000000001, 47.7, -50.00000000000044, 45.7, 46.9, 46.699999999999996, -50.00000000000044, 47.7, 45.7, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 22.299999999999876, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 38.700000000000024, 38.10000000000002, 37.300000000000026, 21.299999999999862, 47.1, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 32.50000000000002, -50.00000000000044, 47.9, -50.00000000000044, 5.299999999999635, -50.00000000000044, 45.3, -50.00000000000044], "episode_lengths": [178, 24, 500, 54, 500, 72, 74, 28, 32, 500, 62, 500, 128, 500, 84, 500, 500, 24, 500, 50, 116, 500, 500, 42, 46, 34, 22, 364, 500, 500, 500, 34, 500, 500, 132, 22, 500, 40, 500, 500, 500, 500, 500, 500, 500, 138, 500, 414, 274, 500, 500, 500, 500, 500, 124, 500, 500, 500, 40, 28, 500, 74, 24, 500, 44, 32, 34, 500, 24, 44, 34, 40, 500, 500, 242, 500, 278, 42, 500, 500, 500, 112, 500, 114, 120, 128, 288, 30, 30, 500, 40, 500, 176, 500, 22, 500, 448, 500, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46053791792603815, "mean_inference_ms": 1.4753843957392845, "mean_action_processing_ms": 0.17438879516342048, "mean_env_wait_ms": 0.10366978636078979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299450874328613, "StateBufferConnector_ms": 0.008988380432128906, "ViewRequirementAgentConnector_ms": 0.18760347366333008}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3851.7986410195294, "num_env_steps_trained_throughput_per_sec": 3851.7986410195294, "timesteps_total": 1440000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 4708.801, "sample_time_ms": 4296.307, "load_time_ms": 40.688, "load_throughput": 442392.28, "learn_time_ms": 351.883, "learn_throughput": 51153.41, "synch_weights_time_ms": 18.467}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5457, "training_iteration": 80, "trial_id": "9f288_00006", "date": "2023-10-25_16-04-08", "timestamp": 1698246248, "time_this_iter_s": 4.680020093917847, "time_total_s": 300.45046639442444, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 300.45046639442444, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 88.23333333333333, "ram_util_percent": 31.016666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060557e-25, "cur_lr": 0.0003, "total_loss": 6.151681820551555, "policy_loss": -0.033896256859103836, "vf_loss": 6.185615420341492, "vf_explained_var": -1.519918441772461e-06, "kl": 0.0003154635962611489, "entropy": 0.37287591646114987, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 966.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.531000000000223, "episode_len_mean": 290.82, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.7, -50.00000000000044, 45.7, 46.9, 46.699999999999996, -50.00000000000044, 47.7, 45.7, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 22.299999999999876, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 38.700000000000024, 38.10000000000002, 37.300000000000026, 21.299999999999862, 47.1, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 32.50000000000002, -50.00000000000044, 47.9, -50.00000000000044, 5.299999999999635, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.5, 47.7, -50.00000000000044, -50.00000000000044, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 33.90000000000004, -50.00000000000044, 46.699999999999996, 33.30000000000003, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 37.10000000000003, 47.1, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 35.30000000000004, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.1, 15.299999999999777, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044], "episode_lengths": [24, 500, 44, 32, 34, 500, 24, 44, 34, 40, 500, 500, 242, 500, 278, 42, 500, 500, 500, 112, 500, 114, 120, 128, 288, 30, 30, 500, 40, 500, 176, 500, 22, 500, 448, 500, 48, 500, 500, 46, 24, 500, 500, 30, 66, 500, 500, 500, 24, 500, 162, 500, 34, 168, 46, 54, 500, 500, 500, 500, 500, 500, 30, 130, 30, 500, 500, 24, 500, 148, 228, 500, 500, 50, 348, 32, 50, 500, 500, 34, 500, 184, 500, 500, 42, 500, 500, 500, 36, 500, 500, 500, 60, 50, 28, 500, 500, 500, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4620315247272137, "mean_inference_ms": 1.4800245842298176, "mean_action_processing_ms": 0.17517595839976083, "mean_env_wait_ms": 0.10420267443736872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300213813781738, "StateBufferConnector_ms": 0.011989831924438477, "ViewRequirementAgentConnector_ms": 0.20280742645263672}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.531000000000223, "episode_len_mean": 290.82, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.7, -50.00000000000044, 45.7, 46.9, 46.699999999999996, -50.00000000000044, 47.7, 45.7, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 22.299999999999876, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 38.700000000000024, 38.10000000000002, 37.300000000000026, 21.299999999999862, 47.1, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 32.50000000000002, -50.00000000000044, 47.9, -50.00000000000044, 5.299999999999635, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.5, 47.7, -50.00000000000044, -50.00000000000044, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 33.90000000000004, -50.00000000000044, 46.699999999999996, 33.30000000000003, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 37.10000000000003, 47.1, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 35.30000000000004, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.1, 15.299999999999777, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044], "episode_lengths": [24, 500, 44, 32, 34, 500, 24, 44, 34, 40, 500, 500, 242, 500, 278, 42, 500, 500, 500, 112, 500, 114, 120, 128, 288, 30, 30, 500, 40, 500, 176, 500, 22, 500, 448, 500, 48, 500, 500, 46, 24, 500, 500, 30, 66, 500, 500, 500, 24, 500, 162, 500, 34, 168, 46, 54, 500, 500, 500, 500, 500, 500, 30, 130, 30, 500, 500, 24, 500, 148, 228, 500, 500, 50, 348, 32, 50, 500, 500, 34, 500, 184, 500, 500, 42, 500, 500, 500, 36, 500, 500, 500, 60, 50, 28, 500, 500, 500, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4620315247272137, "mean_inference_ms": 1.4800245842298176, "mean_action_processing_ms": 0.17517595839976083, "mean_env_wait_ms": 0.10420267443736872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300213813781738, "StateBufferConnector_ms": 0.011989831924438477, "ViewRequirementAgentConnector_ms": 0.20280742645263672}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3526.399275377753, "num_env_steps_trained_throughput_per_sec": 3526.399275377753, "timesteps_total": 1458000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1458000, "timers": {"training_iteration_time_ms": 4736.598, "sample_time_ms": 4326.324, "load_time_ms": 40.388, "load_throughput": 445680.485, "learn_time_ms": 350.149, "learn_throughput": 51406.724, "synch_weights_time_ms": 18.381}, "counters": {"num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "done": false, "episodes_total": 5519, "training_iteration": 81, "trial_id": "9f288_00006", "date": "2023-10-25_16-04-13", "timestamp": 1698246253, "time_this_iter_s": 5.1109089851379395, "time_total_s": 305.5613753795624, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 305.5613753795624, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 79.9, "ram_util_percent": 31.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530278e-26, "cur_lr": 0.0003, "total_loss": 6.350278417269389, "policy_loss": -0.02671334333717823, "vf_loss": 6.377030412356059, "vf_explained_var": -1.6887982686360676e-06, "kl": 4.19450474780092e-05, "entropy": 0.3854767680168152, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 978.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.450000000000231, "episode_len_mean": 295.0, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 35.30000000000004, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.1, 15.299999999999777, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 26.09999999999993, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 47.1, 45.5, 47.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 37.70000000000003, 46.699999999999996, 44.5, -50.00000000000044, 47.3, -50.00000000000044, 45.7, -50.00000000000044, 32.90000000000003, 47.5, 47.3, 18.499999999999822, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 38.90000000000002, 23.699999999999896, 45.9, 29.69999999999998, 44.10000000000001, 39.70000000000002, 42.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, -50.00000000000044, 34.70000000000004, 46.5, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, 46.9, 47.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044], "episode_lengths": [500, 500, 24, 500, 148, 228, 500, 500, 50, 348, 32, 50, 500, 500, 34, 500, 184, 500, 500, 42, 500, 500, 500, 36, 500, 500, 500, 60, 50, 28, 500, 500, 500, 30, 500, 240, 500, 52, 500, 32, 500, 30, 46, 28, 34, 500, 500, 26, 500, 124, 34, 56, 500, 28, 500, 44, 500, 172, 26, 28, 316, 500, 500, 50, 500, 112, 264, 42, 204, 60, 104, 72, 500, 44, 500, 500, 500, 456, 500, 154, 36, 92, 500, 500, 500, 500, 500, 500, 500, 40, 500, 20, 500, 500, 32, 26, 500, 500, 32, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46331121113397394, "mean_inference_ms": 1.4837372919229341, "mean_action_processing_ms": 0.1756488428494663, "mean_env_wait_ms": 0.10442770961700328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05099892616271973, "StateBufferConnector_ms": 0.011003732681274414, "ViewRequirementAgentConnector_ms": 0.18304967880249023}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.450000000000231, "episode_len_mean": 295.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 35.30000000000004, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.1, 15.299999999999777, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 26.09999999999993, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 47.1, 45.5, 47.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 37.70000000000003, 46.699999999999996, 44.5, -50.00000000000044, 47.3, -50.00000000000044, 45.7, -50.00000000000044, 32.90000000000003, 47.5, 47.3, 18.499999999999822, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 38.90000000000002, 23.699999999999896, 45.9, 29.69999999999998, 44.10000000000001, 39.70000000000002, 42.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, -50.00000000000044, 34.70000000000004, 46.5, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, 46.9, 47.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044], "episode_lengths": [500, 500, 24, 500, 148, 228, 500, 500, 50, 348, 32, 50, 500, 500, 34, 500, 184, 500, 500, 42, 500, 500, 500, 36, 500, 500, 500, 60, 50, 28, 500, 500, 500, 30, 500, 240, 500, 52, 500, 32, 500, 30, 46, 28, 34, 500, 500, 26, 500, 124, 34, 56, 500, 28, 500, 44, 500, 172, 26, 28, 316, 500, 500, 50, 500, 112, 264, 42, 204, 60, 104, 72, 500, 44, 500, 500, 500, 456, 500, 154, 36, 92, 500, 500, 500, 500, 500, 500, 500, 40, 500, 20, 500, 500, 32, 26, 500, 500, 32, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46331121113397394, "mean_inference_ms": 1.4837372919229341, "mean_action_processing_ms": 0.1756488428494663, "mean_env_wait_ms": 0.10442770961700328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05099892616271973, "StateBufferConnector_ms": 0.011003732681274414, "ViewRequirementAgentConnector_ms": 0.18304967880249023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3950.78548431763, "num_env_steps_trained_throughput_per_sec": 3950.78548431763, "timesteps_total": 1476000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 4719.395, "sample_time_ms": 4307.465, "load_time_ms": 40.438, "load_throughput": 445128.405, "learn_time_ms": 351.034, "learn_throughput": 51277.025, "synch_weights_time_ms": 18.956}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5584, "training_iteration": 82, "trial_id": "9f288_00006", "date": "2023-10-25_16-04-17", "timestamp": 1698246257, "time_this_iter_s": 4.565892696380615, "time_total_s": 310.127268075943, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 310.127268075943, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 90.26666666666667, "ram_util_percent": 31.016666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 0.0003, "total_loss": 6.202089945475261, "policy_loss": 0.017711929356058437, "vf_loss": 6.184409419695537, "vf_explained_var": -2.473592758178711e-06, "kl": 4.7318257166750755e-05, "entropy": 0.3144193689028422, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 990.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.5530000000002082, "episode_len_mean": 271.06, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.70000000000002, 42.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, -50.00000000000044, 34.70000000000004, 46.5, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, 46.9, 47.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 46.9, -50.00000000000044, -50.00000000000044, 47.3, 30.099999999999987, 47.3, 46.9, 47.1, 46.3, -50.00000000000044, -50.00000000000044, 47.5, 43.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.5, 47.9, 46.099999999999994, -50.00000000000044, 46.9, 47.7, 31.1, 45.5, -50.00000000000044, 36.70000000000003, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 47.1, 39.10000000000002, 46.5, 47.5, 43.7, 46.3, 44.7, -50.00000000000044, 45.7, -50.00000000000044, 45.9, 32.100000000000016, 46.9, 41.90000000000001, -50.00000000000044, 38.300000000000026, 46.099999999999994, -50.00000000000044, 46.099999999999994], "episode_lengths": [104, 72, 500, 44, 500, 500, 500, 456, 500, 154, 36, 92, 500, 500, 500, 500, 500, 500, 500, 40, 500, 20, 500, 500, 32, 26, 500, 500, 32, 500, 500, 500, 36, 500, 36, 500, 500, 500, 160, 32, 500, 500, 28, 200, 28, 32, 30, 38, 500, 500, 26, 64, 500, 66, 500, 500, 500, 500, 96, 500, 500, 500, 54, 500, 500, 46, 22, 40, 500, 32, 24, 190, 46, 500, 134, 32, 34, 500, 500, 500, 36, 30, 110, 36, 26, 64, 38, 54, 500, 44, 500, 42, 180, 32, 82, 500, 118, 40, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46427926015724535, "mean_inference_ms": 1.487584889685599, "mean_action_processing_ms": 0.1759568832585203, "mean_env_wait_ms": 0.10448213840456046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04301333427429199, "StateBufferConnector_ms": 0.012999296188354492, "ViewRequirementAgentConnector_ms": 0.17891335487365723}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.5530000000002082, "episode_len_mean": 271.06, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.70000000000002, 42.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, -50.00000000000044, 34.70000000000004, 46.5, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, 46.9, 47.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 46.9, -50.00000000000044, -50.00000000000044, 47.3, 30.099999999999987, 47.3, 46.9, 47.1, 46.3, -50.00000000000044, -50.00000000000044, 47.5, 43.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.5, 47.9, 46.099999999999994, -50.00000000000044, 46.9, 47.7, 31.1, 45.5, -50.00000000000044, 36.70000000000003, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 47.1, 39.10000000000002, 46.5, 47.5, 43.7, 46.3, 44.7, -50.00000000000044, 45.7, -50.00000000000044, 45.9, 32.100000000000016, 46.9, 41.90000000000001, -50.00000000000044, 38.300000000000026, 46.099999999999994, -50.00000000000044, 46.099999999999994], "episode_lengths": [104, 72, 500, 44, 500, 500, 500, 456, 500, 154, 36, 92, 500, 500, 500, 500, 500, 500, 500, 40, 500, 20, 500, 500, 32, 26, 500, 500, 32, 500, 500, 500, 36, 500, 36, 500, 500, 500, 160, 32, 500, 500, 28, 200, 28, 32, 30, 38, 500, 500, 26, 64, 500, 66, 500, 500, 500, 500, 96, 500, 500, 500, 54, 500, 500, 46, 22, 40, 500, 32, 24, 190, 46, 500, 134, 32, 34, 500, 500, 500, 36, 30, 110, 36, 26, 64, 38, 54, 500, 44, 500, 42, 180, 32, 82, 500, 118, 40, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46427926015724535, "mean_inference_ms": 1.487584889685599, "mean_action_processing_ms": 0.1759568832585203, "mean_env_wait_ms": 0.10448213840456046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04301333427429199, "StateBufferConnector_ms": 0.012999296188354492, "ViewRequirementAgentConnector_ms": 0.17891335487365723}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3927.9944845989103, "num_env_steps_trained_throughput_per_sec": 3927.9944845989103, "timesteps_total": 1494000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1494000, "timers": {"training_iteration_time_ms": 4716.329, "sample_time_ms": 4310.716, "load_time_ms": 40.537, "load_throughput": 444035.126, "learn_time_ms": 344.263, "learn_throughput": 52285.541, "synch_weights_time_ms": 19.409}, "counters": {"num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "done": false, "episodes_total": 5654, "training_iteration": 83, "trial_id": "9f288_00006", "date": "2023-10-25_16-04-22", "timestamp": 1698246262, "time_this_iter_s": 4.589460611343384, "time_total_s": 314.7167286872864, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 314.7167286872864, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 90.10000000000001, "ram_util_percent": 31.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825696e-26, "cur_lr": 0.0003, "total_loss": 6.062037189801534, "policy_loss": 0.018698949987689655, "vf_loss": 6.043371915817261, "vf_explained_var": -2.086162567138672e-06, "kl": 2.402350185448654e-05, "entropy": 0.3389381815989812, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1002.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.893999999999822, "episode_len_mean": 241.66, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.9, 46.099999999999994, -50.00000000000044, 46.9, 47.7, 31.1, 45.5, -50.00000000000044, 36.70000000000003, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 47.1, 39.10000000000002, 46.5, 47.5, 43.7, 46.3, 44.7, -50.00000000000044, 45.7, -50.00000000000044, 45.9, 32.100000000000016, 46.9, 41.90000000000001, -50.00000000000044, 38.300000000000026, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 41.90000000000001, 47.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 47.7, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.5, -50.00000000000044, 7.899999999999672, 47.3, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 46.5, 46.5, 47.5, 23.499999999999893, 43.7, 32.90000000000003, 46.9, 46.099999999999994, 46.099999999999994, 47.3, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 44.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.3, 46.099999999999994, 46.699999999999996, 46.5, 46.3, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 38.50000000000003, 44.7, 47.7], "episode_lengths": [22, 40, 500, 32, 24, 190, 46, 500, 134, 32, 34, 500, 500, 500, 36, 30, 110, 36, 26, 64, 38, 54, 500, 44, 500, 42, 180, 32, 82, 500, 118, 40, 500, 40, 500, 500, 500, 64, 500, 82, 26, 38, 500, 500, 500, 500, 76, 24, 500, 500, 26, 500, 500, 36, 500, 36, 500, 422, 28, 500, 500, 26, 500, 36, 36, 26, 266, 64, 172, 32, 40, 40, 28, 500, 26, 500, 500, 500, 500, 500, 500, 500, 500, 186, 56, 500, 500, 90, 38, 40, 34, 36, 38, 500, 500, 278, 500, 116, 54, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4652113886796218, "mean_inference_ms": 1.4914544076802465, "mean_action_processing_ms": 0.17634376907529017, "mean_env_wait_ms": 0.1046428938838284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04401803016662598, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.18797826766967773}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.893999999999822, "episode_len_mean": 241.66, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.9, 46.099999999999994, -50.00000000000044, 46.9, 47.7, 31.1, 45.5, -50.00000000000044, 36.70000000000003, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 47.1, 39.10000000000002, 46.5, 47.5, 43.7, 46.3, 44.7, -50.00000000000044, 45.7, -50.00000000000044, 45.9, 32.100000000000016, 46.9, 41.90000000000001, -50.00000000000044, 38.300000000000026, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 41.90000000000001, 47.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 47.7, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.5, -50.00000000000044, 7.899999999999672, 47.3, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 46.5, 46.5, 47.5, 23.499999999999893, 43.7, 32.90000000000003, 46.9, 46.099999999999994, 46.099999999999994, 47.3, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 44.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.3, 46.099999999999994, 46.699999999999996, 46.5, 46.3, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 38.50000000000003, 44.7, 47.7], "episode_lengths": [22, 40, 500, 32, 24, 190, 46, 500, 134, 32, 34, 500, 500, 500, 36, 30, 110, 36, 26, 64, 38, 54, 500, 44, 500, 42, 180, 32, 82, 500, 118, 40, 500, 40, 500, 500, 500, 64, 500, 82, 26, 38, 500, 500, 500, 500, 76, 24, 500, 500, 26, 500, 500, 36, 500, 36, 500, 422, 28, 500, 500, 26, 500, 36, 36, 26, 266, 64, 172, 32, 40, 40, 28, 500, 26, 500, 500, 500, 500, 500, 500, 500, 500, 186, 56, 500, 500, 90, 38, 40, 34, 36, 38, 500, 500, 278, 500, 116, 54, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4652113886796218, "mean_inference_ms": 1.4914544076802465, "mean_action_processing_ms": 0.17634376907529017, "mean_env_wait_ms": 0.1046428938838284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04401803016662598, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.18797826766967773}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3801.9604773226615, "num_env_steps_trained_throughput_per_sec": 3801.9604773226615, "timesteps_total": 1512000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 4691.529, "sample_time_ms": 4286.463, "load_time_ms": 40.437, "load_throughput": 445133.916, "learn_time_ms": 343.953, "learn_throughput": 52332.755, "synch_weights_time_ms": 19.273}, "counters": {"num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": true, "episodes_total": 5720, "training_iteration": 84, "trial_id": "9f288_00006", "date": "2023-10-25_16-04-27", "timestamp": 1698246267, "time_this_iter_s": 4.740398645401001, "time_total_s": 319.4571273326874, "pid": 14960, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 319.4571273326874, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 87.5, "ram_util_percent": 31.014285714285712}}
