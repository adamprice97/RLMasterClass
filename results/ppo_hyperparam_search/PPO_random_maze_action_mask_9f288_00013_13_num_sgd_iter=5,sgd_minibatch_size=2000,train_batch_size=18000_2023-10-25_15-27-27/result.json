{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999993, "cur_lr": 0.0003, "total_loss": 9.160154681735568, "policy_loss": -0.0020341137217150793, "vf_loss": 9.161660109625922, "vf_explained_var": 0.00014802482393052842, "kl": 0.0030138207797990777, "entropy": 0.7410061465369331, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 37.70000000000003, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -26.411111111111452, "episode_len_mean": 431.1111111111111, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 9.8999999999997, -50.00000000000044, 25.499999999999922, -50.00000000000044, 22.299999999999876, 2.299999999999592, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.099999999999802, 20.699999999999854, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044], "episode_lengths": [124, 500, 500, 500, 500, 500, 500, 156, 402, 500, 246, 500, 278, 478, 500, 500, 226, 500, 236, 500, 500, 500, 500, 500, 500, 330, 294, 300, 500, 500, 500, 500, 500, 450, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.374186073386243, "mean_inference_ms": 1.2200126218022758, "mean_action_processing_ms": 0.14183704201285105, "mean_env_wait_ms": 0.08281545852942386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047206878662109375, "StateBufferConnector_ms": 0.011115603976779513, "ViewRequirementAgentConnector_ms": 0.09717543919881184}}, "episode_reward_max": 37.70000000000003, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -26.411111111111452, "episode_len_mean": 431.1111111111111, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 9.8999999999997, -50.00000000000044, 25.499999999999922, -50.00000000000044, 22.299999999999876, 2.299999999999592, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.099999999999802, 20.699999999999854, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044], "episode_lengths": [124, 500, 500, 500, 500, 500, 500, 156, 402, 500, 246, 500, 278, 478, 500, 500, 226, 500, 236, 500, 500, 500, 500, 500, 500, 330, 294, 300, 500, 500, 500, 500, 500, 450, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.374186073386243, "mean_inference_ms": 1.2200126218022758, "mean_action_processing_ms": 0.14183704201285105, "mean_env_wait_ms": 0.08281545852942386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047206878662109375, "StateBufferConnector_ms": 0.011115603976779513, "ViewRequirementAgentConnector_ms": 0.09717543919881184}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5610.973082331859, "num_env_steps_trained_throughput_per_sec": 5610.973082331859, "timesteps_total": 18000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 3208.0, "sample_time_ms": 2904.998, "load_time_ms": 9.999, "load_throughput": 1800130.472, "learn_time_ms": 280.0, "learn_throughput": 64285.666, "synch_weights_time_ms": 10.001}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 36, "training_iteration": 1, "trial_id": "9f288_00013", "date": "2023-10-25_16-36-35", "timestamp": 1698248195, "time_this_iter_s": 3.214000701904297, "time_total_s": 3.214000701904297, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 3.214000701904297, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 63.94000000000001, "ram_util_percent": 26.160000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999996, "cur_lr": 0.0003, "total_loss": 8.943937683105469, "policy_loss": -0.0022289802630742392, "vf_loss": 8.945882924397786, "vf_explained_var": 6.6677729288736975e-06, "kl": 0.0035510347801669517, "entropy": 0.7135735551516215, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 43.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -9.047252747253017, "episode_len_mean": 371.25274725274727, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 9.8999999999997, -50.00000000000044, 25.499999999999922, -50.00000000000044, 22.299999999999876, 2.299999999999592, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.099999999999802, 20.699999999999854, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 3.699999999999612, 37.70000000000003, 17.299999999999805, 16.09999999999979, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 6.499999999999652, 25.099999999999916, 15.699999999999783, -50.00000000000044, 34.10000000000004, -50.00000000000044, 10.299999999999706, 26.89999999999994, -50.00000000000044, -50.00000000000044, 1.099999999999575, -50.00000000000044, 29.299999999999976, -50.00000000000044, 8.899999999999686, 38.10000000000002, 4.299999999999621, -50.00000000000044, 34.30000000000004, 41.30000000000001, 11.699999999999726, 10.299999999999706, 38.10000000000002, 17.899999999999814, 10.699999999999712, 30.499999999999993, -50.00000000000044, 25.899999999999928, -50.00000000000044, -50.00000000000044, 41.30000000000001, 32.90000000000003, 33.70000000000004, 43.7, 26.09999999999993, 19.499999999999837, 30.099999999999987, 0.2999999999995637, 33.90000000000004, 24.099999999999902, -50.00000000000044, 41.500000000000014, 33.70000000000004, 7.899999999999672], "episode_lengths": [124, 500, 500, 500, 500, 500, 500, 156, 402, 500, 246, 500, 278, 478, 500, 500, 226, 500, 236, 500, 500, 500, 500, 500, 500, 330, 294, 300, 500, 500, 500, 500, 500, 450, 500, 500, 500, 500, 276, 464, 124, 328, 340, 500, 500, 96, 500, 436, 250, 344, 500, 160, 500, 398, 232, 500, 500, 490, 500, 208, 500, 412, 120, 458, 500, 158, 88, 384, 398, 120, 322, 394, 196, 500, 242, 500, 500, 88, 172, 164, 64, 240, 306, 200, 498, 162, 260, 500, 86, 164, 422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37615324201991734, "mean_inference_ms": 1.2370866357859525, "mean_action_processing_ms": 0.14432015957424416, "mean_env_wait_ms": 0.08421625102889273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029665035205882984, "StateBufferConnector_ms": 0.008790309612567607, "ViewRequirementAgentConnector_ms": 0.09779013120211087}}, "episode_reward_max": 43.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -9.047252747253017, "episode_len_mean": 371.25274725274727, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 9.8999999999997, -50.00000000000044, 25.499999999999922, -50.00000000000044, 22.299999999999876, 2.299999999999592, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.099999999999802, 20.699999999999854, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 3.699999999999612, 37.70000000000003, 17.299999999999805, 16.09999999999979, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 6.499999999999652, 25.099999999999916, 15.699999999999783, -50.00000000000044, 34.10000000000004, -50.00000000000044, 10.299999999999706, 26.89999999999994, -50.00000000000044, -50.00000000000044, 1.099999999999575, -50.00000000000044, 29.299999999999976, -50.00000000000044, 8.899999999999686, 38.10000000000002, 4.299999999999621, -50.00000000000044, 34.30000000000004, 41.30000000000001, 11.699999999999726, 10.299999999999706, 38.10000000000002, 17.899999999999814, 10.699999999999712, 30.499999999999993, -50.00000000000044, 25.899999999999928, -50.00000000000044, -50.00000000000044, 41.30000000000001, 32.90000000000003, 33.70000000000004, 43.7, 26.09999999999993, 19.499999999999837, 30.099999999999987, 0.2999999999995637, 33.90000000000004, 24.099999999999902, -50.00000000000044, 41.500000000000014, 33.70000000000004, 7.899999999999672], "episode_lengths": [124, 500, 500, 500, 500, 500, 500, 156, 402, 500, 246, 500, 278, 478, 500, 500, 226, 500, 236, 500, 500, 500, 500, 500, 500, 330, 294, 300, 500, 500, 500, 500, 500, 450, 500, 500, 500, 500, 276, 464, 124, 328, 340, 500, 500, 96, 500, 436, 250, 344, 500, 160, 500, 398, 232, 500, 500, 490, 500, 208, 500, 412, 120, 458, 500, 158, 88, 384, 398, 120, 322, 394, 196, 500, 242, 500, 500, 88, 172, 164, 64, 240, 306, 200, 498, 162, 260, 500, 86, 164, 422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37615324201991734, "mean_inference_ms": 1.2370866357859525, "mean_action_processing_ms": 0.14432015957424416, "mean_env_wait_ms": 0.08421625102889273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029665035205882984, "StateBufferConnector_ms": 0.008790309612567607, "ViewRequirementAgentConnector_ms": 0.09779013120211087}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5099.137440201324, "num_env_steps_trained_throughput_per_sec": 5099.137440201324, "timesteps_total": 36000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 3369.004, "sample_time_ms": 2934.499, "load_time_ms": 17.514, "load_throughput": 1027777.775, "learn_time_ms": 404.486, "learn_throughput": 44500.942, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 91, "training_iteration": 2, "trial_id": "9f288_00013", "date": "2023-10-25_16-36-39", "timestamp": 1698248199, "time_this_iter_s": 3.537001609802246, "time_total_s": 6.751002311706543, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.751002311706543, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 61.14, "ram_util_percent": 26.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.04999999999999998, "cur_lr": 0.0003, "total_loss": 8.915193261040582, "policy_loss": -0.0009200551443629795, "vf_loss": 8.916072018941243, "vf_explained_var": 1.3660060034857856e-05, "kl": 0.002165944428947518, "entropy": 0.6720007962650723, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 44.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.887999999999817, "episode_len_mean": 301.86, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.10000000000004, -50.00000000000044, 10.299999999999706, 26.89999999999994, -50.00000000000044, -50.00000000000044, 1.099999999999575, -50.00000000000044, 29.299999999999976, -50.00000000000044, 8.899999999999686, 38.10000000000002, 4.299999999999621, -50.00000000000044, 34.30000000000004, 41.30000000000001, 11.699999999999726, 10.299999999999706, 38.10000000000002, 17.899999999999814, 10.699999999999712, 30.499999999999993, -50.00000000000044, 25.899999999999928, -50.00000000000044, -50.00000000000044, 41.30000000000001, 32.90000000000003, 33.70000000000004, 43.7, 26.09999999999993, 19.499999999999837, 30.099999999999987, 0.2999999999995637, 33.90000000000004, 24.099999999999902, -50.00000000000044, 41.500000000000014, 33.70000000000004, 7.899999999999672, -50.00000000000044, 24.299999999999905, 37.70000000000003, 24.099999999999902, 35.30000000000004, -50.00000000000044, 9.699999999999697, 24.899999999999913, -50.00000000000044, 30.099999999999987, 2.0999999999995893, 12.099999999999731, 26.09999999999993, 2.8999999999996007, 18.699999999999825, -50.00000000000044, 37.300000000000026, 36.900000000000034, -50.00000000000044, 39.300000000000026, 26.09999999999993, 44.10000000000001, 34.50000000000004, 38.10000000000002, -50.00000000000044, -50.00000000000044, 44.5, 22.299999999999876, 15.699999999999783, -50.00000000000044, -50.00000000000044, 19.899999999999842, 36.70000000000003, 26.299999999999933, -50.00000000000044, 37.300000000000026, 26.299999999999933, 39.70000000000002, 38.90000000000002, 32.100000000000016, 23.499999999999893, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 6.299999999999649, 41.90000000000001, 13.699999999999754, -50.00000000000044, 41.70000000000002, 28.699999999999967, 1.6999999999995836, 39.70000000000002, 43.50000000000001, 37.90000000000003, 32.50000000000002, 26.499999999999936, -50.00000000000044], "episode_lengths": [500, 160, 500, 398, 232, 500, 500, 490, 500, 208, 500, 412, 120, 458, 500, 158, 88, 384, 398, 120, 322, 394, 196, 500, 242, 500, 500, 88, 172, 164, 64, 240, 306, 200, 498, 162, 260, 500, 86, 164, 422, 500, 258, 124, 260, 148, 500, 404, 252, 500, 200, 480, 380, 240, 472, 314, 500, 128, 132, 500, 108, 240, 60, 156, 120, 500, 500, 56, 278, 344, 500, 500, 302, 134, 238, 500, 128, 238, 104, 112, 180, 266, 200, 500, 500, 500, 154, 438, 82, 364, 500, 84, 214, 484, 104, 66, 122, 176, 236, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785307588454938, "mean_inference_ms": 1.2383913473033645, "mean_action_processing_ms": 0.14500643285396098, "mean_env_wait_ms": 0.08349471773065632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016997098922729492, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.10399889945983887}}, "episode_reward_max": 44.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.887999999999817, "episode_len_mean": 301.86, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.10000000000004, -50.00000000000044, 10.299999999999706, 26.89999999999994, -50.00000000000044, -50.00000000000044, 1.099999999999575, -50.00000000000044, 29.299999999999976, -50.00000000000044, 8.899999999999686, 38.10000000000002, 4.299999999999621, -50.00000000000044, 34.30000000000004, 41.30000000000001, 11.699999999999726, 10.299999999999706, 38.10000000000002, 17.899999999999814, 10.699999999999712, 30.499999999999993, -50.00000000000044, 25.899999999999928, -50.00000000000044, -50.00000000000044, 41.30000000000001, 32.90000000000003, 33.70000000000004, 43.7, 26.09999999999993, 19.499999999999837, 30.099999999999987, 0.2999999999995637, 33.90000000000004, 24.099999999999902, -50.00000000000044, 41.500000000000014, 33.70000000000004, 7.899999999999672, -50.00000000000044, 24.299999999999905, 37.70000000000003, 24.099999999999902, 35.30000000000004, -50.00000000000044, 9.699999999999697, 24.899999999999913, -50.00000000000044, 30.099999999999987, 2.0999999999995893, 12.099999999999731, 26.09999999999993, 2.8999999999996007, 18.699999999999825, -50.00000000000044, 37.300000000000026, 36.900000000000034, -50.00000000000044, 39.300000000000026, 26.09999999999993, 44.10000000000001, 34.50000000000004, 38.10000000000002, -50.00000000000044, -50.00000000000044, 44.5, 22.299999999999876, 15.699999999999783, -50.00000000000044, -50.00000000000044, 19.899999999999842, 36.70000000000003, 26.299999999999933, -50.00000000000044, 37.300000000000026, 26.299999999999933, 39.70000000000002, 38.90000000000002, 32.100000000000016, 23.499999999999893, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 6.299999999999649, 41.90000000000001, 13.699999999999754, -50.00000000000044, 41.70000000000002, 28.699999999999967, 1.6999999999995836, 39.70000000000002, 43.50000000000001, 37.90000000000003, 32.50000000000002, 26.499999999999936, -50.00000000000044], "episode_lengths": [500, 160, 500, 398, 232, 500, 500, 490, 500, 208, 500, 412, 120, 458, 500, 158, 88, 384, 398, 120, 322, 394, 196, 500, 242, 500, 500, 88, 172, 164, 64, 240, 306, 200, 498, 162, 260, 500, 86, 164, 422, 500, 258, 124, 260, 148, 500, 404, 252, 500, 200, 480, 380, 240, 472, 314, 500, 128, 132, 500, 108, 240, 60, 156, 120, 500, 500, 56, 278, 344, 500, 500, 302, 134, 238, 500, 128, 238, 104, 112, 180, 266, 200, 500, 500, 500, 154, 438, 82, 364, 500, 84, 214, 484, 104, 66, 122, 176, 236, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785307588454938, "mean_inference_ms": 1.2383913473033645, "mean_action_processing_ms": 0.14500643285396098, "mean_env_wait_ms": 0.08349471773065632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016997098922729492, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.10399889945983887}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5292.606982941952, "num_env_steps_trained_throughput_per_sec": 5292.606982941952, "timesteps_total": 54000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 3379.66, "sample_time_ms": 2898.999, "load_time_ms": 16.675, "load_throughput": 1079429.699, "learn_time_ms": 451.314, "learn_throughput": 39883.528, "synch_weights_time_ms": 10.334}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 150, "training_iteration": 3, "trial_id": "9f288_00013", "date": "2023-10-25_16-36-42", "timestamp": 1698248202, "time_this_iter_s": 3.407970666885376, "time_total_s": 10.158972978591919, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 10.158972978591919, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 54.7, "ram_util_percent": 26.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.02499999999999999, "cur_lr": 0.0003, "total_loss": 8.462623066372341, "policy_loss": -0.0012063618335458968, "vf_loss": 8.463832187652589, "vf_explained_var": 2.2901429070366755e-06, "kl": 0.002405582063054062, "entropy": 0.6287366257773506, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.16299999999985, "episode_len_mean": 264.12, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.70000000000003, 26.299999999999933, -50.00000000000044, 37.300000000000026, 26.299999999999933, 39.70000000000002, 38.90000000000002, 32.100000000000016, 23.499999999999893, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 6.299999999999649, 41.90000000000001, 13.699999999999754, -50.00000000000044, 41.70000000000002, 28.699999999999967, 1.6999999999995836, 39.70000000000002, 43.50000000000001, 37.90000000000003, 32.50000000000002, 26.499999999999936, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, 26.89999999999994, 40.90000000000002, 43.10000000000001, 18.29999999999982, 27.899999999999956, 22.299999999999876, 33.10000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 35.30000000000004, 43.7, 34.50000000000004, 25.899999999999928, 2.699999999999598, -50.00000000000044, 39.70000000000002, 16.29999999999979, 10.899999999999714, 38.10000000000002, 14.299999999999763, 44.900000000000006, -50.00000000000044, 34.10000000000004, -50.00000000000044, 25.499999999999922, 44.5, 3.0999999999996035, 25.699999999999925, 42.500000000000014, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 46.099999999999994, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 19.499999999999837, 43.30000000000001, 39.10000000000002, 43.50000000000001, 41.70000000000002, 31.1, 24.899999999999913, 21.89999999999987, 40.30000000000002, 42.900000000000006, -50.00000000000044, 43.10000000000001, 41.70000000000002, -50.00000000000044, 40.10000000000002, 40.90000000000002, 35.900000000000034, -50.00000000000044, 13.099999999999746, -50.00000000000044, 31.70000000000001, 24.899999999999913, 47.1, -50.00000000000044, 19.499999999999837, 20.699999999999854, 27.099999999999945, 40.90000000000002], "episode_lengths": [134, 238, 500, 128, 238, 104, 112, 180, 266, 200, 500, 500, 500, 154, 438, 82, 364, 500, 84, 214, 484, 104, 66, 122, 176, 236, 500, 278, 500, 500, 232, 92, 70, 318, 222, 278, 170, 500, 68, 500, 500, 64, 148, 64, 156, 242, 474, 500, 104, 338, 392, 120, 358, 52, 500, 160, 500, 246, 56, 470, 244, 76, 500, 500, 182, 500, 40, 214, 500, 500, 500, 86, 306, 68, 110, 66, 84, 190, 252, 282, 98, 72, 500, 70, 84, 500, 100, 92, 142, 500, 370, 500, 184, 252, 30, 500, 306, 294, 230, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37701736914899514, "mean_inference_ms": 1.225752640309926, "mean_action_processing_ms": 0.14297289628607232, "mean_env_wait_ms": 0.08450301949461761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699565887451172, "StateBufferConnector_ms": 0.0070149898529052734, "ViewRequirementAgentConnector_ms": 0.0999913215637207}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.16299999999985, "episode_len_mean": 264.12, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.70000000000003, 26.299999999999933, -50.00000000000044, 37.300000000000026, 26.299999999999933, 39.70000000000002, 38.90000000000002, 32.100000000000016, 23.499999999999893, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 6.299999999999649, 41.90000000000001, 13.699999999999754, -50.00000000000044, 41.70000000000002, 28.699999999999967, 1.6999999999995836, 39.70000000000002, 43.50000000000001, 37.90000000000003, 32.50000000000002, 26.499999999999936, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, 26.89999999999994, 40.90000000000002, 43.10000000000001, 18.29999999999982, 27.899999999999956, 22.299999999999876, 33.10000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 35.30000000000004, 43.7, 34.50000000000004, 25.899999999999928, 2.699999999999598, -50.00000000000044, 39.70000000000002, 16.29999999999979, 10.899999999999714, 38.10000000000002, 14.299999999999763, 44.900000000000006, -50.00000000000044, 34.10000000000004, -50.00000000000044, 25.499999999999922, 44.5, 3.0999999999996035, 25.699999999999925, 42.500000000000014, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 46.099999999999994, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 19.499999999999837, 43.30000000000001, 39.10000000000002, 43.50000000000001, 41.70000000000002, 31.1, 24.899999999999913, 21.89999999999987, 40.30000000000002, 42.900000000000006, -50.00000000000044, 43.10000000000001, 41.70000000000002, -50.00000000000044, 40.10000000000002, 40.90000000000002, 35.900000000000034, -50.00000000000044, 13.099999999999746, -50.00000000000044, 31.70000000000001, 24.899999999999913, 47.1, -50.00000000000044, 19.499999999999837, 20.699999999999854, 27.099999999999945, 40.90000000000002], "episode_lengths": [134, 238, 500, 128, 238, 104, 112, 180, 266, 200, 500, 500, 500, 154, 438, 82, 364, 500, 84, 214, 484, 104, 66, 122, 176, 236, 500, 278, 500, 500, 232, 92, 70, 318, 222, 278, 170, 500, 68, 500, 500, 64, 148, 64, 156, 242, 474, 500, 104, 338, 392, 120, 358, 52, 500, 160, 500, 246, 56, 470, 244, 76, 500, 500, 182, 500, 40, 214, 500, 500, 500, 86, 306, 68, 110, 66, 84, 190, 252, 282, 98, 72, 500, 70, 84, 500, 100, 92, 142, 500, 370, 500, 184, 252, 30, 500, 306, 294, 230, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37701736914899514, "mean_inference_ms": 1.225752640309926, "mean_action_processing_ms": 0.14297289628607232, "mean_env_wait_ms": 0.08450301949461761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699565887451172, "StateBufferConnector_ms": 0.0070149898529052734, "ViewRequirementAgentConnector_ms": 0.0999913215637207}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5363.5212362058755, "num_env_steps_trained_throughput_per_sec": 5363.5212362058755, "timesteps_total": 72000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 3373.746, "sample_time_ms": 2885.25, "load_time_ms": 18.006, "load_throughput": 999648.747, "learn_time_ms": 458.237, "learn_throughput": 39280.979, "synch_weights_time_ms": 10.0}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 223, "training_iteration": 4, "trial_id": "9f288_00013", "date": "2023-10-25_16-36-45", "timestamp": 1698248205, "time_this_iter_s": 3.367003917694092, "time_total_s": 13.52597689628601, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 13.52597689628601, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 55.61999999999999, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012499999999999995, "cur_lr": 0.0003, "total_loss": 7.315614848666721, "policy_loss": -0.0005717697242895762, "vf_loss": 7.316226524776883, "vf_explained_var": 1.0318226284450954e-06, "kl": 0.0015054774403577336, "entropy": 0.5882204002804227, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.550999999999844, "episode_len_mean": 260.2, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.900000000000013, -50.00000000000044, 46.099999999999994, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 19.499999999999837, 43.30000000000001, 39.10000000000002, 43.50000000000001, 41.70000000000002, 31.1, 24.899999999999913, 21.89999999999987, 40.30000000000002, 42.900000000000006, -50.00000000000044, 43.10000000000001, 41.70000000000002, -50.00000000000044, 40.10000000000002, 40.90000000000002, 35.900000000000034, -50.00000000000044, 13.099999999999746, -50.00000000000044, 31.70000000000001, 24.899999999999913, 47.1, -50.00000000000044, 19.499999999999837, 20.699999999999854, 27.099999999999945, 40.90000000000002, 43.50000000000001, -50.00000000000044, 42.10000000000001, 44.300000000000004, -50.00000000000044, 36.900000000000034, 36.10000000000004, 44.900000000000006, 21.499999999999865, 9.299999999999692, -50.00000000000044, 40.70000000000002, 31.1, 40.500000000000014, 33.30000000000003, -50.00000000000044, 45.3, -50.00000000000044, 40.90000000000002, 39.300000000000026, 16.09999999999979, 41.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 17.69999999999981, 43.10000000000001, 36.900000000000034, 38.10000000000002, 37.10000000000003, 3.0999999999996035, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 4.899999999999629, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 38.300000000000026, 44.10000000000001, 41.70000000000002, 29.49999999999998, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, 20.099999999999845, -50.00000000000044, 34.10000000000004, 31.500000000000007, 22.899999999999885, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.30000000000001, 5.299999999999635, 19.499999999999837, 29.099999999999973], "episode_lengths": [182, 500, 40, 214, 500, 500, 500, 86, 306, 68, 110, 66, 84, 190, 252, 282, 98, 72, 500, 70, 84, 500, 100, 92, 142, 500, 370, 500, 184, 252, 30, 500, 306, 294, 230, 92, 66, 500, 80, 58, 500, 132, 140, 52, 286, 408, 500, 94, 190, 96, 168, 500, 48, 500, 92, 108, 340, 88, 54, 500, 500, 126, 500, 500, 324, 70, 132, 120, 130, 470, 500, 156, 500, 500, 452, 48, 500, 500, 54, 118, 60, 84, 206, 500, 500, 44, 86, 300, 500, 160, 186, 272, 500, 500, 94, 500, 68, 448, 306, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785825262362381, "mean_inference_ms": 1.2285548695255943, "mean_action_processing_ms": 0.1426993234519593, "mean_env_wait_ms": 0.08440989503624163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100062370300293, "StateBufferConnector_ms": 0.007016181945800781, "ViewRequirementAgentConnector_ms": 0.1169729232788086}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.550999999999844, "episode_len_mean": 260.2, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.900000000000013, -50.00000000000044, 46.099999999999994, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 19.499999999999837, 43.30000000000001, 39.10000000000002, 43.50000000000001, 41.70000000000002, 31.1, 24.899999999999913, 21.89999999999987, 40.30000000000002, 42.900000000000006, -50.00000000000044, 43.10000000000001, 41.70000000000002, -50.00000000000044, 40.10000000000002, 40.90000000000002, 35.900000000000034, -50.00000000000044, 13.099999999999746, -50.00000000000044, 31.70000000000001, 24.899999999999913, 47.1, -50.00000000000044, 19.499999999999837, 20.699999999999854, 27.099999999999945, 40.90000000000002, 43.50000000000001, -50.00000000000044, 42.10000000000001, 44.300000000000004, -50.00000000000044, 36.900000000000034, 36.10000000000004, 44.900000000000006, 21.499999999999865, 9.299999999999692, -50.00000000000044, 40.70000000000002, 31.1, 40.500000000000014, 33.30000000000003, -50.00000000000044, 45.3, -50.00000000000044, 40.90000000000002, 39.300000000000026, 16.09999999999979, 41.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 17.69999999999981, 43.10000000000001, 36.900000000000034, 38.10000000000002, 37.10000000000003, 3.0999999999996035, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 4.899999999999629, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 38.300000000000026, 44.10000000000001, 41.70000000000002, 29.49999999999998, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, 20.099999999999845, -50.00000000000044, 34.10000000000004, 31.500000000000007, 22.899999999999885, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.30000000000001, 5.299999999999635, 19.499999999999837, 29.099999999999973], "episode_lengths": [182, 500, 40, 214, 500, 500, 500, 86, 306, 68, 110, 66, 84, 190, 252, 282, 98, 72, 500, 70, 84, 500, 100, 92, 142, 500, 370, 500, 184, 252, 30, 500, 306, 294, 230, 92, 66, 500, 80, 58, 500, 132, 140, 52, 286, 408, 500, 94, 190, 96, 168, 500, 48, 500, 92, 108, 340, 88, 54, 500, 500, 126, 500, 500, 324, 70, 132, 120, 130, 470, 500, 156, 500, 500, 452, 48, 500, 500, 54, 118, 60, 84, 206, 500, 500, 44, 86, 300, 500, 160, 186, 272, 500, 500, 94, 500, 68, 448, 306, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785825262362381, "mean_inference_ms": 1.2285548695255943, "mean_action_processing_ms": 0.1426993234519593, "mean_env_wait_ms": 0.08440989503624163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100062370300293, "StateBufferConnector_ms": 0.007016181945800781, "ViewRequirementAgentConnector_ms": 0.1169729232788086}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5163.514981841943, "num_env_steps_trained_throughput_per_sec": 5163.514981841943, "timesteps_total": 90000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 3396.196, "sample_time_ms": 2903.599, "load_time_ms": 17.205, "load_throughput": 1046207.502, "learn_time_ms": 463.19, "learn_throughput": 38860.972, "synch_weights_time_ms": 10.0}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 287, "training_iteration": 5, "trial_id": "9f288_00013", "date": "2023-10-25_16-36-49", "timestamp": 1698248209, "time_this_iter_s": 3.492994785308838, "time_total_s": 17.01897168159485, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 17.01897168159485, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 71.07499999999999, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006249999999999998, "cur_lr": 0.0003, "total_loss": 6.52587644788954, "policy_loss": -0.0007002626028325822, "vf_loss": 6.5266265869140625, "vf_explained_var": 1.1907683478461372e-06, "kl": 0.0016641427804390534, "entropy": 0.6026832050747342, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 248.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.110999999999811, "episode_len_mean": 284.52, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.900000000000034, 38.10000000000002, 37.10000000000003, 3.0999999999996035, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 4.899999999999629, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 38.300000000000026, 44.10000000000001, 41.70000000000002, 29.49999999999998, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, 20.099999999999845, -50.00000000000044, 34.10000000000004, 31.500000000000007, 22.899999999999885, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.30000000000001, 5.299999999999635, 19.499999999999837, 29.099999999999973, 15.099999999999774, 23.8999999999999, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.500000000000014, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.70000000000001, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.90000000000002, 42.900000000000006, 40.90000000000002, 42.500000000000014, 43.30000000000001, 43.7, 40.500000000000014, 33.30000000000003, 41.100000000000016, -50.00000000000044, 32.30000000000002, 46.099999999999994, -50.00000000000044, 38.700000000000024, -50.00000000000044, 33.500000000000036, 18.499999999999822, 27.899999999999956, 39.50000000000002, 19.69999999999984, -50.00000000000044, 41.30000000000001, 32.700000000000024, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 24.499999999999908, 42.10000000000001, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, 43.50000000000001], "episode_lengths": [132, 120, 130, 470, 500, 156, 500, 500, 452, 48, 500, 500, 54, 118, 60, 84, 206, 500, 500, 44, 86, 300, 500, 160, 186, 272, 500, 500, 94, 500, 68, 448, 306, 210, 350, 262, 500, 66, 500, 38, 500, 52, 500, 96, 90, 500, 500, 36, 500, 500, 500, 172, 218, 500, 500, 500, 62, 500, 74, 244, 500, 500, 500, 64, 102, 72, 92, 76, 68, 64, 96, 168, 90, 500, 178, 40, 500, 114, 500, 166, 316, 222, 106, 304, 500, 88, 174, 500, 474, 500, 500, 364, 500, 256, 80, 500, 98, 50, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3787379746709502, "mean_inference_ms": 1.2265889644198806, "mean_action_processing_ms": 0.14305331588131648, "mean_env_wait_ms": 0.08318333512617794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019995927810668945, "StateBufferConnector_ms": 0.009001016616821289, "ViewRequirementAgentConnector_ms": 0.10849714279174805}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.110999999999811, "episode_len_mean": 284.52, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.900000000000034, 38.10000000000002, 37.10000000000003, 3.0999999999996035, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 4.899999999999629, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 38.300000000000026, 44.10000000000001, 41.70000000000002, 29.49999999999998, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, 20.099999999999845, -50.00000000000044, 34.10000000000004, 31.500000000000007, 22.899999999999885, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.30000000000001, 5.299999999999635, 19.499999999999837, 29.099999999999973, 15.099999999999774, 23.8999999999999, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.500000000000014, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.70000000000001, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.90000000000002, 42.900000000000006, 40.90000000000002, 42.500000000000014, 43.30000000000001, 43.7, 40.500000000000014, 33.30000000000003, 41.100000000000016, -50.00000000000044, 32.30000000000002, 46.099999999999994, -50.00000000000044, 38.700000000000024, -50.00000000000044, 33.500000000000036, 18.499999999999822, 27.899999999999956, 39.50000000000002, 19.69999999999984, -50.00000000000044, 41.30000000000001, 32.700000000000024, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 24.499999999999908, 42.10000000000001, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, 43.50000000000001], "episode_lengths": [132, 120, 130, 470, 500, 156, 500, 500, 452, 48, 500, 500, 54, 118, 60, 84, 206, 500, 500, 44, 86, 300, 500, 160, 186, 272, 500, 500, 94, 500, 68, 448, 306, 210, 350, 262, 500, 66, 500, 38, 500, 52, 500, 96, 90, 500, 500, 36, 500, 500, 500, 172, 218, 500, 500, 500, 62, 500, 74, 244, 500, 500, 500, 64, 102, 72, 92, 76, 68, 64, 96, 168, 90, 500, 178, 40, 500, 114, 500, 166, 316, 222, 106, 304, 500, 88, 174, 500, 474, 500, 500, 364, 500, 256, 80, 500, 98, 50, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3787379746709502, "mean_inference_ms": 1.2265889644198806, "mean_action_processing_ms": 0.14305331588131648, "mean_env_wait_ms": 0.08318333512617794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019995927810668945, "StateBufferConnector_ms": 0.009001016616821289, "ViewRequirementAgentConnector_ms": 0.10849714279174805}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5253.936617726638, "num_env_steps_trained_throughput_per_sec": 5253.936617726638, "timesteps_total": 108000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3401.164, "sample_time_ms": 2896.833, "load_time_ms": 17.838, "load_throughput": 1009108.64, "learn_time_ms": 474.496, "learn_throughput": 37935.0, "synch_weights_time_ms": 9.829}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 353, "training_iteration": 6, "trial_id": "9f288_00013", "date": "2023-10-25_16-36-52", "timestamp": 1698248212, "time_this_iter_s": 3.4319992065429688, "time_total_s": 20.450970888137817, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 20.450970888137817, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 54.96, "ram_util_percent": 26.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003124999999999999, "cur_lr": 0.0003, "total_loss": 6.825630007849799, "policy_loss": 2.5739438003963894e-05, "vf_loss": 6.825660684373644, "vf_explained_var": 4.5431984795464407e-07, "kl": 0.00021370740955383778, "entropy": 0.5704846349027421, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.580999999999835, "episode_len_mean": 269.84, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, 42.500000000000014, 43.30000000000001, 43.7, 40.500000000000014, 33.30000000000003, 41.100000000000016, -50.00000000000044, 32.30000000000002, 46.099999999999994, -50.00000000000044, 38.700000000000024, -50.00000000000044, 33.500000000000036, 18.499999999999822, 27.899999999999956, 39.50000000000002, 19.69999999999984, -50.00000000000044, 41.30000000000001, 32.700000000000024, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 24.499999999999908, 42.10000000000001, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, 43.50000000000001, 30.699999999999996, 22.099999999999874, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.50000000000002, 45.9, -50.00000000000044, 34.50000000000004, 36.900000000000034, -50.00000000000044, 37.50000000000003, 42.500000000000014, 32.100000000000016, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 13.299999999999748, 41.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.10000000000001, 41.30000000000001, 44.10000000000001, 28.499999999999964, 30.699999999999996, 38.700000000000024, 35.10000000000004, 42.10000000000001, 44.900000000000006, -50.00000000000044, 34.10000000000004, 34.10000000000004, 32.90000000000003, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.70000000000002, 12.499999999999737, -50.00000000000044, -50.00000000000044, 41.100000000000016, 27.899999999999956, -50.00000000000044, -50.00000000000044, 40.500000000000014, 32.100000000000016, 43.50000000000001, 41.100000000000016], "episode_lengths": [92, 76, 68, 64, 96, 168, 90, 500, 178, 40, 500, 114, 500, 166, 316, 222, 106, 304, 500, 88, 174, 500, 474, 500, 500, 364, 500, 256, 80, 500, 98, 50, 500, 66, 194, 280, 500, 174, 500, 500, 94, 106, 42, 500, 156, 132, 500, 126, 76, 180, 500, 108, 500, 500, 308, 500, 500, 500, 500, 78, 500, 500, 162, 368, 88, 500, 104, 500, 500, 58, 80, 88, 60, 216, 194, 114, 150, 80, 52, 500, 160, 160, 172, 98, 500, 500, 500, 52, 104, 376, 500, 500, 90, 222, 500, 500, 96, 180, 66, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768701933442046, "mean_inference_ms": 1.2183763759381443, "mean_action_processing_ms": 0.14239492667497652, "mean_env_wait_ms": 0.08279161144834113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016004085540771484, "StateBufferConnector_ms": 0.003992795944213867, "ViewRequirementAgentConnector_ms": 0.10752677917480469}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.580999999999835, "episode_len_mean": 269.84, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, 42.500000000000014, 43.30000000000001, 43.7, 40.500000000000014, 33.30000000000003, 41.100000000000016, -50.00000000000044, 32.30000000000002, 46.099999999999994, -50.00000000000044, 38.700000000000024, -50.00000000000044, 33.500000000000036, 18.499999999999822, 27.899999999999956, 39.50000000000002, 19.69999999999984, -50.00000000000044, 41.30000000000001, 32.700000000000024, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 24.499999999999908, 42.10000000000001, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, 43.50000000000001, 30.699999999999996, 22.099999999999874, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.50000000000002, 45.9, -50.00000000000044, 34.50000000000004, 36.900000000000034, -50.00000000000044, 37.50000000000003, 42.500000000000014, 32.100000000000016, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 13.299999999999748, 41.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.10000000000001, 41.30000000000001, 44.10000000000001, 28.499999999999964, 30.699999999999996, 38.700000000000024, 35.10000000000004, 42.10000000000001, 44.900000000000006, -50.00000000000044, 34.10000000000004, 34.10000000000004, 32.90000000000003, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.70000000000002, 12.499999999999737, -50.00000000000044, -50.00000000000044, 41.100000000000016, 27.899999999999956, -50.00000000000044, -50.00000000000044, 40.500000000000014, 32.100000000000016, 43.50000000000001, 41.100000000000016], "episode_lengths": [92, 76, 68, 64, 96, 168, 90, 500, 178, 40, 500, 114, 500, 166, 316, 222, 106, 304, 500, 88, 174, 500, 474, 500, 500, 364, 500, 256, 80, 500, 98, 50, 500, 66, 194, 280, 500, 174, 500, 500, 94, 106, 42, 500, 156, 132, 500, 126, 76, 180, 500, 108, 500, 500, 308, 500, 500, 500, 500, 78, 500, 500, 162, 368, 88, 500, 104, 500, 500, 58, 80, 88, 60, 216, 194, 114, 150, 80, 52, 500, 160, 160, 172, 98, 500, 500, 500, 52, 104, 376, 500, 500, 90, 222, 500, 500, 96, 180, 66, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768701933442046, "mean_inference_ms": 1.2183763759381443, "mean_action_processing_ms": 0.14239492667497652, "mean_env_wait_ms": 0.08279161144834113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016004085540771484, "StateBufferConnector_ms": 0.003992795944213867, "ViewRequirementAgentConnector_ms": 0.10752677917480469}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5334.207183446419, "num_env_steps_trained_throughput_per_sec": 5334.207183446419, "timesteps_total": 126000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 3397.347, "sample_time_ms": 2903.057, "load_time_ms": 17.289, "load_throughput": 1041110.576, "learn_time_ms": 465.146, "learn_throughput": 38697.513, "synch_weights_time_ms": 9.71}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 419, "training_iteration": 7, "trial_id": "9f288_00013", "date": "2023-10-25_16-36-56", "timestamp": 1698248216, "time_this_iter_s": 3.3794472217559814, "time_total_s": 23.8304181098938, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 23.8304181098938, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 52.239999999999995, "ram_util_percent": 26.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015624999999999994, "cur_lr": 0.0003, "total_loss": 6.623386775122748, "policy_loss": -0.0003030235982603497, "vf_loss": 6.623746543460422, "vf_explained_var": -4.928641849093967e-06, "kl": 0.0012987580086384614, "entropy": 0.5875873737865024, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.382999999999843, "episode_len_mean": 261.82, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.10000000000001, 41.30000000000001, 44.10000000000001, 28.499999999999964, 30.699999999999996, 38.700000000000024, 35.10000000000004, 42.10000000000001, 44.900000000000006, -50.00000000000044, 34.10000000000004, 34.10000000000004, 32.90000000000003, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.70000000000002, 12.499999999999737, -50.00000000000044, -50.00000000000044, 41.100000000000016, 27.899999999999956, -50.00000000000044, -50.00000000000044, 40.500000000000014, 32.100000000000016, 43.50000000000001, 41.100000000000016, 30.099999999999987, 42.70000000000001, -50.00000000000044, 31.900000000000013, 41.500000000000014, 26.09999999999993, -50.00000000000044, 23.099999999999888, -50.00000000000044, 37.70000000000003, 43.30000000000001, 25.29999999999992, 39.70000000000002, 44.7, 19.69999999999984, -50.00000000000044, 31.70000000000001, 37.50000000000003, -50.00000000000044, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 37.70000000000003, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 38.90000000000002, 17.299999999999805, -50.00000000000044, 36.10000000000004, 41.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, 46.9, -50.00000000000044, 18.899999999999828, -50.00000000000044, 39.10000000000002, -50.00000000000044, 36.70000000000003, 45.1, 37.10000000000003, -50.00000000000044, 46.9, -50.00000000000044, 44.7, -50.00000000000044, 41.500000000000014, 32.700000000000024, 31.900000000000013, 36.900000000000034, -50.00000000000044, 39.300000000000026, 39.50000000000002, 39.70000000000002], "episode_lengths": [500, 104, 500, 500, 58, 80, 88, 60, 216, 194, 114, 150, 80, 52, 500, 160, 160, 172, 98, 500, 500, 500, 52, 104, 376, 500, 500, 90, 222, 500, 500, 96, 180, 66, 90, 200, 74, 500, 182, 86, 240, 500, 270, 500, 124, 68, 248, 104, 54, 304, 500, 184, 126, 500, 74, 44, 500, 500, 174, 500, 124, 84, 500, 500, 500, 500, 46, 112, 328, 500, 140, 84, 168, 500, 500, 500, 232, 500, 32, 500, 312, 500, 110, 500, 134, 50, 130, 500, 32, 500, 54, 500, 86, 174, 182, 132, 500, 108, 106, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3746248128261332, "mean_inference_ms": 1.210584507771194, "mean_action_processing_ms": 0.14109093006250295, "mean_env_wait_ms": 0.08228683352944596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019002914428710938, "StateBufferConnector_ms": 0.0029942989349365234, "ViewRequirementAgentConnector_ms": 0.1129915714263916}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.382999999999843, "episode_len_mean": 261.82, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.10000000000001, 41.30000000000001, 44.10000000000001, 28.499999999999964, 30.699999999999996, 38.700000000000024, 35.10000000000004, 42.10000000000001, 44.900000000000006, -50.00000000000044, 34.10000000000004, 34.10000000000004, 32.90000000000003, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.70000000000002, 12.499999999999737, -50.00000000000044, -50.00000000000044, 41.100000000000016, 27.899999999999956, -50.00000000000044, -50.00000000000044, 40.500000000000014, 32.100000000000016, 43.50000000000001, 41.100000000000016, 30.099999999999987, 42.70000000000001, -50.00000000000044, 31.900000000000013, 41.500000000000014, 26.09999999999993, -50.00000000000044, 23.099999999999888, -50.00000000000044, 37.70000000000003, 43.30000000000001, 25.29999999999992, 39.70000000000002, 44.7, 19.69999999999984, -50.00000000000044, 31.70000000000001, 37.50000000000003, -50.00000000000044, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 37.70000000000003, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 38.90000000000002, 17.299999999999805, -50.00000000000044, 36.10000000000004, 41.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, 46.9, -50.00000000000044, 18.899999999999828, -50.00000000000044, 39.10000000000002, -50.00000000000044, 36.70000000000003, 45.1, 37.10000000000003, -50.00000000000044, 46.9, -50.00000000000044, 44.7, -50.00000000000044, 41.500000000000014, 32.700000000000024, 31.900000000000013, 36.900000000000034, -50.00000000000044, 39.300000000000026, 39.50000000000002, 39.70000000000002], "episode_lengths": [500, 104, 500, 500, 58, 80, 88, 60, 216, 194, 114, 150, 80, 52, 500, 160, 160, 172, 98, 500, 500, 500, 52, 104, 376, 500, 500, 90, 222, 500, 500, 96, 180, 66, 90, 200, 74, 500, 182, 86, 240, 500, 270, 500, 124, 68, 248, 104, 54, 304, 500, 184, 126, 500, 74, 44, 500, 500, 174, 500, 124, 84, 500, 500, 500, 500, 46, 112, 328, 500, 140, 84, 168, 500, 500, 500, 232, 500, 32, 500, 312, 500, 110, 500, 134, 50, 130, 500, 32, 500, 54, 500, 86, 174, 182, 132, 500, 108, 106, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3746248128261332, "mean_inference_ms": 1.210584507771194, "mean_action_processing_ms": 0.14109093006250295, "mean_env_wait_ms": 0.08228683352944596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019002914428710938, "StateBufferConnector_ms": 0.0029942989349365234, "ViewRequirementAgentConnector_ms": 0.1129915714263916}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5642.500708512554, "num_env_steps_trained_throughput_per_sec": 5642.500708512554, "timesteps_total": 144000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3371.438, "sample_time_ms": 2877.675, "load_time_ms": 18.003, "load_throughput": 999839.054, "learn_time_ms": 464.142, "learn_throughput": 38781.253, "synch_weights_time_ms": 9.617}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 484, "training_iteration": 8, "trial_id": "9f288_00013", "date": "2023-10-25_16-36-59", "timestamp": 1698248219, "time_this_iter_s": 3.1960742473602295, "time_total_s": 27.02649235725403, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 27.02649235725403, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 59.775, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812499999999997, "cur_lr": 0.0003, "total_loss": 7.04668877919515, "policy_loss": -1.593505342801412e-05, "vf_loss": 7.046762847900391, "vf_explained_var": -4.238552517361111e-07, "kl": 0.00032099797132205925, "entropy": 0.5833508498138852, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.499999999999822, "episode_len_mean": 275.66, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 38.90000000000002, 17.299999999999805, -50.00000000000044, 36.10000000000004, 41.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, 46.9, -50.00000000000044, 18.899999999999828, -50.00000000000044, 39.10000000000002, -50.00000000000044, 36.70000000000003, 45.1, 37.10000000000003, -50.00000000000044, 46.9, -50.00000000000044, 44.7, -50.00000000000044, 41.500000000000014, 32.700000000000024, 31.900000000000013, 36.900000000000034, -50.00000000000044, 39.300000000000026, 39.50000000000002, 39.70000000000002, -50.00000000000044, 43.7, 40.70000000000002, 44.5, 42.30000000000001, 19.09999999999983, 42.30000000000001, 36.50000000000003, 37.10000000000003, -50.00000000000044, 43.50000000000001, 21.89999999999987, -50.00000000000044, 42.500000000000014, 32.50000000000002, 5.6999999999996405, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 45.7, -50.00000000000044, 42.30000000000001, 44.10000000000001, 37.300000000000026, 23.099999999999888, -50.00000000000044, -50.00000000000044, 45.7, 26.89999999999994, 14.499999999999766, -50.00000000000044, -50.00000000000044, 15.49999999999978, 33.70000000000004, 34.10000000000004, 34.10000000000004, 42.30000000000001, 7.699999999999669, 3.699999999999612, -50.00000000000044, 43.50000000000001, 44.900000000000006, -50.00000000000044, 45.1, 4.499999999999623, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.30000000000001, 45.3, 17.099999999999802, 33.500000000000036, 42.500000000000014, 40.90000000000002, -50.00000000000044, 23.099999999999888, 3.2999999999996064, 39.300000000000026, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 46, 112, 328, 500, 140, 84, 168, 500, 500, 500, 232, 500, 32, 500, 312, 500, 110, 500, 134, 50, 130, 500, 32, 500, 54, 500, 86, 174, 182, 132, 500, 108, 106, 104, 500, 64, 94, 56, 78, 310, 78, 136, 130, 500, 66, 282, 500, 76, 176, 444, 500, 132, 500, 500, 238, 500, 44, 500, 78, 60, 128, 270, 500, 500, 44, 232, 356, 500, 500, 346, 164, 160, 160, 78, 424, 464, 500, 66, 52, 500, 50, 456, 500, 72, 500, 88, 48, 330, 166, 76, 92, 500, 270, 468, 108, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.372269983265443, "mean_inference_ms": 1.2032747956061771, "mean_action_processing_ms": 0.14041374331602094, "mean_env_wait_ms": 0.08144139881507438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099799156188965, "StateBufferConnector_ms": 0.0060040950775146484, "ViewRequirementAgentConnector_ms": 0.11796951293945312}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.499999999999822, "episode_len_mean": 275.66, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 38.90000000000002, 17.299999999999805, -50.00000000000044, 36.10000000000004, 41.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, 46.9, -50.00000000000044, 18.899999999999828, -50.00000000000044, 39.10000000000002, -50.00000000000044, 36.70000000000003, 45.1, 37.10000000000003, -50.00000000000044, 46.9, -50.00000000000044, 44.7, -50.00000000000044, 41.500000000000014, 32.700000000000024, 31.900000000000013, 36.900000000000034, -50.00000000000044, 39.300000000000026, 39.50000000000002, 39.70000000000002, -50.00000000000044, 43.7, 40.70000000000002, 44.5, 42.30000000000001, 19.09999999999983, 42.30000000000001, 36.50000000000003, 37.10000000000003, -50.00000000000044, 43.50000000000001, 21.89999999999987, -50.00000000000044, 42.500000000000014, 32.50000000000002, 5.6999999999996405, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 45.7, -50.00000000000044, 42.30000000000001, 44.10000000000001, 37.300000000000026, 23.099999999999888, -50.00000000000044, -50.00000000000044, 45.7, 26.89999999999994, 14.499999999999766, -50.00000000000044, -50.00000000000044, 15.49999999999978, 33.70000000000004, 34.10000000000004, 34.10000000000004, 42.30000000000001, 7.699999999999669, 3.699999999999612, -50.00000000000044, 43.50000000000001, 44.900000000000006, -50.00000000000044, 45.1, 4.499999999999623, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.30000000000001, 45.3, 17.099999999999802, 33.500000000000036, 42.500000000000014, 40.90000000000002, -50.00000000000044, 23.099999999999888, 3.2999999999996064, 39.300000000000026, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 46, 112, 328, 500, 140, 84, 168, 500, 500, 500, 232, 500, 32, 500, 312, 500, 110, 500, 134, 50, 130, 500, 32, 500, 54, 500, 86, 174, 182, 132, 500, 108, 106, 104, 500, 64, 94, 56, 78, 310, 78, 136, 130, 500, 66, 282, 500, 76, 176, 444, 500, 132, 500, 500, 238, 500, 44, 500, 78, 60, 128, 270, 500, 500, 44, 232, 356, 500, 500, 346, 164, 160, 160, 78, 424, 464, 500, 66, 52, 500, 50, 456, 500, 72, 500, 88, 48, 330, 166, 76, 92, 500, 270, 468, 108, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.372269983265443, "mean_inference_ms": 1.2032747956061771, "mean_action_processing_ms": 0.14041374331602094, "mean_env_wait_ms": 0.08144139881507438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099799156188965, "StateBufferConnector_ms": 0.0060040950775146484, "ViewRequirementAgentConnector_ms": 0.11796951293945312}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5496.184646538358, "num_env_steps_trained_throughput_per_sec": 5496.184646538358, "timesteps_total": 162000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 3360.723, "sample_time_ms": 2863.155, "load_time_ms": 18.114, "load_throughput": 993730.656, "learn_time_ms": 467.793, "learn_throughput": 38478.576, "synch_weights_time_ms": 9.66}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "done": false, "episodes_total": 546, "training_iteration": 9, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-02", "timestamp": 1698248222, "time_this_iter_s": 3.2809979915618896, "time_total_s": 30.307490348815918, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 30.307490348815918, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 54.6, "ram_util_percent": 26.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00039062499999999986, "cur_lr": 0.0003, "total_loss": 6.411592769622803, "policy_loss": -0.0005763735622167587, "vf_loss": 6.412227090199789, "vf_explained_var": -8.834732903374566e-07, "kl": 0.001574902728344401, "entropy": 0.5850261939896477, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 428.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.207999999999827, "episode_len_mean": 268.58, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 26.89999999999994, 14.499999999999766, -50.00000000000044, -50.00000000000044, 15.49999999999978, 33.70000000000004, 34.10000000000004, 34.10000000000004, 42.30000000000001, 7.699999999999669, 3.699999999999612, -50.00000000000044, 43.50000000000001, 44.900000000000006, -50.00000000000044, 45.1, 4.499999999999623, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.30000000000001, 45.3, 17.099999999999802, 33.500000000000036, 42.500000000000014, 40.90000000000002, -50.00000000000044, 23.099999999999888, 3.2999999999996064, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 27.899999999999956, 43.10000000000001, 44.900000000000006, 43.10000000000001, 34.900000000000034, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 30.699999999999996, 46.099999999999994, -50.00000000000044, 24.099999999999902, 31.500000000000007, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.7, 35.500000000000036, 36.50000000000003, -50.00000000000044, 46.099999999999994, 34.50000000000004, 45.5, 43.50000000000001, 41.500000000000014, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 25.29999999999992, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.70000000000001, 43.900000000000006, 44.7, 40.30000000000002, -50.00000000000044, 41.30000000000001, 14.699999999999768, 11.899999999999729, -50.00000000000044, 32.90000000000003, 42.900000000000006, 42.70000000000001, 26.299999999999933], "episode_lengths": [44, 232, 356, 500, 500, 346, 164, 160, 160, 78, 424, 464, 500, 66, 52, 500, 50, 456, 500, 72, 500, 88, 48, 330, 166, 76, 92, 500, 270, 468, 108, 500, 500, 500, 90, 500, 500, 92, 500, 66, 500, 222, 70, 52, 70, 152, 60, 500, 500, 500, 62, 500, 500, 94, 194, 40, 500, 260, 186, 500, 52, 500, 500, 246, 500, 104, 500, 64, 146, 136, 500, 40, 156, 46, 66, 86, 56, 500, 500, 500, 90, 248, 118, 500, 500, 500, 56, 74, 62, 54, 98, 500, 88, 354, 382, 500, 172, 72, 74, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3716296428637343, "mean_inference_ms": 1.1992137681951716, "mean_action_processing_ms": 0.1399018907297416, "mean_env_wait_ms": 0.08156120418644662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029999256134033203, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.11898040771484375}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.207999999999827, "episode_len_mean": 268.58, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 26.89999999999994, 14.499999999999766, -50.00000000000044, -50.00000000000044, 15.49999999999978, 33.70000000000004, 34.10000000000004, 34.10000000000004, 42.30000000000001, 7.699999999999669, 3.699999999999612, -50.00000000000044, 43.50000000000001, 44.900000000000006, -50.00000000000044, 45.1, 4.499999999999623, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.30000000000001, 45.3, 17.099999999999802, 33.500000000000036, 42.500000000000014, 40.90000000000002, -50.00000000000044, 23.099999999999888, 3.2999999999996064, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 27.899999999999956, 43.10000000000001, 44.900000000000006, 43.10000000000001, 34.900000000000034, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 30.699999999999996, 46.099999999999994, -50.00000000000044, 24.099999999999902, 31.500000000000007, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.7, 35.500000000000036, 36.50000000000003, -50.00000000000044, 46.099999999999994, 34.50000000000004, 45.5, 43.50000000000001, 41.500000000000014, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 25.29999999999992, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.70000000000001, 43.900000000000006, 44.7, 40.30000000000002, -50.00000000000044, 41.30000000000001, 14.699999999999768, 11.899999999999729, -50.00000000000044, 32.90000000000003, 42.900000000000006, 42.70000000000001, 26.299999999999933], "episode_lengths": [44, 232, 356, 500, 500, 346, 164, 160, 160, 78, 424, 464, 500, 66, 52, 500, 50, 456, 500, 72, 500, 88, 48, 330, 166, 76, 92, 500, 270, 468, 108, 500, 500, 500, 90, 500, 500, 92, 500, 66, 500, 222, 70, 52, 70, 152, 60, 500, 500, 500, 62, 500, 500, 94, 194, 40, 500, 260, 186, 500, 52, 500, 500, 246, 500, 104, 500, 64, 146, 136, 500, 40, 156, 46, 66, 86, 56, 500, 500, 500, 90, 248, 118, 500, 500, 500, 56, 74, 62, 54, 98, 500, 88, 354, 382, 500, 172, 72, 74, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3716296428637343, "mean_inference_ms": 1.1992137681951716, "mean_action_processing_ms": 0.1399018907297416, "mean_env_wait_ms": 0.08156120418644662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029999256134033203, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.11898040771484375}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5535.053974081883, "num_env_steps_trained_throughput_per_sec": 5535.053974081883, "timesteps_total": 180000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3349.851, "sample_time_ms": 2850.04, "load_time_ms": 18.705, "load_throughput": 962304.101, "learn_time_ms": 469.414, "learn_throughput": 38345.714, "synch_weights_time_ms": 9.691}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 614, "training_iteration": 10, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-06", "timestamp": 1698248226, "time_this_iter_s": 3.258000373840332, "time_total_s": 33.56549072265625, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 33.56549072265625, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 53.05999999999999, "ram_util_percent": 26.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531249999999993, "cur_lr": 0.0003, "total_loss": 7.3160490565829805, "policy_loss": -0.0005042359232902526, "vf_loss": 7.3166117668151855, "vf_explained_var": -2.8212865193684897e-06, "kl": 0.001328465466430215, "entropy": 0.5877090136210124, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.048999999999875, "episode_len_mean": 225.24, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.5, 42.70000000000001, 43.900000000000006, 44.7, 40.30000000000002, -50.00000000000044, 41.30000000000001, 14.699999999999768, 11.899999999999729, -50.00000000000044, 32.90000000000003, 42.900000000000006, 42.70000000000001, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.30000000000001, 35.900000000000034, -50.00000000000044, 34.10000000000004, 42.70000000000001, -50.00000000000044, 16.699999999999797, -50.00000000000044, 45.7, 29.899999999999984, 47.1, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, 16.29999999999979, 31.70000000000001, -50.00000000000044, 46.699999999999996, 36.70000000000003, 45.3, 45.1, -50.00000000000044, 34.30000000000004, 45.3, 30.099999999999987, 37.300000000000026, 40.500000000000014, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.500000000000014, 38.700000000000024, 44.5, 40.500000000000014, 42.30000000000001, -50.00000000000044, 46.699999999999996, 45.3, 40.90000000000002, 22.299999999999876, 44.900000000000006, 38.10000000000002, 44.7, 31.500000000000007, 38.700000000000024, 39.90000000000002, 36.900000000000034, 7.09999999999966, 28.29999999999996, 44.7, 40.90000000000002, 41.100000000000016, -50.00000000000044, 34.30000000000004, 38.10000000000002, 25.099999999999916, -50.00000000000044, 34.900000000000034, -50.00000000000044, 41.70000000000002, -50.00000000000044, 34.70000000000004, 25.699999999999925, 39.300000000000026, -50.00000000000044, 33.90000000000004, 40.10000000000002, 43.50000000000001, 45.7], "episode_lengths": [500, 500, 56, 74, 62, 54, 98, 500, 88, 354, 382, 500, 172, 72, 74, 238, 500, 500, 500, 86, 78, 142, 500, 160, 74, 500, 334, 500, 44, 202, 30, 500, 38, 80, 500, 500, 500, 58, 500, 124, 500, 500, 58, 86, 338, 184, 500, 34, 134, 48, 50, 500, 158, 48, 200, 128, 96, 62, 500, 500, 68, 76, 114, 56, 96, 78, 500, 34, 48, 92, 278, 52, 120, 54, 186, 114, 102, 132, 430, 218, 54, 92, 90, 500, 158, 120, 250, 500, 152, 500, 84, 500, 154, 244, 108, 500, 162, 100, 66, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3715029303685081, "mean_inference_ms": 1.1969356064213674, "mean_action_processing_ms": 0.13988855597449185, "mean_env_wait_ms": 0.08113763851645306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998498916625977, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.1100156307220459}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.048999999999875, "episode_len_mean": 225.24, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.5, 42.70000000000001, 43.900000000000006, 44.7, 40.30000000000002, -50.00000000000044, 41.30000000000001, 14.699999999999768, 11.899999999999729, -50.00000000000044, 32.90000000000003, 42.900000000000006, 42.70000000000001, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.30000000000001, 35.900000000000034, -50.00000000000044, 34.10000000000004, 42.70000000000001, -50.00000000000044, 16.699999999999797, -50.00000000000044, 45.7, 29.899999999999984, 47.1, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, 16.29999999999979, 31.70000000000001, -50.00000000000044, 46.699999999999996, 36.70000000000003, 45.3, 45.1, -50.00000000000044, 34.30000000000004, 45.3, 30.099999999999987, 37.300000000000026, 40.500000000000014, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.500000000000014, 38.700000000000024, 44.5, 40.500000000000014, 42.30000000000001, -50.00000000000044, 46.699999999999996, 45.3, 40.90000000000002, 22.299999999999876, 44.900000000000006, 38.10000000000002, 44.7, 31.500000000000007, 38.700000000000024, 39.90000000000002, 36.900000000000034, 7.09999999999966, 28.29999999999996, 44.7, 40.90000000000002, 41.100000000000016, -50.00000000000044, 34.30000000000004, 38.10000000000002, 25.099999999999916, -50.00000000000044, 34.900000000000034, -50.00000000000044, 41.70000000000002, -50.00000000000044, 34.70000000000004, 25.699999999999925, 39.300000000000026, -50.00000000000044, 33.90000000000004, 40.10000000000002, 43.50000000000001, 45.7], "episode_lengths": [500, 500, 56, 74, 62, 54, 98, 500, 88, 354, 382, 500, 172, 72, 74, 238, 500, 500, 500, 86, 78, 142, 500, 160, 74, 500, 334, 500, 44, 202, 30, 500, 38, 80, 500, 500, 500, 58, 500, 124, 500, 500, 58, 86, 338, 184, 500, 34, 134, 48, 50, 500, 158, 48, 200, 128, 96, 62, 500, 500, 68, 76, 114, 56, 96, 78, 500, 34, 48, 92, 278, 52, 120, 54, 186, 114, 102, 132, 430, 218, 54, 92, 90, 500, 158, 120, 250, 500, 152, 500, 84, 500, 154, 244, 108, 500, 162, 100, 66, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3715029303685081, "mean_inference_ms": 1.1969356064213674, "mean_action_processing_ms": 0.13988855597449185, "mean_env_wait_ms": 0.08113763851645306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998498916625977, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.1100156307220459}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5441.406308278602, "num_env_steps_trained_throughput_per_sec": 5441.406308278602, "timesteps_total": 198000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 198000, "timers": {"training_iteration_time_ms": 3359.847, "sample_time_ms": 2841.036, "load_time_ms": 20.005, "load_throughput": 899769.175, "learn_time_ms": 487.317, "learn_throughput": 36936.97, "synch_weights_time_ms": 9.588}, "counters": {"num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "done": false, "episodes_total": 698, "training_iteration": 11, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-09", "timestamp": 1698248229, "time_this_iter_s": 3.313966989517212, "time_total_s": 36.87945771217346, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 36.87945771217346, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 63.025, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765624999999996e-05, "cur_lr": 0.0003, "total_loss": 6.882964049445258, "policy_loss": -0.0006984460684988234, "vf_loss": 6.883716424306233, "vf_explained_var": -2.215968237982856e-06, "kl": 0.0009942364427974186, "entropy": 0.5396120892630683, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.32799999999985, "episode_len_mean": 247.4, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, 22.299999999999876, 44.900000000000006, 38.10000000000002, 44.7, 31.500000000000007, 38.700000000000024, 39.90000000000002, 36.900000000000034, 7.09999999999966, 28.29999999999996, 44.7, 40.90000000000002, 41.100000000000016, -50.00000000000044, 34.30000000000004, 38.10000000000002, 25.099999999999916, -50.00000000000044, 34.900000000000034, -50.00000000000044, 41.70000000000002, -50.00000000000044, 34.70000000000004, 25.699999999999925, 39.300000000000026, -50.00000000000044, 33.90000000000004, 40.10000000000002, 43.50000000000001, 45.7, -50.00000000000044, 13.499999999999751, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.499999999999964, 45.3, 38.10000000000002, 42.500000000000014, -50.00000000000044, 41.90000000000001, 41.100000000000016, 43.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 34.10000000000004, 28.499999999999964, 38.300000000000026, 28.89999999999997, -50.00000000000044, 19.69999999999984, 11.29999999999972, 40.90000000000002, 38.300000000000026, 44.5, 39.70000000000002, 45.1, -50.00000000000044, 43.7, 32.700000000000024, 43.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 29.49999999999998, 42.70000000000001, 43.10000000000001, 35.70000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, 44.7, 21.89999999999987], "episode_lengths": [92, 278, 52, 120, 54, 186, 114, 102, 132, 430, 218, 54, 92, 90, 500, 158, 120, 250, 500, 152, 500, 84, 500, 154, 244, 108, 500, 162, 100, 66, 44, 500, 366, 500, 500, 500, 68, 500, 500, 52, 500, 500, 52, 500, 216, 48, 120, 76, 500, 82, 90, 62, 92, 500, 500, 146, 500, 500, 112, 500, 108, 500, 500, 46, 500, 106, 500, 500, 62, 160, 216, 118, 212, 500, 304, 388, 92, 118, 56, 104, 50, 500, 64, 174, 62, 74, 500, 500, 206, 74, 70, 144, 34, 500, 500, 68, 500, 56, 54, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37194128279982425, "mean_inference_ms": 1.1951665000168368, "mean_action_processing_ms": 0.13965153787539375, "mean_env_wait_ms": 0.08117873017486418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031989336013793945, "StateBufferConnector_ms": 0.004998683929443359, "ViewRequirementAgentConnector_ms": 0.1369948387145996}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.32799999999985, "episode_len_mean": 247.4, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, 22.299999999999876, 44.900000000000006, 38.10000000000002, 44.7, 31.500000000000007, 38.700000000000024, 39.90000000000002, 36.900000000000034, 7.09999999999966, 28.29999999999996, 44.7, 40.90000000000002, 41.100000000000016, -50.00000000000044, 34.30000000000004, 38.10000000000002, 25.099999999999916, -50.00000000000044, 34.900000000000034, -50.00000000000044, 41.70000000000002, -50.00000000000044, 34.70000000000004, 25.699999999999925, 39.300000000000026, -50.00000000000044, 33.90000000000004, 40.10000000000002, 43.50000000000001, 45.7, -50.00000000000044, 13.499999999999751, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.499999999999964, 45.3, 38.10000000000002, 42.500000000000014, -50.00000000000044, 41.90000000000001, 41.100000000000016, 43.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 34.10000000000004, 28.499999999999964, 38.300000000000026, 28.89999999999997, -50.00000000000044, 19.69999999999984, 11.29999999999972, 40.90000000000002, 38.300000000000026, 44.5, 39.70000000000002, 45.1, -50.00000000000044, 43.7, 32.700000000000024, 43.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 29.49999999999998, 42.70000000000001, 43.10000000000001, 35.70000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, 44.7, 21.89999999999987], "episode_lengths": [92, 278, 52, 120, 54, 186, 114, 102, 132, 430, 218, 54, 92, 90, 500, 158, 120, 250, 500, 152, 500, 84, 500, 154, 244, 108, 500, 162, 100, 66, 44, 500, 366, 500, 500, 500, 68, 500, 500, 52, 500, 500, 52, 500, 216, 48, 120, 76, 500, 82, 90, 62, 92, 500, 500, 146, 500, 500, 112, 500, 108, 500, 500, 46, 500, 106, 500, 500, 62, 160, 216, 118, 212, 500, 304, 388, 92, 118, 56, 104, 50, 500, 64, 174, 62, 74, 500, 500, 206, 74, 70, 144, 34, 500, 500, 68, 500, 56, 54, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37194128279982425, "mean_inference_ms": 1.1951665000168368, "mean_action_processing_ms": 0.13965153787539375, "mean_env_wait_ms": 0.08117873017486418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031989336013793945, "StateBufferConnector_ms": 0.004998683929443359, "ViewRequirementAgentConnector_ms": 0.1369948387145996}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5536.753171492408, "num_env_steps_trained_throughput_per_sec": 5536.753171492408, "timesteps_total": 216000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3331.947, "sample_time_ms": 2818.536, "load_time_ms": 19.002, "load_throughput": 947252.837, "learn_time_ms": 483.019, "learn_throughput": 37265.577, "synch_weights_time_ms": 9.688}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 767, "training_iteration": 12, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-12", "timestamp": 1698248232, "time_this_iter_s": 3.257000684738159, "time_total_s": 40.13645839691162, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 40.13645839691162, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 53.61999999999999, "ram_util_percent": 26.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812499999998e-05, "cur_lr": 0.0003, "total_loss": 6.944882000817193, "policy_loss": -9.097572829988267e-05, "vf_loss": 6.945029237535265, "vf_explained_var": 5.03328111436632e-07, "kl": 0.00036718123981608464, "entropy": 0.5632133901119232, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.35499999999985, "episode_len_mean": 242.14, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.499999999999964, 38.300000000000026, 28.89999999999997, -50.00000000000044, 19.69999999999984, 11.29999999999972, 40.90000000000002, 38.300000000000026, 44.5, 39.70000000000002, 45.1, -50.00000000000044, 43.7, 32.700000000000024, 43.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 29.49999999999998, 42.70000000000001, 43.10000000000001, 35.70000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, 44.7, 21.89999999999987, -50.00000000000044, 41.70000000000002, 38.10000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 4.499999999999623, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 41.90000000000001, 24.499999999999908, -50.00000000000044, 43.900000000000006, 40.500000000000014, 44.5, 45.9, 45.9, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 37.10000000000003, 26.299999999999933, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 26.89999999999994, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.3, 45.7, 37.10000000000003, 30.29999999999999, 30.499999999999993, 41.100000000000016, 39.90000000000002, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 30.29999999999999, 42.900000000000006, 39.90000000000002, -50.00000000000044, 45.7, 11.499999999999723, 46.3, 44.10000000000001, 45.5, 40.500000000000014, 42.900000000000006, 34.30000000000004, 28.29999999999996, 26.499999999999936, 38.10000000000002, -50.00000000000044], "episode_lengths": [216, 118, 212, 500, 304, 388, 92, 118, 56, 104, 50, 500, 64, 174, 62, 74, 500, 500, 206, 74, 70, 144, 34, 500, 500, 68, 500, 56, 54, 282, 500, 84, 120, 168, 500, 500, 70, 456, 500, 500, 500, 70, 86, 500, 500, 82, 256, 500, 62, 96, 56, 42, 42, 500, 500, 232, 500, 500, 500, 80, 130, 238, 42, 500, 500, 48, 232, 500, 144, 500, 38, 44, 130, 198, 196, 90, 102, 46, 500, 102, 500, 500, 66, 500, 198, 72, 102, 500, 44, 386, 38, 60, 46, 96, 72, 158, 218, 236, 120, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37077113960518154, "mean_inference_ms": 1.193928753432607, "mean_action_processing_ms": 0.1393500483240448, "mean_env_wait_ms": 0.08087564575777029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023978471755981445, "StateBufferConnector_ms": 0.009500741958618164, "ViewRequirementAgentConnector_ms": 0.13300085067749023}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.35499999999985, "episode_len_mean": 242.14, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.499999999999964, 38.300000000000026, 28.89999999999997, -50.00000000000044, 19.69999999999984, 11.29999999999972, 40.90000000000002, 38.300000000000026, 44.5, 39.70000000000002, 45.1, -50.00000000000044, 43.7, 32.700000000000024, 43.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 29.49999999999998, 42.70000000000001, 43.10000000000001, 35.70000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, 44.7, 21.89999999999987, -50.00000000000044, 41.70000000000002, 38.10000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 4.499999999999623, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 41.90000000000001, 24.499999999999908, -50.00000000000044, 43.900000000000006, 40.500000000000014, 44.5, 45.9, 45.9, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 37.10000000000003, 26.299999999999933, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 26.89999999999994, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.3, 45.7, 37.10000000000003, 30.29999999999999, 30.499999999999993, 41.100000000000016, 39.90000000000002, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 30.29999999999999, 42.900000000000006, 39.90000000000002, -50.00000000000044, 45.7, 11.499999999999723, 46.3, 44.10000000000001, 45.5, 40.500000000000014, 42.900000000000006, 34.30000000000004, 28.29999999999996, 26.499999999999936, 38.10000000000002, -50.00000000000044], "episode_lengths": [216, 118, 212, 500, 304, 388, 92, 118, 56, 104, 50, 500, 64, 174, 62, 74, 500, 500, 206, 74, 70, 144, 34, 500, 500, 68, 500, 56, 54, 282, 500, 84, 120, 168, 500, 500, 70, 456, 500, 500, 500, 70, 86, 500, 500, 82, 256, 500, 62, 96, 56, 42, 42, 500, 500, 232, 500, 500, 500, 80, 130, 238, 42, 500, 500, 48, 232, 500, 144, 500, 38, 44, 130, 198, 196, 90, 102, 46, 500, 102, 500, 500, 66, 500, 198, 72, 102, 500, 44, 386, 38, 60, 46, 96, 72, 158, 218, 236, 120, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37077113960518154, "mean_inference_ms": 1.193928753432607, "mean_action_processing_ms": 0.1393500483240448, "mean_env_wait_ms": 0.08087564575777029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023978471755981445, "StateBufferConnector_ms": 0.009500741958618164, "ViewRequirementAgentConnector_ms": 0.13300085067749023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5366.720428078172, "num_env_steps_trained_throughput_per_sec": 5366.720428078172, "timesteps_total": 234000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 234000, "timers": {"training_iteration_time_ms": 3327.25, "sample_time_ms": 2818.037, "load_time_ms": 19.902, "load_throughput": 904418.044, "learn_time_ms": 478.026, "learn_throughput": 37654.853, "synch_weights_time_ms": 9.485}, "counters": {"num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "done": false, "episodes_total": 837, "training_iteration": 13, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-16", "timestamp": 1698248236, "time_this_iter_s": 3.360999822616577, "time_total_s": 43.4974582195282, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 43.4974582195282, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 54.52, "ram_util_percent": 26.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.441406249999999e-05, "cur_lr": 0.0003, "total_loss": 7.091846232944064, "policy_loss": -0.0009664965172608693, "vf_loss": 7.09287166595459, "vf_explained_var": -1.0848045349121093e-06, "kl": 0.0017430111144802949, "entropy": 0.589137511783176, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 608.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.601999999999862, "episode_len_mean": 234.7, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.29999999999999, 30.499999999999993, 41.100000000000016, 39.90000000000002, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 30.29999999999999, 42.900000000000006, 39.90000000000002, -50.00000000000044, 45.7, 11.499999999999723, 46.3, 44.10000000000001, 45.5, 40.500000000000014, 42.900000000000006, 34.30000000000004, 28.29999999999996, 26.499999999999936, 38.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 14.299999999999763, -50.00000000000044, 28.499999999999964, 38.300000000000026, 4.299999999999621, 41.100000000000016, -50.00000000000044, 38.50000000000003, -50.00000000000044, 32.90000000000003, 42.30000000000001, 43.7, 37.300000000000026, 45.9, 41.30000000000001, 39.70000000000002, 39.300000000000026, 41.90000000000001, 45.1, 37.90000000000003, 45.3, 39.70000000000002, 35.500000000000036, -50.00000000000044, 31.300000000000004, 41.100000000000016, 35.10000000000004, 26.69999999999994, -50.00000000000044, 44.300000000000004, -50.00000000000044, 5.6999999999996405, 25.899999999999928, 41.90000000000001, 45.3, 28.699999999999967, -50.00000000000044, 44.7, 38.10000000000002, 38.50000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 42.70000000000001, 43.30000000000001, 44.7, 40.10000000000002, 43.10000000000001, -50.00000000000044, 43.10000000000001, 42.10000000000001, 38.50000000000003, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 0.2999999999995637, 41.30000000000001], "episode_lengths": [198, 196, 90, 102, 46, 500, 102, 500, 500, 66, 500, 198, 72, 102, 500, 44, 386, 38, 60, 46, 96, 72, 158, 218, 236, 120, 500, 500, 60, 358, 500, 216, 118, 458, 90, 500, 116, 500, 172, 78, 64, 128, 42, 88, 104, 108, 82, 50, 122, 48, 104, 146, 500, 188, 90, 150, 234, 500, 58, 500, 444, 242, 82, 48, 214, 500, 54, 120, 116, 74, 500, 500, 42, 500, 136, 500, 500, 500, 170, 500, 500, 500, 230, 74, 68, 54, 100, 70, 500, 70, 80, 116, 500, 42, 500, 500, 500, 120, 498, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3714113597635271, "mean_inference_ms": 1.1957023491336236, "mean_action_processing_ms": 0.13956551493636482, "mean_env_wait_ms": 0.08094842690936004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02198505401611328, "StateBufferConnector_ms": 0.008504629135131836, "ViewRequirementAgentConnector_ms": 0.12027215957641602}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.601999999999862, "episode_len_mean": 234.7, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.29999999999999, 30.499999999999993, 41.100000000000016, 39.90000000000002, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 30.29999999999999, 42.900000000000006, 39.90000000000002, -50.00000000000044, 45.7, 11.499999999999723, 46.3, 44.10000000000001, 45.5, 40.500000000000014, 42.900000000000006, 34.30000000000004, 28.29999999999996, 26.499999999999936, 38.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 14.299999999999763, -50.00000000000044, 28.499999999999964, 38.300000000000026, 4.299999999999621, 41.100000000000016, -50.00000000000044, 38.50000000000003, -50.00000000000044, 32.90000000000003, 42.30000000000001, 43.7, 37.300000000000026, 45.9, 41.30000000000001, 39.70000000000002, 39.300000000000026, 41.90000000000001, 45.1, 37.90000000000003, 45.3, 39.70000000000002, 35.500000000000036, -50.00000000000044, 31.300000000000004, 41.100000000000016, 35.10000000000004, 26.69999999999994, -50.00000000000044, 44.300000000000004, -50.00000000000044, 5.6999999999996405, 25.899999999999928, 41.90000000000001, 45.3, 28.699999999999967, -50.00000000000044, 44.7, 38.10000000000002, 38.50000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 42.70000000000001, 43.30000000000001, 44.7, 40.10000000000002, 43.10000000000001, -50.00000000000044, 43.10000000000001, 42.10000000000001, 38.50000000000003, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 0.2999999999995637, 41.30000000000001], "episode_lengths": [198, 196, 90, 102, 46, 500, 102, 500, 500, 66, 500, 198, 72, 102, 500, 44, 386, 38, 60, 46, 96, 72, 158, 218, 236, 120, 500, 500, 60, 358, 500, 216, 118, 458, 90, 500, 116, 500, 172, 78, 64, 128, 42, 88, 104, 108, 82, 50, 122, 48, 104, 146, 500, 188, 90, 150, 234, 500, 58, 500, 444, 242, 82, 48, 214, 500, 54, 120, 116, 74, 500, 500, 42, 500, 136, 500, 500, 500, 170, 500, 500, 500, 230, 74, 68, 54, 100, 70, 500, 70, 80, 116, 500, 42, 500, 500, 500, 120, 498, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3714113597635271, "mean_inference_ms": 1.1957023491336236, "mean_action_processing_ms": 0.13956551493636482, "mean_env_wait_ms": 0.08094842690936004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02198505401611328, "StateBufferConnector_ms": 0.008504629135131836, "ViewRequirementAgentConnector_ms": 0.12027215957641602}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5231.07266979262, "num_env_steps_trained_throughput_per_sec": 5231.07266979262, "timesteps_total": 252000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3335.747, "sample_time_ms": 2826.933, "load_time_ms": 19.402, "load_throughput": 927721.011, "learn_time_ms": 477.725, "learn_throughput": 37678.55, "synch_weights_time_ms": 9.985}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 910, "training_iteration": 14, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-19", "timestamp": 1698248239, "time_this_iter_s": 3.4479706287384033, "time_total_s": 46.9454288482666, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 46.9454288482666, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 58.28000000000001, "ram_util_percent": 26.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031249999996e-05, "cur_lr": 0.0003, "total_loss": 6.47185910542806, "policy_loss": -0.0005965587165620592, "vf_loss": 6.472507413228353, "vf_explained_var": -6.331337822808159e-07, "kl": 0.001606255585449803, "entropy": 0.5176699135038588, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9049999999998146, "episode_len_mean": 276.54, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.899999999999928, 41.90000000000001, 45.3, 28.699999999999967, -50.00000000000044, 44.7, 38.10000000000002, 38.50000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 42.70000000000001, 43.30000000000001, 44.7, 40.10000000000002, 43.10000000000001, -50.00000000000044, 43.10000000000001, 42.10000000000001, 38.50000000000003, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 0.2999999999995637, 41.30000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 38.700000000000024, 40.10000000000002, 36.900000000000034, 42.900000000000006, 30.29999999999999, -50.00000000000044, 32.50000000000002, 39.10000000000002, 43.50000000000001, 38.700000000000024, -50.00000000000044, 36.30000000000003, 16.09999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 39.90000000000002, 37.10000000000003, -50.00000000000044, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 34.10000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 8.899999999999686, 41.100000000000016, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 36.30000000000003, 24.69999999999991, -50.00000000000044, 45.5, 39.50000000000002, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, -50.00000000000044], "episode_lengths": [242, 82, 48, 214, 500, 54, 120, 116, 74, 500, 500, 42, 500, 136, 500, 500, 500, 170, 500, 500, 500, 230, 74, 68, 54, 100, 70, 500, 70, 80, 116, 500, 42, 500, 500, 500, 120, 498, 88, 500, 176, 500, 500, 114, 100, 132, 72, 198, 500, 176, 110, 66, 114, 500, 138, 340, 500, 500, 500, 110, 500, 102, 130, 500, 38, 68, 500, 500, 160, 78, 500, 500, 86, 412, 90, 106, 500, 500, 500, 58, 62, 500, 64, 500, 138, 254, 500, 46, 106, 96, 500, 500, 58, 500, 110, 500, 500, 66, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3724425713252021, "mean_inference_ms": 1.2008546616479487, "mean_action_processing_ms": 0.13977756707864672, "mean_env_wait_ms": 0.08086978012202022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0269925594329834, "StateBufferConnector_ms": 0.006020069122314453, "ViewRequirementAgentConnector_ms": 0.12624096870422363}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9049999999998146, "episode_len_mean": 276.54, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.899999999999928, 41.90000000000001, 45.3, 28.699999999999967, -50.00000000000044, 44.7, 38.10000000000002, 38.50000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 42.70000000000001, 43.30000000000001, 44.7, 40.10000000000002, 43.10000000000001, -50.00000000000044, 43.10000000000001, 42.10000000000001, 38.50000000000003, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 0.2999999999995637, 41.30000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 38.700000000000024, 40.10000000000002, 36.900000000000034, 42.900000000000006, 30.29999999999999, -50.00000000000044, 32.50000000000002, 39.10000000000002, 43.50000000000001, 38.700000000000024, -50.00000000000044, 36.30000000000003, 16.09999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 39.90000000000002, 37.10000000000003, -50.00000000000044, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 34.10000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 8.899999999999686, 41.100000000000016, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 36.30000000000003, 24.69999999999991, -50.00000000000044, 45.5, 39.50000000000002, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, -50.00000000000044], "episode_lengths": [242, 82, 48, 214, 500, 54, 120, 116, 74, 500, 500, 42, 500, 136, 500, 500, 500, 170, 500, 500, 500, 230, 74, 68, 54, 100, 70, 500, 70, 80, 116, 500, 42, 500, 500, 500, 120, 498, 88, 500, 176, 500, 500, 114, 100, 132, 72, 198, 500, 176, 110, 66, 114, 500, 138, 340, 500, 500, 500, 110, 500, 102, 130, 500, 38, 68, 500, 500, 160, 78, 500, 500, 86, 412, 90, 106, 500, 500, 500, 58, 62, 500, 64, 500, 138, 254, 500, 46, 106, 96, 500, 500, 58, 500, 110, 500, 500, 66, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3724425713252021, "mean_inference_ms": 1.2008546616479487, "mean_action_processing_ms": 0.13977756707864672, "mean_env_wait_ms": 0.08086978012202022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0269925594329834, "StateBufferConnector_ms": 0.006020069122314453, "ViewRequirementAgentConnector_ms": 0.12624096870422363}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5514.751504646242, "num_env_steps_trained_throughput_per_sec": 5514.751504646242, "timesteps_total": 270000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 3313.545, "sample_time_ms": 2824.231, "load_time_ms": 19.002, "load_throughput": 947245.706, "learn_time_ms": 458.729, "learn_throughput": 39238.861, "synch_weights_time_ms": 9.881}, "counters": {"num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 971, "training_iteration": 15, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-22", "timestamp": 1698248242, "time_this_iter_s": 3.270970582962036, "time_total_s": 50.21639943122864, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 50.21639943122864, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 69.175, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515624999998e-06, "cur_lr": 0.0003, "total_loss": 6.609179083506266, "policy_loss": -0.0003092575404379103, "vf_loss": 6.609536382887098, "vf_explained_var": -1.789463890923394e-06, "kl": 0.0011460012624780803, "entropy": 0.47975842687818737, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 698.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.64399999999981, "episode_len_mean": 264.14, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 36.30000000000003, 24.69999999999991, -50.00000000000044, 45.5, 39.50000000000002, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, -50.00000000000044, 37.50000000000003, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, 41.30000000000001, -50.00000000000044, 45.9, 47.1, -50.00000000000044, -50.00000000000044, 46.3, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.900000000000006, 45.5, 43.50000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.699999999999996, 38.90000000000002, -50.00000000000044, 46.099999999999994, 10.899999999999714, 20.49999999999985, 42.900000000000006, 37.10000000000003, -50.00000000000044, 45.9, 39.70000000000002, 47.1, 41.30000000000001, 47.1, 44.7, 41.70000000000002, 45.9, 44.10000000000001, 26.499999999999936, 43.900000000000006, 40.10000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, 13.499999999999751, 42.500000000000014, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 42.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, 41.100000000000016, 37.70000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 58, 62, 500, 64, 500, 138, 254, 500, 46, 106, 96, 500, 500, 58, 500, 110, 500, 500, 66, 72, 500, 126, 40, 500, 50, 500, 88, 500, 42, 30, 500, 500, 38, 130, 500, 500, 500, 68, 72, 46, 66, 500, 58, 500, 500, 500, 500, 500, 78, 500, 500, 500, 50, 34, 112, 500, 40, 392, 296, 72, 130, 500, 42, 104, 30, 88, 30, 54, 84, 42, 60, 236, 62, 100, 84, 500, 500, 366, 76, 500, 82, 58, 500, 80, 40, 500, 500, 38, 90, 124, 46, 500, 500, 500, 210, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37927413284129974, "mean_inference_ms": 1.2208815915396105, "mean_action_processing_ms": 0.1413878792836363, "mean_env_wait_ms": 0.08270060672144508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03398466110229492, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.13898825645446777}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.64399999999981, "episode_len_mean": 264.14, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 36.30000000000003, 24.69999999999991, -50.00000000000044, 45.5, 39.50000000000002, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, -50.00000000000044, 37.50000000000003, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, 41.30000000000001, -50.00000000000044, 45.9, 47.1, -50.00000000000044, -50.00000000000044, 46.3, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.900000000000006, 45.5, 43.50000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.699999999999996, 38.90000000000002, -50.00000000000044, 46.099999999999994, 10.899999999999714, 20.49999999999985, 42.900000000000006, 37.10000000000003, -50.00000000000044, 45.9, 39.70000000000002, 47.1, 41.30000000000001, 47.1, 44.7, 41.70000000000002, 45.9, 44.10000000000001, 26.499999999999936, 43.900000000000006, 40.10000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, 13.499999999999751, 42.500000000000014, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 42.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, 41.100000000000016, 37.70000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 58, 62, 500, 64, 500, 138, 254, 500, 46, 106, 96, 500, 500, 58, 500, 110, 500, 500, 66, 72, 500, 126, 40, 500, 50, 500, 88, 500, 42, 30, 500, 500, 38, 130, 500, 500, 500, 68, 72, 46, 66, 500, 58, 500, 500, 500, 500, 500, 78, 500, 500, 500, 50, 34, 112, 500, 40, 392, 296, 72, 130, 500, 42, 104, 30, 88, 30, 54, 84, 42, 60, 236, 62, 100, 84, 500, 500, 366, 76, 500, 82, 58, 500, 80, 40, 500, 500, 38, 90, 124, 46, 500, 500, 500, 210, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37927413284129974, "mean_inference_ms": 1.2208815915396105, "mean_action_processing_ms": 0.1413878792836363, "mean_env_wait_ms": 0.08270060672144508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03398466110229492, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.13898825645446777}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4468.750578959341, "num_env_steps_trained_throughput_per_sec": 4468.750578959341, "timesteps_total": 288000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 3373.742, "sample_time_ms": 2906.427, "load_time_ms": 17.802, "load_throughput": 1011097.969, "learn_time_ms": 437.829, "learn_throughput": 41111.928, "synch_weights_time_ms": 9.881}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1047, "training_iteration": 16, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-26", "timestamp": 1698248246, "time_this_iter_s": 4.034966707229614, "time_total_s": 54.25136613845825, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 54.25136613845825, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 74.33333333333333, "ram_util_percent": 26.683333333333326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.051757812499999e-06, "cur_lr": 0.0003, "total_loss": 6.431312221950955, "policy_loss": -0.001038730392853419, "vf_loss": 6.432396782769097, "vf_explained_var": -1.1192427741156684e-06, "kl": 0.0013150821490455656, "entropy": 0.45814462966389125, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.860999999999816, "episode_len_mean": 257.0, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, 37.10000000000003, -50.00000000000044, 45.9, 39.70000000000002, 47.1, 41.30000000000001, 47.1, 44.7, 41.70000000000002, 45.9, 44.10000000000001, 26.499999999999936, 43.900000000000006, 40.10000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, 13.499999999999751, 42.500000000000014, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 42.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, 41.100000000000016, 37.70000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 38.300000000000026, 46.099999999999994, 39.300000000000026, 43.30000000000001, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 3.499999999999609, -50.00000000000044, 46.099999999999994, 44.10000000000001, 0.49999999999956657, 45.3, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.7, 42.30000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 35.900000000000034, 41.100000000000016, 47.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, 42.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 17.299999999999805, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [72, 130, 500, 42, 104, 30, 88, 30, 54, 84, 42, 60, 236, 62, 100, 84, 500, 500, 366, 76, 500, 82, 58, 500, 80, 40, 500, 500, 38, 90, 124, 46, 500, 500, 500, 210, 500, 500, 500, 68, 500, 60, 500, 500, 118, 500, 500, 500, 48, 118, 40, 108, 68, 50, 50, 500, 500, 466, 500, 40, 60, 496, 48, 274, 500, 500, 500, 50, 64, 78, 86, 500, 500, 142, 90, 28, 500, 500, 52, 44, 80, 44, 500, 500, 76, 328, 48, 44, 500, 500, 150, 500, 72, 500, 500, 40, 144, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3837748580880041, "mean_inference_ms": 1.235447197182873, "mean_action_processing_ms": 0.14287947544470683, "mean_env_wait_ms": 0.08392100670736641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699422836303711, "StateBufferConnector_ms": 0.00399470329284668, "ViewRequirementAgentConnector_ms": 0.14402270317077637}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.860999999999816, "episode_len_mean": 257.0, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, 37.10000000000003, -50.00000000000044, 45.9, 39.70000000000002, 47.1, 41.30000000000001, 47.1, 44.7, 41.70000000000002, 45.9, 44.10000000000001, 26.499999999999936, 43.900000000000006, 40.10000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, 13.499999999999751, 42.500000000000014, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 42.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, 41.100000000000016, 37.70000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 38.300000000000026, 46.099999999999994, 39.300000000000026, 43.30000000000001, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 3.499999999999609, -50.00000000000044, 46.099999999999994, 44.10000000000001, 0.49999999999956657, 45.3, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.7, 42.30000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 35.900000000000034, 41.100000000000016, 47.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, 42.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 17.299999999999805, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [72, 130, 500, 42, 104, 30, 88, 30, 54, 84, 42, 60, 236, 62, 100, 84, 500, 500, 366, 76, 500, 82, 58, 500, 80, 40, 500, 500, 38, 90, 124, 46, 500, 500, 500, 210, 500, 500, 500, 68, 500, 60, 500, 500, 118, 500, 500, 500, 48, 118, 40, 108, 68, 50, 50, 500, 500, 466, 500, 40, 60, 496, 48, 274, 500, 500, 500, 50, 64, 78, 86, 500, 500, 142, 90, 28, 500, 500, 52, 44, 80, 44, 500, 500, 76, 328, 48, 44, 500, 500, 150, 500, 72, 500, 500, 40, 144, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3837748580880041, "mean_inference_ms": 1.235447197182873, "mean_action_processing_ms": 0.14287947544470683, "mean_env_wait_ms": 0.08392100670736641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699422836303711, "StateBufferConnector_ms": 0.00399470329284668, "ViewRequirementAgentConnector_ms": 0.14402270317077637}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4531.680297076897, "num_env_steps_trained_throughput_per_sec": 4531.680297076897, "timesteps_total": 306000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 306000, "timers": {"training_iteration_time_ms": 3433.501, "sample_time_ms": 2953.791, "load_time_ms": 20.102, "load_throughput": 895424.784, "learn_time_ms": 447.924, "learn_throughput": 40185.355, "synch_weights_time_ms": 9.881}, "counters": {"num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "done": false, "episodes_total": 1109, "training_iteration": 17, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-30", "timestamp": 1698248250, "time_this_iter_s": 3.9790329933166504, "time_total_s": 58.2303991317749, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 58.2303991317749, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 76.14000000000001, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062499994e-06, "cur_lr": 0.0003, "total_loss": 7.014189306894938, "policy_loss": -0.00024494606380661327, "vf_loss": 7.014478778839111, "vf_explained_var": -2.035829755995009e-06, "kl": 0.000963688757125267, "entropy": 0.444902558459176, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 788.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.109999999999807, "episode_len_mean": 269.5, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, -50.00000000000044, -50.00000000000044, 35.900000000000034, 41.100000000000016, 47.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, 42.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 17.299999999999805, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 30.29999999999999, 36.70000000000003, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 29.099999999999973, 45.9, 9.699999999999697, 47.5, -50.00000000000044, 45.3, 43.50000000000001, -50.00000000000044, 25.499999999999922, 8.49999999999968, -50.00000000000044, 14.499999999999766, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.699999999999854, 46.5, 4.299999999999621, -50.00000000000044, 45.5, 46.5, 38.50000000000003, 45.5, 20.299999999999848, -50.00000000000044, 45.1, -50.00000000000044, 15.299999999999777, 43.50000000000001, 39.70000000000002, 45.5, 43.900000000000006, 32.50000000000002, 46.9, 40.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, -50.00000000000044, 46.5, 47.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 38.700000000000024, 40.90000000000002, -50.00000000000044, 44.10000000000001], "episode_lengths": [86, 500, 500, 142, 90, 28, 500, 500, 52, 44, 80, 44, 500, 500, 76, 328, 48, 44, 500, 500, 150, 500, 72, 500, 500, 40, 144, 500, 500, 500, 500, 500, 500, 76, 54, 42, 500, 50, 500, 198, 134, 106, 500, 500, 500, 98, 210, 42, 404, 26, 500, 48, 66, 500, 246, 416, 500, 356, 68, 500, 500, 500, 294, 36, 458, 500, 46, 36, 116, 46, 298, 500, 50, 500, 348, 66, 104, 46, 62, 176, 32, 100, 42, 500, 500, 500, 500, 40, 70, 500, 36, 24, 500, 50, 500, 500, 114, 92, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38801524270445453, "mean_inference_ms": 1.2498357326989895, "mean_action_processing_ms": 0.14567912520795942, "mean_env_wait_ms": 0.08514170010732242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030003070831298828, "StateBufferConnector_ms": 0.005987882614135742, "ViewRequirementAgentConnector_ms": 0.1620488166809082}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.109999999999807, "episode_len_mean": 269.5, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, -50.00000000000044, -50.00000000000044, 35.900000000000034, 41.100000000000016, 47.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, 42.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 17.299999999999805, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 30.29999999999999, 36.70000000000003, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 29.099999999999973, 45.9, 9.699999999999697, 47.5, -50.00000000000044, 45.3, 43.50000000000001, -50.00000000000044, 25.499999999999922, 8.49999999999968, -50.00000000000044, 14.499999999999766, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.699999999999854, 46.5, 4.299999999999621, -50.00000000000044, 45.5, 46.5, 38.50000000000003, 45.5, 20.299999999999848, -50.00000000000044, 45.1, -50.00000000000044, 15.299999999999777, 43.50000000000001, 39.70000000000002, 45.5, 43.900000000000006, 32.50000000000002, 46.9, 40.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, -50.00000000000044, 46.5, 47.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 38.700000000000024, 40.90000000000002, -50.00000000000044, 44.10000000000001], "episode_lengths": [86, 500, 500, 142, 90, 28, 500, 500, 52, 44, 80, 44, 500, 500, 76, 328, 48, 44, 500, 500, 150, 500, 72, 500, 500, 40, 144, 500, 500, 500, 500, 500, 500, 76, 54, 42, 500, 50, 500, 198, 134, 106, 500, 500, 500, 98, 210, 42, 404, 26, 500, 48, 66, 500, 246, 416, 500, 356, 68, 500, 500, 500, 294, 36, 458, 500, 46, 36, 116, 46, 298, 500, 50, 500, 348, 66, 104, 46, 62, 176, 32, 100, 42, 500, 500, 500, 500, 40, 70, 500, 36, 24, 500, 50, 500, 500, 114, 92, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38801524270445453, "mean_inference_ms": 1.2498357326989895, "mean_action_processing_ms": 0.14567912520795942, "mean_env_wait_ms": 0.08514170010732242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030003070831298828, "StateBufferConnector_ms": 0.005987882614135742, "ViewRequirementAgentConnector_ms": 0.1620488166809082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4614.2107659925805, "num_env_steps_trained_throughput_per_sec": 4614.2107659925805, "timesteps_total": 324000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 3504.592, "sample_time_ms": 3025.39, "load_time_ms": 20.502, "load_throughput": 877947.0, "learn_time_ms": 446.816, "learn_throughput": 40285.016, "synch_weights_time_ms": 9.882}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1179, "training_iteration": 18, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-34", "timestamp": 1698248254, "time_this_iter_s": 3.905989646911621, "time_total_s": 62.13638877868652, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 62.13638877868652, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 66.63333333333333, "ram_util_percent": 27.549999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531249997e-07, "cur_lr": 0.0003, "total_loss": 6.658036073048909, "policy_loss": -0.00010450867315133412, "vf_loss": 6.658190335167779, "vf_explained_var": -2.1113289727105036e-06, "kl": 0.0005547243381966006, "entropy": 0.4970983485380808, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.782999999999847, "episode_len_mean": 227.84, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, 40.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, -50.00000000000044, 46.5, 47.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 38.700000000000024, 40.90000000000002, -50.00000000000044, 44.10000000000001, 45.7, 47.3, -50.00000000000044, 37.300000000000026, 46.9, 46.5, -50.00000000000044, 41.100000000000016, 29.099999999999973, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.099999999999994, -50.00000000000044, 40.70000000000002, 40.500000000000014, -50.00000000000044, 24.299999999999905, 43.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.7, 46.5, 34.900000000000034, 45.5, 39.90000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.3, 44.900000000000006, 3.899999999999615, -50.00000000000044, 44.10000000000001, 42.30000000000001, 44.300000000000004, 20.099999999999845, -50.00000000000044, 44.10000000000001, 18.899999999999828, -50.00000000000044, 45.3, 20.699999999999854, 46.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 10.499999999999709, -50.00000000000044, 40.30000000000002, 45.1, 45.1, 43.900000000000006, 44.300000000000004, 30.699999999999996, 41.70000000000002, 42.500000000000014, 38.90000000000002, 34.30000000000004, -50.00000000000044, 38.10000000000002, 43.50000000000001, 46.699999999999996, -50.00000000000044, 41.30000000000001, 47.5, 47.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 37.300000000000026, 45.9, 45.1, 38.10000000000002], "episode_lengths": [32, 100, 42, 500, 500, 500, 500, 40, 70, 500, 36, 24, 500, 50, 500, 500, 114, 92, 500, 60, 44, 28, 500, 128, 32, 36, 500, 90, 210, 500, 500, 70, 40, 500, 94, 96, 500, 258, 64, 500, 500, 34, 24, 36, 152, 46, 102, 500, 74, 500, 500, 500, 54, 38, 52, 462, 500, 60, 78, 58, 300, 500, 60, 312, 500, 48, 294, 32, 500, 500, 42, 500, 396, 500, 98, 50, 50, 62, 58, 194, 84, 76, 112, 158, 500, 120, 66, 34, 500, 88, 26, 30, 500, 500, 34, 500, 128, 42, 50, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38765791879676414, "mean_inference_ms": 1.2516805325112355, "mean_action_processing_ms": 0.14579910701346116, "mean_env_wait_ms": 0.08569592144512729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023009061813354492, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.12299132347106934}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.782999999999847, "episode_len_mean": 227.84, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, 40.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, -50.00000000000044, 46.5, 47.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 38.700000000000024, 40.90000000000002, -50.00000000000044, 44.10000000000001, 45.7, 47.3, -50.00000000000044, 37.300000000000026, 46.9, 46.5, -50.00000000000044, 41.100000000000016, 29.099999999999973, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.099999999999994, -50.00000000000044, 40.70000000000002, 40.500000000000014, -50.00000000000044, 24.299999999999905, 43.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.7, 46.5, 34.900000000000034, 45.5, 39.90000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.3, 44.900000000000006, 3.899999999999615, -50.00000000000044, 44.10000000000001, 42.30000000000001, 44.300000000000004, 20.099999999999845, -50.00000000000044, 44.10000000000001, 18.899999999999828, -50.00000000000044, 45.3, 20.699999999999854, 46.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 10.499999999999709, -50.00000000000044, 40.30000000000002, 45.1, 45.1, 43.900000000000006, 44.300000000000004, 30.699999999999996, 41.70000000000002, 42.500000000000014, 38.90000000000002, 34.30000000000004, -50.00000000000044, 38.10000000000002, 43.50000000000001, 46.699999999999996, -50.00000000000044, 41.30000000000001, 47.5, 47.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 37.300000000000026, 45.9, 45.1, 38.10000000000002], "episode_lengths": [32, 100, 42, 500, 500, 500, 500, 40, 70, 500, 36, 24, 500, 50, 500, 500, 114, 92, 500, 60, 44, 28, 500, 128, 32, 36, 500, 90, 210, 500, 500, 70, 40, 500, 94, 96, 500, 258, 64, 500, 500, 34, 24, 36, 152, 46, 102, 500, 74, 500, 500, 500, 54, 38, 52, 462, 500, 60, 78, 58, 300, 500, 60, 312, 500, 48, 294, 32, 500, 500, 42, 500, 396, 500, 98, 50, 50, 62, 58, 194, 84, 76, 112, 158, 500, 120, 66, 34, 500, 88, 26, 30, 500, 500, 34, 500, 128, 42, 50, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38765791879676414, "mean_inference_ms": 1.2516805325112355, "mean_action_processing_ms": 0.14579910701346116, "mean_env_wait_ms": 0.08569592144512729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023009061813354492, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.12299132347106934}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5402.204516709042, "num_env_steps_trained_throughput_per_sec": 5402.204516709042, "timesteps_total": 342000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 342000, "timers": {"training_iteration_time_ms": 3510.29, "sample_time_ms": 3035.487, "load_time_ms": 20.706, "load_throughput": 869328.844, "learn_time_ms": 441.916, "learn_throughput": 40731.697, "synch_weights_time_ms": 10.179}, "counters": {"num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "done": false, "episodes_total": 1259, "training_iteration": 19, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-38", "timestamp": 1698248258, "time_this_iter_s": 3.3389644622802734, "time_total_s": 65.4753532409668, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 65.4753532409668, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 55.86, "ram_util_percent": 27.639999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.8146972656249986e-07, "cur_lr": 0.0003, "total_loss": 6.425317001342774, "policy_loss": -0.00010154280397627089, "vf_loss": 6.425465318891737, "vf_explained_var": -1.27818849351671e-06, "kl": 0.00040333536983578396, "entropy": 0.46770376496844823, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9699999999998097, "episode_len_mean": 270.92, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 44.900000000000006, 3.899999999999615, -50.00000000000044, 44.10000000000001, 42.30000000000001, 44.300000000000004, 20.099999999999845, -50.00000000000044, 44.10000000000001, 18.899999999999828, -50.00000000000044, 45.3, 20.699999999999854, 46.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 10.499999999999709, -50.00000000000044, 40.30000000000002, 45.1, 45.1, 43.900000000000006, 44.300000000000004, 30.699999999999996, 41.70000000000002, 42.500000000000014, 38.90000000000002, 34.30000000000004, -50.00000000000044, 38.10000000000002, 43.50000000000001, 46.699999999999996, -50.00000000000044, 41.30000000000001, 47.5, 47.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 37.300000000000026, 45.9, 45.1, 38.10000000000002, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, 19.69999999999984, -50.00000000000044, 45.5, -50.00000000000044, 44.7, 26.09999999999993, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 46.5, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, 33.30000000000003, -50.00000000000044, 45.3, -50.00000000000044, 36.900000000000034, 31.500000000000007, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.29999999999996, 26.69999999999994, -50.00000000000044, -50.00000000000044, 46.3, 41.30000000000001, -50.00000000000044, 21.699999999999868, -50.00000000000044, 38.10000000000002, 44.10000000000001], "episode_lengths": [38, 52, 462, 500, 60, 78, 58, 300, 500, 60, 312, 500, 48, 294, 32, 500, 500, 42, 500, 396, 500, 98, 50, 50, 62, 58, 194, 84, 76, 112, 158, 500, 120, 66, 34, 500, 88, 26, 30, 500, 500, 34, 500, 128, 42, 50, 120, 338, 500, 500, 500, 272, 304, 500, 46, 500, 54, 240, 500, 500, 152, 500, 36, 500, 312, 500, 500, 500, 460, 500, 168, 500, 48, 500, 132, 186, 40, 500, 500, 34, 500, 36, 98, 500, 500, 130, 500, 52, 500, 218, 234, 500, 500, 38, 88, 500, 284, 500, 120, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3874213752382296, "mean_inference_ms": 1.249840035873958, "mean_action_processing_ms": 0.14529123187555226, "mean_env_wait_ms": 0.08527466759444337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022033214569091797, "StateBufferConnector_ms": 0.004996776580810547, "ViewRequirementAgentConnector_ms": 0.10502767562866211}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9699999999998097, "episode_len_mean": 270.92, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 44.900000000000006, 3.899999999999615, -50.00000000000044, 44.10000000000001, 42.30000000000001, 44.300000000000004, 20.099999999999845, -50.00000000000044, 44.10000000000001, 18.899999999999828, -50.00000000000044, 45.3, 20.699999999999854, 46.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 10.499999999999709, -50.00000000000044, 40.30000000000002, 45.1, 45.1, 43.900000000000006, 44.300000000000004, 30.699999999999996, 41.70000000000002, 42.500000000000014, 38.90000000000002, 34.30000000000004, -50.00000000000044, 38.10000000000002, 43.50000000000001, 46.699999999999996, -50.00000000000044, 41.30000000000001, 47.5, 47.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 37.300000000000026, 45.9, 45.1, 38.10000000000002, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, 19.69999999999984, -50.00000000000044, 45.5, -50.00000000000044, 44.7, 26.09999999999993, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 46.5, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, 33.30000000000003, -50.00000000000044, 45.3, -50.00000000000044, 36.900000000000034, 31.500000000000007, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.29999999999996, 26.69999999999994, -50.00000000000044, -50.00000000000044, 46.3, 41.30000000000001, -50.00000000000044, 21.699999999999868, -50.00000000000044, 38.10000000000002, 44.10000000000001], "episode_lengths": [38, 52, 462, 500, 60, 78, 58, 300, 500, 60, 312, 500, 48, 294, 32, 500, 500, 42, 500, 396, 500, 98, 50, 50, 62, 58, 194, 84, 76, 112, 158, 500, 120, 66, 34, 500, 88, 26, 30, 500, 500, 34, 500, 128, 42, 50, 120, 338, 500, 500, 500, 272, 304, 500, 46, 500, 54, 240, 500, 500, 152, 500, 36, 500, 312, 500, 500, 500, 460, 500, 168, 500, 48, 500, 132, 186, 40, 500, 500, 34, 500, 36, 98, 500, 500, 130, 500, 52, 500, 218, 234, 500, 500, 38, 88, 500, 284, 500, 120, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3874213752382296, "mean_inference_ms": 1.249840035873958, "mean_action_processing_ms": 0.14529123187555226, "mean_env_wait_ms": 0.08527466759444337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022033214569091797, "StateBufferConnector_ms": 0.004996776580810547, "ViewRequirementAgentConnector_ms": 0.10502767562866211}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5545.334073127704, "num_env_steps_trained_throughput_per_sec": 5545.334073127704, "timesteps_total": 360000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 3509.687, "sample_time_ms": 3035.084, "load_time_ms": 19.703, "load_throughput": 913579.415, "learn_time_ms": 442.72, "learn_throughput": 40657.771, "synch_weights_time_ms": 10.178}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1312, "training_iteration": 20, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-41", "timestamp": 1698248261, "time_this_iter_s": 3.2519705295562744, "time_total_s": 68.72732377052307, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.72732377052307, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 62.62500000000001, "ram_util_percent": 27.625000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328124993e-07, "cur_lr": 0.0003, "total_loss": 6.3300760057237415, "policy_loss": -0.0005347148411803776, "vf_loss": 6.330659188164605, "vf_explained_var": -1.2874603271484376e-06, "kl": 0.0010101128428544825, "entropy": 0.48473080926471285, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 923.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.6619999999998035, "episode_len_mean": 273.94, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.30000000000003, -50.00000000000044, 45.3, -50.00000000000044, 36.900000000000034, 31.500000000000007, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.29999999999996, 26.69999999999994, -50.00000000000044, -50.00000000000044, 46.3, 41.30000000000001, -50.00000000000044, 21.699999999999868, -50.00000000000044, 38.10000000000002, 44.10000000000001, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.3, 42.500000000000014, 46.3, 15.699999999999783, -50.00000000000044, 44.5, 26.69999999999994, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.10000000000002, 45.7, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.099999999999994, 46.9, 44.300000000000004, 31.300000000000004, 37.90000000000003, 36.900000000000034, -50.00000000000044, 44.7, 45.5, 44.7, 45.7, 44.5, 42.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.3, 45.7, -50.00000000000044, 44.10000000000001, 19.899999999999842, -50.00000000000044, 39.50000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 168, 500, 48, 500, 132, 186, 40, 500, 500, 34, 500, 36, 98, 500, 500, 130, 500, 52, 500, 218, 234, 500, 500, 38, 88, 500, 284, 500, 120, 60, 500, 54, 34, 500, 500, 132, 500, 500, 28, 500, 500, 500, 66, 500, 48, 76, 38, 344, 500, 56, 234, 500, 60, 500, 120, 44, 500, 500, 134, 40, 32, 58, 188, 122, 132, 500, 54, 46, 54, 44, 56, 78, 38, 500, 500, 86, 38, 44, 500, 60, 302, 500, 106, 500, 84, 500, 90, 500, 500, 76, 500, 56, 76, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38537364928909973, "mean_inference_ms": 1.2432287053503557, "mean_action_processing_ms": 0.14503270059522502, "mean_env_wait_ms": 0.08452747391510415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02401423454284668, "StateBufferConnector_ms": 0.006998777389526367, "ViewRequirementAgentConnector_ms": 0.11002993583679199}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.6619999999998035, "episode_len_mean": 273.94, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.30000000000003, -50.00000000000044, 45.3, -50.00000000000044, 36.900000000000034, 31.500000000000007, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.29999999999996, 26.69999999999994, -50.00000000000044, -50.00000000000044, 46.3, 41.30000000000001, -50.00000000000044, 21.699999999999868, -50.00000000000044, 38.10000000000002, 44.10000000000001, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.3, 42.500000000000014, 46.3, 15.699999999999783, -50.00000000000044, 44.5, 26.69999999999994, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.10000000000002, 45.7, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.099999999999994, 46.9, 44.300000000000004, 31.300000000000004, 37.90000000000003, 36.900000000000034, -50.00000000000044, 44.7, 45.5, 44.7, 45.7, 44.5, 42.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.3, 45.7, -50.00000000000044, 44.10000000000001, 19.899999999999842, -50.00000000000044, 39.50000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 168, 500, 48, 500, 132, 186, 40, 500, 500, 34, 500, 36, 98, 500, 500, 130, 500, 52, 500, 218, 234, 500, 500, 38, 88, 500, 284, 500, 120, 60, 500, 54, 34, 500, 500, 132, 500, 500, 28, 500, 500, 500, 66, 500, 48, 76, 38, 344, 500, 56, 234, 500, 60, 500, 120, 44, 500, 500, 134, 40, 32, 58, 188, 122, 132, 500, 54, 46, 54, 44, 56, 78, 38, 500, 500, 86, 38, 44, 500, 60, 302, 500, 106, 500, 84, 500, 90, 500, 500, 76, 500, 56, 76, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38537364928909973, "mean_inference_ms": 1.2432287053503557, "mean_action_processing_ms": 0.14503270059522502, "mean_env_wait_ms": 0.08452747391510415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02401423454284668, "StateBufferConnector_ms": 0.006998777389526367, "ViewRequirementAgentConnector_ms": 0.11002993583679199}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5457.896090613073, "num_env_steps_trained_throughput_per_sec": 5457.896090613073, "timesteps_total": 378000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 378000, "timers": {"training_iteration_time_ms": 3508.688, "sample_time_ms": 3028.488, "load_time_ms": 19.702, "load_throughput": 913592.681, "learn_time_ms": 448.416, "learn_throughput": 40141.315, "synch_weights_time_ms": 10.179}, "counters": {"num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "done": false, "episodes_total": 1381, "training_iteration": 21, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-44", "timestamp": 1698248264, "time_this_iter_s": 3.3039700984954834, "time_total_s": 72.03129386901855, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 72.03129386901855, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 51.46, "ram_util_percent": 27.619999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062497e-08, "cur_lr": 0.0003, "total_loss": 6.597014564938015, "policy_loss": -0.00016828133828110164, "vf_loss": 6.597232733832465, "vf_explained_var": 4.834598965115017e-07, "kl": 0.0005285364022357599, "entropy": 0.4989459892114004, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 968.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8379999999998033, "episode_len_mean": 272.18, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 45.7, 44.5, 42.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.3, 45.7, -50.00000000000044, 44.10000000000001, 19.899999999999842, -50.00000000000044, 39.50000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.1, 29.299999999999976, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.7, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.5, 38.10000000000002, 44.900000000000006, 43.30000000000001, -50.00000000000044, 40.90000000000002, 46.9, 40.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, 45.7, 42.10000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, 21.499999999999865, 43.10000000000001, -50.00000000000044, 40.90000000000002, 4.299999999999621, 26.499999999999936, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044], "episode_lengths": [54, 44, 56, 78, 38, 500, 500, 86, 38, 44, 500, 60, 302, 500, 106, 500, 84, 500, 90, 500, 500, 76, 500, 56, 76, 500, 500, 500, 500, 500, 500, 500, 22, 500, 52, 500, 500, 74, 50, 208, 500, 500, 92, 44, 500, 114, 500, 500, 84, 36, 120, 52, 68, 500, 92, 32, 96, 96, 500, 500, 38, 44, 80, 72, 500, 500, 80, 500, 500, 122, 108, 500, 500, 500, 52, 44, 42, 38, 500, 500, 78, 188, 500, 66, 500, 126, 500, 500, 72, 38, 286, 70, 500, 92, 458, 236, 500, 500, 168, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3843856820391508, "mean_inference_ms": 1.2392807875142224, "mean_action_processing_ms": 0.1443399357385049, "mean_env_wait_ms": 0.0840404519134178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100396156311035, "StateBufferConnector_ms": 0.004004001617431641, "ViewRequirementAgentConnector_ms": 0.12289023399353027}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8379999999998033, "episode_len_mean": 272.18, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 45.7, 44.5, 42.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.3, 45.7, -50.00000000000044, 44.10000000000001, 19.899999999999842, -50.00000000000044, 39.50000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.1, 29.299999999999976, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.7, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.5, 38.10000000000002, 44.900000000000006, 43.30000000000001, -50.00000000000044, 40.90000000000002, 46.9, 40.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, 45.7, 42.10000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, 21.499999999999865, 43.10000000000001, -50.00000000000044, 40.90000000000002, 4.299999999999621, 26.499999999999936, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044], "episode_lengths": [54, 44, 56, 78, 38, 500, 500, 86, 38, 44, 500, 60, 302, 500, 106, 500, 84, 500, 90, 500, 500, 76, 500, 56, 76, 500, 500, 500, 500, 500, 500, 500, 22, 500, 52, 500, 500, 74, 50, 208, 500, 500, 92, 44, 500, 114, 500, 500, 84, 36, 120, 52, 68, 500, 92, 32, 96, 96, 500, 500, 38, 44, 80, 72, 500, 500, 80, 500, 500, 122, 108, 500, 500, 500, 52, 44, 42, 38, 500, 500, 78, 188, 500, 66, 500, 126, 500, 500, 72, 38, 286, 70, 500, 92, 458, 236, 500, 500, 168, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3843856820391508, "mean_inference_ms": 1.2392807875142224, "mean_action_processing_ms": 0.1443399357385049, "mean_env_wait_ms": 0.0840404519134178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100396156311035, "StateBufferConnector_ms": 0.004004001617431641, "ViewRequirementAgentConnector_ms": 0.12289023399353027}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5474.498821855656, "num_env_steps_trained_throughput_per_sec": 5474.498821855656, "timesteps_total": 396000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 3512.385, "sample_time_ms": 3028.388, "load_time_ms": 19.303, "load_throughput": 932511.938, "learn_time_ms": 452.716, "learn_throughput": 39760.067, "synch_weights_time_ms": 10.076}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1450, "training_iteration": 22, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-48", "timestamp": 1698248268, "time_this_iter_s": 3.293966770172119, "time_total_s": 75.32526063919067, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 75.32526063919067, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 61.574999999999996, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031248e-08, "cur_lr": 0.0003, "total_loss": 6.672082858615451, "policy_loss": -0.00043202373716566295, "vf_loss": 6.672564623090956, "vf_explained_var": -2.3974312676323784e-07, "kl": 0.0012367556992343351, "entropy": 0.49745942023065354, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.516999999999843, "episode_len_mean": 240.5, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 45.7, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, 21.499999999999865, 43.10000000000001, -50.00000000000044, 40.90000000000002, 4.299999999999621, 26.499999999999936, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 33.30000000000003, 38.300000000000026, 36.30000000000003, 29.69999999999998, 43.50000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.90000000000002, 46.099999999999994, 41.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 43.30000000000001, 46.699999999999996, 44.300000000000004, 33.70000000000004, 46.9, 46.3, -50.00000000000044, 46.699999999999996, 40.70000000000002, 44.5, 0.8999999999995723, 44.10000000000001, 45.5, -50.00000000000044, 28.09999999999996, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.10000000000002, 46.3, 44.5, 45.9, 46.099999999999994, 41.90000000000001, 30.099999999999987, 38.50000000000003, 42.500000000000014, 24.899999999999913, 45.9, 47.5, 36.50000000000003, -50.00000000000044, 33.90000000000004, 4.899999999999629, 44.7, 41.30000000000001, -50.00000000000044, 39.10000000000002, -50.00000000000044, 45.9, 46.699999999999996, 40.90000000000002, -50.00000000000044], "episode_lengths": [52, 44, 42, 38, 500, 500, 78, 188, 500, 66, 500, 126, 500, 500, 72, 38, 286, 70, 500, 92, 458, 236, 500, 500, 168, 500, 500, 168, 118, 138, 204, 66, 146, 500, 500, 106, 500, 52, 500, 500, 310, 500, 500, 500, 88, 500, 102, 40, 86, 38, 500, 500, 500, 500, 500, 46, 50, 68, 34, 58, 164, 32, 38, 500, 34, 94, 56, 492, 60, 46, 500, 220, 500, 102, 500, 100, 38, 56, 42, 40, 82, 200, 116, 76, 252, 42, 26, 136, 500, 162, 452, 54, 88, 500, 110, 500, 42, 34, 92, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38399294024520714, "mean_inference_ms": 1.2355138775295527, "mean_action_processing_ms": 0.1430291038818326, "mean_env_wait_ms": 0.083843953592203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024971961975097656, "StateBufferConnector_ms": 0.002002239227294922, "ViewRequirementAgentConnector_ms": 0.13802266120910645}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.516999999999843, "episode_len_mean": 240.5, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 45.7, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, 21.499999999999865, 43.10000000000001, -50.00000000000044, 40.90000000000002, 4.299999999999621, 26.499999999999936, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 33.30000000000003, 38.300000000000026, 36.30000000000003, 29.69999999999998, 43.50000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.90000000000002, 46.099999999999994, 41.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 43.30000000000001, 46.699999999999996, 44.300000000000004, 33.70000000000004, 46.9, 46.3, -50.00000000000044, 46.699999999999996, 40.70000000000002, 44.5, 0.8999999999995723, 44.10000000000001, 45.5, -50.00000000000044, 28.09999999999996, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.10000000000002, 46.3, 44.5, 45.9, 46.099999999999994, 41.90000000000001, 30.099999999999987, 38.50000000000003, 42.500000000000014, 24.899999999999913, 45.9, 47.5, 36.50000000000003, -50.00000000000044, 33.90000000000004, 4.899999999999629, 44.7, 41.30000000000001, -50.00000000000044, 39.10000000000002, -50.00000000000044, 45.9, 46.699999999999996, 40.90000000000002, -50.00000000000044], "episode_lengths": [52, 44, 42, 38, 500, 500, 78, 188, 500, 66, 500, 126, 500, 500, 72, 38, 286, 70, 500, 92, 458, 236, 500, 500, 168, 500, 500, 168, 118, 138, 204, 66, 146, 500, 500, 106, 500, 52, 500, 500, 310, 500, 500, 500, 88, 500, 102, 40, 86, 38, 500, 500, 500, 500, 500, 46, 50, 68, 34, 58, 164, 32, 38, 500, 34, 94, 56, 492, 60, 46, 500, 220, 500, 102, 500, 100, 38, 56, 42, 40, 82, 200, 116, 76, 252, 42, 26, 136, 500, 162, 452, 54, 88, 500, 110, 500, 42, 34, 92, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38399294024520714, "mean_inference_ms": 1.2355138775295527, "mean_action_processing_ms": 0.1430291038818326, "mean_env_wait_ms": 0.083843953592203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024971961975097656, "StateBufferConnector_ms": 0.002002239227294922, "ViewRequirementAgentConnector_ms": 0.13802266120910645}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5550.466012145562, "num_env_steps_trained_throughput_per_sec": 5550.466012145562, "timesteps_total": 414000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 414000, "timers": {"training_iteration_time_ms": 3501.281, "sample_time_ms": 3014.288, "load_time_ms": 19.403, "load_throughput": 927706.191, "learn_time_ms": 455.812, "learn_throughput": 39489.971, "synch_weights_time_ms": 9.976}, "counters": {"num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "done": false, "episodes_total": 1524, "training_iteration": 23, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-51", "timestamp": 1698248271, "time_this_iter_s": 3.2499685287475586, "time_total_s": 78.57522916793823, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 78.57522916793823, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 52.580000000000005, "ram_util_percent": 27.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.384185791015624e-08, "cur_lr": 0.0003, "total_loss": 6.851342752244737, "policy_loss": -0.000278624478313658, "vf_loss": 6.851671144697401, "vf_explained_var": -1.8636385599772135e-06, "kl": 0.0008194117762084514, "entropy": 0.4976299266020457, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1058.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.720999999999835, "episode_len_mean": 248.46, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.09999999999996, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.10000000000002, 46.3, 44.5, 45.9, 46.099999999999994, 41.90000000000001, 30.099999999999987, 38.50000000000003, 42.500000000000014, 24.899999999999913, 45.9, 47.5, 36.50000000000003, -50.00000000000044, 33.90000000000004, 4.899999999999629, 44.7, 41.30000000000001, -50.00000000000044, 39.10000000000002, -50.00000000000044, 45.9, 46.699999999999996, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.1, 6.499999999999652, 45.9, 44.300000000000004, 45.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.900000000000006, 32.30000000000002, -50.00000000000044, 16.09999999999979, 38.90000000000002, -50.00000000000044, 39.90000000000002, 47.7, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.1, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 25.499999999999922, 16.8999999999998, 36.70000000000003, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 36.900000000000034, 32.100000000000016, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.099999999999994, 45.3, 41.30000000000001, 46.5, -50.00000000000044, 46.099999999999994, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 30.29999999999999, 46.9, 23.8999999999999, 42.70000000000001, -50.00000000000044, 12.899999999999743, 45.5, -50.00000000000044, 0.09999999999956088, 44.300000000000004, 46.3, 43.50000000000001, 37.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [220, 500, 102, 500, 100, 38, 56, 42, 40, 82, 200, 116, 76, 252, 42, 26, 136, 500, 162, 452, 54, 88, 500, 110, 500, 42, 34, 92, 500, 500, 50, 436, 42, 58, 42, 500, 68, 500, 52, 178, 500, 340, 112, 500, 102, 24, 40, 500, 40, 500, 500, 230, 50, 50, 500, 500, 500, 88, 500, 246, 332, 134, 112, 500, 500, 500, 44, 500, 132, 180, 500, 88, 500, 40, 48, 88, 36, 500, 40, 384, 500, 500, 500, 500, 104, 198, 32, 262, 74, 500, 372, 46, 500, 500, 58, 38, 66, 128, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3824068594443675, "mean_inference_ms": 1.2314126926222164, "mean_action_processing_ms": 0.1427997007655825, "mean_env_wait_ms": 0.08353912871282278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021941423416137695, "StateBufferConnector_ms": 0.003001689910888672, "ViewRequirementAgentConnector_ms": 0.13101959228515625}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.720999999999835, "episode_len_mean": 248.46, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.09999999999996, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.10000000000002, 46.3, 44.5, 45.9, 46.099999999999994, 41.90000000000001, 30.099999999999987, 38.50000000000003, 42.500000000000014, 24.899999999999913, 45.9, 47.5, 36.50000000000003, -50.00000000000044, 33.90000000000004, 4.899999999999629, 44.7, 41.30000000000001, -50.00000000000044, 39.10000000000002, -50.00000000000044, 45.9, 46.699999999999996, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.1, 6.499999999999652, 45.9, 44.300000000000004, 45.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.900000000000006, 32.30000000000002, -50.00000000000044, 16.09999999999979, 38.90000000000002, -50.00000000000044, 39.90000000000002, 47.7, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.1, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 25.499999999999922, 16.8999999999998, 36.70000000000003, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 36.900000000000034, 32.100000000000016, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.099999999999994, 45.3, 41.30000000000001, 46.5, -50.00000000000044, 46.099999999999994, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 30.29999999999999, 46.9, 23.8999999999999, 42.70000000000001, -50.00000000000044, 12.899999999999743, 45.5, -50.00000000000044, 0.09999999999956088, 44.300000000000004, 46.3, 43.50000000000001, 37.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [220, 500, 102, 500, 100, 38, 56, 42, 40, 82, 200, 116, 76, 252, 42, 26, 136, 500, 162, 452, 54, 88, 500, 110, 500, 42, 34, 92, 500, 500, 50, 436, 42, 58, 42, 500, 68, 500, 52, 178, 500, 340, 112, 500, 102, 24, 40, 500, 40, 500, 500, 230, 50, 50, 500, 500, 500, 88, 500, 246, 332, 134, 112, 500, 500, 500, 44, 500, 132, 180, 500, 88, 500, 40, 48, 88, 36, 500, 40, 384, 500, 500, 500, 500, 104, 198, 32, 262, 74, 500, 372, 46, 500, 500, 58, 38, 66, 128, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3824068594443675, "mean_inference_ms": 1.2314126926222164, "mean_action_processing_ms": 0.1427997007655825, "mean_env_wait_ms": 0.08353912871282278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021941423416137695, "StateBufferConnector_ms": 0.003001689910888672, "ViewRequirementAgentConnector_ms": 0.13101959228515625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5514.741031142092, "num_env_steps_trained_throughput_per_sec": 5514.741031142092, "timesteps_total": 432000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 3483.581, "sample_time_ms": 2995.791, "load_time_ms": 19.102, "load_throughput": 942319.056, "learn_time_ms": 457.112, "learn_throughput": 39377.682, "synch_weights_time_ms": 9.573}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1595, "training_iteration": 24, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-54", "timestamp": 1698248274, "time_this_iter_s": 3.269970417022705, "time_total_s": 81.84519958496094, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 81.84519958496094, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 51.2, "ram_util_percent": 27.46}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.192092895507812e-08, "cur_lr": 0.0003, "total_loss": 6.867305617862278, "policy_loss": -0.0010252114592327012, "vf_loss": 6.868381447262234, "vf_explained_var": -1.166926489935981e-06, "kl": 0.0015683753294676232, "entropy": 0.5069078352716234, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1103.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.041999999999813, "episode_len_mean": 270.22, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.900000000000034, 32.100000000000016, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.099999999999994, 45.3, 41.30000000000001, 46.5, -50.00000000000044, 46.099999999999994, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 30.29999999999999, 46.9, 23.8999999999999, 42.70000000000001, -50.00000000000044, 12.899999999999743, 45.5, -50.00000000000044, 0.09999999999956088, 44.300000000000004, 46.3, 43.50000000000001, 37.300000000000026, -50.00000000000044, -50.00000000000044, 33.90000000000004, 41.70000000000002, 43.10000000000001, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, 46.3, 33.30000000000003, 40.70000000000002, 21.89999999999987, 8.899999999999686, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 8.299999999999677, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 26.69999999999994, 43.7, 45.9, 7.699999999999669, 42.900000000000006, 44.10000000000001, 37.90000000000003, 30.499999999999993, 46.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, 20.49999999999985, 47.1, 39.90000000000002, -50.00000000000044, 43.10000000000001, 43.7, 45.3, -50.00000000000044, 9.699999999999697, -50.00000000000044, 43.50000000000001, 44.7, 13.899999999999757, -50.00000000000044, 39.90000000000002], "episode_lengths": [500, 132, 180, 500, 88, 500, 40, 48, 88, 36, 500, 40, 384, 500, 500, 500, 500, 104, 198, 32, 262, 74, 500, 372, 46, 500, 500, 58, 38, 66, 128, 500, 500, 162, 84, 70, 500, 56, 500, 72, 500, 42, 500, 38, 168, 94, 282, 412, 296, 500, 500, 500, 500, 186, 418, 500, 500, 500, 350, 234, 64, 42, 424, 72, 60, 122, 196, 38, 500, 58, 500, 66, 500, 500, 500, 52, 38, 62, 500, 500, 86, 56, 110, 500, 500, 296, 30, 102, 500, 70, 64, 48, 500, 404, 500, 66, 54, 362, 500, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38154303775376036, "mean_inference_ms": 1.2291055902177432, "mean_action_processing_ms": 0.1429595410401388, "mean_env_wait_ms": 0.08304233310621692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024998188018798828, "StateBufferConnector_ms": 0.0029685497283935547, "ViewRequirementAgentConnector_ms": 0.130018949508667}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.041999999999813, "episode_len_mean": 270.22, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.900000000000034, 32.100000000000016, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.099999999999994, 45.3, 41.30000000000001, 46.5, -50.00000000000044, 46.099999999999994, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 30.29999999999999, 46.9, 23.8999999999999, 42.70000000000001, -50.00000000000044, 12.899999999999743, 45.5, -50.00000000000044, 0.09999999999956088, 44.300000000000004, 46.3, 43.50000000000001, 37.300000000000026, -50.00000000000044, -50.00000000000044, 33.90000000000004, 41.70000000000002, 43.10000000000001, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, 46.3, 33.30000000000003, 40.70000000000002, 21.89999999999987, 8.899999999999686, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 8.299999999999677, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 26.69999999999994, 43.7, 45.9, 7.699999999999669, 42.900000000000006, 44.10000000000001, 37.90000000000003, 30.499999999999993, 46.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, 20.49999999999985, 47.1, 39.90000000000002, -50.00000000000044, 43.10000000000001, 43.7, 45.3, -50.00000000000044, 9.699999999999697, -50.00000000000044, 43.50000000000001, 44.7, 13.899999999999757, -50.00000000000044, 39.90000000000002], "episode_lengths": [500, 132, 180, 500, 88, 500, 40, 48, 88, 36, 500, 40, 384, 500, 500, 500, 500, 104, 198, 32, 262, 74, 500, 372, 46, 500, 500, 58, 38, 66, 128, 500, 500, 162, 84, 70, 500, 56, 500, 72, 500, 42, 500, 38, 168, 94, 282, 412, 296, 500, 500, 500, 500, 186, 418, 500, 500, 500, 350, 234, 64, 42, 424, 72, 60, 122, 196, 38, 500, 58, 500, 66, 500, 500, 500, 52, 38, 62, 500, 500, 86, 56, 110, 500, 500, 296, 30, 102, 500, 70, 64, 48, 500, 404, 500, 66, 54, 362, 500, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38154303775376036, "mean_inference_ms": 1.2291055902177432, "mean_action_processing_ms": 0.1429595410401388, "mean_env_wait_ms": 0.08304233310621692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024998188018798828, "StateBufferConnector_ms": 0.0029685497283935547, "ViewRequirementAgentConnector_ms": 0.130018949508667}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5449.634988549969, "num_env_steps_trained_throughput_per_sec": 5449.634988549969, "timesteps_total": 450000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 3487.482, "sample_time_ms": 2978.794, "load_time_ms": 20.502, "load_throughput": 877972.525, "learn_time_ms": 476.508, "learn_throughput": 37774.803, "synch_weights_time_ms": 9.574}, "counters": {"num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "episodes_total": 1662, "training_iteration": 25, "trial_id": "9f288_00013", "date": "2023-10-25_16-37-57", "timestamp": 1698248277, "time_this_iter_s": 3.307969570159912, "time_total_s": 85.15316915512085, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 85.15316915512085, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 64.25, "ram_util_percent": 27.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.96046447753906e-09, "cur_lr": 0.0003, "total_loss": 6.701735602484809, "policy_loss": -0.0001618963148858812, "vf_loss": 6.70194656583998, "vf_explained_var": -1.3298458523220485e-06, "kl": 0.0006104394927168263, "entropy": 0.49064447349972196, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1148.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.003999999999832, "episode_len_mean": 250.6, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, 20.49999999999985, 47.1, 39.90000000000002, -50.00000000000044, 43.10000000000001, 43.7, 45.3, -50.00000000000044, 9.699999999999697, -50.00000000000044, 43.50000000000001, 44.7, 13.899999999999757, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.900000000000006, 43.30000000000001, 39.10000000000002, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 40.70000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, 46.9, 45.3, 42.10000000000001, 43.30000000000001, 21.299999999999862, 43.7, 21.499999999999865, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 44.900000000000006, 44.10000000000001, -50.00000000000044, 39.10000000000002, 46.5, 46.3, 44.10000000000001, -50.00000000000044, 32.700000000000024, 44.300000000000004, -50.00000000000044, 36.70000000000003, -50.00000000000044, 28.699999999999967, 34.10000000000004, 46.699999999999996, 27.699999999999953, 42.70000000000001, 42.500000000000014, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 46.9, -50.00000000000044, 37.70000000000003, 45.7, 42.70000000000001, -50.00000000000044, 25.29999999999992, 19.09999999999983, 38.700000000000024, 46.099999999999994, 46.699999999999996, -50.00000000000044, 40.90000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [66, 500, 500, 500, 52, 38, 62, 500, 500, 86, 56, 110, 500, 500, 296, 30, 102, 500, 70, 64, 48, 500, 404, 500, 66, 54, 362, 500, 102, 500, 72, 68, 110, 242, 500, 500, 500, 500, 500, 260, 94, 500, 500, 58, 48, 32, 48, 80, 68, 288, 64, 286, 114, 500, 500, 500, 32, 56, 500, 52, 60, 500, 110, 36, 38, 60, 500, 174, 58, 500, 134, 500, 214, 160, 34, 224, 74, 76, 80, 500, 500, 500, 210, 500, 32, 500, 124, 44, 74, 500, 248, 310, 114, 40, 34, 500, 92, 66, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3809693886486022, "mean_inference_ms": 1.2270721692264834, "mean_action_processing_ms": 0.1427611834923115, "mean_env_wait_ms": 0.08307376337171309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024956941604614258, "StateBufferConnector_ms": 0.009967565536499023, "ViewRequirementAgentConnector_ms": 0.09288787841796875}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.003999999999832, "episode_len_mean": 250.6, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, 20.49999999999985, 47.1, 39.90000000000002, -50.00000000000044, 43.10000000000001, 43.7, 45.3, -50.00000000000044, 9.699999999999697, -50.00000000000044, 43.50000000000001, 44.7, 13.899999999999757, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.900000000000006, 43.30000000000001, 39.10000000000002, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 40.70000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, 46.9, 45.3, 42.10000000000001, 43.30000000000001, 21.299999999999862, 43.7, 21.499999999999865, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 44.900000000000006, 44.10000000000001, -50.00000000000044, 39.10000000000002, 46.5, 46.3, 44.10000000000001, -50.00000000000044, 32.700000000000024, 44.300000000000004, -50.00000000000044, 36.70000000000003, -50.00000000000044, 28.699999999999967, 34.10000000000004, 46.699999999999996, 27.699999999999953, 42.70000000000001, 42.500000000000014, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 46.9, -50.00000000000044, 37.70000000000003, 45.7, 42.70000000000001, -50.00000000000044, 25.29999999999992, 19.09999999999983, 38.700000000000024, 46.099999999999994, 46.699999999999996, -50.00000000000044, 40.90000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [66, 500, 500, 500, 52, 38, 62, 500, 500, 86, 56, 110, 500, 500, 296, 30, 102, 500, 70, 64, 48, 500, 404, 500, 66, 54, 362, 500, 102, 500, 72, 68, 110, 242, 500, 500, 500, 500, 500, 260, 94, 500, 500, 58, 48, 32, 48, 80, 68, 288, 64, 286, 114, 500, 500, 500, 32, 56, 500, 52, 60, 500, 110, 36, 38, 60, 500, 174, 58, 500, 134, 500, 214, 160, 34, 224, 74, 76, 80, 500, 500, 500, 210, 500, 32, 500, 124, 44, 74, 500, 248, 310, 114, 40, 34, 500, 92, 66, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3809693886486022, "mean_inference_ms": 1.2270721692264834, "mean_action_processing_ms": 0.1427611834923115, "mean_env_wait_ms": 0.08307376337171309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024956941604614258, "StateBufferConnector_ms": 0.009967565536499023, "ViewRequirementAgentConnector_ms": 0.09288787841796875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5535.109569146574, "num_env_steps_trained_throughput_per_sec": 5535.109569146574, "timesteps_total": 468000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 3409.881, "sample_time_ms": 2886.597, "load_time_ms": 20.702, "load_throughput": 869501.051, "learn_time_ms": 490.705, "learn_throughput": 36681.9, "synch_weights_time_ms": 9.675}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1733, "training_iteration": 26, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-01", "timestamp": 1698248281, "time_this_iter_s": 3.257967710494995, "time_total_s": 88.41113686561584, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 88.41113686561584, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 53.32000000000001, "ram_util_percent": 27.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.98023223876953e-09, "cur_lr": 0.0003, "total_loss": 6.479840109083388, "policy_loss": -0.00047402319808801014, "vf_loss": 6.480365191565619, "vf_explained_var": -3.16566891140408e-06, "kl": 0.0009139322961265369, "entropy": 0.5105843491024441, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1193.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.477999999999819, "episode_len_mean": 265.84, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.10000000000002, 46.5, 46.3, 44.10000000000001, -50.00000000000044, 32.700000000000024, 44.300000000000004, -50.00000000000044, 36.70000000000003, -50.00000000000044, 28.699999999999967, 34.10000000000004, 46.699999999999996, 27.699999999999953, 42.70000000000001, 42.500000000000014, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 46.9, -50.00000000000044, 37.70000000000003, 45.7, 42.70000000000001, -50.00000000000044, 25.29999999999992, 19.09999999999983, 38.700000000000024, 46.099999999999994, 46.699999999999996, -50.00000000000044, 40.90000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 46.699999999999996, 44.900000000000006, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 47.9, 44.7, 31.500000000000007, 44.7, -50.00000000000044, 29.899999999999984, 41.90000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 41.30000000000001, 43.7, 43.7, 3.699999999999612, -50.00000000000044, 47.5, 38.300000000000026, 43.30000000000001, 11.29999999999972, -50.00000000000044, -50.00000000000044, 19.69999999999984, 34.30000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, 36.50000000000003, 37.10000000000003, 35.70000000000003, 46.699999999999996, 42.30000000000001, 7.699999999999669, 44.7, 41.100000000000016, 42.70000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 110, 36, 38, 60, 500, 174, 58, 500, 134, 500, 214, 160, 34, 224, 74, 76, 80, 500, 500, 500, 210, 500, 32, 500, 124, 44, 74, 500, 248, 310, 114, 40, 34, 500, 92, 66, 500, 500, 500, 500, 500, 262, 500, 34, 52, 160, 500, 500, 500, 500, 94, 500, 22, 54, 186, 54, 500, 202, 82, 500, 52, 500, 24, 500, 500, 500, 54, 88, 64, 64, 464, 500, 26, 118, 68, 388, 500, 500, 304, 158, 500, 50, 500, 500, 500, 500, 356, 136, 130, 144, 34, 78, 424, 54, 90, 74, 80, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.380455723180908, "mean_inference_ms": 1.2245875321250281, "mean_action_processing_ms": 0.1425693122526099, "mean_env_wait_ms": 0.08261817884747419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01699066162109375, "StateBufferConnector_ms": 0.010994911193847656, "ViewRequirementAgentConnector_ms": 0.08492588996887207}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.477999999999819, "episode_len_mean": 265.84, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.10000000000002, 46.5, 46.3, 44.10000000000001, -50.00000000000044, 32.700000000000024, 44.300000000000004, -50.00000000000044, 36.70000000000003, -50.00000000000044, 28.699999999999967, 34.10000000000004, 46.699999999999996, 27.699999999999953, 42.70000000000001, 42.500000000000014, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 46.9, -50.00000000000044, 37.70000000000003, 45.7, 42.70000000000001, -50.00000000000044, 25.29999999999992, 19.09999999999983, 38.700000000000024, 46.099999999999994, 46.699999999999996, -50.00000000000044, 40.90000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 46.699999999999996, 44.900000000000006, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 47.9, 44.7, 31.500000000000007, 44.7, -50.00000000000044, 29.899999999999984, 41.90000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 41.30000000000001, 43.7, 43.7, 3.699999999999612, -50.00000000000044, 47.5, 38.300000000000026, 43.30000000000001, 11.29999999999972, -50.00000000000044, -50.00000000000044, 19.69999999999984, 34.30000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, 36.50000000000003, 37.10000000000003, 35.70000000000003, 46.699999999999996, 42.30000000000001, 7.699999999999669, 44.7, 41.100000000000016, 42.70000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 110, 36, 38, 60, 500, 174, 58, 500, 134, 500, 214, 160, 34, 224, 74, 76, 80, 500, 500, 500, 210, 500, 32, 500, 124, 44, 74, 500, 248, 310, 114, 40, 34, 500, 92, 66, 500, 500, 500, 500, 500, 262, 500, 34, 52, 160, 500, 500, 500, 500, 94, 500, 22, 54, 186, 54, 500, 202, 82, 500, 52, 500, 24, 500, 500, 500, 54, 88, 64, 64, 464, 500, 26, 118, 68, 388, 500, 500, 304, 158, 500, 50, 500, 500, 500, 500, 356, 136, 130, 144, 34, 78, 424, 54, 90, 74, 80, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.380455723180908, "mean_inference_ms": 1.2245875321250281, "mean_action_processing_ms": 0.1425693122526099, "mean_env_wait_ms": 0.08261817884747419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01699066162109375, "StateBufferConnector_ms": 0.010994911193847656, "ViewRequirementAgentConnector_ms": 0.08492588996887207}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5496.181845700047, "num_env_steps_trained_throughput_per_sec": 5496.181845700047, "timesteps_total": 486000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 486000, "timers": {"training_iteration_time_ms": 3340.178, "sample_time_ms": 2820.993, "load_time_ms": 19.202, "load_throughput": 937415.453, "learn_time_ms": 488.008, "learn_throughput": 36884.636, "synch_weights_time_ms": 9.772}, "counters": {"num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "done": false, "episodes_total": 1794, "training_iteration": 27, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-04", "timestamp": 1698248284, "time_this_iter_s": 3.279998302459717, "time_total_s": 91.69113516807556, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 91.69113516807556, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 64.175, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384765e-09, "cur_lr": 0.0003, "total_loss": 6.454483646816677, "policy_loss": -0.0005235006411870321, "vf_loss": 6.455058797200521, "vf_explained_var": 1.9126468234592014e-06, "kl": 0.0008866423046053266, "entropy": 0.517568768395318, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1238.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.8520000000002204, "episode_len_mean": 299.08, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 41.30000000000001, 43.7, 43.7, 3.699999999999612, -50.00000000000044, 47.5, 38.300000000000026, 43.30000000000001, 11.29999999999972, -50.00000000000044, -50.00000000000044, 19.69999999999984, 34.30000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, 36.50000000000003, 37.10000000000003, 35.70000000000003, 46.699999999999996, 42.30000000000001, 7.699999999999669, 44.7, 41.100000000000016, 42.70000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.500000000000014, 47.3, 46.099999999999994, 45.1, 37.10000000000003, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 44.300000000000004, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 31.300000000000004, 37.90000000000003, 37.10000000000003, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, -50.00000000000044, 47.1, 46.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 26.69999999999994, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, -50.00000000000044, 46.3, 6.699999999999655, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 15.49999999999978, 34.10000000000004, -50.00000000000044, -50.00000000000044, 30.29999999999999, 46.3], "episode_lengths": [500, 52, 500, 24, 500, 500, 500, 54, 88, 64, 64, 464, 500, 26, 118, 68, 388, 500, 500, 304, 158, 500, 50, 500, 500, 500, 500, 356, 136, 130, 144, 34, 78, 424, 54, 90, 74, 80, 500, 500, 500, 500, 500, 44, 500, 86, 28, 40, 50, 130, 500, 460, 500, 500, 58, 374, 500, 500, 500, 28, 188, 122, 130, 500, 500, 400, 500, 500, 30, 36, 500, 90, 500, 36, 500, 134, 500, 500, 500, 234, 500, 234, 500, 58, 500, 54, 500, 38, 434, 500, 80, 500, 48, 500, 346, 160, 500, 500, 198, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788611655369934, "mean_inference_ms": 1.2217190462209795, "mean_action_processing_ms": 0.14267083018232884, "mean_env_wait_ms": 0.08203906425075452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399587631225586, "StateBufferConnector_ms": 0.0019996166229248047, "ViewRequirementAgentConnector_ms": 0.09986519813537598}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.8520000000002204, "episode_len_mean": 299.08, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 41.30000000000001, 43.7, 43.7, 3.699999999999612, -50.00000000000044, 47.5, 38.300000000000026, 43.30000000000001, 11.29999999999972, -50.00000000000044, -50.00000000000044, 19.69999999999984, 34.30000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, 36.50000000000003, 37.10000000000003, 35.70000000000003, 46.699999999999996, 42.30000000000001, 7.699999999999669, 44.7, 41.100000000000016, 42.70000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.500000000000014, 47.3, 46.099999999999994, 45.1, 37.10000000000003, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 44.300000000000004, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 31.300000000000004, 37.90000000000003, 37.10000000000003, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, -50.00000000000044, 47.1, 46.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 26.69999999999994, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, -50.00000000000044, 46.3, 6.699999999999655, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 15.49999999999978, 34.10000000000004, -50.00000000000044, -50.00000000000044, 30.29999999999999, 46.3], "episode_lengths": [500, 52, 500, 24, 500, 500, 500, 54, 88, 64, 64, 464, 500, 26, 118, 68, 388, 500, 500, 304, 158, 500, 50, 500, 500, 500, 500, 356, 136, 130, 144, 34, 78, 424, 54, 90, 74, 80, 500, 500, 500, 500, 500, 44, 500, 86, 28, 40, 50, 130, 500, 460, 500, 500, 58, 374, 500, 500, 500, 28, 188, 122, 130, 500, 500, 400, 500, 500, 30, 36, 500, 90, 500, 36, 500, 134, 500, 500, 500, 234, 500, 234, 500, 58, 500, 54, 500, 38, 434, 500, 80, 500, 48, 500, 346, 160, 500, 500, 198, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788611655369934, "mean_inference_ms": 1.2217190462209795, "mean_action_processing_ms": 0.14267083018232884, "mean_env_wait_ms": 0.08203906425075452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399587631225586, "StateBufferConnector_ms": 0.0019996166229248047, "ViewRequirementAgentConnector_ms": 0.09986519813537598}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5530.006784922924, "num_env_steps_trained_throughput_per_sec": 5530.006784922924, "timesteps_total": 504000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 3275.575, "sample_time_ms": 2754.393, "load_time_ms": 17.699, "load_throughput": 1016998.206, "learn_time_ms": 491.508, "learn_throughput": 36622.002, "synch_weights_time_ms": 9.872}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1854, "training_iteration": 28, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-07", "timestamp": 1698248287, "time_this_iter_s": 3.2599639892578125, "time_total_s": 94.95109915733337, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 94.95109915733337, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 51.44, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.450580596923825e-10, "cur_lr": 0.0003, "total_loss": 6.891952196756999, "policy_loss": -0.0002866193652153015, "vf_loss": 6.892288133833143, "vf_explained_var": -4.001458485921224e-06, "kl": 0.000977191378455839, "entropy": 0.4920954525470734, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1283.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.566999999999815, "episode_len_mean": 269.94, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 26.69999999999994, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, -50.00000000000044, 46.3, 6.699999999999655, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 15.49999999999978, 34.10000000000004, -50.00000000000044, -50.00000000000044, 30.29999999999999, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016, 15.699999999999783, 45.5, -50.00000000000044, 43.10000000000001, 45.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 22.49999999999988, 44.7, 21.299999999999862, 43.50000000000001, 37.90000000000003, -50.00000000000044, 43.7, 38.700000000000024, 11.699999999999726, 36.50000000000003, 45.3, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 39.70000000000002, 46.099999999999994, 30.099999999999987, 46.5, 45.7, -50.00000000000044, 43.900000000000006, 41.90000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 27.299999999999947, 39.10000000000002, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 23.699999999999896, 43.900000000000006, 42.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 36.30000000000003, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.5, -50.00000000000044, 45.9, -50.00000000000044, 43.7, 41.500000000000014, 22.49999999999988, -50.00000000000044, -50.00000000000044, 43.10000000000001, 36.70000000000003, 46.099999999999994, 34.70000000000004], "episode_lengths": [500, 36, 500, 134, 500, 500, 500, 234, 500, 234, 500, 58, 500, 54, 500, 38, 434, 500, 80, 500, 48, 500, 346, 160, 500, 500, 198, 38, 500, 500, 90, 344, 46, 500, 70, 48, 66, 500, 500, 80, 500, 500, 276, 54, 288, 66, 122, 500, 64, 114, 384, 136, 48, 126, 500, 500, 500, 114, 104, 40, 200, 36, 44, 500, 62, 82, 500, 90, 500, 228, 110, 40, 50, 500, 500, 264, 62, 72, 114, 500, 500, 138, 112, 500, 500, 500, 116, 36, 500, 42, 500, 64, 86, 276, 500, 500, 70, 134, 40, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37858936613795274, "mean_inference_ms": 1.2192788423597707, "mean_action_processing_ms": 0.1421926897534958, "mean_env_wait_ms": 0.08212401112577755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03593182563781738, "StateBufferConnector_ms": 0.004002571105957031, "ViewRequirementAgentConnector_ms": 0.10611224174499512}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.566999999999815, "episode_len_mean": 269.94, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 26.69999999999994, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, -50.00000000000044, 46.3, 6.699999999999655, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 15.49999999999978, 34.10000000000004, -50.00000000000044, -50.00000000000044, 30.29999999999999, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016, 15.699999999999783, 45.5, -50.00000000000044, 43.10000000000001, 45.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 22.49999999999988, 44.7, 21.299999999999862, 43.50000000000001, 37.90000000000003, -50.00000000000044, 43.7, 38.700000000000024, 11.699999999999726, 36.50000000000003, 45.3, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 39.70000000000002, 46.099999999999994, 30.099999999999987, 46.5, 45.7, -50.00000000000044, 43.900000000000006, 41.90000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 27.299999999999947, 39.10000000000002, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 23.699999999999896, 43.900000000000006, 42.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 36.30000000000003, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.5, -50.00000000000044, 45.9, -50.00000000000044, 43.7, 41.500000000000014, 22.49999999999988, -50.00000000000044, -50.00000000000044, 43.10000000000001, 36.70000000000003, 46.099999999999994, 34.70000000000004], "episode_lengths": [500, 36, 500, 134, 500, 500, 500, 234, 500, 234, 500, 58, 500, 54, 500, 38, 434, 500, 80, 500, 48, 500, 346, 160, 500, 500, 198, 38, 500, 500, 90, 344, 46, 500, 70, 48, 66, 500, 500, 80, 500, 500, 276, 54, 288, 66, 122, 500, 64, 114, 384, 136, 48, 126, 500, 500, 500, 114, 104, 40, 200, 36, 44, 500, 62, 82, 500, 90, 500, 228, 110, 40, 50, 500, 500, 264, 62, 72, 114, 500, 500, 138, 112, 500, 500, 500, 116, 36, 500, 42, 500, 64, 86, 276, 500, 500, 70, 134, 40, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37858936613795274, "mean_inference_ms": 1.2192788423597707, "mean_action_processing_ms": 0.1421926897534958, "mean_env_wait_ms": 0.08212401112577755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03593182563781738, "StateBufferConnector_ms": 0.004002571105957031, "ViewRequirementAgentConnector_ms": 0.10611224174499512}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5384.433772527656, "num_env_steps_trained_throughput_per_sec": 5384.433772527656, "timesteps_total": 522000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 522000, "timers": {"training_iteration_time_ms": 3276.675, "sample_time_ms": 2745.697, "load_time_ms": 17.896, "load_throughput": 1005810.877, "learn_time_ms": 501.505, "learn_throughput": 35891.984, "synch_weights_time_ms": 9.475}, "counters": {"num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "done": false, "episodes_total": 1926, "training_iteration": 29, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-11", "timestamp": 1698248291, "time_this_iter_s": 3.3479695320129395, "time_total_s": 98.29906868934631, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 98.29906868934631, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 52.8, "ram_util_percent": 27.139999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7252902984619127e-10, "cur_lr": 0.0003, "total_loss": 7.261747275458442, "policy_loss": -0.00015182166049877802, "vf_loss": 7.2619498146904835, "vf_explained_var": -1.3205740186903211e-06, "kl": 0.000647869793191881, "entropy": 0.5080549485153623, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1328.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.044999999999868, "episode_len_mean": 215.28, "episode_media": {}, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, 43.7, 41.500000000000014, 22.49999999999988, -50.00000000000044, -50.00000000000044, 43.10000000000001, 36.70000000000003, 46.099999999999994, 34.70000000000004, -50.00000000000044, 26.499999999999936, 46.5, 38.300000000000026, 46.5, 14.299999999999763, 21.499999999999865, 46.099999999999994, -50.00000000000044, 43.10000000000001, 43.10000000000001, 45.5, 46.699999999999996, 39.50000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 4.699999999999626, 46.3, 45.9, 30.499999999999993, 25.699999999999925, 14.899999999999771, -50.00000000000044, 46.9, 42.900000000000006, 34.70000000000004, 43.30000000000001, 41.90000000000001, -50.00000000000044, 40.70000000000002, 46.099999999999994, 43.30000000000001, 45.9, 44.900000000000006, 40.70000000000002, 14.299999999999763, 36.70000000000003, 42.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 38.50000000000003, -50.00000000000044, 46.099999999999994, 43.50000000000001, 45.9, 17.69999999999981, 37.50000000000003, 21.299999999999862, 45.7, 45.5, 32.700000000000024, 44.900000000000006, -50.00000000000044, 45.9, 30.699999999999996, -50.00000000000044, 41.90000000000001, 40.70000000000002, 47.1, 45.5, -50.00000000000044, 46.099999999999994, 38.300000000000026, 41.90000000000001, 42.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 44.10000000000001, 43.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, 43.7, -50.00000000000044, 38.300000000000026, 40.70000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 42, 500, 64, 86, 276, 500, 500, 70, 134, 40, 154, 500, 236, 36, 118, 36, 358, 286, 40, 500, 70, 70, 46, 34, 106, 500, 100, 500, 500, 500, 170, 454, 38, 42, 196, 244, 352, 500, 32, 72, 154, 68, 82, 500, 94, 40, 68, 42, 52, 94, 358, 134, 80, 500, 62, 500, 116, 500, 40, 66, 42, 324, 126, 288, 44, 46, 174, 52, 500, 42, 194, 500, 82, 94, 30, 46, 500, 40, 118, 82, 80, 42, 500, 500, 500, 500, 50, 44, 60, 62, 500, 38, 500, 64, 500, 118, 94, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774639066925524, "mean_inference_ms": 1.2171717295089168, "mean_action_processing_ms": 0.14204343519852086, "mean_env_wait_ms": 0.08184254032586825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030927419662475586, "StateBufferConnector_ms": 0.009000062942504883, "ViewRequirementAgentConnector_ms": 0.11901140213012695}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.044999999999868, "episode_len_mean": 215.28, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, 43.7, 41.500000000000014, 22.49999999999988, -50.00000000000044, -50.00000000000044, 43.10000000000001, 36.70000000000003, 46.099999999999994, 34.70000000000004, -50.00000000000044, 26.499999999999936, 46.5, 38.300000000000026, 46.5, 14.299999999999763, 21.499999999999865, 46.099999999999994, -50.00000000000044, 43.10000000000001, 43.10000000000001, 45.5, 46.699999999999996, 39.50000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 4.699999999999626, 46.3, 45.9, 30.499999999999993, 25.699999999999925, 14.899999999999771, -50.00000000000044, 46.9, 42.900000000000006, 34.70000000000004, 43.30000000000001, 41.90000000000001, -50.00000000000044, 40.70000000000002, 46.099999999999994, 43.30000000000001, 45.9, 44.900000000000006, 40.70000000000002, 14.299999999999763, 36.70000000000003, 42.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 38.50000000000003, -50.00000000000044, 46.099999999999994, 43.50000000000001, 45.9, 17.69999999999981, 37.50000000000003, 21.299999999999862, 45.7, 45.5, 32.700000000000024, 44.900000000000006, -50.00000000000044, 45.9, 30.699999999999996, -50.00000000000044, 41.90000000000001, 40.70000000000002, 47.1, 45.5, -50.00000000000044, 46.099999999999994, 38.300000000000026, 41.90000000000001, 42.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 44.10000000000001, 43.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, 43.7, -50.00000000000044, 38.300000000000026, 40.70000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 42, 500, 64, 86, 276, 500, 500, 70, 134, 40, 154, 500, 236, 36, 118, 36, 358, 286, 40, 500, 70, 70, 46, 34, 106, 500, 100, 500, 500, 500, 170, 454, 38, 42, 196, 244, 352, 500, 32, 72, 154, 68, 82, 500, 94, 40, 68, 42, 52, 94, 358, 134, 80, 500, 62, 500, 116, 500, 40, 66, 42, 324, 126, 288, 44, 46, 174, 52, 500, 42, 194, 500, 82, 94, 30, 46, 500, 40, 118, 82, 80, 42, 500, 500, 500, 500, 50, 44, 60, 62, 500, 38, 500, 64, 500, 118, 94, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774639066925524, "mean_inference_ms": 1.2171717295089168, "mean_action_processing_ms": 0.14204343519852086, "mean_env_wait_ms": 0.08184254032586825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030927419662475586, "StateBufferConnector_ms": 0.009000062942504883, "ViewRequirementAgentConnector_ms": 0.11901140213012695}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5572.793640513544, "num_env_steps_trained_throughput_per_sec": 5572.793640513544, "timesteps_total": 540000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 3275.076, "sample_time_ms": 2745.7, "load_time_ms": 17.796, "load_throughput": 1011463.711, "learn_time_ms": 500.001, "learn_throughput": 35999.914, "synch_weights_time_ms": 9.375}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2014, "training_iteration": 30, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-14", "timestamp": 1698248294, "time_this_iter_s": 3.235976457595825, "time_total_s": 101.53504514694214, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 101.53504514694214, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 62.25, "ram_util_percent": 27.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309564e-10, "cur_lr": 0.0003, "total_loss": 6.391265127393934, "policy_loss": -0.0001242044899198744, "vf_loss": 6.391440200805664, "vf_explained_var": -1.288784874810113e-06, "kl": 0.0007461901075430432, "entropy": 0.5086340645949046, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1373.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.282999999999824, "episode_len_mean": 252.78, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.700000000000024, 44.900000000000006, -50.00000000000044, 45.9, 30.699999999999996, -50.00000000000044, 41.90000000000001, 40.70000000000002, 47.1, 45.5, -50.00000000000044, 46.099999999999994, 38.300000000000026, 41.90000000000001, 42.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 44.10000000000001, 43.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, 43.7, -50.00000000000044, 38.300000000000026, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 36.30000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 26.299999999999933, -50.00000000000044, 41.90000000000001, 12.299999999999734, 21.09999999999986, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, 39.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 44.7, 41.30000000000001, 37.300000000000026, 45.1, 43.7, 41.90000000000001, 45.1, 40.10000000000002, 47.1, 25.29999999999992, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 36.30000000000003, 42.900000000000006, 46.5, 24.69999999999991, 46.9, -50.00000000000044, 43.7], "episode_lengths": [174, 52, 500, 42, 194, 500, 82, 94, 30, 46, 500, 40, 118, 82, 80, 42, 500, 500, 500, 500, 50, 44, 60, 62, 500, 38, 500, 64, 500, 118, 94, 500, 500, 500, 500, 34, 34, 138, 60, 500, 500, 500, 500, 500, 272, 500, 500, 338, 500, 500, 98, 500, 54, 32, 500, 238, 500, 82, 378, 290, 34, 500, 500, 48, 102, 38, 500, 500, 84, 500, 70, 500, 500, 50, 62, 500, 500, 46, 54, 88, 128, 50, 64, 82, 50, 100, 30, 248, 500, 38, 500, 500, 62, 138, 72, 36, 254, 32, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37885138142215113, "mean_inference_ms": 1.220432934440813, "mean_action_processing_ms": 0.1421088968935114, "mean_env_wait_ms": 0.08230712330211214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026014328002929688, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.13801240921020508}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.282999999999824, "episode_len_mean": 252.78, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.700000000000024, 44.900000000000006, -50.00000000000044, 45.9, 30.699999999999996, -50.00000000000044, 41.90000000000001, 40.70000000000002, 47.1, 45.5, -50.00000000000044, 46.099999999999994, 38.300000000000026, 41.90000000000001, 42.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 44.10000000000001, 43.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, 43.7, -50.00000000000044, 38.300000000000026, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 36.30000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 26.299999999999933, -50.00000000000044, 41.90000000000001, 12.299999999999734, 21.09999999999986, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, 39.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 44.7, 41.30000000000001, 37.300000000000026, 45.1, 43.7, 41.90000000000001, 45.1, 40.10000000000002, 47.1, 25.29999999999992, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 36.30000000000003, 42.900000000000006, 46.5, 24.69999999999991, 46.9, -50.00000000000044, 43.7], "episode_lengths": [174, 52, 500, 42, 194, 500, 82, 94, 30, 46, 500, 40, 118, 82, 80, 42, 500, 500, 500, 500, 50, 44, 60, 62, 500, 38, 500, 64, 500, 118, 94, 500, 500, 500, 500, 34, 34, 138, 60, 500, 500, 500, 500, 500, 272, 500, 500, 338, 500, 500, 98, 500, 54, 32, 500, 238, 500, 82, 378, 290, 34, 500, 500, 48, 102, 38, 500, 500, 84, 500, 70, 500, 500, 50, 62, 500, 500, 46, 54, 88, 128, 50, 64, 82, 50, 100, 30, 248, 500, 38, 500, 500, 62, 138, 72, 36, 254, 32, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37885138142215113, "mean_inference_ms": 1.220432934440813, "mean_action_processing_ms": 0.1421088968935114, "mean_env_wait_ms": 0.08230712330211214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026014328002929688, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.13801240921020508}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4819.307391909689, "num_env_steps_trained_throughput_per_sec": 4819.307391909689, "timesteps_total": 558000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 558000, "timers": {"training_iteration_time_ms": 3318.776, "sample_time_ms": 2786.096, "load_time_ms": 17.796, "load_throughput": 1011451.515, "learn_time_ms": 503.105, "learn_throughput": 35777.83, "synch_weights_time_ms": 9.475}, "counters": {"num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "done": false, "episodes_total": 2081, "training_iteration": 31, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-18", "timestamp": 1698248298, "time_this_iter_s": 3.741971492767334, "time_total_s": 105.27701663970947, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 105.27701663970947, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 63.2, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154782e-11, "cur_lr": 0.0003, "total_loss": 6.779597844017877, "policy_loss": -0.00037272340721554225, "vf_loss": 6.780023670196533, "vf_explained_var": -4.230605231391059e-06, "kl": 0.0007934619315190301, "entropy": 0.5316852437125312, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.933999999999835, "episode_len_mean": 251.3, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 44.7, 41.30000000000001, 37.300000000000026, 45.1, 43.7, 41.90000000000001, 45.1, 40.10000000000002, 47.1, 25.29999999999992, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 36.30000000000003, 42.900000000000006, 46.5, 24.69999999999991, 46.9, -50.00000000000044, 43.7, -50.00000000000044, 43.7, -50.00000000000044, 42.500000000000014, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 35.70000000000003, 39.90000000000002, -50.00000000000044, 36.50000000000003, 0.8999999999995723, 37.10000000000003, 30.9, 15.899999999999785, -50.00000000000044, -50.00000000000044, 46.9, 38.50000000000003, -50.00000000000044, -50.00000000000044, 44.5, 37.300000000000026, 41.30000000000001, -50.00000000000044, 43.10000000000001, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.500000000000014, -50.00000000000044, 39.50000000000002, -50.00000000000044, 16.09999999999979, 39.300000000000026, -50.00000000000044, 44.7, 22.49999999999988, 40.90000000000002, 32.50000000000002, 41.30000000000001, 44.5, -50.00000000000044, 42.70000000000001, 32.100000000000016, 44.7, 34.50000000000004, 32.700000000000024, 47.3, 36.10000000000004, -50.00000000000044, 44.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006], "episode_lengths": [38, 500, 500, 84, 500, 70, 500, 500, 50, 62, 500, 500, 46, 54, 88, 128, 50, 64, 82, 50, 100, 30, 248, 500, 38, 500, 500, 62, 138, 72, 36, 254, 32, 500, 64, 500, 64, 500, 76, 500, 188, 500, 52, 500, 500, 196, 500, 144, 102, 500, 136, 492, 130, 192, 342, 500, 500, 32, 116, 500, 500, 56, 128, 88, 500, 70, 154, 500, 500, 48, 500, 86, 500, 106, 500, 340, 108, 500, 54, 276, 92, 176, 88, 56, 500, 74, 180, 54, 156, 174, 28, 140, 500, 54, 500, 80, 500, 500, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3789468082102823, "mean_inference_ms": 1.220437022352552, "mean_action_processing_ms": 0.14211739236236587, "mean_env_wait_ms": 0.08235205784262822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299952507019043, "StateBufferConnector_ms": 0.0020275115966796875, "ViewRequirementAgentConnector_ms": 0.11782526969909668}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.933999999999835, "episode_len_mean": 251.3, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 44.7, 41.30000000000001, 37.300000000000026, 45.1, 43.7, 41.90000000000001, 45.1, 40.10000000000002, 47.1, 25.29999999999992, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 36.30000000000003, 42.900000000000006, 46.5, 24.69999999999991, 46.9, -50.00000000000044, 43.7, -50.00000000000044, 43.7, -50.00000000000044, 42.500000000000014, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 35.70000000000003, 39.90000000000002, -50.00000000000044, 36.50000000000003, 0.8999999999995723, 37.10000000000003, 30.9, 15.899999999999785, -50.00000000000044, -50.00000000000044, 46.9, 38.50000000000003, -50.00000000000044, -50.00000000000044, 44.5, 37.300000000000026, 41.30000000000001, -50.00000000000044, 43.10000000000001, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.500000000000014, -50.00000000000044, 39.50000000000002, -50.00000000000044, 16.09999999999979, 39.300000000000026, -50.00000000000044, 44.7, 22.49999999999988, 40.90000000000002, 32.50000000000002, 41.30000000000001, 44.5, -50.00000000000044, 42.70000000000001, 32.100000000000016, 44.7, 34.50000000000004, 32.700000000000024, 47.3, 36.10000000000004, -50.00000000000044, 44.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006], "episode_lengths": [38, 500, 500, 84, 500, 70, 500, 500, 50, 62, 500, 500, 46, 54, 88, 128, 50, 64, 82, 50, 100, 30, 248, 500, 38, 500, 500, 62, 138, 72, 36, 254, 32, 500, 64, 500, 64, 500, 76, 500, 188, 500, 52, 500, 500, 196, 500, 144, 102, 500, 136, 492, 130, 192, 342, 500, 500, 32, 116, 500, 500, 56, 128, 88, 500, 70, 154, 500, 500, 48, 500, 86, 500, 106, 500, 340, 108, 500, 54, 276, 92, 176, 88, 56, 500, 74, 180, 54, 156, 174, 28, 140, 500, 54, 500, 80, 500, 500, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3789468082102823, "mean_inference_ms": 1.220437022352552, "mean_action_processing_ms": 0.14211739236236587, "mean_env_wait_ms": 0.08235205784262822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299952507019043, "StateBufferConnector_ms": 0.0020275115966796875, "ViewRequirementAgentConnector_ms": 0.11782526969909668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5242.309534788818, "num_env_steps_trained_throughput_per_sec": 5242.309534788818, "timesteps_total": 576000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 3333.339, "sample_time_ms": 2806.399, "load_time_ms": 17.996, "load_throughput": 1000220.877, "learn_time_ms": 497.062, "learn_throughput": 36212.806, "synch_weights_time_ms": 9.478}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2146, "training_iteration": 32, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-21", "timestamp": 1698248301, "time_this_iter_s": 3.4395973682403564, "time_total_s": 108.71661400794983, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 108.71661400794983, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 59.760000000000005, "ram_util_percent": 27.439999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.656612873077391e-11, "cur_lr": 0.0003, "total_loss": 6.536657947964138, "policy_loss": -0.0006486222561862733, "vf_loss": 6.537354818979899, "vf_explained_var": -4.886256323920356e-06, "kl": 0.0012761383885845135, "entropy": 0.4821898294819726, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1463.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.609999999999818, "episode_len_mean": 264.52, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.500000000000014, -50.00000000000044, 39.50000000000002, -50.00000000000044, 16.09999999999979, 39.300000000000026, -50.00000000000044, 44.7, 22.49999999999988, 40.90000000000002, 32.50000000000002, 41.30000000000001, 44.5, -50.00000000000044, 42.70000000000001, 32.100000000000016, 44.7, 34.50000000000004, 32.700000000000024, 47.3, 36.10000000000004, -50.00000000000044, 44.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 9.8999999999997, 27.699999999999953, 38.90000000000002, 23.8999999999999, 46.5, 43.7, 41.90000000000001, -50.00000000000044, 30.699999999999996, 41.100000000000016, -50.00000000000044, 45.7, 45.7, 46.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.10000000000001, 17.099999999999802, 34.50000000000004, 36.10000000000004, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.5, 33.500000000000036, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.9, 46.699999999999996, 43.900000000000006, 47.5, 45.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 9.699999999999697, 41.30000000000001, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 17.099999999999802, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001], "episode_lengths": [70, 154, 500, 500, 48, 500, 86, 500, 106, 500, 340, 108, 500, 54, 276, 92, 176, 88, 56, 500, 74, 180, 54, 156, 174, 28, 140, 500, 54, 500, 80, 500, 500, 500, 62, 500, 402, 224, 112, 262, 36, 64, 82, 500, 194, 90, 500, 44, 44, 38, 38, 500, 500, 500, 500, 84, 80, 330, 156, 140, 38, 68, 500, 500, 500, 500, 500, 66, 500, 46, 166, 48, 500, 94, 500, 42, 34, 62, 26, 50, 500, 500, 50, 500, 500, 62, 500, 404, 88, 500, 214, 500, 500, 362, 500, 330, 48, 500, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37885141854726007, "mean_inference_ms": 1.2208810658483342, "mean_action_processing_ms": 0.1423376771860188, "mean_env_wait_ms": 0.08243669082310001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02695751190185547, "StateBufferConnector_ms": 0.013025522232055664, "ViewRequirementAgentConnector_ms": 0.12490200996398926}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.609999999999818, "episode_len_mean": 264.52, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.500000000000014, -50.00000000000044, 39.50000000000002, -50.00000000000044, 16.09999999999979, 39.300000000000026, -50.00000000000044, 44.7, 22.49999999999988, 40.90000000000002, 32.50000000000002, 41.30000000000001, 44.5, -50.00000000000044, 42.70000000000001, 32.100000000000016, 44.7, 34.50000000000004, 32.700000000000024, 47.3, 36.10000000000004, -50.00000000000044, 44.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 9.8999999999997, 27.699999999999953, 38.90000000000002, 23.8999999999999, 46.5, 43.7, 41.90000000000001, -50.00000000000044, 30.699999999999996, 41.100000000000016, -50.00000000000044, 45.7, 45.7, 46.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.10000000000001, 17.099999999999802, 34.50000000000004, 36.10000000000004, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.5, 33.500000000000036, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.9, 46.699999999999996, 43.900000000000006, 47.5, 45.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 9.699999999999697, 41.30000000000001, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 17.099999999999802, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001], "episode_lengths": [70, 154, 500, 500, 48, 500, 86, 500, 106, 500, 340, 108, 500, 54, 276, 92, 176, 88, 56, 500, 74, 180, 54, 156, 174, 28, 140, 500, 54, 500, 80, 500, 500, 500, 62, 500, 402, 224, 112, 262, 36, 64, 82, 500, 194, 90, 500, 44, 44, 38, 38, 500, 500, 500, 500, 84, 80, 330, 156, 140, 38, 68, 500, 500, 500, 500, 500, 66, 500, 46, 166, 48, 500, 94, 500, 42, 34, 62, 26, 50, 500, 500, 50, 500, 500, 62, 500, 404, 88, 500, 214, 500, 500, 362, 500, 330, 48, 500, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37885141854726007, "mean_inference_ms": 1.2208810658483342, "mean_action_processing_ms": 0.1423376771860188, "mean_env_wait_ms": 0.08243669082310001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02695751190185547, "StateBufferConnector_ms": 0.013025522232055664, "ViewRequirementAgentConnector_ms": 0.12490200996398926}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5160.560106987803, "num_env_steps_trained_throughput_per_sec": 5160.560106987803, "timesteps_total": 594000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 594000, "timers": {"training_iteration_time_ms": 3357.841, "sample_time_ms": 2835.199, "load_time_ms": 17.596, "load_throughput": 1022956.62, "learn_time_ms": 492.961, "learn_throughput": 36514.048, "synch_weights_time_ms": 9.481}, "counters": {"num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "done": false, "episodes_total": 2211, "training_iteration": 33, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-25", "timestamp": 1698248305, "time_this_iter_s": 3.492988348007202, "time_total_s": 112.20960235595703, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 112.20960235595703, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 59.56, "ram_util_percent": 27.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386954e-11, "cur_lr": 0.0003, "total_loss": 6.734525129530165, "policy_loss": -0.00022127822869353825, "vf_loss": 6.73479675716824, "vf_explained_var": -1.983907487657335e-05, "kl": 0.0010474838810454103, "entropy": 0.5031392706765069, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1508.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.445999999999812, "episode_len_mean": 266.16, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, -50.00000000000044, 45.9, 46.699999999999996, 43.900000000000006, 47.5, 45.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 9.699999999999697, 41.30000000000001, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 17.099999999999802, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.10000000000004, 30.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.5, 45.7, 26.299999999999933, 40.90000000000002, 26.499999999999936, 9.299999999999692, 43.7, -50.00000000000044, 44.7, -50.00000000000044, 46.099999999999994, 43.7, 10.299999999999706, -50.00000000000044, 47.3, 36.50000000000003, 29.299999999999976, 42.900000000000006, 45.9, 45.5, 41.90000000000001, 44.5, -50.00000000000044, 43.30000000000001, 42.900000000000006, 34.10000000000004, -50.00000000000044, -50.00000000000044, 45.5, 46.5, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 36.50000000000003, 41.30000000000001, 11.29999999999972, 45.3, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 2.699999999999598, 17.299999999999805, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 46.5, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 39.50000000000002, 41.30000000000001, 42.30000000000001, 47.1, 34.10000000000004], "episode_lengths": [500, 94, 500, 42, 34, 62, 26, 50, 500, 500, 50, 500, 500, 62, 500, 404, 88, 500, 214, 500, 500, 362, 500, 330, 48, 500, 500, 78, 500, 140, 194, 500, 40, 500, 500, 500, 120, 36, 44, 238, 92, 236, 408, 64, 500, 54, 500, 40, 64, 398, 500, 28, 136, 208, 72, 42, 46, 82, 56, 500, 68, 72, 160, 500, 500, 46, 36, 500, 30, 500, 500, 50, 500, 136, 88, 388, 48, 500, 100, 500, 500, 474, 328, 500, 500, 500, 144, 36, 50, 76, 500, 500, 500, 42, 500, 106, 88, 78, 30, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37872315940694873, "mean_inference_ms": 1.222208929225787, "mean_action_processing_ms": 0.14251720246343022, "mean_env_wait_ms": 0.08247067284477862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026002883911132812, "StateBufferConnector_ms": 0.007001399993896484, "ViewRequirementAgentConnector_ms": 0.12697386741638184}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.445999999999812, "episode_len_mean": 266.16, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, -50.00000000000044, 45.9, 46.699999999999996, 43.900000000000006, 47.5, 45.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 9.699999999999697, 41.30000000000001, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 17.099999999999802, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.10000000000004, 30.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.5, 45.7, 26.299999999999933, 40.90000000000002, 26.499999999999936, 9.299999999999692, 43.7, -50.00000000000044, 44.7, -50.00000000000044, 46.099999999999994, 43.7, 10.299999999999706, -50.00000000000044, 47.3, 36.50000000000003, 29.299999999999976, 42.900000000000006, 45.9, 45.5, 41.90000000000001, 44.5, -50.00000000000044, 43.30000000000001, 42.900000000000006, 34.10000000000004, -50.00000000000044, -50.00000000000044, 45.5, 46.5, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 36.50000000000003, 41.30000000000001, 11.29999999999972, 45.3, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 2.699999999999598, 17.299999999999805, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 46.5, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 39.50000000000002, 41.30000000000001, 42.30000000000001, 47.1, 34.10000000000004], "episode_lengths": [500, 94, 500, 42, 34, 62, 26, 50, 500, 500, 50, 500, 500, 62, 500, 404, 88, 500, 214, 500, 500, 362, 500, 330, 48, 500, 500, 78, 500, 140, 194, 500, 40, 500, 500, 500, 120, 36, 44, 238, 92, 236, 408, 64, 500, 54, 500, 40, 64, 398, 500, 28, 136, 208, 72, 42, 46, 82, 56, 500, 68, 72, 160, 500, 500, 46, 36, 500, 30, 500, 500, 50, 500, 136, 88, 388, 48, 500, 100, 500, 500, 474, 328, 500, 500, 500, 144, 36, 50, 76, 500, 500, 500, 42, 500, 106, 88, 78, 30, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37872315940694873, "mean_inference_ms": 1.222208929225787, "mean_action_processing_ms": 0.14251720246343022, "mean_env_wait_ms": 0.08247067284477862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026002883911132812, "StateBufferConnector_ms": 0.007001399993896484, "ViewRequirementAgentConnector_ms": 0.12697386741638184}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5418.656319150739, "num_env_steps_trained_throughput_per_sec": 5418.656319150739, "timesteps_total": 612000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 3363.629, "sample_time_ms": 2839.651, "load_time_ms": 18.397, "load_throughput": 978425.602, "learn_time_ms": 493.695, "learn_throughput": 36459.789, "synch_weights_time_ms": 9.284}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2283, "training_iteration": 34, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-28", "timestamp": 1698248308, "time_this_iter_s": 3.3268537521362305, "time_total_s": 115.53645610809326, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 115.53645610809326, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 55.71999999999999, "ram_util_percent": 27.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693477e-11, "cur_lr": 0.0003, "total_loss": 7.180016877916124, "policy_loss": -0.0006215953080552733, "vf_loss": 7.180688518948025, "vf_explained_var": -7.259845733642578e-06, "kl": 0.0009839304451563495, "entropy": 0.5009752088122897, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1553.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.759999999999847, "episode_len_mean": 233.08, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.299999999999805, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 46.5, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 39.50000000000002, 41.30000000000001, 42.30000000000001, 47.1, 34.10000000000004, 46.099999999999994, 46.099999999999994, 29.49999999999998, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, 22.699999999999882, 38.50000000000003, 9.499999999999694, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.3, -50.00000000000044, 44.10000000000001, 44.7, 32.50000000000002, 41.30000000000001, 16.29999999999979, 46.3, 42.30000000000001, -50.00000000000044, 46.699999999999996, 44.5, 45.1, 45.7, 47.3, -50.00000000000044, 38.700000000000024, 43.10000000000001, 47.1, 41.30000000000001, -50.00000000000044, 46.5, 42.900000000000006, 46.099999999999994, 42.500000000000014, 45.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 31.1, 34.30000000000004, 43.7, 45.3, -50.00000000000044, 44.900000000000006, 5.6999999999996405, 39.10000000000002, -50.00000000000044, 44.900000000000006, 43.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.3, 42.30000000000001, 44.7, -50.00000000000044, 8.49999999999968, 44.7, 36.30000000000003, 35.30000000000004, 30.699999999999996, 39.300000000000026, 46.699999999999996, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5], "episode_lengths": [328, 500, 500, 500, 144, 36, 50, 76, 500, 500, 500, 42, 500, 106, 88, 78, 30, 160, 40, 40, 206, 122, 500, 500, 44, 500, 500, 68, 274, 116, 406, 500, 500, 182, 500, 164, 500, 500, 94, 38, 500, 60, 54, 176, 88, 338, 38, 78, 500, 34, 56, 50, 44, 28, 500, 114, 70, 30, 88, 500, 36, 72, 40, 76, 42, 500, 50, 500, 500, 190, 158, 64, 48, 500, 52, 444, 110, 500, 52, 62, 500, 36, 500, 500, 48, 78, 54, 500, 416, 54, 138, 148, 194, 108, 34, 200, 500, 500, 500, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.378777008429094, "mean_inference_ms": 1.2214510138351409, "mean_action_processing_ms": 0.142576948922677, "mean_env_wait_ms": 0.08252646340361437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099989891052246, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.1220083236694336}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.759999999999847, "episode_len_mean": 233.08, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.299999999999805, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 46.5, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 39.50000000000002, 41.30000000000001, 42.30000000000001, 47.1, 34.10000000000004, 46.099999999999994, 46.099999999999994, 29.49999999999998, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, 22.699999999999882, 38.50000000000003, 9.499999999999694, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.3, -50.00000000000044, 44.10000000000001, 44.7, 32.50000000000002, 41.30000000000001, 16.29999999999979, 46.3, 42.30000000000001, -50.00000000000044, 46.699999999999996, 44.5, 45.1, 45.7, 47.3, -50.00000000000044, 38.700000000000024, 43.10000000000001, 47.1, 41.30000000000001, -50.00000000000044, 46.5, 42.900000000000006, 46.099999999999994, 42.500000000000014, 45.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 31.1, 34.30000000000004, 43.7, 45.3, -50.00000000000044, 44.900000000000006, 5.6999999999996405, 39.10000000000002, -50.00000000000044, 44.900000000000006, 43.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.3, 42.30000000000001, 44.7, -50.00000000000044, 8.49999999999968, 44.7, 36.30000000000003, 35.30000000000004, 30.699999999999996, 39.300000000000026, 46.699999999999996, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5], "episode_lengths": [328, 500, 500, 500, 144, 36, 50, 76, 500, 500, 500, 42, 500, 106, 88, 78, 30, 160, 40, 40, 206, 122, 500, 500, 44, 500, 500, 68, 274, 116, 406, 500, 500, 182, 500, 164, 500, 500, 94, 38, 500, 60, 54, 176, 88, 338, 38, 78, 500, 34, 56, 50, 44, 28, 500, 114, 70, 30, 88, 500, 36, 72, 40, 76, 42, 500, 50, 500, 500, 190, 158, 64, 48, 500, 52, 444, 110, 500, 52, 62, 500, 36, 500, 500, 48, 78, 54, 500, 416, 54, 138, 148, 194, 108, 34, 200, 500, 500, 500, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.378777008429094, "mean_inference_ms": 1.2214510138351409, "mean_action_processing_ms": 0.142576948922677, "mean_env_wait_ms": 0.08252646340361437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099989891052246, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.1220083236694336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5391.507384541466, "num_env_steps_trained_throughput_per_sec": 5391.507384541466, "timesteps_total": 630000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 3367.19, "sample_time_ms": 2848.852, "load_time_ms": 17.297, "load_throughput": 1040651.152, "learn_time_ms": 489.053, "learn_throughput": 36805.839, "synch_weights_time_ms": 9.387}, "counters": {"num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 2365, "training_iteration": 35, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-31", "timestamp": 1698248311, "time_this_iter_s": 3.3445842266082764, "time_total_s": 118.88104033470154, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 118.88104033470154, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 58.96, "ram_util_percent": 27.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346739e-12, "cur_lr": 0.0003, "total_loss": 6.377410221099853, "policy_loss": -0.00023555573489930895, "vf_loss": 6.377695751190186, "vf_explained_var": -3.956423865424262e-06, "kl": 0.0005425617001713414, "entropy": 0.4991405765215556, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1598.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.211999999999824, "episode_len_mean": 258.52, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 31.1, 34.30000000000004, 43.7, 45.3, -50.00000000000044, 44.900000000000006, 5.6999999999996405, 39.10000000000002, -50.00000000000044, 44.900000000000006, 43.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.3, 42.30000000000001, 44.7, -50.00000000000044, 8.49999999999968, 44.7, 36.30000000000003, 35.30000000000004, 30.699999999999996, 39.300000000000026, 46.699999999999996, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 42.10000000000001, 42.900000000000006, 41.90000000000001, 41.100000000000016, -50.00000000000044, 39.50000000000002, 35.10000000000004, 26.69999999999994, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 43.7, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.9, 46.9, -50.00000000000044, 28.499999999999964, 2.499999999999595, -50.00000000000044, 39.300000000000026, 45.5, -50.00000000000044, 41.70000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 29.899999999999984, 0.09999999999956088, 43.50000000000001, -50.00000000000044, 43.30000000000001, 39.70000000000002, 29.099999999999973, 27.899999999999956, 46.099999999999994, 44.300000000000004, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044, 29.299999999999976, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 34.50000000000004, 44.900000000000006], "episode_lengths": [500, 50, 500, 500, 190, 158, 64, 48, 500, 52, 444, 110, 500, 52, 62, 500, 36, 500, 500, 48, 78, 54, 500, 416, 54, 138, 148, 194, 108, 34, 200, 500, 500, 500, 26, 500, 80, 72, 82, 90, 500, 106, 150, 234, 500, 78, 500, 500, 42, 64, 500, 144, 500, 500, 44, 58, 500, 494, 500, 42, 40, 500, 500, 42, 32, 500, 216, 476, 500, 108, 46, 500, 84, 74, 500, 500, 40, 202, 500, 66, 500, 68, 104, 210, 222, 40, 58, 500, 82, 74, 500, 208, 500, 52, 500, 500, 500, 56, 156, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37878025104247215, "mean_inference_ms": 1.2214459759616578, "mean_action_processing_ms": 0.14229543858102098, "mean_env_wait_ms": 0.08263935569072917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399754524230957, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.13199639320373535}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.211999999999824, "episode_len_mean": 258.52, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 31.1, 34.30000000000004, 43.7, 45.3, -50.00000000000044, 44.900000000000006, 5.6999999999996405, 39.10000000000002, -50.00000000000044, 44.900000000000006, 43.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.3, 42.30000000000001, 44.7, -50.00000000000044, 8.49999999999968, 44.7, 36.30000000000003, 35.30000000000004, 30.699999999999996, 39.300000000000026, 46.699999999999996, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 42.10000000000001, 42.900000000000006, 41.90000000000001, 41.100000000000016, -50.00000000000044, 39.50000000000002, 35.10000000000004, 26.69999999999994, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 43.7, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.9, 46.9, -50.00000000000044, 28.499999999999964, 2.499999999999595, -50.00000000000044, 39.300000000000026, 45.5, -50.00000000000044, 41.70000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 29.899999999999984, 0.09999999999956088, 43.50000000000001, -50.00000000000044, 43.30000000000001, 39.70000000000002, 29.099999999999973, 27.899999999999956, 46.099999999999994, 44.300000000000004, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044, 29.299999999999976, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 34.50000000000004, 44.900000000000006], "episode_lengths": [500, 50, 500, 500, 190, 158, 64, 48, 500, 52, 444, 110, 500, 52, 62, 500, 36, 500, 500, 48, 78, 54, 500, 416, 54, 138, 148, 194, 108, 34, 200, 500, 500, 500, 26, 500, 80, 72, 82, 90, 500, 106, 150, 234, 500, 78, 500, 500, 42, 64, 500, 144, 500, 500, 44, 58, 500, 494, 500, 42, 40, 500, 500, 42, 32, 500, 216, 476, 500, 108, 46, 500, 84, 74, 500, 500, 40, 202, 500, 66, 500, 68, 104, 210, 222, 40, 58, 500, 82, 74, 500, 208, 500, 52, 500, 500, 500, 56, 156, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37878025104247215, "mean_inference_ms": 1.2214459759616578, "mean_action_processing_ms": 0.14229543858102098, "mean_env_wait_ms": 0.08263935569072917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399754524230957, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.13199639320373535}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5349.940482576539, "num_env_steps_trained_throughput_per_sec": 5349.940482576539, "timesteps_total": 648000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 3378.445, "sample_time_ms": 2858.452, "load_time_ms": 17.297, "load_throughput": 1040645.415, "learn_time_ms": 490.908, "learn_throughput": 36666.753, "synch_weights_time_ms": 9.286}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2430, "training_iteration": 36, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-35", "timestamp": 1698248315, "time_this_iter_s": 3.3705196380615234, "time_total_s": 122.25155997276306, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 122.25155997276306, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 65.95, "ram_util_percent": 27.424999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9103830456733693e-12, "cur_lr": 0.0003, "total_loss": 7.2342497719658745, "policy_loss": -0.0007977594517999226, "vf_loss": 7.235097503662109, "vf_explained_var": -3.1987826029459634e-06, "kl": 0.0012830476547530149, "entropy": 0.4998937957816654, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1643.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.053999999999826, "episode_len_mean": 260.12, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.099999999999994, 29.899999999999984, 0.09999999999956088, 43.50000000000001, -50.00000000000044, 43.30000000000001, 39.70000000000002, 29.099999999999973, 27.899999999999956, 46.099999999999994, 44.300000000000004, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044, 29.299999999999976, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 34.50000000000004, 44.900000000000006, 24.299999999999905, 43.30000000000001, -50.00000000000044, 42.30000000000001, 45.3, 35.500000000000036, 35.10000000000004, 45.3, 45.5, 26.69999999999994, -50.00000000000044, 46.099999999999994, 44.900000000000006, 33.10000000000003, -50.00000000000044, 16.09999999999979, -50.00000000000044, 8.49999999999968, 47.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.3, -50.00000000000044, 46.9, 40.30000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 12.499999999999737, 39.10000000000002, -50.00000000000044, 37.300000000000026, -50.00000000000044, 42.10000000000001, 43.50000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 45.3, 46.3, -50.00000000000044, 41.30000000000001, 35.10000000000004, 45.1, 45.5, 40.10000000000002, -50.00000000000044, 34.50000000000004, 46.5, 16.499999999999794, 26.09999999999993, 35.70000000000003, -50.00000000000044, -50.00000000000044, 29.299999999999976, 43.50000000000001, -50.00000000000044, 45.1, 0.09999999999956088, 1.8999999999995865, 34.900000000000034, 9.8999999999997, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 40, 202, 500, 66, 500, 68, 104, 210, 222, 40, 58, 500, 82, 74, 500, 208, 500, 52, 500, 500, 500, 56, 156, 52, 258, 68, 500, 78, 48, 146, 150, 48, 46, 234, 500, 40, 52, 170, 500, 340, 500, 416, 28, 52, 500, 500, 500, 500, 500, 112, 38, 500, 32, 98, 500, 500, 108, 376, 110, 500, 128, 500, 80, 66, 500, 40, 500, 46, 48, 38, 500, 88, 150, 50, 46, 100, 500, 156, 36, 336, 240, 144, 500, 500, 208, 66, 500, 50, 500, 482, 152, 402, 500, 500, 90, 32, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37803195997753475, "mean_inference_ms": 1.219542031919718, "mean_action_processing_ms": 0.14228403191297412, "mean_env_wait_ms": 0.08225212041078328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027997970581054688, "StateBufferConnector_ms": 0.00699925422668457, "ViewRequirementAgentConnector_ms": 0.13198471069335938}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.053999999999826, "episode_len_mean": 260.12, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.099999999999994, 29.899999999999984, 0.09999999999956088, 43.50000000000001, -50.00000000000044, 43.30000000000001, 39.70000000000002, 29.099999999999973, 27.899999999999956, 46.099999999999994, 44.300000000000004, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044, 29.299999999999976, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 34.50000000000004, 44.900000000000006, 24.299999999999905, 43.30000000000001, -50.00000000000044, 42.30000000000001, 45.3, 35.500000000000036, 35.10000000000004, 45.3, 45.5, 26.69999999999994, -50.00000000000044, 46.099999999999994, 44.900000000000006, 33.10000000000003, -50.00000000000044, 16.09999999999979, -50.00000000000044, 8.49999999999968, 47.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.3, -50.00000000000044, 46.9, 40.30000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 12.499999999999737, 39.10000000000002, -50.00000000000044, 37.300000000000026, -50.00000000000044, 42.10000000000001, 43.50000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 45.3, 46.3, -50.00000000000044, 41.30000000000001, 35.10000000000004, 45.1, 45.5, 40.10000000000002, -50.00000000000044, 34.50000000000004, 46.5, 16.499999999999794, 26.09999999999993, 35.70000000000003, -50.00000000000044, -50.00000000000044, 29.299999999999976, 43.50000000000001, -50.00000000000044, 45.1, 0.09999999999956088, 1.8999999999995865, 34.900000000000034, 9.8999999999997, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 40, 202, 500, 66, 500, 68, 104, 210, 222, 40, 58, 500, 82, 74, 500, 208, 500, 52, 500, 500, 500, 56, 156, 52, 258, 68, 500, 78, 48, 146, 150, 48, 46, 234, 500, 40, 52, 170, 500, 340, 500, 416, 28, 52, 500, 500, 500, 500, 500, 112, 38, 500, 32, 98, 500, 500, 108, 376, 110, 500, 128, 500, 80, 66, 500, 40, 500, 46, 48, 38, 500, 88, 150, 50, 46, 100, 500, 156, 36, 336, 240, 144, 500, 500, 208, 66, 500, 50, 500, 482, 152, 402, 500, 500, 90, 32, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37803195997753475, "mean_inference_ms": 1.219542031919718, "mean_action_processing_ms": 0.14228403191297412, "mean_env_wait_ms": 0.08225212041078328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027997970581054688, "StateBufferConnector_ms": 0.00699925422668457, "ViewRequirementAgentConnector_ms": 0.13198471069335938}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5219.663372291993, "num_env_steps_trained_throughput_per_sec": 5219.663372291993, "timesteps_total": 666000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 666000, "timers": {"training_iteration_time_ms": 3395.795, "sample_time_ms": 2876.501, "load_time_ms": 17.497, "load_throughput": 1028745.502, "learn_time_ms": 489.608, "learn_throughput": 36764.098, "synch_weights_time_ms": 9.187}, "counters": {"num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "done": false, "episodes_total": 2504, "training_iteration": 37, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-38", "timestamp": 1698248318, "time_this_iter_s": 3.4544970989227295, "time_total_s": 125.70605707168579, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 125.70605707168579, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 52.06, "ram_util_percent": 27.439999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366847e-12, "cur_lr": 0.0003, "total_loss": 6.794997829861111, "policy_loss": -0.00029743599394957225, "vf_loss": 6.795346101125081, "vf_explained_var": -2.6623407999674478e-06, "kl": 0.0009431400645199675, "entropy": 0.5077245553334554, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1688.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.541999999999823, "episode_len_mean": 265.24, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, 43.50000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 45.3, 46.3, -50.00000000000044, 41.30000000000001, 35.10000000000004, 45.1, 45.5, 40.10000000000002, -50.00000000000044, 34.50000000000004, 46.5, 16.499999999999794, 26.09999999999993, 35.70000000000003, -50.00000000000044, -50.00000000000044, 29.299999999999976, 43.50000000000001, -50.00000000000044, 45.1, 0.09999999999956088, 1.8999999999995865, 34.900000000000034, 9.8999999999997, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, -50.00000000000044, 42.500000000000014, 11.899999999999729, 33.30000000000003, 44.5, 11.899999999999729, -50.00000000000044, 43.50000000000001, 42.500000000000014, 20.299999999999848, 12.099999999999731, 36.900000000000034, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 44.900000000000006, 29.299999999999976, 42.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.1, 23.499999999999893, 45.9, 41.100000000000016, 46.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 28.499999999999964, 43.50000000000001, 22.699999999999882, -50.00000000000044, 24.899999999999913, -50.00000000000044, 37.50000000000003, 41.500000000000014, -50.00000000000044, 42.30000000000001, 44.5, 26.09999999999993, 42.30000000000001, 21.09999999999986, 42.900000000000006, 39.90000000000002, -50.00000000000044, 31.300000000000004], "episode_lengths": [80, 66, 500, 40, 500, 46, 48, 38, 500, 88, 150, 50, 46, 100, 500, 156, 36, 336, 240, 144, 500, 500, 208, 66, 500, 50, 500, 482, 152, 402, 500, 500, 90, 32, 500, 500, 76, 382, 168, 56, 382, 500, 66, 76, 298, 380, 132, 50, 500, 500, 500, 46, 52, 208, 80, 86, 500, 500, 500, 500, 500, 346, 82, 500, 500, 88, 500, 500, 60, 500, 96, 500, 30, 266, 42, 90, 38, 500, 500, 78, 500, 500, 216, 66, 274, 500, 252, 500, 126, 86, 500, 78, 56, 240, 78, 290, 72, 102, 500, 188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37840317239928256, "mean_inference_ms": 1.2187924095667726, "mean_action_processing_ms": 0.1418601192497973, "mean_env_wait_ms": 0.08237333416846977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028002262115478516, "StateBufferConnector_ms": 0.010000467300415039, "ViewRequirementAgentConnector_ms": 0.1089925765991211}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.541999999999823, "episode_len_mean": 265.24, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, 43.50000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 45.3, 46.3, -50.00000000000044, 41.30000000000001, 35.10000000000004, 45.1, 45.5, 40.10000000000002, -50.00000000000044, 34.50000000000004, 46.5, 16.499999999999794, 26.09999999999993, 35.70000000000003, -50.00000000000044, -50.00000000000044, 29.299999999999976, 43.50000000000001, -50.00000000000044, 45.1, 0.09999999999956088, 1.8999999999995865, 34.900000000000034, 9.8999999999997, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, -50.00000000000044, 42.500000000000014, 11.899999999999729, 33.30000000000003, 44.5, 11.899999999999729, -50.00000000000044, 43.50000000000001, 42.500000000000014, 20.299999999999848, 12.099999999999731, 36.900000000000034, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 44.900000000000006, 29.299999999999976, 42.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.1, 23.499999999999893, 45.9, 41.100000000000016, 46.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 28.499999999999964, 43.50000000000001, 22.699999999999882, -50.00000000000044, 24.899999999999913, -50.00000000000044, 37.50000000000003, 41.500000000000014, -50.00000000000044, 42.30000000000001, 44.5, 26.09999999999993, 42.30000000000001, 21.09999999999986, 42.900000000000006, 39.90000000000002, -50.00000000000044, 31.300000000000004], "episode_lengths": [80, 66, 500, 40, 500, 46, 48, 38, 500, 88, 150, 50, 46, 100, 500, 156, 36, 336, 240, 144, 500, 500, 208, 66, 500, 50, 500, 482, 152, 402, 500, 500, 90, 32, 500, 500, 76, 382, 168, 56, 382, 500, 66, 76, 298, 380, 132, 50, 500, 500, 500, 46, 52, 208, 80, 86, 500, 500, 500, 500, 500, 346, 82, 500, 500, 88, 500, 500, 60, 500, 96, 500, 30, 266, 42, 90, 38, 500, 500, 78, 500, 500, 216, 66, 274, 500, 252, 500, 126, 86, 500, 78, 56, 240, 78, 290, 72, 102, 500, 188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37840317239928256, "mean_inference_ms": 1.2187924095667726, "mean_action_processing_ms": 0.1418601192497973, "mean_env_wait_ms": 0.08237333416846977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028002262115478516, "StateBufferConnector_ms": 0.010000467300415039, "ViewRequirementAgentConnector_ms": 0.1089925765991211}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5586.589900158006, "num_env_steps_trained_throughput_per_sec": 5586.589900158006, "timesteps_total": 684000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 3392.498, "sample_time_ms": 2872.202, "load_time_ms": 17.703, "load_throughput": 1016800.97, "learn_time_ms": 490.505, "learn_throughput": 36696.861, "synch_weights_time_ms": 9.087}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2568, "training_iteration": 38, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-42", "timestamp": 1698248322, "time_this_iter_s": 3.2280023097991943, "time_total_s": 128.93405938148499, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 128.93405938148499, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 51.4, "ram_util_percent": 27.380000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183423e-13, "cur_lr": 0.0003, "total_loss": 6.746117644839817, "policy_loss": -0.0003763918661408954, "vf_loss": 6.746542962392171, "vf_explained_var": 0.00011347134908040365, "kl": 0.0014335877991224304, "entropy": 0.4885677569442325, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1733.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.500999999999817, "episode_len_mean": 270.62, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.1, 23.499999999999893, 45.9, 41.100000000000016, 46.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 28.499999999999964, 43.50000000000001, 22.699999999999882, -50.00000000000044, 24.899999999999913, -50.00000000000044, 37.50000000000003, 41.500000000000014, -50.00000000000044, 42.30000000000001, 44.5, 26.09999999999993, 42.30000000000001, 21.09999999999986, 42.900000000000006, 39.90000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, 43.10000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, 44.10000000000001, -50.00000000000044, 46.099999999999994, 4.699999999999626, 14.699999999999768, 36.10000000000004, -50.00000000000044, 17.69999999999981, -50.00000000000044, 47.1, 45.3, 29.49999999999998, -50.00000000000044, 42.900000000000006, 43.900000000000006, 31.70000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, 41.30000000000001, 39.50000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 33.90000000000004, 47.1, 45.1, 41.30000000000001, 45.1, 44.7, 0.2999999999995637, 33.90000000000004, 28.09999999999996, -50.00000000000044, 38.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.1, 35.500000000000036, -50.00000000000044, 32.50000000000002, 41.500000000000014], "episode_lengths": [500, 88, 500, 500, 60, 500, 96, 500, 30, 266, 42, 90, 38, 500, 500, 78, 500, 500, 216, 66, 274, 500, 252, 500, 126, 86, 500, 78, 56, 240, 78, 290, 72, 102, 500, 188, 500, 70, 146, 500, 500, 52, 500, 58, 500, 86, 60, 500, 40, 454, 354, 140, 500, 324, 500, 30, 48, 206, 500, 72, 62, 184, 500, 100, 500, 42, 88, 106, 500, 140, 500, 500, 500, 430, 500, 320, 500, 500, 162, 30, 50, 88, 50, 54, 498, 162, 220, 500, 120, 42, 500, 500, 104, 500, 500, 50, 146, 500, 176, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777063306977448, "mean_inference_ms": 1.2164224124110725, "mean_action_processing_ms": 0.14203132697120058, "mean_env_wait_ms": 0.08204278975548775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100086212158203, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.10997414588928223}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.500999999999817, "episode_len_mean": 270.62, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.1, 23.499999999999893, 45.9, 41.100000000000016, 46.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 28.499999999999964, 43.50000000000001, 22.699999999999882, -50.00000000000044, 24.899999999999913, -50.00000000000044, 37.50000000000003, 41.500000000000014, -50.00000000000044, 42.30000000000001, 44.5, 26.09999999999993, 42.30000000000001, 21.09999999999986, 42.900000000000006, 39.90000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, 43.10000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, 44.10000000000001, -50.00000000000044, 46.099999999999994, 4.699999999999626, 14.699999999999768, 36.10000000000004, -50.00000000000044, 17.69999999999981, -50.00000000000044, 47.1, 45.3, 29.49999999999998, -50.00000000000044, 42.900000000000006, 43.900000000000006, 31.70000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, 41.30000000000001, 39.50000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 33.90000000000004, 47.1, 45.1, 41.30000000000001, 45.1, 44.7, 0.2999999999995637, 33.90000000000004, 28.09999999999996, -50.00000000000044, 38.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.1, 35.500000000000036, -50.00000000000044, 32.50000000000002, 41.500000000000014], "episode_lengths": [500, 88, 500, 500, 60, 500, 96, 500, 30, 266, 42, 90, 38, 500, 500, 78, 500, 500, 216, 66, 274, 500, 252, 500, 126, 86, 500, 78, 56, 240, 78, 290, 72, 102, 500, 188, 500, 70, 146, 500, 500, 52, 500, 58, 500, 86, 60, 500, 40, 454, 354, 140, 500, 324, 500, 30, 48, 206, 500, 72, 62, 184, 500, 100, 500, 42, 88, 106, 500, 140, 500, 500, 500, 430, 500, 320, 500, 500, 162, 30, 50, 88, 50, 54, 498, 162, 220, 500, 120, 42, 500, 500, 104, 500, 500, 50, 146, 500, 176, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777063306977448, "mean_inference_ms": 1.2164224124110725, "mean_action_processing_ms": 0.14203132697120058, "mean_env_wait_ms": 0.08204278975548775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100086212158203, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.10997414588928223}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5486.047931643443, "num_env_steps_trained_throughput_per_sec": 5486.047931643443, "timesteps_total": 702000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 702000, "timers": {"training_iteration_time_ms": 3386.306, "sample_time_ms": 2871.803, "load_time_ms": 18.106, "load_throughput": 994159.571, "learn_time_ms": 484.21, "learn_throughput": 37173.972, "synch_weights_time_ms": 9.086}, "counters": {"num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "done": false, "episodes_total": 2632, "training_iteration": 39, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-45", "timestamp": 1698248325, "time_this_iter_s": 3.2860469818115234, "time_total_s": 132.2201063632965, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 132.2201063632965, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 63.425, "ram_util_percent": 27.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917116e-13, "cur_lr": 0.0003, "total_loss": 6.777309968736437, "policy_loss": -0.0003598736340387, "vf_loss": 6.777717759874132, "vf_explained_var": -1.6689300537109375e-05, "kl": 0.0013388786830799088, "entropy": 0.47848134107059903, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1778.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.195999999999825, "episode_len_mean": 268.68, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.50000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 33.90000000000004, 47.1, 45.1, 41.30000000000001, 45.1, 44.7, 0.2999999999995637, 33.90000000000004, 28.09999999999996, -50.00000000000044, 38.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.1, 35.500000000000036, -50.00000000000044, 32.50000000000002, 41.500000000000014, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.300000000000004, -50.00000000000044, 17.099999999999802, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 42.30000000000001, 36.10000000000004, 32.30000000000002, -50.00000000000044, 31.500000000000007, 14.299999999999763, 42.10000000000001, 28.699999999999967, 46.699999999999996, 34.900000000000034, 44.5, 43.10000000000001, 45.7, -50.00000000000044, 17.899999999999814, 35.70000000000003, 42.10000000000001, 36.50000000000003, 43.30000000000001, 39.70000000000002, 42.500000000000014, -50.00000000000044, 45.7, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 36.30000000000003, 40.70000000000002, -50.00000000000044, 15.299999999999777, -50.00000000000044, 45.9, -50.00000000000044, 27.699999999999953, -50.00000000000044, 38.50000000000003, 43.7, 19.299999999999834, 47.3, -50.00000000000044, 28.89999999999997, 34.900000000000034, 46.9, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.5, -50.00000000000044, 16.499999999999794, -50.00000000000044, 41.100000000000016, 45.3, -50.00000000000044], "episode_lengths": [106, 500, 140, 500, 500, 500, 430, 500, 320, 500, 500, 162, 30, 50, 88, 50, 54, 498, 162, 220, 500, 120, 42, 500, 500, 104, 500, 500, 50, 146, 500, 176, 86, 500, 46, 500, 500, 114, 58, 500, 330, 500, 500, 136, 500, 78, 140, 178, 500, 186, 358, 80, 214, 34, 152, 56, 70, 44, 500, 322, 144, 80, 136, 68, 104, 76, 500, 44, 104, 500, 500, 500, 68, 138, 94, 500, 348, 500, 42, 500, 224, 500, 116, 64, 308, 28, 500, 212, 152, 32, 500, 500, 126, 56, 500, 336, 500, 90, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37688428775662886, "mean_inference_ms": 1.21338939302801, "mean_action_processing_ms": 0.14196911781304514, "mean_env_wait_ms": 0.0819002040118146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500629425048828, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.12900209426879883}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.195999999999825, "episode_len_mean": 268.68, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.50000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 33.90000000000004, 47.1, 45.1, 41.30000000000001, 45.1, 44.7, 0.2999999999995637, 33.90000000000004, 28.09999999999996, -50.00000000000044, 38.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.1, 35.500000000000036, -50.00000000000044, 32.50000000000002, 41.500000000000014, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.300000000000004, -50.00000000000044, 17.099999999999802, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 42.30000000000001, 36.10000000000004, 32.30000000000002, -50.00000000000044, 31.500000000000007, 14.299999999999763, 42.10000000000001, 28.699999999999967, 46.699999999999996, 34.900000000000034, 44.5, 43.10000000000001, 45.7, -50.00000000000044, 17.899999999999814, 35.70000000000003, 42.10000000000001, 36.50000000000003, 43.30000000000001, 39.70000000000002, 42.500000000000014, -50.00000000000044, 45.7, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 36.30000000000003, 40.70000000000002, -50.00000000000044, 15.299999999999777, -50.00000000000044, 45.9, -50.00000000000044, 27.699999999999953, -50.00000000000044, 38.50000000000003, 43.7, 19.299999999999834, 47.3, -50.00000000000044, 28.89999999999997, 34.900000000000034, 46.9, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.5, -50.00000000000044, 16.499999999999794, -50.00000000000044, 41.100000000000016, 45.3, -50.00000000000044], "episode_lengths": [106, 500, 140, 500, 500, 500, 430, 500, 320, 500, 500, 162, 30, 50, 88, 50, 54, 498, 162, 220, 500, 120, 42, 500, 500, 104, 500, 500, 50, 146, 500, 176, 86, 500, 46, 500, 500, 114, 58, 500, 330, 500, 500, 136, 500, 78, 140, 178, 500, 186, 358, 80, 214, 34, 152, 56, 70, 44, 500, 322, 144, 80, 136, 68, 104, 76, 500, 44, 104, 500, 500, 500, 68, 138, 94, 500, 348, 500, 42, 500, 224, 500, 116, 64, 308, 28, 500, 212, 152, 32, 500, 500, 126, 56, 500, 336, 500, 90, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37688428775662886, "mean_inference_ms": 1.21338939302801, "mean_action_processing_ms": 0.14196911781304514, "mean_env_wait_ms": 0.0819002040118146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500629425048828, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.12900209426879883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5446.017197871899, "num_env_steps_trained_throughput_per_sec": 5446.017197871899, "timesteps_total": 720000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 3393.825, "sample_time_ms": 2874.902, "load_time_ms": 18.106, "load_throughput": 994159.571, "learn_time_ms": 488.126, "learn_throughput": 36875.706, "synch_weights_time_ms": 9.59}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2699, "training_iteration": 40, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-48", "timestamp": 1698248328, "time_this_iter_s": 3.3131678104400635, "time_total_s": 135.53327417373657, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 135.53327417373657, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 53.019999999999996, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458558e-13, "cur_lr": 0.0003, "total_loss": 6.492106172773573, "policy_loss": 1.699463723020421e-05, "vf_loss": 6.492134157816569, "vf_explained_var": -2.2331873575846355e-06, "kl": 0.00018416368938763603, "entropy": 0.45000554654333325, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1823.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.004999999999818, "episode_len_mean": 255.56, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.299999999999777, -50.00000000000044, 45.9, -50.00000000000044, 27.699999999999953, -50.00000000000044, 38.50000000000003, 43.7, 19.299999999999834, 47.3, -50.00000000000044, 28.89999999999997, 34.900000000000034, 46.9, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.5, -50.00000000000044, 16.499999999999794, -50.00000000000044, 41.100000000000016, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 41.500000000000014, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.1, 46.099999999999994, 41.70000000000002, 43.50000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.50000000000002, 39.70000000000002, 22.899999999999885, 45.3, 41.90000000000001, 45.9, 45.7, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.5, 43.50000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, 42.30000000000001, 41.30000000000001, 45.9, 46.5, 30.29999999999999, 43.50000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, 46.5, -50.00000000000044, 45.7, 46.699999999999996, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, 0.8999999999995723, -50.00000000000044, 46.5, 40.70000000000002, -50.00000000000044, 46.5, 44.900000000000006, 44.5, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 41.30000000000001], "episode_lengths": [348, 500, 42, 500, 224, 500, 116, 64, 308, 28, 500, 212, 152, 32, 500, 500, 126, 56, 500, 336, 500, 90, 48, 500, 500, 500, 42, 86, 500, 84, 500, 50, 40, 84, 66, 30, 500, 500, 500, 40, 106, 104, 272, 48, 82, 42, 44, 60, 48, 500, 500, 88, 500, 500, 76, 500, 46, 66, 500, 86, 500, 500, 500, 500, 264, 500, 78, 88, 42, 36, 198, 66, 146, 500, 500, 500, 500, 46, 74, 36, 500, 44, 34, 76, 500, 500, 38, 492, 500, 36, 94, 500, 36, 52, 56, 500, 64, 500, 500, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773051026772226, "mean_inference_ms": 1.2139340435839332, "mean_action_processing_ms": 0.14126496297877, "mean_env_wait_ms": 0.08222378694759294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022004127502441406, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.11599612236022949}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.004999999999818, "episode_len_mean": 255.56, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.299999999999777, -50.00000000000044, 45.9, -50.00000000000044, 27.699999999999953, -50.00000000000044, 38.50000000000003, 43.7, 19.299999999999834, 47.3, -50.00000000000044, 28.89999999999997, 34.900000000000034, 46.9, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.5, -50.00000000000044, 16.499999999999794, -50.00000000000044, 41.100000000000016, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 41.500000000000014, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.1, 46.099999999999994, 41.70000000000002, 43.50000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.50000000000002, 39.70000000000002, 22.899999999999885, 45.3, 41.90000000000001, 45.9, 45.7, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.5, 43.50000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, 42.30000000000001, 41.30000000000001, 45.9, 46.5, 30.29999999999999, 43.50000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, 46.5, -50.00000000000044, 45.7, 46.699999999999996, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, 0.8999999999995723, -50.00000000000044, 46.5, 40.70000000000002, -50.00000000000044, 46.5, 44.900000000000006, 44.5, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 41.30000000000001], "episode_lengths": [348, 500, 42, 500, 224, 500, 116, 64, 308, 28, 500, 212, 152, 32, 500, 500, 126, 56, 500, 336, 500, 90, 48, 500, 500, 500, 42, 86, 500, 84, 500, 50, 40, 84, 66, 30, 500, 500, 500, 40, 106, 104, 272, 48, 82, 42, 44, 60, 48, 500, 500, 88, 500, 500, 76, 500, 46, 66, 500, 86, 500, 500, 500, 500, 264, 500, 78, 88, 42, 36, 198, 66, 146, 500, 500, 500, 500, 46, 74, 36, 500, 44, 34, 76, 500, 500, 38, 492, 500, 36, 94, 500, 36, 52, 56, 500, 64, 500, 500, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773051026772226, "mean_inference_ms": 1.2139340435839332, "mean_action_processing_ms": 0.14126496297877, "mean_env_wait_ms": 0.08222378694759294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022004127502441406, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.11599612236022949}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5498.655297057502, "num_env_steps_trained_throughput_per_sec": 5498.655297057502, "timesteps_total": 738000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 738000, "timers": {"training_iteration_time_ms": 3347.68, "sample_time_ms": 2837.858, "load_time_ms": 18.409, "load_throughput": 977785.675, "learn_time_ms": 478.824, "learn_throughput": 37592.08, "synch_weights_time_ms": 9.489}, "counters": {"num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "done": false, "episodes_total": 2775, "training_iteration": 41, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-52", "timestamp": 1698248332, "time_this_iter_s": 3.2805261611938477, "time_total_s": 138.81380033493042, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 138.81380033493042, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 55.720000000000006, "ram_util_percent": 27.359999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729279e-14, "cur_lr": 0.0003, "total_loss": 6.556232749091254, "policy_loss": -0.0003603963388337029, "vf_loss": 6.556638707054986, "vf_explained_var": -3.6875406901041667e-06, "kl": 0.0007124073198837442, "entropy": 0.45445546242925855, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1868.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.6600000000002112, "episode_len_mean": 287.16, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, 42.30000000000001, 41.30000000000001, 45.9, 46.5, 30.29999999999999, 43.50000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, 46.5, -50.00000000000044, 45.7, 46.699999999999996, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, 0.8999999999995723, -50.00000000000044, 46.5, 40.70000000000002, -50.00000000000044, 46.5, 44.900000000000006, 44.5, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, 27.899999999999956, 45.9, -50.00000000000044, 38.300000000000026, 25.499999999999922, 10.299999999999706, 45.1, -50.00000000000044, 35.900000000000034, -50.00000000000044, 46.5, 23.499999999999893, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.5, -50.00000000000044, 9.8999999999997, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.70000000000003, 29.899999999999984, -50.00000000000044, 12.299999999999734, 38.10000000000002, 39.70000000000002, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 24.499999999999908, -50.00000000000044, 40.500000000000014, 46.3, -50.00000000000044, 45.5, 44.7, 43.30000000000001, -50.00000000000044, 38.50000000000003], "episode_lengths": [500, 500, 500, 500, 264, 500, 78, 88, 42, 36, 198, 66, 146, 500, 500, 500, 500, 46, 74, 36, 500, 44, 34, 76, 500, 500, 38, 492, 500, 36, 94, 500, 36, 52, 56, 500, 64, 500, 500, 88, 500, 88, 500, 500, 500, 390, 500, 500, 500, 34, 44, 222, 42, 500, 118, 246, 398, 50, 500, 142, 500, 36, 266, 500, 500, 46, 500, 500, 500, 36, 36, 500, 402, 500, 500, 36, 500, 62, 500, 124, 202, 500, 378, 120, 104, 500, 178, 500, 500, 58, 256, 500, 96, 38, 500, 46, 54, 68, 500, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37677003576909995, "mean_inference_ms": 1.213582616292503, "mean_action_processing_ms": 0.14135483703648688, "mean_env_wait_ms": 0.08216429004023355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004220962524414, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.10899901390075684}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.6600000000002112, "episode_len_mean": 287.16, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, 42.30000000000001, 41.30000000000001, 45.9, 46.5, 30.29999999999999, 43.50000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, 46.5, -50.00000000000044, 45.7, 46.699999999999996, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, 0.8999999999995723, -50.00000000000044, 46.5, 40.70000000000002, -50.00000000000044, 46.5, 44.900000000000006, 44.5, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, 27.899999999999956, 45.9, -50.00000000000044, 38.300000000000026, 25.499999999999922, 10.299999999999706, 45.1, -50.00000000000044, 35.900000000000034, -50.00000000000044, 46.5, 23.499999999999893, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.5, -50.00000000000044, 9.8999999999997, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.70000000000003, 29.899999999999984, -50.00000000000044, 12.299999999999734, 38.10000000000002, 39.70000000000002, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 24.499999999999908, -50.00000000000044, 40.500000000000014, 46.3, -50.00000000000044, 45.5, 44.7, 43.30000000000001, -50.00000000000044, 38.50000000000003], "episode_lengths": [500, 500, 500, 500, 264, 500, 78, 88, 42, 36, 198, 66, 146, 500, 500, 500, 500, 46, 74, 36, 500, 44, 34, 76, 500, 500, 38, 492, 500, 36, 94, 500, 36, 52, 56, 500, 64, 500, 500, 88, 500, 88, 500, 500, 500, 390, 500, 500, 500, 34, 44, 222, 42, 500, 118, 246, 398, 50, 500, 142, 500, 36, 266, 500, 500, 46, 500, 500, 500, 36, 36, 500, 402, 500, 500, 36, 500, 62, 500, 124, 202, 500, 378, 120, 104, 500, 178, 500, 500, 58, 256, 500, 96, 38, 500, 46, 54, 68, 500, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37677003576909995, "mean_inference_ms": 1.213582616292503, "mean_action_processing_ms": 0.14135483703648688, "mean_env_wait_ms": 0.08216429004023355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004220962524414, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.10899901390075684}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5642.620475849523, "num_env_steps_trained_throughput_per_sec": 5642.620475849523, "timesteps_total": 756000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 3323.321, "sample_time_ms": 2810.955, "load_time_ms": 18.409, "load_throughput": 977779.343, "learn_time_ms": 481.267, "learn_throughput": 37401.241, "synch_weights_time_ms": 9.589}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2835, "training_iteration": 42, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-55", "timestamp": 1698248335, "time_this_iter_s": 3.1960015296936035, "time_total_s": 142.00980186462402, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 142.00980186462402, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 61.849999999999994, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.5474735088646395e-14, "cur_lr": 0.0003, "total_loss": 6.527539666493734, "policy_loss": -0.0008754286915063858, "vf_loss": 6.528464327918159, "vf_explained_var": -2.102057139078776e-06, "kl": 0.0012939448010320753, "entropy": 0.491483477751414, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1913.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6660000000002129, "episode_len_mean": 297.22, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 35.900000000000034, -50.00000000000044, 46.5, 23.499999999999893, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.5, -50.00000000000044, 9.8999999999997, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.70000000000003, 29.899999999999984, -50.00000000000044, 12.299999999999734, 38.10000000000002, 39.70000000000002, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 24.499999999999908, -50.00000000000044, 40.500000000000014, 46.3, -50.00000000000044, 45.5, 44.7, 43.30000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 42.900000000000006, 45.5, 47.9, 43.50000000000001, 11.899999999999729, 10.899999999999714, -50.00000000000044, 40.500000000000014, 23.699999999999896, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.10000000000001, 39.10000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.099999999999802, 6.699999999999655, -50.00000000000044, 34.70000000000004, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, 35.10000000000004, -50.00000000000044, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 26.69999999999994, 34.70000000000004, 42.900000000000006, 43.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, 40.500000000000014, 38.10000000000002, -50.00000000000044], "episode_lengths": [50, 500, 142, 500, 36, 266, 500, 500, 46, 500, 500, 500, 36, 36, 500, 402, 500, 500, 36, 500, 62, 500, 124, 202, 500, 378, 120, 104, 500, 178, 500, 500, 58, 256, 500, 96, 38, 500, 46, 54, 68, 500, 116, 500, 72, 46, 22, 66, 382, 392, 500, 96, 264, 500, 96, 500, 60, 110, 72, 500, 500, 44, 500, 500, 500, 52, 206, 500, 500, 500, 500, 330, 434, 500, 154, 168, 500, 500, 70, 50, 500, 150, 500, 480, 500, 500, 58, 500, 500, 64, 234, 154, 72, 62, 500, 96, 500, 96, 120, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3759753719433746, "mean_inference_ms": 1.2111572794714447, "mean_action_processing_ms": 0.14136953681623277, "mean_env_wait_ms": 0.08193039053798311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021672487258911133, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.1009979248046875}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6660000000002129, "episode_len_mean": 297.22, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 35.900000000000034, -50.00000000000044, 46.5, 23.499999999999893, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.5, -50.00000000000044, 9.8999999999997, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.70000000000003, 29.899999999999984, -50.00000000000044, 12.299999999999734, 38.10000000000002, 39.70000000000002, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 24.499999999999908, -50.00000000000044, 40.500000000000014, 46.3, -50.00000000000044, 45.5, 44.7, 43.30000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 42.900000000000006, 45.5, 47.9, 43.50000000000001, 11.899999999999729, 10.899999999999714, -50.00000000000044, 40.500000000000014, 23.699999999999896, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.10000000000001, 39.10000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.099999999999802, 6.699999999999655, -50.00000000000044, 34.70000000000004, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, 35.10000000000004, -50.00000000000044, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 26.69999999999994, 34.70000000000004, 42.900000000000006, 43.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, 40.500000000000014, 38.10000000000002, -50.00000000000044], "episode_lengths": [50, 500, 142, 500, 36, 266, 500, 500, 46, 500, 500, 500, 36, 36, 500, 402, 500, 500, 36, 500, 62, 500, 124, 202, 500, 378, 120, 104, 500, 178, 500, 500, 58, 256, 500, 96, 38, 500, 46, 54, 68, 500, 116, 500, 72, 46, 22, 66, 382, 392, 500, 96, 264, 500, 96, 500, 60, 110, 72, 500, 500, 44, 500, 500, 500, 52, 206, 500, 500, 500, 500, 330, 434, 500, 154, 168, 500, 500, 70, 50, 500, 150, 500, 480, 500, 500, 58, 500, 500, 64, 234, 154, 72, 62, 500, 96, 500, 96, 120, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3759753719433746, "mean_inference_ms": 1.2111572794714447, "mean_action_processing_ms": 0.14136953681623277, "mean_env_wait_ms": 0.08193039053798311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021672487258911133, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.1009979248046875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5701.303610850873, "num_env_steps_trained_throughput_per_sec": 5701.303610850873, "timesteps_total": 774000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 774000, "timers": {"training_iteration_time_ms": 3290.239, "sample_time_ms": 2782.455, "load_time_ms": 18.709, "load_throughput": 962096.855, "learn_time_ms": 476.385, "learn_throughput": 37784.558, "synch_weights_time_ms": 9.689}, "counters": {"num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "done": false, "episodes_total": 2892, "training_iteration": 43, "trial_id": "9f288_00013", "date": "2023-10-25_16-38-58", "timestamp": 1698248338, "time_this_iter_s": 3.162169933319092, "time_total_s": 145.17197179794312, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 145.17197179794312, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 51.44, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2737367544323198e-14, "cur_lr": 0.0003, "total_loss": 6.7826451725429955, "policy_loss": -0.00039203690571917426, "vf_loss": 6.7830842124091255, "vf_explained_var": -1.0821554395887586e-06, "kl": 0.0012972290333402093, "entropy": 0.47081282337506614, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1958.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0429999999997999, "episode_len_mean": 285.16, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 17.099999999999802, 6.699999999999655, -50.00000000000044, 34.70000000000004, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, 35.10000000000004, -50.00000000000044, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 26.69999999999994, 34.70000000000004, 42.900000000000006, 43.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, 40.500000000000014, 38.10000000000002, -50.00000000000044, 4.099999999999618, -50.00000000000044, 45.1, 42.30000000000001, 44.10000000000001, 37.300000000000026, 35.70000000000003, -50.00000000000044, 44.300000000000004, 0.8999999999995723, -50.00000000000044, 46.3, 44.300000000000004, 46.3, 45.7, -50.00000000000044, 40.10000000000002, -50.00000000000044, 23.699999999999896, 44.7, 41.30000000000001, 44.5, 41.30000000000001, 42.70000000000001, 45.9, -50.00000000000044, 44.300000000000004, 20.49999999999985, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.7, 46.099999999999994, -50.00000000000044, 46.699999999999996, 37.50000000000003, 31.300000000000004, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 30.29999999999999, 41.90000000000001, 22.099999999999874, -50.00000000000044, 38.300000000000026, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.7, 27.699999999999953, 24.299999999999905, 42.30000000000001], "episode_lengths": [500, 500, 330, 434, 500, 154, 168, 500, 500, 70, 50, 500, 150, 500, 480, 500, 500, 58, 500, 500, 64, 234, 154, 72, 62, 500, 96, 500, 96, 120, 500, 460, 500, 50, 78, 60, 128, 144, 500, 58, 492, 500, 38, 58, 38, 44, 500, 100, 500, 264, 54, 88, 56, 88, 74, 42, 500, 58, 296, 500, 500, 54, 500, 64, 40, 500, 34, 126, 188, 500, 500, 178, 500, 74, 500, 226, 500, 500, 50, 500, 198, 82, 280, 500, 118, 42, 500, 500, 500, 500, 500, 500, 500, 500, 98, 500, 44, 224, 258, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3756306388717042, "mean_inference_ms": 1.2098705814202964, "mean_action_processing_ms": 0.14125977998979564, "mean_env_wait_ms": 0.08172305452622844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022994518280029297, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.10901236534118652}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0429999999997999, "episode_len_mean": 285.16, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 17.099999999999802, 6.699999999999655, -50.00000000000044, 34.70000000000004, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, 35.10000000000004, -50.00000000000044, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 26.69999999999994, 34.70000000000004, 42.900000000000006, 43.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, 40.500000000000014, 38.10000000000002, -50.00000000000044, 4.099999999999618, -50.00000000000044, 45.1, 42.30000000000001, 44.10000000000001, 37.300000000000026, 35.70000000000003, -50.00000000000044, 44.300000000000004, 0.8999999999995723, -50.00000000000044, 46.3, 44.300000000000004, 46.3, 45.7, -50.00000000000044, 40.10000000000002, -50.00000000000044, 23.699999999999896, 44.7, 41.30000000000001, 44.5, 41.30000000000001, 42.70000000000001, 45.9, -50.00000000000044, 44.300000000000004, 20.49999999999985, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.7, 46.099999999999994, -50.00000000000044, 46.699999999999996, 37.50000000000003, 31.300000000000004, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 30.29999999999999, 41.90000000000001, 22.099999999999874, -50.00000000000044, 38.300000000000026, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.7, 27.699999999999953, 24.299999999999905, 42.30000000000001], "episode_lengths": [500, 500, 330, 434, 500, 154, 168, 500, 500, 70, 50, 500, 150, 500, 480, 500, 500, 58, 500, 500, 64, 234, 154, 72, 62, 500, 96, 500, 96, 120, 500, 460, 500, 50, 78, 60, 128, 144, 500, 58, 492, 500, 38, 58, 38, 44, 500, 100, 500, 264, 54, 88, 56, 88, 74, 42, 500, 58, 296, 500, 500, 54, 500, 64, 40, 500, 34, 126, 188, 500, 500, 178, 500, 74, 500, 226, 500, 500, 50, 500, 198, 82, 280, 500, 118, 42, 500, 500, 500, 500, 500, 500, 500, 500, 98, 500, 44, 224, 258, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3756306388717042, "mean_inference_ms": 1.2098705814202964, "mean_action_processing_ms": 0.14125977998979564, "mean_env_wait_ms": 0.08172305452622844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022994518280029297, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.10901236534118652}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5252.405090731901, "num_env_steps_trained_throughput_per_sec": 5252.405090731901, "timesteps_total": 792000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 3300.753, "sample_time_ms": 2790.402, "load_time_ms": 18.709, "load_throughput": 962094.403, "learn_time_ms": 478.355, "learn_throughput": 37628.95, "synch_weights_time_ms": 10.186}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 2961, "training_iteration": 44, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-01", "timestamp": 1698248341, "time_this_iter_s": 3.4329993724823, "time_total_s": 148.60497117042542, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 148.60497117042542, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 67.725, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161599e-14, "cur_lr": 0.0003, "total_loss": 6.643470191955567, "policy_loss": -0.00031530256900522445, "vf_loss": 6.643834898206923, "vf_explained_var": -0.00018824074003431532, "kl": 0.0010259152380462588, "entropy": 0.4947506818506453, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2003.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6879999999998088, "episode_len_mean": 273.72, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.30000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 30.29999999999999, 41.90000000000001, 22.099999999999874, -50.00000000000044, 38.300000000000026, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.7, 27.699999999999953, 24.299999999999905, 42.30000000000001, -50.00000000000044, 44.5, -50.00000000000044, 38.300000000000026, 43.7, 45.3, 23.499999999999893, 40.90000000000002, 30.29999999999999, 40.30000000000002, 44.300000000000004, -50.00000000000044, 41.90000000000001, -50.00000000000044, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 3.2999999999996064, 14.299999999999763, 42.10000000000001, 34.50000000000004, -50.00000000000044, 46.099999999999994, 45.1, 40.10000000000002, 45.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 46.5, 43.7, 36.30000000000003, 45.7, 45.9, 41.500000000000014, 40.10000000000002, 28.09999999999996, 33.30000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.300000000000004, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 15.099999999999774, 40.90000000000002, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 19.299999999999834, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044], "episode_lengths": [178, 500, 74, 500, 226, 500, 500, 50, 500, 198, 82, 280, 500, 118, 42, 500, 500, 500, 500, 500, 500, 500, 500, 98, 500, 44, 224, 258, 78, 500, 56, 500, 118, 64, 48, 266, 92, 198, 98, 58, 500, 82, 500, 472, 500, 500, 468, 358, 80, 156, 500, 40, 50, 100, 44, 76, 500, 500, 28, 36, 64, 138, 44, 42, 86, 100, 220, 168, 500, 56, 500, 500, 500, 500, 500, 100, 38, 42, 500, 500, 146, 58, 500, 40, 38, 500, 350, 92, 500, 44, 58, 500, 500, 74, 500, 308, 500, 56, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37562635373564646, "mean_inference_ms": 1.2085405973286536, "mean_action_processing_ms": 0.14122152775402375, "mean_env_wait_ms": 0.08170479317746461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030971765518188477, "StateBufferConnector_ms": 0.007018566131591797, "ViewRequirementAgentConnector_ms": 0.1259934902191162}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6879999999998088, "episode_len_mean": 273.72, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.30000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 30.29999999999999, 41.90000000000001, 22.099999999999874, -50.00000000000044, 38.300000000000026, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.7, 27.699999999999953, 24.299999999999905, 42.30000000000001, -50.00000000000044, 44.5, -50.00000000000044, 38.300000000000026, 43.7, 45.3, 23.499999999999893, 40.90000000000002, 30.29999999999999, 40.30000000000002, 44.300000000000004, -50.00000000000044, 41.90000000000001, -50.00000000000044, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 3.2999999999996064, 14.299999999999763, 42.10000000000001, 34.50000000000004, -50.00000000000044, 46.099999999999994, 45.1, 40.10000000000002, 45.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 46.5, 43.7, 36.30000000000003, 45.7, 45.9, 41.500000000000014, 40.10000000000002, 28.09999999999996, 33.30000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.300000000000004, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 15.099999999999774, 40.90000000000002, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 19.299999999999834, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044], "episode_lengths": [178, 500, 74, 500, 226, 500, 500, 50, 500, 198, 82, 280, 500, 118, 42, 500, 500, 500, 500, 500, 500, 500, 500, 98, 500, 44, 224, 258, 78, 500, 56, 500, 118, 64, 48, 266, 92, 198, 98, 58, 500, 82, 500, 472, 500, 500, 468, 358, 80, 156, 500, 40, 50, 100, 44, 76, 500, 500, 28, 36, 64, 138, 44, 42, 86, 100, 220, 168, 500, 56, 500, 500, 500, 500, 500, 100, 38, 42, 500, 500, 146, 58, 500, 40, 38, 500, 350, 92, 500, 44, 58, 500, 500, 74, 500, 308, 500, 56, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37562635373564646, "mean_inference_ms": 1.2085405973286536, "mean_action_processing_ms": 0.14122152775402375, "mean_env_wait_ms": 0.08170479317746461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030971765518188477, "StateBufferConnector_ms": 0.007018566131591797, "ViewRequirementAgentConnector_ms": 0.1259934902191162}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5440.677335843864, "num_env_steps_trained_throughput_per_sec": 5440.677335843864, "timesteps_total": 810000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 810000, "timers": {"training_iteration_time_ms": 3297.736, "sample_time_ms": 2776.602, "load_time_ms": 19.709, "load_throughput": 913282.131, "learn_time_ms": 488.353, "learn_throughput": 36858.621, "synch_weights_time_ms": 10.071}, "counters": {"num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "done": false, "episodes_total": 3032, "training_iteration": 45, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-05", "timestamp": 1698248345, "time_this_iter_s": 3.31440806388855, "time_total_s": 151.91937923431396, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 151.91937923431396, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 54.86, "ram_util_percent": 27.419999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860807994e-15, "cur_lr": 0.0003, "total_loss": 7.02302213244968, "policy_loss": -0.0002972073025173611, "vf_loss": 7.023369640774197, "vf_explained_var": -0.0003056552675035265, "kl": 0.0008661448559602529, "entropy": 0.5042870759963989, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2048.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.335999999999848, "episode_len_mean": 237.32, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 15.099999999999774, 40.90000000000002, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 19.299999999999834, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7, -50.00000000000044, 45.3, 40.500000000000014, 39.50000000000002, 46.099999999999994, 44.7, 46.5, 25.499999999999922, -50.00000000000044, 45.5, 25.899999999999928, -50.00000000000044, 36.30000000000003, 41.500000000000014, -50.00000000000044, -50.00000000000044, 28.699999999999967, 42.10000000000001, 42.900000000000006, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.10000000000002, 40.10000000000002, 46.5, 43.10000000000001, -50.00000000000044, 43.7, 17.899999999999814, 45.3, 43.900000000000006, -50.00000000000044, 41.70000000000002, 43.30000000000001, 19.499999999999837, -50.00000000000044, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.5, 26.69999999999994, 36.10000000000004, 46.5, 46.5, -50.00000000000044, 30.699999999999996, 43.7, -50.00000000000044, 14.09999999999976, 43.900000000000006, 45.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.5, 12.099999999999731, 37.70000000000003, -50.00000000000044, 41.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.499999999999822, 34.70000000000004, 42.500000000000014, 46.3, 40.70000000000002, 37.300000000000026, 24.099999999999902, 46.699999999999996, 31.500000000000007], "episode_lengths": [58, 500, 40, 38, 500, 350, 92, 500, 44, 58, 500, 500, 74, 500, 308, 500, 56, 72, 500, 500, 82, 54, 500, 48, 96, 106, 40, 54, 36, 246, 500, 46, 242, 500, 138, 86, 500, 500, 214, 80, 72, 72, 500, 500, 100, 100, 36, 70, 500, 64, 322, 48, 62, 500, 84, 68, 306, 500, 74, 50, 500, 500, 500, 92, 56, 234, 140, 36, 36, 500, 194, 64, 500, 360, 62, 48, 500, 76, 500, 500, 500, 48, 36, 380, 124, 500, 84, 90, 500, 500, 500, 316, 154, 76, 38, 94, 128, 260, 34, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37483143483734865, "mean_inference_ms": 1.2076911048270862, "mean_action_processing_ms": 0.14095691936342067, "mean_env_wait_ms": 0.0817765366432848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029010772705078125, "StateBufferConnector_ms": 0.009019613265991211, "ViewRequirementAgentConnector_ms": 0.1349959373474121}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.335999999999848, "episode_len_mean": 237.32, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 15.099999999999774, 40.90000000000002, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 19.299999999999834, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7, -50.00000000000044, 45.3, 40.500000000000014, 39.50000000000002, 46.099999999999994, 44.7, 46.5, 25.499999999999922, -50.00000000000044, 45.5, 25.899999999999928, -50.00000000000044, 36.30000000000003, 41.500000000000014, -50.00000000000044, -50.00000000000044, 28.699999999999967, 42.10000000000001, 42.900000000000006, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.10000000000002, 40.10000000000002, 46.5, 43.10000000000001, -50.00000000000044, 43.7, 17.899999999999814, 45.3, 43.900000000000006, -50.00000000000044, 41.70000000000002, 43.30000000000001, 19.499999999999837, -50.00000000000044, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.5, 26.69999999999994, 36.10000000000004, 46.5, 46.5, -50.00000000000044, 30.699999999999996, 43.7, -50.00000000000044, 14.09999999999976, 43.900000000000006, 45.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.5, 12.099999999999731, 37.70000000000003, -50.00000000000044, 41.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.499999999999822, 34.70000000000004, 42.500000000000014, 46.3, 40.70000000000002, 37.300000000000026, 24.099999999999902, 46.699999999999996, 31.500000000000007], "episode_lengths": [58, 500, 40, 38, 500, 350, 92, 500, 44, 58, 500, 500, 74, 500, 308, 500, 56, 72, 500, 500, 82, 54, 500, 48, 96, 106, 40, 54, 36, 246, 500, 46, 242, 500, 138, 86, 500, 500, 214, 80, 72, 72, 500, 500, 100, 100, 36, 70, 500, 64, 322, 48, 62, 500, 84, 68, 306, 500, 74, 50, 500, 500, 500, 92, 56, 234, 140, 36, 36, 500, 194, 64, 500, 360, 62, 48, 500, 76, 500, 500, 500, 48, 36, 380, 124, 500, 84, 90, 500, 500, 500, 316, 154, 76, 38, 94, 128, 260, 34, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37483143483734865, "mean_inference_ms": 1.2076911048270862, "mean_action_processing_ms": 0.14095691936342067, "mean_env_wait_ms": 0.0817765366432848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029010772705078125, "StateBufferConnector_ms": 0.009019613265991211, "ViewRequirementAgentConnector_ms": 0.1349959373474121}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5384.38269907817, "num_env_steps_trained_throughput_per_sec": 5384.38269907817, "timesteps_total": 828000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 3295.584, "sample_time_ms": 2768.302, "load_time_ms": 20.009, "load_throughput": 899587.987, "learn_time_ms": 494.3, "learn_throughput": 36415.104, "synch_weights_time_ms": 10.071}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3113, "training_iteration": 46, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-08", "timestamp": 1698248348, "time_this_iter_s": 3.3489983081817627, "time_total_s": 155.26837754249573, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 155.26837754249573, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 52.81999999999999, "ram_util_percent": 27.419999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430403997e-15, "cur_lr": 0.0003, "total_loss": 6.1971295886569555, "policy_loss": -0.0004970495226896472, "vf_loss": 6.1976739353603785, "vf_explained_var": 0.00033203628328111435, "kl": 0.0007784768688297719, "entropy": 0.47271339694658915, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2093.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9749999999998042, "episode_len_mean": 275.86, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, 19.499999999999837, -50.00000000000044, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.5, 26.69999999999994, 36.10000000000004, 46.5, 46.5, -50.00000000000044, 30.699999999999996, 43.7, -50.00000000000044, 14.09999999999976, 43.900000000000006, 45.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.5, 12.099999999999731, 37.70000000000003, -50.00000000000044, 41.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.499999999999822, 34.70000000000004, 42.500000000000014, 46.3, 40.70000000000002, 37.300000000000026, 24.099999999999902, 46.699999999999996, 31.500000000000007, -50.00000000000044, 32.50000000000002, 46.5, 44.5, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.9, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 47.3, 36.900000000000034, -50.00000000000044, -50.00000000000044, 5.299999999999635, -50.00000000000044, 43.50000000000001, 43.900000000000006, 46.699999999999996, 7.299999999999663, 45.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.1, 40.30000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 24.499999999999908, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, 43.900000000000006, 3.699999999999612, -50.00000000000044, 43.7, -50.00000000000044, 10.699999999999712, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 25.099999999999916], "episode_lengths": [68, 306, 500, 74, 50, 500, 500, 500, 92, 56, 234, 140, 36, 36, 500, 194, 64, 500, 360, 62, 48, 500, 76, 500, 500, 500, 48, 36, 380, 124, 500, 84, 90, 500, 500, 500, 316, 154, 76, 38, 94, 128, 260, 34, 186, 500, 176, 36, 56, 48, 500, 58, 500, 32, 500, 44, 500, 500, 500, 86, 28, 132, 500, 500, 448, 500, 66, 62, 34, 428, 42, 34, 500, 500, 50, 98, 500, 66, 500, 256, 500, 256, 500, 500, 62, 464, 500, 64, 500, 394, 500, 250, 500, 500, 84, 500, 38, 500, 500, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3752502988233077, "mean_inference_ms": 1.2074162653184277, "mean_action_processing_ms": 0.1412072329677922, "mean_env_wait_ms": 0.08164072929646103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200101852416992, "StateBufferConnector_ms": 0.011999845504760742, "ViewRequirementAgentConnector_ms": 0.12199687957763672}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9749999999998042, "episode_len_mean": 275.86, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, 19.499999999999837, -50.00000000000044, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.5, 26.69999999999994, 36.10000000000004, 46.5, 46.5, -50.00000000000044, 30.699999999999996, 43.7, -50.00000000000044, 14.09999999999976, 43.900000000000006, 45.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.5, 12.099999999999731, 37.70000000000003, -50.00000000000044, 41.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.499999999999822, 34.70000000000004, 42.500000000000014, 46.3, 40.70000000000002, 37.300000000000026, 24.099999999999902, 46.699999999999996, 31.500000000000007, -50.00000000000044, 32.50000000000002, 46.5, 44.5, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.9, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 47.3, 36.900000000000034, -50.00000000000044, -50.00000000000044, 5.299999999999635, -50.00000000000044, 43.50000000000001, 43.900000000000006, 46.699999999999996, 7.299999999999663, 45.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.1, 40.30000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 24.499999999999908, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, 43.900000000000006, 3.699999999999612, -50.00000000000044, 43.7, -50.00000000000044, 10.699999999999712, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 25.099999999999916], "episode_lengths": [68, 306, 500, 74, 50, 500, 500, 500, 92, 56, 234, 140, 36, 36, 500, 194, 64, 500, 360, 62, 48, 500, 76, 500, 500, 500, 48, 36, 380, 124, 500, 84, 90, 500, 500, 500, 316, 154, 76, 38, 94, 128, 260, 34, 186, 500, 176, 36, 56, 48, 500, 58, 500, 32, 500, 44, 500, 500, 500, 86, 28, 132, 500, 500, 448, 500, 66, 62, 34, 428, 42, 34, 500, 500, 50, 98, 500, 66, 500, 256, 500, 256, 500, 500, 62, 464, 500, 64, 500, 394, 500, 250, 500, 500, 84, 500, 38, 500, 500, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3752502988233077, "mean_inference_ms": 1.2074162653184277, "mean_action_processing_ms": 0.1412072329677922, "mean_env_wait_ms": 0.08164072929646103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200101852416992, "StateBufferConnector_ms": 0.011999845504760742, "ViewRequirementAgentConnector_ms": 0.12199687957763672}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5301.907908042877, "num_env_steps_trained_throughput_per_sec": 5301.907908042877, "timesteps_total": 846000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 846000, "timers": {"training_iteration_time_ms": 3290.235, "sample_time_ms": 2765.553, "load_time_ms": 19.809, "load_throughput": 908666.586, "learn_time_ms": 492.4, "learn_throughput": 36555.626, "synch_weights_time_ms": 9.971}, "counters": {"num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "done": false, "episodes_total": 3168, "training_iteration": 47, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-11", "timestamp": 1698248351, "time_this_iter_s": 3.40000057220459, "time_total_s": 158.66837811470032, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 158.66837811470032, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 58.85999999999999, "ram_util_percent": 27.439999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715201999e-15, "cur_lr": 0.0003, "total_loss": 6.5927950647142195, "policy_loss": -0.00041266307234764097, "vf_loss": 6.59325451321072, "vf_explained_var": -0.00022560358047485352, "kl": 0.0010840363464492636, "entropy": 0.4677490234375, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2138.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9519999999998072, "episode_len_mean": 271.08, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 40.30000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 24.499999999999908, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, 43.900000000000006, 3.699999999999612, -50.00000000000044, 43.7, -50.00000000000044, 10.699999999999712, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.099999999999994, 41.500000000000014, 42.500000000000014, 44.900000000000006, -50.00000000000044, 38.50000000000003, 45.3, 45.7, -50.00000000000044, 45.5, -50.00000000000044, 45.9, -50.00000000000044, 39.90000000000002, 44.7, 45.9, 45.3, 44.10000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, 44.10000000000001, 8.699999999999683, 45.1, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.900000000000006, 42.10000000000001, 43.7, 45.5, 37.50000000000003, -50.00000000000044, 42.70000000000001, 40.30000000000002, 46.699999999999996, 46.3, 3.499999999999609, 44.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 45.5, 45.7, 42.70000000000001, 34.50000000000004, -50.00000000000044, 45.1, 11.29999999999972, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, -50.00000000000044, 32.30000000000002, 43.50000000000001], "episode_lengths": [50, 98, 500, 66, 500, 256, 500, 256, 500, 500, 62, 464, 500, 64, 500, 394, 500, 250, 500, 500, 84, 500, 38, 500, 500, 250, 500, 500, 500, 500, 154, 40, 86, 76, 52, 500, 116, 48, 44, 500, 46, 500, 42, 500, 102, 54, 42, 48, 60, 102, 500, 500, 44, 60, 414, 50, 500, 58, 82, 500, 500, 142, 500, 500, 500, 96, 52, 80, 64, 46, 126, 500, 74, 98, 34, 38, 466, 56, 98, 500, 500, 500, 500, 142, 500, 46, 44, 74, 156, 500, 50, 388, 322, 500, 500, 500, 20, 500, 178, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3755695655975396, "mean_inference_ms": 1.2077765703974572, "mean_action_processing_ms": 0.1409236358021066, "mean_env_wait_ms": 0.08189344969016206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022003173828125, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.12399959564208984}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9519999999998072, "episode_len_mean": 271.08, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 40.30000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 24.499999999999908, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, 43.900000000000006, 3.699999999999612, -50.00000000000044, 43.7, -50.00000000000044, 10.699999999999712, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.099999999999994, 41.500000000000014, 42.500000000000014, 44.900000000000006, -50.00000000000044, 38.50000000000003, 45.3, 45.7, -50.00000000000044, 45.5, -50.00000000000044, 45.9, -50.00000000000044, 39.90000000000002, 44.7, 45.9, 45.3, 44.10000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, 44.10000000000001, 8.699999999999683, 45.1, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.900000000000006, 42.10000000000001, 43.7, 45.5, 37.50000000000003, -50.00000000000044, 42.70000000000001, 40.30000000000002, 46.699999999999996, 46.3, 3.499999999999609, 44.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 45.5, 45.7, 42.70000000000001, 34.50000000000004, -50.00000000000044, 45.1, 11.29999999999972, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, -50.00000000000044, 32.30000000000002, 43.50000000000001], "episode_lengths": [50, 98, 500, 66, 500, 256, 500, 256, 500, 500, 62, 464, 500, 64, 500, 394, 500, 250, 500, 500, 84, 500, 38, 500, 500, 250, 500, 500, 500, 500, 154, 40, 86, 76, 52, 500, 116, 48, 44, 500, 46, 500, 42, 500, 102, 54, 42, 48, 60, 102, 500, 500, 44, 60, 414, 50, 500, 58, 82, 500, 500, 142, 500, 500, 500, 96, 52, 80, 64, 46, 126, 500, 74, 98, 34, 38, 466, 56, 98, 500, 500, 500, 500, 142, 500, 46, 44, 74, 156, 500, 50, 388, 322, 500, 500, 500, 20, 500, 178, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3755695655975396, "mean_inference_ms": 1.2077765703974572, "mean_action_processing_ms": 0.1409236358021066, "mean_env_wait_ms": 0.08189344969016206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022003173828125, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.12399959564208984}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5387.602988728329, "num_env_steps_trained_throughput_per_sec": 5387.602988728329, "timesteps_total": 864000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 3302.135, "sample_time_ms": 2777.153, "load_time_ms": 20.506, "load_throughput": 877780.617, "learn_time_ms": 492.0, "learn_throughput": 36585.349, "synch_weights_time_ms": 9.974}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3242, "training_iteration": 48, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-15", "timestamp": 1698248355, "time_this_iter_s": 3.346999406814575, "time_total_s": 162.0153775215149, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 162.0153775215149, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 67.025, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357600999e-16, "cur_lr": 0.0003, "total_loss": 7.0718178431193035, "policy_loss": -0.0001840711726496617, "vf_loss": 7.072052913241916, "vf_explained_var": 0.00018145905600653754, "kl": 0.0005610699869091856, "entropy": 0.509705181254281, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2183.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.528999999999836, "episode_len_mean": 250.4, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 3.499999999999609, 44.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 45.5, 45.7, 42.70000000000001, 34.50000000000004, -50.00000000000044, 45.1, 11.29999999999972, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, -50.00000000000044, 32.30000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.3, 34.900000000000034, 25.29999999999992, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.30000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 43.7, 46.5, 38.50000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.900000000000006, 44.7, 29.899999999999984, -50.00000000000044, 35.10000000000004, 43.50000000000001, 41.30000000000001, 8.099999999999675, 12.899999999999743, 38.50000000000003, 37.300000000000026, 24.099999999999902, -50.00000000000044, 2.0999999999995893, 25.499999999999922, 44.7, 45.1, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 37.50000000000003, -50.00000000000044, 41.100000000000016, 45.5, 27.899999999999956, 6.299999999999649, 45.7, -50.00000000000044, 46.099999999999994, 46.3, 44.300000000000004, 38.90000000000002, 44.5, 31.300000000000004, 38.700000000000024, 41.100000000000016, 44.10000000000001, 46.3, 23.699999999999896, 46.699999999999996, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.90000000000002, 44.300000000000004, 41.500000000000014, 12.299999999999734, 5.099999999999632], "episode_lengths": [38, 466, 56, 98, 500, 500, 500, 500, 142, 500, 46, 44, 74, 156, 500, 50, 388, 322, 500, 500, 500, 20, 500, 178, 66, 500, 500, 500, 500, 68, 38, 152, 248, 500, 500, 76, 138, 94, 500, 500, 500, 192, 64, 36, 116, 500, 90, 500, 62, 54, 202, 500, 150, 66, 88, 420, 372, 116, 128, 260, 500, 480, 246, 54, 50, 24, 500, 500, 500, 50, 126, 500, 90, 46, 222, 438, 44, 500, 40, 38, 58, 112, 56, 188, 114, 90, 60, 38, 264, 34, 500, 86, 500, 500, 34, 112, 58, 86, 378, 450]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37575802793669155, "mean_inference_ms": 1.2082680838766529, "mean_action_processing_ms": 0.14095291626238765, "mean_env_wait_ms": 0.08200970027673372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301739692687988, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.12698888778686523}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.528999999999836, "episode_len_mean": 250.4, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 3.499999999999609, 44.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 45.5, 45.7, 42.70000000000001, 34.50000000000004, -50.00000000000044, 45.1, 11.29999999999972, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, -50.00000000000044, 32.30000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.3, 34.900000000000034, 25.29999999999992, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.30000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 43.7, 46.5, 38.50000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.900000000000006, 44.7, 29.899999999999984, -50.00000000000044, 35.10000000000004, 43.50000000000001, 41.30000000000001, 8.099999999999675, 12.899999999999743, 38.50000000000003, 37.300000000000026, 24.099999999999902, -50.00000000000044, 2.0999999999995893, 25.499999999999922, 44.7, 45.1, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 37.50000000000003, -50.00000000000044, 41.100000000000016, 45.5, 27.899999999999956, 6.299999999999649, 45.7, -50.00000000000044, 46.099999999999994, 46.3, 44.300000000000004, 38.90000000000002, 44.5, 31.300000000000004, 38.700000000000024, 41.100000000000016, 44.10000000000001, 46.3, 23.699999999999896, 46.699999999999996, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.90000000000002, 44.300000000000004, 41.500000000000014, 12.299999999999734, 5.099999999999632], "episode_lengths": [38, 466, 56, 98, 500, 500, 500, 500, 142, 500, 46, 44, 74, 156, 500, 50, 388, 322, 500, 500, 500, 20, 500, 178, 66, 500, 500, 500, 500, 68, 38, 152, 248, 500, 500, 76, 138, 94, 500, 500, 500, 192, 64, 36, 116, 500, 90, 500, 62, 54, 202, 500, 150, 66, 88, 420, 372, 116, 128, 260, 500, 480, 246, 54, 50, 24, 500, 500, 500, 50, 126, 500, 90, 46, 222, 438, 44, 500, 40, 38, 58, 112, 56, 188, 114, 90, 60, 38, 264, 34, 500, 86, 500, 500, 34, 112, 58, 86, 378, 450]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37575802793669155, "mean_inference_ms": 1.2082680838766529, "mean_action_processing_ms": 0.14095291626238765, "mean_env_wait_ms": 0.08200970027673372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301739692687988, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.12698888778686523}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5325.43985021117, "num_env_steps_trained_throughput_per_sec": 5325.43985021117, "timesteps_total": 882000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 882000, "timers": {"training_iteration_time_ms": 3312.03, "sample_time_ms": 2791.953, "load_time_ms": 19.006, "load_throughput": 947072.219, "learn_time_ms": 488.596, "learn_throughput": 36840.28, "synch_weights_time_ms": 10.074}, "counters": {"num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "done": false, "episodes_total": 3317, "training_iteration": 49, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-18", "timestamp": 1698248358, "time_this_iter_s": 3.384999990463257, "time_total_s": 165.40037751197815, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 165.40037751197815, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 56.78000000000001, "ram_util_percent": 27.459999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788004996e-16, "cur_lr": 0.0003, "total_loss": 6.713633675045437, "policy_loss": -0.00037497679392496744, "vf_loss": 6.714059617784288, "vf_explained_var": -0.0019653108384874132, "kl": 0.0006352996739268393, "entropy": 0.5092670347955491, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2228.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.926999999999815, "episode_len_mean": 266.38, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0999999999995893, 25.499999999999922, 44.7, 45.1, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 37.50000000000003, -50.00000000000044, 41.100000000000016, 45.5, 27.899999999999956, 6.299999999999649, 45.7, -50.00000000000044, 46.099999999999994, 46.3, 44.300000000000004, 38.90000000000002, 44.5, 31.300000000000004, 38.700000000000024, 41.100000000000016, 44.10000000000001, 46.3, 23.699999999999896, 46.699999999999996, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.90000000000002, 44.300000000000004, 41.500000000000014, 12.299999999999734, 5.099999999999632, -50.00000000000044, 20.099999999999845, 31.300000000000004, -50.00000000000044, -50.00000000000044, 11.29999999999972, -50.00000000000044, 39.10000000000002, 16.8999999999998, 8.299999999999677, 42.500000000000014, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 32.50000000000002, 46.699999999999996, 40.10000000000002, 19.09999999999983, -50.00000000000044, 41.90000000000001, 46.3, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.5, 35.30000000000004, 42.30000000000001, 43.10000000000001, -50.00000000000044, 44.5, 36.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, 43.900000000000006, 44.900000000000006, 28.29999999999996], "episode_lengths": [480, 246, 54, 50, 24, 500, 500, 500, 50, 126, 500, 90, 46, 222, 438, 44, 500, 40, 38, 58, 112, 56, 188, 114, 90, 60, 38, 264, 34, 500, 86, 500, 500, 34, 112, 58, 86, 378, 450, 500, 300, 188, 500, 500, 388, 500, 110, 332, 418, 76, 500, 66, 500, 42, 500, 500, 500, 156, 500, 58, 500, 500, 176, 34, 100, 310, 500, 82, 38, 500, 98, 500, 46, 148, 78, 70, 500, 56, 136, 58, 500, 500, 500, 500, 56, 500, 500, 76, 500, 80, 48, 500, 464, 500, 500, 500, 352, 62, 52, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37557939634750875, "mean_inference_ms": 1.2073499049528733, "mean_action_processing_ms": 0.1410290636652193, "mean_env_wait_ms": 0.08181213424866296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024012327194213867, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.13399720191955566}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.926999999999815, "episode_len_mean": 266.38, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.0999999999995893, 25.499999999999922, 44.7, 45.1, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 37.50000000000003, -50.00000000000044, 41.100000000000016, 45.5, 27.899999999999956, 6.299999999999649, 45.7, -50.00000000000044, 46.099999999999994, 46.3, 44.300000000000004, 38.90000000000002, 44.5, 31.300000000000004, 38.700000000000024, 41.100000000000016, 44.10000000000001, 46.3, 23.699999999999896, 46.699999999999996, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.90000000000002, 44.300000000000004, 41.500000000000014, 12.299999999999734, 5.099999999999632, -50.00000000000044, 20.099999999999845, 31.300000000000004, -50.00000000000044, -50.00000000000044, 11.29999999999972, -50.00000000000044, 39.10000000000002, 16.8999999999998, 8.299999999999677, 42.500000000000014, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 32.50000000000002, 46.699999999999996, 40.10000000000002, 19.09999999999983, -50.00000000000044, 41.90000000000001, 46.3, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.5, 35.30000000000004, 42.30000000000001, 43.10000000000001, -50.00000000000044, 44.5, 36.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, 43.900000000000006, 44.900000000000006, 28.29999999999996], "episode_lengths": [480, 246, 54, 50, 24, 500, 500, 500, 50, 126, 500, 90, 46, 222, 438, 44, 500, 40, 38, 58, 112, 56, 188, 114, 90, 60, 38, 264, 34, 500, 86, 500, 500, 34, 112, 58, 86, 378, 450, 500, 300, 188, 500, 500, 388, 500, 110, 332, 418, 76, 500, 66, 500, 42, 500, 500, 500, 156, 500, 58, 500, 500, 176, 34, 100, 310, 500, 82, 38, 500, 98, 500, 46, 148, 78, 70, 500, 56, 136, 58, 500, 500, 500, 500, 56, 500, 500, 76, 500, 80, 48, 500, 464, 500, 500, 500, 352, 62, 52, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37557939634750875, "mean_inference_ms": 1.2073499049528733, "mean_action_processing_ms": 0.1410290636652193, "mean_env_wait_ms": 0.08181213424866296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024012327194213867, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.13399720191955566}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5323.866359287123, "num_env_steps_trained_throughput_per_sec": 5323.866359287123, "timesteps_total": 900000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 3319.613, "sample_time_ms": 2792.053, "load_time_ms": 20.009, "load_throughput": 899590.131, "learn_time_ms": 495.481, "learn_throughput": 36328.364, "synch_weights_time_ms": 9.669}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3378, "training_iteration": 50, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-22", "timestamp": 1698248362, "time_this_iter_s": 3.3859994411468506, "time_total_s": 168.786376953125, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 168.786376953125, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 51.9, "ram_util_percent": 27.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002498e-16, "cur_lr": 0.0003, "total_loss": 6.547258747948541, "policy_loss": -0.0005790467891428206, "vf_loss": 6.5478887134128145, "vf_explained_var": -0.002447276645236545, "kl": 0.0016167921574399577, "entropy": 0.5096337344911364, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2273.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.02099999999981, "episode_len_mean": 275.38, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.09999999999983, -50.00000000000044, 41.90000000000001, 46.3, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.5, 35.30000000000004, 42.30000000000001, 43.10000000000001, -50.00000000000044, 44.5, 36.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, 43.900000000000006, 44.900000000000006, 28.29999999999996, -50.00000000000044, 41.90000000000001, -50.00000000000044, 40.10000000000002, 22.699999999999882, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, 37.300000000000026, 24.299999999999905, 45.5, 38.700000000000024, 1.8999999999995865, -50.00000000000044, 32.30000000000002, 33.10000000000003, -50.00000000000044, 35.10000000000004, 43.30000000000001, 28.699999999999967, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.5, 41.70000000000002, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, 35.10000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 36.900000000000034, 44.300000000000004, 41.100000000000016, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.5, 38.90000000000002, -50.00000000000044, 42.900000000000006, 39.90000000000002, 33.70000000000004, -50.00000000000044], "episode_lengths": [310, 500, 82, 38, 500, 98, 500, 46, 148, 78, 70, 500, 56, 136, 58, 500, 500, 500, 500, 56, 500, 500, 76, 500, 80, 48, 500, 464, 500, 500, 500, 352, 62, 52, 218, 500, 82, 500, 100, 274, 500, 500, 120, 500, 52, 500, 128, 258, 46, 114, 482, 500, 178, 170, 500, 150, 68, 214, 500, 500, 52, 42, 500, 70, 500, 500, 74, 36, 84, 500, 226, 500, 500, 70, 76, 48, 500, 500, 78, 150, 500, 70, 500, 62, 500, 500, 64, 132, 58, 90, 96, 500, 500, 46, 112, 500, 72, 102, 164, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3751251870479432, "mean_inference_ms": 1.2059380806165867, "mean_action_processing_ms": 0.14080288675013303, "mean_env_wait_ms": 0.08179854627663649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599787712097168, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.12199115753173828}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.02099999999981, "episode_len_mean": 275.38, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.09999999999983, -50.00000000000044, 41.90000000000001, 46.3, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.5, 35.30000000000004, 42.30000000000001, 43.10000000000001, -50.00000000000044, 44.5, 36.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, 43.900000000000006, 44.900000000000006, 28.29999999999996, -50.00000000000044, 41.90000000000001, -50.00000000000044, 40.10000000000002, 22.699999999999882, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, 37.300000000000026, 24.299999999999905, 45.5, 38.700000000000024, 1.8999999999995865, -50.00000000000044, 32.30000000000002, 33.10000000000003, -50.00000000000044, 35.10000000000004, 43.30000000000001, 28.699999999999967, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.5, 41.70000000000002, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, 35.10000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 36.900000000000034, 44.300000000000004, 41.100000000000016, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.5, 38.90000000000002, -50.00000000000044, 42.900000000000006, 39.90000000000002, 33.70000000000004, -50.00000000000044], "episode_lengths": [310, 500, 82, 38, 500, 98, 500, 46, 148, 78, 70, 500, 56, 136, 58, 500, 500, 500, 500, 56, 500, 500, 76, 500, 80, 48, 500, 464, 500, 500, 500, 352, 62, 52, 218, 500, 82, 500, 100, 274, 500, 500, 120, 500, 52, 500, 128, 258, 46, 114, 482, 500, 178, 170, 500, 150, 68, 214, 500, 500, 52, 42, 500, 70, 500, 500, 74, 36, 84, 500, 226, 500, 500, 70, 76, 48, 500, 500, 78, 150, 500, 70, 500, 62, 500, 500, 64, 132, 58, 90, 96, 500, 500, 46, 112, 500, 72, 102, 164, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3751251870479432, "mean_inference_ms": 1.2059380806165867, "mean_action_processing_ms": 0.14080288675013303, "mean_env_wait_ms": 0.08179854627663649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599787712097168, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.12199115753173828}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5642.625958278895, "num_env_steps_trained_throughput_per_sec": 5642.625958278895, "timesteps_total": 918000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 918000, "timers": {"training_iteration_time_ms": 3311.261, "sample_time_ms": 2784.0, "load_time_ms": 19.606, "load_throughput": 918091.036, "learn_time_ms": 495.58, "learn_throughput": 36321.083, "synch_weights_time_ms": 9.673}, "counters": {"num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "done": false, "episodes_total": 3443, "training_iteration": 51, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-25", "timestamp": 1698248365, "time_this_iter_s": 3.1960020065307617, "time_total_s": 171.98237895965576, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 171.98237895965576, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 61.25, "ram_util_percent": 27.549999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001249e-17, "cur_lr": 0.0003, "total_loss": 6.622029876708984, "policy_loss": -0.00025540383325682744, "vf_loss": 6.622336726718479, "vf_explained_var": -0.00029682318369547527, "kl": 0.0008971404542105827, "entropy": 0.5143996165858374, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2318.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6779999999998074, "episode_len_mean": 273.8, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, 46.5, 41.70000000000002, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, 35.10000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 36.900000000000034, 44.300000000000004, 41.100000000000016, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.5, 38.90000000000002, -50.00000000000044, 42.900000000000006, 39.90000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 44.10000000000001, 46.9, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 46.099999999999994, -50.00000000000044, 12.899999999999743, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 37.50000000000003, -50.00000000000044, 26.69999999999994, -50.00000000000044, 43.10000000000001, 45.9, 37.10000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 30.099999999999987, 45.5, 43.50000000000001, 28.29999999999996, 31.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 41.90000000000001, 43.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.5, -50.00000000000044, 33.70000000000004, 6.699999999999655, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, 45.9, 45.1, 9.699999999999697, 43.30000000000001, 24.499999999999908, 46.099999999999994], "episode_lengths": [74, 36, 84, 500, 226, 500, 500, 70, 76, 48, 500, 500, 78, 150, 500, 70, 500, 62, 500, 500, 64, 132, 58, 90, 96, 500, 500, 46, 112, 500, 72, 102, 164, 500, 500, 500, 500, 248, 500, 500, 54, 500, 60, 32, 500, 90, 500, 500, 500, 142, 40, 500, 372, 78, 500, 500, 50, 500, 126, 500, 234, 500, 70, 42, 130, 500, 50, 500, 500, 500, 60, 200, 46, 66, 218, 188, 500, 46, 500, 82, 64, 500, 500, 80, 36, 500, 164, 434, 500, 500, 500, 500, 58, 50, 42, 50, 404, 68, 256, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3753879179710779, "mean_inference_ms": 1.2069634092449697, "mean_action_processing_ms": 0.14084924763012968, "mean_env_wait_ms": 0.08180913132051489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199697494506836, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.12196898460388184}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6779999999998074, "episode_len_mean": 273.8, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, 46.5, 41.70000000000002, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, 35.10000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 36.900000000000034, 44.300000000000004, 41.100000000000016, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.5, 38.90000000000002, -50.00000000000044, 42.900000000000006, 39.90000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 44.10000000000001, 46.9, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 46.099999999999994, -50.00000000000044, 12.899999999999743, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 37.50000000000003, -50.00000000000044, 26.69999999999994, -50.00000000000044, 43.10000000000001, 45.9, 37.10000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 30.099999999999987, 45.5, 43.50000000000001, 28.29999999999996, 31.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 41.90000000000001, 43.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.5, -50.00000000000044, 33.70000000000004, 6.699999999999655, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, 45.9, 45.1, 9.699999999999697, 43.30000000000001, 24.499999999999908, 46.099999999999994], "episode_lengths": [74, 36, 84, 500, 226, 500, 500, 70, 76, 48, 500, 500, 78, 150, 500, 70, 500, 62, 500, 500, 64, 132, 58, 90, 96, 500, 500, 46, 112, 500, 72, 102, 164, 500, 500, 500, 500, 248, 500, 500, 54, 500, 60, 32, 500, 90, 500, 500, 500, 142, 40, 500, 372, 78, 500, 500, 50, 500, 126, 500, 234, 500, 70, 42, 130, 500, 50, 500, 500, 500, 60, 200, 46, 66, 218, 188, 500, 46, 500, 82, 64, 500, 500, 80, 36, 500, 164, 434, 500, 500, 500, 500, 58, 50, 42, 50, 404, 68, 256, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3753879179710779, "mean_inference_ms": 1.2069634092449697, "mean_action_processing_ms": 0.14084924763012968, "mean_env_wait_ms": 0.08180913132051489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199697494506836, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.12196898460388184}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4986.286394670056, "num_env_steps_trained_throughput_per_sec": 4986.286394670056, "timesteps_total": 936000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 3353.25, "sample_time_ms": 2823.1, "load_time_ms": 20.006, "load_throughput": 899741.295, "learn_time_ms": 498.07, "learn_throughput": 36139.493, "synch_weights_time_ms": 9.673}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3509, "training_iteration": 52, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-29", "timestamp": 1698248369, "time_this_iter_s": 3.6169002056121826, "time_total_s": 175.59927916526794, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 175.59927916526794, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 61.339999999999996, "ram_util_percent": 27.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.4408920985006246e-17, "cur_lr": 0.0003, "total_loss": 6.678568055894639, "policy_loss": -0.0006269213132327423, "vf_loss": 6.679244814978706, "vf_explained_var": -0.00872274504767524, "kl": 0.0016657001152676938, "entropy": 0.498433561457528, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.317999999999834, "episode_len_mean": 247.5, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 43.50000000000001, 28.29999999999996, 31.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 41.90000000000001, 43.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.5, -50.00000000000044, 33.70000000000004, 6.699999999999655, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, 45.9, 45.1, 9.699999999999697, 43.30000000000001, 24.499999999999908, 46.099999999999994, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.50000000000001, 41.500000000000014, 45.1, 45.1, 43.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 9.099999999999689, 19.69999999999984, 40.30000000000002, -50.00000000000044, 44.5, 40.70000000000002, -50.00000000000044, 37.90000000000003, 39.70000000000002, 44.900000000000006, -50.00000000000044, 45.3, 47.3, -50.00000000000044, 46.9, 40.500000000000014, 11.099999999999717, -50.00000000000044, 44.10000000000001, 44.300000000000004, 45.3, 12.899999999999743, 44.900000000000006, 22.899999999999885, 46.699999999999996, 30.29999999999999, 43.50000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 39.10000000000002, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, 26.89999999999994, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 11.899999999999729, -50.00000000000044, 10.299999999999706, 45.3, 21.299999999999862, -50.00000000000044, 43.50000000000001, 43.10000000000001, 42.900000000000006, -50.00000000000044, 42.70000000000001, 37.90000000000003, 32.90000000000003, -50.00000000000044, 39.70000000000002, 36.900000000000034, -50.00000000000044], "episode_lengths": [46, 66, 218, 188, 500, 46, 500, 82, 64, 500, 500, 80, 36, 500, 164, 434, 500, 500, 500, 500, 58, 50, 42, 50, 404, 68, 256, 40, 500, 500, 100, 66, 86, 50, 50, 62, 48, 500, 500, 410, 304, 98, 500, 56, 94, 500, 122, 104, 52, 500, 48, 28, 500, 32, 96, 390, 500, 60, 58, 48, 372, 52, 272, 34, 198, 66, 52, 500, 500, 500, 500, 336, 110, 500, 48, 500, 90, 232, 56, 500, 500, 500, 50, 382, 500, 398, 48, 288, 500, 66, 70, 72, 500, 74, 122, 172, 500, 104, 132, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37489202631445606, "mean_inference_ms": 1.2090399235362475, "mean_action_processing_ms": 0.1408577111821663, "mean_env_wait_ms": 0.0821602724579875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028003931045532227, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.12292933464050293}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.317999999999834, "episode_len_mean": 247.5, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 43.50000000000001, 28.29999999999996, 31.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 41.90000000000001, 43.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.5, -50.00000000000044, 33.70000000000004, 6.699999999999655, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, 45.9, 45.1, 9.699999999999697, 43.30000000000001, 24.499999999999908, 46.099999999999994, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.50000000000001, 41.500000000000014, 45.1, 45.1, 43.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 9.099999999999689, 19.69999999999984, 40.30000000000002, -50.00000000000044, 44.5, 40.70000000000002, -50.00000000000044, 37.90000000000003, 39.70000000000002, 44.900000000000006, -50.00000000000044, 45.3, 47.3, -50.00000000000044, 46.9, 40.500000000000014, 11.099999999999717, -50.00000000000044, 44.10000000000001, 44.300000000000004, 45.3, 12.899999999999743, 44.900000000000006, 22.899999999999885, 46.699999999999996, 30.29999999999999, 43.50000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 39.10000000000002, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, 26.89999999999994, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 11.899999999999729, -50.00000000000044, 10.299999999999706, 45.3, 21.299999999999862, -50.00000000000044, 43.50000000000001, 43.10000000000001, 42.900000000000006, -50.00000000000044, 42.70000000000001, 37.90000000000003, 32.90000000000003, -50.00000000000044, 39.70000000000002, 36.900000000000034, -50.00000000000044], "episode_lengths": [46, 66, 218, 188, 500, 46, 500, 82, 64, 500, 500, 80, 36, 500, 164, 434, 500, 500, 500, 500, 58, 50, 42, 50, 404, 68, 256, 40, 500, 500, 100, 66, 86, 50, 50, 62, 48, 500, 500, 410, 304, 98, 500, 56, 94, 500, 122, 104, 52, 500, 48, 28, 500, 32, 96, 390, 500, 60, 58, 48, 372, 52, 272, 34, 198, 66, 52, 500, 500, 500, 500, 336, 110, 500, 48, 500, 90, 232, 56, 500, 500, 500, 50, 382, 500, 398, 48, 288, 500, 66, 70, 72, 500, 74, 122, 172, 500, 104, 132, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37489202631445606, "mean_inference_ms": 1.2090399235362475, "mean_action_processing_ms": 0.1408577111821663, "mean_env_wait_ms": 0.0821602724579875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028003931045532227, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.12292933464050293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4987.527922008042, "num_env_steps_trained_throughput_per_sec": 4987.527922008042, "timesteps_total": 954000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 954000, "timers": {"training_iteration_time_ms": 3398.433, "sample_time_ms": 2859.7, "load_time_ms": 19.606, "load_throughput": 918098.852, "learn_time_ms": 507.053, "learn_throughput": 35499.235, "synch_weights_time_ms": 9.673}, "counters": {"num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "done": false, "episodes_total": 3581, "training_iteration": 53, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-32", "timestamp": 1698248372, "time_this_iter_s": 3.620000123977661, "time_total_s": 179.2192792892456, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 179.2192792892456, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 56.25, "ram_util_percent": 27.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503123e-17, "cur_lr": 0.0003, "total_loss": 6.683366362253825, "policy_loss": -0.00013253348362114695, "vf_loss": 6.68354540930854, "vf_explained_var": -0.0003879759046766493, "kl": 0.000976226433011915, "entropy": 0.46545765598615013, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2408.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.704999999999837, "episode_len_mean": 248.62, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, 26.89999999999994, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 11.899999999999729, -50.00000000000044, 10.299999999999706, 45.3, 21.299999999999862, -50.00000000000044, 43.50000000000001, 43.10000000000001, 42.900000000000006, -50.00000000000044, 42.70000000000001, 37.90000000000003, 32.90000000000003, -50.00000000000044, 39.70000000000002, 36.900000000000034, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.10000000000001, 32.90000000000003, 29.49999999999998, 47.3, 24.299999999999905, 44.7, 43.900000000000006, 45.5, -50.00000000000044, 46.699999999999996, 38.10000000000002, 47.1, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.5, 34.70000000000004, 40.70000000000002, -50.00000000000044, 45.1, 20.49999999999985, 42.70000000000001, -50.00000000000044, 28.29999999999996, -50.00000000000044, 45.5, 31.300000000000004, 47.3, 45.3, -50.00000000000044, 38.50000000000003, 45.1, 31.900000000000013, -50.00000000000044, 46.9, 42.500000000000014, -50.00000000000044, 26.69999999999994, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 46.3, 33.500000000000036, -50.00000000000044, 40.30000000000002, 37.50000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 43.30000000000001, 44.900000000000006, 38.700000000000024, 45.7, -50.00000000000044, 0.09999999999956088, 43.7, 46.3, -50.00000000000044, 33.90000000000004, -50.00000000000044, 43.900000000000006, 0.8999999999995723, 43.900000000000006], "episode_lengths": [500, 48, 500, 90, 232, 56, 500, 500, 500, 50, 382, 500, 398, 48, 288, 500, 66, 70, 72, 500, 74, 122, 172, 500, 104, 132, 500, 56, 500, 500, 50, 500, 60, 172, 206, 28, 258, 54, 62, 46, 500, 34, 120, 30, 74, 500, 500, 500, 46, 36, 154, 94, 500, 50, 296, 74, 500, 218, 500, 46, 188, 28, 48, 500, 116, 50, 182, 500, 32, 76, 500, 234, 500, 116, 500, 500, 500, 390, 38, 166, 500, 98, 126, 500, 148, 500, 68, 52, 114, 44, 500, 500, 64, 38, 500, 162, 500, 62, 492, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37602381772019533, "mean_inference_ms": 1.2095866590016868, "mean_action_processing_ms": 0.14121982452702142, "mean_env_wait_ms": 0.08215575752163591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02201247215270996, "StateBufferConnector_ms": 0.0070095062255859375, "ViewRequirementAgentConnector_ms": 0.10699582099914551}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.704999999999837, "episode_len_mean": 248.62, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, 26.89999999999994, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 11.899999999999729, -50.00000000000044, 10.299999999999706, 45.3, 21.299999999999862, -50.00000000000044, 43.50000000000001, 43.10000000000001, 42.900000000000006, -50.00000000000044, 42.70000000000001, 37.90000000000003, 32.90000000000003, -50.00000000000044, 39.70000000000002, 36.900000000000034, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.10000000000001, 32.90000000000003, 29.49999999999998, 47.3, 24.299999999999905, 44.7, 43.900000000000006, 45.5, -50.00000000000044, 46.699999999999996, 38.10000000000002, 47.1, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.5, 34.70000000000004, 40.70000000000002, -50.00000000000044, 45.1, 20.49999999999985, 42.70000000000001, -50.00000000000044, 28.29999999999996, -50.00000000000044, 45.5, 31.300000000000004, 47.3, 45.3, -50.00000000000044, 38.50000000000003, 45.1, 31.900000000000013, -50.00000000000044, 46.9, 42.500000000000014, -50.00000000000044, 26.69999999999994, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 46.3, 33.500000000000036, -50.00000000000044, 40.30000000000002, 37.50000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 43.30000000000001, 44.900000000000006, 38.700000000000024, 45.7, -50.00000000000044, 0.09999999999956088, 43.7, 46.3, -50.00000000000044, 33.90000000000004, -50.00000000000044, 43.900000000000006, 0.8999999999995723, 43.900000000000006], "episode_lengths": [500, 48, 500, 90, 232, 56, 500, 500, 500, 50, 382, 500, 398, 48, 288, 500, 66, 70, 72, 500, 74, 122, 172, 500, 104, 132, 500, 56, 500, 500, 50, 500, 60, 172, 206, 28, 258, 54, 62, 46, 500, 34, 120, 30, 74, 500, 500, 500, 46, 36, 154, 94, 500, 50, 296, 74, 500, 218, 500, 46, 188, 28, 48, 500, 116, 50, 182, 500, 32, 76, 500, 234, 500, 116, 500, 500, 500, 390, 38, 166, 500, 98, 126, 500, 148, 500, 68, 52, 114, 44, 500, 500, 64, 38, 500, 162, 500, 62, 492, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37602381772019533, "mean_inference_ms": 1.2095866590016868, "mean_action_processing_ms": 0.14121982452702142, "mean_env_wait_ms": 0.08215575752163591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02201247215270996, "StateBufferConnector_ms": 0.0070095062255859375, "ViewRequirementAgentConnector_ms": 0.10699582099914551}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4891.122367475785, "num_env_steps_trained_throughput_per_sec": 4891.122367475785, "timesteps_total": 972000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 3423.747, "sample_time_ms": 2886.314, "load_time_ms": 19.606, "load_throughput": 918107.783, "learn_time_ms": 506.35, "learn_throughput": 35548.549, "synch_weights_time_ms": 9.176}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3654, "training_iteration": 54, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-36", "timestamp": 1698248376, "time_this_iter_s": 3.6871373653411865, "time_total_s": 182.9064166545868, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 182.9064166545868, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 59.260000000000005, "ram_util_percent": 27.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251561e-17, "cur_lr": 0.0003, "total_loss": 6.502354134453667, "policy_loss": -0.0004005459447701772, "vf_loss": 6.50280434290568, "vf_explained_var": 0.0014525267812940809, "kl": 0.000905461197343824, "entropy": 0.496656158235338, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2453.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.214999999999822, "episode_len_mean": 263.5, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 42.500000000000014, -50.00000000000044, 26.69999999999994, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 46.3, 33.500000000000036, -50.00000000000044, 40.30000000000002, 37.50000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 43.30000000000001, 44.900000000000006, 38.700000000000024, 45.7, -50.00000000000044, 0.09999999999956088, 43.7, 46.3, -50.00000000000044, 33.90000000000004, -50.00000000000044, 43.900000000000006, 0.8999999999995723, 43.900000000000006, 9.699999999999697, 28.89999999999997, 40.30000000000002, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, 44.900000000000006, 46.5, 22.099999999999874, 44.7, 46.099999999999994, -50.00000000000044, 29.69999999999998, 0.6999999999995694, 38.10000000000002, 44.5, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.099999999999994, 41.30000000000001, 35.30000000000004, -50.00000000000044, 33.10000000000003, 43.30000000000001, 38.700000000000024, -50.00000000000044, 44.900000000000006, 41.70000000000002, 19.09999999999983, 45.1, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, 47.3, 11.29999999999972, 25.099999999999916, 44.300000000000004, 44.900000000000006, 34.900000000000034, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.90000000000001, -50.00000000000044, 26.09999999999993, 42.900000000000006, 46.5, 29.49999999999998, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 25.099999999999916, -50.00000000000044], "episode_lengths": [500, 32, 76, 500, 234, 500, 116, 500, 500, 500, 390, 38, 166, 500, 98, 126, 500, 148, 500, 68, 52, 114, 44, 500, 500, 64, 38, 500, 162, 500, 62, 492, 62, 404, 212, 98, 500, 120, 500, 500, 54, 52, 36, 280, 54, 40, 500, 204, 494, 120, 56, 176, 500, 500, 500, 66, 500, 40, 88, 148, 500, 170, 68, 114, 500, 52, 84, 310, 50, 500, 500, 74, 78, 500, 500, 28, 388, 250, 58, 52, 152, 66, 500, 500, 44, 500, 40, 500, 82, 500, 240, 72, 36, 206, 500, 500, 62, 500, 250, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37708701926223237, "mean_inference_ms": 1.2126593481418668, "mean_action_processing_ms": 0.14131555025648815, "mean_env_wait_ms": 0.08251658355203367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799224853515625, "StateBufferConnector_ms": 0.008002519607543945, "ViewRequirementAgentConnector_ms": 0.13699102401733398}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.214999999999822, "episode_len_mean": 263.5, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 42.500000000000014, -50.00000000000044, 26.69999999999994, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 46.3, 33.500000000000036, -50.00000000000044, 40.30000000000002, 37.50000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 43.30000000000001, 44.900000000000006, 38.700000000000024, 45.7, -50.00000000000044, 0.09999999999956088, 43.7, 46.3, -50.00000000000044, 33.90000000000004, -50.00000000000044, 43.900000000000006, 0.8999999999995723, 43.900000000000006, 9.699999999999697, 28.89999999999997, 40.30000000000002, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, 44.900000000000006, 46.5, 22.099999999999874, 44.7, 46.099999999999994, -50.00000000000044, 29.69999999999998, 0.6999999999995694, 38.10000000000002, 44.5, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.099999999999994, 41.30000000000001, 35.30000000000004, -50.00000000000044, 33.10000000000003, 43.30000000000001, 38.700000000000024, -50.00000000000044, 44.900000000000006, 41.70000000000002, 19.09999999999983, 45.1, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, 47.3, 11.29999999999972, 25.099999999999916, 44.300000000000004, 44.900000000000006, 34.900000000000034, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.90000000000001, -50.00000000000044, 26.09999999999993, 42.900000000000006, 46.5, 29.49999999999998, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 25.099999999999916, -50.00000000000044], "episode_lengths": [500, 32, 76, 500, 234, 500, 116, 500, 500, 500, 390, 38, 166, 500, 98, 126, 500, 148, 500, 68, 52, 114, 44, 500, 500, 64, 38, 500, 162, 500, 62, 492, 62, 404, 212, 98, 500, 120, 500, 500, 54, 52, 36, 280, 54, 40, 500, 204, 494, 120, 56, 176, 500, 500, 500, 66, 500, 40, 88, 148, 500, 170, 68, 114, 500, 52, 84, 310, 50, 500, 500, 74, 78, 500, 500, 28, 388, 250, 58, 52, 152, 66, 500, 500, 44, 500, 40, 500, 82, 500, 240, 72, 36, 206, 500, 500, 62, 500, 250, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37708701926223237, "mean_inference_ms": 1.2126593481418668, "mean_action_processing_ms": 0.14131555025648815, "mean_env_wait_ms": 0.08251658355203367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799224853515625, "StateBufferConnector_ms": 0.008002519607543945, "ViewRequirementAgentConnector_ms": 0.13699102401733398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4572.007717565212, "num_env_steps_trained_throughput_per_sec": 4572.007717565212, "timesteps_total": 990000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 990000, "timers": {"training_iteration_time_ms": 3486.506, "sample_time_ms": 2949.314, "load_time_ms": 18.806, "load_throughput": 957164.164, "learn_time_ms": 506.794, "learn_throughput": 35517.37, "synch_weights_time_ms": 9.291}, "counters": {"num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "done": false, "episodes_total": 3721, "training_iteration": 55, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-40", "timestamp": 1698248380, "time_this_iter_s": 3.942999839782715, "time_total_s": 186.8494164943695, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 186.8494164943695, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 73.97999999999999, "ram_util_percent": 27.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125781e-18, "cur_lr": 0.0003, "total_loss": 6.942219554053413, "policy_loss": -8.673883146709866e-06, "vf_loss": 6.942275926801893, "vf_explained_var": -0.0023573093944125705, "kl": 0.0006837318813328213, "entropy": 0.4777611474196116, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2498.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.030999999999822, "episode_len_mean": 265.32, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.29999999999972, 25.099999999999916, 44.300000000000004, 44.900000000000006, 34.900000000000034, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.90000000000001, -50.00000000000044, 26.09999999999993, 42.900000000000006, 46.5, 29.49999999999998, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 25.099999999999916, -50.00000000000044, 27.899999999999956, 38.50000000000003, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, 46.5, 44.10000000000001, -50.00000000000044, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 14.499999999999766, 46.5, 41.70000000000002, 41.70000000000002, 34.900000000000034, 42.900000000000006, -50.00000000000044, 39.10000000000002, -50.00000000000044, 28.699999999999967, 40.90000000000002, 32.90000000000003, 45.9, 44.900000000000006, -50.00000000000044, 46.3, 36.10000000000004, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, 41.70000000000002, 10.099999999999703, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.30000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.10000000000001, 31.1, 26.299999999999933, 45.3, 19.09999999999983, 22.899999999999885, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 26.69999999999994, 44.10000000000001, 34.50000000000004, -50.00000000000044, 44.300000000000004, 42.900000000000006, -50.00000000000044, 35.70000000000003, 44.900000000000006, -50.00000000000044, 37.90000000000003, -50.00000000000044], "episode_lengths": [388, 250, 58, 52, 152, 66, 500, 500, 44, 500, 40, 500, 82, 500, 240, 72, 36, 206, 500, 500, 62, 500, 250, 500, 222, 116, 500, 36, 500, 60, 36, 60, 500, 494, 500, 500, 356, 36, 84, 84, 152, 72, 500, 110, 500, 214, 92, 172, 42, 52, 500, 38, 140, 500, 46, 500, 500, 146, 84, 400, 500, 500, 102, 500, 500, 96, 68, 88, 500, 500, 74, 500, 500, 76, 500, 500, 58, 60, 190, 238, 48, 310, 272, 500, 62, 500, 50, 500, 234, 60, 156, 500, 58, 72, 500, 144, 52, 500, 122, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3782955652860604, "mean_inference_ms": 1.2181059969368633, "mean_action_processing_ms": 0.14193945565553873, "mean_env_wait_ms": 0.08318231486642375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030008792877197266, "StateBufferConnector_ms": 0.008996725082397461, "ViewRequirementAgentConnector_ms": 0.15378189086914062}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.030999999999822, "episode_len_mean": 265.32, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.29999999999972, 25.099999999999916, 44.300000000000004, 44.900000000000006, 34.900000000000034, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.90000000000001, -50.00000000000044, 26.09999999999993, 42.900000000000006, 46.5, 29.49999999999998, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 25.099999999999916, -50.00000000000044, 27.899999999999956, 38.50000000000003, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, 46.5, 44.10000000000001, -50.00000000000044, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 14.499999999999766, 46.5, 41.70000000000002, 41.70000000000002, 34.900000000000034, 42.900000000000006, -50.00000000000044, 39.10000000000002, -50.00000000000044, 28.699999999999967, 40.90000000000002, 32.90000000000003, 45.9, 44.900000000000006, -50.00000000000044, 46.3, 36.10000000000004, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, 41.70000000000002, 10.099999999999703, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.30000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.10000000000001, 31.1, 26.299999999999933, 45.3, 19.09999999999983, 22.899999999999885, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 26.69999999999994, 44.10000000000001, 34.50000000000004, -50.00000000000044, 44.300000000000004, 42.900000000000006, -50.00000000000044, 35.70000000000003, 44.900000000000006, -50.00000000000044, 37.90000000000003, -50.00000000000044], "episode_lengths": [388, 250, 58, 52, 152, 66, 500, 500, 44, 500, 40, 500, 82, 500, 240, 72, 36, 206, 500, 500, 62, 500, 250, 500, 222, 116, 500, 36, 500, 60, 36, 60, 500, 494, 500, 500, 356, 36, 84, 84, 152, 72, 500, 110, 500, 214, 92, 172, 42, 52, 500, 38, 140, 500, 46, 500, 500, 146, 84, 400, 500, 500, 102, 500, 500, 96, 68, 88, 500, 500, 74, 500, 500, 76, 500, 500, 58, 60, 190, 238, 48, 310, 272, 500, 62, 500, 50, 500, 234, 60, 156, 500, 58, 72, 500, 144, 52, 500, 122, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3782955652860604, "mean_inference_ms": 1.2181059969368633, "mean_action_processing_ms": 0.14193945565553873, "mean_env_wait_ms": 0.08318231486642375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030008792877197266, "StateBufferConnector_ms": 0.008996725082397461, "ViewRequirementAgentConnector_ms": 0.15378189086914062}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4385.966598032221, "num_env_steps_trained_throughput_per_sec": 4385.966598032221, "timesteps_total": 1008000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 3562.606, "sample_time_ms": 3024.114, "load_time_ms": 18.706, "load_throughput": 962275.891, "learn_time_ms": 507.992, "learn_throughput": 35433.662, "synch_weights_time_ms": 9.493}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3797, "training_iteration": 56, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-44", "timestamp": 1698248384, "time_this_iter_s": 4.111011266708374, "time_total_s": 190.96042776107788, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 190.96042776107788, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 69.11666666666666, "ram_util_percent": 27.549999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7755575615628903e-18, "cur_lr": 0.0003, "total_loss": 6.25034843020969, "policy_loss": -0.000345148729522609, "vf_loss": 6.250744607713488, "vf_explained_var": -0.0032912929852803546, "kl": 0.0010036966730720249, "entropy": 0.51075220240487, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2543.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3579999999998034, "episode_len_mean": 287.02, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.10000000000004, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, 41.70000000000002, 10.099999999999703, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.30000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.10000000000001, 31.1, 26.299999999999933, 45.3, 19.09999999999983, 22.899999999999885, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 26.69999999999994, 44.10000000000001, 34.50000000000004, -50.00000000000044, 44.300000000000004, 42.900000000000006, -50.00000000000044, 35.70000000000003, 44.900000000000006, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.9, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, 35.30000000000004, -50.00000000000044, 15.099999999999774, 30.499999999999993, -50.00000000000044, 10.899999999999714, 20.899999999999856, -50.00000000000044, 42.500000000000014, 0.49999999999956657, -50.00000000000044, 17.499999999999808, -50.00000000000044, 31.500000000000007, 22.299999999999876, -50.00000000000044, -50.00000000000044, 32.90000000000003, 40.10000000000002, 37.90000000000003, 43.50000000000001, 43.7, -50.00000000000044, 45.9, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 14.699999999999768, 40.90000000000002, 46.9, 28.89999999999997, 14.499999999999766, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.7], "episode_lengths": [140, 500, 46, 500, 500, 146, 84, 400, 500, 500, 102, 500, 500, 96, 68, 88, 500, 500, 74, 500, 500, 76, 500, 500, 58, 60, 190, 238, 48, 310, 272, 500, 62, 500, 50, 500, 234, 60, 156, 500, 58, 72, 500, 144, 52, 500, 122, 500, 500, 44, 500, 92, 500, 500, 62, 32, 42, 500, 72, 500, 148, 500, 350, 196, 500, 392, 292, 500, 76, 496, 500, 326, 500, 186, 278, 500, 500, 172, 100, 122, 66, 64, 500, 42, 100, 500, 500, 46, 500, 354, 92, 32, 212, 356, 204, 500, 500, 500, 96, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3795801740953098, "mean_inference_ms": 1.2216509625257195, "mean_action_processing_ms": 0.14284094566032768, "mean_env_wait_ms": 0.08321026632483262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019994020462036133, "StateBufferConnector_ms": 0.008996725082397461, "ViewRequirementAgentConnector_ms": 0.16896986961364746}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3579999999998034, "episode_len_mean": 287.02, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.10000000000004, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, 41.70000000000002, 10.099999999999703, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.30000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.10000000000001, 31.1, 26.299999999999933, 45.3, 19.09999999999983, 22.899999999999885, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 26.69999999999994, 44.10000000000001, 34.50000000000004, -50.00000000000044, 44.300000000000004, 42.900000000000006, -50.00000000000044, 35.70000000000003, 44.900000000000006, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.9, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, 35.30000000000004, -50.00000000000044, 15.099999999999774, 30.499999999999993, -50.00000000000044, 10.899999999999714, 20.899999999999856, -50.00000000000044, 42.500000000000014, 0.49999999999956657, -50.00000000000044, 17.499999999999808, -50.00000000000044, 31.500000000000007, 22.299999999999876, -50.00000000000044, -50.00000000000044, 32.90000000000003, 40.10000000000002, 37.90000000000003, 43.50000000000001, 43.7, -50.00000000000044, 45.9, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 14.699999999999768, 40.90000000000002, 46.9, 28.89999999999997, 14.499999999999766, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.7], "episode_lengths": [140, 500, 46, 500, 500, 146, 84, 400, 500, 500, 102, 500, 500, 96, 68, 88, 500, 500, 74, 500, 500, 76, 500, 500, 58, 60, 190, 238, 48, 310, 272, 500, 62, 500, 50, 500, 234, 60, 156, 500, 58, 72, 500, 144, 52, 500, 122, 500, 500, 44, 500, 92, 500, 500, 62, 32, 42, 500, 72, 500, 148, 500, 350, 196, 500, 392, 292, 500, 76, 496, 500, 326, 500, 186, 278, 500, 500, 172, 100, 122, 66, 64, 500, 42, 100, 500, 500, 46, 500, 354, 92, 32, 212, 356, 204, 500, 500, 500, 96, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3795801740953098, "mean_inference_ms": 1.2216509625257195, "mean_action_processing_ms": 0.14284094566032768, "mean_env_wait_ms": 0.08321026632483262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019994020462036133, "StateBufferConnector_ms": 0.008996725082397461, "ViewRequirementAgentConnector_ms": 0.16896986961364746}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4452.142669826477, "num_env_steps_trained_throughput_per_sec": 4452.142669826477, "timesteps_total": 1026000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1026000, "timers": {"training_iteration_time_ms": 3627.405, "sample_time_ms": 3082.814, "load_time_ms": 18.605, "load_throughput": 967458.625, "learn_time_ms": 513.889, "learn_throughput": 35027.04, "synch_weights_time_ms": 9.797}, "counters": {"num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "done": false, "episodes_total": 3849, "training_iteration": 57, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-48", "timestamp": 1698248388, "time_this_iter_s": 4.0489959716796875, "time_total_s": 195.00942373275757, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 195.00942373275757, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 68.50000000000001, "ram_util_percent": 27.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3877787807814452e-18, "cur_lr": 0.0003, "total_loss": 6.703802850511339, "policy_loss": -0.0001494718573263122, "vf_loss": 6.704000504811605, "vf_explained_var": 0.00011765162150065104, "kl": 0.0005409020217486473, "entropy": 0.4819715738296509, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2588.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.965999999999822, "episode_len_mean": 260.96, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.90000000000003, 40.10000000000002, 37.90000000000003, 43.50000000000001, 43.7, -50.00000000000044, 45.9, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 14.699999999999768, 40.90000000000002, 46.9, 28.89999999999997, 14.499999999999766, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, 36.10000000000004, 39.300000000000026, 45.1, -50.00000000000044, 42.30000000000001, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.50000000000001, 31.1, 29.899999999999984, 27.49999999999995, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.1, 44.7, 46.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.7, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 27.299999999999947, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.3, -50.00000000000044, 44.300000000000004, 33.30000000000003, -50.00000000000044, 45.1, -50.00000000000044, 39.90000000000002, 27.099999999999945, 47.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, 46.5, 44.300000000000004, 46.699999999999996, 43.30000000000001, 44.5, 19.69999999999984, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.70000000000002, 19.69999999999984, 44.10000000000001, 43.900000000000006, 34.50000000000004, 46.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044], "episode_lengths": [500, 172, 100, 122, 66, 64, 500, 42, 100, 500, 500, 46, 500, 354, 92, 32, 212, 356, 204, 500, 500, 500, 96, 54, 500, 500, 140, 108, 50, 500, 78, 494, 500, 500, 108, 500, 500, 66, 190, 202, 226, 68, 500, 500, 46, 500, 500, 50, 54, 38, 500, 90, 500, 64, 202, 500, 500, 500, 52, 228, 500, 68, 500, 500, 88, 38, 500, 58, 168, 500, 50, 500, 102, 230, 26, 54, 500, 500, 500, 58, 50, 36, 58, 34, 68, 56, 304, 500, 84, 500, 104, 304, 60, 62, 156, 38, 500, 500, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38154913564469184, "mean_inference_ms": 1.227886570556378, "mean_action_processing_ms": 0.1432037355109045, "mean_env_wait_ms": 0.08391211139450026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03297686576843262, "StateBufferConnector_ms": 0.008995294570922852, "ViewRequirementAgentConnector_ms": 0.14003634452819824}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.965999999999822, "episode_len_mean": 260.96, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.90000000000003, 40.10000000000002, 37.90000000000003, 43.50000000000001, 43.7, -50.00000000000044, 45.9, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 14.699999999999768, 40.90000000000002, 46.9, 28.89999999999997, 14.499999999999766, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, 36.10000000000004, 39.300000000000026, 45.1, -50.00000000000044, 42.30000000000001, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.50000000000001, 31.1, 29.899999999999984, 27.49999999999995, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.1, 44.7, 46.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.7, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 27.299999999999947, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.3, -50.00000000000044, 44.300000000000004, 33.30000000000003, -50.00000000000044, 45.1, -50.00000000000044, 39.90000000000002, 27.099999999999945, 47.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, 46.5, 44.300000000000004, 46.699999999999996, 43.30000000000001, 44.5, 19.69999999999984, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.70000000000002, 19.69999999999984, 44.10000000000001, 43.900000000000006, 34.50000000000004, 46.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044], "episode_lengths": [500, 172, 100, 122, 66, 64, 500, 42, 100, 500, 500, 46, 500, 354, 92, 32, 212, 356, 204, 500, 500, 500, 96, 54, 500, 500, 140, 108, 50, 500, 78, 494, 500, 500, 108, 500, 500, 66, 190, 202, 226, 68, 500, 500, 46, 500, 500, 50, 54, 38, 500, 90, 500, 64, 202, 500, 500, 500, 52, 228, 500, 68, 500, 500, 88, 38, 500, 58, 168, 500, 50, 500, 102, 230, 26, 54, 500, 500, 500, 58, 50, 36, 58, 34, 68, 56, 304, 500, 84, 500, 104, 304, 60, 62, 156, 38, 500, 500, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38154913564469184, "mean_inference_ms": 1.227886570556378, "mean_action_processing_ms": 0.1432037355109045, "mean_env_wait_ms": 0.08391211139450026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03297686576843262, "StateBufferConnector_ms": 0.008995294570922852, "ViewRequirementAgentConnector_ms": 0.14003634452819824}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4331.08495647372, "num_env_steps_trained_throughput_per_sec": 4331.08495647372, "timesteps_total": 1044000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 3708.905, "sample_time_ms": 3154.514, "load_time_ms": 18.905, "load_throughput": 952108.859, "learn_time_ms": 523.189, "learn_throughput": 34404.393, "synch_weights_time_ms": 9.996}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 3925, "training_iteration": 58, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-52", "timestamp": 1698248392, "time_this_iter_s": 4.161002159118652, "time_total_s": 199.17042589187622, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 199.17042589187622, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 70.15, "ram_util_percent": 27.683333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.938893903907226e-19, "cur_lr": 0.0003, "total_loss": 6.742409377627903, "policy_loss": -0.00025081303384568956, "vf_loss": 6.74271347257826, "vf_explained_var": 0.0010480403900146485, "kl": 0.0005262794164018992, "entropy": 0.5330366710821788, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2633.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.812999999999823, "episode_len_mean": 257.5, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, 44.300000000000004, 33.30000000000003, -50.00000000000044, 45.1, -50.00000000000044, 39.90000000000002, 27.099999999999945, 47.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, 46.5, 44.300000000000004, 46.699999999999996, 43.30000000000001, 44.5, 19.69999999999984, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.70000000000002, 19.69999999999984, 44.10000000000001, 43.900000000000006, 34.50000000000004, 46.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.70000000000004, -50.00000000000044, 40.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 15.299999999999777, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.100000000000016, 41.500000000000014, -50.00000000000044, 37.70000000000003, 44.300000000000004, -50.00000000000044, 40.70000000000002, 39.10000000000002, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.3, 44.10000000000001, 46.099999999999994, 38.90000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 42.500000000000014, 23.099999999999888, 40.500000000000014, 15.899999999999785, 42.900000000000006, 44.7, 34.50000000000004, 44.7, -50.00000000000044, 42.10000000000001, 33.10000000000003, 21.09999999999986, 13.099999999999746, -50.00000000000044, -50.00000000000044, 6.099999999999646, 45.1, -50.00000000000044, 45.7, 26.299999999999933, 45.3], "episode_lengths": [38, 500, 58, 168, 500, 50, 500, 102, 230, 26, 54, 500, 500, 500, 58, 50, 36, 58, 34, 68, 56, 304, 500, 84, 500, 104, 304, 60, 62, 156, 38, 500, 500, 76, 500, 500, 98, 164, 500, 92, 46, 500, 500, 500, 500, 500, 500, 110, 348, 500, 500, 54, 500, 500, 500, 50, 90, 86, 500, 124, 58, 500, 94, 110, 500, 54, 500, 500, 500, 500, 66, 48, 60, 40, 112, 66, 500, 500, 156, 76, 270, 96, 342, 72, 54, 156, 54, 500, 80, 170, 290, 370, 500, 500, 440, 50, 500, 44, 238, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3828178824409382, "mean_inference_ms": 1.231539027915237, "mean_action_processing_ms": 0.1435647308382111, "mean_env_wait_ms": 0.08413810464276099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03198599815368652, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.15000104904174805}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.812999999999823, "episode_len_mean": 257.5, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, 44.300000000000004, 33.30000000000003, -50.00000000000044, 45.1, -50.00000000000044, 39.90000000000002, 27.099999999999945, 47.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, 46.5, 44.300000000000004, 46.699999999999996, 43.30000000000001, 44.5, 19.69999999999984, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.70000000000002, 19.69999999999984, 44.10000000000001, 43.900000000000006, 34.50000000000004, 46.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.70000000000004, -50.00000000000044, 40.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 15.299999999999777, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.100000000000016, 41.500000000000014, -50.00000000000044, 37.70000000000003, 44.300000000000004, -50.00000000000044, 40.70000000000002, 39.10000000000002, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.3, 44.10000000000001, 46.099999999999994, 38.90000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 42.500000000000014, 23.099999999999888, 40.500000000000014, 15.899999999999785, 42.900000000000006, 44.7, 34.50000000000004, 44.7, -50.00000000000044, 42.10000000000001, 33.10000000000003, 21.09999999999986, 13.099999999999746, -50.00000000000044, -50.00000000000044, 6.099999999999646, 45.1, -50.00000000000044, 45.7, 26.299999999999933, 45.3], "episode_lengths": [38, 500, 58, 168, 500, 50, 500, 102, 230, 26, 54, 500, 500, 500, 58, 50, 36, 58, 34, 68, 56, 304, 500, 84, 500, 104, 304, 60, 62, 156, 38, 500, 500, 76, 500, 500, 98, 164, 500, 92, 46, 500, 500, 500, 500, 500, 500, 110, 348, 500, 500, 54, 500, 500, 500, 50, 90, 86, 500, 124, 58, 500, 94, 110, 500, 54, 500, 500, 500, 500, 66, 48, 60, 40, 112, 66, 500, 500, 156, 76, 270, 96, 342, 72, 54, 156, 54, 500, 80, 170, 290, 370, 500, 500, 440, 50, 500, 44, 238, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3828178824409382, "mean_inference_ms": 1.231539027915237, "mean_action_processing_ms": 0.1435647308382111, "mean_env_wait_ms": 0.08413810464276099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03198599815368652, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.15000104904174805}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4704.641561609437, "num_env_steps_trained_throughput_per_sec": 4704.641561609437, "timesteps_total": 1062000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1062000, "timers": {"training_iteration_time_ms": 3753.506, "sample_time_ms": 3193.313, "load_time_ms": 20.403, "load_throughput": 882235.414, "learn_time_ms": 526.992, "learn_throughput": 34156.119, "synch_weights_time_ms": 10.296}, "counters": {"num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "done": false, "episodes_total": 3990, "training_iteration": 59, "trial_id": "9f288_00013", "date": "2023-10-25_16-39-56", "timestamp": 1698248396, "time_this_iter_s": 3.8330001831054688, "time_total_s": 203.0034260749817, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 203.0034260749817, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 73.12, "ram_util_percent": 27.639999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953613e-19, "cur_lr": 0.0003, "total_loss": 6.894743792215983, "policy_loss": -0.0002832024875614378, "vf_loss": 6.895079135894775, "vf_explained_var": -0.0009101761711968316, "kl": 0.0007415055443511658, "entropy": 0.5203707092338138, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2678.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.873999999999842, "episode_len_mean": 241.96, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 46.099999999999994, 38.90000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 42.500000000000014, 23.099999999999888, 40.500000000000014, 15.899999999999785, 42.900000000000006, 44.7, 34.50000000000004, 44.7, -50.00000000000044, 42.10000000000001, 33.10000000000003, 21.09999999999986, 13.099999999999746, -50.00000000000044, -50.00000000000044, 6.099999999999646, 45.1, -50.00000000000044, 45.7, 26.299999999999933, 45.3, -50.00000000000044, 40.90000000000002, 31.500000000000007, 34.900000000000034, 47.3, 43.7, 43.30000000000001, 46.3, 27.699999999999953, 42.30000000000001, 45.3, 39.10000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.7, 3.699999999999612, 43.50000000000001, 14.899999999999771, -50.00000000000044, 43.50000000000001, 44.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.5, 41.500000000000014, 46.3, 39.70000000000002, -50.00000000000044, 40.90000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 47.3, 43.50000000000001, -50.00000000000044, 46.5, 4.099999999999618, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, 40.500000000000014, 17.69999999999981, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 46.5, 36.30000000000003, 30.099999999999987, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 47.3, 46.699999999999996, 45.9, 31.1, 39.300000000000026, 41.70000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044], "episode_lengths": [60, 40, 112, 66, 500, 500, 156, 76, 270, 96, 342, 72, 54, 156, 54, 500, 80, 170, 290, 370, 500, 500, 440, 50, 500, 44, 238, 48, 500, 92, 186, 152, 28, 64, 68, 38, 224, 78, 48, 110, 500, 60, 500, 62, 500, 54, 464, 66, 352, 500, 66, 52, 500, 84, 500, 36, 86, 38, 104, 500, 92, 120, 500, 500, 66, 28, 66, 500, 36, 460, 70, 500, 500, 54, 96, 324, 500, 500, 500, 500, 500, 390, 36, 138, 200, 500, 284, 500, 500, 268, 500, 28, 34, 42, 190, 108, 84, 86, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38303433569629797, "mean_inference_ms": 1.2344856207845574, "mean_action_processing_ms": 0.14410758791957107, "mean_env_wait_ms": 0.0845357387801275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033987998962402344, "StateBufferConnector_ms": 0.009004592895507812, "ViewRequirementAgentConnector_ms": 0.1309823989868164}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.873999999999842, "episode_len_mean": 241.96, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 46.099999999999994, 38.90000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 42.500000000000014, 23.099999999999888, 40.500000000000014, 15.899999999999785, 42.900000000000006, 44.7, 34.50000000000004, 44.7, -50.00000000000044, 42.10000000000001, 33.10000000000003, 21.09999999999986, 13.099999999999746, -50.00000000000044, -50.00000000000044, 6.099999999999646, 45.1, -50.00000000000044, 45.7, 26.299999999999933, 45.3, -50.00000000000044, 40.90000000000002, 31.500000000000007, 34.900000000000034, 47.3, 43.7, 43.30000000000001, 46.3, 27.699999999999953, 42.30000000000001, 45.3, 39.10000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.7, 3.699999999999612, 43.50000000000001, 14.899999999999771, -50.00000000000044, 43.50000000000001, 44.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.5, 41.500000000000014, 46.3, 39.70000000000002, -50.00000000000044, 40.90000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 47.3, 43.50000000000001, -50.00000000000044, 46.5, 4.099999999999618, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, 40.500000000000014, 17.69999999999981, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 46.5, 36.30000000000003, 30.099999999999987, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 47.3, 46.699999999999996, 45.9, 31.1, 39.300000000000026, 41.70000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044], "episode_lengths": [60, 40, 112, 66, 500, 500, 156, 76, 270, 96, 342, 72, 54, 156, 54, 500, 80, 170, 290, 370, 500, 500, 440, 50, 500, 44, 238, 48, 500, 92, 186, 152, 28, 64, 68, 38, 224, 78, 48, 110, 500, 60, 500, 62, 500, 54, 464, 66, 352, 500, 66, 52, 500, 84, 500, 36, 86, 38, 104, 500, 92, 120, 500, 500, 66, 28, 66, 500, 36, 460, 70, 500, 500, 54, 96, 324, 500, 500, 500, 500, 500, 390, 36, 138, 200, 500, 284, 500, 500, 268, 500, 28, 34, 42, 190, 108, 84, 86, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38303433569629797, "mean_inference_ms": 1.2344856207845574, "mean_action_processing_ms": 0.14410758791957107, "mean_env_wait_ms": 0.0845357387801275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033987998962402344, "StateBufferConnector_ms": 0.009004592895507812, "ViewRequirementAgentConnector_ms": 0.1309823989868164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4648.7615007591285, "num_env_steps_trained_throughput_per_sec": 4648.7615007591285, "timesteps_total": 1080000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 3802.605, "sample_time_ms": 3245.113, "load_time_ms": 19.899, "load_throughput": 904554.579, "learn_time_ms": 524.791, "learn_throughput": 34299.401, "synch_weights_time_ms": 10.401}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4062, "training_iteration": 60, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-00", "timestamp": 1698248400, "time_this_iter_s": 3.8779990673065186, "time_total_s": 206.8814251422882, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 206.8814251422882, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 72.03999999999999, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768065e-19, "cur_lr": 0.0003, "total_loss": 6.771132808261448, "policy_loss": -0.0001480895663715071, "vf_loss": 6.771329996320937, "vf_explained_var": -0.0031237893634372287, "kl": 0.0008885762657573398, "entropy": 0.49190221627553304, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2723.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.257999999999853, "episode_len_mean": 238.1, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 11.099999999999717, 46.5, 36.30000000000003, 30.099999999999987, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 47.3, 46.699999999999996, 45.9, 31.1, 39.300000000000026, 41.70000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 46.099999999999994, 42.10000000000001, -50.00000000000044, 33.70000000000004, 42.900000000000006, 44.10000000000001, 41.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, 21.299999999999862, 25.899999999999928, 45.3, -50.00000000000044, 45.3, 44.10000000000001, 41.100000000000016, 45.9, 42.70000000000001, 38.700000000000024, -50.00000000000044, 23.699999999999896, 40.500000000000014, -50.00000000000044, 41.70000000000002, 35.10000000000004, 37.10000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 41.90000000000001, 45.1, -50.00000000000044, 42.10000000000001, 46.099999999999994, 42.10000000000001, 32.50000000000002, 18.499999999999822, 41.30000000000001, -50.00000000000044, 41.500000000000014, 36.50000000000003, 28.699999999999967, 46.5, -50.00000000000044, 22.899999999999885, 36.50000000000003, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.50000000000003, 46.699999999999996, 44.300000000000004, -50.00000000000044, 30.9, 27.099999999999945, 45.9, 41.90000000000001, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.300000000000004, 44.10000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.5, -50.00000000000044, 37.70000000000003], "episode_lengths": [500, 500, 390, 36, 138, 200, 500, 284, 500, 500, 268, 500, 28, 34, 42, 190, 108, 84, 86, 500, 500, 64, 40, 80, 500, 164, 72, 60, 84, 500, 42, 500, 288, 242, 48, 500, 48, 60, 90, 42, 74, 114, 500, 264, 96, 500, 84, 150, 130, 90, 500, 500, 500, 90, 500, 82, 50, 500, 80, 40, 80, 176, 316, 88, 500, 86, 136, 214, 36, 500, 272, 136, 500, 500, 136, 64, 84, 500, 500, 500, 72, 126, 34, 58, 500, 192, 230, 42, 82, 500, 500, 112, 58, 60, 500, 94, 500, 46, 500, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38418696670902347, "mean_inference_ms": 1.2370623596355783, "mean_action_processing_ms": 0.14471223679803324, "mean_env_wait_ms": 0.08466108773629415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02999138832092285, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.14301848411560059}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.257999999999853, "episode_len_mean": 238.1, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 11.099999999999717, 46.5, 36.30000000000003, 30.099999999999987, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 47.3, 46.699999999999996, 45.9, 31.1, 39.300000000000026, 41.70000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 46.099999999999994, 42.10000000000001, -50.00000000000044, 33.70000000000004, 42.900000000000006, 44.10000000000001, 41.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, 21.299999999999862, 25.899999999999928, 45.3, -50.00000000000044, 45.3, 44.10000000000001, 41.100000000000016, 45.9, 42.70000000000001, 38.700000000000024, -50.00000000000044, 23.699999999999896, 40.500000000000014, -50.00000000000044, 41.70000000000002, 35.10000000000004, 37.10000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 41.90000000000001, 45.1, -50.00000000000044, 42.10000000000001, 46.099999999999994, 42.10000000000001, 32.50000000000002, 18.499999999999822, 41.30000000000001, -50.00000000000044, 41.500000000000014, 36.50000000000003, 28.699999999999967, 46.5, -50.00000000000044, 22.899999999999885, 36.50000000000003, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.50000000000003, 46.699999999999996, 44.300000000000004, -50.00000000000044, 30.9, 27.099999999999945, 45.9, 41.90000000000001, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.300000000000004, 44.10000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.5, -50.00000000000044, 37.70000000000003], "episode_lengths": [500, 500, 390, 36, 138, 200, 500, 284, 500, 500, 268, 500, 28, 34, 42, 190, 108, 84, 86, 500, 500, 64, 40, 80, 500, 164, 72, 60, 84, 500, 42, 500, 288, 242, 48, 500, 48, 60, 90, 42, 74, 114, 500, 264, 96, 500, 84, 150, 130, 90, 500, 500, 500, 90, 500, 82, 50, 500, 80, 40, 80, 176, 316, 88, 500, 86, 136, 214, 36, 500, 272, 136, 500, 500, 136, 64, 84, 500, 500, 500, 72, 126, 34, 58, 500, 192, 230, 42, 82, 500, 500, 112, 58, 60, 500, 94, 500, 46, 500, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38418696670902347, "mean_inference_ms": 1.2370623596355783, "mean_action_processing_ms": 0.14471223679803324, "mean_env_wait_ms": 0.08466108773629415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02999138832092285, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.14301848411560059}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4703.418185007891, "num_env_steps_trained_throughput_per_sec": 4703.418185007891, "timesteps_total": 1098000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1098000, "timers": {"training_iteration_time_ms": 3866.305, "sample_time_ms": 3300.813, "load_time_ms": 20.199, "load_throughput": 891114.781, "learn_time_ms": 532.49, "learn_throughput": 33803.424, "synch_weights_time_ms": 10.402}, "counters": {"num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "done": false, "episodes_total": 4141, "training_iteration": 61, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-04", "timestamp": 1698248404, "time_this_iter_s": 3.8330001831054688, "time_total_s": 210.71442532539368, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 210.71442532539368, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 62.13333333333333, "ram_util_percent": 27.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884032e-20, "cur_lr": 0.0003, "total_loss": 6.724664730495877, "policy_loss": 6.462633609771728e-06, "vf_loss": 6.724704731835259, "vf_explained_var": -0.0008063726954989964, "kl": 0.00030867225311794757, "entropy": 0.4641430596510569, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2768.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.752999999999833, "episode_len_mean": 248.12, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.899999999999885, 36.50000000000003, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.50000000000003, 46.699999999999996, 44.300000000000004, -50.00000000000044, 30.9, 27.099999999999945, 45.9, 41.90000000000001, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.300000000000004, 44.10000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.5, -50.00000000000044, 37.70000000000003, -50.00000000000044, 42.10000000000001, 45.7, 45.5, 37.50000000000003, 42.500000000000014, 46.099999999999994, 3.699999999999612, 45.7, 43.900000000000006, 46.099999999999994, 46.9, 40.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 10.699999999999712, 47.3, -50.00000000000044, 0.2999999999995637, 40.10000000000002, 40.90000000000002, -50.00000000000044, 18.699999999999825, 42.70000000000001, 28.499999999999964, 44.7, -50.00000000000044, 30.29999999999999, 42.70000000000001, 38.10000000000002, 40.90000000000002, 31.300000000000004, -50.00000000000044, 44.900000000000006, 44.7, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 44.7, 45.9, 44.10000000000001, 43.30000000000001, 44.10000000000001, 41.100000000000016, 45.9, -50.00000000000044, 46.099999999999994, 21.09999999999986, -50.00000000000044, -50.00000000000044, 29.49999999999998, 46.9, -50.00000000000044], "episode_lengths": [272, 136, 500, 500, 136, 64, 84, 500, 500, 500, 72, 126, 34, 58, 500, 192, 230, 42, 82, 500, 500, 112, 58, 60, 500, 94, 500, 46, 500, 124, 500, 80, 44, 46, 126, 76, 40, 464, 44, 62, 40, 32, 92, 110, 500, 500, 500, 500, 500, 500, 500, 62, 394, 28, 500, 498, 100, 92, 500, 314, 74, 216, 54, 500, 198, 74, 120, 92, 188, 500, 52, 54, 100, 500, 500, 500, 58, 46, 66, 500, 500, 500, 500, 500, 170, 54, 42, 60, 68, 60, 90, 42, 500, 40, 290, 500, 500, 206, 32, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3849070934568045, "mean_inference_ms": 1.2390861689429455, "mean_action_processing_ms": 0.14452323805267667, "mean_env_wait_ms": 0.0849468967441382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599048614501953, "StateBufferConnector_ms": 0.007004976272583008, "ViewRequirementAgentConnector_ms": 0.12901830673217773}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.752999999999833, "episode_len_mean": 248.12, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.899999999999885, 36.50000000000003, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.50000000000003, 46.699999999999996, 44.300000000000004, -50.00000000000044, 30.9, 27.099999999999945, 45.9, 41.90000000000001, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.300000000000004, 44.10000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.5, -50.00000000000044, 37.70000000000003, -50.00000000000044, 42.10000000000001, 45.7, 45.5, 37.50000000000003, 42.500000000000014, 46.099999999999994, 3.699999999999612, 45.7, 43.900000000000006, 46.099999999999994, 46.9, 40.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 10.699999999999712, 47.3, -50.00000000000044, 0.2999999999995637, 40.10000000000002, 40.90000000000002, -50.00000000000044, 18.699999999999825, 42.70000000000001, 28.499999999999964, 44.7, -50.00000000000044, 30.29999999999999, 42.70000000000001, 38.10000000000002, 40.90000000000002, 31.300000000000004, -50.00000000000044, 44.900000000000006, 44.7, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 44.7, 45.9, 44.10000000000001, 43.30000000000001, 44.10000000000001, 41.100000000000016, 45.9, -50.00000000000044, 46.099999999999994, 21.09999999999986, -50.00000000000044, -50.00000000000044, 29.49999999999998, 46.9, -50.00000000000044], "episode_lengths": [272, 136, 500, 500, 136, 64, 84, 500, 500, 500, 72, 126, 34, 58, 500, 192, 230, 42, 82, 500, 500, 112, 58, 60, 500, 94, 500, 46, 500, 124, 500, 80, 44, 46, 126, 76, 40, 464, 44, 62, 40, 32, 92, 110, 500, 500, 500, 500, 500, 500, 500, 62, 394, 28, 500, 498, 100, 92, 500, 314, 74, 216, 54, 500, 198, 74, 120, 92, 188, 500, 52, 54, 100, 500, 500, 500, 58, 46, 66, 500, 500, 500, 500, 500, 170, 54, 42, 60, 68, 60, 90, 42, 500, 40, 290, 500, 500, 206, 32, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3849070934568045, "mean_inference_ms": 1.2390861689429455, "mean_action_processing_ms": 0.14452323805267667, "mean_env_wait_ms": 0.0849468967441382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599048614501953, "StateBufferConnector_ms": 0.007004976272583008, "ViewRequirementAgentConnector_ms": 0.12901830673217773}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4713.2783678001015, "num_env_steps_trained_throughput_per_sec": 4713.2783678001015, "timesteps_total": 1116000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 3887.215, "sample_time_ms": 3319.113, "load_time_ms": 20.099, "load_throughput": 895551.18, "learn_time_ms": 535.201, "learn_throughput": 33632.25, "synch_weights_time_ms": 10.401}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4211, "training_iteration": 62, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-08", "timestamp": 1698248408, "time_this_iter_s": 3.82399845123291, "time_total_s": 214.5384237766266, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 214.5384237766266, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 68.64000000000001, "ram_util_percent": 27.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.336808689942016e-20, "cur_lr": 0.0003, "total_loss": 6.000992594824897, "policy_loss": -0.0005069286070971025, "vf_loss": 6.001543532477485, "vf_explained_var": 0.000648041566212972, "kl": 0.000843694052689159, "entropy": 0.44075335529115467, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2813.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.2290000000002093, "episode_len_mean": 277.82, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, 28.499999999999964, 44.7, -50.00000000000044, 30.29999999999999, 42.70000000000001, 38.10000000000002, 40.90000000000002, 31.300000000000004, -50.00000000000044, 44.900000000000006, 44.7, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 44.7, 45.9, 44.10000000000001, 43.30000000000001, 44.10000000000001, 41.100000000000016, 45.9, -50.00000000000044, 46.099999999999994, 21.09999999999986, -50.00000000000044, -50.00000000000044, 29.49999999999998, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 23.099999999999888, 46.699999999999996, 39.90000000000002, -50.00000000000044, 44.5, 44.5, 47.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 38.300000000000026, 44.5, 42.500000000000014, -50.00000000000044, 45.1, 46.699999999999996], "episode_lengths": [74, 216, 54, 500, 198, 74, 120, 92, 188, 500, 52, 54, 100, 500, 500, 500, 58, 46, 66, 500, 500, 500, 500, 500, 170, 54, 42, 60, 68, 60, 90, 42, 500, 40, 290, 500, 500, 206, 32, 500, 500, 500, 52, 500, 500, 60, 270, 34, 102, 500, 56, 56, 28, 500, 500, 40, 500, 50, 500, 500, 500, 140, 500, 56, 500, 500, 500, 28, 500, 26, 500, 500, 500, 500, 500, 60, 44, 70, 500, 500, 32, 38, 40, 500, 500, 24, 500, 500, 500, 500, 500, 96, 500, 500, 118, 56, 76, 500, 50, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3860035848070565, "mean_inference_ms": 1.2405858569856738, "mean_action_processing_ms": 0.14522658566205038, "mean_env_wait_ms": 0.0848047804422594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02798771858215332, "StateBufferConnector_ms": 0.007004737854003906, "ViewRequirementAgentConnector_ms": 0.12095117568969727}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.2290000000002093, "episode_len_mean": 277.82, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, 28.499999999999964, 44.7, -50.00000000000044, 30.29999999999999, 42.70000000000001, 38.10000000000002, 40.90000000000002, 31.300000000000004, -50.00000000000044, 44.900000000000006, 44.7, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 44.7, 45.9, 44.10000000000001, 43.30000000000001, 44.10000000000001, 41.100000000000016, 45.9, -50.00000000000044, 46.099999999999994, 21.09999999999986, -50.00000000000044, -50.00000000000044, 29.49999999999998, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 23.099999999999888, 46.699999999999996, 39.90000000000002, -50.00000000000044, 44.5, 44.5, 47.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 38.300000000000026, 44.5, 42.500000000000014, -50.00000000000044, 45.1, 46.699999999999996], "episode_lengths": [74, 216, 54, 500, 198, 74, 120, 92, 188, 500, 52, 54, 100, 500, 500, 500, 58, 46, 66, 500, 500, 500, 500, 500, 170, 54, 42, 60, 68, 60, 90, 42, 500, 40, 290, 500, 500, 206, 32, 500, 500, 500, 52, 500, 500, 60, 270, 34, 102, 500, 56, 56, 28, 500, 500, 40, 500, 50, 500, 500, 500, 140, 500, 56, 500, 500, 500, 28, 500, 26, 500, 500, 500, 500, 500, 60, 44, 70, 500, 500, 32, 38, 40, 500, 500, 24, 500, 500, 500, 500, 500, 96, 500, 500, 118, 56, 76, 500, 50, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3860035848070565, "mean_inference_ms": 1.2405858569856738, "mean_action_processing_ms": 0.14522658566205038, "mean_env_wait_ms": 0.0848047804422594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02798771858215332, "StateBufferConnector_ms": 0.007004737854003906, "ViewRequirementAgentConnector_ms": 0.12095117568969727}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4786.729903493758, "num_env_steps_trained_throughput_per_sec": 4786.729903493758, "timesteps_total": 1134000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1134000, "timers": {"training_iteration_time_ms": 3902.354, "sample_time_ms": 3334.809, "load_time_ms": 22.599, "load_throughput": 796480.934, "learn_time_ms": 532.044, "learn_throughput": 33831.777, "synch_weights_time_ms": 10.501}, "counters": {"num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "done": false, "episodes_total": 4271, "training_iteration": 63, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-12", "timestamp": 1698248412, "time_this_iter_s": 3.7673940658569336, "time_total_s": 218.30581784248352, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 218.30581784248352, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 60.666666666666664, "ram_util_percent": 28.01666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.168404344971008e-20, "cur_lr": 0.0003, "total_loss": 6.661294460296631, "policy_loss": -0.00041332609123653834, "vf_loss": 6.6617549472384985, "vf_explained_var": -0.003215679857465956, "kl": 0.0007833786154593427, "entropy": 0.4724624428484175, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2858.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7619999999998001, "episode_len_mean": 272.94, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 38.300000000000026, 44.5, 42.500000000000014, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 34.900000000000034, 45.1, -50.00000000000044, 46.699999999999996, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.09999999999983, 47.3, 44.5, 27.099999999999945, 45.1, 32.700000000000024, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.3, 45.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 39.50000000000002, 43.30000000000001, -50.00000000000044, 45.1, 41.70000000000002, 22.899999999999885, 46.9, 46.5, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 47.3, 40.10000000000002, 46.099999999999994, 47.1, -50.00000000000044, 3.0999999999996035, 44.900000000000006, 44.900000000000006, 42.900000000000006, 30.9, 39.10000000000002, 33.90000000000004, 47.3, 40.500000000000014, 44.7, 43.10000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 60, 44, 70, 500, 500, 32, 38, 40, 500, 500, 24, 500, 500, 500, 500, 500, 96, 500, 500, 118, 56, 76, 500, 50, 34, 500, 500, 500, 54, 500, 152, 50, 500, 34, 168, 500, 500, 500, 310, 28, 56, 230, 50, 174, 34, 500, 500, 500, 88, 48, 46, 500, 500, 38, 500, 106, 68, 500, 50, 84, 272, 32, 36, 500, 136, 500, 42, 500, 500, 292, 500, 500, 58, 500, 500, 500, 500, 264, 28, 100, 40, 30, 500, 470, 52, 52, 72, 192, 110, 162, 28, 96, 54, 70, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38675574980688104, "mean_inference_ms": 1.2443748856618486, "mean_action_processing_ms": 0.14552761381085275, "mean_env_wait_ms": 0.08531905142097095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0339665412902832, "StateBufferConnector_ms": 0.009998559951782227, "ViewRequirementAgentConnector_ms": 0.13197636604309082}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7619999999998001, "episode_len_mean": 272.94, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 38.300000000000026, 44.5, 42.500000000000014, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 34.900000000000034, 45.1, -50.00000000000044, 46.699999999999996, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.09999999999983, 47.3, 44.5, 27.099999999999945, 45.1, 32.700000000000024, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.3, 45.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 39.50000000000002, 43.30000000000001, -50.00000000000044, 45.1, 41.70000000000002, 22.899999999999885, 46.9, 46.5, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 47.3, 40.10000000000002, 46.099999999999994, 47.1, -50.00000000000044, 3.0999999999996035, 44.900000000000006, 44.900000000000006, 42.900000000000006, 30.9, 39.10000000000002, 33.90000000000004, 47.3, 40.500000000000014, 44.7, 43.10000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 60, 44, 70, 500, 500, 32, 38, 40, 500, 500, 24, 500, 500, 500, 500, 500, 96, 500, 500, 118, 56, 76, 500, 50, 34, 500, 500, 500, 54, 500, 152, 50, 500, 34, 168, 500, 500, 500, 310, 28, 56, 230, 50, 174, 34, 500, 500, 500, 88, 48, 46, 500, 500, 38, 500, 106, 68, 500, 50, 84, 272, 32, 36, 500, 136, 500, 42, 500, 500, 292, 500, 500, 58, 500, 500, 500, 500, 264, 28, 100, 40, 30, 500, 470, 52, 52, 72, 192, 110, 162, 28, 96, 54, 70, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38675574980688104, "mean_inference_ms": 1.2443748856618486, "mean_action_processing_ms": 0.14552761381085275, "mean_env_wait_ms": 0.08531905142097095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0339665412902832, "StateBufferConnector_ms": 0.009998559951782227, "ViewRequirementAgentConnector_ms": 0.13197636604309082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4626.062367903881, "num_env_steps_trained_throughput_per_sec": 4626.062367903881, "timesteps_total": 1152000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 3923.44, "sample_time_ms": 3358.695, "load_time_ms": 22.599, "load_throughput": 796480.094, "learn_time_ms": 529.044, "learn_throughput": 34023.619, "synch_weights_time_ms": 10.801}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4342, "training_iteration": 64, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-15", "timestamp": 1698248415, "time_this_iter_s": 3.8969995975494385, "time_total_s": 222.20281744003296, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 222.20281744003296, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 73.74000000000001, "ram_util_percent": 27.860000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.084202172485504e-20, "cur_lr": 0.0003, "total_loss": 6.111963431040446, "policy_loss": -0.0003467447227901883, "vf_loss": 6.112357012430826, "vf_explained_var": 0.004743063449859619, "kl": 0.0011022986500595128, "entropy": 0.4684428526295556, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2903.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.642999999999837, "episode_len_mean": 239.22, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 47.3, 40.10000000000002, 46.099999999999994, 47.1, -50.00000000000044, 3.0999999999996035, 44.900000000000006, 44.900000000000006, 42.900000000000006, 30.9, 39.10000000000002, 33.90000000000004, 47.3, 40.500000000000014, 44.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 27.099999999999945, -50.00000000000044, 44.300000000000004, -50.00000000000044, 38.50000000000003, 7.899999999999672, 43.900000000000006, 44.7, 47.1, 45.7, -50.00000000000044, -50.00000000000044, 45.9, 44.300000000000004, -50.00000000000044, 45.3, 43.900000000000006, 43.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.90000000000002, 11.899999999999729, 44.900000000000006, -50.00000000000044, 30.099999999999987, 44.5, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 26.499999999999936, 44.7, 45.3, -50.00000000000044, 42.30000000000001, 46.3, 41.100000000000016, 44.5, 42.900000000000006, 44.10000000000001, 39.70000000000002, 41.500000000000014, 46.099999999999994, -50.00000000000044, 46.9, 46.5, -50.00000000000044, 45.9, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.90000000000004, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 292, 500, 500, 58, 500, 500, 500, 500, 264, 28, 100, 40, 30, 500, 470, 52, 52, 72, 192, 110, 162, 28, 96, 54, 70, 500, 500, 500, 34, 500, 230, 500, 58, 500, 116, 422, 62, 54, 30, 44, 500, 500, 42, 58, 500, 48, 62, 62, 46, 500, 500, 154, 500, 32, 500, 34, 500, 112, 382, 52, 500, 200, 56, 500, 48, 56, 500, 206, 500, 500, 34, 34, 236, 54, 48, 500, 78, 38, 90, 56, 72, 60, 104, 86, 40, 500, 32, 36, 500, 42, 112, 500, 500, 500, 500, 98, 162, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3878859279180313, "mean_inference_ms": 1.246887838963922, "mean_action_processing_ms": 0.14568129347176886, "mean_env_wait_ms": 0.0857039792949885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03240251541137695, "StateBufferConnector_ms": 0.006995439529418945, "ViewRequirementAgentConnector_ms": 0.15156030654907227}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.642999999999837, "episode_len_mean": 239.22, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 47.3, 40.10000000000002, 46.099999999999994, 47.1, -50.00000000000044, 3.0999999999996035, 44.900000000000006, 44.900000000000006, 42.900000000000006, 30.9, 39.10000000000002, 33.90000000000004, 47.3, 40.500000000000014, 44.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 27.099999999999945, -50.00000000000044, 44.300000000000004, -50.00000000000044, 38.50000000000003, 7.899999999999672, 43.900000000000006, 44.7, 47.1, 45.7, -50.00000000000044, -50.00000000000044, 45.9, 44.300000000000004, -50.00000000000044, 45.3, 43.900000000000006, 43.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.90000000000002, 11.899999999999729, 44.900000000000006, -50.00000000000044, 30.099999999999987, 44.5, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 26.499999999999936, 44.7, 45.3, -50.00000000000044, 42.30000000000001, 46.3, 41.100000000000016, 44.5, 42.900000000000006, 44.10000000000001, 39.70000000000002, 41.500000000000014, 46.099999999999994, -50.00000000000044, 46.9, 46.5, -50.00000000000044, 45.9, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.90000000000004, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 292, 500, 500, 58, 500, 500, 500, 500, 264, 28, 100, 40, 30, 500, 470, 52, 52, 72, 192, 110, 162, 28, 96, 54, 70, 500, 500, 500, 34, 500, 230, 500, 58, 500, 116, 422, 62, 54, 30, 44, 500, 500, 42, 58, 500, 48, 62, 62, 46, 500, 500, 154, 500, 32, 500, 34, 500, 112, 382, 52, 500, 200, 56, 500, 48, 56, 500, 206, 500, 500, 34, 34, 236, 54, 48, 500, 78, 38, 90, 56, 72, 60, 104, 86, 40, 500, 32, 36, 500, 42, 112, 500, 500, 500, 500, 98, 162, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3878859279180313, "mean_inference_ms": 1.246887838963922, "mean_action_processing_ms": 0.14568129347176886, "mean_env_wait_ms": 0.0857039792949885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03240251541137695, "StateBufferConnector_ms": 0.006995439529418945, "ViewRequirementAgentConnector_ms": 0.15156030654907227}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4758.122181702952, "num_env_steps_trained_throughput_per_sec": 4758.122181702952, "timesteps_total": 1170000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1170000, "timers": {"training_iteration_time_ms": 3908.141, "sample_time_ms": 3353.495, "load_time_ms": 23.2, "load_throughput": 775878.437, "learn_time_ms": 517.844, "learn_throughput": 34759.488, "synch_weights_time_ms": 11.001}, "counters": {"num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "done": false, "episodes_total": 4414, "training_iteration": 65, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-19", "timestamp": 1698248419, "time_this_iter_s": 3.7900002002716064, "time_total_s": 225.99281764030457, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 225.99281764030457, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 71.28, "ram_util_percent": 27.779999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.42101086242752e-21, "cur_lr": 0.0003, "total_loss": 6.919812615712484, "policy_loss": -0.00020669119225607977, "vf_loss": 6.920070425669352, "vf_explained_var": 0.0005630797810024685, "kl": 0.000953938813423368, "entropy": 0.5110377960734898, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2948.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.337999999999838, "episode_len_mean": 247.28, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, 46.699999999999996, 26.499999999999936, 44.7, 45.3, -50.00000000000044, 42.30000000000001, 46.3, 41.100000000000016, 44.5, 42.900000000000006, 44.10000000000001, 39.70000000000002, 41.500000000000014, 46.099999999999994, -50.00000000000044, 46.9, 46.5, -50.00000000000044, 45.9, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.90000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, 41.100000000000016, 16.09999999999979, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.50000000000001, 20.49999999999985, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.1, 43.30000000000001, 39.90000000000002, 26.499999999999936, 33.70000000000004, 35.30000000000004, 31.900000000000013, 37.10000000000003, 45.9, -50.00000000000044, 46.699999999999996, 46.9, 35.70000000000003, 44.7, -50.00000000000044, 32.100000000000016, 41.500000000000014, 40.70000000000002, 44.300000000000004, 42.10000000000001, 34.900000000000034, 24.099999999999902, 7.09999999999966, 37.10000000000003, 19.899999999999842, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 30.099999999999987, -50.00000000000044, 41.500000000000014, 43.900000000000006, 46.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, 43.50000000000001, 2.699999999999598], "episode_lengths": [500, 34, 34, 236, 54, 48, 500, 78, 38, 90, 56, 72, 60, 104, 86, 40, 500, 32, 36, 500, 42, 112, 500, 500, 500, 500, 98, 162, 40, 500, 500, 390, 500, 90, 340, 500, 500, 34, 500, 246, 500, 500, 500, 98, 500, 66, 296, 500, 500, 86, 54, 500, 500, 500, 500, 26, 500, 500, 76, 50, 68, 102, 236, 164, 148, 182, 130, 42, 500, 34, 32, 144, 54, 500, 180, 86, 94, 58, 80, 152, 260, 430, 130, 302, 500, 500, 28, 500, 200, 500, 86, 62, 36, 140, 500, 500, 60, 64, 66, 474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38820849477749164, "mean_inference_ms": 1.2491387917082062, "mean_action_processing_ms": 0.1462876700910546, "mean_env_wait_ms": 0.08558683972331234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03599667549133301, "StateBufferConnector_ms": 0.006994009017944336, "ViewRequirementAgentConnector_ms": 0.12298822402954102}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.337999999999838, "episode_len_mean": 247.28, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, 46.699999999999996, 26.499999999999936, 44.7, 45.3, -50.00000000000044, 42.30000000000001, 46.3, 41.100000000000016, 44.5, 42.900000000000006, 44.10000000000001, 39.70000000000002, 41.500000000000014, 46.099999999999994, -50.00000000000044, 46.9, 46.5, -50.00000000000044, 45.9, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.90000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, 41.100000000000016, 16.09999999999979, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.50000000000001, 20.49999999999985, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.1, 43.30000000000001, 39.90000000000002, 26.499999999999936, 33.70000000000004, 35.30000000000004, 31.900000000000013, 37.10000000000003, 45.9, -50.00000000000044, 46.699999999999996, 46.9, 35.70000000000003, 44.7, -50.00000000000044, 32.100000000000016, 41.500000000000014, 40.70000000000002, 44.300000000000004, 42.10000000000001, 34.900000000000034, 24.099999999999902, 7.09999999999966, 37.10000000000003, 19.899999999999842, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 30.099999999999987, -50.00000000000044, 41.500000000000014, 43.900000000000006, 46.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, 43.50000000000001, 2.699999999999598], "episode_lengths": [500, 34, 34, 236, 54, 48, 500, 78, 38, 90, 56, 72, 60, 104, 86, 40, 500, 32, 36, 500, 42, 112, 500, 500, 500, 500, 98, 162, 40, 500, 500, 390, 500, 90, 340, 500, 500, 34, 500, 246, 500, 500, 500, 98, 500, 66, 296, 500, 500, 86, 54, 500, 500, 500, 500, 26, 500, 500, 76, 50, 68, 102, 236, 164, 148, 182, 130, 42, 500, 34, 32, 144, 54, 500, 180, 86, 94, 58, 80, 152, 260, 430, 130, 302, 500, 500, 28, 500, 200, 500, 86, 62, 36, 140, 500, 500, 60, 64, 66, 474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38820849477749164, "mean_inference_ms": 1.2491387917082062, "mean_action_processing_ms": 0.1462876700910546, "mean_env_wait_ms": 0.08558683972331234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03599667549133301, "StateBufferConnector_ms": 0.006994009017944336, "ViewRequirementAgentConnector_ms": 0.12298822402954102}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4734.352660005157, "num_env_steps_trained_throughput_per_sec": 4734.352660005157, "timesteps_total": 1188000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 3877.941, "sample_time_ms": 3327.595, "load_time_ms": 24.1, "load_throughput": 746900.723, "learn_time_ms": 512.744, "learn_throughput": 35105.239, "synch_weights_time_ms": 10.902}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4484, "training_iteration": 66, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-23", "timestamp": 1698248423, "time_this_iter_s": 3.8100273609161377, "time_total_s": 229.8028450012207, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 229.8028450012207, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 62.98333333333333, "ram_util_percent": 27.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.71050543121376e-21, "cur_lr": 0.0003, "total_loss": 6.606708908081055, "policy_loss": 0.00010445217291514079, "vf_loss": 6.606655438741048, "vf_explained_var": -0.0038470784823099774, "kl": 0.00017762763426516258, "entropy": 0.5093711283471849, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2993.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.434999999999846, "episode_len_mean": 241.34, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.100000000000016, 41.500000000000014, 40.70000000000002, 44.300000000000004, 42.10000000000001, 34.900000000000034, 24.099999999999902, 7.09999999999966, 37.10000000000003, 19.899999999999842, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 30.099999999999987, -50.00000000000044, 41.500000000000014, 43.900000000000006, 46.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, 43.50000000000001, 2.699999999999598, 26.499999999999936, 36.30000000000003, 22.899999999999885, 44.300000000000004, 45.3, -50.00000000000044, 33.70000000000004, 38.50000000000003, 26.09999999999993, -50.00000000000044, -50.00000000000044, 12.69999999999974, 43.900000000000006, -50.00000000000044, 44.300000000000004, 40.70000000000002, 43.7, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.10000000000001, 46.099999999999994, 42.900000000000006, -50.00000000000044, 20.099999999999845, 47.7, 47.3, 38.10000000000002, 47.5, -50.00000000000044, 45.1, 42.900000000000006, 44.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, 35.70000000000003, 44.7, 46.099999999999994, 21.09999999999986, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 43.10000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 44.7, 15.699999999999783, 33.500000000000036, 36.70000000000003, 39.70000000000002, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 39.10000000000002, 21.499999999999865, -50.00000000000044, 29.69999999999998, 45.1, 44.300000000000004, -50.00000000000044, 46.099999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [180, 86, 94, 58, 80, 152, 260, 430, 130, 302, 500, 500, 28, 500, 200, 500, 86, 62, 36, 140, 500, 500, 60, 64, 66, 474, 236, 138, 272, 58, 48, 500, 164, 116, 240, 500, 500, 374, 62, 500, 58, 94, 64, 500, 154, 500, 60, 40, 72, 500, 300, 24, 28, 120, 26, 500, 50, 72, 54, 42, 500, 500, 500, 500, 500, 500, 40, 68, 144, 54, 40, 290, 500, 500, 500, 142, 70, 500, 104, 500, 54, 344, 166, 134, 104, 84, 500, 34, 500, 110, 286, 500, 204, 50, 58, 500, 40, 60, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3882952939635706, "mean_inference_ms": 1.2514636115010263, "mean_action_processing_ms": 0.1465070333983943, "mean_env_wait_ms": 0.08605319774545542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027008533477783203, "StateBufferConnector_ms": 0.004996538162231445, "ViewRequirementAgentConnector_ms": 0.12895464897155762}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.434999999999846, "episode_len_mean": 241.34, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.100000000000016, 41.500000000000014, 40.70000000000002, 44.300000000000004, 42.10000000000001, 34.900000000000034, 24.099999999999902, 7.09999999999966, 37.10000000000003, 19.899999999999842, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 30.099999999999987, -50.00000000000044, 41.500000000000014, 43.900000000000006, 46.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, 43.50000000000001, 2.699999999999598, 26.499999999999936, 36.30000000000003, 22.899999999999885, 44.300000000000004, 45.3, -50.00000000000044, 33.70000000000004, 38.50000000000003, 26.09999999999993, -50.00000000000044, -50.00000000000044, 12.69999999999974, 43.900000000000006, -50.00000000000044, 44.300000000000004, 40.70000000000002, 43.7, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.10000000000001, 46.099999999999994, 42.900000000000006, -50.00000000000044, 20.099999999999845, 47.7, 47.3, 38.10000000000002, 47.5, -50.00000000000044, 45.1, 42.900000000000006, 44.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, 35.70000000000003, 44.7, 46.099999999999994, 21.09999999999986, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 43.10000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 44.7, 15.699999999999783, 33.500000000000036, 36.70000000000003, 39.70000000000002, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 39.10000000000002, 21.499999999999865, -50.00000000000044, 29.69999999999998, 45.1, 44.300000000000004, -50.00000000000044, 46.099999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [180, 86, 94, 58, 80, 152, 260, 430, 130, 302, 500, 500, 28, 500, 200, 500, 86, 62, 36, 140, 500, 500, 60, 64, 66, 474, 236, 138, 272, 58, 48, 500, 164, 116, 240, 500, 500, 374, 62, 500, 58, 94, 64, 500, 154, 500, 60, 40, 72, 500, 300, 24, 28, 120, 26, 500, 50, 72, 54, 42, 500, 500, 500, 500, 500, 500, 40, 68, 144, 54, 40, 290, 500, 500, 500, 142, 70, 500, 104, 500, 54, 344, 166, 134, 104, 84, 500, 34, 500, 110, 286, 500, 204, 50, 58, 500, 40, 60, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3882952939635706, "mean_inference_ms": 1.2514636115010263, "mean_action_processing_ms": 0.1465070333983943, "mean_env_wait_ms": 0.08605319774545542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027008533477783203, "StateBufferConnector_ms": 0.004996538162231445, "ViewRequirementAgentConnector_ms": 0.12895464897155762}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4754.3497617046405, "num_env_steps_trained_throughput_per_sec": 4754.3497617046405, "timesteps_total": 1206000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1206000, "timers": {"training_iteration_time_ms": 3852.242, "sample_time_ms": 3299.595, "load_time_ms": 23.6, "load_throughput": 762720.143, "learn_time_ms": 515.744, "learn_throughput": 34901.032, "synch_weights_time_ms": 10.801}, "counters": {"num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "done": false, "episodes_total": 4558, "training_iteration": 67, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-27", "timestamp": 1698248427, "time_this_iter_s": 3.7920331954956055, "time_total_s": 233.5948781967163, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 233.5948781967163, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 69.3, "ram_util_percent": 27.619999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.35525271560688e-21, "cur_lr": 0.0003, "total_loss": 6.3549549102783205, "policy_loss": -0.0002473317707578341, "vf_loss": 6.355250665876601, "vf_explained_var": -0.012530618243747287, "kl": 0.0007342291693175993, "entropy": 0.4838681015703413, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3038.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.862999999999811, "episode_len_mean": 266.96, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 46.099999999999994, 21.09999999999986, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 43.10000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 44.7, 15.699999999999783, 33.500000000000036, 36.70000000000003, 39.70000000000002, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 39.10000000000002, 21.499999999999865, -50.00000000000044, 29.69999999999998, 45.1, 44.300000000000004, -50.00000000000044, 46.099999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, 23.099999999999888, 36.30000000000003, 31.300000000000004, 46.9, 41.90000000000001, -50.00000000000044, -50.00000000000044, 25.899999999999928, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, 47.7, 43.7, 46.5, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 44.7, 42.10000000000001, 47.3, 44.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 2.499999999999595, 11.29999999999972, 45.3, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.70000000000001, 36.900000000000034, -50.00000000000044, 45.1, -50.00000000000044, 45.9, 46.099999999999994, 45.3, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 47.3, 43.900000000000006, 41.30000000000001], "episode_lengths": [54, 40, 290, 500, 500, 500, 142, 70, 500, 104, 500, 54, 344, 166, 134, 104, 84, 500, 34, 500, 110, 286, 500, 204, 50, 58, 500, 40, 60, 500, 500, 270, 138, 188, 32, 82, 500, 500, 242, 150, 500, 500, 500, 70, 500, 58, 500, 500, 42, 24, 64, 36, 500, 64, 500, 500, 54, 80, 28, 52, 30, 500, 500, 80, 500, 52, 500, 500, 500, 500, 50, 82, 500, 500, 500, 44, 476, 388, 48, 126, 500, 500, 500, 100, 500, 74, 132, 500, 50, 500, 42, 40, 48, 500, 500, 54, 500, 28, 62, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3893176513548186, "mean_inference_ms": 1.2538049649600875, "mean_action_processing_ms": 0.14649511733553555, "mean_env_wait_ms": 0.08625692391812277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03498721122741699, "StateBufferConnector_ms": 0.00699925422668457, "ViewRequirementAgentConnector_ms": 0.14400148391723633}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.862999999999811, "episode_len_mean": 266.96, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 46.099999999999994, 21.09999999999986, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 43.10000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 44.7, 15.699999999999783, 33.500000000000036, 36.70000000000003, 39.70000000000002, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 39.10000000000002, 21.499999999999865, -50.00000000000044, 29.69999999999998, 45.1, 44.300000000000004, -50.00000000000044, 46.099999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, 23.099999999999888, 36.30000000000003, 31.300000000000004, 46.9, 41.90000000000001, -50.00000000000044, -50.00000000000044, 25.899999999999928, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, 47.7, 43.7, 46.5, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 44.7, 42.10000000000001, 47.3, 44.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 2.499999999999595, 11.29999999999972, 45.3, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.70000000000001, 36.900000000000034, -50.00000000000044, 45.1, -50.00000000000044, 45.9, 46.099999999999994, 45.3, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 47.3, 43.900000000000006, 41.30000000000001], "episode_lengths": [54, 40, 290, 500, 500, 500, 142, 70, 500, 104, 500, 54, 344, 166, 134, 104, 84, 500, 34, 500, 110, 286, 500, 204, 50, 58, 500, 40, 60, 500, 500, 270, 138, 188, 32, 82, 500, 500, 242, 150, 500, 500, 500, 70, 500, 58, 500, 500, 42, 24, 64, 36, 500, 64, 500, 500, 54, 80, 28, 52, 30, 500, 500, 80, 500, 52, 500, 500, 500, 500, 50, 82, 500, 500, 500, 44, 476, 388, 48, 126, 500, 500, 500, 100, 500, 74, 132, 500, 50, 500, 42, 40, 48, 500, 500, 54, 500, 28, 62, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3893176513548186, "mean_inference_ms": 1.2538049649600875, "mean_action_processing_ms": 0.14649511733553555, "mean_env_wait_ms": 0.08625692391812277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03498721122741699, "StateBufferConnector_ms": 0.00699925422668457, "ViewRequirementAgentConnector_ms": 0.14400148391723633}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4783.416259217888, "num_env_steps_trained_throughput_per_sec": 4783.416259217888, "timesteps_total": 1224000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 3812.941, "sample_time_ms": 3267.295, "load_time_ms": 23.8, "load_throughput": 756314.152, "learn_time_ms": 508.644, "learn_throughput": 35388.198, "synch_weights_time_ms": 10.601}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4627, "training_iteration": 68, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-31", "timestamp": 1698248431, "time_this_iter_s": 3.7689993381500244, "time_total_s": 237.36387753486633, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 237.36387753486633, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 68.76, "ram_util_percent": 27.660000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.7762635780344e-22, "cur_lr": 0.0003, "total_loss": 7.196542485555013, "policy_loss": -0.0001494924227396647, "vf_loss": 7.19674219555325, "vf_explained_var": -0.00715530448489719, "kl": 0.0007204496735703792, "entropy": 0.5025326675838895, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3083.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 18.485999999999887, "episode_len_mean": 195.9, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 47.3, 43.900000000000006, 41.30000000000001, 45.1, 47.1, 45.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 23.8999999999999, 36.900000000000034, 7.899999999999672, 42.30000000000001, 45.3, 45.5, -50.00000000000044, 45.3, 47.3, 34.50000000000004, 45.7, 5.099999999999632, 47.3, 43.7, 44.300000000000004, -50.00000000000044, 32.50000000000002, 44.7, 43.900000000000006, 42.70000000000001, 39.50000000000002, 36.10000000000004, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 24.299999999999905, 43.900000000000006, 34.900000000000034, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 36.900000000000034, 42.70000000000001, 40.500000000000014, 45.3, 47.1, 45.5, 46.9, 43.50000000000001, 46.099999999999994, 43.30000000000001, 34.900000000000034, 44.10000000000001, 45.3, 47.5, 18.499999999999822, 21.499999999999865, 45.9, 36.900000000000034, -50.00000000000044, 44.5, -50.00000000000044, 44.5, 45.5, -50.00000000000044, 43.7, 26.499999999999936, -50.00000000000044, 44.7, 33.70000000000004, 40.70000000000002, 44.900000000000006, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 35.30000000000004, 21.89999999999987, 37.300000000000026, 42.500000000000014, 46.099999999999994, 40.30000000000002, 43.7, 32.700000000000024, 47.1, 42.70000000000001], "episode_lengths": [48, 500, 500, 54, 500, 28, 62, 88, 50, 30, 48, 74, 500, 500, 52, 500, 262, 132, 422, 78, 48, 46, 500, 48, 28, 156, 44, 450, 28, 64, 58, 500, 176, 54, 62, 74, 106, 140, 74, 104, 500, 500, 500, 48, 500, 500, 258, 62, 152, 500, 36, 500, 500, 68, 500, 132, 74, 96, 48, 30, 46, 32, 66, 40, 68, 152, 60, 48, 26, 316, 286, 42, 132, 500, 56, 500, 56, 46, 500, 64, 236, 500, 54, 164, 94, 52, 500, 148, 500, 500, 148, 282, 128, 76, 40, 98, 64, 174, 30, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39040850682194406, "mean_inference_ms": 1.256825088563483, "mean_action_processing_ms": 0.14682354158675978, "mean_env_wait_ms": 0.08639220724501502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02999138832092285, "StateBufferConnector_ms": 0.009003400802612305, "ViewRequirementAgentConnector_ms": 0.15300869941711426}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 18.485999999999887, "episode_len_mean": 195.9, "episodes_this_iter": 92, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 47.3, 43.900000000000006, 41.30000000000001, 45.1, 47.1, 45.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 23.8999999999999, 36.900000000000034, 7.899999999999672, 42.30000000000001, 45.3, 45.5, -50.00000000000044, 45.3, 47.3, 34.50000000000004, 45.7, 5.099999999999632, 47.3, 43.7, 44.300000000000004, -50.00000000000044, 32.50000000000002, 44.7, 43.900000000000006, 42.70000000000001, 39.50000000000002, 36.10000000000004, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 24.299999999999905, 43.900000000000006, 34.900000000000034, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 36.900000000000034, 42.70000000000001, 40.500000000000014, 45.3, 47.1, 45.5, 46.9, 43.50000000000001, 46.099999999999994, 43.30000000000001, 34.900000000000034, 44.10000000000001, 45.3, 47.5, 18.499999999999822, 21.499999999999865, 45.9, 36.900000000000034, -50.00000000000044, 44.5, -50.00000000000044, 44.5, 45.5, -50.00000000000044, 43.7, 26.499999999999936, -50.00000000000044, 44.7, 33.70000000000004, 40.70000000000002, 44.900000000000006, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 35.30000000000004, 21.89999999999987, 37.300000000000026, 42.500000000000014, 46.099999999999994, 40.30000000000002, 43.7, 32.700000000000024, 47.1, 42.70000000000001], "episode_lengths": [48, 500, 500, 54, 500, 28, 62, 88, 50, 30, 48, 74, 500, 500, 52, 500, 262, 132, 422, 78, 48, 46, 500, 48, 28, 156, 44, 450, 28, 64, 58, 500, 176, 54, 62, 74, 106, 140, 74, 104, 500, 500, 500, 48, 500, 500, 258, 62, 152, 500, 36, 500, 500, 68, 500, 132, 74, 96, 48, 30, 46, 32, 66, 40, 68, 152, 60, 48, 26, 316, 286, 42, 132, 500, 56, 500, 56, 46, 500, 64, 236, 500, 54, 164, 94, 52, 500, 148, 500, 500, 148, 282, 128, 76, 40, 98, 64, 174, 30, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39040850682194406, "mean_inference_ms": 1.256825088563483, "mean_action_processing_ms": 0.14682354158675978, "mean_env_wait_ms": 0.08639220724501502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02999138832092285, "StateBufferConnector_ms": 0.009003400802612305, "ViewRequirementAgentConnector_ms": 0.15300869941711426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4833.514238729308, "num_env_steps_trained_throughput_per_sec": 4833.514238729308, "timesteps_total": 1242000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1242000, "timers": {"training_iteration_time_ms": 3802.74, "sample_time_ms": 3263.295, "load_time_ms": 23.399, "load_throughput": 769252.038, "learn_time_ms": 503.344, "learn_throughput": 35760.826, "synch_weights_time_ms": 10.302}, "counters": {"num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "done": false, "episodes_total": 4719, "training_iteration": 69, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-34", "timestamp": 1698248434, "time_this_iter_s": 3.729997396469116, "time_total_s": 241.09387493133545, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 241.09387493133545, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 63.04999999999999, "ram_util_percent": 27.733333333333338}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3881317890172e-22, "cur_lr": 0.0003, "total_loss": 6.221961095598009, "policy_loss": -0.00031038232975535925, "vf_loss": 6.22232084274292, "vf_explained_var": -0.0011215077506171332, "kl": 0.0011004012032979442, "entropy": 0.4941751499970754, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3128.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.422999999999838, "episode_len_mean": 241.42, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.900000000000034, 44.10000000000001, 45.3, 47.5, 18.499999999999822, 21.499999999999865, 45.9, 36.900000000000034, -50.00000000000044, 44.5, -50.00000000000044, 44.5, 45.5, -50.00000000000044, 43.7, 26.499999999999936, -50.00000000000044, 44.7, 33.70000000000004, 40.70000000000002, 44.900000000000006, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 35.30000000000004, 21.89999999999987, 37.300000000000026, 42.500000000000014, 46.099999999999994, 40.30000000000002, 43.7, 32.700000000000024, 47.1, 42.70000000000001, -50.00000000000044, 41.30000000000001, 42.500000000000014, 34.50000000000004, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 45.7, 43.10000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.30000000000001, -50.00000000000044, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, -50.00000000000044, 46.099999999999994, 41.100000000000016, 45.5, -50.00000000000044, 46.3, -50.00000000000044, 19.69999999999984, 14.699999999999768, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.900000000000006, 44.5, 45.1, -50.00000000000044, 44.300000000000004, 45.3, 44.5, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 28.09999999999996, 42.70000000000001], "episode_lengths": [152, 60, 48, 26, 316, 286, 42, 132, 500, 56, 500, 56, 46, 500, 64, 236, 500, 54, 164, 94, 52, 500, 148, 500, 500, 148, 282, 128, 76, 40, 98, 64, 174, 30, 74, 500, 88, 76, 156, 38, 34, 500, 500, 500, 500, 500, 306, 500, 500, 44, 70, 98, 500, 500, 500, 52, 88, 500, 48, 76, 500, 500, 52, 82, 500, 40, 90, 46, 500, 38, 500, 304, 354, 500, 500, 68, 500, 500, 96, 52, 30, 500, 500, 52, 62, 56, 50, 500, 58, 48, 56, 74, 46, 500, 500, 500, 274, 500, 220, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39065572683163935, "mean_inference_ms": 1.257017602017485, "mean_action_processing_ms": 0.14702953988801792, "mean_env_wait_ms": 0.08639138319862888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800130844116211, "StateBufferConnector_ms": 0.009002923965454102, "ViewRequirementAgentConnector_ms": 0.1370086669921875}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.422999999999838, "episode_len_mean": 241.42, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.900000000000034, 44.10000000000001, 45.3, 47.5, 18.499999999999822, 21.499999999999865, 45.9, 36.900000000000034, -50.00000000000044, 44.5, -50.00000000000044, 44.5, 45.5, -50.00000000000044, 43.7, 26.499999999999936, -50.00000000000044, 44.7, 33.70000000000004, 40.70000000000002, 44.900000000000006, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 35.30000000000004, 21.89999999999987, 37.300000000000026, 42.500000000000014, 46.099999999999994, 40.30000000000002, 43.7, 32.700000000000024, 47.1, 42.70000000000001, -50.00000000000044, 41.30000000000001, 42.500000000000014, 34.50000000000004, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 45.7, 43.10000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.30000000000001, -50.00000000000044, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, -50.00000000000044, 46.099999999999994, 41.100000000000016, 45.5, -50.00000000000044, 46.3, -50.00000000000044, 19.69999999999984, 14.699999999999768, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.900000000000006, 44.5, 45.1, -50.00000000000044, 44.300000000000004, 45.3, 44.5, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 28.09999999999996, 42.70000000000001], "episode_lengths": [152, 60, 48, 26, 316, 286, 42, 132, 500, 56, 500, 56, 46, 500, 64, 236, 500, 54, 164, 94, 52, 500, 148, 500, 500, 148, 282, 128, 76, 40, 98, 64, 174, 30, 74, 500, 88, 76, 156, 38, 34, 500, 500, 500, 500, 500, 306, 500, 500, 44, 70, 98, 500, 500, 500, 52, 88, 500, 48, 76, 500, 500, 52, 82, 500, 40, 90, 46, 500, 38, 500, 304, 354, 500, 500, 68, 500, 500, 96, 52, 30, 500, 500, 52, 62, 56, 50, 500, 58, 48, 56, 74, 46, 500, 500, 500, 274, 500, 220, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39065572683163935, "mean_inference_ms": 1.257017602017485, "mean_action_processing_ms": 0.14702953988801792, "mean_env_wait_ms": 0.08639138319862888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800130844116211, "StateBufferConnector_ms": 0.009002923965454102, "ViewRequirementAgentConnector_ms": 0.1370086669921875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4903.2964179603305, "num_env_steps_trained_throughput_per_sec": 4903.2964179603305, "timesteps_total": 1260000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 3782.641, "sample_time_ms": 3246.696, "load_time_ms": 23.199, "load_throughput": 775891.195, "learn_time_ms": 500.144, "learn_throughput": 35989.643, "synch_weights_time_ms": 10.102}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4784, "training_iteration": 70, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-38", "timestamp": 1698248438, "time_this_iter_s": 3.6769986152648926, "time_total_s": 244.77087354660034, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 244.77087354660034, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 68.3, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6940658945086e-22, "cur_lr": 0.0003, "total_loss": 6.30646063486735, "policy_loss": -0.0007203500303957197, "vf_loss": 6.307228427463108, "vf_explained_var": -0.007740933365292019, "kl": 0.0012605581134655117, "entropy": 0.4753733456134796, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3173.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.052999999999824, "episode_len_mean": 255.1, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, 19.69999999999984, 14.699999999999768, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.900000000000006, 44.5, 45.1, -50.00000000000044, 44.300000000000004, 45.3, 44.5, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 28.09999999999996, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, 18.099999999999817, 43.10000000000001, 44.7, 43.900000000000006, -50.00000000000044, 41.100000000000016, 45.9, -50.00000000000044, 22.699999999999882, 43.50000000000001, -50.00000000000044, 46.699999999999996, 33.70000000000004, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.3, 33.500000000000036, 26.69999999999994, 33.90000000000004, -50.00000000000044, -50.00000000000044, 47.5, 38.10000000000002, 46.099999999999994, -50.00000000000044, 23.699999999999896, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 45.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 47.1, 19.499999999999837, -50.00000000000044, 19.69999999999984, 41.30000000000001, 44.900000000000006, 32.30000000000002, -50.00000000000044, 46.3, -50.00000000000044, 46.3, -50.00000000000044, 37.90000000000003, -50.00000000000044, 26.69999999999994, 33.90000000000004, -50.00000000000044, 45.9, 45.3, 41.70000000000002, 37.300000000000026, 39.10000000000002, 20.699999999999854], "episode_lengths": [38, 500, 304, 354, 500, 500, 68, 500, 500, 96, 52, 30, 500, 500, 52, 62, 56, 50, 500, 58, 48, 56, 74, 46, 500, 500, 500, 274, 500, 220, 74, 500, 500, 66, 78, 500, 500, 320, 70, 54, 62, 500, 90, 42, 500, 274, 66, 500, 34, 164, 500, 46, 500, 500, 500, 56, 48, 166, 234, 162, 500, 500, 26, 120, 40, 500, 264, 500, 32, 500, 38, 42, 500, 68, 500, 78, 500, 30, 306, 500, 304, 88, 52, 178, 500, 38, 500, 38, 500, 122, 500, 234, 162, 500, 42, 48, 84, 128, 110, 294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39113904087035806, "mean_inference_ms": 1.2577988263103745, "mean_action_processing_ms": 0.14718837156584366, "mean_env_wait_ms": 0.08644351895967631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040990352630615234, "StateBufferConnector_ms": 0.009004831314086914, "ViewRequirementAgentConnector_ms": 0.13401389122009277}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.052999999999824, "episode_len_mean": 255.1, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, 19.69999999999984, 14.699999999999768, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.900000000000006, 44.5, 45.1, -50.00000000000044, 44.300000000000004, 45.3, 44.5, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 28.09999999999996, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, 18.099999999999817, 43.10000000000001, 44.7, 43.900000000000006, -50.00000000000044, 41.100000000000016, 45.9, -50.00000000000044, 22.699999999999882, 43.50000000000001, -50.00000000000044, 46.699999999999996, 33.70000000000004, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.3, 33.500000000000036, 26.69999999999994, 33.90000000000004, -50.00000000000044, -50.00000000000044, 47.5, 38.10000000000002, 46.099999999999994, -50.00000000000044, 23.699999999999896, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 45.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 47.1, 19.499999999999837, -50.00000000000044, 19.69999999999984, 41.30000000000001, 44.900000000000006, 32.30000000000002, -50.00000000000044, 46.3, -50.00000000000044, 46.3, -50.00000000000044, 37.90000000000003, -50.00000000000044, 26.69999999999994, 33.90000000000004, -50.00000000000044, 45.9, 45.3, 41.70000000000002, 37.300000000000026, 39.10000000000002, 20.699999999999854], "episode_lengths": [38, 500, 304, 354, 500, 500, 68, 500, 500, 96, 52, 30, 500, 500, 52, 62, 56, 50, 500, 58, 48, 56, 74, 46, 500, 500, 500, 274, 500, 220, 74, 500, 500, 66, 78, 500, 500, 320, 70, 54, 62, 500, 90, 42, 500, 274, 66, 500, 34, 164, 500, 46, 500, 500, 500, 56, 48, 166, 234, 162, 500, 500, 26, 120, 40, 500, 264, 500, 32, 500, 38, 42, 500, 68, 500, 78, 500, 30, 306, 500, 304, 88, 52, 178, 500, 38, 500, 38, 500, 122, 500, 234, 162, 500, 42, 48, 84, 128, 110, 294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39113904087035806, "mean_inference_ms": 1.2577988263103745, "mean_action_processing_ms": 0.14718837156584366, "mean_env_wait_ms": 0.08644351895967631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040990352630615234, "StateBufferConnector_ms": 0.009004831314086914, "ViewRequirementAgentConnector_ms": 0.13401389122009277}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4885.992516479775, "num_env_steps_trained_throughput_per_sec": 4885.992516479775, "timesteps_total": 1278000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1278000, "timers": {"training_iteration_time_ms": 3768.34, "sample_time_ms": 3240.196, "load_time_ms": 22.999, "load_throughput": 782631.347, "learn_time_ms": 492.344, "learn_throughput": 36559.809, "synch_weights_time_ms": 10.101}, "counters": {"num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "done": false, "episodes_total": 4853, "training_iteration": 71, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-42", "timestamp": 1698248442, "time_this_iter_s": 3.692002534866333, "time_total_s": 248.46287608146667, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 248.46287608146667, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 69.17999999999999, "ram_util_percent": 27.740000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543e-23, "cur_lr": 0.0003, "total_loss": 6.722546248965793, "policy_loss": -4.110241101847755e-05, "vf_loss": 6.72263322406345, "vf_explained_var": 0.002917569213443332, "kl": 0.00016974437213737776, "entropy": 0.4584009932147132, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3218.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.176999999999811, "episode_len_mean": 263.84, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.699999999999896, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 45.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 47.1, 19.499999999999837, -50.00000000000044, 19.69999999999984, 41.30000000000001, 44.900000000000006, 32.30000000000002, -50.00000000000044, 46.3, -50.00000000000044, 46.3, -50.00000000000044, 37.90000000000003, -50.00000000000044, 26.69999999999994, 33.90000000000004, -50.00000000000044, 45.9, 45.3, 41.70000000000002, 37.300000000000026, 39.10000000000002, 20.699999999999854, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.50000000000001, 44.5, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 22.099999999999874, 45.7, -50.00000000000044, 46.3, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, 2.299999999999592, -50.00000000000044, 43.900000000000006, 46.699999999999996, -50.00000000000044, 46.9, -50.00000000000044, 13.499999999999751, 8.099999999999675, -50.00000000000044, 44.7, 28.499999999999964, 44.900000000000006, -50.00000000000044, 32.30000000000002, 32.50000000000002, 43.900000000000006, 46.099999999999994, 41.90000000000001, -50.00000000000044, 45.9, 44.300000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.30000000000001, 22.299999999999876, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 37.90000000000003, 46.3, 46.3], "episode_lengths": [264, 500, 32, 500, 38, 42, 500, 68, 500, 78, 500, 30, 306, 500, 304, 88, 52, 178, 500, 38, 500, 38, 500, 122, 500, 234, 162, 500, 42, 48, 84, 128, 110, 294, 500, 500, 76, 66, 56, 46, 500, 500, 60, 280, 44, 500, 38, 44, 500, 500, 500, 24, 500, 92, 500, 500, 500, 500, 124, 500, 500, 76, 500, 54, 500, 478, 500, 62, 34, 500, 32, 500, 366, 420, 500, 54, 216, 52, 500, 178, 176, 62, 40, 82, 500, 42, 58, 34, 500, 500, 68, 278, 52, 500, 500, 500, 42, 122, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39183637398170573, "mean_inference_ms": 1.2594087004102839, "mean_action_processing_ms": 0.14728135072230772, "mean_env_wait_ms": 0.08660363263239251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027998924255371094, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.16100192070007324}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.176999999999811, "episode_len_mean": 263.84, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.699999999999896, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 45.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 47.1, 19.499999999999837, -50.00000000000044, 19.69999999999984, 41.30000000000001, 44.900000000000006, 32.30000000000002, -50.00000000000044, 46.3, -50.00000000000044, 46.3, -50.00000000000044, 37.90000000000003, -50.00000000000044, 26.69999999999994, 33.90000000000004, -50.00000000000044, 45.9, 45.3, 41.70000000000002, 37.300000000000026, 39.10000000000002, 20.699999999999854, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.50000000000001, 44.5, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 22.099999999999874, 45.7, -50.00000000000044, 46.3, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, 2.299999999999592, -50.00000000000044, 43.900000000000006, 46.699999999999996, -50.00000000000044, 46.9, -50.00000000000044, 13.499999999999751, 8.099999999999675, -50.00000000000044, 44.7, 28.499999999999964, 44.900000000000006, -50.00000000000044, 32.30000000000002, 32.50000000000002, 43.900000000000006, 46.099999999999994, 41.90000000000001, -50.00000000000044, 45.9, 44.300000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.30000000000001, 22.299999999999876, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 37.90000000000003, 46.3, 46.3], "episode_lengths": [264, 500, 32, 500, 38, 42, 500, 68, 500, 78, 500, 30, 306, 500, 304, 88, 52, 178, 500, 38, 500, 38, 500, 122, 500, 234, 162, 500, 42, 48, 84, 128, 110, 294, 500, 500, 76, 66, 56, 46, 500, 500, 60, 280, 44, 500, 38, 44, 500, 500, 500, 24, 500, 92, 500, 500, 500, 500, 124, 500, 500, 76, 500, 54, 500, 478, 500, 62, 34, 500, 32, 500, 366, 420, 500, 54, 216, 52, 500, 178, 176, 62, 40, 82, 500, 42, 58, 34, 500, 500, 68, 278, 52, 500, 500, 500, 42, 122, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39183637398170573, "mean_inference_ms": 1.2594087004102839, "mean_action_processing_ms": 0.14728135072230772, "mean_env_wait_ms": 0.08660363263239251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027998924255371094, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.16100192070007324}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4866.174872203846, "num_env_steps_trained_throughput_per_sec": 4866.174872203846, "timesteps_total": 1296000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 3756.341, "sample_time_ms": 3240.196, "load_time_ms": 22.799, "load_throughput": 789495.407, "learn_time_ms": 480.544, "learn_throughput": 37457.565, "synch_weights_time_ms": 10.102}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4919, "training_iteration": 72, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-46", "timestamp": 1698248446, "time_this_iter_s": 3.7050013542175293, "time_total_s": 252.1678774356842, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 252.1678774356842, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 69.05999999999999, "ram_util_percent": 27.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715e-23, "cur_lr": 0.0003, "total_loss": 6.75779210196601, "policy_loss": -0.00045367669728067187, "vf_loss": 6.758294052547878, "vf_explained_var": -0.005293528238932292, "kl": 0.0008779525112698947, "entropy": 0.4822710381613837, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3263.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.277999999999829, "episode_len_mean": 247.86, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.099999999999675, -50.00000000000044, 44.7, 28.499999999999964, 44.900000000000006, -50.00000000000044, 32.30000000000002, 32.50000000000002, 43.900000000000006, 46.099999999999994, 41.90000000000001, -50.00000000000044, 45.9, 44.300000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.30000000000001, 22.299999999999876, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 37.90000000000003, 46.3, 46.3, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 46.099999999999994, 37.70000000000003, -50.00000000000044, 46.099999999999994, 45.9, -50.00000000000044, 42.70000000000001, 43.900000000000006, 27.099999999999945, 45.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.099999999999994, 46.5, 47.3, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.299999999999848, 28.29999999999996, -50.00000000000044, 46.3, -50.00000000000044, 37.90000000000003, -50.00000000000044, 44.300000000000004, 39.70000000000002, 42.70000000000001, 24.099999999999902, 30.699999999999996, 6.8999999999996575, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.9, 43.7, -50.00000000000044, 43.10000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 27.899999999999956, 47.3, -50.00000000000044, 42.70000000000001, 43.30000000000001, 39.50000000000002, -50.00000000000044, 45.5, 9.099999999999689, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.5, 42.30000000000001, 36.900000000000034], "episode_lengths": [420, 500, 54, 216, 52, 500, 178, 176, 62, 40, 82, 500, 42, 58, 34, 500, 500, 68, 278, 52, 500, 500, 500, 42, 122, 38, 38, 500, 500, 148, 500, 40, 124, 500, 40, 42, 500, 74, 62, 230, 48, 500, 500, 62, 40, 36, 28, 500, 102, 500, 56, 500, 500, 500, 298, 218, 500, 38, 500, 122, 500, 58, 104, 74, 260, 194, 432, 34, 500, 500, 500, 500, 44, 22, 64, 500, 70, 110, 500, 500, 500, 44, 56, 222, 28, 500, 74, 68, 106, 500, 46, 410, 30, 500, 500, 500, 130, 36, 78, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3921440196212349, "mean_inference_ms": 1.2605246124920568, "mean_action_processing_ms": 0.14758815752040874, "mean_env_wait_ms": 0.08658959866874483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020992517471313477, "StateBufferConnector_ms": 0.008001565933227539, "ViewRequirementAgentConnector_ms": 0.17002320289611816}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.277999999999829, "episode_len_mean": 247.86, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.099999999999675, -50.00000000000044, 44.7, 28.499999999999964, 44.900000000000006, -50.00000000000044, 32.30000000000002, 32.50000000000002, 43.900000000000006, 46.099999999999994, 41.90000000000001, -50.00000000000044, 45.9, 44.300000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.30000000000001, 22.299999999999876, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 37.90000000000003, 46.3, 46.3, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 46.099999999999994, 37.70000000000003, -50.00000000000044, 46.099999999999994, 45.9, -50.00000000000044, 42.70000000000001, 43.900000000000006, 27.099999999999945, 45.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.099999999999994, 46.5, 47.3, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.299999999999848, 28.29999999999996, -50.00000000000044, 46.3, -50.00000000000044, 37.90000000000003, -50.00000000000044, 44.300000000000004, 39.70000000000002, 42.70000000000001, 24.099999999999902, 30.699999999999996, 6.8999999999996575, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.9, 43.7, -50.00000000000044, 43.10000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 27.899999999999956, 47.3, -50.00000000000044, 42.70000000000001, 43.30000000000001, 39.50000000000002, -50.00000000000044, 45.5, 9.099999999999689, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.5, 42.30000000000001, 36.900000000000034], "episode_lengths": [420, 500, 54, 216, 52, 500, 178, 176, 62, 40, 82, 500, 42, 58, 34, 500, 500, 68, 278, 52, 500, 500, 500, 42, 122, 38, 38, 500, 500, 148, 500, 40, 124, 500, 40, 42, 500, 74, 62, 230, 48, 500, 500, 62, 40, 36, 28, 500, 102, 500, 56, 500, 500, 500, 298, 218, 500, 38, 500, 122, 500, 58, 104, 74, 260, 194, 432, 34, 500, 500, 500, 500, 44, 22, 64, 500, 70, 110, 500, 500, 500, 44, 56, 222, 28, 500, 74, 68, 106, 500, 46, 410, 30, 500, 500, 500, 130, 36, 78, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3921440196212349, "mean_inference_ms": 1.2605246124920568, "mean_action_processing_ms": 0.14758815752040874, "mean_env_wait_ms": 0.08658959866874483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020992517471313477, "StateBufferConnector_ms": 0.008001565933227539, "ViewRequirementAgentConnector_ms": 0.17002320289611816}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4912.61352177405, "num_env_steps_trained_throughput_per_sec": 4912.61352177405, "timesteps_total": 1314000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1314000, "timers": {"training_iteration_time_ms": 3746.705, "sample_time_ms": 3237.504, "load_time_ms": 20.799, "load_throughput": 865410.637, "learn_time_ms": 475.8, "learn_throughput": 37831.013, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "done": false, "episodes_total": 4992, "training_iteration": 73, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-49", "timestamp": 1698248449, "time_this_iter_s": 3.6700398921966553, "time_total_s": 255.83791732788086, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 255.83791732788086, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 68.5, "ram_util_percent": 27.679999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.11758236813575e-23, "cur_lr": 0.0003, "total_loss": 6.607257334391276, "policy_loss": -0.0003325038486056858, "vf_loss": 6.6076360702514645, "vf_explained_var": 0.0003197590510050456, "kl": 0.0009243276198819532, "entropy": 0.4627705362108019, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.818999999999813, "episode_len_mean": 267.44, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.70000000000002, 42.70000000000001, 24.099999999999902, 30.699999999999996, 6.8999999999996575, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.9, 43.7, -50.00000000000044, 43.10000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 27.899999999999956, 47.3, -50.00000000000044, 42.70000000000001, 43.30000000000001, 39.50000000000002, -50.00000000000044, 45.5, 9.099999999999689, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.5, 42.30000000000001, 36.900000000000034, -50.00000000000044, 37.300000000000026, 41.500000000000014, -50.00000000000044, 29.69999999999998, 46.699999999999996, 7.299999999999663, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 43.50000000000001, 41.500000000000014, -50.00000000000044, 43.50000000000001, -50.00000000000044, 4.299999999999621, -50.00000000000044, 12.899999999999743, 45.7, 27.699999999999953, 37.300000000000026, 41.30000000000001, 3.499999999999609, 40.30000000000002, 44.900000000000006, 25.699999999999925, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 33.30000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 44.300000000000004, 42.30000000000001, -50.00000000000044, 43.900000000000006, 45.9, 40.70000000000002, -50.00000000000044, 36.30000000000003, 45.3, -50.00000000000044, 47.7, 45.3, 33.10000000000003, 44.900000000000006, 2.0999999999995893], "episode_lengths": [104, 74, 260, 194, 432, 34, 500, 500, 500, 500, 44, 22, 64, 500, 70, 110, 500, 500, 500, 44, 56, 222, 28, 500, 74, 68, 106, 500, 46, 410, 30, 500, 500, 500, 130, 36, 78, 132, 500, 128, 86, 500, 204, 34, 428, 500, 58, 500, 50, 66, 86, 500, 66, 500, 458, 500, 372, 44, 224, 128, 88, 466, 98, 52, 244, 500, 70, 500, 500, 500, 500, 48, 120, 500, 500, 500, 500, 500, 500, 122, 168, 500, 500, 174, 500, 58, 78, 500, 62, 42, 94, 500, 138, 48, 500, 24, 48, 170, 52, 480]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39270223320445025, "mean_inference_ms": 1.261461145004788, "mean_action_processing_ms": 0.14750702585849879, "mean_env_wait_ms": 0.08683687110405511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027005672454833984, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.1590275764465332}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.818999999999813, "episode_len_mean": 267.44, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.70000000000002, 42.70000000000001, 24.099999999999902, 30.699999999999996, 6.8999999999996575, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.9, 43.7, -50.00000000000044, 43.10000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 27.899999999999956, 47.3, -50.00000000000044, 42.70000000000001, 43.30000000000001, 39.50000000000002, -50.00000000000044, 45.5, 9.099999999999689, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.5, 42.30000000000001, 36.900000000000034, -50.00000000000044, 37.300000000000026, 41.500000000000014, -50.00000000000044, 29.69999999999998, 46.699999999999996, 7.299999999999663, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 43.50000000000001, 41.500000000000014, -50.00000000000044, 43.50000000000001, -50.00000000000044, 4.299999999999621, -50.00000000000044, 12.899999999999743, 45.7, 27.699999999999953, 37.300000000000026, 41.30000000000001, 3.499999999999609, 40.30000000000002, 44.900000000000006, 25.699999999999925, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 33.30000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 44.300000000000004, 42.30000000000001, -50.00000000000044, 43.900000000000006, 45.9, 40.70000000000002, -50.00000000000044, 36.30000000000003, 45.3, -50.00000000000044, 47.7, 45.3, 33.10000000000003, 44.900000000000006, 2.0999999999995893], "episode_lengths": [104, 74, 260, 194, 432, 34, 500, 500, 500, 500, 44, 22, 64, 500, 70, 110, 500, 500, 500, 44, 56, 222, 28, 500, 74, 68, 106, 500, 46, 410, 30, 500, 500, 500, 130, 36, 78, 132, 500, 128, 86, 500, 204, 34, 428, 500, 58, 500, 50, 66, 86, 500, 66, 500, 458, 500, 372, 44, 224, 128, 88, 466, 98, 52, 244, 500, 70, 500, 500, 500, 500, 48, 120, 500, 500, 500, 500, 500, 500, 122, 168, 500, 500, 174, 500, 58, 78, 500, 62, 42, 94, 500, 138, 48, 500, 24, 48, 170, 52, 480]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39270223320445025, "mean_inference_ms": 1.261461145004788, "mean_action_processing_ms": 0.14750702585849879, "mean_env_wait_ms": 0.08683687110405511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027005672454833984, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.1590275764465332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4887.32601426901, "num_env_steps_trained_throughput_per_sec": 4887.32601426901, "timesteps_total": 1332000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 3725.905, "sample_time_ms": 3209.303, "load_time_ms": 20.8, "load_throughput": 865399.725, "learn_time_ms": 482.9, "learn_throughput": 37274.791, "synch_weights_time_ms": 10.201}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5054, "training_iteration": 74, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-53", "timestamp": 1698248453, "time_this_iter_s": 3.6889960765838623, "time_total_s": 259.5269134044647, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 259.5269134044647, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 59.63333333333335, "ram_util_percent": 27.616666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.058791184067875e-23, "cur_lr": 0.0003, "total_loss": 6.466204261779785, "policy_loss": -0.0005764161547025044, "vf_loss": 6.466831599341498, "vf_explained_var": -0.0023426387045118544, "kl": 0.0013203034844183196, "entropy": 0.5091798471079932, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3353.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7720000000002051, "episode_len_mean": 288.28, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.699999999999925, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 33.30000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 44.300000000000004, 42.30000000000001, -50.00000000000044, 43.900000000000006, 45.9, 40.70000000000002, -50.00000000000044, 36.30000000000003, 45.3, -50.00000000000044, 47.7, 45.3, 33.10000000000003, 44.900000000000006, 2.0999999999995893, 17.69999999999981, 45.5, 44.900000000000006, 43.50000000000001, 28.09999999999996, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 36.70000000000003, 43.50000000000001, 46.699999999999996, 43.900000000000006, 31.300000000000004, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 25.29999999999992, 34.10000000000004, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 23.8999999999999, 16.699999999999797, -50.00000000000044, 36.50000000000003, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.500000000000014, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 47.7, 42.70000000000001, -50.00000000000044, 42.10000000000001, 46.099999999999994, -50.00000000000044, 25.29999999999992, -50.00000000000044, 45.7, 40.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 19.299999999999834, 42.900000000000006], "episode_lengths": [244, 500, 70, 500, 500, 500, 500, 48, 120, 500, 500, 500, 500, 500, 500, 122, 168, 500, 500, 174, 500, 58, 78, 500, 62, 42, 94, 500, 138, 48, 500, 24, 48, 170, 52, 480, 324, 46, 52, 66, 220, 46, 500, 500, 500, 500, 92, 500, 500, 134, 66, 34, 62, 188, 500, 32, 500, 500, 248, 160, 500, 24, 500, 500, 60, 262, 334, 500, 136, 500, 172, 500, 500, 52, 96, 58, 500, 62, 500, 424, 500, 500, 500, 56, 24, 74, 500, 80, 40, 500, 248, 500, 44, 96, 500, 500, 96, 500, 308, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39296418750983864, "mean_inference_ms": 1.2628509265096302, "mean_action_processing_ms": 0.1476691238964171, "mean_env_wait_ms": 0.08680141432363479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034020185470581055, "StateBufferConnector_ms": 0.00800180435180664, "ViewRequirementAgentConnector_ms": 0.13802218437194824}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7720000000002051, "episode_len_mean": 288.28, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.699999999999925, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 33.30000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 44.300000000000004, 42.30000000000001, -50.00000000000044, 43.900000000000006, 45.9, 40.70000000000002, -50.00000000000044, 36.30000000000003, 45.3, -50.00000000000044, 47.7, 45.3, 33.10000000000003, 44.900000000000006, 2.0999999999995893, 17.69999999999981, 45.5, 44.900000000000006, 43.50000000000001, 28.09999999999996, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 36.70000000000003, 43.50000000000001, 46.699999999999996, 43.900000000000006, 31.300000000000004, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 25.29999999999992, 34.10000000000004, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 23.8999999999999, 16.699999999999797, -50.00000000000044, 36.50000000000003, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.500000000000014, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 47.7, 42.70000000000001, -50.00000000000044, 42.10000000000001, 46.099999999999994, -50.00000000000044, 25.29999999999992, -50.00000000000044, 45.7, 40.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 19.299999999999834, 42.900000000000006], "episode_lengths": [244, 500, 70, 500, 500, 500, 500, 48, 120, 500, 500, 500, 500, 500, 500, 122, 168, 500, 500, 174, 500, 58, 78, 500, 62, 42, 94, 500, 138, 48, 500, 24, 48, 170, 52, 480, 324, 46, 52, 66, 220, 46, 500, 500, 500, 500, 92, 500, 500, 134, 66, 34, 62, 188, 500, 32, 500, 500, 248, 160, 500, 24, 500, 500, 60, 262, 334, 500, 136, 500, 172, 500, 500, 52, 96, 58, 500, 62, 500, 424, 500, 500, 500, 56, 24, 74, 500, 80, 40, 500, 248, 500, 44, 96, 500, 500, 96, 500, 308, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39296418750983864, "mean_inference_ms": 1.2628509265096302, "mean_action_processing_ms": 0.1476691238964171, "mean_env_wait_ms": 0.08680141432363479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034020185470581055, "StateBufferConnector_ms": 0.00800180435180664, "ViewRequirementAgentConnector_ms": 0.13802218437194824}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4729.3580881026855, "num_env_steps_trained_throughput_per_sec": 4729.3580881026855, "timesteps_total": 1350000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1350000, "timers": {"training_iteration_time_ms": 3728.206, "sample_time_ms": 3204.003, "load_time_ms": 21.399, "load_throughput": 841144.976, "learn_time_ms": 490.402, "learn_throughput": 36704.607, "synch_weights_time_ms": 9.901}, "counters": {"num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "done": false, "episodes_total": 5118, "training_iteration": 75, "trial_id": "9f288_00013", "date": "2023-10-25_16-40-57", "timestamp": 1698248457, "time_this_iter_s": 3.8130130767822266, "time_total_s": 263.33992648124695, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 263.33992648124695, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 70.35999999999999, "ram_util_percent": 27.660000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339375e-24, "cur_lr": 0.0003, "total_loss": 6.362453206380208, "policy_loss": -0.0006455781559149425, "vf_loss": 6.363147724999322, "vf_explained_var": -0.006229983435736762, "kl": 0.0014310861382720455, "entropy": 0.4903039905760023, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3398.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.2860000000002097, "episode_len_mean": 283.42, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.699999999999797, -50.00000000000044, 36.50000000000003, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.500000000000014, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 47.7, 42.70000000000001, -50.00000000000044, 42.10000000000001, 46.099999999999994, -50.00000000000044, 25.29999999999992, -50.00000000000044, 45.7, 40.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 19.299999999999834, 42.900000000000006, -50.00000000000044, 46.699999999999996, 45.1, 42.500000000000014, 44.5, 13.299999999999748, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.5, -50.00000000000044, -50.00000000000044, 46.9, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.7, 45.9, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, 45.9, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.7, 47.3, -50.00000000000044, -50.00000000000044, 47.7, 46.3, 43.900000000000006, 46.9, 38.90000000000002, 47.3, -50.00000000000044, 39.300000000000026, -50.00000000000044, 24.899999999999913, 46.3, 20.099999999999845, 47.5, 45.5, 17.69999999999981, -50.00000000000044, 19.499999999999837], "episode_lengths": [334, 500, 136, 500, 172, 500, 500, 52, 96, 58, 500, 62, 500, 424, 500, 500, 500, 56, 24, 74, 500, 80, 40, 500, 248, 500, 44, 96, 500, 500, 96, 500, 308, 72, 500, 34, 50, 76, 56, 368, 344, 500, 500, 500, 500, 24, 46, 500, 500, 32, 262, 500, 500, 500, 68, 44, 42, 500, 80, 500, 500, 500, 118, 500, 500, 500, 70, 120, 42, 112, 500, 500, 500, 72, 500, 500, 500, 500, 42, 44, 28, 500, 500, 24, 38, 62, 32, 112, 28, 500, 108, 500, 252, 38, 300, 26, 46, 324, 500, 306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39350580339862495, "mean_inference_ms": 1.2642403139688645, "mean_action_processing_ms": 0.14781065492644277, "mean_env_wait_ms": 0.0870381796213298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03998899459838867, "StateBufferConnector_ms": 0.0019996166229248047, "ViewRequirementAgentConnector_ms": 0.12294411659240723}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.2860000000002097, "episode_len_mean": 283.42, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.699999999999797, -50.00000000000044, 36.50000000000003, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.500000000000014, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 47.7, 42.70000000000001, -50.00000000000044, 42.10000000000001, 46.099999999999994, -50.00000000000044, 25.29999999999992, -50.00000000000044, 45.7, 40.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 19.299999999999834, 42.900000000000006, -50.00000000000044, 46.699999999999996, 45.1, 42.500000000000014, 44.5, 13.299999999999748, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.5, -50.00000000000044, -50.00000000000044, 46.9, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.7, 45.9, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, 45.9, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.7, 47.3, -50.00000000000044, -50.00000000000044, 47.7, 46.3, 43.900000000000006, 46.9, 38.90000000000002, 47.3, -50.00000000000044, 39.300000000000026, -50.00000000000044, 24.899999999999913, 46.3, 20.099999999999845, 47.5, 45.5, 17.69999999999981, -50.00000000000044, 19.499999999999837], "episode_lengths": [334, 500, 136, 500, 172, 500, 500, 52, 96, 58, 500, 62, 500, 424, 500, 500, 500, 56, 24, 74, 500, 80, 40, 500, 248, 500, 44, 96, 500, 500, 96, 500, 308, 72, 500, 34, 50, 76, 56, 368, 344, 500, 500, 500, 500, 24, 46, 500, 500, 32, 262, 500, 500, 500, 68, 44, 42, 500, 80, 500, 500, 500, 118, 500, 500, 500, 70, 120, 42, 112, 500, 500, 500, 72, 500, 500, 500, 500, 42, 44, 28, 500, 500, 24, 38, 62, 32, 112, 28, 500, 108, 500, 252, 38, 300, 26, 46, 324, 500, 306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39350580339862495, "mean_inference_ms": 1.2642403139688645, "mean_action_processing_ms": 0.14781065492644277, "mean_env_wait_ms": 0.0870381796213298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03998899459838867, "StateBufferConnector_ms": 0.0019996166229248047, "ViewRequirementAgentConnector_ms": 0.12294411659240723}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4843.911249901836, "num_env_steps_trained_throughput_per_sec": 4843.911249901836, "timesteps_total": 1368000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 3719.606, "sample_time_ms": 3199.303, "load_time_ms": 20.9, "load_throughput": 861264.196, "learn_time_ms": 486.702, "learn_throughput": 36983.628, "synch_weights_time_ms": 10.201}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5184, "training_iteration": 76, "trial_id": "9f288_00013", "date": "2023-10-25_16-41-01", "timestamp": 1698248461, "time_this_iter_s": 3.7219982147216797, "time_total_s": 267.0619246959686, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 267.0619246959686, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 68.44000000000001, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.6469779601696876e-24, "cur_lr": 0.0003, "total_loss": 6.376225683424208, "policy_loss": -4.823340309990777e-06, "vf_loss": 6.376279311709934, "vf_explained_var": -0.00437877443101671, "kl": 0.00012904478391596462, "entropy": 0.48779962923791675, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3443.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.229999999999814, "episode_len_mean": 258.32, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.7, 47.3, -50.00000000000044, -50.00000000000044, 47.7, 46.3, 43.900000000000006, 46.9, 38.90000000000002, 47.3, -50.00000000000044, 39.300000000000026, -50.00000000000044, 24.899999999999913, 46.3, 20.099999999999845, 47.5, 45.5, 17.69999999999981, -50.00000000000044, 19.499999999999837, 45.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.7, 34.30000000000004, -50.00000000000044, -50.00000000000044, 17.099999999999802, 13.899999999999757, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.5, 34.50000000000004, 46.3, 41.70000000000002, -50.00000000000044, 25.499999999999922, 47.7, -50.00000000000044, 4.499999999999623, 29.899999999999984, 42.30000000000001, -50.00000000000044, 46.3, 46.9, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 45.3, 41.500000000000014, 47.9, 47.1, 10.299999999999706, -50.00000000000044, 45.3, 47.1, -50.00000000000044, 30.29999999999999, 22.299999999999876, 44.7, 46.5, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.500000000000014, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 17.899999999999814, 46.099999999999994], "episode_lengths": [42, 112, 500, 500, 500, 72, 500, 500, 500, 500, 42, 44, 28, 500, 500, 24, 38, 62, 32, 112, 28, 500, 108, 500, 252, 38, 300, 26, 46, 324, 500, 306, 42, 62, 500, 500, 92, 64, 158, 500, 500, 330, 362, 500, 64, 500, 500, 36, 156, 38, 84, 500, 246, 24, 500, 456, 202, 78, 500, 38, 32, 500, 48, 500, 52, 32, 500, 500, 144, 500, 48, 86, 22, 30, 398, 500, 48, 30, 500, 198, 278, 54, 36, 500, 98, 50, 500, 500, 500, 500, 32, 76, 500, 52, 500, 500, 500, 58, 322, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3940150186750108, "mean_inference_ms": 1.2660081830438186, "mean_action_processing_ms": 0.1482345022152388, "mean_env_wait_ms": 0.08723825263911564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031986236572265625, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13299298286437988}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.229999999999814, "episode_len_mean": 258.32, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.7, 47.3, -50.00000000000044, -50.00000000000044, 47.7, 46.3, 43.900000000000006, 46.9, 38.90000000000002, 47.3, -50.00000000000044, 39.300000000000026, -50.00000000000044, 24.899999999999913, 46.3, 20.099999999999845, 47.5, 45.5, 17.69999999999981, -50.00000000000044, 19.499999999999837, 45.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.7, 34.30000000000004, -50.00000000000044, -50.00000000000044, 17.099999999999802, 13.899999999999757, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.5, 34.50000000000004, 46.3, 41.70000000000002, -50.00000000000044, 25.499999999999922, 47.7, -50.00000000000044, 4.499999999999623, 29.899999999999984, 42.30000000000001, -50.00000000000044, 46.3, 46.9, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 45.3, 41.500000000000014, 47.9, 47.1, 10.299999999999706, -50.00000000000044, 45.3, 47.1, -50.00000000000044, 30.29999999999999, 22.299999999999876, 44.7, 46.5, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.500000000000014, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 17.899999999999814, 46.099999999999994], "episode_lengths": [42, 112, 500, 500, 500, 72, 500, 500, 500, 500, 42, 44, 28, 500, 500, 24, 38, 62, 32, 112, 28, 500, 108, 500, 252, 38, 300, 26, 46, 324, 500, 306, 42, 62, 500, 500, 92, 64, 158, 500, 500, 330, 362, 500, 64, 500, 500, 36, 156, 38, 84, 500, 246, 24, 500, 456, 202, 78, 500, 38, 32, 500, 48, 500, 52, 32, 500, 500, 144, 500, 48, 86, 22, 30, 398, 500, 48, 30, 500, 198, 278, 54, 36, 500, 98, 50, 500, 500, 500, 500, 32, 76, 500, 52, 500, 500, 500, 58, 322, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3940150186750108, "mean_inference_ms": 1.2660081830438186, "mean_action_processing_ms": 0.1482345022152388, "mean_env_wait_ms": 0.08723825263911564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031986236572265625, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13299298286437988}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4778.341577672612, "num_env_steps_trained_throughput_per_sec": 4778.341577672612, "timesteps_total": 1386000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1386000, "timers": {"training_iteration_time_ms": 3717.705, "sample_time_ms": 3202.803, "load_time_ms": 20.799, "load_throughput": 865409.645, "learn_time_ms": 481.502, "learn_throughput": 37383.055, "synch_weights_time_ms": 10.102}, "counters": {"num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "done": false, "episodes_total": 5252, "training_iteration": 77, "trial_id": "9f288_00013", "date": "2023-10-25_16-41-04", "timestamp": 1698248464, "time_this_iter_s": 3.7729990482330322, "time_total_s": 270.83492374420166, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 270.83492374420166, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 68.42, "ram_util_percent": 28.060000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848438e-24, "cur_lr": 0.0003, "total_loss": 6.996530034806994, "policy_loss": -3.9558857679367065e-05, "vf_loss": 6.996619097391764, "vf_explained_var": -0.009915921423170302, "kl": 0.00041538022298810674, "entropy": 0.4949247777462006, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3488.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.55599999999983, "episode_len_mean": 245.1, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 30.29999999999999, 22.299999999999876, 44.7, 46.5, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.500000000000014, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 17.899999999999814, 46.099999999999994, -50.00000000000044, 40.500000000000014, 17.299999999999805, 39.70000000000002, 40.10000000000002, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 37.70000000000003, 11.099999999999717, 45.3, 45.9, 26.499999999999936, -50.00000000000044, 33.90000000000004, 42.70000000000001, 44.7, -50.00000000000044, 18.099999999999817, 46.699999999999996, 44.5, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 46.9, -50.00000000000044, 44.7, 45.7, 44.300000000000004, 46.099999999999994, 45.7, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, 46.3, 43.30000000000001, 45.7, 44.900000000000006, 44.10000000000001, 46.099999999999994, 41.70000000000002, 39.300000000000026, 45.5, 38.10000000000002, 45.7, 46.3, 47.1, 41.90000000000001, -50.00000000000044, 34.70000000000004, 15.099999999999774, 47.3, -50.00000000000044, -50.00000000000044, 37.300000000000026, 43.50000000000001, 46.9, 10.499999999999709, 34.900000000000034, 37.300000000000026, 43.30000000000001], "episode_lengths": [500, 198, 278, 54, 36, 500, 98, 50, 500, 500, 500, 500, 32, 76, 500, 52, 500, 500, 500, 58, 322, 40, 500, 96, 328, 104, 100, 44, 500, 500, 36, 88, 500, 500, 64, 124, 390, 48, 42, 236, 500, 162, 74, 54, 500, 320, 34, 56, 500, 92, 500, 90, 500, 500, 500, 500, 486, 32, 500, 54, 44, 58, 40, 44, 500, 46, 500, 500, 500, 500, 474, 500, 500, 38, 68, 44, 52, 60, 40, 84, 108, 46, 120, 44, 38, 30, 82, 500, 154, 350, 28, 500, 500, 128, 66, 32, 396, 152, 128, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39434539030365356, "mean_inference_ms": 1.267407320445444, "mean_action_processing_ms": 0.14836650069289742, "mean_env_wait_ms": 0.08730454600392111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026003599166870117, "StateBufferConnector_ms": 0.00899648666381836, "ViewRequirementAgentConnector_ms": 0.13802599906921387}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.55599999999983, "episode_len_mean": 245.1, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 30.29999999999999, 22.299999999999876, 44.7, 46.5, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.500000000000014, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 17.899999999999814, 46.099999999999994, -50.00000000000044, 40.500000000000014, 17.299999999999805, 39.70000000000002, 40.10000000000002, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 37.70000000000003, 11.099999999999717, 45.3, 45.9, 26.499999999999936, -50.00000000000044, 33.90000000000004, 42.70000000000001, 44.7, -50.00000000000044, 18.099999999999817, 46.699999999999996, 44.5, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 46.9, -50.00000000000044, 44.7, 45.7, 44.300000000000004, 46.099999999999994, 45.7, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, 46.3, 43.30000000000001, 45.7, 44.900000000000006, 44.10000000000001, 46.099999999999994, 41.70000000000002, 39.300000000000026, 45.5, 38.10000000000002, 45.7, 46.3, 47.1, 41.90000000000001, -50.00000000000044, 34.70000000000004, 15.099999999999774, 47.3, -50.00000000000044, -50.00000000000044, 37.300000000000026, 43.50000000000001, 46.9, 10.499999999999709, 34.900000000000034, 37.300000000000026, 43.30000000000001], "episode_lengths": [500, 198, 278, 54, 36, 500, 98, 50, 500, 500, 500, 500, 32, 76, 500, 52, 500, 500, 500, 58, 322, 40, 500, 96, 328, 104, 100, 44, 500, 500, 36, 88, 500, 500, 64, 124, 390, 48, 42, 236, 500, 162, 74, 54, 500, 320, 34, 56, 500, 92, 500, 90, 500, 500, 500, 500, 486, 32, 500, 54, 44, 58, 40, 44, 500, 46, 500, 500, 500, 500, 474, 500, 500, 38, 68, 44, 52, 60, 40, 84, 108, 46, 120, 44, 38, 30, 82, 500, 154, 350, 28, 500, 500, 128, 66, 32, 396, 152, 128, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39434539030365356, "mean_inference_ms": 1.267407320445444, "mean_action_processing_ms": 0.14836650069289742, "mean_env_wait_ms": 0.08730454600392111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026003599166870117, "StateBufferConnector_ms": 0.00899648666381836, "ViewRequirementAgentConnector_ms": 0.13802599906921387}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5006.950078372998, "num_env_steps_trained_throughput_per_sec": 5006.950078372998, "timesteps_total": 1404000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 3700.905, "sample_time_ms": 3204.303, "load_time_ms": 19.5, "load_throughput": 923098.683, "learn_time_ms": 464.001, "learn_throughput": 38792.989, "synch_weights_time_ms": 10.602}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5330, "training_iteration": 78, "trial_id": "9f288_00013", "date": "2023-10-25_16-41-08", "timestamp": 1698248468, "time_this_iter_s": 3.6010022163391113, "time_total_s": 274.43592596054077, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 274.43592596054077, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 61.050000000000004, "ram_util_percent": 27.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424219e-25, "cur_lr": 0.0003, "total_loss": 6.465445200602214, "policy_loss": -0.00013427668147616916, "vf_loss": 6.465626409318712, "vf_explained_var": 0.0010807514190673828, "kl": 0.0008061298699671069, "entropy": 0.46895793279012044, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3533.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.575999999999816, "episode_len_mean": 254.86, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, 46.3, 43.30000000000001, 45.7, 44.900000000000006, 44.10000000000001, 46.099999999999994, 41.70000000000002, 39.300000000000026, 45.5, 38.10000000000002, 45.7, 46.3, 47.1, 41.90000000000001, -50.00000000000044, 34.70000000000004, 15.099999999999774, 47.3, -50.00000000000044, -50.00000000000044, 37.300000000000026, 43.50000000000001, 46.9, 10.499999999999709, 34.900000000000034, 37.300000000000026, 43.30000000000001, 37.10000000000003, 40.90000000000002, 46.5, -50.00000000000044, 45.1, 20.49999999999985, 44.300000000000004, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 26.499999999999936, 31.1, 15.699999999999783, -50.00000000000044, 45.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 47.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 45.5, 45.9, 37.70000000000003, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.90000000000001, 4.499999999999623, 45.9, 10.899999999999714, 47.3, 46.5, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.1], "episode_lengths": [46, 500, 500, 500, 500, 474, 500, 500, 38, 68, 44, 52, 60, 40, 84, 108, 46, 120, 44, 38, 30, 82, 500, 154, 350, 28, 500, 500, 128, 66, 32, 396, 152, 128, 68, 130, 92, 36, 500, 50, 296, 58, 58, 58, 500, 500, 236, 190, 344, 500, 46, 500, 66, 500, 500, 500, 28, 52, 500, 500, 500, 116, 500, 26, 500, 80, 500, 52, 42, 500, 46, 42, 124, 500, 38, 500, 44, 44, 500, 500, 500, 500, 40, 82, 456, 42, 392, 28, 36, 500, 500, 36, 500, 500, 500, 500, 54, 500, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39476125247878213, "mean_inference_ms": 1.2675741642140315, "mean_action_processing_ms": 0.1484083765608992, "mean_env_wait_ms": 0.08717623150895104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002666473388672, "StateBufferConnector_ms": 0.009998798370361328, "ViewRequirementAgentConnector_ms": 0.13301491737365723}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.575999999999816, "episode_len_mean": 254.86, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, 46.3, 43.30000000000001, 45.7, 44.900000000000006, 44.10000000000001, 46.099999999999994, 41.70000000000002, 39.300000000000026, 45.5, 38.10000000000002, 45.7, 46.3, 47.1, 41.90000000000001, -50.00000000000044, 34.70000000000004, 15.099999999999774, 47.3, -50.00000000000044, -50.00000000000044, 37.300000000000026, 43.50000000000001, 46.9, 10.499999999999709, 34.900000000000034, 37.300000000000026, 43.30000000000001, 37.10000000000003, 40.90000000000002, 46.5, -50.00000000000044, 45.1, 20.49999999999985, 44.300000000000004, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 26.499999999999936, 31.1, 15.699999999999783, -50.00000000000044, 45.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 47.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 45.5, 45.9, 37.70000000000003, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.90000000000001, 4.499999999999623, 45.9, 10.899999999999714, 47.3, 46.5, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.1], "episode_lengths": [46, 500, 500, 500, 500, 474, 500, 500, 38, 68, 44, 52, 60, 40, 84, 108, 46, 120, 44, 38, 30, 82, 500, 154, 350, 28, 500, 500, 128, 66, 32, 396, 152, 128, 68, 130, 92, 36, 500, 50, 296, 58, 58, 58, 500, 500, 236, 190, 344, 500, 46, 500, 66, 500, 500, 500, 28, 52, 500, 500, 500, 116, 500, 26, 500, 80, 500, 52, 42, 500, 46, 42, 124, 500, 38, 500, 44, 44, 500, 500, 500, 500, 40, 82, 456, 42, 392, 28, 36, 500, 500, 36, 500, 500, 500, 500, 54, 500, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39476125247878213, "mean_inference_ms": 1.2675741642140315, "mean_action_processing_ms": 0.1484083765608992, "mean_env_wait_ms": 0.08717623150895104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002666473388672, "StateBufferConnector_ms": 0.009998798370361328, "ViewRequirementAgentConnector_ms": 0.13301491737365723}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4765.668464509541, "num_env_steps_trained_throughput_per_sec": 4765.668464509541, "timesteps_total": 1422000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1422000, "timers": {"training_iteration_time_ms": 3706.207, "sample_time_ms": 3202.303, "load_time_ms": 19.3, "load_throughput": 932659.391, "learn_time_ms": 471.402, "learn_throughput": 38183.984, "synch_weights_time_ms": 10.701}, "counters": {"num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "done": false, "episodes_total": 5395, "training_iteration": 79, "trial_id": "9f288_00013", "date": "2023-10-25_16-41-12", "timestamp": 1698248472, "time_this_iter_s": 3.785001277923584, "time_total_s": 278.22092723846436, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 278.22092723846436, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 67.72, "ram_util_percent": 27.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121095e-25, "cur_lr": 0.0003, "total_loss": 6.706377209557427, "policy_loss": -0.00018426469630665248, "vf_loss": 6.706611230638292, "vf_explained_var": 0.004474303457472059, "kl": 0.0008835881252379194, "entropy": 0.497084030840132, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3578.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.563999999999856, "episode_len_mean": 215.04, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 39.70000000000002, 46.5, 45.5, 47.3, -50.00000000000044, 42.70000000000001, 13.899999999999757, -50.00000000000044, 45.9, 45.1, 46.5, 44.7, 43.900000000000006, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 47.3, -50.00000000000044, 45.9, -50.00000000000044, 14.499999999999766, 40.90000000000002, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, 44.300000000000004, 46.3, -50.00000000000044, 39.90000000000002, 43.10000000000001, 34.30000000000004, 42.900000000000006, 46.9, 46.099999999999994, 45.1, 42.30000000000001, 46.099999999999994, 45.1, 46.9, 43.7, 47.5, 46.3, -50.00000000000044, 47.3, 45.3, -50.00000000000044, 43.30000000000001, 41.100000000000016, 45.3, -50.00000000000044, 41.70000000000002, 34.30000000000004, 30.499999999999993, 45.9, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.900000000000006, 45.7, 45.9, 30.099999999999987, 42.30000000000001, 44.300000000000004, -50.00000000000044, 46.9, 45.3, -50.00000000000044, 8.899999999999686, -50.00000000000044, 44.10000000000001, 46.5, 34.50000000000004, 46.5, -50.00000000000044, 44.7, 45.1, 31.70000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.1], "episode_lengths": [500, 36, 500, 500, 500, 500, 54, 500, 500, 50, 500, 104, 36, 46, 28, 500, 74, 362, 500, 42, 50, 36, 54, 62, 500, 40, 500, 500, 166, 500, 28, 500, 42, 500, 356, 92, 42, 500, 40, 500, 54, 500, 58, 38, 500, 102, 70, 158, 72, 32, 40, 50, 78, 40, 50, 32, 64, 26, 38, 500, 28, 48, 500, 68, 90, 48, 500, 84, 158, 196, 42, 500, 84, 500, 62, 44, 42, 200, 78, 58, 500, 32, 48, 500, 412, 500, 60, 36, 156, 36, 500, 54, 50, 184, 162, 500, 500, 52, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39540331139033535, "mean_inference_ms": 1.2699187416824558, "mean_action_processing_ms": 0.14894260196732817, "mean_env_wait_ms": 0.08732279541740119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024997234344482422, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.16100835800170898}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.563999999999856, "episode_len_mean": 215.04, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 39.70000000000002, 46.5, 45.5, 47.3, -50.00000000000044, 42.70000000000001, 13.899999999999757, -50.00000000000044, 45.9, 45.1, 46.5, 44.7, 43.900000000000006, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 47.3, -50.00000000000044, 45.9, -50.00000000000044, 14.499999999999766, 40.90000000000002, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, 44.300000000000004, 46.3, -50.00000000000044, 39.90000000000002, 43.10000000000001, 34.30000000000004, 42.900000000000006, 46.9, 46.099999999999994, 45.1, 42.30000000000001, 46.099999999999994, 45.1, 46.9, 43.7, 47.5, 46.3, -50.00000000000044, 47.3, 45.3, -50.00000000000044, 43.30000000000001, 41.100000000000016, 45.3, -50.00000000000044, 41.70000000000002, 34.30000000000004, 30.499999999999993, 45.9, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.900000000000006, 45.7, 45.9, 30.099999999999987, 42.30000000000001, 44.300000000000004, -50.00000000000044, 46.9, 45.3, -50.00000000000044, 8.899999999999686, -50.00000000000044, 44.10000000000001, 46.5, 34.50000000000004, 46.5, -50.00000000000044, 44.7, 45.1, 31.70000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.1], "episode_lengths": [500, 36, 500, 500, 500, 500, 54, 500, 500, 50, 500, 104, 36, 46, 28, 500, 74, 362, 500, 42, 50, 36, 54, 62, 500, 40, 500, 500, 166, 500, 28, 500, 42, 500, 356, 92, 42, 500, 40, 500, 54, 500, 58, 38, 500, 102, 70, 158, 72, 32, 40, 50, 78, 40, 50, 32, 64, 26, 38, 500, 28, 48, 500, 68, 90, 48, 500, 84, 158, 196, 42, 500, 84, 500, 62, 44, 42, 200, 78, 58, 500, 32, 48, 500, 412, 500, 60, 36, 156, 36, 500, 54, 50, 184, 162, 500, 500, 52, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39540331139033535, "mean_inference_ms": 1.2699187416824558, "mean_action_processing_ms": 0.14894260196732817, "mean_env_wait_ms": 0.08732279541740119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024997234344482422, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.16100835800170898}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4514.674588999863, "num_env_steps_trained_throughput_per_sec": 4514.674588999863, "timesteps_total": 1440000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 3737.807, "sample_time_ms": 3229.902, "load_time_ms": 19.0, "load_throughput": 947366.947, "learn_time_ms": 475.602, "learn_throughput": 37846.782, "synch_weights_time_ms": 10.801}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5485, "training_iteration": 80, "trial_id": "9f288_00013", "date": "2023-10-25_16-41-16", "timestamp": 1698248476, "time_this_iter_s": 3.992994785308838, "time_total_s": 282.2139220237732, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 282.2139220237732, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 73.42, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060548e-25, "cur_lr": 0.0003, "total_loss": 5.759860441419813, "policy_loss": -0.0003640716274579366, "vf_loss": 5.760270955827501, "vf_explained_var": 0.008783580197228327, "kl": 0.0013050348085695558, "entropy": 0.46407265994283886, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3623.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.0539999999998235, "episode_len_mean": 250.06, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 41.100000000000016, 45.3, -50.00000000000044, 41.70000000000002, 34.30000000000004, 30.499999999999993, 45.9, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.900000000000006, 45.7, 45.9, 30.099999999999987, 42.30000000000001, 44.300000000000004, -50.00000000000044, 46.9, 45.3, -50.00000000000044, 8.899999999999686, -50.00000000000044, 44.10000000000001, 46.5, 34.50000000000004, 46.5, -50.00000000000044, 44.7, 45.1, 31.70000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 45.3, 38.700000000000024, -50.00000000000044, 44.900000000000006, 46.5, 36.30000000000003, -50.00000000000044, 41.90000000000001, 46.9, -50.00000000000044, 42.10000000000001, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.9, 41.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 30.099999999999987, 42.10000000000001, 39.50000000000002, -50.00000000000044, 44.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.5, 47.3, -50.00000000000044, 38.90000000000002, 44.5, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 46.5, -50.00000000000044, 40.10000000000002, 45.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007], "episode_lengths": [500, 68, 90, 48, 500, 84, 158, 196, 42, 500, 84, 500, 62, 44, 42, 200, 78, 58, 500, 32, 48, 500, 412, 500, 60, 36, 156, 36, 500, 54, 50, 184, 162, 500, 500, 52, 500, 50, 500, 500, 68, 500, 500, 42, 48, 114, 500, 52, 36, 138, 500, 82, 32, 500, 80, 122, 500, 500, 54, 500, 42, 86, 42, 500, 500, 500, 500, 500, 500, 98, 200, 80, 106, 500, 52, 54, 500, 500, 500, 26, 46, 28, 500, 112, 56, 54, 500, 500, 38, 36, 500, 100, 46, 64, 500, 500, 500, 500, 500, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3956665991090825, "mean_inference_ms": 1.2717328096464289, "mean_action_processing_ms": 0.14905755729163883, "mean_env_wait_ms": 0.08769620173974314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025003671646118164, "StateBufferConnector_ms": 0.005002498626708984, "ViewRequirementAgentConnector_ms": 0.12699675559997559}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.0539999999998235, "episode_len_mean": 250.06, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 41.100000000000016, 45.3, -50.00000000000044, 41.70000000000002, 34.30000000000004, 30.499999999999993, 45.9, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.900000000000006, 45.7, 45.9, 30.099999999999987, 42.30000000000001, 44.300000000000004, -50.00000000000044, 46.9, 45.3, -50.00000000000044, 8.899999999999686, -50.00000000000044, 44.10000000000001, 46.5, 34.50000000000004, 46.5, -50.00000000000044, 44.7, 45.1, 31.70000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 45.3, 38.700000000000024, -50.00000000000044, 44.900000000000006, 46.5, 36.30000000000003, -50.00000000000044, 41.90000000000001, 46.9, -50.00000000000044, 42.10000000000001, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.9, 41.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 30.099999999999987, 42.10000000000001, 39.50000000000002, -50.00000000000044, 44.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.5, 47.3, -50.00000000000044, 38.90000000000002, 44.5, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 46.5, -50.00000000000044, 40.10000000000002, 45.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007], "episode_lengths": [500, 68, 90, 48, 500, 84, 158, 196, 42, 500, 84, 500, 62, 44, 42, 200, 78, 58, 500, 32, 48, 500, 412, 500, 60, 36, 156, 36, 500, 54, 50, 184, 162, 500, 500, 52, 500, 50, 500, 500, 68, 500, 500, 42, 48, 114, 500, 52, 36, 138, 500, 82, 32, 500, 80, 122, 500, 500, 54, 500, 42, 86, 42, 500, 500, 500, 500, 500, 500, 98, 200, 80, 106, 500, 52, 54, 500, 500, 500, 26, 46, 28, 500, 112, 56, 54, 500, 500, 38, 36, 500, 100, 46, 64, 500, 500, 500, 500, 500, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3956665991090825, "mean_inference_ms": 1.2717328096464289, "mean_action_processing_ms": 0.14905755729163883, "mean_env_wait_ms": 0.08769620173974314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025003671646118164, "StateBufferConnector_ms": 0.005002498626708984, "ViewRequirementAgentConnector_ms": 0.12699675559997559}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4538.442496248596, "num_env_steps_trained_throughput_per_sec": 4538.442496248596, "timesteps_total": 1458000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1458000, "timers": {"training_iteration_time_ms": 3766.019, "sample_time_ms": 3245.502, "load_time_ms": 19.8, "load_throughput": 909098.782, "learn_time_ms": 487.5, "learn_throughput": 36923.09, "synch_weights_time_ms": 10.915}, "counters": {"num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "done": false, "episodes_total": 5547, "training_iteration": 81, "trial_id": "9f288_00013", "date": "2023-10-25_16-41-20", "timestamp": 1698248480, "time_this_iter_s": 3.9721181392669678, "time_total_s": 286.18604016304016, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 286.18604016304016, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 64.76666666666667, "ram_util_percent": 27.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530274e-26, "cur_lr": 0.0003, "total_loss": 6.598898421393501, "policy_loss": -0.0005775649514463213, "vf_loss": 6.59952449798584, "vf_explained_var": -0.016659882333543565, "kl": 0.0007747010575599233, "entropy": 0.4857412874698639, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3668.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.088999999999833, "episode_len_mean": 234.74, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 46.5, -50.00000000000044, 40.10000000000002, 45.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 46.5, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.3, 43.900000000000006, -50.00000000000044, 43.7, 44.900000000000006, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 47.1, 42.900000000000006, 29.69999999999998, 39.70000000000002, 44.900000000000006, -50.00000000000044, 41.30000000000001, 46.099999999999994, 45.9, 44.10000000000001, 40.10000000000002, 46.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 18.099999999999817, 40.70000000000002, 44.900000000000006, -50.00000000000044, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 29.899999999999984, 45.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, 47.9, -50.00000000000044, 47.3, 46.5, 47.5, 46.3, 46.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 6.099999999999646, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, 47.3, 30.099999999999987, 44.900000000000006, 45.5, 46.3, 47.1, 43.50000000000001, 43.900000000000006, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, 44.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.7], "episode_lengths": [56, 54, 500, 500, 38, 36, 500, 100, 46, 64, 500, 500, 500, 500, 500, 186, 500, 36, 114, 500, 500, 500, 38, 48, 62, 500, 64, 52, 50, 34, 500, 500, 284, 500, 30, 72, 204, 104, 52, 500, 88, 40, 42, 60, 100, 32, 500, 52, 500, 320, 94, 52, 500, 38, 42, 500, 500, 38, 500, 202, 44, 500, 60, 500, 48, 22, 500, 28, 36, 26, 38, 36, 500, 500, 78, 500, 440, 500, 52, 48, 500, 28, 200, 52, 46, 38, 30, 66, 62, 500, 70, 500, 500, 178, 54, 500, 500, 116, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3969860751478453, "mean_inference_ms": 1.273087742444888, "mean_action_processing_ms": 0.14882213397267693, "mean_env_wait_ms": 0.08815997269728922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031996965408325195, "StateBufferConnector_ms": 0.007012605667114258, "ViewRequirementAgentConnector_ms": 0.14612102508544922}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.088999999999833, "episode_len_mean": 234.74, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 46.5, -50.00000000000044, 40.10000000000002, 45.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 46.5, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.3, 43.900000000000006, -50.00000000000044, 43.7, 44.900000000000006, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 47.1, 42.900000000000006, 29.69999999999998, 39.70000000000002, 44.900000000000006, -50.00000000000044, 41.30000000000001, 46.099999999999994, 45.9, 44.10000000000001, 40.10000000000002, 46.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 18.099999999999817, 40.70000000000002, 44.900000000000006, -50.00000000000044, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 29.899999999999984, 45.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, 47.9, -50.00000000000044, 47.3, 46.5, 47.5, 46.3, 46.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 6.099999999999646, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, 47.3, 30.099999999999987, 44.900000000000006, 45.5, 46.3, 47.1, 43.50000000000001, 43.900000000000006, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, 44.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.7], "episode_lengths": [56, 54, 500, 500, 38, 36, 500, 100, 46, 64, 500, 500, 500, 500, 500, 186, 500, 36, 114, 500, 500, 500, 38, 48, 62, 500, 64, 52, 50, 34, 500, 500, 284, 500, 30, 72, 204, 104, 52, 500, 88, 40, 42, 60, 100, 32, 500, 52, 500, 320, 94, 52, 500, 38, 42, 500, 500, 38, 500, 202, 44, 500, 60, 500, 48, 22, 500, 28, 36, 26, 38, 36, 500, 500, 78, 500, 440, 500, 52, 48, 500, 28, 200, 52, 46, 38, 30, 66, 62, 500, 70, 500, 500, 178, 54, 500, 500, 116, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3969860751478453, "mean_inference_ms": 1.273087742444888, "mean_action_processing_ms": 0.14882213397267693, "mean_env_wait_ms": 0.08815997269728922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031996965408325195, "StateBufferConnector_ms": 0.007012605667114258, "ViewRequirementAgentConnector_ms": 0.14612102508544922}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4749.975683085104, "num_env_steps_trained_throughput_per_sec": 4749.975683085104, "timesteps_total": 1476000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 3775.068, "sample_time_ms": 3249.495, "load_time_ms": 21.599, "load_throughput": 833354.181, "learn_time_ms": 490.418, "learn_throughput": 36703.355, "synch_weights_time_ms": 11.115}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5631, "training_iteration": 82, "trial_id": "9f288_00013", "date": "2023-10-25_16-41-24", "timestamp": 1698248484, "time_this_iter_s": 3.796478033065796, "time_total_s": 289.98251819610596, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 289.98251819610596, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 70.32000000000001, "ram_util_percent": 27.080000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765137e-26, "cur_lr": 0.0003, "total_loss": 6.668712690141466, "policy_loss": -0.00022964694847663243, "vf_loss": 6.668989870283339, "vf_explained_var": 0.006453190909491645, "kl": 0.0007519758167240474, "entropy": 0.47412086062961156, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3713.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.147999999999831, "episode_len_mean": 249.16, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 47.5, 46.3, 46.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 6.099999999999646, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, 47.3, 30.099999999999987, 44.900000000000006, 45.5, 46.3, 47.1, 43.50000000000001, 43.900000000000006, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, 44.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.7, -50.00000000000044, 43.50000000000001, 45.3, -50.00000000000044, 29.69999999999998, 23.29999999999989, -50.00000000000044, 44.900000000000006, 47.1, 19.499999999999837, 45.3, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.7, 45.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 27.899999999999956, 26.69999999999994, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 47.1, 34.50000000000004, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 28.09999999999996, -50.00000000000044, 31.70000000000001, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 45.1, 25.699999999999925, 31.300000000000004, 43.50000000000001, 39.90000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 43.10000000000001, 25.899999999999928, 41.30000000000001, 13.099999999999746, 38.10000000000002, 45.5, 46.099999999999994, 40.30000000000002, -50.00000000000044, 39.300000000000026, 43.10000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 40.500000000000014], "episode_lengths": [36, 26, 38, 36, 500, 500, 78, 500, 440, 500, 52, 48, 500, 28, 200, 52, 46, 38, 30, 66, 62, 500, 70, 500, 500, 178, 54, 500, 500, 116, 500, 54, 500, 66, 48, 500, 204, 268, 500, 52, 30, 306, 48, 500, 66, 500, 44, 42, 500, 68, 500, 500, 222, 234, 44, 42, 500, 500, 30, 156, 500, 500, 230, 500, 220, 500, 184, 500, 226, 500, 500, 50, 244, 188, 66, 102, 500, 68, 500, 500, 44, 38, 70, 242, 88, 370, 120, 46, 40, 98, 500, 108, 70, 126, 500, 500, 500, 500, 64, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3967398091576878, "mean_inference_ms": 1.2742189730257178, "mean_action_processing_ms": 0.1487798326040162, "mean_env_wait_ms": 0.08801258944702921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599787712097168, "StateBufferConnector_ms": 0.0050127506256103516, "ViewRequirementAgentConnector_ms": 0.1267714500427246}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.147999999999831, "episode_len_mean": 249.16, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 47.5, 46.3, 46.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 6.099999999999646, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, 47.3, 30.099999999999987, 44.900000000000006, 45.5, 46.3, 47.1, 43.50000000000001, 43.900000000000006, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, 44.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.7, -50.00000000000044, 43.50000000000001, 45.3, -50.00000000000044, 29.69999999999998, 23.29999999999989, -50.00000000000044, 44.900000000000006, 47.1, 19.499999999999837, 45.3, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.7, 45.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 27.899999999999956, 26.69999999999994, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 47.1, 34.50000000000004, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 28.09999999999996, -50.00000000000044, 31.70000000000001, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 45.1, 25.699999999999925, 31.300000000000004, 43.50000000000001, 39.90000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 43.10000000000001, 25.899999999999928, 41.30000000000001, 13.099999999999746, 38.10000000000002, 45.5, 46.099999999999994, 40.30000000000002, -50.00000000000044, 39.300000000000026, 43.10000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 40.500000000000014], "episode_lengths": [36, 26, 38, 36, 500, 500, 78, 500, 440, 500, 52, 48, 500, 28, 200, 52, 46, 38, 30, 66, 62, 500, 70, 500, 500, 178, 54, 500, 500, 116, 500, 54, 500, 66, 48, 500, 204, 268, 500, 52, 30, 306, 48, 500, 66, 500, 44, 42, 500, 68, 500, 500, 222, 234, 44, 42, 500, 500, 30, 156, 500, 500, 230, 500, 220, 500, 184, 500, 226, 500, 500, 50, 244, 188, 66, 102, 500, 68, 500, 500, 44, 38, 70, 242, 88, 370, 120, 46, 40, 98, 500, 108, 70, 126, 500, 500, 500, 500, 64, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3967398091576878, "mean_inference_ms": 1.2742189730257178, "mean_action_processing_ms": 0.1487798326040162, "mean_env_wait_ms": 0.08801258944702921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599787712097168, "StateBufferConnector_ms": 0.0050127506256103516, "ViewRequirementAgentConnector_ms": 0.1267714500427246}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5098.293459629382, "num_env_steps_trained_throughput_per_sec": 5098.293459629382, "timesteps_total": 1494000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1494000, "timers": {"training_iteration_time_ms": 3761.723, "sample_time_ms": 3225.936, "load_time_ms": 20.48, "load_throughput": 878913.882, "learn_time_ms": 501.397, "learn_throughput": 35899.7, "synch_weights_time_ms": 11.269}, "counters": {"num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "done": false, "episodes_total": 5699, "training_iteration": 83, "trial_id": "9f288_00013", "date": "2023-10-25_16-41-27", "timestamp": 1698248487, "time_this_iter_s": 3.5355913639068604, "time_total_s": 293.5181095600128, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 293.5181095600128, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 62.36, "ram_util_percent": 27.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825684e-26, "cur_lr": 0.0003, "total_loss": 6.711627769470215, "policy_loss": -0.00029729406038920083, "vf_loss": 6.711975002288819, "vf_explained_var": 0.004714247915479872, "kl": 0.0012480534321487843, "entropy": 0.4986620465914408, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3758.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.381999999999836, "episode_len_mean": 246.84, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 25.699999999999925, 31.300000000000004, 43.50000000000001, 39.90000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 43.10000000000001, 25.899999999999928, 41.30000000000001, 13.099999999999746, 38.10000000000002, 45.5, 46.099999999999994, 40.30000000000002, -50.00000000000044, 39.300000000000026, 43.10000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 19.09999999999983, 42.70000000000001, 43.50000000000001, 45.9, 46.3, 32.100000000000016, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.1, -50.00000000000044, 46.9, 41.70000000000002, 41.90000000000001, 43.10000000000001, 40.90000000000002, 17.099999999999802, 46.699999999999996, 34.10000000000004, 46.9, 46.699999999999996, 27.099999999999945, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, 44.10000000000001, 45.1, 40.90000000000002, -50.00000000000044, 43.50000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.5, 44.10000000000001, 36.50000000000003, 6.099999999999646, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, 33.90000000000004, 43.10000000000001, 2.299999999999592, 22.899999999999885, 38.90000000000002, 43.10000000000001, 32.50000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [50, 244, 188, 66, 102, 500, 68, 500, 500, 44, 38, 70, 242, 88, 370, 120, 46, 40, 98, 500, 108, 70, 126, 500, 500, 500, 500, 64, 96, 500, 500, 34, 34, 500, 256, 500, 500, 500, 78, 310, 74, 66, 42, 38, 180, 500, 84, 500, 500, 500, 72, 50, 500, 32, 84, 82, 70, 92, 330, 34, 160, 32, 34, 230, 500, 500, 266, 500, 60, 50, 92, 500, 66, 34, 500, 500, 100, 500, 500, 500, 58, 500, 26, 60, 136, 440, 500, 46, 500, 500, 74, 162, 70, 478, 272, 112, 70, 176, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3963010156375438, "mean_inference_ms": 1.2744717069069535, "mean_action_processing_ms": 0.149026622966896, "mean_env_wait_ms": 0.0879205312085973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500128746032715, "StateBufferConnector_ms": 0.006996870040893555, "ViewRequirementAgentConnector_ms": 0.13294100761413574}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.381999999999836, "episode_len_mean": 246.84, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 25.699999999999925, 31.300000000000004, 43.50000000000001, 39.90000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 43.10000000000001, 25.899999999999928, 41.30000000000001, 13.099999999999746, 38.10000000000002, 45.5, 46.099999999999994, 40.30000000000002, -50.00000000000044, 39.300000000000026, 43.10000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 19.09999999999983, 42.70000000000001, 43.50000000000001, 45.9, 46.3, 32.100000000000016, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.1, -50.00000000000044, 46.9, 41.70000000000002, 41.90000000000001, 43.10000000000001, 40.90000000000002, 17.099999999999802, 46.699999999999996, 34.10000000000004, 46.9, 46.699999999999996, 27.099999999999945, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, 44.10000000000001, 45.1, 40.90000000000002, -50.00000000000044, 43.50000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.5, 44.10000000000001, 36.50000000000003, 6.099999999999646, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, 33.90000000000004, 43.10000000000001, 2.299999999999592, 22.899999999999885, 38.90000000000002, 43.10000000000001, 32.50000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [50, 244, 188, 66, 102, 500, 68, 500, 500, 44, 38, 70, 242, 88, 370, 120, 46, 40, 98, 500, 108, 70, 126, 500, 500, 500, 500, 64, 96, 500, 500, 34, 34, 500, 256, 500, 500, 500, 78, 310, 74, 66, 42, 38, 180, 500, 84, 500, 500, 500, 72, 50, 500, 32, 84, 82, 70, 92, 330, 34, 160, 32, 34, 230, 500, 500, 266, 500, 60, 50, 92, 500, 66, 34, 500, 500, 100, 500, 500, 500, 58, 500, 26, 60, 136, 440, 500, 46, 500, 500, 74, 162, 70, 478, 272, 112, 70, 176, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3963010156375438, "mean_inference_ms": 1.2744717069069535, "mean_action_processing_ms": 0.149026622966896, "mean_env_wait_ms": 0.0879205312085973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500128746032715, "StateBufferConnector_ms": 0.006996870040893555, "ViewRequirementAgentConnector_ms": 0.13294100761413574}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4993.282784628137, "num_env_steps_trained_throughput_per_sec": 4993.282784628137, "timesteps_total": 1512000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 3753.908, "sample_time_ms": 3224.42, "load_time_ms": 21.08, "load_throughput": 853903.738, "learn_time_ms": 494.797, "learn_throughput": 36378.554, "synch_weights_time_ms": 10.87}, "counters": {"num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": true, "episodes_total": 5770, "training_iteration": 84, "trial_id": "9f288_00013", "date": "2023-10-25_16-41-31", "timestamp": 1698248491, "time_this_iter_s": 3.6108334064483643, "time_total_s": 297.1289429664612, "pid": 24928, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 297.1289429664612, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 62.06, "ram_util_percent": 27.26}}
