{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000007, "cur_lr": 0.0003, "total_loss": 9.39300085703532, "policy_loss": -0.0021060175572832425, "vf_loss": 9.394581604003907, "vf_explained_var": 0.00021436214447021485, "kl": 0.0029904389094410917, "entropy": 0.7283628741900127, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 35.900000000000034, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -29.75600000000035, "episode_len_mean": 437.84, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.899999999999856, 2.8999999999996007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 32.50000000000002, 23.699999999999896, 10.899999999999714, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 292, 472, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 142, 500, 500, 500, 500, 500, 208, 176, 264, 392, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36591484115554856, "mean_inference_ms": 1.1974024129556968, "mean_action_processing_ms": 0.13965799139215276, "mean_env_wait_ms": 0.07579841575660667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995399475097656, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09205150604248047}}, "episode_reward_max": 35.900000000000034, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -29.75600000000035, "episode_len_mean": 437.84, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.899999999999856, 2.8999999999996007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 32.50000000000002, 23.699999999999896, 10.899999999999714, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 292, 472, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 142, 500, 500, 500, 500, 500, 208, 176, 264, 392, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36591484115554856, "mean_inference_ms": 1.1974024129556968, "mean_action_processing_ms": 0.13965799139215276, "mean_env_wait_ms": 0.07579841575660667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995399475097656, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09205150604248047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5871.150602855155, "num_env_steps_trained_throughput_per_sec": 5871.150602855155, "timesteps_total": 12000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 2043.892, "sample_time_ms": 1925.383, "load_time_ms": 7.078, "load_throughput": 1695296.17, "learn_time_ms": 100.644, "learn_throughput": 119232.295, "synch_weights_time_ms": 9.789}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 25, "training_iteration": 1, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-24", "timestamp": 1698247584, "time_this_iter_s": 2.0478928089141846, "time_total_s": 2.0478928089141846, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 2.0478928089141846, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 58.70000000000001, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000003, "cur_lr": 0.0003, "total_loss": 9.14103577931722, "policy_loss": -0.002314168711503347, "vf_loss": 9.143112881978352, "vf_explained_var": 6.126165390014648e-05, "kl": 0.0030603772852979697, "entropy": 0.692106282711029, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 41.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -19.479245283019175, "episode_len_mean": 402.75471698113205, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.899999999999856, 2.8999999999996007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 32.50000000000002, 23.699999999999896, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 30.699999999999996, 24.299999999999905, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 22.299999999999876, 41.500000000000014, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 34.10000000000004, 18.899999999999828, -50.00000000000044, -50.00000000000044, 12.299999999999734, 9.099999999999689, -50.00000000000044, 34.900000000000034, -50.00000000000044, 29.299999999999976, 18.699999999999825], "episode_lengths": [500, 292, 472, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 142, 500, 500, 500, 500, 500, 208, 176, 264, 392, 500, 500, 500, 500, 102, 194, 258, 362, 500, 500, 500, 230, 500, 278, 86, 500, 456, 500, 500, 160, 312, 500, 500, 378, 410, 500, 152, 500, 208, 314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36624519877104533, "mean_inference_ms": 1.1930070081999113, "mean_action_processing_ms": 0.13727338175640802, "mean_env_wait_ms": 0.07532050104605147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022640768087135173, "StateBufferConnector_ms": 0.003774660938190964, "ViewRequirementAgentConnector_ms": 0.1321014368309165}}, "episode_reward_max": 41.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -19.479245283019175, "episode_len_mean": 402.75471698113205, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.899999999999856, 2.8999999999996007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 32.50000000000002, 23.699999999999896, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 30.699999999999996, 24.299999999999905, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 22.299999999999876, 41.500000000000014, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 34.10000000000004, 18.899999999999828, -50.00000000000044, -50.00000000000044, 12.299999999999734, 9.099999999999689, -50.00000000000044, 34.900000000000034, -50.00000000000044, 29.299999999999976, 18.699999999999825], "episode_lengths": [500, 292, 472, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 142, 500, 500, 500, 500, 500, 208, 176, 264, 392, 500, 500, 500, 500, 102, 194, 258, 362, 500, 500, 500, 230, 500, 278, 86, 500, 456, 500, 500, 160, 312, 500, 500, 378, 410, 500, 152, 500, 208, 314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36624519877104533, "mean_inference_ms": 1.1930070081999113, "mean_action_processing_ms": 0.13727338175640802, "mean_env_wait_ms": 0.07532050104605147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022640768087135173, "StateBufferConnector_ms": 0.003774660938190964, "ViewRequirementAgentConnector_ms": 0.1321014368309165}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6080.234725858405, "num_env_steps_trained_throughput_per_sec": 6080.234725858405, "timesteps_total": 24000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 2008.75, "sample_time_ms": 1889.085, "load_time_ms": 7.039, "load_throughput": 1704857.244, "learn_time_ms": 100.733, "learn_throughput": 119127.033, "synch_weights_time_ms": 10.395}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 53, "training_iteration": 2, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-26", "timestamp": 1698247586, "time_this_iter_s": 1.9776079654693604, "time_total_s": 4.025500774383545, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 4.025500774383545, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 60.133333333333326, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000002, "cur_lr": 0.0003, "total_loss": 8.883521461486817, "policy_loss": -0.0005851487318674723, "vf_loss": 8.884117380777996, "vf_explained_var": 3.147125244140625e-05, "kl": 0.0011785287808455298, "entropy": 0.6950778563817342, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 43.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -15.365909090909373, "episode_len_mean": 381.3863636363636, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.899999999999856, 2.8999999999996007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 32.50000000000002, 23.699999999999896, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 30.699999999999996, 24.299999999999905, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 22.299999999999876, 41.500000000000014, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 34.10000000000004, 18.899999999999828, -50.00000000000044, -50.00000000000044, 12.299999999999734, 9.099999999999689, -50.00000000000044, 34.900000000000034, -50.00000000000044, 29.299999999999976, 18.699999999999825, -50.00000000000044, 36.30000000000003, 29.899999999999984, -50.00000000000044, 33.500000000000036, 29.49999999999998, 35.70000000000003, 43.7, 34.70000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 31.70000000000001, 11.699999999999726, -50.00000000000044, 33.10000000000003, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 29.69999999999998], "episode_lengths": [500, 292, 472, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 142, 500, 500, 500, 500, 500, 208, 176, 264, 392, 500, 500, 500, 500, 102, 194, 258, 362, 500, 500, 500, 230, 500, 278, 86, 500, 456, 500, 500, 160, 312, 500, 500, 378, 410, 500, 152, 500, 208, 314, 500, 138, 202, 500, 166, 206, 144, 64, 154, 70, 500, 500, 124, 500, 96, 500, 500, 146, 500, 500, 500, 350, 500, 500, 500, 500, 184, 384, 500, 170, 500, 414, 500, 500, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3679942886315901, "mean_inference_ms": 1.1861679912129435, "mean_action_processing_ms": 0.13572503260623003, "mean_env_wait_ms": 0.07553895206572105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01818239688873291, "StateBufferConnector_ms": 0.00568411566994407, "ViewRequirementAgentConnector_ms": 0.11705403978174383}}, "episode_reward_max": 43.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -15.365909090909373, "episode_len_mean": 381.3863636363636, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.899999999999856, 2.8999999999996007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 32.50000000000002, 23.699999999999896, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 30.699999999999996, 24.299999999999905, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 22.299999999999876, 41.500000000000014, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 34.10000000000004, 18.899999999999828, -50.00000000000044, -50.00000000000044, 12.299999999999734, 9.099999999999689, -50.00000000000044, 34.900000000000034, -50.00000000000044, 29.299999999999976, 18.699999999999825, -50.00000000000044, 36.30000000000003, 29.899999999999984, -50.00000000000044, 33.500000000000036, 29.49999999999998, 35.70000000000003, 43.7, 34.70000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 31.70000000000001, 11.699999999999726, -50.00000000000044, 33.10000000000003, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 29.69999999999998], "episode_lengths": [500, 292, 472, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 142, 500, 500, 500, 500, 500, 208, 176, 264, 392, 500, 500, 500, 500, 102, 194, 258, 362, 500, 500, 500, 230, 500, 278, 86, 500, 456, 500, 500, 160, 312, 500, 500, 378, 410, 500, 152, 500, 208, 314, 500, 138, 202, 500, 166, 206, 144, 64, 154, 70, 500, 500, 124, 500, 96, 500, 500, 146, 500, 500, 500, 350, 500, 500, 500, 500, 184, 384, 500, 170, 500, 414, 500, 500, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3679942886315901, "mean_inference_ms": 1.1861679912129435, "mean_action_processing_ms": 0.13572503260623003, "mean_env_wait_ms": 0.07553895206572105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01818239688873291, "StateBufferConnector_ms": 0.00568411566994407, "ViewRequirementAgentConnector_ms": 0.11705403978174383}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5712.004554019744, "num_env_steps_trained_throughput_per_sec": 5712.004554019744, "timesteps_total": 36000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 2039.446, "sample_time_ms": 1874.943, "load_time_ms": 8.025, "load_throughput": 1495251.121, "learn_time_ms": 145.215, "learn_throughput": 82635.936, "synch_weights_time_ms": 9.93}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 88, "training_iteration": 3, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-28", "timestamp": 1698247588, "time_this_iter_s": 2.105837821960449, "time_total_s": 6.131338596343994, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.131338596343994, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 63.46666666666666, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.02500000000000001, "cur_lr": 0.0003, "total_loss": 8.976397514343262, "policy_loss": -0.0009078765287995338, "vf_loss": 8.977342859903972, "vf_explained_var": -3.0144055684407553e-05, "kl": 0.0011770371725636627, "entropy": 0.6676343441009521, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 43.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.2920000000002227, "episode_len_mean": 333.52, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.299999999999905, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 22.299999999999876, 41.500000000000014, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 34.10000000000004, 18.899999999999828, -50.00000000000044, -50.00000000000044, 12.299999999999734, 9.099999999999689, -50.00000000000044, 34.900000000000034, -50.00000000000044, 29.299999999999976, 18.699999999999825, -50.00000000000044, 36.30000000000003, 29.899999999999984, -50.00000000000044, 33.500000000000036, 29.49999999999998, 35.70000000000003, 43.7, 34.70000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 31.70000000000001, 11.699999999999726, -50.00000000000044, 33.10000000000003, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 21.699999999999868, 31.900000000000013, 31.300000000000004, 23.8999999999999, -50.00000000000044, 29.899999999999984, -50.00000000000044, 39.50000000000002, 26.09999999999993, 18.499999999999822, -50.00000000000044, -50.00000000000044, 33.10000000000003, 35.900000000000034, -50.00000000000044, 37.10000000000003, -50.00000000000044, 29.69999999999998, 7.899999999999672, 21.09999999999986, -50.00000000000044, 41.500000000000014, 42.30000000000001, 37.90000000000003, 40.90000000000002, 15.099999999999774, 10.699999999999712, 34.50000000000004, -50.00000000000044, 19.09999999999983, 40.30000000000002, 38.700000000000024, 33.500000000000036, 43.30000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 0.09999999999956088, 32.90000000000003, -50.00000000000044], "episode_lengths": [258, 362, 500, 500, 500, 230, 500, 278, 86, 500, 456, 500, 500, 160, 312, 500, 500, 378, 410, 500, 152, 500, 208, 314, 500, 138, 202, 500, 166, 206, 144, 64, 154, 70, 500, 500, 124, 500, 96, 500, 500, 146, 500, 500, 500, 350, 500, 500, 500, 500, 184, 384, 500, 170, 500, 414, 500, 500, 204, 500, 284, 182, 188, 262, 500, 202, 500, 106, 240, 316, 500, 500, 170, 142, 500, 130, 500, 204, 422, 290, 500, 86, 78, 122, 92, 350, 394, 156, 500, 310, 98, 114, 166, 68, 500, 188, 500, 500, 172, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36867739146848544, "mean_inference_ms": 1.1795569753386306, "mean_action_processing_ms": 0.1341215356047668, "mean_env_wait_ms": 0.07561116272497427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018001794815063477, "StateBufferConnector_ms": 0.006001472473144531, "ViewRequirementAgentConnector_ms": 0.1259932518005371}}, "episode_reward_max": 43.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.2920000000002227, "episode_len_mean": 333.52, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.299999999999905, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 22.299999999999876, 41.500000000000014, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 34.10000000000004, 18.899999999999828, -50.00000000000044, -50.00000000000044, 12.299999999999734, 9.099999999999689, -50.00000000000044, 34.900000000000034, -50.00000000000044, 29.299999999999976, 18.699999999999825, -50.00000000000044, 36.30000000000003, 29.899999999999984, -50.00000000000044, 33.500000000000036, 29.49999999999998, 35.70000000000003, 43.7, 34.70000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 31.70000000000001, 11.699999999999726, -50.00000000000044, 33.10000000000003, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 21.699999999999868, 31.900000000000013, 31.300000000000004, 23.8999999999999, -50.00000000000044, 29.899999999999984, -50.00000000000044, 39.50000000000002, 26.09999999999993, 18.499999999999822, -50.00000000000044, -50.00000000000044, 33.10000000000003, 35.900000000000034, -50.00000000000044, 37.10000000000003, -50.00000000000044, 29.69999999999998, 7.899999999999672, 21.09999999999986, -50.00000000000044, 41.500000000000014, 42.30000000000001, 37.90000000000003, 40.90000000000002, 15.099999999999774, 10.699999999999712, 34.50000000000004, -50.00000000000044, 19.09999999999983, 40.30000000000002, 38.700000000000024, 33.500000000000036, 43.30000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 0.09999999999956088, 32.90000000000003, -50.00000000000044], "episode_lengths": [258, 362, 500, 500, 500, 230, 500, 278, 86, 500, 456, 500, 500, 160, 312, 500, 500, 378, 410, 500, 152, 500, 208, 314, 500, 138, 202, 500, 166, 206, 144, 64, 154, 70, 500, 500, 124, 500, 96, 500, 500, 146, 500, 500, 500, 350, 500, 500, 500, 500, 184, 384, 500, 170, 500, 414, 500, 500, 204, 500, 284, 182, 188, 262, 500, 202, 500, 106, 240, 316, 500, 500, 170, 142, 500, 130, 500, 204, 422, 290, 500, 86, 78, 122, 92, 350, 394, 156, 500, 310, 98, 114, 166, 68, 500, 188, 500, 500, 172, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36867739146848544, "mean_inference_ms": 1.1795569753386306, "mean_action_processing_ms": 0.1341215356047668, "mean_env_wait_ms": 0.07561116272497427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018001794815063477, "StateBufferConnector_ms": 0.006001472473144531, "ViewRequirementAgentConnector_ms": 0.1259932518005371}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5489.475831664349, "num_env_steps_trained_throughput_per_sec": 5489.475831664349, "timesteps_total": 48000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 2076.085, "sample_time_ms": 1871.458, "load_time_ms": 10.519, "load_throughput": 1140835.097, "learn_time_ms": 182.912, "learn_throughput": 65605.45, "synch_weights_time_ms": 10.198}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 129, "training_iteration": 4, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-30", "timestamp": 1698247590, "time_this_iter_s": 2.191000461578369, "time_total_s": 8.322339057922363, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 8.322339057922363, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 57.20000000000001, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000004, "cur_lr": 0.0003, "total_loss": 8.916738764444988, "policy_loss": -0.0007711408038934072, "vf_loss": 8.917561594645182, "vf_explained_var": -1.037915547688802e-05, "kl": 0.001116501715675137, "entropy": 0.6561128973960877, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.7879999999998097, "episode_len_mean": 302.8, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 31.70000000000001, 11.699999999999726, -50.00000000000044, 33.10000000000003, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 21.699999999999868, 31.900000000000013, 31.300000000000004, 23.8999999999999, -50.00000000000044, 29.899999999999984, -50.00000000000044, 39.50000000000002, 26.09999999999993, 18.499999999999822, -50.00000000000044, -50.00000000000044, 33.10000000000003, 35.900000000000034, -50.00000000000044, 37.10000000000003, -50.00000000000044, 29.69999999999998, 7.899999999999672, 21.09999999999986, -50.00000000000044, 41.500000000000014, 42.30000000000001, 37.90000000000003, 40.90000000000002, 15.099999999999774, 10.699999999999712, 34.50000000000004, -50.00000000000044, 19.09999999999983, 40.30000000000002, 38.700000000000024, 33.500000000000036, 43.30000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 0.09999999999956088, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.29999999999972, 42.500000000000014, 24.499999999999908, 46.099999999999994, 37.70000000000003, 34.50000000000004, -50.00000000000044, 45.9, 45.9, 39.300000000000026, -50.00000000000044, 32.700000000000024, -50.00000000000044, 8.49999999999968, 22.299999999999876, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 19.899999999999842, 40.90000000000002, 22.299999999999876, 30.699999999999996, 35.900000000000034, -50.00000000000044, 20.49999999999985, 20.699999999999854, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 44.5, 23.29999999999989, 36.50000000000003, 22.49999999999988, 41.500000000000014, 40.10000000000002, 39.90000000000002, 15.099999999999774, 37.90000000000003, 36.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [350, 500, 500, 500, 500, 184, 384, 500, 170, 500, 414, 500, 500, 204, 500, 284, 182, 188, 262, 500, 202, 500, 106, 240, 316, 500, 500, 170, 142, 500, 130, 500, 204, 422, 290, 500, 86, 78, 122, 92, 350, 394, 156, 500, 310, 98, 114, 166, 68, 500, 188, 500, 500, 172, 500, 500, 500, 388, 76, 256, 40, 124, 156, 500, 42, 42, 108, 500, 174, 500, 416, 278, 500, 154, 500, 500, 302, 92, 278, 194, 142, 500, 296, 294, 500, 500, 496, 56, 268, 136, 276, 86, 100, 102, 350, 122, 136, 62, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37038445418713456, "mean_inference_ms": 1.1824388557836099, "mean_action_processing_ms": 0.1358111941824826, "mean_env_wait_ms": 0.07641948906269733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599501609802246, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.12801074981689453}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.7879999999998097, "episode_len_mean": 302.8, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 31.70000000000001, 11.699999999999726, -50.00000000000044, 33.10000000000003, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 21.699999999999868, 31.900000000000013, 31.300000000000004, 23.8999999999999, -50.00000000000044, 29.899999999999984, -50.00000000000044, 39.50000000000002, 26.09999999999993, 18.499999999999822, -50.00000000000044, -50.00000000000044, 33.10000000000003, 35.900000000000034, -50.00000000000044, 37.10000000000003, -50.00000000000044, 29.69999999999998, 7.899999999999672, 21.09999999999986, -50.00000000000044, 41.500000000000014, 42.30000000000001, 37.90000000000003, 40.90000000000002, 15.099999999999774, 10.699999999999712, 34.50000000000004, -50.00000000000044, 19.09999999999983, 40.30000000000002, 38.700000000000024, 33.500000000000036, 43.30000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 0.09999999999956088, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.29999999999972, 42.500000000000014, 24.499999999999908, 46.099999999999994, 37.70000000000003, 34.50000000000004, -50.00000000000044, 45.9, 45.9, 39.300000000000026, -50.00000000000044, 32.700000000000024, -50.00000000000044, 8.49999999999968, 22.299999999999876, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 19.899999999999842, 40.90000000000002, 22.299999999999876, 30.699999999999996, 35.900000000000034, -50.00000000000044, 20.49999999999985, 20.699999999999854, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 44.5, 23.29999999999989, 36.50000000000003, 22.49999999999988, 41.500000000000014, 40.10000000000002, 39.90000000000002, 15.099999999999774, 37.90000000000003, 36.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [350, 500, 500, 500, 500, 184, 384, 500, 170, 500, 414, 500, 500, 204, 500, 284, 182, 188, 262, 500, 202, 500, 106, 240, 316, 500, 500, 170, 142, 500, 130, 500, 204, 422, 290, 500, 86, 78, 122, 92, 350, 394, 156, 500, 310, 98, 114, 166, 68, 500, 188, 500, 500, 172, 500, 500, 500, 388, 76, 256, 40, 124, 156, 500, 42, 42, 108, 500, 174, 500, 416, 278, 500, 154, 500, 500, 302, 92, 278, 194, 142, 500, 296, 294, 500, 500, 496, 56, 268, 136, 276, 86, 100, 102, 350, 122, 136, 62, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37038445418713456, "mean_inference_ms": 1.1824388557836099, "mean_action_processing_ms": 0.1358111941824826, "mean_env_wait_ms": 0.07641948906269733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599501609802246, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.12801074981689453}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5708.218101910075, "num_env_steps_trained_throughput_per_sec": 5708.218101910075, "timesteps_total": 60000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 2081.314, "sample_time_ms": 1894.873, "load_time_ms": 9.815, "load_throughput": 1222639.045, "learn_time_ms": 165.67, "learn_throughput": 72433.103, "synch_weights_time_ms": 9.753}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 174, "training_iteration": 5, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-32", "timestamp": 1698247592, "time_this_iter_s": 2.107229471206665, "time_total_s": 10.429568529129028, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 10.429568529129028, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 60.79999999999999, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000002, "cur_lr": 0.0003, "total_loss": 8.789782905578614, "policy_loss": -0.00019772959252198536, "vf_loss": 8.790035565694174, "vf_explained_var": -4.7047932942708336e-06, "kl": 0.0006359454297429086, "entropy": 0.5892571846644084, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.39199999999984, "episode_len_mean": 266.78, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 0.09999999999956088, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.29999999999972, 42.500000000000014, 24.499999999999908, 46.099999999999994, 37.70000000000003, 34.50000000000004, -50.00000000000044, 45.9, 45.9, 39.300000000000026, -50.00000000000044, 32.700000000000024, -50.00000000000044, 8.49999999999968, 22.299999999999876, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 19.899999999999842, 40.90000000000002, 22.299999999999876, 30.699999999999996, 35.900000000000034, -50.00000000000044, 20.49999999999985, 20.699999999999854, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 44.5, 23.29999999999989, 36.50000000000003, 22.49999999999988, 41.500000000000014, 40.10000000000002, 39.90000000000002, 15.099999999999774, 37.90000000000003, 36.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991, 37.10000000000003, -50.00000000000044, 34.50000000000004, 41.70000000000002, 37.300000000000026, 38.90000000000002, 32.30000000000002, -50.00000000000044, 11.899999999999729, 35.900000000000034, 42.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 27.49999999999995, 40.70000000000002, 46.099999999999994, 44.300000000000004, -50.00000000000044, 14.09999999999976, 14.299999999999763, 33.70000000000004, 45.9, 42.30000000000001, 46.3, 42.10000000000001, 42.30000000000001, 44.7, -50.00000000000044, 37.90000000000003, 34.30000000000004, 46.9, 40.90000000000002, -50.00000000000044, 34.70000000000004, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 35.70000000000003, 38.700000000000024, 42.900000000000006, -50.00000000000044], "episode_lengths": [68, 500, 188, 500, 500, 172, 500, 500, 500, 388, 76, 256, 40, 124, 156, 500, 42, 42, 108, 500, 174, 500, 416, 278, 500, 154, 500, 500, 302, 92, 278, 194, 142, 500, 296, 294, 500, 500, 496, 56, 268, 136, 276, 86, 100, 102, 350, 122, 136, 62, 500, 500, 254, 130, 500, 156, 84, 128, 112, 178, 500, 382, 142, 78, 500, 38, 500, 226, 94, 40, 58, 500, 360, 358, 164, 42, 78, 38, 80, 78, 54, 500, 122, 158, 32, 92, 500, 154, 500, 344, 500, 500, 500, 500, 500, 124, 144, 114, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37329234025101415, "mean_inference_ms": 1.1911987210804675, "mean_action_processing_ms": 0.13775325636465074, "mean_env_wait_ms": 0.07753478819045152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03799724578857422, "StateBufferConnector_ms": 0.003000497817993164, "ViewRequirementAgentConnector_ms": 0.12500643730163574}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.39199999999984, "episode_len_mean": 266.78, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 0.09999999999956088, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.29999999999972, 42.500000000000014, 24.499999999999908, 46.099999999999994, 37.70000000000003, 34.50000000000004, -50.00000000000044, 45.9, 45.9, 39.300000000000026, -50.00000000000044, 32.700000000000024, -50.00000000000044, 8.49999999999968, 22.299999999999876, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 19.899999999999842, 40.90000000000002, 22.299999999999876, 30.699999999999996, 35.900000000000034, -50.00000000000044, 20.49999999999985, 20.699999999999854, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 44.5, 23.29999999999989, 36.50000000000003, 22.49999999999988, 41.500000000000014, 40.10000000000002, 39.90000000000002, 15.099999999999774, 37.90000000000003, 36.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991, 37.10000000000003, -50.00000000000044, 34.50000000000004, 41.70000000000002, 37.300000000000026, 38.90000000000002, 32.30000000000002, -50.00000000000044, 11.899999999999729, 35.900000000000034, 42.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 27.49999999999995, 40.70000000000002, 46.099999999999994, 44.300000000000004, -50.00000000000044, 14.09999999999976, 14.299999999999763, 33.70000000000004, 45.9, 42.30000000000001, 46.3, 42.10000000000001, 42.30000000000001, 44.7, -50.00000000000044, 37.90000000000003, 34.30000000000004, 46.9, 40.90000000000002, -50.00000000000044, 34.70000000000004, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 35.70000000000003, 38.700000000000024, 42.900000000000006, -50.00000000000044], "episode_lengths": [68, 500, 188, 500, 500, 172, 500, 500, 500, 388, 76, 256, 40, 124, 156, 500, 42, 42, 108, 500, 174, 500, 416, 278, 500, 154, 500, 500, 302, 92, 278, 194, 142, 500, 296, 294, 500, 500, 496, 56, 268, 136, 276, 86, 100, 102, 350, 122, 136, 62, 500, 500, 254, 130, 500, 156, 84, 128, 112, 178, 500, 382, 142, 78, 500, 38, 500, 226, 94, 40, 58, 500, 360, 358, 164, 42, 78, 38, 80, 78, 54, 500, 122, 158, 32, 92, 500, 154, 500, 344, 500, 500, 500, 500, 500, 124, 144, 114, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37329234025101415, "mean_inference_ms": 1.1911987210804675, "mean_action_processing_ms": 0.13775325636465074, "mean_env_wait_ms": 0.07753478819045152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03799724578857422, "StateBufferConnector_ms": 0.003000497817993164, "ViewRequirementAgentConnector_ms": 0.12500643730163574}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5553.35659789542, "num_env_steps_trained_throughput_per_sec": 5553.35659789542, "timesteps_total": 72000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 2094.571, "sample_time_ms": 1898.871, "load_time_ms": 9.845, "load_throughput": 1218841.368, "learn_time_ms": 175.058, "learn_throughput": 68548.536, "synch_weights_time_ms": 9.628}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 222, "training_iteration": 6, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-34", "timestamp": 1698247594, "time_this_iter_s": 2.1658546924591064, "time_total_s": 12.595423221588135, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 12.595423221588135, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 63.70000000000001, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003125000000000001, "cur_lr": 0.0003, "total_loss": 8.825304794311524, "policy_loss": -0.00023669074289500713, "vf_loss": 8.82559757232666, "vf_explained_var": -6.469090779622396e-06, "kl": 0.00035358058603378594, "entropy": 0.576451551914215, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.659999999999853, "episode_len_mean": 254.1, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991, 37.10000000000003, -50.00000000000044, 34.50000000000004, 41.70000000000002, 37.300000000000026, 38.90000000000002, 32.30000000000002, -50.00000000000044, 11.899999999999729, 35.900000000000034, 42.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 27.49999999999995, 40.70000000000002, 46.099999999999994, 44.300000000000004, -50.00000000000044, 14.09999999999976, 14.299999999999763, 33.70000000000004, 45.9, 42.30000000000001, 46.3, 42.10000000000001, 42.30000000000001, 44.7, -50.00000000000044, 37.90000000000003, 34.30000000000004, 46.9, 40.90000000000002, -50.00000000000044, 34.70000000000004, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 35.70000000000003, 38.700000000000024, 42.900000000000006, -50.00000000000044, 17.299999999999805, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 38.50000000000003, 23.499999999999893, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.30000000000001, 37.90000000000003, 46.3, 11.099999999999717, -50.00000000000044, 32.50000000000002, 41.90000000000001, 32.700000000000024, -50.00000000000044, 30.499999999999993, 34.30000000000004, -50.00000000000044, 34.30000000000004, 43.10000000000001, 25.499999999999922, 33.70000000000004, 39.90000000000002, 44.300000000000004, 37.10000000000003, 37.90000000000003, 9.8999999999997, 15.299999999999777, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 38.90000000000002, 40.70000000000002, -50.00000000000044, 19.09999999999983, 41.30000000000001, -50.00000000000044, 31.500000000000007, 32.50000000000002], "episode_lengths": [136, 62, 500, 500, 254, 130, 500, 156, 84, 128, 112, 178, 500, 382, 142, 78, 500, 38, 500, 226, 94, 40, 58, 500, 360, 358, 164, 42, 78, 38, 80, 78, 54, 500, 122, 158, 32, 92, 500, 154, 500, 344, 500, 500, 500, 500, 500, 124, 144, 114, 72, 500, 328, 500, 126, 500, 58, 500, 116, 266, 500, 64, 500, 68, 500, 78, 122, 38, 390, 500, 176, 82, 174, 500, 196, 158, 500, 158, 70, 246, 164, 102, 58, 130, 122, 402, 348, 246, 500, 500, 500, 52, 112, 94, 500, 310, 88, 500, 186, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37709547161387136, "mean_inference_ms": 1.2018782600730689, "mean_action_processing_ms": 0.1390331379073288, "mean_env_wait_ms": 0.07925524555180523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033003807067871094, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.12600469589233398}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.659999999999853, "episode_len_mean": 254.1, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991, 37.10000000000003, -50.00000000000044, 34.50000000000004, 41.70000000000002, 37.300000000000026, 38.90000000000002, 32.30000000000002, -50.00000000000044, 11.899999999999729, 35.900000000000034, 42.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 27.49999999999995, 40.70000000000002, 46.099999999999994, 44.300000000000004, -50.00000000000044, 14.09999999999976, 14.299999999999763, 33.70000000000004, 45.9, 42.30000000000001, 46.3, 42.10000000000001, 42.30000000000001, 44.7, -50.00000000000044, 37.90000000000003, 34.30000000000004, 46.9, 40.90000000000002, -50.00000000000044, 34.70000000000004, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 35.70000000000003, 38.700000000000024, 42.900000000000006, -50.00000000000044, 17.299999999999805, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 38.50000000000003, 23.499999999999893, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.30000000000001, 37.90000000000003, 46.3, 11.099999999999717, -50.00000000000044, 32.50000000000002, 41.90000000000001, 32.700000000000024, -50.00000000000044, 30.499999999999993, 34.30000000000004, -50.00000000000044, 34.30000000000004, 43.10000000000001, 25.499999999999922, 33.70000000000004, 39.90000000000002, 44.300000000000004, 37.10000000000003, 37.90000000000003, 9.8999999999997, 15.299999999999777, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 38.90000000000002, 40.70000000000002, -50.00000000000044, 19.09999999999983, 41.30000000000001, -50.00000000000044, 31.500000000000007, 32.50000000000002], "episode_lengths": [136, 62, 500, 500, 254, 130, 500, 156, 84, 128, 112, 178, 500, 382, 142, 78, 500, 38, 500, 226, 94, 40, 58, 500, 360, 358, 164, 42, 78, 38, 80, 78, 54, 500, 122, 158, 32, 92, 500, 154, 500, 344, 500, 500, 500, 500, 500, 124, 144, 114, 72, 500, 328, 500, 126, 500, 58, 500, 116, 266, 500, 64, 500, 68, 500, 78, 122, 38, 390, 500, 176, 82, 174, 500, 196, 158, 500, 158, 70, 246, 164, 102, 58, 130, 122, 402, 348, 246, 500, 500, 500, 52, 112, 94, 500, 310, 88, 500, 186, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37709547161387136, "mean_inference_ms": 1.2018782600730689, "mean_action_processing_ms": 0.1390331379073288, "mean_env_wait_ms": 0.07925524555180523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033003807067871094, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.12600469589233398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5095.543423481577, "num_env_steps_trained_throughput_per_sec": 5095.543423481577, "timesteps_total": 84000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 2131.775, "sample_time_ms": 1917.318, "load_time_ms": 10.725, "load_throughput": 1118932.192, "learn_time_ms": 192.907, "learn_throughput": 62206.066, "synch_weights_time_ms": 9.682}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 270, "training_iteration": 7, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-37", "timestamp": 1698247597, "time_this_iter_s": 2.3599979877471924, "time_total_s": 14.955421209335327, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 14.955421209335327, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 57.574999999999996, "ram_util_percent": 26.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000005, "cur_lr": 0.0003, "total_loss": 8.790145746866862, "policy_loss": -0.00033862839142481487, "vf_loss": 8.790543874104818, "vf_explained_var": 2.9961268107096354e-06, "kl": 0.0001513085715108294, "entropy": 0.5979188521703084, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.818999999999852, "episode_len_mean": 257.52, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 35.70000000000003, 38.700000000000024, 42.900000000000006, -50.00000000000044, 17.299999999999805, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 38.50000000000003, 23.499999999999893, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.30000000000001, 37.90000000000003, 46.3, 11.099999999999717, -50.00000000000044, 32.50000000000002, 41.90000000000001, 32.700000000000024, -50.00000000000044, 30.499999999999993, 34.30000000000004, -50.00000000000044, 34.30000000000004, 43.10000000000001, 25.499999999999922, 33.70000000000004, 39.90000000000002, 44.300000000000004, 37.10000000000003, 37.90000000000003, 9.8999999999997, 15.299999999999777, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 38.90000000000002, 40.70000000000002, -50.00000000000044, 19.09999999999983, 41.30000000000001, -50.00000000000044, 31.500000000000007, 32.50000000000002, 3.699999999999612, 20.49999999999985, 40.500000000000014, 27.49999999999995, 41.30000000000001, -50.00000000000044, 37.10000000000003, 37.90000000000003, -50.00000000000044, 36.10000000000004, 43.900000000000006, 43.10000000000001, -50.00000000000044, 29.099999999999973, 43.30000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.30000000000002, 16.499999999999794, 41.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, 27.899999999999956, 29.099999999999973, 20.899999999999856, 18.899999999999828, -50.00000000000044, 36.50000000000003, 42.70000000000001, 43.50000000000001, 41.90000000000001, 18.699999999999825, 39.10000000000002, 40.30000000000002, 12.69999999999974, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.7], "episode_lengths": [500, 500, 500, 124, 144, 114, 72, 500, 328, 500, 126, 500, 58, 500, 116, 266, 500, 64, 500, 68, 500, 78, 122, 38, 390, 500, 176, 82, 174, 500, 196, 158, 500, 158, 70, 246, 164, 102, 58, 130, 122, 402, 348, 246, 500, 500, 500, 52, 112, 94, 500, 310, 88, 500, 186, 176, 464, 296, 96, 226, 88, 500, 130, 122, 500, 140, 62, 70, 500, 210, 68, 500, 500, 136, 98, 336, 86, 54, 500, 500, 84, 500, 56, 222, 210, 292, 312, 500, 136, 74, 66, 82, 314, 110, 98, 374, 500, 118, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37791625644309507, "mean_inference_ms": 1.2066225991400903, "mean_action_processing_ms": 0.13979376858306916, "mean_env_wait_ms": 0.07949108747356165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023999691009521484, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.13499784469604492}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.818999999999852, "episode_len_mean": 257.52, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 35.70000000000003, 38.700000000000024, 42.900000000000006, -50.00000000000044, 17.299999999999805, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 38.50000000000003, 23.499999999999893, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.30000000000001, 37.90000000000003, 46.3, 11.099999999999717, -50.00000000000044, 32.50000000000002, 41.90000000000001, 32.700000000000024, -50.00000000000044, 30.499999999999993, 34.30000000000004, -50.00000000000044, 34.30000000000004, 43.10000000000001, 25.499999999999922, 33.70000000000004, 39.90000000000002, 44.300000000000004, 37.10000000000003, 37.90000000000003, 9.8999999999997, 15.299999999999777, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 38.90000000000002, 40.70000000000002, -50.00000000000044, 19.09999999999983, 41.30000000000001, -50.00000000000044, 31.500000000000007, 32.50000000000002, 3.699999999999612, 20.49999999999985, 40.500000000000014, 27.49999999999995, 41.30000000000001, -50.00000000000044, 37.10000000000003, 37.90000000000003, -50.00000000000044, 36.10000000000004, 43.900000000000006, 43.10000000000001, -50.00000000000044, 29.099999999999973, 43.30000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.30000000000002, 16.499999999999794, 41.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, 27.899999999999956, 29.099999999999973, 20.899999999999856, 18.899999999999828, -50.00000000000044, 36.50000000000003, 42.70000000000001, 43.50000000000001, 41.90000000000001, 18.699999999999825, 39.10000000000002, 40.30000000000002, 12.69999999999974, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.7], "episode_lengths": [500, 500, 500, 124, 144, 114, 72, 500, 328, 500, 126, 500, 58, 500, 116, 266, 500, 64, 500, 68, 500, 78, 122, 38, 390, 500, 176, 82, 174, 500, 196, 158, 500, 158, 70, 246, 164, 102, 58, 130, 122, 402, 348, 246, 500, 500, 500, 52, 112, 94, 500, 310, 88, 500, 186, 176, 464, 296, 96, 226, 88, 500, 130, 122, 500, 140, 62, 70, 500, 210, 68, 500, 500, 136, 98, 336, 86, 54, 500, 500, 84, 500, 56, 222, 210, 292, 312, 500, 136, 74, 66, 82, 314, 110, 98, 374, 500, 118, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37791625644309507, "mean_inference_ms": 1.2066225991400903, "mean_action_processing_ms": 0.13979376858306916, "mean_env_wait_ms": 0.07949108747356165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023999691009521484, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.13499784469604492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5347.594819218327, "num_env_steps_trained_throughput_per_sec": 5347.594819218327, "timesteps_total": 96000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 2145.803, "sample_time_ms": 1910.528, "load_time_ms": 11.384, "load_throughput": 1054118.357, "learn_time_ms": 213.169, "learn_throughput": 56293.416, "synch_weights_time_ms": 9.597}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 314, "training_iteration": 8, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-39", "timestamp": 1698247599, "time_this_iter_s": 2.247999668121338, "time_total_s": 17.203420877456665, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 17.203420877456665, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 58.06666666666666, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000003, "cur_lr": 0.0003, "total_loss": 8.392853418986002, "policy_loss": -0.0004523900958398978, "vf_loss": 8.393363952636719, "vf_explained_var": 3.1987826029459634e-06, "kl": 0.0006678830690143892, "entropy": 0.5839693923791249, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 128.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.79699999999984, "episode_len_mean": 257.74, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 38.90000000000002, 40.70000000000002, -50.00000000000044, 19.09999999999983, 41.30000000000001, -50.00000000000044, 31.500000000000007, 32.50000000000002, 3.699999999999612, 20.49999999999985, 40.500000000000014, 27.49999999999995, 41.30000000000001, -50.00000000000044, 37.10000000000003, 37.90000000000003, -50.00000000000044, 36.10000000000004, 43.900000000000006, 43.10000000000001, -50.00000000000044, 29.099999999999973, 43.30000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.30000000000002, 16.499999999999794, 41.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, 27.899999999999956, 29.099999999999973, 20.899999999999856, 18.899999999999828, -50.00000000000044, 36.50000000000003, 42.70000000000001, 43.50000000000001, 41.90000000000001, 18.699999999999825, 39.10000000000002, 40.30000000000002, 12.69999999999974, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, 37.10000000000003, 39.300000000000026, -50.00000000000044, 33.70000000000004, 9.699999999999697, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.3, -50.00000000000044, 18.29999999999982, 3.2999999999996064, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 21.699999999999868, 3.2999999999996064, -50.00000000000044, 43.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 30.9, 40.70000000000002, 40.500000000000014, -50.00000000000044, 9.099999999999689, -50.00000000000044, 44.300000000000004, 44.7, 37.50000000000003, 42.70000000000001, 45.5, 41.90000000000001, 34.10000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 16.8999999999998, 25.899999999999928, 44.5, 43.30000000000001, 40.500000000000014], "episode_lengths": [52, 112, 94, 500, 310, 88, 500, 186, 176, 464, 296, 96, 226, 88, 500, 130, 122, 500, 140, 62, 70, 500, 210, 68, 500, 500, 136, 98, 336, 86, 54, 500, 500, 84, 500, 56, 222, 210, 292, 312, 500, 136, 74, 66, 82, 314, 110, 98, 374, 500, 118, 500, 64, 500, 130, 108, 500, 164, 404, 500, 500, 46, 500, 48, 500, 318, 468, 38, 500, 500, 500, 110, 284, 468, 500, 68, 52, 500, 500, 192, 94, 96, 500, 410, 500, 58, 54, 126, 74, 46, 82, 160, 500, 70, 500, 332, 242, 56, 68, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37861948089605674, "mean_inference_ms": 1.2127067717084807, "mean_action_processing_ms": 0.14031070291320194, "mean_env_wait_ms": 0.08046491480877367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023006439208984375, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.13402581214904785}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.79699999999984, "episode_len_mean": 257.74, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 38.90000000000002, 40.70000000000002, -50.00000000000044, 19.09999999999983, 41.30000000000001, -50.00000000000044, 31.500000000000007, 32.50000000000002, 3.699999999999612, 20.49999999999985, 40.500000000000014, 27.49999999999995, 41.30000000000001, -50.00000000000044, 37.10000000000003, 37.90000000000003, -50.00000000000044, 36.10000000000004, 43.900000000000006, 43.10000000000001, -50.00000000000044, 29.099999999999973, 43.30000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.30000000000002, 16.499999999999794, 41.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, 27.899999999999956, 29.099999999999973, 20.899999999999856, 18.899999999999828, -50.00000000000044, 36.50000000000003, 42.70000000000001, 43.50000000000001, 41.90000000000001, 18.699999999999825, 39.10000000000002, 40.30000000000002, 12.69999999999974, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, 37.10000000000003, 39.300000000000026, -50.00000000000044, 33.70000000000004, 9.699999999999697, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.3, -50.00000000000044, 18.29999999999982, 3.2999999999996064, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 21.699999999999868, 3.2999999999996064, -50.00000000000044, 43.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 30.9, 40.70000000000002, 40.500000000000014, -50.00000000000044, 9.099999999999689, -50.00000000000044, 44.300000000000004, 44.7, 37.50000000000003, 42.70000000000001, 45.5, 41.90000000000001, 34.10000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 16.8999999999998, 25.899999999999928, 44.5, 43.30000000000001, 40.500000000000014], "episode_lengths": [52, 112, 94, 500, 310, 88, 500, 186, 176, 464, 296, 96, 226, 88, 500, 130, 122, 500, 140, 62, 70, 500, 210, 68, 500, 500, 136, 98, 336, 86, 54, 500, 500, 84, 500, 56, 222, 210, 292, 312, 500, 136, 74, 66, 82, 314, 110, 98, 374, 500, 118, 500, 64, 500, 130, 108, 500, 164, 404, 500, 500, 46, 500, 48, 500, 318, 468, 38, 500, 500, 500, 110, 284, 468, 500, 68, 52, 500, 500, 192, 94, 96, 500, 410, 500, 58, 54, 126, 74, 46, 82, 160, 500, 70, 500, 332, 242, 56, 68, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37861948089605674, "mean_inference_ms": 1.2127067717084807, "mean_action_processing_ms": 0.14031070291320194, "mean_env_wait_ms": 0.08046491480877367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023006439208984375, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.13402581214904785}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5278.862043403348, "num_env_steps_trained_throughput_per_sec": 5278.862043403348, "timesteps_total": 108000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 2159.96, "sample_time_ms": 1926.136, "load_time_ms": 11.119, "load_throughput": 1079229.104, "learn_time_ms": 211.952, "learn_throughput": 56616.65, "synch_weights_time_ms": 9.642}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 361, "training_iteration": 9, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-41", "timestamp": 1698247601, "time_this_iter_s": 2.2782163619995117, "time_total_s": 19.481637239456177, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 19.481637239456177, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 65.56666666666666, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00039062500000000013, "cur_lr": 0.0003, "total_loss": 8.167830880482992, "policy_loss": -0.0002604871988296509, "vf_loss": 8.168144798278808, "vf_explained_var": -3.870328267415365e-06, "kl": 0.0006272961490897918, "entropy": 0.5373687545458475, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.713999999999832, "episode_len_mean": 263.54, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.699999999999825, 39.10000000000002, 40.30000000000002, 12.69999999999974, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, 37.10000000000003, 39.300000000000026, -50.00000000000044, 33.70000000000004, 9.699999999999697, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.3, -50.00000000000044, 18.29999999999982, 3.2999999999996064, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 21.699999999999868, 3.2999999999996064, -50.00000000000044, 43.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 30.9, 40.70000000000002, 40.500000000000014, -50.00000000000044, 9.099999999999689, -50.00000000000044, 44.300000000000004, 44.7, 37.50000000000003, 42.70000000000001, 45.5, 41.90000000000001, 34.10000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 16.8999999999998, 25.899999999999928, 44.5, 43.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.300000000000004, 47.7, -50.00000000000044, 40.30000000000002, 44.5, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 31.1, 39.10000000000002, -50.00000000000044, 47.1, 40.500000000000014, 28.699999999999967, 37.300000000000026, 34.50000000000004, -50.00000000000044, 41.100000000000016, -50.00000000000044, 39.300000000000026, 15.099999999999774, 20.49999999999985, -50.00000000000044, 43.7, 46.099999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, 17.299999999999805, 38.700000000000024, 14.499999999999766, 45.1, -50.00000000000044, -50.00000000000044, 38.300000000000026, 15.299999999999777, 43.30000000000001, 42.70000000000001, -50.00000000000044, 27.699999999999953, 40.500000000000014], "episode_lengths": [314, 110, 98, 374, 500, 118, 500, 64, 500, 130, 108, 500, 164, 404, 500, 500, 46, 500, 48, 500, 318, 468, 38, 500, 500, 500, 110, 284, 468, 500, 68, 52, 500, 500, 192, 94, 96, 500, 410, 500, 58, 54, 126, 74, 46, 82, 160, 500, 70, 500, 332, 242, 56, 68, 96, 500, 500, 140, 58, 24, 500, 98, 56, 62, 82, 500, 500, 190, 110, 500, 30, 96, 214, 128, 156, 500, 90, 500, 108, 350, 296, 500, 64, 40, 500, 146, 500, 328, 114, 356, 50, 500, 500, 118, 348, 68, 74, 500, 224, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.380105632386981, "mean_inference_ms": 1.220435176079371, "mean_action_processing_ms": 0.1414893957965829, "mean_env_wait_ms": 0.08181945263026384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299880027770996, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.13522911071777344}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.713999999999832, "episode_len_mean": 263.54, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.699999999999825, 39.10000000000002, 40.30000000000002, 12.69999999999974, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, 37.10000000000003, 39.300000000000026, -50.00000000000044, 33.70000000000004, 9.699999999999697, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.3, -50.00000000000044, 18.29999999999982, 3.2999999999996064, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 21.699999999999868, 3.2999999999996064, -50.00000000000044, 43.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 30.9, 40.70000000000002, 40.500000000000014, -50.00000000000044, 9.099999999999689, -50.00000000000044, 44.300000000000004, 44.7, 37.50000000000003, 42.70000000000001, 45.5, 41.90000000000001, 34.10000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 16.8999999999998, 25.899999999999928, 44.5, 43.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.300000000000004, 47.7, -50.00000000000044, 40.30000000000002, 44.5, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 31.1, 39.10000000000002, -50.00000000000044, 47.1, 40.500000000000014, 28.699999999999967, 37.300000000000026, 34.50000000000004, -50.00000000000044, 41.100000000000016, -50.00000000000044, 39.300000000000026, 15.099999999999774, 20.49999999999985, -50.00000000000044, 43.7, 46.099999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, 17.299999999999805, 38.700000000000024, 14.499999999999766, 45.1, -50.00000000000044, -50.00000000000044, 38.300000000000026, 15.299999999999777, 43.30000000000001, 42.70000000000001, -50.00000000000044, 27.699999999999953, 40.500000000000014], "episode_lengths": [314, 110, 98, 374, 500, 118, 500, 64, 500, 130, 108, 500, 164, 404, 500, 500, 46, 500, 48, 500, 318, 468, 38, 500, 500, 500, 110, 284, 468, 500, 68, 52, 500, 500, 192, 94, 96, 500, 410, 500, 58, 54, 126, 74, 46, 82, 160, 500, 70, 500, 332, 242, 56, 68, 96, 500, 500, 140, 58, 24, 500, 98, 56, 62, 82, 500, 500, 190, 110, 500, 30, 96, 214, 128, 156, 500, 90, 500, 108, 350, 296, 500, 64, 40, 500, 146, 500, 328, 114, 356, 50, 500, 500, 118, 348, 68, 74, 500, 224, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.380105632386981, "mean_inference_ms": 1.220435176079371, "mean_action_processing_ms": 0.1414893957965829, "mean_env_wait_ms": 0.08181945263026384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299880027770996, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.13522911071777344}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5249.279199424048, "num_env_steps_trained_throughput_per_sec": 5249.279199424048, "timesteps_total": 120000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 2172.567, "sample_time_ms": 1933.123, "load_time_ms": 11.31, "load_throughput": 1060982.868, "learn_time_ms": 217.485, "learn_throughput": 55176.111, "synch_weights_time_ms": 9.647}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 406, "training_iteration": 10, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-44", "timestamp": 1698247604, "time_this_iter_s": 2.291020631790161, "time_total_s": 21.772657871246338, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 21.772657871246338, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 64.5, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000007, "cur_lr": 0.0003, "total_loss": 7.673921171824137, "policy_loss": -0.0003326132893562317, "vf_loss": 7.67430804570516, "vf_explained_var": -2.578894297281901e-06, "kl": 0.0002641728156352959, "entropy": 0.5428329428037008, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.962999999999845, "episode_len_mean": 246.06, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 43.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.300000000000004, 47.7, -50.00000000000044, 40.30000000000002, 44.5, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 31.1, 39.10000000000002, -50.00000000000044, 47.1, 40.500000000000014, 28.699999999999967, 37.300000000000026, 34.50000000000004, -50.00000000000044, 41.100000000000016, -50.00000000000044, 39.300000000000026, 15.099999999999774, 20.49999999999985, -50.00000000000044, 43.7, 46.099999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, 17.299999999999805, 38.700000000000024, 14.499999999999766, 45.1, -50.00000000000044, -50.00000000000044, 38.300000000000026, 15.299999999999777, 43.30000000000001, 42.70000000000001, -50.00000000000044, 27.699999999999953, 40.500000000000014, -50.00000000000044, 42.500000000000014, 44.7, -50.00000000000044, 18.499999999999822, 47.5, 39.70000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 31.500000000000007, 16.29999999999979, 19.499999999999837, -50.00000000000044, -50.00000000000044, 33.70000000000004, 45.7, 47.3, -50.00000000000044, -50.00000000000044, 41.70000000000002, 2.0999999999995893, 44.5, -50.00000000000044, -50.00000000000044, 40.500000000000014, 37.90000000000003, 45.3, 43.900000000000006, -50.00000000000044, 38.700000000000024, 41.500000000000014, 44.300000000000004, 38.10000000000002, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 38.90000000000002, 45.9, 21.299999999999862, 41.30000000000001, 46.9, -50.00000000000044, 15.099999999999774, 39.90000000000002, -50.00000000000044, 42.500000000000014, 41.100000000000016], "episode_lengths": [56, 68, 96, 500, 500, 140, 58, 24, 500, 98, 56, 62, 82, 500, 500, 190, 110, 500, 30, 96, 214, 128, 156, 500, 90, 500, 108, 350, 296, 500, 64, 40, 500, 146, 500, 328, 114, 356, 50, 500, 500, 118, 348, 68, 74, 500, 224, 96, 500, 76, 54, 500, 316, 26, 104, 62, 500, 500, 500, 500, 194, 186, 338, 306, 500, 500, 164, 44, 28, 500, 500, 84, 480, 56, 500, 500, 96, 122, 48, 62, 500, 114, 86, 58, 120, 84, 500, 84, 500, 112, 42, 288, 88, 32, 500, 350, 102, 500, 76, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37995763590371284, "mean_inference_ms": 1.2211642057658412, "mean_action_processing_ms": 0.14227228642529413, "mean_env_wait_ms": 0.08269533082840345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700423240661621, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.12319588661193848}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.962999999999845, "episode_len_mean": 246.06, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 43.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.300000000000004, 47.7, -50.00000000000044, 40.30000000000002, 44.5, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 31.1, 39.10000000000002, -50.00000000000044, 47.1, 40.500000000000014, 28.699999999999967, 37.300000000000026, 34.50000000000004, -50.00000000000044, 41.100000000000016, -50.00000000000044, 39.300000000000026, 15.099999999999774, 20.49999999999985, -50.00000000000044, 43.7, 46.099999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, 17.299999999999805, 38.700000000000024, 14.499999999999766, 45.1, -50.00000000000044, -50.00000000000044, 38.300000000000026, 15.299999999999777, 43.30000000000001, 42.70000000000001, -50.00000000000044, 27.699999999999953, 40.500000000000014, -50.00000000000044, 42.500000000000014, 44.7, -50.00000000000044, 18.499999999999822, 47.5, 39.70000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 31.500000000000007, 16.29999999999979, 19.499999999999837, -50.00000000000044, -50.00000000000044, 33.70000000000004, 45.7, 47.3, -50.00000000000044, -50.00000000000044, 41.70000000000002, 2.0999999999995893, 44.5, -50.00000000000044, -50.00000000000044, 40.500000000000014, 37.90000000000003, 45.3, 43.900000000000006, -50.00000000000044, 38.700000000000024, 41.500000000000014, 44.300000000000004, 38.10000000000002, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 38.90000000000002, 45.9, 21.299999999999862, 41.30000000000001, 46.9, -50.00000000000044, 15.099999999999774, 39.90000000000002, -50.00000000000044, 42.500000000000014, 41.100000000000016], "episode_lengths": [56, 68, 96, 500, 500, 140, 58, 24, 500, 98, 56, 62, 82, 500, 500, 190, 110, 500, 30, 96, 214, 128, 156, 500, 90, 500, 108, 350, 296, 500, 64, 40, 500, 146, 500, 328, 114, 356, 50, 500, 500, 118, 348, 68, 74, 500, 224, 96, 500, 76, 54, 500, 316, 26, 104, 62, 500, 500, 500, 500, 194, 186, 338, 306, 500, 500, 164, 44, 28, 500, 500, 84, 480, 56, 500, 500, 96, 122, 48, 62, 500, 114, 86, 58, 120, 84, 500, 84, 500, 112, 42, 288, 88, 32, 500, 350, 102, 500, 76, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37995763590371284, "mean_inference_ms": 1.2211642057658412, "mean_action_processing_ms": 0.14227228642529413, "mean_env_wait_ms": 0.08269533082840345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700423240661621, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.12319588661193848}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5933.247318013648, "num_env_steps_trained_throughput_per_sec": 5933.247318013648, "timesteps_total": 132000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 2170.428, "sample_time_ms": 1928.636, "load_time_ms": 11.406, "load_throughput": 1052047.758, "learn_time_ms": 219.819, "learn_throughput": 54590.469, "synch_weights_time_ms": 9.565}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 458, "training_iteration": 11, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-46", "timestamp": 1698247606, "time_this_iter_s": 2.0275015830993652, "time_total_s": 23.800159454345703, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 23.800159454345703, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 57.73333333333333, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000003e-05, "cur_lr": 0.0003, "total_loss": 6.298054885864258, "policy_loss": -4.048744837443034e-05, "vf_loss": 6.2981491406758625, "vf_explained_var": -2.165635426839193e-06, "kl": 0.0006243383767241539, "entropy": 0.5371468782424926, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.795999999999825, "episode_len_mean": 262.68, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.499999999999766, 45.1, -50.00000000000044, -50.00000000000044, 38.300000000000026, 15.299999999999777, 43.30000000000001, 42.70000000000001, -50.00000000000044, 27.699999999999953, 40.500000000000014, -50.00000000000044, 42.500000000000014, 44.7, -50.00000000000044, 18.499999999999822, 47.5, 39.70000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 31.500000000000007, 16.29999999999979, 19.499999999999837, -50.00000000000044, -50.00000000000044, 33.70000000000004, 45.7, 47.3, -50.00000000000044, -50.00000000000044, 41.70000000000002, 2.0999999999995893, 44.5, -50.00000000000044, -50.00000000000044, 40.500000000000014, 37.90000000000003, 45.3, 43.900000000000006, -50.00000000000044, 38.700000000000024, 41.500000000000014, 44.300000000000004, 38.10000000000002, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 38.90000000000002, 45.9, 21.299999999999862, 41.30000000000001, 46.9, -50.00000000000044, 15.099999999999774, 39.90000000000002, -50.00000000000044, 42.500000000000014, 41.100000000000016, 31.1, -50.00000000000044, 37.50000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 44.7, 30.499999999999993, 40.500000000000014, -50.00000000000044, 42.10000000000001, 45.5, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.500000000000014, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 39.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 26.299999999999933, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, 15.099999999999774], "episode_lengths": [356, 50, 500, 500, 118, 348, 68, 74, 500, 224, 96, 500, 76, 54, 500, 316, 26, 104, 62, 500, 500, 500, 500, 194, 186, 338, 306, 500, 500, 164, 44, 28, 500, 500, 84, 480, 56, 500, 500, 96, 122, 48, 62, 500, 114, 86, 58, 120, 84, 500, 84, 500, 112, 42, 288, 88, 32, 500, 350, 102, 500, 76, 90, 190, 500, 126, 500, 74, 500, 500, 154, 54, 196, 96, 500, 80, 46, 126, 500, 500, 60, 76, 500, 128, 500, 500, 500, 78, 500, 110, 38, 500, 500, 238, 48, 500, 500, 58, 36, 350]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3801824073013502, "mean_inference_ms": 1.2217489117607274, "mean_action_processing_ms": 0.14243125746007834, "mean_env_wait_ms": 0.08277181676376352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0399937629699707, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.12700915336608887}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.795999999999825, "episode_len_mean": 262.68, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.499999999999766, 45.1, -50.00000000000044, -50.00000000000044, 38.300000000000026, 15.299999999999777, 43.30000000000001, 42.70000000000001, -50.00000000000044, 27.699999999999953, 40.500000000000014, -50.00000000000044, 42.500000000000014, 44.7, -50.00000000000044, 18.499999999999822, 47.5, 39.70000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 31.500000000000007, 16.29999999999979, 19.499999999999837, -50.00000000000044, -50.00000000000044, 33.70000000000004, 45.7, 47.3, -50.00000000000044, -50.00000000000044, 41.70000000000002, 2.0999999999995893, 44.5, -50.00000000000044, -50.00000000000044, 40.500000000000014, 37.90000000000003, 45.3, 43.900000000000006, -50.00000000000044, 38.700000000000024, 41.500000000000014, 44.300000000000004, 38.10000000000002, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 38.90000000000002, 45.9, 21.299999999999862, 41.30000000000001, 46.9, -50.00000000000044, 15.099999999999774, 39.90000000000002, -50.00000000000044, 42.500000000000014, 41.100000000000016, 31.1, -50.00000000000044, 37.50000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 44.7, 30.499999999999993, 40.500000000000014, -50.00000000000044, 42.10000000000001, 45.5, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.500000000000014, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 39.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 26.299999999999933, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, 15.099999999999774], "episode_lengths": [356, 50, 500, 500, 118, 348, 68, 74, 500, 224, 96, 500, 76, 54, 500, 316, 26, 104, 62, 500, 500, 500, 500, 194, 186, 338, 306, 500, 500, 164, 44, 28, 500, 500, 84, 480, 56, 500, 500, 96, 122, 48, 62, 500, 114, 86, 58, 120, 84, 500, 84, 500, 112, 42, 288, 88, 32, 500, 350, 102, 500, 76, 90, 190, 500, 126, 500, 74, 500, 500, 154, 54, 196, 96, 500, 80, 46, 126, 500, 500, 60, 76, 500, 128, 500, 500, 500, 78, 500, 110, 38, 500, 500, 238, 48, 500, 500, 58, 36, 350]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3801824073013502, "mean_inference_ms": 1.2217489117607274, "mean_action_processing_ms": 0.14243125746007834, "mean_env_wait_ms": 0.08277181676376352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0399937629699707, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.12700915336608887}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5621.121142976738, "num_env_steps_trained_throughput_per_sec": 5621.121142976738, "timesteps_total": 144000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 2186.548, "sample_time_ms": 1945.417, "load_time_ms": 11.306, "load_throughput": 1061385.597, "learn_time_ms": 219.567, "learn_throughput": 54653.03, "synch_weights_time_ms": 9.356}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 495, "training_iteration": 12, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-48", "timestamp": 1698247608, "time_this_iter_s": 2.1388025283813477, "time_total_s": 25.93896198272705, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 25.93896198272705, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 66.10000000000001, "ram_util_percent": 26.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.8828125000000016e-05, "cur_lr": 0.0003, "total_loss": 6.596426232655843, "policy_loss": -0.0004229754209518433, "vf_loss": 6.596901671091715, "vf_explained_var": -1.7404556274414062e-06, "kl": 0.0005508832335787399, "entropy": 0.5243641475836436, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 188.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.589999999999819, "episode_len_mean": 264.72, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 38.90000000000002, 45.9, 21.299999999999862, 41.30000000000001, 46.9, -50.00000000000044, 15.099999999999774, 39.90000000000002, -50.00000000000044, 42.500000000000014, 41.100000000000016, 31.1, -50.00000000000044, 37.50000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 44.7, 30.499999999999993, 40.500000000000014, -50.00000000000044, 42.10000000000001, 45.5, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.500000000000014, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 39.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 26.299999999999933, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, 15.099999999999774, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.900000000000006, 37.70000000000003, 46.5, 46.5, 41.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, 20.699999999999854, -50.00000000000044, 40.90000000000002, 40.500000000000014, 44.900000000000006, -50.00000000000044, 42.900000000000006, 44.900000000000006, 44.900000000000006, -50.00000000000044, 38.700000000000024, 42.500000000000014, 35.30000000000004, 44.5, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 29.899999999999984, 37.90000000000003, 46.3, -50.00000000000044, -50.00000000000044, 5.299999999999635, 38.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 20.099999999999845, -50.00000000000044, -50.00000000000044, 42.30000000000001], "episode_lengths": [84, 500, 84, 500, 112, 42, 288, 88, 32, 500, 350, 102, 500, 76, 90, 190, 500, 126, 500, 74, 500, 500, 154, 54, 196, 96, 500, 80, 46, 126, 500, 500, 60, 76, 500, 128, 500, 500, 500, 78, 500, 110, 38, 500, 500, 238, 48, 500, 500, 58, 36, 350, 392, 500, 500, 52, 124, 36, 36, 84, 94, 500, 500, 500, 334, 294, 500, 92, 96, 52, 500, 72, 52, 52, 500, 114, 76, 148, 56, 48, 52, 500, 500, 500, 500, 62, 202, 122, 38, 500, 500, 448, 116, 500, 500, 40, 300, 500, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38002170642190547, "mean_inference_ms": 1.2238384149827681, "mean_action_processing_ms": 0.14305357089334902, "mean_env_wait_ms": 0.08333461185740036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200387954711914, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.1272127628326416}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.589999999999819, "episode_len_mean": 264.72, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 38.90000000000002, 45.9, 21.299999999999862, 41.30000000000001, 46.9, -50.00000000000044, 15.099999999999774, 39.90000000000002, -50.00000000000044, 42.500000000000014, 41.100000000000016, 31.1, -50.00000000000044, 37.50000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 44.7, 30.499999999999993, 40.500000000000014, -50.00000000000044, 42.10000000000001, 45.5, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.500000000000014, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 39.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 26.299999999999933, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, 15.099999999999774, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.900000000000006, 37.70000000000003, 46.5, 46.5, 41.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, 20.699999999999854, -50.00000000000044, 40.90000000000002, 40.500000000000014, 44.900000000000006, -50.00000000000044, 42.900000000000006, 44.900000000000006, 44.900000000000006, -50.00000000000044, 38.700000000000024, 42.500000000000014, 35.30000000000004, 44.5, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 29.899999999999984, 37.90000000000003, 46.3, -50.00000000000044, -50.00000000000044, 5.299999999999635, 38.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 20.099999999999845, -50.00000000000044, -50.00000000000044, 42.30000000000001], "episode_lengths": [84, 500, 84, 500, 112, 42, 288, 88, 32, 500, 350, 102, 500, 76, 90, 190, 500, 126, 500, 74, 500, 500, 154, 54, 196, 96, 500, 80, 46, 126, 500, 500, 60, 76, 500, 128, 500, 500, 500, 78, 500, 110, 38, 500, 500, 238, 48, 500, 500, 58, 36, 350, 392, 500, 500, 52, 124, 36, 36, 84, 94, 500, 500, 500, 334, 294, 500, 92, 96, 52, 500, 72, 52, 52, 500, 114, 76, 148, 56, 48, 52, 500, 500, 500, 500, 62, 202, 122, 38, 500, 500, 448, 116, 500, 500, 40, 300, 500, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38002170642190547, "mean_inference_ms": 1.2238384149827681, "mean_action_processing_ms": 0.14305357089334902, "mean_env_wait_ms": 0.08333461185740036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200387954711914, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.1272127628326416}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5549.705896168215, "num_env_steps_trained_throughput_per_sec": 5549.705896168215, "timesteps_total": 156000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 2192.692, "sample_time_ms": 1953.93, "load_time_ms": 11.306, "load_throughput": 1061374.406, "learn_time_ms": 217.11, "learn_throughput": 55271.512, "synch_weights_time_ms": 9.443}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 543, "training_iteration": 13, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-50", "timestamp": 1698247610, "time_this_iter_s": 2.1672749519348145, "time_total_s": 28.106236934661865, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 28.106236934661865, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 62.833333333333336, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000008e-05, "cur_lr": 0.0003, "total_loss": 6.75436102549235, "policy_loss": -0.00012742976347605386, "vf_loss": 6.7545439084370935, "vf_explained_var": -1.3828277587890625e-06, "kl": 0.00028277796585219527, "entropy": 0.5550747990608216, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5479999999997995, "episode_len_mean": 285.12, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 26.299999999999933, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, 15.099999999999774, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.900000000000006, 37.70000000000003, 46.5, 46.5, 41.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, 20.699999999999854, -50.00000000000044, 40.90000000000002, 40.500000000000014, 44.900000000000006, -50.00000000000044, 42.900000000000006, 44.900000000000006, 44.900000000000006, -50.00000000000044, 38.700000000000024, 42.500000000000014, 35.30000000000004, 44.5, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 29.899999999999984, 37.90000000000003, 46.3, -50.00000000000044, -50.00000000000044, 5.299999999999635, 38.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 20.099999999999845, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.500000000000014, 44.10000000000001, 43.900000000000006, 44.10000000000001, 5.099999999999632, -50.00000000000044, 38.50000000000003, 38.90000000000002, 7.499999999999666, -50.00000000000044, 39.70000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, 14.299999999999763, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, 34.70000000000004, 42.70000000000001, -50.00000000000044, 27.699999999999953, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 43.7, 46.3, -50.00000000000044, 40.90000000000002, 38.10000000000002, 38.50000000000003], "episode_lengths": [500, 110, 38, 500, 500, 238, 48, 500, 500, 58, 36, 350, 392, 500, 500, 52, 124, 36, 36, 84, 94, 500, 500, 500, 334, 294, 500, 92, 96, 52, 500, 72, 52, 52, 500, 114, 76, 148, 56, 48, 52, 500, 500, 500, 500, 62, 202, 122, 38, 500, 500, 448, 116, 500, 500, 40, 300, 500, 500, 78, 500, 86, 60, 62, 60, 450, 500, 116, 112, 426, 500, 104, 500, 188, 500, 358, 442, 500, 500, 500, 64, 500, 500, 500, 228, 500, 154, 74, 500, 224, 500, 234, 500, 500, 64, 38, 500, 92, 120, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37967353011335375, "mean_inference_ms": 1.22415281757018, "mean_action_processing_ms": 0.14346132958610955, "mean_env_wait_ms": 0.08389662594523138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025003671646118164, "StateBufferConnector_ms": 0.006996870040893555, "ViewRequirementAgentConnector_ms": 0.11221480369567871}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5479999999997995, "episode_len_mean": 285.12, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 26.299999999999933, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, 15.099999999999774, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.900000000000006, 37.70000000000003, 46.5, 46.5, 41.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, 20.699999999999854, -50.00000000000044, 40.90000000000002, 40.500000000000014, 44.900000000000006, -50.00000000000044, 42.900000000000006, 44.900000000000006, 44.900000000000006, -50.00000000000044, 38.700000000000024, 42.500000000000014, 35.30000000000004, 44.5, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 29.899999999999984, 37.90000000000003, 46.3, -50.00000000000044, -50.00000000000044, 5.299999999999635, 38.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 20.099999999999845, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.500000000000014, 44.10000000000001, 43.900000000000006, 44.10000000000001, 5.099999999999632, -50.00000000000044, 38.50000000000003, 38.90000000000002, 7.499999999999666, -50.00000000000044, 39.70000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, 14.299999999999763, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, 34.70000000000004, 42.70000000000001, -50.00000000000044, 27.699999999999953, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 43.7, 46.3, -50.00000000000044, 40.90000000000002, 38.10000000000002, 38.50000000000003], "episode_lengths": [500, 110, 38, 500, 500, 238, 48, 500, 500, 58, 36, 350, 392, 500, 500, 52, 124, 36, 36, 84, 94, 500, 500, 500, 334, 294, 500, 92, 96, 52, 500, 72, 52, 52, 500, 114, 76, 148, 56, 48, 52, 500, 500, 500, 500, 62, 202, 122, 38, 500, 500, 448, 116, 500, 500, 40, 300, 500, 500, 78, 500, 86, 60, 62, 60, 450, 500, 116, 112, 426, 500, 104, 500, 188, 500, 358, 442, 500, 500, 500, 64, 500, 500, 500, 228, 500, 154, 74, 500, 224, 500, 234, 500, 500, 64, 38, 500, 92, 120, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37967353011335375, "mean_inference_ms": 1.22415281757018, "mean_action_processing_ms": 0.14346132958610955, "mean_env_wait_ms": 0.08389662594523138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025003671646118164, "StateBufferConnector_ms": 0.006996870040893555, "ViewRequirementAgentConnector_ms": 0.11221480369567871}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5103.5721503140885, "num_env_steps_trained_throughput_per_sec": 5103.5721503140885, "timesteps_total": 168000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 2209.221, "sample_time_ms": 1962.142, "load_time_ms": 11.486, "load_throughput": 1044723.582, "learn_time_ms": 224.868, "learn_throughput": 53364.53, "synch_weights_time_ms": 9.722}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 583, "training_iteration": 14, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-52", "timestamp": 1698247612, "time_this_iter_s": 2.3572909832000732, "time_total_s": 30.46352791786194, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 30.46352791786194, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 51.72500000000001, "ram_util_percent": 25.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000004e-05, "cur_lr": 0.0003, "total_loss": 6.581417401631673, "policy_loss": -0.0006982768575350443, "vf_loss": 6.582169850667317, "vf_explained_var": -6.198883056640625e-07, "kl": 0.0011889261941860241, "entropy": 0.5418252229690552, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 218.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.045999999999807, "episode_len_mean": 280.16, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, -50.00000000000044, 5.299999999999635, 38.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 20.099999999999845, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.500000000000014, 44.10000000000001, 43.900000000000006, 44.10000000000001, 5.099999999999632, -50.00000000000044, 38.50000000000003, 38.90000000000002, 7.499999999999666, -50.00000000000044, 39.70000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, 14.299999999999763, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, 34.70000000000004, 42.70000000000001, -50.00000000000044, 27.699999999999953, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 43.7, 46.3, -50.00000000000044, 40.90000000000002, 38.10000000000002, 38.50000000000003, -50.00000000000044, 42.10000000000001, 42.500000000000014, -50.00000000000044, 37.300000000000026, 46.5, 44.5, 33.90000000000004, -50.00000000000044, 42.500000000000014, 1.8999999999995865, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.70000000000001, 28.499999999999964, 43.7, 44.5, 25.499999999999922, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 33.10000000000003, 47.5, 40.10000000000002, -50.00000000000044, 42.500000000000014, 3.2999999999996064, 27.299999999999947, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 22.299999999999876, -50.00000000000044, 35.500000000000036, -50.00000000000044, 41.30000000000001, 42.500000000000014, 39.300000000000026, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7], "episode_lengths": [38, 500, 500, 448, 116, 500, 500, 40, 300, 500, 500, 78, 500, 86, 60, 62, 60, 450, 500, 116, 112, 426, 500, 104, 500, 188, 500, 358, 442, 500, 500, 500, 64, 500, 500, 500, 228, 500, 154, 74, 500, 224, 500, 234, 500, 500, 64, 38, 500, 92, 120, 116, 500, 80, 76, 500, 128, 36, 56, 162, 500, 76, 482, 500, 52, 500, 74, 216, 64, 56, 246, 500, 48, 56, 500, 170, 26, 100, 500, 76, 468, 228, 76, 60, 500, 500, 132, 500, 278, 500, 146, 500, 88, 76, 108, 64, 500, 500, 66, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37862377546089104, "mean_inference_ms": 1.220681067098182, "mean_action_processing_ms": 0.14363392349890838, "mean_env_wait_ms": 0.08314503148975722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999664306640625, "StateBufferConnector_ms": 0.0059964656829833984, "ViewRequirementAgentConnector_ms": 0.10419917106628418}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.045999999999807, "episode_len_mean": 280.16, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, -50.00000000000044, 5.299999999999635, 38.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 20.099999999999845, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.500000000000014, 44.10000000000001, 43.900000000000006, 44.10000000000001, 5.099999999999632, -50.00000000000044, 38.50000000000003, 38.90000000000002, 7.499999999999666, -50.00000000000044, 39.70000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, 14.299999999999763, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, 34.70000000000004, 42.70000000000001, -50.00000000000044, 27.699999999999953, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 43.7, 46.3, -50.00000000000044, 40.90000000000002, 38.10000000000002, 38.50000000000003, -50.00000000000044, 42.10000000000001, 42.500000000000014, -50.00000000000044, 37.300000000000026, 46.5, 44.5, 33.90000000000004, -50.00000000000044, 42.500000000000014, 1.8999999999995865, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.70000000000001, 28.499999999999964, 43.7, 44.5, 25.499999999999922, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 33.10000000000003, 47.5, 40.10000000000002, -50.00000000000044, 42.500000000000014, 3.2999999999996064, 27.299999999999947, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 22.299999999999876, -50.00000000000044, 35.500000000000036, -50.00000000000044, 41.30000000000001, 42.500000000000014, 39.300000000000026, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7], "episode_lengths": [38, 500, 500, 448, 116, 500, 500, 40, 300, 500, 500, 78, 500, 86, 60, 62, 60, 450, 500, 116, 112, 426, 500, 104, 500, 188, 500, 358, 442, 500, 500, 500, 64, 500, 500, 500, 228, 500, 154, 74, 500, 224, 500, 234, 500, 500, 64, 38, 500, 92, 120, 116, 500, 80, 76, 500, 128, 36, 56, 162, 500, 76, 482, 500, 52, 500, 74, 216, 64, 56, 246, 500, 48, 56, 500, 170, 26, 100, 500, 76, 468, 228, 76, 60, 500, 500, 132, 500, 278, 500, 146, 500, 88, 76, 108, 64, 500, 500, 66, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37862377546089104, "mean_inference_ms": 1.220681067098182, "mean_action_processing_ms": 0.14363392349890838, "mean_env_wait_ms": 0.08314503148975722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999664306640625, "StateBufferConnector_ms": 0.0059964656829833984, "ViewRequirementAgentConnector_ms": 0.10419917106628418}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5842.7401310202895, "num_env_steps_trained_throughput_per_sec": 5842.7401310202895, "timesteps_total": 180000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 2204.381, "sample_time_ms": 1948.589, "load_time_ms": 11.686, "load_throughput": 1026828.625, "learn_time_ms": 233.481, "learn_throughput": 51396.008, "synch_weights_time_ms": 9.824}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 631, "training_iteration": 15, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-54", "timestamp": 1698247614, "time_this_iter_s": 2.0588393211364746, "time_total_s": 32.52236723899841, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 32.52236723899841, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 65.15, "ram_util_percent": 25.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000002e-06, "cur_lr": 0.0003, "total_loss": 6.407816282908121, "policy_loss": 9.402384360631307e-05, "vf_loss": 6.4077729225158695, "vf_explained_var": 1.6848246256510416e-06, "kl": 0.00011310430891171563, "entropy": 0.5072026928265889, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 233.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.956999999999811, "episode_len_mean": 276.06, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.70000000000004, 42.70000000000001, -50.00000000000044, 27.699999999999953, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 43.7, 46.3, -50.00000000000044, 40.90000000000002, 38.10000000000002, 38.50000000000003, -50.00000000000044, 42.10000000000001, 42.500000000000014, -50.00000000000044, 37.300000000000026, 46.5, 44.5, 33.90000000000004, -50.00000000000044, 42.500000000000014, 1.8999999999995865, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.70000000000001, 28.499999999999964, 43.7, 44.5, 25.499999999999922, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 33.10000000000003, 47.5, 40.10000000000002, -50.00000000000044, 42.500000000000014, 3.2999999999996064, 27.299999999999947, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 22.299999999999876, -50.00000000000044, 35.500000000000036, -50.00000000000044, 41.30000000000001, 42.500000000000014, 39.300000000000026, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 41.30000000000001, 44.5, 43.7, 36.900000000000034, 21.09999999999986, 43.10000000000001, -50.00000000000044, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, 0.2999999999995637, 42.10000000000001, 15.299999999999777, 41.500000000000014, 27.099999999999945, -50.00000000000044, 34.70000000000004, -50.00000000000044, 3.899999999999615, 43.10000000000001, 45.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, 41.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 154, 74, 500, 224, 500, 234, 500, 500, 64, 38, 500, 92, 120, 116, 500, 80, 76, 500, 128, 36, 56, 162, 500, 76, 482, 500, 52, 500, 74, 216, 64, 56, 246, 500, 48, 56, 500, 170, 26, 100, 500, 76, 468, 228, 76, 60, 500, 500, 132, 500, 278, 500, 146, 500, 88, 76, 108, 64, 500, 500, 66, 54, 500, 88, 56, 64, 132, 290, 70, 500, 500, 448, 500, 500, 498, 80, 348, 86, 230, 500, 154, 500, 462, 70, 48, 84, 500, 500, 500, 110, 500, 500, 360, 500, 500, 86, 102, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778930497060943, "mean_inference_ms": 1.218348312391323, "mean_action_processing_ms": 0.14354068746753149, "mean_env_wait_ms": 0.08296674748670403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200460433959961, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.11199092864990234}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.956999999999811, "episode_len_mean": 276.06, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.70000000000004, 42.70000000000001, -50.00000000000044, 27.699999999999953, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 43.7, 46.3, -50.00000000000044, 40.90000000000002, 38.10000000000002, 38.50000000000003, -50.00000000000044, 42.10000000000001, 42.500000000000014, -50.00000000000044, 37.300000000000026, 46.5, 44.5, 33.90000000000004, -50.00000000000044, 42.500000000000014, 1.8999999999995865, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.70000000000001, 28.499999999999964, 43.7, 44.5, 25.499999999999922, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 33.10000000000003, 47.5, 40.10000000000002, -50.00000000000044, 42.500000000000014, 3.2999999999996064, 27.299999999999947, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 22.299999999999876, -50.00000000000044, 35.500000000000036, -50.00000000000044, 41.30000000000001, 42.500000000000014, 39.300000000000026, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 41.30000000000001, 44.5, 43.7, 36.900000000000034, 21.09999999999986, 43.10000000000001, -50.00000000000044, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, 0.2999999999995637, 42.10000000000001, 15.299999999999777, 41.500000000000014, 27.099999999999945, -50.00000000000044, 34.70000000000004, -50.00000000000044, 3.899999999999615, 43.10000000000001, 45.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, 41.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 154, 74, 500, 224, 500, 234, 500, 500, 64, 38, 500, 92, 120, 116, 500, 80, 76, 500, 128, 36, 56, 162, 500, 76, 482, 500, 52, 500, 74, 216, 64, 56, 246, 500, 48, 56, 500, 170, 26, 100, 500, 76, 468, 228, 76, 60, 500, 500, 132, 500, 278, 500, 146, 500, 88, 76, 108, 64, 500, 500, 66, 54, 500, 88, 56, 64, 132, 290, 70, 500, 500, 448, 500, 500, 498, 80, 348, 86, 230, 500, 154, 500, 462, 70, 48, 84, 500, 500, 500, 110, 500, 500, 360, 500, 500, 86, 102, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778930497060943, "mean_inference_ms": 1.218348312391323, "mean_action_processing_ms": 0.14354068746753149, "mean_env_wait_ms": 0.08296674748670403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200460433959961, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.11199092864990234}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5147.295789541504, "num_env_steps_trained_throughput_per_sec": 5147.295789541504, "timesteps_total": 192000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 2221.427, "sample_time_ms": 1945.699, "load_time_ms": 12.289, "load_throughput": 976513.381, "learn_time_ms": 252.613, "learn_throughput": 47503.427, "synch_weights_time_ms": 9.926}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 668, "training_iteration": 16, "trial_id": "9f288_00011", "date": "2023-10-25_16-26-57", "timestamp": 1698247617, "time_this_iter_s": 2.337108612060547, "time_total_s": 34.85947585105896, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 34.85947585105896, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 54.55, "ram_util_percent": 25.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.051757812500001e-06, "cur_lr": 0.0003, "total_loss": 6.973322963714599, "policy_loss": -0.00025758519768714905, "vf_loss": 6.97363691329956, "vf_explained_var": -6.397565205891927e-07, "kl": 0.0001437879236940868, "entropy": 0.5635156949361165, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 248.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.929999999999832, "episode_len_mean": 261.36, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.500000000000036, -50.00000000000044, 41.30000000000001, 42.500000000000014, 39.300000000000026, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 41.30000000000001, 44.5, 43.7, 36.900000000000034, 21.09999999999986, 43.10000000000001, -50.00000000000044, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, 0.2999999999995637, 42.10000000000001, 15.299999999999777, 41.500000000000014, 27.099999999999945, -50.00000000000044, 34.70000000000004, -50.00000000000044, 3.899999999999615, 43.10000000000001, 45.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, 41.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, 38.90000000000002, 42.500000000000014, 44.10000000000001, 37.300000000000026, 43.50000000000001, 26.09999999999993, -50.00000000000044, 37.90000000000003, 35.30000000000004, 24.69999999999991, 46.9, 47.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 32.100000000000016, 40.30000000000002, -50.00000000000044, 43.900000000000006, 37.50000000000003, 46.699999999999996, -50.00000000000044, 31.500000000000007, 33.90000000000004, 44.5, 42.900000000000006, 39.90000000000002, -50.00000000000044, 11.099999999999717, 32.90000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 31.500000000000007, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, 28.09999999999996, 46.699999999999996, 32.50000000000002, 38.10000000000002, 46.5, 40.500000000000014, -50.00000000000044, 46.699999999999996, 37.70000000000003], "episode_lengths": [146, 500, 88, 76, 108, 64, 500, 500, 66, 54, 500, 88, 56, 64, 132, 290, 70, 500, 500, 448, 500, 500, 498, 80, 348, 86, 230, 500, 154, 500, 462, 70, 48, 84, 500, 500, 500, 110, 500, 500, 360, 500, 500, 86, 102, 500, 500, 346, 500, 112, 76, 60, 128, 66, 240, 500, 122, 148, 254, 32, 28, 68, 500, 500, 180, 98, 500, 62, 126, 34, 500, 186, 162, 56, 72, 102, 500, 390, 172, 500, 72, 500, 500, 186, 84, 500, 500, 118, 500, 500, 48, 220, 34, 176, 120, 36, 96, 500, 34, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38261634492599855, "mean_inference_ms": 1.2364458762119648, "mean_action_processing_ms": 0.14570954774567357, "mean_env_wait_ms": 0.08382750571208426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035939693450927734, "StateBufferConnector_ms": 0.009999752044677734, "ViewRequirementAgentConnector_ms": 0.1315300464630127}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.929999999999832, "episode_len_mean": 261.36, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.500000000000036, -50.00000000000044, 41.30000000000001, 42.500000000000014, 39.300000000000026, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 41.30000000000001, 44.5, 43.7, 36.900000000000034, 21.09999999999986, 43.10000000000001, -50.00000000000044, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, 0.2999999999995637, 42.10000000000001, 15.299999999999777, 41.500000000000014, 27.099999999999945, -50.00000000000044, 34.70000000000004, -50.00000000000044, 3.899999999999615, 43.10000000000001, 45.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, 41.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, 38.90000000000002, 42.500000000000014, 44.10000000000001, 37.300000000000026, 43.50000000000001, 26.09999999999993, -50.00000000000044, 37.90000000000003, 35.30000000000004, 24.69999999999991, 46.9, 47.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 32.100000000000016, 40.30000000000002, -50.00000000000044, 43.900000000000006, 37.50000000000003, 46.699999999999996, -50.00000000000044, 31.500000000000007, 33.90000000000004, 44.5, 42.900000000000006, 39.90000000000002, -50.00000000000044, 11.099999999999717, 32.90000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 31.500000000000007, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, 28.09999999999996, 46.699999999999996, 32.50000000000002, 38.10000000000002, 46.5, 40.500000000000014, -50.00000000000044, 46.699999999999996, 37.70000000000003], "episode_lengths": [146, 500, 88, 76, 108, 64, 500, 500, 66, 54, 500, 88, 56, 64, 132, 290, 70, 500, 500, 448, 500, 500, 498, 80, 348, 86, 230, 500, 154, 500, 462, 70, 48, 84, 500, 500, 500, 110, 500, 500, 360, 500, 500, 86, 102, 500, 500, 346, 500, 112, 76, 60, 128, 66, 240, 500, 122, 148, 254, 32, 28, 68, 500, 500, 180, 98, 500, 62, 126, 34, 500, 186, 162, 56, 72, 102, 500, 390, 172, 500, 72, 500, 500, 186, 84, 500, 500, 118, 500, 500, 48, 220, 34, 176, 120, 36, 96, 500, 34, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38261634492599855, "mean_inference_ms": 1.2364458762119648, "mean_action_processing_ms": 0.14570954774567357, "mean_env_wait_ms": 0.08382750571208426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035939693450927734, "StateBufferConnector_ms": 0.009999752044677734, "ViewRequirementAgentConnector_ms": 0.1315300464630127}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3908.1496111506813, "num_env_steps_trained_throughput_per_sec": 3908.1496111506813, "timesteps_total": 204000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 2292.978, "sample_time_ms": 2023.091, "load_time_ms": 11.489, "load_throughput": 1044504.608, "learn_time_ms": 247.471, "learn_throughput": 48490.572, "synch_weights_time_ms": 9.927}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 721, "training_iteration": 17, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-00", "timestamp": 1698247620, "time_this_iter_s": 3.0755066871643066, "time_total_s": 37.93498253822327, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 37.93498253822327, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 81.3, "ram_util_percent": 29.150000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500005e-06, "cur_lr": 0.0003, "total_loss": 6.591714700063069, "policy_loss": -0.00040750627716382344, "vf_loss": 6.592175070444743, "vf_explained_var": -1.438458760579427e-06, "kl": 0.0004739517675754238, "entropy": 0.5298004269599914, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 263.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.94599999999984, "episode_len_mean": 251.2, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, 38.90000000000002, 42.500000000000014, 44.10000000000001, 37.300000000000026, 43.50000000000001, 26.09999999999993, -50.00000000000044, 37.90000000000003, 35.30000000000004, 24.69999999999991, 46.9, 47.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 32.100000000000016, 40.30000000000002, -50.00000000000044, 43.900000000000006, 37.50000000000003, 46.699999999999996, -50.00000000000044, 31.500000000000007, 33.90000000000004, 44.5, 42.900000000000006, 39.90000000000002, -50.00000000000044, 11.099999999999717, 32.90000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 31.500000000000007, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, 28.09999999999996, 46.699999999999996, 32.50000000000002, 38.10000000000002, 46.5, 40.500000000000014, -50.00000000000044, 46.699999999999996, 37.70000000000003, -50.00000000000044, 38.300000000000026, 46.699999999999996, 38.10000000000002, 29.69999999999998, 44.5, 41.90000000000001, 44.300000000000004, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 17.099999999999802, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 36.70000000000003, 26.09999999999993, 23.8999999999999, 28.499999999999964, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 39.10000000000002, 12.69999999999974, 22.899999999999885, 46.699999999999996, 42.70000000000001, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [102, 500, 500, 346, 500, 112, 76, 60, 128, 66, 240, 500, 122, 148, 254, 32, 28, 68, 500, 500, 180, 98, 500, 62, 126, 34, 500, 186, 162, 56, 72, 102, 500, 390, 172, 500, 72, 500, 500, 186, 84, 500, 500, 118, 500, 500, 48, 220, 34, 176, 120, 36, 96, 500, 34, 124, 500, 118, 34, 120, 204, 56, 82, 58, 500, 44, 48, 500, 36, 500, 500, 330, 82, 500, 500, 500, 52, 500, 48, 500, 500, 168, 500, 134, 240, 262, 216, 80, 500, 500, 46, 110, 374, 272, 34, 74, 28, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3876747142594905, "mean_inference_ms": 1.252666700051962, "mean_action_processing_ms": 0.14776845685146175, "mean_env_wait_ms": 0.08560348463965826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02793407440185547, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.1476271152496338}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.94599999999984, "episode_len_mean": 251.2, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, 38.90000000000002, 42.500000000000014, 44.10000000000001, 37.300000000000026, 43.50000000000001, 26.09999999999993, -50.00000000000044, 37.90000000000003, 35.30000000000004, 24.69999999999991, 46.9, 47.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 32.100000000000016, 40.30000000000002, -50.00000000000044, 43.900000000000006, 37.50000000000003, 46.699999999999996, -50.00000000000044, 31.500000000000007, 33.90000000000004, 44.5, 42.900000000000006, 39.90000000000002, -50.00000000000044, 11.099999999999717, 32.90000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 31.500000000000007, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, 28.09999999999996, 46.699999999999996, 32.50000000000002, 38.10000000000002, 46.5, 40.500000000000014, -50.00000000000044, 46.699999999999996, 37.70000000000003, -50.00000000000044, 38.300000000000026, 46.699999999999996, 38.10000000000002, 29.69999999999998, 44.5, 41.90000000000001, 44.300000000000004, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 17.099999999999802, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 36.70000000000003, 26.09999999999993, 23.8999999999999, 28.499999999999964, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 39.10000000000002, 12.69999999999974, 22.899999999999885, 46.699999999999996, 42.70000000000001, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [102, 500, 500, 346, 500, 112, 76, 60, 128, 66, 240, 500, 122, 148, 254, 32, 28, 68, 500, 500, 180, 98, 500, 62, 126, 34, 500, 186, 162, 56, 72, 102, 500, 390, 172, 500, 72, 500, 500, 186, 84, 500, 500, 118, 500, 500, 48, 220, 34, 176, 120, 36, 96, 500, 34, 124, 500, 118, 34, 120, 204, 56, 82, 58, 500, 44, 48, 500, 36, 500, 500, 330, 82, 500, 500, 500, 52, 500, 48, 500, 500, 168, 500, 134, 240, 262, 216, 80, 500, 500, 46, 110, 374, 272, 34, 74, 28, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3876747142594905, "mean_inference_ms": 1.252666700051962, "mean_action_processing_ms": 0.14776845685146175, "mean_env_wait_ms": 0.08560348463965826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02793407440185547, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.1476271152496338}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5114.321928961926, "num_env_steps_trained_throughput_per_sec": 5114.321928961926, "timesteps_total": 216000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 2303.213, "sample_time_ms": 2049.055, "load_time_ms": 10.689, "load_throughput": 1122619.792, "learn_time_ms": 232.47, "learn_throughput": 51619.466, "synch_weights_time_ms": 9.927}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 765, "training_iteration": 18, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-02", "timestamp": 1698247622, "time_this_iter_s": 2.351350784301758, "time_total_s": 40.286333322525024, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 40.286333322525024, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 64.13333333333334, "ram_util_percent": 25.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250003e-07, "cur_lr": 0.0003, "total_loss": 6.328301111857097, "policy_loss": -0.0007581123461325963, "vf_loss": 6.329113388061524, "vf_explained_var": -5.602836608886719e-07, "kl": 0.0015380565678848749, "entropy": 0.5419557372728984, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 278.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.995999999999813, "episode_len_mean": 270.66, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.500000000000007, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, 28.09999999999996, 46.699999999999996, 32.50000000000002, 38.10000000000002, 46.5, 40.500000000000014, -50.00000000000044, 46.699999999999996, 37.70000000000003, -50.00000000000044, 38.300000000000026, 46.699999999999996, 38.10000000000002, 29.69999999999998, 44.5, 41.90000000000001, 44.300000000000004, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 17.099999999999802, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 36.70000000000003, 26.09999999999993, 23.8999999999999, 28.499999999999964, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 39.10000000000002, 12.69999999999974, 22.899999999999885, 46.699999999999996, 42.70000000000001, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 7.09999999999966, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.50000000000003, 45.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, 3.499999999999609, 44.900000000000006, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 2.8999999999996007, 39.300000000000026, 45.5, 46.3, 40.30000000000002, -50.00000000000044, 19.899999999999842, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.90000000000001, 44.10000000000001], "episode_lengths": [186, 84, 500, 500, 118, 500, 500, 48, 220, 34, 176, 120, 36, 96, 500, 34, 124, 500, 118, 34, 120, 204, 56, 82, 58, 500, 44, 48, 500, 36, 500, 500, 330, 82, 500, 500, 500, 52, 500, 48, 500, 500, 168, 500, 134, 240, 262, 216, 80, 500, 500, 46, 110, 374, 272, 34, 74, 28, 500, 500, 500, 114, 500, 430, 48, 500, 500, 68, 500, 126, 46, 500, 154, 500, 466, 52, 500, 388, 500, 500, 48, 500, 48, 500, 52, 500, 500, 92, 472, 108, 46, 38, 98, 500, 302, 500, 102, 500, 82, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3893580296304843, "mean_inference_ms": 1.2565247006151217, "mean_action_processing_ms": 0.14756558884353826, "mean_env_wait_ms": 0.08592231247682168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02209782600402832, "StateBufferConnector_ms": 0.011000871658325195, "ViewRequirementAgentConnector_ms": 0.1339282989501953}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.995999999999813, "episode_len_mean": 270.66, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.500000000000007, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, 28.09999999999996, 46.699999999999996, 32.50000000000002, 38.10000000000002, 46.5, 40.500000000000014, -50.00000000000044, 46.699999999999996, 37.70000000000003, -50.00000000000044, 38.300000000000026, 46.699999999999996, 38.10000000000002, 29.69999999999998, 44.5, 41.90000000000001, 44.300000000000004, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 17.099999999999802, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 36.70000000000003, 26.09999999999993, 23.8999999999999, 28.499999999999964, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 39.10000000000002, 12.69999999999974, 22.899999999999885, 46.699999999999996, 42.70000000000001, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 7.09999999999966, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.50000000000003, 45.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, 3.499999999999609, 44.900000000000006, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 2.8999999999996007, 39.300000000000026, 45.5, 46.3, 40.30000000000002, -50.00000000000044, 19.899999999999842, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.90000000000001, 44.10000000000001], "episode_lengths": [186, 84, 500, 500, 118, 500, 500, 48, 220, 34, 176, 120, 36, 96, 500, 34, 124, 500, 118, 34, 120, 204, 56, 82, 58, 500, 44, 48, 500, 36, 500, 500, 330, 82, 500, 500, 500, 52, 500, 48, 500, 500, 168, 500, 134, 240, 262, 216, 80, 500, 500, 46, 110, 374, 272, 34, 74, 28, 500, 500, 500, 114, 500, 430, 48, 500, 500, 68, 500, 126, 46, 500, 154, 500, 466, 52, 500, 388, 500, 500, 48, 500, 48, 500, 52, 500, 500, 92, 472, 108, 46, 38, 98, 500, 302, 500, 102, 500, 82, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3893580296304843, "mean_inference_ms": 1.2565247006151217, "mean_action_processing_ms": 0.14756558884353826, "mean_env_wait_ms": 0.08592231247682168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02209782600402832, "StateBufferConnector_ms": 0.011000871658325195, "ViewRequirementAgentConnector_ms": 0.1339282989501953}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4878.630755769473, "num_env_steps_trained_throughput_per_sec": 4878.630755769473, "timesteps_total": 228000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 2321.862, "sample_time_ms": 2055.359, "load_time_ms": 11.289, "load_throughput": 1062988.35, "learn_time_ms": 244.315, "learn_throughput": 49116.942, "synch_weights_time_ms": 9.828}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 804, "training_iteration": 19, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-05", "timestamp": 1698247625, "time_this_iter_s": 2.4644904136657715, "time_total_s": 42.750823736190796, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 42.750823736190796, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 61.775000000000006, "ram_util_percent": 27.125000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.8146972656250013e-07, "cur_lr": 0.0003, "total_loss": 6.563774077097575, "policy_loss": -0.0002052764097849528, "vf_loss": 6.564032046000163, "vf_explained_var": -1.3271967569986979e-06, "kl": 0.00044318698407247816, "entropy": 0.5291939655939738, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2699999999998015, "episode_len_mean": 277.92, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.8999999999999, 28.499999999999964, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 39.10000000000002, 12.69999999999974, 22.899999999999885, 46.699999999999996, 42.70000000000001, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 7.09999999999966, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.50000000000003, 45.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, 3.499999999999609, 44.900000000000006, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 2.8999999999996007, 39.300000000000026, 45.5, 46.3, 40.30000000000002, -50.00000000000044, 19.899999999999842, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.90000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.9, 41.100000000000016, 46.5, 45.3, -50.00000000000044, 27.49999999999995, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, 29.69999999999998, 40.90000000000002, 42.900000000000006, 46.3, 44.900000000000006, -50.00000000000044, 1.099999999999575, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.70000000000001, 30.699999999999996, -50.00000000000044, 16.29999999999979, 37.90000000000003, 46.9, -50.00000000000044, -50.00000000000044, 21.09999999999986, 46.5, 44.10000000000001, 42.70000000000001, -50.00000000000044, 15.49999999999978, 44.7, 8.899999999999686, 46.9, -50.00000000000044], "episode_lengths": [262, 216, 80, 500, 500, 46, 110, 374, 272, 34, 74, 28, 500, 500, 500, 114, 500, 430, 48, 500, 500, 68, 500, 126, 46, 500, 154, 500, 466, 52, 500, 388, 500, 500, 48, 500, 48, 500, 52, 500, 500, 92, 472, 108, 46, 38, 98, 500, 302, 500, 102, 500, 82, 60, 500, 500, 90, 500, 500, 42, 90, 36, 48, 500, 226, 500, 100, 500, 42, 204, 92, 72, 38, 52, 500, 490, 500, 118, 500, 500, 52, 500, 74, 194, 500, 338, 122, 32, 500, 500, 290, 36, 60, 74, 500, 346, 54, 412, 32, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39128898991441974, "mean_inference_ms": 1.2639857054805155, "mean_action_processing_ms": 0.1485028505068559, "mean_env_wait_ms": 0.08729368956541066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026533126831054688, "StateBufferConnector_ms": 0.008004426956176758, "ViewRequirementAgentConnector_ms": 0.15063047409057617}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2699999999998015, "episode_len_mean": 277.92, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.8999999999999, 28.499999999999964, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 39.10000000000002, 12.69999999999974, 22.899999999999885, 46.699999999999996, 42.70000000000001, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 7.09999999999966, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.50000000000003, 45.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, 3.499999999999609, 44.900000000000006, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 2.8999999999996007, 39.300000000000026, 45.5, 46.3, 40.30000000000002, -50.00000000000044, 19.899999999999842, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.90000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.9, 41.100000000000016, 46.5, 45.3, -50.00000000000044, 27.49999999999995, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, 29.69999999999998, 40.90000000000002, 42.900000000000006, 46.3, 44.900000000000006, -50.00000000000044, 1.099999999999575, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.70000000000001, 30.699999999999996, -50.00000000000044, 16.29999999999979, 37.90000000000003, 46.9, -50.00000000000044, -50.00000000000044, 21.09999999999986, 46.5, 44.10000000000001, 42.70000000000001, -50.00000000000044, 15.49999999999978, 44.7, 8.899999999999686, 46.9, -50.00000000000044], "episode_lengths": [262, 216, 80, 500, 500, 46, 110, 374, 272, 34, 74, 28, 500, 500, 500, 114, 500, 430, 48, 500, 500, 68, 500, 126, 46, 500, 154, 500, 466, 52, 500, 388, 500, 500, 48, 500, 48, 500, 52, 500, 500, 92, 472, 108, 46, 38, 98, 500, 302, 500, 102, 500, 82, 60, 500, 500, 90, 500, 500, 42, 90, 36, 48, 500, 226, 500, 100, 500, 42, 204, 92, 72, 38, 52, 500, 490, 500, 118, 500, 500, 52, 500, 74, 194, 500, 338, 122, 32, 500, 500, 290, 36, 60, 74, 500, 346, 54, 412, 32, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39128898991441974, "mean_inference_ms": 1.2639857054805155, "mean_action_processing_ms": 0.1485028505068559, "mean_env_wait_ms": 0.08729368956541066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026533126831054688, "StateBufferConnector_ms": 0.008004426956176758, "ViewRequirementAgentConnector_ms": 0.15063047409057617}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4653.357741166029, "num_env_steps_trained_throughput_per_sec": 4653.357741166029, "timesteps_total": 240000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 2351.138, "sample_time_ms": 2086.173, "load_time_ms": 11.185, "load_throughput": 1072846.927, "learn_time_ms": 242.575, "learn_throughput": 49469.323, "synch_weights_time_ms": 10.035}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 850, "training_iteration": 20, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-07", "timestamp": 1698247627, "time_this_iter_s": 2.583782434463501, "time_total_s": 45.3346061706543, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 45.3346061706543, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 69.23333333333333, "ram_util_percent": 31.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125006e-07, "cur_lr": 0.0003, "total_loss": 6.702935218811035, "policy_loss": 1.619579270482063e-05, "vf_loss": 6.70297679901123, "vf_explained_var": -5.642573038736979e-07, "kl": 0.00013264469891206924, "entropy": 0.5788850108782451, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 308.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.601999999999817, "episode_len_mean": 264.62, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 40.30000000000002, -50.00000000000044, 19.899999999999842, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.90000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.9, 41.100000000000016, 46.5, 45.3, -50.00000000000044, 27.49999999999995, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, 29.69999999999998, 40.90000000000002, 42.900000000000006, 46.3, 44.900000000000006, -50.00000000000044, 1.099999999999575, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.70000000000001, 30.699999999999996, -50.00000000000044, 16.29999999999979, 37.90000000000003, 46.9, -50.00000000000044, -50.00000000000044, 21.09999999999986, 46.5, 44.10000000000001, 42.70000000000001, -50.00000000000044, 15.49999999999978, 44.7, 8.899999999999686, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, 40.10000000000002, 40.30000000000002, 18.499999999999822, 36.10000000000004, 38.10000000000002, 40.90000000000002, 39.10000000000002, -50.00000000000044, 29.299999999999976, 12.499999999999737, 39.70000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 23.499999999999893, 46.5, 42.30000000000001, 35.10000000000004, -50.00000000000044, 44.7, 47.5, 46.5, 45.5, -50.00000000000044, 38.90000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.900000000000006, 44.7, 7.499999999999666, 42.70000000000001, -50.00000000000044, 44.900000000000006], "episode_lengths": [38, 98, 500, 302, 500, 102, 500, 82, 60, 500, 500, 90, 500, 500, 42, 90, 36, 48, 500, 226, 500, 100, 500, 42, 204, 92, 72, 38, 52, 500, 490, 500, 118, 500, 500, 52, 500, 74, 194, 500, 338, 122, 32, 500, 500, 290, 36, 60, 74, 500, 346, 54, 412, 32, 500, 500, 500, 500, 462, 500, 500, 100, 98, 316, 140, 120, 92, 110, 500, 208, 376, 104, 500, 132, 500, 500, 500, 92, 266, 36, 78, 150, 500, 54, 26, 36, 46, 500, 112, 60, 500, 500, 52, 500, 52, 54, 426, 74, 500, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3937083717851811, "mean_inference_ms": 1.271751942319436, "mean_action_processing_ms": 0.14939928049711765, "mean_env_wait_ms": 0.08795622750662378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02953195571899414, "StateBufferConnector_ms": 0.007004261016845703, "ViewRequirementAgentConnector_ms": 0.17354559898376465}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.601999999999817, "episode_len_mean": 264.62, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 40.30000000000002, -50.00000000000044, 19.899999999999842, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.90000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.9, 41.100000000000016, 46.5, 45.3, -50.00000000000044, 27.49999999999995, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, 29.69999999999998, 40.90000000000002, 42.900000000000006, 46.3, 44.900000000000006, -50.00000000000044, 1.099999999999575, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.70000000000001, 30.699999999999996, -50.00000000000044, 16.29999999999979, 37.90000000000003, 46.9, -50.00000000000044, -50.00000000000044, 21.09999999999986, 46.5, 44.10000000000001, 42.70000000000001, -50.00000000000044, 15.49999999999978, 44.7, 8.899999999999686, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, 40.10000000000002, 40.30000000000002, 18.499999999999822, 36.10000000000004, 38.10000000000002, 40.90000000000002, 39.10000000000002, -50.00000000000044, 29.299999999999976, 12.499999999999737, 39.70000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 23.499999999999893, 46.5, 42.30000000000001, 35.10000000000004, -50.00000000000044, 44.7, 47.5, 46.5, 45.5, -50.00000000000044, 38.90000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.900000000000006, 44.7, 7.499999999999666, 42.70000000000001, -50.00000000000044, 44.900000000000006], "episode_lengths": [38, 98, 500, 302, 500, 102, 500, 82, 60, 500, 500, 90, 500, 500, 42, 90, 36, 48, 500, 226, 500, 100, 500, 42, 204, 92, 72, 38, 52, 500, 490, 500, 118, 500, 500, 52, 500, 74, 194, 500, 338, 122, 32, 500, 500, 290, 36, 60, 74, 500, 346, 54, 412, 32, 500, 500, 500, 500, 462, 500, 500, 100, 98, 316, 140, 120, 92, 110, 500, 208, 376, 104, 500, 132, 500, 500, 500, 92, 266, 36, 78, 150, 500, 54, 26, 36, 46, 500, 112, 60, 500, 500, 52, 500, 52, 54, 426, 74, 500, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3937083717851811, "mean_inference_ms": 1.271751942319436, "mean_action_processing_ms": 0.14939928049711765, "mean_env_wait_ms": 0.08795622750662378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02953195571899414, "StateBufferConnector_ms": 0.007004261016845703, "ViewRequirementAgentConnector_ms": 0.17354559898376465}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4694.360590822784, "num_env_steps_trained_throughput_per_sec": 4694.360590822784, "timesteps_total": 252000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 2404.514, "sample_time_ms": 2114.924, "load_time_ms": 12.081, "load_throughput": 993298.915, "learn_time_ms": 266.356, "learn_throughput": 45052.435, "synch_weights_time_ms": 9.982}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 895, "training_iteration": 21, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-10", "timestamp": 1698247630, "time_this_iter_s": 2.56125545501709, "time_total_s": 47.89586162567139, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 47.89586162567139, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 63.074999999999996, "ram_util_percent": 34.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062503e-08, "cur_lr": 0.0003, "total_loss": 6.717987950642904, "policy_loss": -0.0003315005335025489, "vf_loss": 6.718376286824545, "vf_explained_var": -2.2252400716145835e-06, "kl": 0.0004646962740063524, "entropy": 0.5673560976982117, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 323.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.966999999999821, "episode_len_mean": 265.96, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 42.70000000000001, -50.00000000000044, 15.49999999999978, 44.7, 8.899999999999686, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, 40.10000000000002, 40.30000000000002, 18.499999999999822, 36.10000000000004, 38.10000000000002, 40.90000000000002, 39.10000000000002, -50.00000000000044, 29.299999999999976, 12.499999999999737, 39.70000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 23.499999999999893, 46.5, 42.30000000000001, 35.10000000000004, -50.00000000000044, 44.7, 47.5, 46.5, 45.5, -50.00000000000044, 38.90000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.900000000000006, 44.7, 7.499999999999666, 42.70000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 30.499999999999993, 46.5, -50.00000000000044, -50.00000000000044, 47.3, 30.9, 42.70000000000001, 35.70000000000003, 43.7, -50.00000000000044, -50.00000000000044, 43.7, 42.30000000000001, -50.00000000000044, 44.900000000000006, 40.30000000000002, 46.099999999999994, 42.10000000000001, -50.00000000000044, 45.1, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 22.899999999999885, -50.00000000000044, 28.499999999999964, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 44.300000000000004, 47.3, 44.10000000000001, 39.70000000000002, 38.50000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 41.90000000000001], "episode_lengths": [60, 74, 500, 346, 54, 412, 32, 500, 500, 500, 500, 462, 500, 500, 100, 98, 316, 140, 120, 92, 110, 500, 208, 376, 104, 500, 132, 500, 500, 500, 92, 266, 36, 78, 150, 500, 54, 26, 36, 46, 500, 112, 60, 500, 500, 52, 500, 52, 54, 426, 74, 500, 52, 500, 500, 86, 196, 36, 500, 500, 28, 192, 74, 144, 64, 500, 500, 64, 78, 500, 52, 98, 40, 80, 500, 50, 362, 500, 500, 500, 154, 272, 500, 216, 500, 188, 500, 500, 500, 500, 212, 58, 28, 60, 104, 116, 500, 60, 500, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39525995728735824, "mean_inference_ms": 1.2769412518194312, "mean_action_processing_ms": 0.14975440594763803, "mean_env_wait_ms": 0.08776579698626943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000664710998535, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.16252851486206055}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.966999999999821, "episode_len_mean": 265.96, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 42.70000000000001, -50.00000000000044, 15.49999999999978, 44.7, 8.899999999999686, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, 40.10000000000002, 40.30000000000002, 18.499999999999822, 36.10000000000004, 38.10000000000002, 40.90000000000002, 39.10000000000002, -50.00000000000044, 29.299999999999976, 12.499999999999737, 39.70000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 23.499999999999893, 46.5, 42.30000000000001, 35.10000000000004, -50.00000000000044, 44.7, 47.5, 46.5, 45.5, -50.00000000000044, 38.90000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.900000000000006, 44.7, 7.499999999999666, 42.70000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 30.499999999999993, 46.5, -50.00000000000044, -50.00000000000044, 47.3, 30.9, 42.70000000000001, 35.70000000000003, 43.7, -50.00000000000044, -50.00000000000044, 43.7, 42.30000000000001, -50.00000000000044, 44.900000000000006, 40.30000000000002, 46.099999999999994, 42.10000000000001, -50.00000000000044, 45.1, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 22.899999999999885, -50.00000000000044, 28.499999999999964, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 44.300000000000004, 47.3, 44.10000000000001, 39.70000000000002, 38.50000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 41.90000000000001], "episode_lengths": [60, 74, 500, 346, 54, 412, 32, 500, 500, 500, 500, 462, 500, 500, 100, 98, 316, 140, 120, 92, 110, 500, 208, 376, 104, 500, 132, 500, 500, 500, 92, 266, 36, 78, 150, 500, 54, 26, 36, 46, 500, 112, 60, 500, 500, 52, 500, 52, 54, 426, 74, 500, 52, 500, 500, 86, 196, 36, 500, 500, 28, 192, 74, 144, 64, 500, 500, 64, 78, 500, 52, 98, 40, 80, 500, 50, 362, 500, 500, 500, 154, 272, 500, 216, 500, 188, 500, 500, 500, 500, 212, 58, 28, 60, 104, 116, 500, 60, 500, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39525995728735824, "mean_inference_ms": 1.2769412518194312, "mean_action_processing_ms": 0.14975440594763803, "mean_env_wait_ms": 0.08776579698626943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000664710998535, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.16252851486206055}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5422.62592809465, "num_env_steps_trained_throughput_per_sec": 5422.62592809465, "timesteps_total": 264000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 2412.328, "sample_time_ms": 2119.445, "load_time_ms": 12.283, "load_throughput": 976992.948, "learn_time_ms": 269.357, "learn_throughput": 44550.495, "synch_weights_time_ms": 9.973}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 942, "training_iteration": 22, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-12", "timestamp": 1698247632, "time_this_iter_s": 2.2179484367370605, "time_total_s": 50.11381006240845, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 50.11381006240845, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 61.5, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.7683715820312516e-08, "cur_lr": 0.0003, "total_loss": 7.338402366638183, "policy_loss": 4.4158597787221274e-05, "vf_loss": 7.338417116800944, "vf_explained_var": 1.3669331868489583e-06, "kl": 0.0002768364447092608, "entropy": 0.5900513450304667, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.822999999999858, "episode_len_mean": 237.44, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.3, 30.9, 42.70000000000001, 35.70000000000003, 43.7, -50.00000000000044, -50.00000000000044, 43.7, 42.30000000000001, -50.00000000000044, 44.900000000000006, 40.30000000000002, 46.099999999999994, 42.10000000000001, -50.00000000000044, 45.1, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 22.899999999999885, -50.00000000000044, 28.499999999999964, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 44.300000000000004, 47.3, 44.10000000000001, 39.70000000000002, 38.50000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 41.90000000000001, 41.100000000000016, 34.30000000000004, 43.10000000000001, 43.10000000000001, 31.500000000000007, 41.30000000000001, 41.90000000000001, 44.10000000000001, 42.900000000000006, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.100000000000016, 33.90000000000004, 46.099999999999994, 42.10000000000001, 42.70000000000001, -50.00000000000044, 37.10000000000003, 42.30000000000001, -50.00000000000044, 40.30000000000002, 42.10000000000001, 31.900000000000013, 43.10000000000001, 19.299999999999834, 29.899999999999984, 45.3, 34.50000000000004, -50.00000000000044, 44.10000000000001, 43.900000000000006, 42.500000000000014, -50.00000000000044, 35.900000000000034, 42.10000000000001, 33.70000000000004, -50.00000000000044, 35.500000000000036, 34.10000000000004, 45.3, 44.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 44.10000000000001, 38.700000000000024, -50.00000000000044], "episode_lengths": [500, 500, 28, 192, 74, 144, 64, 500, 500, 64, 78, 500, 52, 98, 40, 80, 500, 50, 362, 500, 500, 500, 154, 272, 500, 216, 500, 188, 500, 500, 500, 500, 212, 58, 28, 60, 104, 116, 500, 60, 500, 82, 90, 158, 70, 70, 186, 88, 82, 60, 72, 146, 500, 500, 500, 90, 500, 500, 500, 136, 500, 90, 162, 40, 80, 74, 500, 130, 78, 500, 98, 80, 182, 70, 308, 202, 48, 156, 500, 60, 62, 76, 500, 142, 80, 164, 500, 146, 160, 48, 56, 500, 58, 500, 500, 46, 50, 60, 114, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3959986067744224, "mean_inference_ms": 1.278766448577105, "mean_action_processing_ms": 0.15018973048285017, "mean_env_wait_ms": 0.08832990709921472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02901148796081543, "StateBufferConnector_ms": 0.0050029754638671875, "ViewRequirementAgentConnector_ms": 0.14100432395935059}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.822999999999858, "episode_len_mean": 237.44, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.3, 30.9, 42.70000000000001, 35.70000000000003, 43.7, -50.00000000000044, -50.00000000000044, 43.7, 42.30000000000001, -50.00000000000044, 44.900000000000006, 40.30000000000002, 46.099999999999994, 42.10000000000001, -50.00000000000044, 45.1, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 22.899999999999885, -50.00000000000044, 28.499999999999964, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 44.300000000000004, 47.3, 44.10000000000001, 39.70000000000002, 38.50000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 41.90000000000001, 41.100000000000016, 34.30000000000004, 43.10000000000001, 43.10000000000001, 31.500000000000007, 41.30000000000001, 41.90000000000001, 44.10000000000001, 42.900000000000006, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.100000000000016, 33.90000000000004, 46.099999999999994, 42.10000000000001, 42.70000000000001, -50.00000000000044, 37.10000000000003, 42.30000000000001, -50.00000000000044, 40.30000000000002, 42.10000000000001, 31.900000000000013, 43.10000000000001, 19.299999999999834, 29.899999999999984, 45.3, 34.50000000000004, -50.00000000000044, 44.10000000000001, 43.900000000000006, 42.500000000000014, -50.00000000000044, 35.900000000000034, 42.10000000000001, 33.70000000000004, -50.00000000000044, 35.500000000000036, 34.10000000000004, 45.3, 44.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 44.10000000000001, 38.700000000000024, -50.00000000000044], "episode_lengths": [500, 500, 28, 192, 74, 144, 64, 500, 500, 64, 78, 500, 52, 98, 40, 80, 500, 50, 362, 500, 500, 500, 154, 272, 500, 216, 500, 188, 500, 500, 500, 500, 212, 58, 28, 60, 104, 116, 500, 60, 500, 82, 90, 158, 70, 70, 186, 88, 82, 60, 72, 146, 500, 500, 500, 90, 500, 500, 500, 136, 500, 90, 162, 40, 80, 74, 500, 130, 78, 500, 98, 80, 182, 70, 308, 202, 48, 156, 500, 60, 62, 76, 500, 142, 80, 164, 500, 146, 160, 48, 56, 500, 58, 500, 500, 46, 50, 60, 114, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3959986067744224, "mean_inference_ms": 1.278766448577105, "mean_action_processing_ms": 0.15018973048285017, "mean_env_wait_ms": 0.08832990709921472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02901148796081543, "StateBufferConnector_ms": 0.0050029754638671875, "ViewRequirementAgentConnector_ms": 0.14100432395935059}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5215.621856273649, "num_env_steps_trained_throughput_per_sec": 5215.621856273649, "timesteps_total": 276000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 2426.079, "sample_time_ms": 2129.677, "load_time_ms": 12.156, "load_throughput": 987164.109, "learn_time_ms": 273.158, "learn_throughput": 43930.68, "synch_weights_time_ms": 9.918}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1000, "training_iteration": 23, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-14", "timestamp": 1698247634, "time_this_iter_s": 2.304779529571533, "time_total_s": 52.41858959197998, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 52.41858959197998, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 64.16666666666667, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156258e-08, "cur_lr": 0.0003, "total_loss": 6.564591916402181, "policy_loss": -0.00035527870059013365, "vf_loss": 6.565007623036703, "vf_explained_var": -1.3629595438639323e-06, "kl": 0.0009761271309040846, "entropy": 0.6041634519894917, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.11199999999987, "episode_len_mean": 229.6, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 34.30000000000004, 43.10000000000001, 43.10000000000001, 31.500000000000007, 41.30000000000001, 41.90000000000001, 44.10000000000001, 42.900000000000006, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.100000000000016, 33.90000000000004, 46.099999999999994, 42.10000000000001, 42.70000000000001, -50.00000000000044, 37.10000000000003, 42.30000000000001, -50.00000000000044, 40.30000000000002, 42.10000000000001, 31.900000000000013, 43.10000000000001, 19.299999999999834, 29.899999999999984, 45.3, 34.50000000000004, -50.00000000000044, 44.10000000000001, 43.900000000000006, 42.500000000000014, -50.00000000000044, 35.900000000000034, 42.10000000000001, 33.70000000000004, -50.00000000000044, 35.500000000000036, 34.10000000000004, 45.3, 44.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 44.10000000000001, 38.700000000000024, -50.00000000000044, 40.10000000000002, 29.899999999999984, -50.00000000000044, 1.099999999999575, 45.5, 41.90000000000001, 41.100000000000016, -50.00000000000044, 34.70000000000004, 9.699999999999697, 11.29999999999972, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.699999999999626, 45.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.099999999999994, 36.70000000000003, 40.500000000000014, -50.00000000000044, 46.099999999999994, 40.10000000000002, 43.7, 40.500000000000014, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.10000000000001, -50.00000000000044, 33.10000000000003, 33.90000000000004, 32.700000000000024, 38.90000000000002, 42.30000000000001, 12.499999999999737, 44.900000000000006, 42.70000000000001, -50.00000000000044], "episode_lengths": [90, 158, 70, 70, 186, 88, 82, 60, 72, 146, 500, 500, 500, 90, 500, 500, 500, 136, 500, 90, 162, 40, 80, 74, 500, 130, 78, 500, 98, 80, 182, 70, 308, 202, 48, 156, 500, 60, 62, 76, 500, 142, 80, 164, 500, 146, 160, 48, 56, 500, 58, 500, 500, 46, 50, 60, 114, 500, 100, 202, 500, 490, 46, 82, 90, 500, 154, 404, 388, 500, 500, 500, 454, 42, 122, 500, 500, 100, 40, 134, 96, 500, 40, 100, 64, 96, 500, 90, 500, 60, 500, 170, 162, 174, 112, 78, 376, 52, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39581203904645107, "mean_inference_ms": 1.2762459080828428, "mean_action_processing_ms": 0.1505595368647166, "mean_env_wait_ms": 0.08872138733067658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700948715209961, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.14203572273254395}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.11199999999987, "episode_len_mean": 229.6, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 34.30000000000004, 43.10000000000001, 43.10000000000001, 31.500000000000007, 41.30000000000001, 41.90000000000001, 44.10000000000001, 42.900000000000006, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.100000000000016, 33.90000000000004, 46.099999999999994, 42.10000000000001, 42.70000000000001, -50.00000000000044, 37.10000000000003, 42.30000000000001, -50.00000000000044, 40.30000000000002, 42.10000000000001, 31.900000000000013, 43.10000000000001, 19.299999999999834, 29.899999999999984, 45.3, 34.50000000000004, -50.00000000000044, 44.10000000000001, 43.900000000000006, 42.500000000000014, -50.00000000000044, 35.900000000000034, 42.10000000000001, 33.70000000000004, -50.00000000000044, 35.500000000000036, 34.10000000000004, 45.3, 44.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 44.10000000000001, 38.700000000000024, -50.00000000000044, 40.10000000000002, 29.899999999999984, -50.00000000000044, 1.099999999999575, 45.5, 41.90000000000001, 41.100000000000016, -50.00000000000044, 34.70000000000004, 9.699999999999697, 11.29999999999972, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.699999999999626, 45.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.099999999999994, 36.70000000000003, 40.500000000000014, -50.00000000000044, 46.099999999999994, 40.10000000000002, 43.7, 40.500000000000014, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.10000000000001, -50.00000000000044, 33.10000000000003, 33.90000000000004, 32.700000000000024, 38.90000000000002, 42.30000000000001, 12.499999999999737, 44.900000000000006, 42.70000000000001, -50.00000000000044], "episode_lengths": [90, 158, 70, 70, 186, 88, 82, 60, 72, 146, 500, 500, 500, 90, 500, 500, 500, 136, 500, 90, 162, 40, 80, 74, 500, 130, 78, 500, 98, 80, 182, 70, 308, 202, 48, 156, 500, 60, 62, 76, 500, 142, 80, 164, 500, 146, 160, 48, 56, 500, 58, 500, 500, 46, 50, 60, 114, 500, 100, 202, 500, 490, 46, 82, 90, 500, 154, 404, 388, 500, 500, 500, 454, 42, 122, 500, 500, 100, 40, 134, 96, 500, 40, 100, 64, 96, 500, 90, 500, 60, 500, 170, 162, 174, 112, 78, 376, 52, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39581203904645107, "mean_inference_ms": 1.2762459080828428, "mean_action_processing_ms": 0.1505595368647166, "mean_env_wait_ms": 0.08872138733067658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700948715209961, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.14203572273254395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5601.065202476941, "num_env_steps_trained_throughput_per_sec": 5601.065202476941, "timesteps_total": 288000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 2405.194, "sample_time_ms": 2127.241, "load_time_ms": 11.078, "load_throughput": 1083258.321, "learn_time_ms": 256.07, "learn_throughput": 46862.196, "synch_weights_time_ms": 9.565}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1042, "training_iteration": 24, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-17", "timestamp": 1698247637, "time_this_iter_s": 2.151219129562378, "time_total_s": 54.56980872154236, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 54.56980872154236, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 55.375, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078129e-08, "cur_lr": 0.0003, "total_loss": 5.702286338806152, "policy_loss": -0.0001227023700873057, "vf_loss": 5.702458922068278, "vf_explained_var": -2.956390380859375e-06, "kl": 0.00014060664110123375, "entropy": 0.4988665779431661, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 368.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.589999999999833, "episode_len_mean": 254.76, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.900000000000034, 42.10000000000001, 33.70000000000004, -50.00000000000044, 35.500000000000036, 34.10000000000004, 45.3, 44.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 44.10000000000001, 38.700000000000024, -50.00000000000044, 40.10000000000002, 29.899999999999984, -50.00000000000044, 1.099999999999575, 45.5, 41.90000000000001, 41.100000000000016, -50.00000000000044, 34.70000000000004, 9.699999999999697, 11.29999999999972, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.699999999999626, 45.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.099999999999994, 36.70000000000003, 40.500000000000014, -50.00000000000044, 46.099999999999994, 40.10000000000002, 43.7, 40.500000000000014, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.10000000000001, -50.00000000000044, 33.10000000000003, 33.90000000000004, 32.700000000000024, 38.90000000000002, 42.30000000000001, 12.499999999999737, 44.900000000000006, 42.70000000000001, -50.00000000000044, 8.299999999999677, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 42.500000000000014, 18.699999999999825, 36.10000000000004, -50.00000000000044, 46.3, 35.30000000000004, 45.3, 35.900000000000034, -50.00000000000044, 43.7, -50.00000000000044, 19.299999999999834, 45.5, 46.099999999999994, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.30000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 39.10000000000002, 40.70000000000002, 44.5, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044], "episode_lengths": [142, 80, 164, 500, 146, 160, 48, 56, 500, 58, 500, 500, 46, 50, 60, 114, 500, 100, 202, 500, 490, 46, 82, 90, 500, 154, 404, 388, 500, 500, 500, 454, 42, 122, 500, 500, 100, 40, 134, 96, 500, 40, 100, 64, 96, 500, 90, 500, 60, 500, 170, 162, 174, 112, 78, 376, 52, 74, 500, 418, 500, 500, 56, 40, 76, 314, 140, 500, 38, 148, 48, 142, 500, 64, 500, 308, 46, 40, 500, 116, 500, 500, 34, 68, 112, 500, 500, 500, 116, 110, 94, 56, 500, 124, 500, 500, 500, 500, 52, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39428399154150184, "mean_inference_ms": 1.2740168967448555, "mean_action_processing_ms": 0.1499789063578099, "mean_env_wait_ms": 0.08854897778954171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03201031684875488, "StateBufferConnector_ms": 0.009232759475708008, "ViewRequirementAgentConnector_ms": 0.1400449275970459}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.589999999999833, "episode_len_mean": 254.76, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.900000000000034, 42.10000000000001, 33.70000000000004, -50.00000000000044, 35.500000000000036, 34.10000000000004, 45.3, 44.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 44.10000000000001, 38.700000000000024, -50.00000000000044, 40.10000000000002, 29.899999999999984, -50.00000000000044, 1.099999999999575, 45.5, 41.90000000000001, 41.100000000000016, -50.00000000000044, 34.70000000000004, 9.699999999999697, 11.29999999999972, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.699999999999626, 45.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.099999999999994, 36.70000000000003, 40.500000000000014, -50.00000000000044, 46.099999999999994, 40.10000000000002, 43.7, 40.500000000000014, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.10000000000001, -50.00000000000044, 33.10000000000003, 33.90000000000004, 32.700000000000024, 38.90000000000002, 42.30000000000001, 12.499999999999737, 44.900000000000006, 42.70000000000001, -50.00000000000044, 8.299999999999677, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 42.500000000000014, 18.699999999999825, 36.10000000000004, -50.00000000000044, 46.3, 35.30000000000004, 45.3, 35.900000000000034, -50.00000000000044, 43.7, -50.00000000000044, 19.299999999999834, 45.5, 46.099999999999994, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.30000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 39.10000000000002, 40.70000000000002, 44.5, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044], "episode_lengths": [142, 80, 164, 500, 146, 160, 48, 56, 500, 58, 500, 500, 46, 50, 60, 114, 500, 100, 202, 500, 490, 46, 82, 90, 500, 154, 404, 388, 500, 500, 500, 454, 42, 122, 500, 500, 100, 40, 134, 96, 500, 40, 100, 64, 96, 500, 90, 500, 60, 500, 170, 162, 174, 112, 78, 376, 52, 74, 500, 418, 500, 500, 56, 40, 76, 314, 140, 500, 38, 148, 48, 142, 500, 64, 500, 308, 46, 40, 500, 116, 500, 500, 34, 68, 112, 500, 500, 500, 116, 110, 94, 56, 500, 124, 500, 500, 500, 500, 52, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39428399154150184, "mean_inference_ms": 1.2740168967448555, "mean_action_processing_ms": 0.1499789063578099, "mean_env_wait_ms": 0.08854897778954171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03201031684875488, "StateBufferConnector_ms": 0.009232759475708008, "ViewRequirementAgentConnector_ms": 0.1400449275970459}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5345.84714139308, "num_env_steps_trained_throughput_per_sec": 5345.84714139308, "timesteps_total": 300000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 2424.284, "sample_time_ms": 2137.9, "load_time_ms": 12.291, "load_throughput": 976306.915, "learn_time_ms": 263.236, "learn_throughput": 45586.388, "synch_weights_time_ms": 9.616}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 1083, "training_iteration": 25, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-19", "timestamp": 1698247639, "time_this_iter_s": 2.24973201751709, "time_total_s": 56.81954073905945, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 56.81954073905945, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 62.56666666666666, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.9604644775390645e-09, "cur_lr": 0.0003, "total_loss": 6.308081150054932, "policy_loss": -0.00029986277222633363, "vf_loss": 6.308439064025879, "vf_explained_var": 1.231829325358073e-07, "kl": 0.00041045148818170675, "entropy": 0.5800772746404012, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.952999999999821, "episode_len_mean": 266.08, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, 44.10000000000001, -50.00000000000044, 33.10000000000003, 33.90000000000004, 32.700000000000024, 38.90000000000002, 42.30000000000001, 12.499999999999737, 44.900000000000006, 42.70000000000001, -50.00000000000044, 8.299999999999677, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 42.500000000000014, 18.699999999999825, 36.10000000000004, -50.00000000000044, 46.3, 35.30000000000004, 45.3, 35.900000000000034, -50.00000000000044, 43.7, -50.00000000000044, 19.299999999999834, 45.5, 46.099999999999994, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.30000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 39.10000000000002, 40.70000000000002, 44.5, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 18.29999999999982, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.5, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 22.299999999999876, 16.8999999999998, 42.30000000000001, 42.70000000000001, 39.300000000000026, 40.30000000000002, 35.70000000000003, -50.00000000000044, 41.30000000000001, 45.1, -50.00000000000044, 33.70000000000004, 43.50000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 44.5, 37.90000000000003, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.5, 38.50000000000003], "episode_lengths": [90, 500, 60, 500, 170, 162, 174, 112, 78, 376, 52, 74, 500, 418, 500, 500, 56, 40, 76, 314, 140, 500, 38, 148, 48, 142, 500, 64, 500, 308, 46, 40, 500, 116, 500, 500, 34, 68, 112, 500, 500, 500, 116, 110, 94, 56, 500, 124, 500, 500, 500, 500, 52, 500, 500, 500, 500, 80, 318, 102, 500, 500, 64, 500, 36, 50, 62, 500, 500, 72, 500, 500, 82, 500, 278, 332, 78, 74, 108, 98, 144, 500, 88, 50, 500, 164, 66, 130, 500, 500, 500, 500, 50, 56, 122, 144, 500, 500, 36, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3936160053725355, "mean_inference_ms": 1.274434382154121, "mean_action_processing_ms": 0.14937067797279724, "mean_env_wait_ms": 0.08833870974636121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031025171279907227, "StateBufferConnector_ms": 0.00722956657409668, "ViewRequirementAgentConnector_ms": 0.11057138442993164}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.952999999999821, "episode_len_mean": 266.08, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, 44.10000000000001, -50.00000000000044, 33.10000000000003, 33.90000000000004, 32.700000000000024, 38.90000000000002, 42.30000000000001, 12.499999999999737, 44.900000000000006, 42.70000000000001, -50.00000000000044, 8.299999999999677, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 42.500000000000014, 18.699999999999825, 36.10000000000004, -50.00000000000044, 46.3, 35.30000000000004, 45.3, 35.900000000000034, -50.00000000000044, 43.7, -50.00000000000044, 19.299999999999834, 45.5, 46.099999999999994, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.30000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 39.10000000000002, 40.70000000000002, 44.5, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 18.29999999999982, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.5, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 22.299999999999876, 16.8999999999998, 42.30000000000001, 42.70000000000001, 39.300000000000026, 40.30000000000002, 35.70000000000003, -50.00000000000044, 41.30000000000001, 45.1, -50.00000000000044, 33.70000000000004, 43.50000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 44.5, 37.90000000000003, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.5, 38.50000000000003], "episode_lengths": [90, 500, 60, 500, 170, 162, 174, 112, 78, 376, 52, 74, 500, 418, 500, 500, 56, 40, 76, 314, 140, 500, 38, 148, 48, 142, 500, 64, 500, 308, 46, 40, 500, 116, 500, 500, 34, 68, 112, 500, 500, 500, 116, 110, 94, 56, 500, 124, 500, 500, 500, 500, 52, 500, 500, 500, 500, 80, 318, 102, 500, 500, 64, 500, 36, 50, 62, 500, 500, 72, 500, 500, 82, 500, 278, 332, 78, 74, 108, 98, 144, 500, 88, 50, 500, 164, 66, 130, 500, 500, 500, 500, 50, 56, 122, 144, 500, 500, 36, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3936160053725355, "mean_inference_ms": 1.274434382154121, "mean_action_processing_ms": 0.14937067797279724, "mean_env_wait_ms": 0.08833870974636121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031025171279907227, "StateBufferConnector_ms": 0.00722956657409668, "ViewRequirementAgentConnector_ms": 0.11057138442993164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5731.659177300959, "num_env_steps_trained_throughput_per_sec": 5731.659177300959, "timesteps_total": 312000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 2400.516, "sample_time_ms": 2145.894, "load_time_ms": 11.358, "load_throughput": 1056544.103, "learn_time_ms": 232.509, "learn_throughput": 51610.812, "synch_weights_time_ms": 9.615}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 1129, "training_iteration": 26, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-21", "timestamp": 1698247641, "time_this_iter_s": 2.099632740020752, "time_total_s": 58.9191734790802, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 58.9191734790802, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 64.43333333333334, "ram_util_percent": 35.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9802322387695322e-09, "cur_lr": 0.0003, "total_loss": 6.9726844469706215, "policy_loss": -0.0004113528877496719, "vf_loss": 6.973152351379395, "vf_explained_var": -4.172325134277344e-07, "kl": 0.0005135054728649872, "entropy": 0.5649475892384846, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 398.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5619999999998218, "episode_len_mean": 264.98, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 18.29999999999982, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.5, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 22.299999999999876, 16.8999999999998, 42.30000000000001, 42.70000000000001, 39.300000000000026, 40.30000000000002, 35.70000000000003, -50.00000000000044, 41.30000000000001, 45.1, -50.00000000000044, 33.70000000000004, 43.50000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 44.5, 37.90000000000003, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.5, 38.50000000000003, -50.00000000000044, 40.30000000000002, 40.500000000000014, -50.00000000000044, 44.7, 45.9, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.3, 47.1, -50.00000000000044, -50.00000000000044, 47.5, 31.900000000000013, 41.500000000000014, 41.100000000000016, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.9, 43.10000000000001, -50.00000000000044, 16.8999999999998, 45.3, 41.100000000000016, 35.900000000000034, 28.89999999999997, 32.30000000000002, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 38.50000000000003, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.30000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 19.499999999999837, -50.00000000000044, 39.10000000000002, 37.70000000000003, 36.70000000000003, 45.1], "episode_lengths": [500, 500, 500, 500, 80, 318, 102, 500, 500, 64, 500, 36, 50, 62, 500, 500, 72, 500, 500, 82, 500, 278, 332, 78, 74, 108, 98, 144, 500, 88, 50, 500, 164, 66, 130, 500, 500, 500, 500, 50, 56, 122, 144, 500, 500, 36, 116, 500, 98, 96, 500, 54, 42, 500, 92, 500, 48, 30, 500, 500, 26, 182, 86, 90, 500, 500, 102, 500, 42, 70, 500, 332, 48, 90, 142, 212, 178, 500, 54, 500, 500, 52, 82, 500, 500, 132, 116, 500, 78, 500, 138, 500, 62, 500, 306, 500, 110, 124, 134, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39385532348963537, "mean_inference_ms": 1.2742805375568644, "mean_action_processing_ms": 0.14979098853525877, "mean_env_wait_ms": 0.08831194244668712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026030302047729492, "StateBufferConnector_ms": 0.008997440338134766, "ViewRequirementAgentConnector_ms": 0.11525559425354004}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5619999999998218, "episode_len_mean": 264.98, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 18.29999999999982, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.5, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 22.299999999999876, 16.8999999999998, 42.30000000000001, 42.70000000000001, 39.300000000000026, 40.30000000000002, 35.70000000000003, -50.00000000000044, 41.30000000000001, 45.1, -50.00000000000044, 33.70000000000004, 43.50000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 44.5, 37.90000000000003, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.5, 38.50000000000003, -50.00000000000044, 40.30000000000002, 40.500000000000014, -50.00000000000044, 44.7, 45.9, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.3, 47.1, -50.00000000000044, -50.00000000000044, 47.5, 31.900000000000013, 41.500000000000014, 41.100000000000016, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.9, 43.10000000000001, -50.00000000000044, 16.8999999999998, 45.3, 41.100000000000016, 35.900000000000034, 28.89999999999997, 32.30000000000002, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 38.50000000000003, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.30000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 19.499999999999837, -50.00000000000044, 39.10000000000002, 37.70000000000003, 36.70000000000003, 45.1], "episode_lengths": [500, 500, 500, 500, 80, 318, 102, 500, 500, 64, 500, 36, 50, 62, 500, 500, 72, 500, 500, 82, 500, 278, 332, 78, 74, 108, 98, 144, 500, 88, 50, 500, 164, 66, 130, 500, 500, 500, 500, 50, 56, 122, 144, 500, 500, 36, 116, 500, 98, 96, 500, 54, 42, 500, 92, 500, 48, 30, 500, 500, 26, 182, 86, 90, 500, 500, 102, 500, 42, 70, 500, 332, 48, 90, 142, 212, 178, 500, 54, 500, 500, 52, 82, 500, 500, 132, 116, 500, 78, 500, 138, 500, 62, 500, 306, 500, 110, 124, 134, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39385532348963537, "mean_inference_ms": 1.2742805375568644, "mean_action_processing_ms": 0.14979098853525877, "mean_env_wait_ms": 0.08831194244668712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026030302047729492, "StateBufferConnector_ms": 0.008997440338134766, "ViewRequirementAgentConnector_ms": 0.11525559425354004}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5576.907726418031, "num_env_steps_trained_throughput_per_sec": 5576.907726418031, "timesteps_total": 324000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 2308.638, "sample_time_ms": 2069.405, "load_time_ms": 11.236, "load_throughput": 1067954.932, "learn_time_ms": 217.663, "learn_throughput": 55131.211, "synch_weights_time_ms": 9.314}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1182, "training_iteration": 27, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-23", "timestamp": 1698247643, "time_this_iter_s": 2.16072416305542, "time_total_s": 61.07989764213562, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 61.07989764213562, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 65.7, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4901161193847661e-09, "cur_lr": 0.0003, "total_loss": 6.831625302632649, "policy_loss": -0.0004107892513275146, "vf_loss": 6.832091426849365, "vf_explained_var": -1.136461893717448e-06, "kl": 0.0003324084845720184, "entropy": 0.5535314242045085, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 413.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.449999999999836, "episode_len_mean": 256.14, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.50000000000003, -50.00000000000044, 40.30000000000002, 40.500000000000014, -50.00000000000044, 44.7, 45.9, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.3, 47.1, -50.00000000000044, -50.00000000000044, 47.5, 31.900000000000013, 41.500000000000014, 41.100000000000016, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.9, 43.10000000000001, -50.00000000000044, 16.8999999999998, 45.3, 41.100000000000016, 35.900000000000034, 28.89999999999997, 32.30000000000002, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 38.50000000000003, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.30000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 19.499999999999837, -50.00000000000044, 39.10000000000002, 37.70000000000003, 36.70000000000003, 45.1, 40.10000000000002, 23.099999999999888, 40.10000000000002, 11.499999999999723, 31.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 35.900000000000034, 39.50000000000002, 37.300000000000026, 43.7, -50.00000000000044, 42.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 38.90000000000002, 28.699999999999967, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 23.699999999999896, 41.90000000000001, 47.1, -50.00000000000044, -50.00000000000044, 37.50000000000003, 6.099999999999646, 44.5, -50.00000000000044, 46.5, 31.70000000000001, -50.00000000000044, 45.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, 37.90000000000003, -50.00000000000044, -50.00000000000044, 35.30000000000004], "episode_lengths": [116, 500, 98, 96, 500, 54, 42, 500, 92, 500, 48, 30, 500, 500, 26, 182, 86, 90, 500, 500, 102, 500, 42, 70, 500, 332, 48, 90, 142, 212, 178, 500, 54, 500, 500, 52, 82, 500, 500, 132, 116, 500, 78, 500, 138, 500, 62, 500, 306, 500, 110, 124, 134, 50, 100, 270, 100, 386, 188, 500, 46, 500, 142, 106, 128, 64, 500, 80, 74, 500, 500, 44, 112, 214, 60, 500, 500, 500, 128, 264, 82, 30, 500, 500, 126, 440, 56, 500, 36, 184, 500, 48, 74, 500, 500, 148, 122, 500, 500, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3935206269821127, "mean_inference_ms": 1.2731472358950036, "mean_action_processing_ms": 0.15000802647065303, "mean_env_wait_ms": 0.08835796540978162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020006179809570312, "StateBufferConnector_ms": 0.010998249053955078, "ViewRequirementAgentConnector_ms": 0.1427164077758789}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.449999999999836, "episode_len_mean": 256.14, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.50000000000003, -50.00000000000044, 40.30000000000002, 40.500000000000014, -50.00000000000044, 44.7, 45.9, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.3, 47.1, -50.00000000000044, -50.00000000000044, 47.5, 31.900000000000013, 41.500000000000014, 41.100000000000016, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.9, 43.10000000000001, -50.00000000000044, 16.8999999999998, 45.3, 41.100000000000016, 35.900000000000034, 28.89999999999997, 32.30000000000002, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 38.50000000000003, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.30000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 19.499999999999837, -50.00000000000044, 39.10000000000002, 37.70000000000003, 36.70000000000003, 45.1, 40.10000000000002, 23.099999999999888, 40.10000000000002, 11.499999999999723, 31.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 35.900000000000034, 39.50000000000002, 37.300000000000026, 43.7, -50.00000000000044, 42.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 38.90000000000002, 28.699999999999967, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 23.699999999999896, 41.90000000000001, 47.1, -50.00000000000044, -50.00000000000044, 37.50000000000003, 6.099999999999646, 44.5, -50.00000000000044, 46.5, 31.70000000000001, -50.00000000000044, 45.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, 37.90000000000003, -50.00000000000044, -50.00000000000044, 35.30000000000004], "episode_lengths": [116, 500, 98, 96, 500, 54, 42, 500, 92, 500, 48, 30, 500, 500, 26, 182, 86, 90, 500, 500, 102, 500, 42, 70, 500, 332, 48, 90, 142, 212, 178, 500, 54, 500, 500, 52, 82, 500, 500, 132, 116, 500, 78, 500, 138, 500, 62, 500, 306, 500, 110, 124, 134, 50, 100, 270, 100, 386, 188, 500, 46, 500, 142, 106, 128, 64, 500, 80, 74, 500, 500, 44, 112, 214, 60, 500, 500, 500, 128, 264, 82, 30, 500, 500, 126, 440, 56, 500, 36, 184, 500, 48, 74, 500, 500, 148, 122, 500, 500, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3935206269821127, "mean_inference_ms": 1.2731472358950036, "mean_action_processing_ms": 0.15000802647065303, "mean_env_wait_ms": 0.08835796540978162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020006179809570312, "StateBufferConnector_ms": 0.010998249053955078, "ViewRequirementAgentConnector_ms": 0.1427164077758789}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5455.300892860337, "num_env_steps_trained_throughput_per_sec": 5455.300892860337, "timesteps_total": 336000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 2293.972, "sample_time_ms": 2052.959, "load_time_ms": 11.711, "load_throughput": 1024692.134, "learn_time_ms": 218.971, "learn_throughput": 54801.72, "synch_weights_time_ms": 9.382}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 1228, "training_iteration": 28, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-25", "timestamp": 1698247645, "time_this_iter_s": 2.204695463180542, "time_total_s": 63.28459310531616, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 63.28459310531616, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 61.900000000000006, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.450580596923831e-10, "cur_lr": 0.0003, "total_loss": 6.582487424214681, "policy_loss": -0.0003207564353942871, "vf_loss": 6.582854747772217, "vf_explained_var": 4.3312708536783854e-07, "kl": 0.0005856346176339382, "entropy": 0.466566276550293, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 428.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.346999999999837, "episode_len_mean": 262.18, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.30000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 19.499999999999837, -50.00000000000044, 39.10000000000002, 37.70000000000003, 36.70000000000003, 45.1, 40.10000000000002, 23.099999999999888, 40.10000000000002, 11.499999999999723, 31.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 35.900000000000034, 39.50000000000002, 37.300000000000026, 43.7, -50.00000000000044, 42.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 38.90000000000002, 28.699999999999967, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 23.699999999999896, 41.90000000000001, 47.1, -50.00000000000044, -50.00000000000044, 37.50000000000003, 6.099999999999646, 44.5, -50.00000000000044, 46.5, 31.70000000000001, -50.00000000000044, 45.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, 37.90000000000003, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 42.500000000000014, 38.300000000000026, 36.10000000000004, 38.300000000000026, -50.00000000000044, 35.500000000000036, 39.70000000000002, 45.9, 44.7, 26.299999999999933, 11.499999999999723, 32.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 39.10000000000002, 46.3, 40.30000000000002, -50.00000000000044, 44.10000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.50000000000003, -50.00000000000044, 46.3, 34.50000000000004, 36.70000000000003, 1.299999999999578, 42.70000000000001, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 47.3, 25.29999999999992], "episode_lengths": [138, 500, 62, 500, 306, 500, 110, 124, 134, 50, 100, 270, 100, 386, 188, 500, 46, 500, 142, 106, 128, 64, 500, 80, 74, 500, 500, 44, 112, 214, 60, 500, 500, 500, 128, 264, 82, 30, 500, 500, 126, 440, 56, 500, 36, 184, 500, 48, 74, 500, 500, 148, 122, 500, 500, 148, 500, 76, 118, 140, 118, 500, 146, 104, 42, 54, 238, 386, 176, 500, 500, 58, 500, 500, 500, 156, 110, 38, 98, 500, 60, 146, 500, 500, 500, 500, 68, 126, 500, 38, 156, 134, 488, 74, 500, 170, 500, 500, 28, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39366809681639786, "mean_inference_ms": 1.2722679671302777, "mean_action_processing_ms": 0.14929246040447358, "mean_env_wait_ms": 0.08785854300911602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020992279052734375, "StateBufferConnector_ms": 0.010001420974731445, "ViewRequirementAgentConnector_ms": 0.13669681549072266}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.346999999999837, "episode_len_mean": 262.18, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.30000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 19.499999999999837, -50.00000000000044, 39.10000000000002, 37.70000000000003, 36.70000000000003, 45.1, 40.10000000000002, 23.099999999999888, 40.10000000000002, 11.499999999999723, 31.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 35.900000000000034, 39.50000000000002, 37.300000000000026, 43.7, -50.00000000000044, 42.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 38.90000000000002, 28.699999999999967, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 23.699999999999896, 41.90000000000001, 47.1, -50.00000000000044, -50.00000000000044, 37.50000000000003, 6.099999999999646, 44.5, -50.00000000000044, 46.5, 31.70000000000001, -50.00000000000044, 45.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, 37.90000000000003, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 42.500000000000014, 38.300000000000026, 36.10000000000004, 38.300000000000026, -50.00000000000044, 35.500000000000036, 39.70000000000002, 45.9, 44.7, 26.299999999999933, 11.499999999999723, 32.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 39.10000000000002, 46.3, 40.30000000000002, -50.00000000000044, 44.10000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.50000000000003, -50.00000000000044, 46.3, 34.50000000000004, 36.70000000000003, 1.299999999999578, 42.70000000000001, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 47.3, 25.29999999999992], "episode_lengths": [138, 500, 62, 500, 306, 500, 110, 124, 134, 50, 100, 270, 100, 386, 188, 500, 46, 500, 142, 106, 128, 64, 500, 80, 74, 500, 500, 44, 112, 214, 60, 500, 500, 500, 128, 264, 82, 30, 500, 500, 126, 440, 56, 500, 36, 184, 500, 48, 74, 500, 500, 148, 122, 500, 500, 148, 500, 76, 118, 140, 118, 500, 146, 104, 42, 54, 238, 386, 176, 500, 500, 58, 500, 500, 500, 156, 110, 38, 98, 500, 60, 146, 500, 500, 500, 500, 68, 126, 500, 38, 156, 134, 488, 74, 500, 170, 500, 500, 28, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39366809681639786, "mean_inference_ms": 1.2722679671302777, "mean_action_processing_ms": 0.14929246040447358, "mean_env_wait_ms": 0.08785854300911602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020992279052734375, "StateBufferConnector_ms": 0.010001420974731445, "ViewRequirementAgentConnector_ms": 0.13669681549072266}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5692.707680040265, "num_env_steps_trained_throughput_per_sec": 5692.707680040265, "timesteps_total": 348000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 2258.798, "sample_time_ms": 2037.49, "load_time_ms": 10.811, "load_throughput": 1109983.526, "learn_time_ms": 200.172, "learn_throughput": 59948.56, "synch_weights_time_ms": 9.376}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 1272, "training_iteration": 29, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-28", "timestamp": 1698247648, "time_this_iter_s": 2.2285377979278564, "time_total_s": 65.51313090324402, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 65.51313090324402, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 62.03333333333334, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7252902984619153e-10, "cur_lr": 0.0003, "total_loss": 6.403849569956462, "policy_loss": -0.00011888941129048666, "vf_loss": 6.404014968872071, "vf_explained_var": 5.1657358805338543e-08, "kl": 0.00037303884316012653, "entropy": 0.4663362781206767, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 443.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.072999999999834, "episode_len_mean": 254.92, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 35.30000000000004, 37.90000000000003, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 42.500000000000014, 38.300000000000026, 36.10000000000004, 38.300000000000026, -50.00000000000044, 35.500000000000036, 39.70000000000002, 45.9, 44.7, 26.299999999999933, 11.499999999999723, 32.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 39.10000000000002, 46.3, 40.30000000000002, -50.00000000000044, 44.10000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.50000000000003, -50.00000000000044, 46.3, 34.50000000000004, 36.70000000000003, 1.299999999999578, 42.70000000000001, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 47.3, 25.29999999999992, -50.00000000000044, 43.900000000000006, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.8999999999998, 41.30000000000001, 45.1, 44.5, -50.00000000000044, 43.7, -50.00000000000044, 42.70000000000001, 34.900000000000034, 44.300000000000004, 42.30000000000001, -50.00000000000044, 44.7, 46.699999999999996, 44.900000000000006, -50.00000000000044, 32.90000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.3, -50.00000000000044, 45.7, 20.699999999999854, 46.9, -50.00000000000044, 29.899999999999984, 42.30000000000001, -50.00000000000044, 24.499999999999908, 38.50000000000003, 44.300000000000004, 43.900000000000006, 2.299999999999592, -50.00000000000044, 34.10000000000004, 46.099999999999994, 26.09999999999993, 46.9, 45.3, 45.7], "episode_lengths": [500, 500, 148, 122, 500, 500, 148, 500, 76, 118, 140, 118, 500, 146, 104, 42, 54, 238, 386, 176, 500, 500, 58, 500, 500, 500, 156, 110, 38, 98, 500, 60, 146, 500, 500, 500, 500, 68, 126, 500, 38, 156, 134, 488, 74, 500, 170, 500, 500, 28, 248, 500, 62, 500, 116, 500, 500, 500, 332, 88, 50, 56, 500, 64, 500, 74, 152, 58, 78, 500, 54, 34, 52, 500, 172, 58, 500, 500, 58, 38, 500, 44, 294, 32, 500, 202, 78, 500, 256, 116, 58, 62, 478, 500, 160, 40, 240, 32, 48, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3935381564513177, "mean_inference_ms": 1.2712202379082256, "mean_action_processing_ms": 0.14917513176696956, "mean_env_wait_ms": 0.08770664225174325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022987842559814453, "StateBufferConnector_ms": 0.009002447128295898, "ViewRequirementAgentConnector_ms": 0.11772918701171875}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.072999999999834, "episode_len_mean": 254.92, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 35.30000000000004, 37.90000000000003, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 42.500000000000014, 38.300000000000026, 36.10000000000004, 38.300000000000026, -50.00000000000044, 35.500000000000036, 39.70000000000002, 45.9, 44.7, 26.299999999999933, 11.499999999999723, 32.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 39.10000000000002, 46.3, 40.30000000000002, -50.00000000000044, 44.10000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.50000000000003, -50.00000000000044, 46.3, 34.50000000000004, 36.70000000000003, 1.299999999999578, 42.70000000000001, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 47.3, 25.29999999999992, -50.00000000000044, 43.900000000000006, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.8999999999998, 41.30000000000001, 45.1, 44.5, -50.00000000000044, 43.7, -50.00000000000044, 42.70000000000001, 34.900000000000034, 44.300000000000004, 42.30000000000001, -50.00000000000044, 44.7, 46.699999999999996, 44.900000000000006, -50.00000000000044, 32.90000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.3, -50.00000000000044, 45.7, 20.699999999999854, 46.9, -50.00000000000044, 29.899999999999984, 42.30000000000001, -50.00000000000044, 24.499999999999908, 38.50000000000003, 44.300000000000004, 43.900000000000006, 2.299999999999592, -50.00000000000044, 34.10000000000004, 46.099999999999994, 26.09999999999993, 46.9, 45.3, 45.7], "episode_lengths": [500, 500, 148, 122, 500, 500, 148, 500, 76, 118, 140, 118, 500, 146, 104, 42, 54, 238, 386, 176, 500, 500, 58, 500, 500, 500, 156, 110, 38, 98, 500, 60, 146, 500, 500, 500, 500, 68, 126, 500, 38, 156, 134, 488, 74, 500, 170, 500, 500, 28, 248, 500, 62, 500, 116, 500, 500, 500, 332, 88, 50, 56, 500, 64, 500, 74, 152, 58, 78, 500, 54, 34, 52, 500, 172, 58, 500, 500, 58, 38, 500, 44, 294, 32, 500, 202, 78, 500, 256, 116, 58, 62, 478, 500, 160, 40, 240, 32, 48, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3935381564513177, "mean_inference_ms": 1.2712202379082256, "mean_action_processing_ms": 0.14917513176696956, "mean_env_wait_ms": 0.08770664225174325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022987842559814453, "StateBufferConnector_ms": 0.009002447128295898, "ViewRequirementAgentConnector_ms": 0.11772918701171875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5057.752050040864, "num_env_steps_trained_throughput_per_sec": 5057.752050040864, "timesteps_total": 360000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 2238.179, "sample_time_ms": 2002.34, "load_time_ms": 10.912, "load_throughput": 1099659.779, "learn_time_ms": 214.78, "learn_throughput": 55870.995, "synch_weights_time_ms": 9.196}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1321, "training_iteration": 30, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-30", "timestamp": 1698247650, "time_this_iter_s": 2.377593994140625, "time_total_s": 67.89072489738464, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 67.89072489738464, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 59.300000000000004, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309577e-10, "cur_lr": 0.0003, "total_loss": 6.49532839457194, "policy_loss": -5.8054178953170774e-05, "vf_loss": 6.49543612798055, "vf_explained_var": 1.6013781229654948e-06, "kl": 0.00014813187361302957, "entropy": 0.4965792715549469, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 458.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.111999999999831, "episode_len_mean": 249.54, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.10000000000003, -50.00000000000044, -50.00000000000044, 47.3, 25.29999999999992, -50.00000000000044, 43.900000000000006, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.8999999999998, 41.30000000000001, 45.1, 44.5, -50.00000000000044, 43.7, -50.00000000000044, 42.70000000000001, 34.900000000000034, 44.300000000000004, 42.30000000000001, -50.00000000000044, 44.7, 46.699999999999996, 44.900000000000006, -50.00000000000044, 32.90000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.3, -50.00000000000044, 45.7, 20.699999999999854, 46.9, -50.00000000000044, 29.899999999999984, 42.30000000000001, -50.00000000000044, 24.499999999999908, 38.50000000000003, 44.300000000000004, 43.900000000000006, 2.299999999999592, -50.00000000000044, 34.10000000000004, 46.099999999999994, 26.09999999999993, 46.9, 45.3, 45.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 34.10000000000004, 9.099999999999689, 45.7, 45.9, 31.1, -50.00000000000044, 34.30000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, 19.299999999999834, -50.00000000000044, 43.10000000000001, 20.899999999999856, 4.499999999999623, 42.30000000000001, 39.90000000000002, 40.70000000000002, 31.1, -50.00000000000044, 40.10000000000002, 46.5, 45.1, 47.1, -50.00000000000044, 20.299999999999848, 39.50000000000002, 45.9, 41.100000000000016, -50.00000000000044, -50.00000000000044], "episode_lengths": [170, 500, 500, 28, 248, 500, 62, 500, 116, 500, 500, 500, 332, 88, 50, 56, 500, 64, 500, 74, 152, 58, 78, 500, 54, 34, 52, 500, 172, 58, 500, 500, 58, 38, 500, 44, 294, 32, 500, 202, 78, 500, 256, 116, 58, 62, 478, 500, 160, 40, 240, 32, 48, 44, 500, 66, 500, 70, 500, 500, 500, 82, 500, 500, 52, 500, 160, 410, 44, 42, 190, 500, 158, 34, 500, 500, 34, 44, 500, 308, 500, 70, 292, 456, 78, 102, 94, 190, 500, 100, 36, 50, 30, 500, 298, 106, 42, 90, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3935913742168896, "mean_inference_ms": 1.2708644908620728, "mean_action_processing_ms": 0.14928254215068537, "mean_env_wait_ms": 0.08767249726748955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02098870277404785, "StateBufferConnector_ms": 0.009003162384033203, "ViewRequirementAgentConnector_ms": 0.12871360778808594}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.111999999999831, "episode_len_mean": 249.54, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.10000000000003, -50.00000000000044, -50.00000000000044, 47.3, 25.29999999999992, -50.00000000000044, 43.900000000000006, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.8999999999998, 41.30000000000001, 45.1, 44.5, -50.00000000000044, 43.7, -50.00000000000044, 42.70000000000001, 34.900000000000034, 44.300000000000004, 42.30000000000001, -50.00000000000044, 44.7, 46.699999999999996, 44.900000000000006, -50.00000000000044, 32.90000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.3, -50.00000000000044, 45.7, 20.699999999999854, 46.9, -50.00000000000044, 29.899999999999984, 42.30000000000001, -50.00000000000044, 24.499999999999908, 38.50000000000003, 44.300000000000004, 43.900000000000006, 2.299999999999592, -50.00000000000044, 34.10000000000004, 46.099999999999994, 26.09999999999993, 46.9, 45.3, 45.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 34.10000000000004, 9.099999999999689, 45.7, 45.9, 31.1, -50.00000000000044, 34.30000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, 19.299999999999834, -50.00000000000044, 43.10000000000001, 20.899999999999856, 4.499999999999623, 42.30000000000001, 39.90000000000002, 40.70000000000002, 31.1, -50.00000000000044, 40.10000000000002, 46.5, 45.1, 47.1, -50.00000000000044, 20.299999999999848, 39.50000000000002, 45.9, 41.100000000000016, -50.00000000000044, -50.00000000000044], "episode_lengths": [170, 500, 500, 28, 248, 500, 62, 500, 116, 500, 500, 500, 332, 88, 50, 56, 500, 64, 500, 74, 152, 58, 78, 500, 54, 34, 52, 500, 172, 58, 500, 500, 58, 38, 500, 44, 294, 32, 500, 202, 78, 500, 256, 116, 58, 62, 478, 500, 160, 40, 240, 32, 48, 44, 500, 66, 500, 70, 500, 500, 500, 82, 500, 500, 52, 500, 160, 410, 44, 42, 190, 500, 158, 34, 500, 500, 34, 44, 500, 308, 500, 70, 292, 456, 78, 102, 94, 190, 500, 100, 36, 50, 30, 500, 298, 106, 42, 90, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3935913742168896, "mean_inference_ms": 1.2708644908620728, "mean_action_processing_ms": 0.14928254215068537, "mean_env_wait_ms": 0.08767249726748955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02098870277404785, "StateBufferConnector_ms": 0.009003162384033203, "ViewRequirementAgentConnector_ms": 0.12871360778808594}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5274.35913342801, "num_env_steps_trained_throughput_per_sec": 5274.35913342801, "timesteps_total": 372000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 2210.069, "sample_time_ms": 1987.011, "load_time_ms": 10.213, "load_throughput": 1174921.694, "learn_time_ms": 202.443, "learn_throughput": 59276.083, "synch_weights_time_ms": 9.352}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 1367, "training_iteration": 31, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-32", "timestamp": 1698247652, "time_this_iter_s": 2.280182123184204, "time_total_s": 70.17090702056885, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 70.17090702056885, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 54.199999999999996, "ram_util_percent": 35.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154788e-11, "cur_lr": 0.0003, "total_loss": 6.686191495259603, "policy_loss": -0.0001555807888507843, "vf_loss": 6.686391830444336, "vf_explained_var": -1.1761983235677084e-06, "kl": 0.00026095819555583454, "entropy": 0.4475721776485443, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.43099999999983, "episode_len_mean": 251.34, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 26.09999999999993, 46.9, 45.3, 45.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 34.10000000000004, 9.099999999999689, 45.7, 45.9, 31.1, -50.00000000000044, 34.30000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, 19.299999999999834, -50.00000000000044, 43.10000000000001, 20.899999999999856, 4.499999999999623, 42.30000000000001, 39.90000000000002, 40.70000000000002, 31.1, -50.00000000000044, 40.10000000000002, 46.5, 45.1, 47.1, -50.00000000000044, 20.299999999999848, 39.50000000000002, 45.9, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 46.9, 46.699999999999996, 45.7, 45.1, 44.900000000000006, 45.5, 43.900000000000006, 41.500000000000014, -50.00000000000044, 37.90000000000003, 42.900000000000006, 29.299999999999976, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 44.900000000000006, 33.10000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.100000000000016, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 43.7, 42.10000000000001, 43.7, 13.499999999999751, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 31.500000000000007, 45.5, 47.1, 45.5, -50.00000000000044, 41.100000000000016], "episode_lengths": [40, 240, 32, 48, 44, 500, 66, 500, 70, 500, 500, 500, 82, 500, 500, 52, 500, 160, 410, 44, 42, 190, 500, 158, 34, 500, 500, 34, 44, 500, 308, 500, 70, 292, 456, 78, 102, 94, 190, 500, 100, 36, 50, 30, 500, 298, 106, 42, 90, 500, 500, 500, 140, 32, 34, 44, 50, 52, 46, 62, 86, 500, 122, 72, 208, 500, 500, 30, 500, 52, 170, 500, 38, 500, 500, 168, 500, 500, 136, 90, 500, 494, 500, 64, 80, 64, 366, 500, 154, 500, 500, 500, 500, 250, 186, 46, 30, 46, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3939204699003085, "mean_inference_ms": 1.2700096437643331, "mean_action_processing_ms": 0.14925461801381343, "mean_env_wait_ms": 0.08765432131420743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499556541442871, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.11899805068969727}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.43099999999983, "episode_len_mean": 251.34, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 26.09999999999993, 46.9, 45.3, 45.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 34.10000000000004, 9.099999999999689, 45.7, 45.9, 31.1, -50.00000000000044, 34.30000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, 19.299999999999834, -50.00000000000044, 43.10000000000001, 20.899999999999856, 4.499999999999623, 42.30000000000001, 39.90000000000002, 40.70000000000002, 31.1, -50.00000000000044, 40.10000000000002, 46.5, 45.1, 47.1, -50.00000000000044, 20.299999999999848, 39.50000000000002, 45.9, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 46.9, 46.699999999999996, 45.7, 45.1, 44.900000000000006, 45.5, 43.900000000000006, 41.500000000000014, -50.00000000000044, 37.90000000000003, 42.900000000000006, 29.299999999999976, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 44.900000000000006, 33.10000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.100000000000016, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 43.7, 42.10000000000001, 43.7, 13.499999999999751, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 31.500000000000007, 45.5, 47.1, 45.5, -50.00000000000044, 41.100000000000016], "episode_lengths": [40, 240, 32, 48, 44, 500, 66, 500, 70, 500, 500, 500, 82, 500, 500, 52, 500, 160, 410, 44, 42, 190, 500, 158, 34, 500, 500, 34, 44, 500, 308, 500, 70, 292, 456, 78, 102, 94, 190, 500, 100, 36, 50, 30, 500, 298, 106, 42, 90, 500, 500, 500, 140, 32, 34, 44, 50, 52, 46, 62, 86, 500, 122, 72, 208, 500, 500, 30, 500, 52, 170, 500, 38, 500, 500, 168, 500, 500, 136, 90, 500, 494, 500, 64, 80, 64, 366, 500, 154, 500, 500, 500, 500, 250, 186, 46, 30, 46, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3939204699003085, "mean_inference_ms": 1.2700096437643331, "mean_action_processing_ms": 0.14925461801381343, "mean_env_wait_ms": 0.08765432131420743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499556541442871, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.11899805068969727}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5126.763088351414, "num_env_steps_trained_throughput_per_sec": 5126.763088351414, "timesteps_total": 384000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 2222.84, "sample_time_ms": 1979.548, "load_time_ms": 11.163, "load_throughput": 1074982.497, "learn_time_ms": 221.648, "learn_throughput": 54139.792, "synch_weights_time_ms": 9.47}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 1416, "training_iteration": 32, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-35", "timestamp": 1698247655, "time_this_iter_s": 2.345684051513672, "time_total_s": 72.51659107208252, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 72.51659107208252, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 60.43333333333333, "ram_util_percent": 35.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.656612873077394e-11, "cur_lr": 0.0003, "total_loss": 6.451267337799072, "policy_loss": -0.0004842559496561686, "vf_loss": 6.451795260111491, "vf_explained_var": -1.4146169026692709e-06, "kl": 0.00041919110792226397, "entropy": 0.4366945763429006, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 488.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.129999999999832, "episode_len_mean": 249.34, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 46.9, 46.699999999999996, 45.7, 45.1, 44.900000000000006, 45.5, 43.900000000000006, 41.500000000000014, -50.00000000000044, 37.90000000000003, 42.900000000000006, 29.299999999999976, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 44.900000000000006, 33.10000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.100000000000016, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 43.7, 42.10000000000001, 43.7, 13.499999999999751, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 31.500000000000007, 45.5, 47.1, 45.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 35.10000000000004, 25.699999999999925, 26.89999999999994, -50.00000000000044, 42.500000000000014, 41.30000000000001, -50.00000000000044, 45.7, 45.9, 47.3, 32.700000000000024, -50.00000000000044, -50.00000000000044, 47.7, 46.699999999999996, 35.10000000000004, -50.00000000000044, 41.90000000000001, 37.10000000000003, 41.30000000000001, 45.7, 45.7, 35.900000000000034, 45.7, 25.899999999999928, -50.00000000000044, 26.89999999999994, 44.10000000000001, -50.00000000000044, 40.10000000000002, 45.3, -50.00000000000044, 44.900000000000006, 47.1, 43.900000000000006, 3.699999999999612, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.5, -50.00000000000044, 44.7], "episode_lengths": [90, 500, 500, 500, 140, 32, 34, 44, 50, 52, 46, 62, 86, 500, 122, 72, 208, 500, 500, 30, 500, 52, 170, 500, 38, 500, 500, 168, 500, 500, 136, 90, 500, 494, 500, 64, 80, 64, 366, 500, 154, 500, 500, 500, 500, 250, 186, 46, 30, 46, 500, 90, 500, 150, 244, 232, 500, 76, 88, 500, 44, 42, 28, 174, 500, 500, 24, 34, 150, 500, 82, 130, 88, 44, 44, 142, 44, 242, 500, 232, 60, 500, 100, 48, 500, 52, 30, 62, 464, 500, 500, 50, 500, 500, 500, 42, 500, 46, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39370499978395246, "mean_inference_ms": 1.2700774971835092, "mean_action_processing_ms": 0.14895981364840807, "mean_env_wait_ms": 0.08756988291159581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031989336013793945, "StateBufferConnector_ms": 0.0019989013671875, "ViewRequirementAgentConnector_ms": 0.1230165958404541}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.129999999999832, "episode_len_mean": 249.34, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 46.9, 46.699999999999996, 45.7, 45.1, 44.900000000000006, 45.5, 43.900000000000006, 41.500000000000014, -50.00000000000044, 37.90000000000003, 42.900000000000006, 29.299999999999976, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 44.900000000000006, 33.10000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.100000000000016, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 43.7, 42.10000000000001, 43.7, 13.499999999999751, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 31.500000000000007, 45.5, 47.1, 45.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 35.10000000000004, 25.699999999999925, 26.89999999999994, -50.00000000000044, 42.500000000000014, 41.30000000000001, -50.00000000000044, 45.7, 45.9, 47.3, 32.700000000000024, -50.00000000000044, -50.00000000000044, 47.7, 46.699999999999996, 35.10000000000004, -50.00000000000044, 41.90000000000001, 37.10000000000003, 41.30000000000001, 45.7, 45.7, 35.900000000000034, 45.7, 25.899999999999928, -50.00000000000044, 26.89999999999994, 44.10000000000001, -50.00000000000044, 40.10000000000002, 45.3, -50.00000000000044, 44.900000000000006, 47.1, 43.900000000000006, 3.699999999999612, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.5, -50.00000000000044, 44.7], "episode_lengths": [90, 500, 500, 500, 140, 32, 34, 44, 50, 52, 46, 62, 86, 500, 122, 72, 208, 500, 500, 30, 500, 52, 170, 500, 38, 500, 500, 168, 500, 500, 136, 90, 500, 494, 500, 64, 80, 64, 366, 500, 154, 500, 500, 500, 500, 250, 186, 46, 30, 46, 500, 90, 500, 150, 244, 232, 500, 76, 88, 500, 44, 42, 28, 174, 500, 500, 24, 34, 150, 500, 82, 130, 88, 44, 44, 142, 44, 242, 500, 232, 60, 500, 100, 48, 500, 52, 30, 62, 464, 500, 500, 50, 500, 500, 500, 42, 500, 46, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39370499978395246, "mean_inference_ms": 1.2700774971835092, "mean_action_processing_ms": 0.14895981364840807, "mean_env_wait_ms": 0.08756988291159581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031989336013793945, "StateBufferConnector_ms": 0.0019989013671875, "ViewRequirementAgentConnector_ms": 0.1230165958404541}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4507.603073452359, "num_env_steps_trained_throughput_per_sec": 4507.603073452359, "timesteps_total": 396000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 2259.078, "sample_time_ms": 2004.442, "load_time_ms": 12.064, "load_throughput": 994718.225, "learn_time_ms": 231.856, "learn_throughput": 51756.366, "synch_weights_time_ms": 9.508}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1464, "training_iteration": 33, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-38", "timestamp": 1698247658, "time_this_iter_s": 2.6671671867370605, "time_total_s": 75.18375825881958, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 75.18375825881958, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 54.1, "ram_util_percent": 35.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.328306436538697e-11, "cur_lr": 0.0003, "total_loss": 6.5174044926961265, "policy_loss": 1.1217718323071797e-05, "vf_loss": 6.51743205388387, "vf_explained_var": -3.178914388020833e-07, "kl": 0.00018153787626336756, "entropy": 0.387072745958964, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 503.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2339999999998144, "episode_len_mean": 268.26, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 31.500000000000007, 45.5, 47.1, 45.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 35.10000000000004, 25.699999999999925, 26.89999999999994, -50.00000000000044, 42.500000000000014, 41.30000000000001, -50.00000000000044, 45.7, 45.9, 47.3, 32.700000000000024, -50.00000000000044, -50.00000000000044, 47.7, 46.699999999999996, 35.10000000000004, -50.00000000000044, 41.90000000000001, 37.10000000000003, 41.30000000000001, 45.7, 45.7, 35.900000000000034, 45.7, 25.899999999999928, -50.00000000000044, 26.89999999999994, 44.10000000000001, -50.00000000000044, 40.10000000000002, 45.3, -50.00000000000044, 44.900000000000006, 47.1, 43.900000000000006, 3.699999999999612, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.5, -50.00000000000044, 44.7, -50.00000000000044, 37.50000000000003, 41.100000000000016, 41.90000000000001, 13.499999999999751, -50.00000000000044, 46.699999999999996, 11.29999999999972, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 47.5, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 46.699999999999996, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 41.100000000000016, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 39.70000000000002, 47.1, 24.099999999999902, -50.00000000000044, 36.30000000000003], "episode_lengths": [154, 500, 500, 500, 500, 250, 186, 46, 30, 46, 500, 90, 500, 150, 244, 232, 500, 76, 88, 500, 44, 42, 28, 174, 500, 500, 24, 34, 150, 500, 82, 130, 88, 44, 44, 142, 44, 242, 500, 232, 60, 500, 100, 48, 500, 52, 30, 62, 464, 500, 500, 50, 500, 500, 500, 42, 500, 46, 500, 54, 500, 126, 90, 82, 366, 500, 34, 388, 500, 190, 500, 500, 26, 92, 500, 500, 500, 500, 500, 198, 34, 110, 500, 500, 500, 170, 500, 90, 48, 60, 500, 500, 46, 500, 500, 104, 30, 260, 500, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3938581520101878, "mean_inference_ms": 1.2699251811686814, "mean_action_processing_ms": 0.1485659546224696, "mean_env_wait_ms": 0.08724700801777133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0354914665222168, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.11688041687011719}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2339999999998144, "episode_len_mean": 268.26, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 31.500000000000007, 45.5, 47.1, 45.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 35.10000000000004, 25.699999999999925, 26.89999999999994, -50.00000000000044, 42.500000000000014, 41.30000000000001, -50.00000000000044, 45.7, 45.9, 47.3, 32.700000000000024, -50.00000000000044, -50.00000000000044, 47.7, 46.699999999999996, 35.10000000000004, -50.00000000000044, 41.90000000000001, 37.10000000000003, 41.30000000000001, 45.7, 45.7, 35.900000000000034, 45.7, 25.899999999999928, -50.00000000000044, 26.89999999999994, 44.10000000000001, -50.00000000000044, 40.10000000000002, 45.3, -50.00000000000044, 44.900000000000006, 47.1, 43.900000000000006, 3.699999999999612, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.5, -50.00000000000044, 44.7, -50.00000000000044, 37.50000000000003, 41.100000000000016, 41.90000000000001, 13.499999999999751, -50.00000000000044, 46.699999999999996, 11.29999999999972, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 47.5, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 46.699999999999996, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 41.100000000000016, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 39.70000000000002, 47.1, 24.099999999999902, -50.00000000000044, 36.30000000000003], "episode_lengths": [154, 500, 500, 500, 500, 250, 186, 46, 30, 46, 500, 90, 500, 150, 244, 232, 500, 76, 88, 500, 44, 42, 28, 174, 500, 500, 24, 34, 150, 500, 82, 130, 88, 44, 44, 142, 44, 242, 500, 232, 60, 500, 100, 48, 500, 52, 30, 62, 464, 500, 500, 50, 500, 500, 500, 42, 500, 46, 500, 54, 500, 126, 90, 82, 366, 500, 34, 388, 500, 190, 500, 500, 26, 92, 500, 500, 500, 500, 500, 198, 34, 110, 500, 500, 500, 170, 500, 90, 48, 60, 500, 500, 46, 500, 500, 104, 30, 260, 500, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3938581520101878, "mean_inference_ms": 1.2699251811686814, "mean_action_processing_ms": 0.1485659546224696, "mean_env_wait_ms": 0.08724700801777133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0354914665222168, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.11688041687011719}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5653.652608407458, "num_env_steps_trained_throughput_per_sec": 5653.652608407458, "timesteps_total": 408000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 2257.086, "sample_time_ms": 2009.616, "load_time_ms": 11.862, "load_throughput": 1011636.514, "learn_time_ms": 224.948, "learn_throughput": 53345.577, "synch_weights_time_ms": 9.421}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 1504, "training_iteration": 34, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-40", "timestamp": 1698247660, "time_this_iter_s": 2.1275196075439453, "time_total_s": 77.31127786636353, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 77.31127786636353, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 62.86666666666667, "ram_util_percent": 35.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693485e-11, "cur_lr": 0.0003, "total_loss": 6.173370011647543, "policy_loss": -0.0002438160280386607, "vf_loss": 6.173659102121989, "vf_explained_var": 9.139378865559896e-07, "kl": 0.0005035980552975161, "entropy": 0.45403183102607725, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.846000000000232, "episode_len_mean": 308.96, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.899999999999928, -50.00000000000044, 26.89999999999994, 44.10000000000001, -50.00000000000044, 40.10000000000002, 45.3, -50.00000000000044, 44.900000000000006, 47.1, 43.900000000000006, 3.699999999999612, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.5, -50.00000000000044, 44.7, -50.00000000000044, 37.50000000000003, 41.100000000000016, 41.90000000000001, 13.499999999999751, -50.00000000000044, 46.699999999999996, 11.29999999999972, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 47.5, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 46.699999999999996, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 41.100000000000016, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 39.70000000000002, 47.1, 24.099999999999902, -50.00000000000044, 36.30000000000003, 34.70000000000004, 44.300000000000004, 45.3, 35.500000000000036, -50.00000000000044, 42.10000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 22.299999999999876, 18.099999999999817, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [242, 500, 232, 60, 500, 100, 48, 500, 52, 30, 62, 464, 500, 500, 50, 500, 500, 500, 42, 500, 46, 500, 54, 500, 126, 90, 82, 366, 500, 34, 388, 500, 190, 500, 500, 26, 92, 500, 500, 500, 500, 500, 198, 34, 110, 500, 500, 500, 170, 500, 90, 48, 60, 500, 500, 46, 500, 500, 104, 30, 260, 500, 138, 154, 58, 48, 146, 500, 80, 104, 500, 500, 44, 30, 500, 220, 500, 500, 44, 500, 500, 500, 500, 38, 66, 48, 500, 500, 278, 320, 500, 54, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39434359037343003, "mean_inference_ms": 1.2691811992146185, "mean_action_processing_ms": 0.1490284382820435, "mean_env_wait_ms": 0.08759265174237575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04049539566040039, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.11185789108276367}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.846000000000232, "episode_len_mean": 308.96, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.899999999999928, -50.00000000000044, 26.89999999999994, 44.10000000000001, -50.00000000000044, 40.10000000000002, 45.3, -50.00000000000044, 44.900000000000006, 47.1, 43.900000000000006, 3.699999999999612, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.5, -50.00000000000044, 44.7, -50.00000000000044, 37.50000000000003, 41.100000000000016, 41.90000000000001, 13.499999999999751, -50.00000000000044, 46.699999999999996, 11.29999999999972, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 47.5, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 46.699999999999996, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 41.100000000000016, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 39.70000000000002, 47.1, 24.099999999999902, -50.00000000000044, 36.30000000000003, 34.70000000000004, 44.300000000000004, 45.3, 35.500000000000036, -50.00000000000044, 42.10000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 22.299999999999876, 18.099999999999817, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [242, 500, 232, 60, 500, 100, 48, 500, 52, 30, 62, 464, 500, 500, 50, 500, 500, 500, 42, 500, 46, 500, 54, 500, 126, 90, 82, 366, 500, 34, 388, 500, 190, 500, 500, 26, 92, 500, 500, 500, 500, 500, 198, 34, 110, 500, 500, 500, 170, 500, 90, 48, 60, 500, 500, 46, 500, 500, 104, 30, 260, 500, 138, 154, 58, 48, 146, 500, 80, 104, 500, 500, 44, 30, 500, 220, 500, 500, 44, 500, 500, 500, 500, 38, 66, 48, 500, 500, 278, 320, 500, 54, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39434359037343003, "mean_inference_ms": 1.2691811992146185, "mean_action_processing_ms": 0.1490284382820435, "mean_env_wait_ms": 0.08759265174237575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04049539566040039, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.11185789108276367}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5212.501433054379, "num_env_steps_trained_throughput_per_sec": 5212.501433054379, "timesteps_total": 420000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 2262.828, "sample_time_ms": 2011.331, "load_time_ms": 10.921, "load_throughput": 1098841.113, "learn_time_ms": 229.57, "learn_throughput": 52271.745, "synch_weights_time_ms": 9.468}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 1541, "training_iteration": 35, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-42", "timestamp": 1698247662, "time_this_iter_s": 2.3071868419647217, "time_total_s": 79.61846470832825, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 79.61846470832825, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 61.800000000000004, "ram_util_percent": 35.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346743e-12, "cur_lr": 0.0003, "total_loss": 6.12297960917155, "policy_loss": -5.74156641960144e-05, "vf_loss": 6.123078695933024, "vf_explained_var": -1.223882039388021e-06, "kl": 0.0001019048867078709, "entropy": 0.4187033951282501, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 533.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.232000000000237, "episode_len_mean": 312.8, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 46.699999999999996, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 41.100000000000016, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 39.70000000000002, 47.1, 24.099999999999902, -50.00000000000044, 36.30000000000003, 34.70000000000004, 44.300000000000004, 45.3, 35.500000000000036, -50.00000000000044, 42.10000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 22.299999999999876, 18.099999999999817, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.50000000000001, 46.3, -50.00000000000044, 30.9, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, 4.099999999999618, 29.299999999999976, 45.1, 45.1, -50.00000000000044, 46.5, 38.700000000000024, -50.00000000000044, 32.700000000000024], "episode_lengths": [500, 500, 500, 500, 198, 34, 110, 500, 500, 500, 170, 500, 90, 48, 60, 500, 500, 46, 500, 500, 104, 30, 260, 500, 138, 154, 58, 48, 146, 500, 80, 104, 500, 500, 44, 30, 500, 220, 500, 500, 44, 500, 500, 500, 500, 38, 66, 48, 500, 500, 278, 320, 500, 54, 500, 500, 500, 500, 500, 500, 500, 500, 44, 66, 38, 500, 192, 130, 500, 500, 500, 60, 500, 292, 500, 500, 500, 500, 42, 36, 500, 500, 70, 500, 500, 62, 500, 72, 64, 500, 500, 460, 208, 50, 50, 500, 36, 114, 500, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39438201368701065, "mean_inference_ms": 1.2685762905621492, "mean_action_processing_ms": 0.14912636404600504, "mean_env_wait_ms": 0.08747402351293139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100109100341797, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.12598943710327148}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.232000000000237, "episode_len_mean": 312.8, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 46.699999999999996, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 41.100000000000016, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 39.70000000000002, 47.1, 24.099999999999902, -50.00000000000044, 36.30000000000003, 34.70000000000004, 44.300000000000004, 45.3, 35.500000000000036, -50.00000000000044, 42.10000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 22.299999999999876, 18.099999999999817, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.50000000000001, 46.3, -50.00000000000044, 30.9, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, 4.099999999999618, 29.299999999999976, 45.1, 45.1, -50.00000000000044, 46.5, 38.700000000000024, -50.00000000000044, 32.700000000000024], "episode_lengths": [500, 500, 500, 500, 198, 34, 110, 500, 500, 500, 170, 500, 90, 48, 60, 500, 500, 46, 500, 500, 104, 30, 260, 500, 138, 154, 58, 48, 146, 500, 80, 104, 500, 500, 44, 30, 500, 220, 500, 500, 44, 500, 500, 500, 500, 38, 66, 48, 500, 500, 278, 320, 500, 54, 500, 500, 500, 500, 500, 500, 500, 500, 44, 66, 38, 500, 192, 130, 500, 500, 500, 60, 500, 292, 500, 500, 500, 500, 42, 36, 500, 500, 70, 500, 500, 62, 500, 72, 64, 500, 500, 460, 208, 50, 50, 500, 36, 114, 500, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39438201368701065, "mean_inference_ms": 1.2685762905621492, "mean_action_processing_ms": 0.14912636404600504, "mean_env_wait_ms": 0.08747402351293139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100109100341797, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.12598943710327148}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4774.220169049098, "num_env_steps_trained_throughput_per_sec": 4774.220169049098, "timesteps_total": 432000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 2304.814, "sample_time_ms": 2039.297, "load_time_ms": 11.895, "load_throughput": 1008822.104, "learn_time_ms": 242.741, "learn_throughput": 49435.433, "synch_weights_time_ms": 9.342}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1579, "training_iteration": 36, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-45", "timestamp": 1698247665, "time_this_iter_s": 2.5182673931121826, "time_total_s": 82.13673210144043, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 82.13673210144043, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 59.366666666666674, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9103830456733713e-12, "cur_lr": 0.0003, "total_loss": 6.646928278605143, "policy_loss": -0.00026422515511512754, "vf_loss": 6.6472349484761555, "vf_explained_var": -1.3907750447591145e-06, "kl": 0.000293057925841822, "entropy": 0.42475516597429913, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 548.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.721000000000228, "episode_len_mean": 302.72, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 22.299999999999876, 18.099999999999817, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.50000000000001, 46.3, -50.00000000000044, 30.9, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, 4.099999999999618, 29.299999999999976, 45.1, 45.1, -50.00000000000044, 46.5, 38.700000000000024, -50.00000000000044, 32.700000000000024, -50.00000000000044, 21.299999999999862, -50.00000000000044, 47.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.5, 39.300000000000026, 45.9, 37.10000000000003, 44.900000000000006, 35.500000000000036, 45.7, 45.1, -50.00000000000044, 36.900000000000034, 42.900000000000006, 25.29999999999992, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.900000000000006, 24.299999999999905, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 47.1, 33.70000000000004, 5.6999999999996405, 46.099999999999994, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 500, 278, 320, 500, 54, 500, 500, 500, 500, 500, 500, 500, 500, 44, 66, 38, 500, 192, 130, 500, 500, 500, 60, 500, 292, 500, 500, 500, 500, 42, 36, 500, 500, 70, 500, 500, 62, 500, 72, 64, 500, 500, 460, 208, 50, 50, 500, 36, 114, 500, 174, 500, 288, 500, 26, 74, 500, 500, 500, 36, 500, 36, 108, 42, 130, 52, 146, 44, 50, 500, 132, 72, 248, 52, 500, 500, 500, 78, 500, 52, 258, 500, 82, 500, 500, 70, 500, 30, 164, 444, 40, 500, 28, 500, 500, 500, 38, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39350299760913315, "mean_inference_ms": 1.2682651959010909, "mean_action_processing_ms": 0.14872794029011918, "mean_env_wait_ms": 0.0875629710800518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026987791061401367, "StateBufferConnector_ms": 0.0010013580322265625, "ViewRequirementAgentConnector_ms": 0.15448737144470215}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.721000000000228, "episode_len_mean": 302.72, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 22.299999999999876, 18.099999999999817, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.50000000000001, 46.3, -50.00000000000044, 30.9, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, 4.099999999999618, 29.299999999999976, 45.1, 45.1, -50.00000000000044, 46.5, 38.700000000000024, -50.00000000000044, 32.700000000000024, -50.00000000000044, 21.299999999999862, -50.00000000000044, 47.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.5, 39.300000000000026, 45.9, 37.10000000000003, 44.900000000000006, 35.500000000000036, 45.7, 45.1, -50.00000000000044, 36.900000000000034, 42.900000000000006, 25.29999999999992, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.900000000000006, 24.299999999999905, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 47.1, 33.70000000000004, 5.6999999999996405, 46.099999999999994, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 500, 278, 320, 500, 54, 500, 500, 500, 500, 500, 500, 500, 500, 44, 66, 38, 500, 192, 130, 500, 500, 500, 60, 500, 292, 500, 500, 500, 500, 42, 36, 500, 500, 70, 500, 500, 62, 500, 72, 64, 500, 500, 460, 208, 50, 50, 500, 36, 114, 500, 174, 500, 288, 500, 26, 74, 500, 500, 500, 36, 500, 36, 108, 42, 130, 52, 146, 44, 50, 500, 132, 72, 248, 52, 500, 500, 500, 78, 500, 52, 258, 500, 82, 500, 500, 70, 500, 30, 164, 444, 40, 500, 28, 500, 500, 500, 38, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39350299760913315, "mean_inference_ms": 1.2682651959010909, "mean_action_processing_ms": 0.14872794029011918, "mean_env_wait_ms": 0.0875629710800518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026987791061401367, "StateBufferConnector_ms": 0.0010013580322265625, "ViewRequirementAgentConnector_ms": 0.15448737144470215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4969.611421299849, "num_env_steps_trained_throughput_per_sec": 4969.611421299849, "timesteps_total": 444000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 2331.109, "sample_time_ms": 2043.427, "load_time_ms": 12.888, "load_throughput": 931134.697, "learn_time_ms": 263.521, "learn_throughput": 45537.188, "synch_weights_time_ms": 9.714}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 1627, "training_iteration": 37, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-48", "timestamp": 1698247668, "time_this_iter_s": 2.419261932373047, "time_total_s": 84.55599403381348, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 84.55599403381348, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 36.36666666666667, "ram_util_percent": 35.23333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366857e-12, "cur_lr": 0.0003, "total_loss": 6.4636817614237465, "policy_loss": 0.00010916739702224732, "vf_loss": 6.463611030578614, "vf_explained_var": -5.920728047688802e-07, "kl": 0.00011901150878657063, "entropy": 0.38466517329216005, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.554999999999806, "episode_len_mean": 270.02, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.299999999999976, 45.1, 45.1, -50.00000000000044, 46.5, 38.700000000000024, -50.00000000000044, 32.700000000000024, -50.00000000000044, 21.299999999999862, -50.00000000000044, 47.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.5, 39.300000000000026, 45.9, 37.10000000000003, 44.900000000000006, 35.500000000000036, 45.7, 45.1, -50.00000000000044, 36.900000000000034, 42.900000000000006, 25.29999999999992, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.900000000000006, 24.299999999999905, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 47.1, 33.70000000000004, 5.6999999999996405, 46.099999999999994, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 44.900000000000006, 43.7, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.9, 42.900000000000006, -50.00000000000044, 45.1, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, 44.300000000000004, -50.00000000000044, 45.1, 30.29999999999999, -50.00000000000044, 44.7, 45.5, 31.900000000000013, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 44.5, -50.00000000000044, 47.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.5, -50.00000000000044], "episode_lengths": [208, 50, 50, 500, 36, 114, 500, 174, 500, 288, 500, 26, 74, 500, 500, 500, 36, 500, 36, 108, 42, 130, 52, 146, 44, 50, 500, 132, 72, 248, 52, 500, 500, 500, 78, 500, 52, 258, 500, 82, 500, 500, 70, 500, 30, 164, 444, 40, 500, 28, 500, 500, 500, 38, 40, 500, 500, 500, 248, 52, 64, 500, 156, 500, 42, 72, 500, 50, 42, 500, 500, 500, 48, 42, 58, 500, 50, 198, 500, 54, 46, 182, 124, 500, 500, 500, 500, 212, 500, 56, 500, 24, 90, 500, 500, 500, 500, 64, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3931306996731502, "mean_inference_ms": 1.2690516579183015, "mean_action_processing_ms": 0.14891425673361053, "mean_env_wait_ms": 0.08759483899704318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0309908390045166, "StateBufferConnector_ms": 0.003998279571533203, "ViewRequirementAgentConnector_ms": 0.14849233627319336}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.554999999999806, "episode_len_mean": 270.02, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.299999999999976, 45.1, 45.1, -50.00000000000044, 46.5, 38.700000000000024, -50.00000000000044, 32.700000000000024, -50.00000000000044, 21.299999999999862, -50.00000000000044, 47.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.5, 39.300000000000026, 45.9, 37.10000000000003, 44.900000000000006, 35.500000000000036, 45.7, 45.1, -50.00000000000044, 36.900000000000034, 42.900000000000006, 25.29999999999992, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.900000000000006, 24.299999999999905, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 47.1, 33.70000000000004, 5.6999999999996405, 46.099999999999994, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 44.900000000000006, 43.7, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.9, 42.900000000000006, -50.00000000000044, 45.1, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, 44.300000000000004, -50.00000000000044, 45.1, 30.29999999999999, -50.00000000000044, 44.7, 45.5, 31.900000000000013, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 44.5, -50.00000000000044, 47.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.5, -50.00000000000044], "episode_lengths": [208, 50, 50, 500, 36, 114, 500, 174, 500, 288, 500, 26, 74, 500, 500, 500, 36, 500, 36, 108, 42, 130, 52, 146, 44, 50, 500, 132, 72, 248, 52, 500, 500, 500, 78, 500, 52, 258, 500, 82, 500, 500, 70, 500, 30, 164, 444, 40, 500, 28, 500, 500, 500, 38, 40, 500, 500, 500, 248, 52, 64, 500, 156, 500, 42, 72, 500, 50, 42, 500, 500, 500, 48, 42, 58, 500, 50, 198, 500, 54, 46, 182, 124, 500, 500, 500, 500, 212, 500, 56, 500, 24, 90, 500, 500, 500, 500, 64, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3931306996731502, "mean_inference_ms": 1.2690516579183015, "mean_action_processing_ms": 0.14891425673361053, "mean_env_wait_ms": 0.08759483899704318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0309908390045166, "StateBufferConnector_ms": 0.003998279571533203, "ViewRequirementAgentConnector_ms": 0.14849233627319336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3493.6983949296455, "num_env_steps_trained_throughput_per_sec": 3493.6983949296455, "timesteps_total": 456000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 2454.615, "sample_time_ms": 2178.511, "load_time_ms": 12.413, "load_throughput": 966759.914, "learn_time_ms": 252.486, "learn_throughput": 47527.443, "synch_weights_time_ms": 9.646}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 1671, "training_iteration": 38, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-52", "timestamp": 1698247672, "time_this_iter_s": 3.440023183822632, "time_total_s": 87.99601721763611, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 87.99601721763611, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 45.44, "ram_util_percent": 35.239999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183428e-13, "cur_lr": 0.0003, "total_loss": 6.88518664042155, "policy_loss": -0.0001014390339454015, "vf_loss": 6.885331853230794, "vf_explained_var": -4.0928522745768227e-07, "kl": 8.170851874732913e-05, "entropy": 0.4369582037130992, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 578.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.332999999999839, "episode_len_mean": 242.32, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 44.900000000000006, 43.7, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.9, 42.900000000000006, -50.00000000000044, 45.1, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, 44.300000000000004, -50.00000000000044, 45.1, 30.29999999999999, -50.00000000000044, 44.7, 45.5, 31.900000000000013, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 44.5, -50.00000000000044, 47.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 37.300000000000026, 44.900000000000006, -50.00000000000044, 46.099999999999994, 42.70000000000001, 38.700000000000024, 46.5, 35.900000000000034, 18.099999999999817, 40.30000000000002, -50.00000000000044, 46.3, -50.00000000000044, 44.5, 35.30000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, 7.699999999999669, 1.099999999999575, -50.00000000000044, 46.3, 28.29999999999996, 46.5, 44.5, 44.7, 45.1, 46.3, 45.5, 46.5, 45.7, 44.5, 40.90000000000002, 18.899999999999828, -50.00000000000044, -50.00000000000044, 38.50000000000003, 37.70000000000003, 35.30000000000004, 32.90000000000003, -50.00000000000044, 38.700000000000024, 44.5, 44.900000000000006, 23.8999999999999, 44.900000000000006, 46.5, -50.00000000000044, 45.7, -50.00000000000044, 45.1, 36.30000000000003], "episode_lengths": [500, 500, 500, 248, 52, 64, 500, 156, 500, 42, 72, 500, 50, 42, 500, 500, 500, 48, 42, 58, 500, 50, 198, 500, 54, 46, 182, 124, 500, 500, 500, 500, 212, 500, 56, 500, 24, 90, 500, 500, 500, 500, 64, 36, 500, 500, 500, 36, 128, 52, 500, 40, 74, 114, 36, 142, 320, 98, 500, 38, 500, 56, 148, 500, 500, 86, 424, 490, 500, 38, 218, 36, 56, 54, 50, 38, 46, 36, 44, 56, 92, 312, 500, 500, 116, 124, 148, 172, 500, 114, 56, 52, 262, 52, 36, 500, 44, 500, 50, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3938212420049092, "mean_inference_ms": 1.2708695538195243, "mean_action_processing_ms": 0.14945536291920006, "mean_env_wait_ms": 0.08794044699938798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035004377365112305, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.141998291015625}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.332999999999839, "episode_len_mean": 242.32, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 44.900000000000006, 43.7, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.9, 42.900000000000006, -50.00000000000044, 45.1, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, 44.300000000000004, -50.00000000000044, 45.1, 30.29999999999999, -50.00000000000044, 44.7, 45.5, 31.900000000000013, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 44.5, -50.00000000000044, 47.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 37.300000000000026, 44.900000000000006, -50.00000000000044, 46.099999999999994, 42.70000000000001, 38.700000000000024, 46.5, 35.900000000000034, 18.099999999999817, 40.30000000000002, -50.00000000000044, 46.3, -50.00000000000044, 44.5, 35.30000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, 7.699999999999669, 1.099999999999575, -50.00000000000044, 46.3, 28.29999999999996, 46.5, 44.5, 44.7, 45.1, 46.3, 45.5, 46.5, 45.7, 44.5, 40.90000000000002, 18.899999999999828, -50.00000000000044, -50.00000000000044, 38.50000000000003, 37.70000000000003, 35.30000000000004, 32.90000000000003, -50.00000000000044, 38.700000000000024, 44.5, 44.900000000000006, 23.8999999999999, 44.900000000000006, 46.5, -50.00000000000044, 45.7, -50.00000000000044, 45.1, 36.30000000000003], "episode_lengths": [500, 500, 500, 248, 52, 64, 500, 156, 500, 42, 72, 500, 50, 42, 500, 500, 500, 48, 42, 58, 500, 50, 198, 500, 54, 46, 182, 124, 500, 500, 500, 500, 212, 500, 56, 500, 24, 90, 500, 500, 500, 500, 64, 36, 500, 500, 500, 36, 128, 52, 500, 40, 74, 114, 36, 142, 320, 98, 500, 38, 500, 56, 148, 500, 500, 86, 424, 490, 500, 38, 218, 36, 56, 54, 50, 38, 46, 36, 44, 56, 92, 312, 500, 500, 116, 124, 148, 172, 500, 114, 56, 52, 262, 52, 36, 500, 44, 500, 50, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3938212420049092, "mean_inference_ms": 1.2708695538195243, "mean_action_processing_ms": 0.14945536291920006, "mean_env_wait_ms": 0.08794044699938798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035004377365112305, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.141998291015625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5452.266337468745, "num_env_steps_trained_throughput_per_sec": 5452.266337468745, "timesteps_total": 468000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 2463.911, "sample_time_ms": 2190.844, "load_time_ms": 12.513, "load_throughput": 959021.384, "learn_time_ms": 249.257, "learn_throughput": 48143.069, "synch_weights_time_ms": 9.638}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1726, "training_iteration": 39, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-54", "timestamp": 1698247674, "time_this_iter_s": 2.205702304840088, "time_total_s": 90.2017195224762, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 90.2017195224762, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 67.39999999999999, "ram_util_percent": 35.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.637978807091714e-13, "cur_lr": 0.0003, "total_loss": 6.41515703201294, "policy_loss": -4.418616493542989e-05, "vf_loss": 6.415244229634603, "vf_explained_var": -1.700719197591146e-06, "kl": 6.665976766650298e-05, "entropy": 0.42842058738072714, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 593.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.036999999999832, "episode_len_mean": 245.3, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 37.300000000000026, 44.900000000000006, -50.00000000000044, 46.099999999999994, 42.70000000000001, 38.700000000000024, 46.5, 35.900000000000034, 18.099999999999817, 40.30000000000002, -50.00000000000044, 46.3, -50.00000000000044, 44.5, 35.30000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, 7.699999999999669, 1.099999999999575, -50.00000000000044, 46.3, 28.29999999999996, 46.5, 44.5, 44.7, 45.1, 46.3, 45.5, 46.5, 45.7, 44.5, 40.90000000000002, 18.899999999999828, -50.00000000000044, -50.00000000000044, 38.50000000000003, 37.70000000000003, 35.30000000000004, 32.90000000000003, -50.00000000000044, 38.700000000000024, 44.5, 44.900000000000006, 23.8999999999999, 44.900000000000006, 46.5, -50.00000000000044, 45.7, -50.00000000000044, 45.1, 36.30000000000003, -50.00000000000044, 14.899999999999771, -50.00000000000044, 46.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 47.5, 21.699999999999868, 43.50000000000001, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, 43.7, 45.5, 45.3, 24.899999999999913, 2.699999999999598, 32.100000000000016, -50.00000000000044, 44.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 39.70000000000002, 22.699999999999882, -50.00000000000044, -50.00000000000044, 44.5, 6.699999999999655, 34.900000000000034, -50.00000000000044], "episode_lengths": [500, 500, 64, 36, 500, 500, 500, 36, 128, 52, 500, 40, 74, 114, 36, 142, 320, 98, 500, 38, 500, 56, 148, 500, 500, 86, 424, 490, 500, 38, 218, 36, 56, 54, 50, 38, 46, 36, 44, 56, 92, 312, 500, 500, 116, 124, 148, 172, 500, 114, 56, 52, 262, 52, 36, 500, 44, 500, 50, 138, 500, 352, 500, 36, 500, 62, 500, 26, 500, 500, 500, 500, 500, 106, 26, 284, 66, 500, 40, 32, 500, 64, 46, 48, 252, 474, 180, 500, 60, 34, 500, 500, 104, 274, 500, 500, 56, 434, 152, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39436715329624755, "mean_inference_ms": 1.2715052696738531, "mean_action_processing_ms": 0.14906571249123718, "mean_env_wait_ms": 0.08796592737454902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024965286254882812, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.12796998023986816}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.036999999999832, "episode_len_mean": 245.3, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 37.300000000000026, 44.900000000000006, -50.00000000000044, 46.099999999999994, 42.70000000000001, 38.700000000000024, 46.5, 35.900000000000034, 18.099999999999817, 40.30000000000002, -50.00000000000044, 46.3, -50.00000000000044, 44.5, 35.30000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, 7.699999999999669, 1.099999999999575, -50.00000000000044, 46.3, 28.29999999999996, 46.5, 44.5, 44.7, 45.1, 46.3, 45.5, 46.5, 45.7, 44.5, 40.90000000000002, 18.899999999999828, -50.00000000000044, -50.00000000000044, 38.50000000000003, 37.70000000000003, 35.30000000000004, 32.90000000000003, -50.00000000000044, 38.700000000000024, 44.5, 44.900000000000006, 23.8999999999999, 44.900000000000006, 46.5, -50.00000000000044, 45.7, -50.00000000000044, 45.1, 36.30000000000003, -50.00000000000044, 14.899999999999771, -50.00000000000044, 46.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 47.5, 21.699999999999868, 43.50000000000001, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, 43.7, 45.5, 45.3, 24.899999999999913, 2.699999999999598, 32.100000000000016, -50.00000000000044, 44.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 39.70000000000002, 22.699999999999882, -50.00000000000044, -50.00000000000044, 44.5, 6.699999999999655, 34.900000000000034, -50.00000000000044], "episode_lengths": [500, 500, 64, 36, 500, 500, 500, 36, 128, 52, 500, 40, 74, 114, 36, 142, 320, 98, 500, 38, 500, 56, 148, 500, 500, 86, 424, 490, 500, 38, 218, 36, 56, 54, 50, 38, 46, 36, 44, 56, 92, 312, 500, 500, 116, 124, 148, 172, 500, 114, 56, 52, 262, 52, 36, 500, 44, 500, 50, 138, 500, 352, 500, 36, 500, 62, 500, 26, 500, 500, 500, 500, 500, 106, 26, 284, 66, 500, 40, 32, 500, 64, 46, 48, 252, 474, 180, 500, 60, 34, 500, 500, 104, 274, 500, 500, 56, 434, 152, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39436715329624755, "mean_inference_ms": 1.2715052696738531, "mean_action_processing_ms": 0.14906571249123718, "mean_env_wait_ms": 0.08796592737454902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024965286254882812, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.12796998023986816}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5364.087136438598, "num_env_steps_trained_throughput_per_sec": 5364.087136438598, "timesteps_total": 480000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 2450.361, "sample_time_ms": 2188.062, "load_time_ms": 12.69, "load_throughput": 945614.357, "learn_time_ms": 238.409, "learn_throughput": 50333.566, "synch_weights_time_ms": 9.541}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 1766, "training_iteration": 40, "trial_id": "9f288_00011", "date": "2023-10-25_16-27-58", "timestamp": 1698247678, "time_this_iter_s": 2.241826295852661, "time_total_s": 92.44354581832886, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 92.44354581832886, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 39.84, "ram_util_percent": 35.260000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.818989403545857e-13, "cur_lr": 0.0003, "total_loss": 6.786435095469157, "policy_loss": 7.81351700425148e-05, "vf_loss": 6.786395454406739, "vf_explained_var": 9.735425313313801e-07, "kl": 4.90663866135795e-05, "entropy": 0.3858126242955526, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 608.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.01699999999982, "episode_len_mean": 255.48, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, 45.7, -50.00000000000044, 45.1, 36.30000000000003, -50.00000000000044, 14.899999999999771, -50.00000000000044, 46.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 47.5, 21.699999999999868, 43.50000000000001, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, 43.7, 45.5, 45.3, 24.899999999999913, 2.699999999999598, 32.100000000000016, -50.00000000000044, 44.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 39.70000000000002, 22.699999999999882, -50.00000000000044, -50.00000000000044, 44.5, 6.699999999999655, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.699999999999996, 23.099999999999888, 21.89999999999987, 39.50000000000002, 37.90000000000003, -50.00000000000044, 23.29999999999989, -50.00000000000044, 35.70000000000003, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 37.300000000000026, 42.500000000000014, 47.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 9.299999999999692, -50.00000000000044, 43.50000000000001, 15.699999999999783, 46.3, 41.500000000000014, 1.099999999999575, 46.099999999999994, 41.500000000000014, 43.7, 48.1, 42.70000000000001, 44.7, 4.099999999999618, 45.9, 45.9, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.50000000000001, 45.7, 47.1, 34.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.90000000000002, -50.00000000000044], "episode_lengths": [36, 500, 44, 500, 50, 138, 500, 352, 500, 36, 500, 62, 500, 26, 500, 500, 500, 500, 500, 106, 26, 284, 66, 500, 40, 32, 500, 64, 46, 48, 252, 474, 180, 500, 60, 34, 500, 500, 104, 274, 500, 500, 56, 434, 152, 500, 500, 500, 72, 34, 270, 282, 106, 122, 500, 268, 500, 144, 500, 70, 48, 500, 128, 76, 28, 60, 500, 500, 56, 500, 408, 500, 66, 344, 38, 86, 490, 40, 86, 64, 20, 74, 54, 460, 42, 42, 42, 500, 500, 500, 28, 66, 44, 30, 158, 500, 500, 34, 92, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3940851496834187, "mean_inference_ms": 1.2700741098603126, "mean_action_processing_ms": 0.14918240142844488, "mean_env_wait_ms": 0.08810506754921998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025954008102416992, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.11991763114929199}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.01699999999982, "episode_len_mean": 255.48, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, 45.7, -50.00000000000044, 45.1, 36.30000000000003, -50.00000000000044, 14.899999999999771, -50.00000000000044, 46.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 47.5, 21.699999999999868, 43.50000000000001, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, 43.7, 45.5, 45.3, 24.899999999999913, 2.699999999999598, 32.100000000000016, -50.00000000000044, 44.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 39.70000000000002, 22.699999999999882, -50.00000000000044, -50.00000000000044, 44.5, 6.699999999999655, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.699999999999996, 23.099999999999888, 21.89999999999987, 39.50000000000002, 37.90000000000003, -50.00000000000044, 23.29999999999989, -50.00000000000044, 35.70000000000003, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 37.300000000000026, 42.500000000000014, 47.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 9.299999999999692, -50.00000000000044, 43.50000000000001, 15.699999999999783, 46.3, 41.500000000000014, 1.099999999999575, 46.099999999999994, 41.500000000000014, 43.7, 48.1, 42.70000000000001, 44.7, 4.099999999999618, 45.9, 45.9, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.50000000000001, 45.7, 47.1, 34.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.90000000000002, -50.00000000000044], "episode_lengths": [36, 500, 44, 500, 50, 138, 500, 352, 500, 36, 500, 62, 500, 26, 500, 500, 500, 500, 500, 106, 26, 284, 66, 500, 40, 32, 500, 64, 46, 48, 252, 474, 180, 500, 60, 34, 500, 500, 104, 274, 500, 500, 56, 434, 152, 500, 500, 500, 72, 34, 270, 282, 106, 122, 500, 268, 500, 144, 500, 70, 48, 500, 128, 76, 28, 60, 500, 500, 56, 500, 408, 500, 66, 344, 38, 86, 490, 40, 86, 64, 20, 74, 54, 460, 42, 42, 42, 500, 500, 500, 28, 66, 44, 30, 158, 500, 500, 34, 92, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3940851496834187, "mean_inference_ms": 1.2700741098603126, "mean_action_processing_ms": 0.14918240142844488, "mean_env_wait_ms": 0.08810506754921998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025954008102416992, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.11991763114929199}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5436.2825469613335, "num_env_steps_trained_throughput_per_sec": 5436.2825469613335, "timesteps_total": 492000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 2443.585, "sample_time_ms": 2183.779, "load_time_ms": 12.728, "load_throughput": 942815.654, "learn_time_ms": 235.977, "learn_throughput": 50852.453, "synch_weights_time_ms": 9.642}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 1820, "training_iteration": 41, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-00", "timestamp": 1698247680, "time_this_iter_s": 2.2123892307281494, "time_total_s": 94.655935049057, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 94.655935049057, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 62.19999999999999, "ram_util_percent": 35.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729285e-14, "cur_lr": 0.0003, "total_loss": 5.932764593760172, "policy_loss": -0.00012758541852235793, "vf_loss": 5.932937208811442, "vf_explained_var": -1.5576680501302083e-06, "kl": 6.747472032534082e-05, "entropy": 0.4498594005902608, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 623.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.764999999999842, "episode_len_mean": 228.04, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, 46.699999999999996, 23.099999999999888, 21.89999999999987, 39.50000000000002, 37.90000000000003, -50.00000000000044, 23.29999999999989, -50.00000000000044, 35.70000000000003, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 37.300000000000026, 42.500000000000014, 47.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 9.299999999999692, -50.00000000000044, 43.50000000000001, 15.699999999999783, 46.3, 41.500000000000014, 1.099999999999575, 46.099999999999994, 41.500000000000014, 43.7, 48.1, 42.70000000000001, 44.7, 4.099999999999618, 45.9, 45.9, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.50000000000001, 45.7, 47.1, 34.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.90000000000002, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.500000000000014, 44.900000000000006, -50.00000000000044, 38.10000000000002, 46.699999999999996, -50.00000000000044, 41.90000000000001, 45.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, 2.0999999999995893, 39.10000000000002, 45.3, 45.3, 43.30000000000001, 46.099999999999994, 46.5, 45.1, 29.899999999999984, 28.89999999999997, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, 46.9, 42.900000000000006, 43.10000000000001, 44.5, 45.9, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001], "episode_lengths": [72, 34, 270, 282, 106, 122, 500, 268, 500, 144, 500, 70, 48, 500, 128, 76, 28, 60, 500, 500, 56, 500, 408, 500, 66, 344, 38, 86, 490, 40, 86, 64, 20, 74, 54, 460, 42, 42, 42, 500, 500, 500, 28, 66, 44, 30, 158, 500, 500, 34, 92, 500, 200, 500, 500, 72, 76, 52, 500, 120, 34, 500, 82, 48, 98, 500, 500, 42, 480, 110, 48, 48, 68, 40, 36, 50, 202, 212, 500, 90, 500, 54, 500, 500, 500, 500, 44, 500, 34, 32, 72, 70, 56, 42, 500, 42, 500, 500, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3933348381328369, "mean_inference_ms": 1.2689892968239298, "mean_action_processing_ms": 0.14946557750517345, "mean_env_wait_ms": 0.08807907553162829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020992755889892578, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.12297844886779785}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.764999999999842, "episode_len_mean": 228.04, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, 46.699999999999996, 23.099999999999888, 21.89999999999987, 39.50000000000002, 37.90000000000003, -50.00000000000044, 23.29999999999989, -50.00000000000044, 35.70000000000003, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 37.300000000000026, 42.500000000000014, 47.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 9.299999999999692, -50.00000000000044, 43.50000000000001, 15.699999999999783, 46.3, 41.500000000000014, 1.099999999999575, 46.099999999999994, 41.500000000000014, 43.7, 48.1, 42.70000000000001, 44.7, 4.099999999999618, 45.9, 45.9, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.50000000000001, 45.7, 47.1, 34.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.90000000000002, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.500000000000014, 44.900000000000006, -50.00000000000044, 38.10000000000002, 46.699999999999996, -50.00000000000044, 41.90000000000001, 45.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, 2.0999999999995893, 39.10000000000002, 45.3, 45.3, 43.30000000000001, 46.099999999999994, 46.5, 45.1, 29.899999999999984, 28.89999999999997, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, 46.9, 42.900000000000006, 43.10000000000001, 44.5, 45.9, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001], "episode_lengths": [72, 34, 270, 282, 106, 122, 500, 268, 500, 144, 500, 70, 48, 500, 128, 76, 28, 60, 500, 500, 56, 500, 408, 500, 66, 344, 38, 86, 490, 40, 86, 64, 20, 74, 54, 460, 42, 42, 42, 500, 500, 500, 28, 66, 44, 30, 158, 500, 500, 34, 92, 500, 200, 500, 500, 72, 76, 52, 500, 120, 34, 500, 82, 48, 98, 500, 500, 42, 480, 110, 48, 48, 68, 40, 36, 50, 202, 212, 500, 90, 500, 54, 500, 500, 500, 500, 44, 500, 34, 32, 72, 70, 56, 42, 500, 42, 500, 500, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3933348381328369, "mean_inference_ms": 1.2689892968239298, "mean_action_processing_ms": 0.14946557750517345, "mean_env_wait_ms": 0.08807907553162829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020992755889892578, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.12297844886779785}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3355.4539374526, "num_env_steps_trained_throughput_per_sec": 3355.4539374526, "timesteps_total": 504000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 2567.146, "sample_time_ms": 2308.296, "load_time_ms": 13.164, "load_throughput": 911610.344, "learn_time_ms": 234.777, "learn_throughput": 51112.239, "synch_weights_time_ms": 9.609}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1868, "training_iteration": 42, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-04", "timestamp": 1698247684, "time_this_iter_s": 3.5819616317749023, "time_total_s": 98.23789668083191, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 98.23789668083191, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 42.76, "ram_util_percent": 35.239999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864643e-14, "cur_lr": 0.0003, "total_loss": 6.457287915547689, "policy_loss": -0.00024272048225005468, "vf_loss": 6.457574621836344, "vf_explained_var": -1.9470850626627604e-07, "kl": 0.0002754180708919307, "entropy": 0.44061699708302815, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 638.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.386999999999821, "episode_len_mean": 251.74, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.699999999999996, 40.90000000000002, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.500000000000014, 44.900000000000006, -50.00000000000044, 38.10000000000002, 46.699999999999996, -50.00000000000044, 41.90000000000001, 45.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, 2.0999999999995893, 39.10000000000002, 45.3, 45.3, 43.30000000000001, 46.099999999999994, 46.5, 45.1, 29.899999999999984, 28.89999999999997, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, 46.9, 42.900000000000006, 43.10000000000001, 44.5, 45.9, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.1, 42.70000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 18.29999999999982, -50.00000000000044, 39.50000000000002, 19.69999999999984, -50.00000000000044, 47.3, 45.9, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 40.10000000000002, -50.00000000000044, -50.00000000000044, 32.50000000000002, 46.5, 46.5, -50.00000000000044, -50.00000000000044, 26.499999999999936, 42.30000000000001, 29.299999999999976, -50.00000000000044, 43.10000000000001, 45.3, 46.099999999999994, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, 28.699999999999967, 44.5, -50.00000000000044, 46.3, -50.00000000000044], "episode_lengths": [500, 500, 34, 92, 500, 200, 500, 500, 72, 76, 52, 500, 120, 34, 500, 82, 48, 98, 500, 500, 42, 480, 110, 48, 48, 68, 40, 36, 50, 202, 212, 500, 90, 500, 54, 500, 500, 500, 500, 44, 500, 34, 32, 72, 70, 56, 42, 500, 42, 500, 500, 500, 78, 500, 500, 98, 50, 74, 500, 76, 500, 500, 48, 500, 318, 500, 106, 304, 500, 28, 42, 52, 500, 50, 500, 52, 100, 500, 500, 176, 36, 36, 500, 500, 236, 78, 208, 500, 70, 48, 40, 86, 500, 500, 96, 214, 56, 500, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39351943892415037, "mean_inference_ms": 1.2689589776260524, "mean_action_processing_ms": 0.1491243219360897, "mean_env_wait_ms": 0.08797489768681793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01799464225769043, "StateBufferConnector_ms": 0.00600433349609375, "ViewRequirementAgentConnector_ms": 0.13301873207092285}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.386999999999821, "episode_len_mean": 251.74, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.699999999999996, 40.90000000000002, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.500000000000014, 44.900000000000006, -50.00000000000044, 38.10000000000002, 46.699999999999996, -50.00000000000044, 41.90000000000001, 45.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, 2.0999999999995893, 39.10000000000002, 45.3, 45.3, 43.30000000000001, 46.099999999999994, 46.5, 45.1, 29.899999999999984, 28.89999999999997, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, 46.9, 42.900000000000006, 43.10000000000001, 44.5, 45.9, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.1, 42.70000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 18.29999999999982, -50.00000000000044, 39.50000000000002, 19.69999999999984, -50.00000000000044, 47.3, 45.9, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 40.10000000000002, -50.00000000000044, -50.00000000000044, 32.50000000000002, 46.5, 46.5, -50.00000000000044, -50.00000000000044, 26.499999999999936, 42.30000000000001, 29.299999999999976, -50.00000000000044, 43.10000000000001, 45.3, 46.099999999999994, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, 28.699999999999967, 44.5, -50.00000000000044, 46.3, -50.00000000000044], "episode_lengths": [500, 500, 34, 92, 500, 200, 500, 500, 72, 76, 52, 500, 120, 34, 500, 82, 48, 98, 500, 500, 42, 480, 110, 48, 48, 68, 40, 36, 50, 202, 212, 500, 90, 500, 54, 500, 500, 500, 500, 44, 500, 34, 32, 72, 70, 56, 42, 500, 42, 500, 500, 500, 78, 500, 500, 98, 50, 74, 500, 76, 500, 500, 48, 500, 318, 500, 106, 304, 500, 28, 42, 52, 500, 50, 500, 52, 100, 500, 500, 176, 36, 36, 500, 500, 236, 78, 208, 500, 70, 48, 40, 86, 500, 500, 96, 214, 56, 500, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39351943892415037, "mean_inference_ms": 1.2689589776260524, "mean_action_processing_ms": 0.1491243219360897, "mean_env_wait_ms": 0.08797489768681793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01799464225769043, "StateBufferConnector_ms": 0.00600433349609375, "ViewRequirementAgentConnector_ms": 0.13301873207092285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5663.578900084146, "num_env_steps_trained_throughput_per_sec": 5663.578900084146, "timesteps_total": 516000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 2512.809, "sample_time_ms": 2268.445, "load_time_ms": 12.489, "load_throughput": 960824.682, "learn_time_ms": 221.136, "learn_throughput": 54265.29, "synch_weights_time_ms": 9.539}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 1915, "training_iteration": 43, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-06", "timestamp": 1698247686, "time_this_iter_s": 2.123800039291382, "time_total_s": 100.36169672012329, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 100.36169672012329, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 57.53333333333334, "ram_util_percent": 35.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2737367544323214e-14, "cur_lr": 0.0003, "total_loss": 6.643800131479899, "policy_loss": -0.0003242497642834981, "vf_loss": 6.644168821970622, "vf_explained_var": -8.781750996907552e-07, "kl": 0.00022330713818519143, "entropy": 0.44501368403434755, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.0129999999998125, "episode_len_mean": 265.48, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.1, 42.70000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 18.29999999999982, -50.00000000000044, 39.50000000000002, 19.69999999999984, -50.00000000000044, 47.3, 45.9, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 40.10000000000002, -50.00000000000044, -50.00000000000044, 32.50000000000002, 46.5, 46.5, -50.00000000000044, -50.00000000000044, 26.499999999999936, 42.30000000000001, 29.299999999999976, -50.00000000000044, 43.10000000000001, 45.3, 46.099999999999994, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, 28.699999999999967, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 16.29999999999979, 45.5, 36.900000000000034, 3.2999999999996064, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, -50.00000000000044, 42.900000000000006, 39.10000000000002, 11.899999999999729, 44.900000000000006, 43.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, 43.7, -50.00000000000044, -50.00000000000044, 36.900000000000034, 47.3, 42.70000000000001, 46.9, 2.299999999999592, 40.90000000000002, 14.299999999999763, 33.70000000000004, -50.00000000000044, 41.90000000000001, 47.7, -50.00000000000044, 44.7, -50.00000000000044, 46.3, 31.300000000000004, 42.70000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 42, 500, 500, 500, 78, 500, 500, 98, 50, 74, 500, 76, 500, 500, 48, 500, 318, 500, 106, 304, 500, 28, 42, 52, 500, 50, 500, 52, 100, 500, 500, 176, 36, 36, 500, 500, 236, 78, 208, 500, 70, 48, 40, 86, 500, 500, 96, 214, 56, 500, 38, 500, 338, 46, 132, 468, 52, 500, 500, 500, 500, 116, 40, 500, 72, 110, 382, 52, 70, 500, 74, 500, 42, 500, 500, 112, 64, 500, 500, 132, 28, 74, 32, 478, 92, 358, 164, 500, 82, 24, 500, 54, 500, 38, 188, 74, 124, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3937123763480868, "mean_inference_ms": 1.2685816427173737, "mean_action_processing_ms": 0.1489106835872542, "mean_env_wait_ms": 0.0879243367658815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022011280059814453, "StateBufferConnector_ms": 0.008005142211914062, "ViewRequirementAgentConnector_ms": 0.12797832489013672}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.0129999999998125, "episode_len_mean": 265.48, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.1, 42.70000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 18.29999999999982, -50.00000000000044, 39.50000000000002, 19.69999999999984, -50.00000000000044, 47.3, 45.9, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 40.10000000000002, -50.00000000000044, -50.00000000000044, 32.50000000000002, 46.5, 46.5, -50.00000000000044, -50.00000000000044, 26.499999999999936, 42.30000000000001, 29.299999999999976, -50.00000000000044, 43.10000000000001, 45.3, 46.099999999999994, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, 28.699999999999967, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 16.29999999999979, 45.5, 36.900000000000034, 3.2999999999996064, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, -50.00000000000044, 42.900000000000006, 39.10000000000002, 11.899999999999729, 44.900000000000006, 43.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, 43.7, -50.00000000000044, -50.00000000000044, 36.900000000000034, 47.3, 42.70000000000001, 46.9, 2.299999999999592, 40.90000000000002, 14.299999999999763, 33.70000000000004, -50.00000000000044, 41.90000000000001, 47.7, -50.00000000000044, 44.7, -50.00000000000044, 46.3, 31.300000000000004, 42.70000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 42, 500, 500, 500, 78, 500, 500, 98, 50, 74, 500, 76, 500, 500, 48, 500, 318, 500, 106, 304, 500, 28, 42, 52, 500, 50, 500, 52, 100, 500, 500, 176, 36, 36, 500, 500, 236, 78, 208, 500, 70, 48, 40, 86, 500, 500, 96, 214, 56, 500, 38, 500, 338, 46, 132, 468, 52, 500, 500, 500, 500, 116, 40, 500, 72, 110, 382, 52, 70, 500, 74, 500, 42, 500, 500, 112, 64, 500, 500, 132, 28, 74, 32, 478, 92, 358, 164, 500, 82, 24, 500, 54, 500, 38, 188, 74, 124, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3937123763480868, "mean_inference_ms": 1.2685816427173737, "mean_action_processing_ms": 0.1489106835872542, "mean_env_wait_ms": 0.0879243367658815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022011280059814453, "StateBufferConnector_ms": 0.008005142211914062, "ViewRequirementAgentConnector_ms": 0.12797832489013672}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3493.3865548930626, "num_env_steps_trained_throughput_per_sec": 3493.3865548930626, "timesteps_total": 528000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 2644.063, "sample_time_ms": 2386.824, "load_time_ms": 13.487, "load_throughput": 889759.492, "learn_time_ms": 233.125, "learn_throughput": 51474.474, "synch_weights_time_ms": 9.527}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 1962, "training_iteration": 44, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-09", "timestamp": 1698247689, "time_this_iter_s": 3.4400787353515625, "time_total_s": 103.80177545547485, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 103.80177545547485, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 39.18, "ram_util_percent": 35.239999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161607e-14, "cur_lr": 0.0003, "total_loss": 6.5888142585754395, "policy_loss": -0.0002656840408841769, "vf_loss": 6.589123471577962, "vf_explained_var": -8.265177408854167e-07, "kl": 0.0003379841843260086, "entropy": 0.4345457712809245, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 668.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.557999999999825, "episode_len_mean": 255.08, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, 28.699999999999967, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 16.29999999999979, 45.5, 36.900000000000034, 3.2999999999996064, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, -50.00000000000044, 42.900000000000006, 39.10000000000002, 11.899999999999729, 44.900000000000006, 43.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, 43.7, -50.00000000000044, -50.00000000000044, 36.900000000000034, 47.3, 42.70000000000001, 46.9, 2.299999999999592, 40.90000000000002, 14.299999999999763, 33.70000000000004, -50.00000000000044, 41.90000000000001, 47.7, -50.00000000000044, 44.7, -50.00000000000044, 46.3, 31.300000000000004, 42.70000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 37.90000000000003, 45.7, -50.00000000000044, 45.3, 2.0999999999995893, -50.00000000000044, 43.30000000000001, 46.099999999999994, 26.09999999999993, 25.899999999999928, -50.00000000000044, -50.00000000000044, 43.7, 0.49999999999956657, 45.1, -50.00000000000044, 40.90000000000002, 27.099999999999945, 47.1, 44.10000000000001, -50.00000000000044, 46.5, 17.099999999999802, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 42.30000000000001, -50.00000000000044, 43.7, 42.70000000000001, 46.5, -50.00000000000044, 47.1, 14.09999999999976, 46.9, 39.50000000000002, 32.100000000000016], "episode_lengths": [500, 96, 214, 56, 500, 38, 500, 338, 46, 132, 468, 52, 500, 500, 500, 500, 116, 40, 500, 72, 110, 382, 52, 70, 500, 74, 500, 42, 500, 500, 112, 64, 500, 500, 132, 28, 74, 32, 478, 92, 358, 164, 500, 82, 24, 500, 54, 500, 38, 188, 74, 124, 500, 500, 500, 500, 142, 122, 44, 500, 48, 480, 500, 68, 40, 240, 242, 500, 500, 64, 496, 50, 500, 92, 230, 30, 60, 500, 36, 330, 60, 56, 500, 500, 500, 52, 500, 500, 50, 78, 500, 64, 74, 36, 500, 30, 360, 32, 106, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39322044593974226, "mean_inference_ms": 1.267208930447825, "mean_action_processing_ms": 0.1485624625501626, "mean_env_wait_ms": 0.08782387470602084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028064250946044922, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.12028980255126953}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.557999999999825, "episode_len_mean": 255.08, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, 28.699999999999967, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 16.29999999999979, 45.5, 36.900000000000034, 3.2999999999996064, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, -50.00000000000044, 42.900000000000006, 39.10000000000002, 11.899999999999729, 44.900000000000006, 43.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, 43.7, -50.00000000000044, -50.00000000000044, 36.900000000000034, 47.3, 42.70000000000001, 46.9, 2.299999999999592, 40.90000000000002, 14.299999999999763, 33.70000000000004, -50.00000000000044, 41.90000000000001, 47.7, -50.00000000000044, 44.7, -50.00000000000044, 46.3, 31.300000000000004, 42.70000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 37.90000000000003, 45.7, -50.00000000000044, 45.3, 2.0999999999995893, -50.00000000000044, 43.30000000000001, 46.099999999999994, 26.09999999999993, 25.899999999999928, -50.00000000000044, -50.00000000000044, 43.7, 0.49999999999956657, 45.1, -50.00000000000044, 40.90000000000002, 27.099999999999945, 47.1, 44.10000000000001, -50.00000000000044, 46.5, 17.099999999999802, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 42.30000000000001, -50.00000000000044, 43.7, 42.70000000000001, 46.5, -50.00000000000044, 47.1, 14.09999999999976, 46.9, 39.50000000000002, 32.100000000000016], "episode_lengths": [500, 96, 214, 56, 500, 38, 500, 338, 46, 132, 468, 52, 500, 500, 500, 500, 116, 40, 500, 72, 110, 382, 52, 70, 500, 74, 500, 42, 500, 500, 112, 64, 500, 500, 132, 28, 74, 32, 478, 92, 358, 164, 500, 82, 24, 500, 54, 500, 38, 188, 74, 124, 500, 500, 500, 500, 142, 122, 44, 500, 48, 480, 500, 68, 40, 240, 242, 500, 500, 64, 496, 50, 500, 92, 230, 30, 60, 500, 36, 330, 60, 56, 500, 500, 500, 52, 500, 500, 50, 78, 500, 64, 74, 36, 500, 30, 360, 32, 106, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39322044593974226, "mean_inference_ms": 1.267208930447825, "mean_action_processing_ms": 0.1485624625501626, "mean_env_wait_ms": 0.08782387470602084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028064250946044922, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.12028980255126953}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5490.067426466538, "num_env_steps_trained_throughput_per_sec": 5490.067426466538, "timesteps_total": 540000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 2632.424, "sample_time_ms": 2382.726, "load_time_ms": 13.314, "load_throughput": 901285.324, "learn_time_ms": 226.054, "learn_throughput": 53084.56, "synch_weights_time_ms": 9.429}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2008, "training_iteration": 45, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-11", "timestamp": 1698247691, "time_this_iter_s": 2.190764904022217, "time_total_s": 105.99254035949707, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 105.99254035949707, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 61.9, "ram_util_percent": 35.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.684341886080803e-15, "cur_lr": 0.0003, "total_loss": 6.8950876553853355, "policy_loss": -7.751832405726115e-05, "vf_loss": 6.895210870107015, "vf_explained_var": -2.662340799967448e-07, "kl": 0.0003416470554005476, "entropy": 0.4557202537854513, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 683.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9029999999998086, "episode_len_mean": 266.58, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 31.300000000000004, 42.70000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 37.90000000000003, 45.7, -50.00000000000044, 45.3, 2.0999999999995893, -50.00000000000044, 43.30000000000001, 46.099999999999994, 26.09999999999993, 25.899999999999928, -50.00000000000044, -50.00000000000044, 43.7, 0.49999999999956657, 45.1, -50.00000000000044, 40.90000000000002, 27.099999999999945, 47.1, 44.10000000000001, -50.00000000000044, 46.5, 17.099999999999802, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 42.30000000000001, -50.00000000000044, 43.7, 42.70000000000001, 46.5, -50.00000000000044, 47.1, 14.09999999999976, 46.9, 39.50000000000002, 32.100000000000016, 9.099999999999689, 40.70000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.900000000000006, 23.699999999999896, 46.9, 34.900000000000034, 46.9, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, -50.00000000000044, 27.699999999999953, 34.10000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.90000000000001, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.300000000000004, 24.099999999999902, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [38, 188, 74, 124, 500, 500, 500, 500, 142, 122, 44, 500, 48, 480, 500, 68, 40, 240, 242, 500, 500, 64, 496, 50, 500, 92, 230, 30, 60, 500, 36, 330, 60, 56, 500, 500, 500, 52, 500, 500, 50, 78, 500, 64, 74, 36, 500, 30, 360, 32, 106, 180, 410, 94, 500, 40, 500, 62, 500, 52, 264, 32, 152, 32, 60, 500, 42, 500, 500, 500, 500, 34, 52, 500, 224, 160, 500, 500, 34, 82, 50, 52, 500, 500, 218, 500, 52, 48, 500, 500, 86, 500, 500, 500, 92, 58, 260, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39272694044617695, "mean_inference_ms": 1.266696908453344, "mean_action_processing_ms": 0.14814305001325187, "mean_env_wait_ms": 0.08779495662951863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03149056434631348, "StateBufferConnector_ms": 0.009003162384033203, "ViewRequirementAgentConnector_ms": 0.126206636428833}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9029999999998086, "episode_len_mean": 266.58, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 31.300000000000004, 42.70000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 37.90000000000003, 45.7, -50.00000000000044, 45.3, 2.0999999999995893, -50.00000000000044, 43.30000000000001, 46.099999999999994, 26.09999999999993, 25.899999999999928, -50.00000000000044, -50.00000000000044, 43.7, 0.49999999999956657, 45.1, -50.00000000000044, 40.90000000000002, 27.099999999999945, 47.1, 44.10000000000001, -50.00000000000044, 46.5, 17.099999999999802, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 42.30000000000001, -50.00000000000044, 43.7, 42.70000000000001, 46.5, -50.00000000000044, 47.1, 14.09999999999976, 46.9, 39.50000000000002, 32.100000000000016, 9.099999999999689, 40.70000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.900000000000006, 23.699999999999896, 46.9, 34.900000000000034, 46.9, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, -50.00000000000044, 27.699999999999953, 34.10000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.90000000000001, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.300000000000004, 24.099999999999902, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [38, 188, 74, 124, 500, 500, 500, 500, 142, 122, 44, 500, 48, 480, 500, 68, 40, 240, 242, 500, 500, 64, 496, 50, 500, 92, 230, 30, 60, 500, 36, 330, 60, 56, 500, 500, 500, 52, 500, 500, 50, 78, 500, 64, 74, 36, 500, 30, 360, 32, 106, 180, 410, 94, 500, 40, 500, 62, 500, 52, 264, 32, 152, 32, 60, 500, 42, 500, 500, 500, 500, 34, 52, 500, 224, 160, 500, 500, 34, 82, 50, 52, 500, 500, 218, 500, 52, 48, 500, 500, 86, 500, 500, 500, 92, 58, 260, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39272694044617695, "mean_inference_ms": 1.266696908453344, "mean_action_processing_ms": 0.14814305001325187, "mean_env_wait_ms": 0.08779495662951863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03149056434631348, "StateBufferConnector_ms": 0.009003162384033203, "ViewRequirementAgentConnector_ms": 0.126206636428833}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5168.272221944404, "num_env_steps_trained_throughput_per_sec": 5168.272221944404, "timesteps_total": 552000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 2613.26, "sample_time_ms": 2359.313, "load_time_ms": 13.08, "load_throughput": 917461.233, "learn_time_ms": 230.516, "learn_throughput": 52057.193, "synch_weights_time_ms": 9.451}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 2056, "training_iteration": 46, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-14", "timestamp": 1698247694, "time_this_iter_s": 2.3258605003356934, "time_total_s": 108.31840085983276, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 108.31840085983276, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 62.26666666666667, "ram_util_percent": 35.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404017e-15, "cur_lr": 0.0003, "total_loss": 6.469862524668375, "policy_loss": -4.321833451588949e-05, "vf_loss": 6.469952011108399, "vf_explained_var": -6.834665934244792e-07, "kl": 2.7671182817812223e-05, "entropy": 0.4615615487098694, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 698.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0229999999997994, "episode_len_mean": 275.34, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, 42.30000000000001, -50.00000000000044, 43.7, 42.70000000000001, 46.5, -50.00000000000044, 47.1, 14.09999999999976, 46.9, 39.50000000000002, 32.100000000000016, 9.099999999999689, 40.70000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.900000000000006, 23.699999999999896, 46.9, 34.900000000000034, 46.9, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, -50.00000000000044, 27.699999999999953, 34.10000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.90000000000001, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.300000000000004, 24.099999999999902, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 46.9, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 28.29999999999996, 45.7, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 40.500000000000014, 38.90000000000002, 42.70000000000001, 41.90000000000001, 9.8999999999997, 9.499999999999694, 44.7, 43.900000000000006, 44.900000000000006], "episode_lengths": [500, 50, 78, 500, 64, 74, 36, 500, 30, 360, 32, 106, 180, 410, 94, 500, 40, 500, 62, 500, 52, 264, 32, 152, 32, 60, 500, 42, 500, 500, 500, 500, 34, 52, 500, 224, 160, 500, 500, 34, 82, 50, 52, 500, 500, 218, 500, 52, 48, 500, 500, 86, 500, 500, 500, 92, 58, 260, 500, 500, 500, 500, 48, 500, 500, 500, 138, 78, 500, 500, 44, 32, 60, 500, 500, 500, 500, 500, 32, 500, 500, 500, 130, 500, 500, 218, 44, 500, 84, 34, 500, 96, 112, 74, 82, 402, 406, 54, 62, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3929277040092933, "mean_inference_ms": 1.266540439721714, "mean_action_processing_ms": 0.14807840904864775, "mean_env_wait_ms": 0.08773410289685928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037420034408569336, "StateBufferConnector_ms": 0.0050029754638671875, "ViewRequirementAgentConnector_ms": 0.1295633316040039}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0229999999997994, "episode_len_mean": 275.34, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, 42.30000000000001, -50.00000000000044, 43.7, 42.70000000000001, 46.5, -50.00000000000044, 47.1, 14.09999999999976, 46.9, 39.50000000000002, 32.100000000000016, 9.099999999999689, 40.70000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.900000000000006, 23.699999999999896, 46.9, 34.900000000000034, 46.9, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, -50.00000000000044, 27.699999999999953, 34.10000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.90000000000001, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.300000000000004, 24.099999999999902, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 46.9, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 28.29999999999996, 45.7, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 40.500000000000014, 38.90000000000002, 42.70000000000001, 41.90000000000001, 9.8999999999997, 9.499999999999694, 44.7, 43.900000000000006, 44.900000000000006], "episode_lengths": [500, 50, 78, 500, 64, 74, 36, 500, 30, 360, 32, 106, 180, 410, 94, 500, 40, 500, 62, 500, 52, 264, 32, 152, 32, 60, 500, 42, 500, 500, 500, 500, 34, 52, 500, 224, 160, 500, 500, 34, 82, 50, 52, 500, 500, 218, 500, 52, 48, 500, 500, 86, 500, 500, 500, 92, 58, 260, 500, 500, 500, 500, 48, 500, 500, 500, 138, 78, 500, 500, 44, 32, 60, 500, 500, 500, 500, 500, 32, 500, 500, 500, 130, 500, 500, 218, 44, 500, 84, 34, 500, 96, 112, 74, 82, 402, 406, 54, 62, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3929277040092933, "mean_inference_ms": 1.266540439721714, "mean_action_processing_ms": 0.14807840904864775, "mean_env_wait_ms": 0.08773410289685928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037420034408569336, "StateBufferConnector_ms": 0.0050029754638671875, "ViewRequirementAgentConnector_ms": 0.1295633316040039}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5559.962335333072, "num_env_steps_trained_throughput_per_sec": 5559.962335333072, "timesteps_total": 564000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 2587.521, "sample_time_ms": 2345.14, "load_time_ms": 12.364, "load_throughput": 970534.885, "learn_time_ms": 219.879, "learn_throughput": 54575.582, "synch_weights_time_ms": 9.338}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 2095, "training_iteration": 47, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-16", "timestamp": 1698247696, "time_this_iter_s": 2.162287712097168, "time_total_s": 110.48068857192993, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 110.48068857192993, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 54.96666666666667, "ram_util_percent": 35.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202008e-15, "cur_lr": 0.0003, "total_loss": 5.610672378540039, "policy_loss": -0.00011114925146102906, "vf_loss": 5.610828145345052, "vf_explained_var": 7.510185241699219e-07, "kl": 0.00019795382728299654, "entropy": 0.4450718919436137, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 713.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.699000000000228, "episode_len_mean": 302.5, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 44.900000000000006, -50.00000000000044, 27.699999999999953, 34.10000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.90000000000001, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.300000000000004, 24.099999999999902, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 46.9, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 28.29999999999996, 45.7, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 40.500000000000014, 38.90000000000002, 42.70000000000001, 41.90000000000001, 9.8999999999997, 9.499999999999694, 44.7, 43.900000000000006, 44.900000000000006, -50.00000000000044, 5.299999999999635, -50.00000000000044, 33.500000000000036, 14.09999999999976, 46.3, 28.699999999999967, 43.900000000000006, -50.00000000000044, 46.099999999999994, 35.500000000000036, 46.9, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 38.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [34, 52, 500, 224, 160, 500, 500, 34, 82, 50, 52, 500, 500, 218, 500, 52, 48, 500, 500, 86, 500, 500, 500, 92, 58, 260, 500, 500, 500, 500, 48, 500, 500, 500, 138, 78, 500, 500, 44, 32, 60, 500, 500, 500, 500, 500, 32, 500, 500, 500, 130, 500, 500, 218, 44, 500, 84, 34, 500, 96, 112, 74, 82, 402, 406, 54, 62, 52, 500, 448, 500, 166, 360, 38, 214, 62, 500, 40, 146, 32, 500, 44, 500, 44, 120, 70, 500, 500, 150, 500, 500, 500, 500, 32, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39250556040278206, "mean_inference_ms": 1.2661046103905302, "mean_action_processing_ms": 0.14826737780189259, "mean_env_wait_ms": 0.08786749372733968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029456138610839844, "StateBufferConnector_ms": 0.006006717681884766, "ViewRequirementAgentConnector_ms": 0.12981796264648438}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.699000000000228, "episode_len_mean": 302.5, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 44.900000000000006, -50.00000000000044, 27.699999999999953, 34.10000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.90000000000001, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.300000000000004, 24.099999999999902, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 46.9, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 28.29999999999996, 45.7, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 40.500000000000014, 38.90000000000002, 42.70000000000001, 41.90000000000001, 9.8999999999997, 9.499999999999694, 44.7, 43.900000000000006, 44.900000000000006, -50.00000000000044, 5.299999999999635, -50.00000000000044, 33.500000000000036, 14.09999999999976, 46.3, 28.699999999999967, 43.900000000000006, -50.00000000000044, 46.099999999999994, 35.500000000000036, 46.9, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 38.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [34, 52, 500, 224, 160, 500, 500, 34, 82, 50, 52, 500, 500, 218, 500, 52, 48, 500, 500, 86, 500, 500, 500, 92, 58, 260, 500, 500, 500, 500, 48, 500, 500, 500, 138, 78, 500, 500, 44, 32, 60, 500, 500, 500, 500, 500, 32, 500, 500, 500, 130, 500, 500, 218, 44, 500, 84, 34, 500, 96, 112, 74, 82, 402, 406, 54, 62, 52, 500, 448, 500, 166, 360, 38, 214, 62, 500, 40, 146, 32, 500, 44, 500, 44, 120, 70, 500, 500, 150, 500, 500, 500, 500, 32, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39250556040278206, "mean_inference_ms": 1.2661046103905302, "mean_action_processing_ms": 0.14826737780189259, "mean_env_wait_ms": 0.08786749372733968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029456138610839844, "StateBufferConnector_ms": 0.006006717681884766, "ViewRequirementAgentConnector_ms": 0.12981796264648438}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5170.769844170038, "num_env_steps_trained_throughput_per_sec": 5170.769844170038, "timesteps_total": 576000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 2476.02, "sample_time_ms": 2208.116, "load_time_ms": 13.215, "load_throughput": 908056.196, "learn_time_ms": 244.577, "learn_throughput": 49064.369, "synch_weights_time_ms": 9.313}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2127, "training_iteration": 48, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-18", "timestamp": 1698247698, "time_this_iter_s": 2.325740098953247, "time_total_s": 112.80642867088318, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 112.80642867088318, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 53.800000000000004, "ram_util_percent": 35.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601004e-16, "cur_lr": 0.0003, "total_loss": 6.317286014556885, "policy_loss": -0.000303965217123429, "vf_loss": 6.317631530761719, "vf_explained_var": -5.205472310384114e-07, "kl": 0.00033970513188705807, "entropy": 0.41706813176472984, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 728.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7699999999998015, "episode_len_mean": 272.88, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.10000000000003, -50.00000000000044, -50.00000000000044, 28.29999999999996, 45.7, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 40.500000000000014, 38.90000000000002, 42.70000000000001, 41.90000000000001, 9.8999999999997, 9.499999999999694, 44.7, 43.900000000000006, 44.900000000000006, -50.00000000000044, 5.299999999999635, -50.00000000000044, 33.500000000000036, 14.09999999999976, 46.3, 28.699999999999967, 43.900000000000006, -50.00000000000044, 46.099999999999994, 35.500000000000036, 46.9, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 38.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 37.90000000000003, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 35.30000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.5, 38.90000000000002, 45.1, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 13.099999999999746, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.7, 47.1, 44.7, 32.100000000000016, -50.00000000000044, 36.10000000000004, 46.9, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.7, -50.00000000000044, 33.90000000000004, 45.7, -50.00000000000044], "episode_lengths": [130, 500, 500, 218, 44, 500, 84, 34, 500, 96, 112, 74, 82, 402, 406, 54, 62, 52, 500, 448, 500, 166, 360, 38, 214, 62, 500, 40, 146, 32, 500, 44, 500, 44, 120, 70, 500, 500, 150, 500, 500, 500, 500, 32, 500, 500, 500, 500, 500, 500, 500, 36, 122, 500, 70, 46, 500, 274, 500, 500, 500, 26, 148, 52, 500, 500, 500, 24, 46, 112, 50, 94, 500, 500, 88, 46, 500, 36, 500, 370, 500, 34, 500, 24, 30, 54, 180, 500, 140, 32, 500, 38, 500, 500, 70, 24, 500, 162, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39206111705627783, "mean_inference_ms": 1.2637245258135152, "mean_action_processing_ms": 0.14750241036282116, "mean_env_wait_ms": 0.08786666500219287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028003215789794922, "StateBufferConnector_ms": 0.006035804748535156, "ViewRequirementAgentConnector_ms": 0.12880349159240723}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7699999999998015, "episode_len_mean": 272.88, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.10000000000003, -50.00000000000044, -50.00000000000044, 28.29999999999996, 45.7, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 40.500000000000014, 38.90000000000002, 42.70000000000001, 41.90000000000001, 9.8999999999997, 9.499999999999694, 44.7, 43.900000000000006, 44.900000000000006, -50.00000000000044, 5.299999999999635, -50.00000000000044, 33.500000000000036, 14.09999999999976, 46.3, 28.699999999999967, 43.900000000000006, -50.00000000000044, 46.099999999999994, 35.500000000000036, 46.9, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 38.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 37.90000000000003, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 35.30000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.5, 38.90000000000002, 45.1, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 13.099999999999746, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.7, 47.1, 44.7, 32.100000000000016, -50.00000000000044, 36.10000000000004, 46.9, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.7, -50.00000000000044, 33.90000000000004, 45.7, -50.00000000000044], "episode_lengths": [130, 500, 500, 218, 44, 500, 84, 34, 500, 96, 112, 74, 82, 402, 406, 54, 62, 52, 500, 448, 500, 166, 360, 38, 214, 62, 500, 40, 146, 32, 500, 44, 500, 44, 120, 70, 500, 500, 150, 500, 500, 500, 500, 32, 500, 500, 500, 500, 500, 500, 500, 36, 122, 500, 70, 46, 500, 274, 500, 500, 500, 26, 148, 52, 500, 500, 500, 24, 46, 112, 50, 94, 500, 500, 88, 46, 500, 36, 500, 370, 500, 34, 500, 24, 30, 54, 180, 500, 140, 32, 500, 38, 500, 500, 70, 24, 500, 162, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39206111705627783, "mean_inference_ms": 1.2637245258135152, "mean_action_processing_ms": 0.14750241036282116, "mean_env_wait_ms": 0.08786666500219287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028003215789794922, "StateBufferConnector_ms": 0.006035804748535156, "ViewRequirementAgentConnector_ms": 0.12880349159240723}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5736.724101556182, "num_env_steps_trained_throughput_per_sec": 5736.724101556182, "timesteps_total": 588000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 2465.106, "sample_time_ms": 2193.369, "load_time_ms": 13.317, "load_throughput": 901112.667, "learn_time_ms": 248.436, "learn_throughput": 48302.081, "synch_weights_time_ms": 9.385}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 2177, "training_iteration": 49, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-20", "timestamp": 1698247700, "time_this_iter_s": 2.096785306930542, "time_total_s": 114.90321397781372, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 114.90321397781372, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 61.400000000000006, "ram_util_percent": 35.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.552713678800502e-16, "cur_lr": 0.0003, "total_loss": 6.881761105855306, "policy_loss": -7.857879002888998e-07, "vf_loss": 6.881805165608724, "vf_explained_var": -1.2954076131184896e-06, "kl": 0.0001232019440900937, "entropy": 0.4332079490025838, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.230999999999817, "episode_len_mean": 253.3, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 37.90000000000003, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 35.30000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.5, 38.90000000000002, 45.1, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 13.099999999999746, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.7, 47.1, 44.7, 32.100000000000016, -50.00000000000044, 36.10000000000004, 46.9, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.7, -50.00000000000044, 33.90000000000004, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.10000000000001, 42.70000000000001, 37.10000000000003, 44.10000000000001, 4.099999999999618, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.900000000000006, 25.899999999999928, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 47.5, 45.1, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 47.7, 36.10000000000004, 29.099999999999973, 47.3, -50.00000000000044, 45.5, 23.499999999999893, 18.899999999999828, 12.69999999999974, -50.00000000000044, -50.00000000000044, 42.900000000000006, 38.10000000000002, -50.00000000000044, 47.5, -50.00000000000044, 47.3, 47.1, -50.00000000000044, 44.300000000000004, 39.300000000000026, -50.00000000000044], "episode_lengths": [36, 122, 500, 70, 46, 500, 274, 500, 500, 500, 26, 148, 52, 500, 500, 500, 24, 46, 112, 50, 94, 500, 500, 88, 46, 500, 36, 500, 370, 500, 34, 500, 24, 30, 54, 180, 500, 140, 32, 500, 38, 500, 500, 70, 24, 500, 162, 44, 500, 500, 500, 56, 60, 74, 130, 60, 460, 500, 500, 68, 62, 242, 52, 500, 500, 28, 500, 500, 38, 500, 26, 50, 32, 52, 500, 500, 26, 500, 24, 140, 210, 28, 500, 46, 266, 312, 374, 500, 500, 72, 120, 500, 26, 500, 28, 30, 500, 58, 108, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39225485371554236, "mean_inference_ms": 1.2630464693007977, "mean_action_processing_ms": 0.14783570312171554, "mean_env_wait_ms": 0.08783241272168488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400803565979004, "StateBufferConnector_ms": 0.009035348892211914, "ViewRequirementAgentConnector_ms": 0.12513971328735352}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.230999999999817, "episode_len_mean": 253.3, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 37.90000000000003, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 35.30000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.5, 38.90000000000002, 45.1, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 13.099999999999746, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.7, 47.1, 44.7, 32.100000000000016, -50.00000000000044, 36.10000000000004, 46.9, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.7, -50.00000000000044, 33.90000000000004, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.10000000000001, 42.70000000000001, 37.10000000000003, 44.10000000000001, 4.099999999999618, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.900000000000006, 25.899999999999928, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 47.5, 45.1, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 47.7, 36.10000000000004, 29.099999999999973, 47.3, -50.00000000000044, 45.5, 23.499999999999893, 18.899999999999828, 12.69999999999974, -50.00000000000044, -50.00000000000044, 42.900000000000006, 38.10000000000002, -50.00000000000044, 47.5, -50.00000000000044, 47.3, 47.1, -50.00000000000044, 44.300000000000004, 39.300000000000026, -50.00000000000044], "episode_lengths": [36, 122, 500, 70, 46, 500, 274, 500, 500, 500, 26, 148, 52, 500, 500, 500, 24, 46, 112, 50, 94, 500, 500, 88, 46, 500, 36, 500, 370, 500, 34, 500, 24, 30, 54, 180, 500, 140, 32, 500, 38, 500, 500, 70, 24, 500, 162, 44, 500, 500, 500, 56, 60, 74, 130, 60, 460, 500, 500, 68, 62, 242, 52, 500, 500, 28, 500, 500, 38, 500, 26, 50, 32, 52, 500, 500, 26, 500, 24, 140, 210, 28, 500, 46, 266, 312, 374, 500, 500, 72, 120, 500, 26, 500, 28, 30, 500, 58, 108, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39225485371554236, "mean_inference_ms": 1.2630464693007977, "mean_action_processing_ms": 0.14783570312171554, "mean_env_wait_ms": 0.08783241272168488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400803565979004, "StateBufferConnector_ms": 0.009035348892211914, "ViewRequirementAgentConnector_ms": 0.12513971328735352}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5360.164874252711, "num_env_steps_trained_throughput_per_sec": 5360.164874252711, "timesteps_total": 600000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 2465.27, "sample_time_ms": 2195.39, "load_time_ms": 12.738, "load_throughput": 942026.873, "learn_time_ms": 247.08, "learn_throughput": 48567.337, "synch_weights_time_ms": 9.363}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 2228, "training_iteration": 50, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-23", "timestamp": 1698247703, "time_this_iter_s": 2.24426531791687, "time_total_s": 117.14747929573059, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 117.14747929573059, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 61.93333333333333, "ram_util_percent": 35.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.776356839400251e-16, "cur_lr": 0.0003, "total_loss": 6.344143231709798, "policy_loss": -0.0005835774044195811, "vf_loss": 6.344767125447591, "vf_explained_var": -4.887580871582031e-07, "kl": 0.0005705642532992291, "entropy": 0.40350157419840493, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 758.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7219999999997964, "episode_len_mean": 273.36, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.7, -50.00000000000044, 33.90000000000004, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.10000000000001, 42.70000000000001, 37.10000000000003, 44.10000000000001, 4.099999999999618, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.900000000000006, 25.899999999999928, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 47.5, 45.1, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 47.7, 36.10000000000004, 29.099999999999973, 47.3, -50.00000000000044, 45.5, 23.499999999999893, 18.899999999999828, 12.69999999999974, -50.00000000000044, -50.00000000000044, 42.900000000000006, 38.10000000000002, -50.00000000000044, 47.5, -50.00000000000044, 47.3, 47.1, -50.00000000000044, 44.300000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, 12.299999999999734, 46.5, 46.699999999999996, 25.099999999999916, -50.00000000000044, 28.499999999999964, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 47.1, -50.00000000000044, 47.9, 44.10000000000001, 46.5, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 27.299999999999947, 42.30000000000001, -50.00000000000044, 46.3, 31.500000000000007], "episode_lengths": [32, 500, 38, 500, 500, 70, 24, 500, 162, 44, 500, 500, 500, 56, 60, 74, 130, 60, 460, 500, 500, 68, 62, 242, 52, 500, 500, 28, 500, 500, 38, 500, 26, 50, 32, 52, 500, 500, 26, 500, 24, 140, 210, 28, 500, 46, 266, 312, 374, 500, 500, 72, 120, 500, 26, 500, 28, 30, 500, 58, 108, 500, 500, 500, 200, 378, 36, 34, 250, 500, 216, 500, 64, 500, 500, 500, 500, 94, 500, 30, 500, 22, 60, 36, 500, 500, 32, 40, 500, 500, 472, 500, 114, 500, 500, 228, 78, 500, 38, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39266974075212546, "mean_inference_ms": 1.2626024761686656, "mean_action_processing_ms": 0.14802099508745215, "mean_env_wait_ms": 0.08759677229941967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022991180419921875, "StateBufferConnector_ms": 0.009027481079101562, "ViewRequirementAgentConnector_ms": 0.11542797088623047}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7219999999997964, "episode_len_mean": 273.36, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.7, -50.00000000000044, 33.90000000000004, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.10000000000001, 42.70000000000001, 37.10000000000003, 44.10000000000001, 4.099999999999618, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.900000000000006, 25.899999999999928, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 47.5, 45.1, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 47.7, 36.10000000000004, 29.099999999999973, 47.3, -50.00000000000044, 45.5, 23.499999999999893, 18.899999999999828, 12.69999999999974, -50.00000000000044, -50.00000000000044, 42.900000000000006, 38.10000000000002, -50.00000000000044, 47.5, -50.00000000000044, 47.3, 47.1, -50.00000000000044, 44.300000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, 12.299999999999734, 46.5, 46.699999999999996, 25.099999999999916, -50.00000000000044, 28.499999999999964, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 47.1, -50.00000000000044, 47.9, 44.10000000000001, 46.5, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 27.299999999999947, 42.30000000000001, -50.00000000000044, 46.3, 31.500000000000007], "episode_lengths": [32, 500, 38, 500, 500, 70, 24, 500, 162, 44, 500, 500, 500, 56, 60, 74, 130, 60, 460, 500, 500, 68, 62, 242, 52, 500, 500, 28, 500, 500, 38, 500, 26, 50, 32, 52, 500, 500, 26, 500, 24, 140, 210, 28, 500, 46, 266, 312, 374, 500, 500, 72, 120, 500, 26, 500, 28, 30, 500, 58, 108, 500, 500, 500, 200, 378, 36, 34, 250, 500, 216, 500, 64, 500, 500, 500, 500, 94, 500, 30, 500, 22, 60, 36, 500, 500, 32, 40, 500, 500, 472, 500, 114, 500, 500, 228, 78, 500, 38, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39266974075212546, "mean_inference_ms": 1.2626024761686656, "mean_action_processing_ms": 0.14802099508745215, "mean_env_wait_ms": 0.08759677229941967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022991180419921875, "StateBufferConnector_ms": 0.009027481079101562, "ViewRequirementAgentConnector_ms": 0.11542797088623047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5589.739648603133, "num_env_steps_trained_throughput_per_sec": 5589.739648603133, "timesteps_total": 612000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 2459.21, "sample_time_ms": 2189.801, "load_time_ms": 12.479, "load_throughput": 961582.806, "learn_time_ms": 246.955, "learn_throughput": 48591.855, "synch_weights_time_ms": 9.176}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2266, "training_iteration": 51, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-25", "timestamp": 1698247705, "time_this_iter_s": 2.150787353515625, "time_total_s": 119.29826664924622, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 119.29826664924622, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 60.36666666666667, "ram_util_percent": 35.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001255e-17, "cur_lr": 0.0003, "total_loss": 6.171088536580403, "policy_loss": 9.842713673909505e-05, "vf_loss": 6.17103157043457, "vf_explained_var": -1.1046727498372397e-06, "kl": 0.0001381215812367979, "entropy": 0.4154653251171112, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 773.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9949999999998005, "episode_len_mean": 275.64, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 23.499999999999893, 18.899999999999828, 12.69999999999974, -50.00000000000044, -50.00000000000044, 42.900000000000006, 38.10000000000002, -50.00000000000044, 47.5, -50.00000000000044, 47.3, 47.1, -50.00000000000044, 44.300000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, 12.299999999999734, 46.5, 46.699999999999996, 25.099999999999916, -50.00000000000044, 28.499999999999964, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 47.1, -50.00000000000044, 47.9, 44.10000000000001, 46.5, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 27.299999999999947, 42.30000000000001, -50.00000000000044, 46.3, 31.500000000000007, 29.899999999999984, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.3, -50.00000000000044, 45.9, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 32.50000000000002, 4.699999999999626, 45.3, -50.00000000000044, 44.300000000000004, 42.500000000000014, -50.00000000000044, 28.09999999999996, 42.10000000000001, -50.00000000000044, 47.3, 18.499999999999822, 29.899999999999984, 44.900000000000006, 37.50000000000003, 25.699999999999925, -50.00000000000044, 45.1, 47.3, 44.5, 45.7], "episode_lengths": [46, 266, 312, 374, 500, 500, 72, 120, 500, 26, 500, 28, 30, 500, 58, 108, 500, 500, 500, 200, 378, 36, 34, 250, 500, 216, 500, 64, 500, 500, 500, 500, 94, 500, 30, 500, 22, 60, 36, 500, 500, 32, 40, 500, 500, 472, 500, 114, 500, 500, 228, 78, 500, 38, 186, 202, 90, 500, 500, 500, 500, 40, 48, 500, 42, 500, 54, 500, 500, 108, 500, 50, 500, 500, 44, 500, 500, 40, 40, 176, 454, 48, 500, 58, 76, 500, 220, 80, 500, 28, 316, 202, 52, 126, 244, 500, 50, 28, 56, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3923731123752572, "mean_inference_ms": 1.2617225096918565, "mean_action_processing_ms": 0.14769299219418733, "mean_env_wait_ms": 0.08744941702973975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030988693237304688, "StateBufferConnector_ms": 0.007021665573120117, "ViewRequirementAgentConnector_ms": 0.1295490264892578}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9949999999998005, "episode_len_mean": 275.64, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 23.499999999999893, 18.899999999999828, 12.69999999999974, -50.00000000000044, -50.00000000000044, 42.900000000000006, 38.10000000000002, -50.00000000000044, 47.5, -50.00000000000044, 47.3, 47.1, -50.00000000000044, 44.300000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, 12.299999999999734, 46.5, 46.699999999999996, 25.099999999999916, -50.00000000000044, 28.499999999999964, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 47.1, -50.00000000000044, 47.9, 44.10000000000001, 46.5, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 27.299999999999947, 42.30000000000001, -50.00000000000044, 46.3, 31.500000000000007, 29.899999999999984, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.3, -50.00000000000044, 45.9, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 32.50000000000002, 4.699999999999626, 45.3, -50.00000000000044, 44.300000000000004, 42.500000000000014, -50.00000000000044, 28.09999999999996, 42.10000000000001, -50.00000000000044, 47.3, 18.499999999999822, 29.899999999999984, 44.900000000000006, 37.50000000000003, 25.699999999999925, -50.00000000000044, 45.1, 47.3, 44.5, 45.7], "episode_lengths": [46, 266, 312, 374, 500, 500, 72, 120, 500, 26, 500, 28, 30, 500, 58, 108, 500, 500, 500, 200, 378, 36, 34, 250, 500, 216, 500, 64, 500, 500, 500, 500, 94, 500, 30, 500, 22, 60, 36, 500, 500, 32, 40, 500, 500, 472, 500, 114, 500, 500, 228, 78, 500, 38, 186, 202, 90, 500, 500, 500, 500, 40, 48, 500, 42, 500, 54, 500, 500, 108, 500, 50, 500, 500, 44, 500, 500, 40, 40, 176, 454, 48, 500, 58, 76, 500, 220, 80, 500, 28, 316, 202, 52, 126, 244, 500, 50, 28, 56, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3923731123752572, "mean_inference_ms": 1.2617225096918565, "mean_action_processing_ms": 0.14769299219418733, "mean_env_wait_ms": 0.08744941702973975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030988693237304688, "StateBufferConnector_ms": 0.007021665573120117, "ViewRequirementAgentConnector_ms": 0.1295490264892578}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5350.687433982354, "num_env_steps_trained_throughput_per_sec": 5350.687433982354, "timesteps_total": 624000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 2325.853, "sample_time_ms": 2058.065, "load_time_ms": 11.821, "load_throughput": 1015174.639, "learn_time_ms": 245.863, "learn_throughput": 48807.739, "synch_weights_time_ms": 9.207}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 2311, "training_iteration": 52, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-28", "timestamp": 1698247708, "time_this_iter_s": 2.247521162033081, "time_total_s": 121.5457878112793, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 121.5457878112793, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 36.44, "ram_util_percent": 35.279999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.4408920985006276e-17, "cur_lr": 0.0003, "total_loss": 6.1522928237915036, "policy_loss": -5.185529589653015e-05, "vf_loss": 6.152385520935058, "vf_explained_var": -1.136461893717448e-06, "kl": 4.239102584193688e-05, "entropy": 0.4096764862537384, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 788.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.05899999999981, "episode_len_mean": 265.02, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 2.8999999999996007, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 27.299999999999947, 42.30000000000001, -50.00000000000044, 46.3, 31.500000000000007, 29.899999999999984, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.3, -50.00000000000044, 45.9, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 32.50000000000002, 4.699999999999626, 45.3, -50.00000000000044, 44.300000000000004, 42.500000000000014, -50.00000000000044, 28.09999999999996, 42.10000000000001, -50.00000000000044, 47.3, 18.499999999999822, 29.899999999999984, 44.900000000000006, 37.50000000000003, 25.699999999999925, -50.00000000000044, 45.1, 47.3, 44.5, 45.7, -50.00000000000044, 42.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 45.1, 45.9, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.50000000000003, -50.00000000000044, 44.7, 8.299999999999677, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 6.099999999999646, 44.900000000000006, -50.00000000000044, 47.3, 44.300000000000004, -50.00000000000044, 38.90000000000002, 45.3, -50.00000000000044, 47.7, 46.3, 46.3, 45.9, 32.700000000000024, -50.00000000000044, 46.5], "episode_lengths": [500, 472, 500, 114, 500, 500, 228, 78, 500, 38, 186, 202, 90, 500, 500, 500, 500, 40, 48, 500, 42, 500, 54, 500, 500, 108, 500, 50, 500, 500, 44, 500, 500, 40, 40, 176, 454, 48, 500, 58, 76, 500, 220, 80, 500, 28, 316, 202, 52, 126, 244, 500, 50, 28, 56, 44, 500, 76, 38, 500, 500, 56, 62, 50, 42, 500, 82, 500, 68, 46, 500, 500, 336, 500, 500, 66, 126, 500, 54, 418, 500, 500, 500, 260, 440, 52, 500, 28, 58, 500, 112, 48, 500, 24, 38, 38, 42, 174, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924107056421207, "mean_inference_ms": 1.2612874487231338, "mean_action_processing_ms": 0.14751784225952377, "mean_env_wait_ms": 0.08729430518246659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699040412902832, "StateBufferConnector_ms": 0.009001016616821289, "ViewRequirementAgentConnector_ms": 0.12999773025512695}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.05899999999981, "episode_len_mean": 265.02, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 2.8999999999996007, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 27.299999999999947, 42.30000000000001, -50.00000000000044, 46.3, 31.500000000000007, 29.899999999999984, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.3, -50.00000000000044, 45.9, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 32.50000000000002, 4.699999999999626, 45.3, -50.00000000000044, 44.300000000000004, 42.500000000000014, -50.00000000000044, 28.09999999999996, 42.10000000000001, -50.00000000000044, 47.3, 18.499999999999822, 29.899999999999984, 44.900000000000006, 37.50000000000003, 25.699999999999925, -50.00000000000044, 45.1, 47.3, 44.5, 45.7, -50.00000000000044, 42.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 45.1, 45.9, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.50000000000003, -50.00000000000044, 44.7, 8.299999999999677, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 6.099999999999646, 44.900000000000006, -50.00000000000044, 47.3, 44.300000000000004, -50.00000000000044, 38.90000000000002, 45.3, -50.00000000000044, 47.7, 46.3, 46.3, 45.9, 32.700000000000024, -50.00000000000044, 46.5], "episode_lengths": [500, 472, 500, 114, 500, 500, 228, 78, 500, 38, 186, 202, 90, 500, 500, 500, 500, 40, 48, 500, 42, 500, 54, 500, 500, 108, 500, 50, 500, 500, 44, 500, 500, 40, 40, 176, 454, 48, 500, 58, 76, 500, 220, 80, 500, 28, 316, 202, 52, 126, 244, 500, 50, 28, 56, 44, 500, 76, 38, 500, 500, 56, 62, 50, 42, 500, 82, 500, 68, 46, 500, 500, 336, 500, 500, 66, 126, 500, 54, 418, 500, 500, 500, 260, 440, 52, 500, 28, 58, 500, 112, 48, 500, 24, 38, 38, 42, 174, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924107056421207, "mean_inference_ms": 1.2612874487231338, "mean_action_processing_ms": 0.14751784225952377, "mean_env_wait_ms": 0.08729430518246659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699040412902832, "StateBufferConnector_ms": 0.009001016616821289, "ViewRequirementAgentConnector_ms": 0.12999773025512695}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5525.653596009012, "num_env_steps_trained_throughput_per_sec": 5525.653596009012, "timesteps_total": 636000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 2331.142, "sample_time_ms": 2073.775, "load_time_ms": 11.72, "load_throughput": 1023847.939, "learn_time_ms": 235.737, "learn_throughput": 50904.1, "synch_weights_time_ms": 9.011}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 2355, "training_iteration": 53, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-31", "timestamp": 1698247711, "time_this_iter_s": 2.8072268962860107, "time_total_s": 124.35301470756531, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 124.35301470756531, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 55.15, "ram_util_percent": 35.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503138e-17, "cur_lr": 0.0003, "total_loss": 5.965649636586507, "policy_loss": -9.600768486658731e-05, "vf_loss": 5.965788873036702, "vf_explained_var": -1.3907750447591145e-06, "kl": 0.00012770329962563665, "entropy": 0.43501259485880533, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 803.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.137999999999812, "episode_len_mean": 259.22, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.09999999999996, 42.10000000000001, -50.00000000000044, 47.3, 18.499999999999822, 29.899999999999984, 44.900000000000006, 37.50000000000003, 25.699999999999925, -50.00000000000044, 45.1, 47.3, 44.5, 45.7, -50.00000000000044, 42.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 45.1, 45.9, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.50000000000003, -50.00000000000044, 44.7, 8.299999999999677, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 6.099999999999646, 44.900000000000006, -50.00000000000044, 47.3, 44.300000000000004, -50.00000000000044, 38.90000000000002, 45.3, -50.00000000000044, 47.7, 46.3, 46.3, 45.9, 32.700000000000024, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.10000000000001, 46.5, 46.099999999999994, -50.00000000000044, 46.9, 45.1, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, -50.00000000000044, 16.09999999999979, 32.30000000000002, 44.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.699999999999996, 45.3, -50.00000000000044, 39.10000000000002, -50.00000000000044, 37.90000000000003, 45.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [220, 80, 500, 28, 316, 202, 52, 126, 244, 500, 50, 28, 56, 44, 500, 76, 38, 500, 500, 56, 62, 50, 42, 500, 82, 500, 68, 46, 500, 500, 336, 500, 500, 66, 126, 500, 54, 418, 500, 500, 500, 260, 440, 52, 500, 28, 58, 500, 112, 48, 500, 24, 38, 38, 42, 174, 500, 36, 500, 500, 500, 500, 44, 60, 36, 40, 500, 32, 50, 500, 56, 500, 500, 140, 54, 500, 500, 40, 32, 500, 500, 340, 178, 56, 68, 500, 500, 500, 500, 500, 22, 34, 48, 500, 110, 500, 122, 44, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39223088674937584, "mean_inference_ms": 1.2609000632314238, "mean_action_processing_ms": 0.14756862415940777, "mean_env_wait_ms": 0.08716675800194579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038987159729003906, "StateBufferConnector_ms": 0.011003971099853516, "ViewRequirementAgentConnector_ms": 0.13901090621948242}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.137999999999812, "episode_len_mean": 259.22, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.09999999999996, 42.10000000000001, -50.00000000000044, 47.3, 18.499999999999822, 29.899999999999984, 44.900000000000006, 37.50000000000003, 25.699999999999925, -50.00000000000044, 45.1, 47.3, 44.5, 45.7, -50.00000000000044, 42.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 45.1, 45.9, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.50000000000003, -50.00000000000044, 44.7, 8.299999999999677, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 6.099999999999646, 44.900000000000006, -50.00000000000044, 47.3, 44.300000000000004, -50.00000000000044, 38.90000000000002, 45.3, -50.00000000000044, 47.7, 46.3, 46.3, 45.9, 32.700000000000024, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.10000000000001, 46.5, 46.099999999999994, -50.00000000000044, 46.9, 45.1, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, -50.00000000000044, 16.09999999999979, 32.30000000000002, 44.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.699999999999996, 45.3, -50.00000000000044, 39.10000000000002, -50.00000000000044, 37.90000000000003, 45.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [220, 80, 500, 28, 316, 202, 52, 126, 244, 500, 50, 28, 56, 44, 500, 76, 38, 500, 500, 56, 62, 50, 42, 500, 82, 500, 68, 46, 500, 500, 336, 500, 500, 66, 126, 500, 54, 418, 500, 500, 500, 260, 440, 52, 500, 28, 58, 500, 112, 48, 500, 24, 38, 38, 42, 174, 500, 36, 500, 500, 500, 500, 44, 60, 36, 40, 500, 32, 50, 500, 56, 500, 500, 140, 54, 500, 500, 40, 32, 500, 500, 340, 178, 56, 68, 500, 500, 500, 500, 500, 22, 34, 48, 500, 110, 500, 122, 44, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39223088674937584, "mean_inference_ms": 1.2609000632314238, "mean_action_processing_ms": 0.14756862415940777, "mean_env_wait_ms": 0.08716675800194579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038987159729003906, "StateBufferConnector_ms": 0.011003971099853516, "ViewRequirementAgentConnector_ms": 0.13901090621948242}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5637.538211468078, "num_env_steps_trained_throughput_per_sec": 5637.538211468078, "timesteps_total": 648000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 2200.495, "sample_time_ms": 1959.371, "load_time_ms": 10.723, "load_throughput": 1119100.302, "learn_time_ms": 220.519, "learn_throughput": 54417.087, "synch_weights_time_ms": 8.984}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2397, "training_iteration": 54, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-33", "timestamp": 1698247713, "time_this_iter_s": 2.133587121963501, "time_total_s": 126.48660182952881, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 126.48660182952881, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 63.29999999999999, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251569e-17, "cur_lr": 0.0003, "total_loss": 6.659001318613688, "policy_loss": -9.930556019147238e-05, "vf_loss": 6.659143193562826, "vf_explained_var": -2.0424524943033854e-06, "kl": 0.00020711262385522862, "entropy": 0.4255411624908447, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 818.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.19200000000020873, "episode_len_mean": 272.46, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.90000000000002, 45.3, -50.00000000000044, 47.7, 46.3, 46.3, 45.9, 32.700000000000024, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.10000000000001, 46.5, 46.099999999999994, -50.00000000000044, 46.9, 45.1, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, -50.00000000000044, 16.09999999999979, 32.30000000000002, 44.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.699999999999996, 45.3, -50.00000000000044, 39.10000000000002, -50.00000000000044, 37.90000000000003, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.5, 45.7, -50.00000000000044, 44.10000000000001, 45.9, 46.5, 46.099999999999994, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 47.1, -50.00000000000044, 35.500000000000036, 46.5, -50.00000000000044, 47.1, 37.10000000000003, 46.699999999999996, -50.00000000000044, 45.3, 46.5, 11.099999999999717, -50.00000000000044, -50.00000000000044, 35.70000000000003, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 18.699999999999825, -50.00000000000044], "episode_lengths": [500, 112, 48, 500, 24, 38, 38, 42, 174, 500, 36, 500, 500, 500, 500, 44, 60, 36, 40, 500, 32, 50, 500, 56, 500, 500, 140, 54, 500, 500, 40, 32, 500, 500, 340, 178, 56, 68, 500, 500, 500, 500, 500, 22, 34, 48, 500, 110, 500, 122, 44, 500, 500, 500, 64, 500, 500, 26, 44, 500, 60, 42, 36, 40, 34, 500, 500, 500, 46, 30, 500, 146, 36, 500, 30, 130, 34, 500, 48, 36, 390, 500, 500, 144, 232, 500, 500, 500, 500, 54, 500, 44, 28, 500, 500, 500, 500, 40, 314, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39148368985039966, "mean_inference_ms": 1.2601957222121611, "mean_action_processing_ms": 0.14747478742099626, "mean_env_wait_ms": 0.08720522042528658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299403190612793, "StateBufferConnector_ms": 0.006005287170410156, "ViewRequirementAgentConnector_ms": 0.13001179695129395}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.19200000000020873, "episode_len_mean": 272.46, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.90000000000002, 45.3, -50.00000000000044, 47.7, 46.3, 46.3, 45.9, 32.700000000000024, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.10000000000001, 46.5, 46.099999999999994, -50.00000000000044, 46.9, 45.1, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, -50.00000000000044, 16.09999999999979, 32.30000000000002, 44.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.699999999999996, 45.3, -50.00000000000044, 39.10000000000002, -50.00000000000044, 37.90000000000003, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.5, 45.7, -50.00000000000044, 44.10000000000001, 45.9, 46.5, 46.099999999999994, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 47.1, -50.00000000000044, 35.500000000000036, 46.5, -50.00000000000044, 47.1, 37.10000000000003, 46.699999999999996, -50.00000000000044, 45.3, 46.5, 11.099999999999717, -50.00000000000044, -50.00000000000044, 35.70000000000003, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 18.699999999999825, -50.00000000000044], "episode_lengths": [500, 112, 48, 500, 24, 38, 38, 42, 174, 500, 36, 500, 500, 500, 500, 44, 60, 36, 40, 500, 32, 50, 500, 56, 500, 500, 140, 54, 500, 500, 40, 32, 500, 500, 340, 178, 56, 68, 500, 500, 500, 500, 500, 22, 34, 48, 500, 110, 500, 122, 44, 500, 500, 500, 64, 500, 500, 26, 44, 500, 60, 42, 36, 40, 34, 500, 500, 500, 46, 30, 500, 146, 36, 500, 30, 130, 34, 500, 48, 36, 390, 500, 500, 144, 232, 500, 500, 500, 500, 54, 500, 44, 28, 500, 500, 500, 500, 40, 314, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39148368985039966, "mean_inference_ms": 1.2601957222121611, "mean_action_processing_ms": 0.14747478742099626, "mean_env_wait_ms": 0.08720522042528658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299403190612793, "StateBufferConnector_ms": 0.006005287170410156, "ViewRequirementAgentConnector_ms": 0.13001179695129395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5563.742170060332, "num_env_steps_trained_throughput_per_sec": 5563.742170060332, "timesteps_total": 660000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 2197.6, "sample_time_ms": 1958.672, "load_time_ms": 10.523, "load_throughput": 1140363.373, "learn_time_ms": 218.523, "learn_throughput": 54914.17, "synch_weights_time_ms": 8.984}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 2444, "training_iteration": 55, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-36", "timestamp": 1698247716, "time_this_iter_s": 2.161821126937866, "time_total_s": 128.64842295646667, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 128.64842295646667, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 61.5, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.5511151231257846e-18, "cur_lr": 0.0003, "total_loss": 6.102300802866618, "policy_loss": -0.0002651174863179525, "vf_loss": 6.102613957722982, "vf_explained_var": -4.3312708536783854e-07, "kl": 0.00043551233880710546, "entropy": 0.4799253781636556, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.9290000000002138, "episode_len_mean": 274.82, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 39.10000000000002, -50.00000000000044, 37.90000000000003, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.5, 45.7, -50.00000000000044, 44.10000000000001, 45.9, 46.5, 46.099999999999994, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 47.1, -50.00000000000044, 35.500000000000036, 46.5, -50.00000000000044, 47.1, 37.10000000000003, 46.699999999999996, -50.00000000000044, 45.3, 46.5, 11.099999999999717, -50.00000000000044, -50.00000000000044, 35.70000000000003, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 18.699999999999825, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 45.3, 41.70000000000002, 47.3, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.7, 47.7, 39.70000000000002, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 47.3, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.699999999999996, 6.499999999999652, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 47.1, -50.00000000000044, 45.9], "episode_lengths": [48, 500, 110, 500, 122, 44, 500, 500, 500, 64, 500, 500, 26, 44, 500, 60, 42, 36, 40, 34, 500, 500, 500, 46, 30, 500, 146, 36, 500, 30, 130, 34, 500, 48, 36, 390, 500, 500, 144, 232, 500, 500, 500, 500, 54, 500, 44, 28, 500, 500, 500, 500, 40, 314, 500, 500, 62, 500, 28, 500, 48, 84, 28, 500, 44, 500, 500, 500, 64, 500, 500, 24, 24, 104, 30, 500, 500, 500, 500, 38, 28, 44, 44, 500, 500, 74, 500, 34, 436, 500, 58, 500, 64, 500, 40, 58, 500, 30, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3916311977296805, "mean_inference_ms": 1.2605899584296536, "mean_action_processing_ms": 0.1478802876872167, "mean_env_wait_ms": 0.08723960936039665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021993398666381836, "StateBufferConnector_ms": 0.006001949310302734, "ViewRequirementAgentConnector_ms": 0.12456393241882324}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.9290000000002138, "episode_len_mean": 274.82, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 39.10000000000002, -50.00000000000044, 37.90000000000003, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.5, 45.7, -50.00000000000044, 44.10000000000001, 45.9, 46.5, 46.099999999999994, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 47.1, -50.00000000000044, 35.500000000000036, 46.5, -50.00000000000044, 47.1, 37.10000000000003, 46.699999999999996, -50.00000000000044, 45.3, 46.5, 11.099999999999717, -50.00000000000044, -50.00000000000044, 35.70000000000003, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 18.699999999999825, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 45.3, 41.70000000000002, 47.3, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.7, 47.7, 39.70000000000002, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 47.3, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.699999999999996, 6.499999999999652, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 47.1, -50.00000000000044, 45.9], "episode_lengths": [48, 500, 110, 500, 122, 44, 500, 500, 500, 64, 500, 500, 26, 44, 500, 60, 42, 36, 40, 34, 500, 500, 500, 46, 30, 500, 146, 36, 500, 30, 130, 34, 500, 48, 36, 390, 500, 500, 144, 232, 500, 500, 500, 500, 54, 500, 44, 28, 500, 500, 500, 500, 40, 314, 500, 500, 62, 500, 28, 500, 48, 84, 28, 500, 44, 500, 500, 500, 64, 500, 500, 24, 24, 104, 30, 500, 500, 500, 500, 38, 28, 44, 44, 500, 500, 74, 500, 34, 436, 500, 58, 500, 64, 500, 40, 58, 500, 30, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3916311977296805, "mean_inference_ms": 1.2605899584296536, "mean_action_processing_ms": 0.1478802876872167, "mean_env_wait_ms": 0.08723960936039665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021993398666381836, "StateBufferConnector_ms": 0.006001949310302734, "ViewRequirementAgentConnector_ms": 0.12456393241882324}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5183.015629580879, "num_env_steps_trained_throughput_per_sec": 5183.015629580879, "timesteps_total": 672000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 2196.94, "sample_time_ms": 1957.639, "load_time_ms": 10.835, "load_throughput": 1107480.098, "learn_time_ms": 218.58, "learn_throughput": 54899.686, "synch_weights_time_ms": 9.087}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 2489, "training_iteration": 56, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-39", "timestamp": 1698247719, "time_this_iter_s": 2.320251703262329, "time_total_s": 130.968674659729, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 130.968674659729, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 41.9, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7755575615628923e-18, "cur_lr": 0.0003, "total_loss": 6.374168618520101, "policy_loss": -0.00010750989119211833, "vf_loss": 6.374321206410726, "vf_explained_var": -1.4861424763997396e-06, "kl": 0.00038364020317089854, "entropy": 0.45003772576649986, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 848.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.896000000000231, "episode_len_mean": 289.46, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 18.699999999999825, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 45.3, 41.70000000000002, 47.3, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.7, 47.7, 39.70000000000002, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 47.3, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.699999999999996, 6.499999999999652, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 47.1, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.7, 44.900000000000006, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.099999999999994, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.5, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 46.3, 11.29999999999972, -50.00000000000044, 10.099999999999703, 44.900000000000006], "episode_lengths": [500, 500, 54, 500, 44, 28, 500, 500, 500, 500, 40, 314, 500, 500, 62, 500, 28, 500, 48, 84, 28, 500, 44, 500, 500, 500, 64, 500, 500, 24, 24, 104, 30, 500, 500, 500, 500, 38, 28, 44, 44, 500, 500, 74, 500, 34, 436, 500, 58, 500, 64, 500, 40, 58, 500, 30, 500, 42, 500, 500, 500, 32, 34, 500, 500, 114, 54, 52, 500, 92, 500, 500, 500, 500, 48, 32, 34, 500, 500, 500, 500, 58, 40, 70, 500, 500, 32, 36, 206, 500, 500, 500, 40, 500, 84, 38, 388, 500, 400, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39180886207890786, "mean_inference_ms": 1.261310930059502, "mean_action_processing_ms": 0.14753709984074828, "mean_env_wait_ms": 0.08721662474328441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019375324249267578, "StateBufferConnector_ms": 0.009018898010253906, "ViewRequirementAgentConnector_ms": 0.13673639297485352}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.896000000000231, "episode_len_mean": 289.46, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 18.699999999999825, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 45.3, 41.70000000000002, 47.3, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.7, 47.7, 39.70000000000002, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 47.3, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.699999999999996, 6.499999999999652, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 47.1, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.7, 44.900000000000006, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.099999999999994, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.5, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 46.3, 11.29999999999972, -50.00000000000044, 10.099999999999703, 44.900000000000006], "episode_lengths": [500, 500, 54, 500, 44, 28, 500, 500, 500, 500, 40, 314, 500, 500, 62, 500, 28, 500, 48, 84, 28, 500, 44, 500, 500, 500, 64, 500, 500, 24, 24, 104, 30, 500, 500, 500, 500, 38, 28, 44, 44, 500, 500, 74, 500, 34, 436, 500, 58, 500, 64, 500, 40, 58, 500, 30, 500, 42, 500, 500, 500, 32, 34, 500, 500, 114, 54, 52, 500, 92, 500, 500, 500, 500, 48, 32, 34, 500, 500, 500, 500, 58, 40, 70, 500, 500, 32, 36, 206, 500, 500, 500, 40, 500, 84, 38, 388, 500, 400, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39180886207890786, "mean_inference_ms": 1.261310930059502, "mean_action_processing_ms": 0.14753709984074828, "mean_env_wait_ms": 0.08721662474328441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019375324249267578, "StateBufferConnector_ms": 0.009018898010253906, "ViewRequirementAgentConnector_ms": 0.13673639297485352}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5708.940670588576, "num_env_steps_trained_throughput_per_sec": 5708.940670588576, "timesteps_total": 684000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 2191.408, "sample_time_ms": 1962.384, "load_time_ms": 10.561, "load_throughput": 1136216.138, "learn_time_ms": 208.397, "learn_throughput": 57582.454, "synch_weights_time_ms": 9.168}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2531, "training_iteration": 57, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-41", "timestamp": 1698247721, "time_this_iter_s": 2.1069653034210205, "time_total_s": 133.07563996315002, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 133.07563996315002, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 59.633333333333326, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3877787807814461e-18, "cur_lr": 0.0003, "total_loss": 6.62390546798706, "policy_loss": -0.0003758341073989868, "vf_loss": 6.624328390757243, "vf_explained_var": -1.0291735331217447e-06, "kl": 0.0004188001041408521, "entropy": 0.471362696091334, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 863.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.924000000000227, "episode_len_mean": 289.78, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, -50.00000000000044, 46.699999999999996, 6.499999999999652, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 47.1, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.7, 44.900000000000006, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.099999999999994, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.5, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 46.3, 11.29999999999972, -50.00000000000044, 10.099999999999703, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 17.099999999999802, -50.00000000000044, 45.9, 18.29999999999982, 44.10000000000001, 0.49999999999956657, 9.699999999999697, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 43.30000000000001, 45.3, 43.7, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 46.3, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.3, 44.10000000000001, 43.10000000000001, 46.3, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 74, 500, 34, 436, 500, 58, 500, 64, 500, 40, 58, 500, 30, 500, 42, 500, 500, 500, 32, 34, 500, 500, 114, 54, 52, 500, 92, 500, 500, 500, 500, 48, 32, 34, 500, 500, 500, 500, 58, 40, 70, 500, 500, 32, 36, 206, 500, 500, 500, 40, 500, 84, 38, 388, 500, 400, 52, 500, 500, 500, 56, 330, 500, 42, 318, 60, 496, 404, 500, 500, 34, 500, 44, 32, 500, 68, 48, 64, 500, 274, 500, 500, 486, 38, 56, 500, 500, 500, 30, 38, 60, 70, 38, 74, 46, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3917922319160585, "mean_inference_ms": 1.26120490772574, "mean_action_processing_ms": 0.14766583337980427, "mean_env_wait_ms": 0.0872565463768046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029895544052124023, "StateBufferConnector_ms": 0.009015560150146484, "ViewRequirementAgentConnector_ms": 0.13645172119140625}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.924000000000227, "episode_len_mean": 289.78, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, -50.00000000000044, 46.699999999999996, 6.499999999999652, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 47.1, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.7, 44.900000000000006, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.099999999999994, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.5, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 46.3, 11.29999999999972, -50.00000000000044, 10.099999999999703, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 17.099999999999802, -50.00000000000044, 45.9, 18.29999999999982, 44.10000000000001, 0.49999999999956657, 9.699999999999697, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 43.30000000000001, 45.3, 43.7, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 46.3, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.3, 44.10000000000001, 43.10000000000001, 46.3, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 74, 500, 34, 436, 500, 58, 500, 64, 500, 40, 58, 500, 30, 500, 42, 500, 500, 500, 32, 34, 500, 500, 114, 54, 52, 500, 92, 500, 500, 500, 500, 48, 32, 34, 500, 500, 500, 500, 58, 40, 70, 500, 500, 32, 36, 206, 500, 500, 500, 40, 500, 84, 38, 388, 500, 400, 52, 500, 500, 500, 56, 330, 500, 42, 318, 60, 496, 404, 500, 500, 34, 500, 44, 32, 500, 68, 48, 64, 500, 274, 500, 500, 486, 38, 56, 500, 500, 500, 30, 38, 60, 70, 38, 74, 46, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3917922319160585, "mean_inference_ms": 1.26120490772574, "mean_action_processing_ms": 0.14766583337980427, "mean_env_wait_ms": 0.0872565463768046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029895544052124023, "StateBufferConnector_ms": 0.009015560150146484, "ViewRequirementAgentConnector_ms": 0.13645172119140625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4861.188586886289, "num_env_steps_trained_throughput_per_sec": 4861.188586886289, "timesteps_total": 696000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 2206.287, "sample_time_ms": 1977.38, "load_time_ms": 10.618, "load_throughput": 1130159.38, "learn_time_ms": 208.189, "learn_throughput": 57639.95, "synch_weights_time_ms": 9.189}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 2573, "training_iteration": 58, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-45", "timestamp": 1698247725, "time_this_iter_s": 2.473282814025879, "time_total_s": 135.5489227771759, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 135.5489227771759, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 47.379999999999995, "ram_util_percent": 35.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.938893903907231e-19, "cur_lr": 0.0003, "total_loss": 6.332414817810059, "policy_loss": -0.00012507997453212739, "vf_loss": 6.332587750752767, "vf_explained_var": -5.245208740234375e-07, "kl": 0.00019563059846632312, "entropy": 0.47846435705820717, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.12099999999981, "episode_len_mean": 264.42, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 46.3, 11.29999999999972, -50.00000000000044, 10.099999999999703, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 17.099999999999802, -50.00000000000044, 45.9, 18.29999999999982, 44.10000000000001, 0.49999999999956657, 9.699999999999697, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 43.30000000000001, 45.3, 43.7, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 46.3, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.3, 44.10000000000001, 43.10000000000001, 46.3, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 21.299999999999862, 39.10000000000002, 40.30000000000002, 45.5, 45.9, 41.500000000000014, 40.500000000000014, 45.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, 43.900000000000006, 30.099999999999987, 46.3, 42.30000000000001, 37.10000000000003, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 28.699999999999967, 43.900000000000006, 40.10000000000002, 42.30000000000001, 43.30000000000001, 32.700000000000024, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 22.299999999999876], "episode_lengths": [36, 206, 500, 500, 500, 40, 500, 84, 38, 388, 500, 400, 52, 500, 500, 500, 56, 330, 500, 42, 318, 60, 496, 404, 500, 500, 34, 500, 44, 32, 500, 68, 48, 64, 500, 274, 500, 500, 486, 38, 56, 500, 500, 500, 30, 38, 60, 70, 38, 74, 46, 500, 500, 500, 500, 46, 50, 288, 110, 98, 46, 42, 86, 96, 46, 40, 500, 500, 56, 72, 500, 500, 500, 500, 28, 500, 500, 42, 62, 200, 38, 78, 130, 356, 500, 500, 500, 312, 214, 62, 100, 78, 68, 174, 94, 500, 500, 500, 102, 278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39295762890756114, "mean_inference_ms": 1.2615625208403243, "mean_action_processing_ms": 0.148396353711643, "mean_env_wait_ms": 0.0875149011435581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045522451400756836, "StateBufferConnector_ms": 0.0089874267578125, "ViewRequirementAgentConnector_ms": 0.13721203804016113}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.12099999999981, "episode_len_mean": 264.42, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 46.3, 11.29999999999972, -50.00000000000044, 10.099999999999703, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 17.099999999999802, -50.00000000000044, 45.9, 18.29999999999982, 44.10000000000001, 0.49999999999956657, 9.699999999999697, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 43.30000000000001, 45.3, 43.7, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 46.3, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.3, 44.10000000000001, 43.10000000000001, 46.3, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 21.299999999999862, 39.10000000000002, 40.30000000000002, 45.5, 45.9, 41.500000000000014, 40.500000000000014, 45.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, 43.900000000000006, 30.099999999999987, 46.3, 42.30000000000001, 37.10000000000003, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 28.699999999999967, 43.900000000000006, 40.10000000000002, 42.30000000000001, 43.30000000000001, 32.700000000000024, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 22.299999999999876], "episode_lengths": [36, 206, 500, 500, 500, 40, 500, 84, 38, 388, 500, 400, 52, 500, 500, 500, 56, 330, 500, 42, 318, 60, 496, 404, 500, 500, 34, 500, 44, 32, 500, 68, 48, 64, 500, 274, 500, 500, 486, 38, 56, 500, 500, 500, 30, 38, 60, 70, 38, 74, 46, 500, 500, 500, 500, 46, 50, 288, 110, 98, 46, 42, 86, 96, 46, 40, 500, 500, 56, 72, 500, 500, 500, 500, 28, 500, 500, 42, 62, 200, 38, 78, 130, 356, 500, 500, 500, 312, 214, 62, 100, 78, 68, 174, 94, 500, 500, 500, 102, 278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39295762890756114, "mean_inference_ms": 1.2615625208403243, "mean_action_processing_ms": 0.148396353711643, "mean_env_wait_ms": 0.0875149011435581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045522451400756836, "StateBufferConnector_ms": 0.0089874267578125, "ViewRequirementAgentConnector_ms": 0.13721203804016113}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5555.407553561625, "num_env_steps_trained_throughput_per_sec": 5555.407553561625, "timesteps_total": 708000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 2213.114, "sample_time_ms": 1985.014, "load_time_ms": 10.617, "load_throughput": 1130238.054, "learn_time_ms": 207.24, "learn_throughput": 57903.964, "synch_weights_time_ms": 9.135}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 2618, "training_iteration": 59, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-48", "timestamp": 1698247728, "time_this_iter_s": 2.968590497970581, "time_total_s": 138.51751327514648, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 138.51751327514648, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 51.00000000000001, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.4694469519536153e-19, "cur_lr": 0.0003, "total_loss": 6.398855876922608, "policy_loss": -0.00012974652151266733, "vf_loss": 6.399032147725423, "vf_explained_var": -7.947285970052083e-09, "kl": 0.00026788275710032394, "entropy": 0.4659001588821411, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 893.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5949999999998106, "episode_len_mean": 269.66, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.4999999999995808, 46.3, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.3, 44.10000000000001, 43.10000000000001, 46.3, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 21.299999999999862, 39.10000000000002, 40.30000000000002, 45.5, 45.9, 41.500000000000014, 40.500000000000014, 45.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, 43.900000000000006, 30.099999999999987, 46.3, 42.30000000000001, 37.10000000000003, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 28.699999999999967, 43.900000000000006, 40.10000000000002, 42.30000000000001, 43.30000000000001, 32.700000000000024, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 22.299999999999876, 40.10000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 28.699999999999967, 2.0999999999995893, -50.00000000000044, 38.50000000000003, 14.299999999999763, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 31.500000000000007, 6.299999999999649, -50.00000000000044, 47.1, 33.30000000000003, 41.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 48.1, -50.00000000000044, 27.099999999999945, -50.00000000000044, 37.10000000000003, -50.00000000000044, 47.1], "episode_lengths": [486, 38, 56, 500, 500, 500, 30, 38, 60, 70, 38, 74, 46, 500, 500, 500, 500, 46, 50, 288, 110, 98, 46, 42, 86, 96, 46, 40, 500, 500, 56, 72, 500, 500, 500, 500, 28, 500, 500, 42, 62, 200, 38, 78, 130, 356, 500, 500, 500, 312, 214, 62, 100, 78, 68, 174, 94, 500, 500, 500, 102, 278, 100, 120, 500, 500, 500, 66, 500, 214, 480, 500, 116, 358, 500, 500, 500, 104, 500, 500, 58, 500, 500, 40, 186, 438, 500, 30, 168, 86, 500, 64, 500, 20, 500, 230, 500, 130, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3933175406506962, "mean_inference_ms": 1.2620291359046494, "mean_action_processing_ms": 0.14857170730976346, "mean_env_wait_ms": 0.08759733599848277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038001060485839844, "StateBufferConnector_ms": 0.0069866180419921875, "ViewRequirementAgentConnector_ms": 0.12444233894348145}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5949999999998106, "episode_len_mean": 269.66, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.4999999999995808, 46.3, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.3, 44.10000000000001, 43.10000000000001, 46.3, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 21.299999999999862, 39.10000000000002, 40.30000000000002, 45.5, 45.9, 41.500000000000014, 40.500000000000014, 45.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, 43.900000000000006, 30.099999999999987, 46.3, 42.30000000000001, 37.10000000000003, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 28.699999999999967, 43.900000000000006, 40.10000000000002, 42.30000000000001, 43.30000000000001, 32.700000000000024, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 22.299999999999876, 40.10000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 28.699999999999967, 2.0999999999995893, -50.00000000000044, 38.50000000000003, 14.299999999999763, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 31.500000000000007, 6.299999999999649, -50.00000000000044, 47.1, 33.30000000000003, 41.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 48.1, -50.00000000000044, 27.099999999999945, -50.00000000000044, 37.10000000000003, -50.00000000000044, 47.1], "episode_lengths": [486, 38, 56, 500, 500, 500, 30, 38, 60, 70, 38, 74, 46, 500, 500, 500, 500, 46, 50, 288, 110, 98, 46, 42, 86, 96, 46, 40, 500, 500, 56, 72, 500, 500, 500, 500, 28, 500, 500, 42, 62, 200, 38, 78, 130, 356, 500, 500, 500, 312, 214, 62, 100, 78, 68, 174, 94, 500, 500, 500, 102, 278, 100, 120, 500, 500, 500, 66, 500, 214, 480, 500, 116, 358, 500, 500, 500, 104, 500, 500, 58, 500, 500, 40, 186, 438, 500, 30, 168, 86, 500, 64, 500, 20, 500, 230, 500, 130, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3933175406506962, "mean_inference_ms": 1.2620291359046494, "mean_action_processing_ms": 0.14857170730976346, "mean_env_wait_ms": 0.08759733599848277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038001060485839844, "StateBufferConnector_ms": 0.0069866180419921875, "ViewRequirementAgentConnector_ms": 0.12444233894348145}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5185.588964916977, "num_env_steps_trained_throughput_per_sec": 5185.588964916977, "timesteps_total": 720000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 2220.651, "sample_time_ms": 1989.692, "load_time_ms": 11.746, "load_throughput": 1021642.938, "learn_time_ms": 208.857, "learn_throughput": 57455.701, "synch_weights_time_ms": 9.347}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2656, "training_iteration": 60, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-50", "timestamp": 1698247730, "time_this_iter_s": 2.3191041946411133, "time_total_s": 140.8366174697876, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 140.8366174697876, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 57.166666666666664, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768077e-19, "cur_lr": 0.0003, "total_loss": 6.073631858825683, "policy_loss": -0.00012772530317306519, "vf_loss": 6.0738096555074055, "vf_explained_var": -1.0132789611816406e-06, "kl": 0.00024549331734912506, "entropy": 0.5037148515383403, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 908.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.07000000000020734, "episode_len_mean": 291.28, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.099999999999987, 46.3, 42.30000000000001, 37.10000000000003, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 28.699999999999967, 43.900000000000006, 40.10000000000002, 42.30000000000001, 43.30000000000001, 32.700000000000024, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 22.299999999999876, 40.10000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 28.699999999999967, 2.0999999999995893, -50.00000000000044, 38.50000000000003, 14.299999999999763, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 31.500000000000007, 6.299999999999649, -50.00000000000044, 47.1, 33.30000000000003, 41.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 48.1, -50.00000000000044, 27.099999999999945, -50.00000000000044, 37.10000000000003, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 34.10000000000004, 44.7, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.10000000000001, 46.5, 47.9, 11.899999999999729, -50.00000000000044, 44.5, 44.7, 45.3, 6.099999999999646, 43.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.3, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 33.90000000000004, 39.90000000000002, 40.10000000000002], "episode_lengths": [200, 38, 78, 130, 356, 500, 500, 500, 312, 214, 62, 100, 78, 68, 174, 94, 500, 500, 500, 102, 278, 100, 120, 500, 500, 500, 66, 500, 214, 480, 500, 116, 358, 500, 500, 500, 104, 500, 500, 58, 500, 500, 40, 186, 438, 500, 30, 168, 86, 500, 64, 500, 20, 500, 230, 500, 130, 500, 30, 500, 500, 500, 500, 58, 160, 54, 500, 78, 500, 60, 36, 22, 382, 500, 56, 54, 48, 440, 64, 500, 188, 500, 44, 500, 500, 48, 454, 500, 500, 500, 110, 500, 52, 500, 500, 34, 500, 162, 102, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39246876949922666, "mean_inference_ms": 1.2621448216293958, "mean_action_processing_ms": 0.1481431470257555, "mean_env_wait_ms": 0.0875660861339032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031992435455322266, "StateBufferConnector_ms": 0.0059871673583984375, "ViewRequirementAgentConnector_ms": 0.12979435920715332}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.07000000000020734, "episode_len_mean": 291.28, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.099999999999987, 46.3, 42.30000000000001, 37.10000000000003, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 28.699999999999967, 43.900000000000006, 40.10000000000002, 42.30000000000001, 43.30000000000001, 32.700000000000024, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 22.299999999999876, 40.10000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 28.699999999999967, 2.0999999999995893, -50.00000000000044, 38.50000000000003, 14.299999999999763, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 31.500000000000007, 6.299999999999649, -50.00000000000044, 47.1, 33.30000000000003, 41.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 48.1, -50.00000000000044, 27.099999999999945, -50.00000000000044, 37.10000000000003, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 34.10000000000004, 44.7, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.10000000000001, 46.5, 47.9, 11.899999999999729, -50.00000000000044, 44.5, 44.7, 45.3, 6.099999999999646, 43.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.3, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 33.90000000000004, 39.90000000000002, 40.10000000000002], "episode_lengths": [200, 38, 78, 130, 356, 500, 500, 500, 312, 214, 62, 100, 78, 68, 174, 94, 500, 500, 500, 102, 278, 100, 120, 500, 500, 500, 66, 500, 214, 480, 500, 116, 358, 500, 500, 500, 104, 500, 500, 58, 500, 500, 40, 186, 438, 500, 30, 168, 86, 500, 64, 500, 20, 500, 230, 500, 130, 500, 30, 500, 500, 500, 500, 58, 160, 54, 500, 78, 500, 60, 36, 22, 382, 500, 56, 54, 48, 440, 64, 500, 188, 500, 44, 500, 500, 48, 454, 500, 500, 500, 110, 500, 52, 500, 500, 34, 500, 162, 102, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39246876949922666, "mean_inference_ms": 1.2621448216293958, "mean_action_processing_ms": 0.1481431470257555, "mean_env_wait_ms": 0.0875660861339032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031992435455322266, "StateBufferConnector_ms": 0.0059871673583984375, "ViewRequirementAgentConnector_ms": 0.12979435920715332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5529.449479097432, "num_env_steps_trained_throughput_per_sec": 5529.449479097432, "timesteps_total": 732000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 2222.992, "sample_time_ms": 2003.332, "load_time_ms": 11.542, "load_throughput": 1039680.236, "learn_time_ms": 197.976, "learn_throughput": 60613.366, "synch_weights_time_ms": 9.232}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 2697, "training_iteration": 61, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-54", "timestamp": 1698247734, "time_this_iter_s": 3.6653616428375244, "time_total_s": 144.50197911262512, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 144.50197911262512, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 46.260000000000005, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884038e-20, "cur_lr": 0.0003, "total_loss": 6.349848524729411, "policy_loss": -0.00041180302699406944, "vf_loss": 6.350305557250977, "vf_explained_var": -9.854634602864584e-07, "kl": 0.0005105944833284563, "entropy": 0.45122637748718264, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 923.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.523000000000205, "episode_len_mean": 280.78, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.1, 33.30000000000003, 41.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 48.1, -50.00000000000044, 27.099999999999945, -50.00000000000044, 37.10000000000003, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 34.10000000000004, 44.7, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.10000000000001, 46.5, 47.9, 11.899999999999729, -50.00000000000044, 44.5, 44.7, 45.3, 6.099999999999646, 43.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.3, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 33.90000000000004, 39.90000000000002, 40.10000000000002, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 40.500000000000014, 44.7, 42.70000000000001, 40.70000000000002, 30.499999999999993, 46.5, 47.1, -50.00000000000044, 33.70000000000004, -50.00000000000044, 47.5, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, 44.5, 35.10000000000004, -50.00000000000044, -50.00000000000044, 34.30000000000004, 45.9, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.5, -50.00000000000044, 46.9], "episode_lengths": [500, 30, 168, 86, 500, 64, 500, 20, 500, 230, 500, 130, 500, 30, 500, 500, 500, 500, 58, 160, 54, 500, 78, 500, 60, 36, 22, 382, 500, 56, 54, 48, 440, 64, 500, 188, 500, 44, 500, 500, 48, 454, 500, 500, 500, 110, 500, 52, 500, 500, 34, 500, 162, 102, 100, 500, 38, 40, 500, 500, 500, 500, 500, 500, 500, 500, 124, 96, 54, 74, 94, 196, 36, 30, 500, 164, 500, 26, 98, 76, 500, 500, 240, 500, 56, 150, 500, 500, 158, 42, 62, 44, 500, 500, 500, 500, 58, 26, 500, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924398720817566, "mean_inference_ms": 1.2622269030754132, "mean_action_processing_ms": 0.14799693876500292, "mean_env_wait_ms": 0.08763308913258207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032994985580444336, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.12302803993225098}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.523000000000205, "episode_len_mean": 280.78, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.1, 33.30000000000003, 41.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 48.1, -50.00000000000044, 27.099999999999945, -50.00000000000044, 37.10000000000003, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 34.10000000000004, 44.7, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.10000000000001, 46.5, 47.9, 11.899999999999729, -50.00000000000044, 44.5, 44.7, 45.3, 6.099999999999646, 43.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.3, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 33.90000000000004, 39.90000000000002, 40.10000000000002, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 40.500000000000014, 44.7, 42.70000000000001, 40.70000000000002, 30.499999999999993, 46.5, 47.1, -50.00000000000044, 33.70000000000004, -50.00000000000044, 47.5, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, 44.5, 35.10000000000004, -50.00000000000044, -50.00000000000044, 34.30000000000004, 45.9, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.5, -50.00000000000044, 46.9], "episode_lengths": [500, 30, 168, 86, 500, 64, 500, 20, 500, 230, 500, 130, 500, 30, 500, 500, 500, 500, 58, 160, 54, 500, 78, 500, 60, 36, 22, 382, 500, 56, 54, 48, 440, 64, 500, 188, 500, 44, 500, 500, 48, 454, 500, 500, 500, 110, 500, 52, 500, 500, 34, 500, 162, 102, 100, 500, 38, 40, 500, 500, 500, 500, 500, 500, 500, 500, 124, 96, 54, 74, 94, 196, 36, 30, 500, 164, 500, 26, 98, 76, 500, 500, 240, 500, 56, 150, 500, 500, 158, 42, 62, 44, 500, 500, 500, 500, 58, 26, 500, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924398720817566, "mean_inference_ms": 1.2622269030754132, "mean_action_processing_ms": 0.14799693876500292, "mean_env_wait_ms": 0.08763308913258207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032994985580444336, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.12302803993225098}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5248.977014863828, "num_env_steps_trained_throughput_per_sec": 5248.977014863828, "timesteps_total": 744000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 2227.237, "sample_time_ms": 2010.885, "load_time_ms": 11.621, "load_throughput": 1032598.687, "learn_time_ms": 194.731, "learn_throughput": 61623.441, "synch_weights_time_ms": 9.19}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 2742, "training_iteration": 62, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-56", "timestamp": 1698247736, "time_this_iter_s": 2.290159225463867, "time_total_s": 146.792138338089, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 146.792138338089, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 50.39999999999999, "ram_util_percent": 35.324999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.336808689942019e-20, "cur_lr": 0.0003, "total_loss": 6.763880634307862, "policy_loss": -0.00034572084744771323, "vf_loss": 6.764273198445638, "vf_explained_var": -1.2795130411783853e-06, "kl": 0.0008023361178857158, "entropy": 0.46857860684394836, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 938.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.321999999999815, "episode_len_mean": 267.4, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 33.90000000000004, 39.90000000000002, 40.10000000000002, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 40.500000000000014, 44.7, 42.70000000000001, 40.70000000000002, 30.499999999999993, 46.5, 47.1, -50.00000000000044, 33.70000000000004, -50.00000000000044, 47.5, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, 44.5, 35.10000000000004, -50.00000000000044, -50.00000000000044, 34.30000000000004, 45.9, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.5, -50.00000000000044, 46.9, -50.00000000000044, 42.10000000000001, 43.900000000000006, 29.899999999999984, -50.00000000000044, 11.899999999999729, 47.3, 38.90000000000002, 2.699999999999598, -50.00000000000044, 43.7, 18.29999999999982, 21.09999999999986, 47.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.7, 21.89999999999987, 19.899999999999842, 43.7, 44.900000000000006, 43.30000000000001, 40.70000000000002, 35.10000000000004, 38.50000000000003, 40.70000000000002, 45.1, 25.29999999999992, -50.00000000000044, 36.30000000000003, 42.30000000000001, 1.6999999999995836, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 43.10000000000001, 9.299999999999692, -50.00000000000044], "episode_lengths": [110, 500, 52, 500, 500, 34, 500, 162, 102, 100, 500, 38, 40, 500, 500, 500, 500, 500, 500, 500, 500, 124, 96, 54, 74, 94, 196, 36, 30, 500, 164, 500, 26, 98, 76, 500, 500, 240, 500, 56, 150, 500, 500, 158, 42, 62, 44, 500, 500, 500, 500, 58, 26, 500, 32, 500, 80, 62, 202, 500, 382, 28, 112, 474, 500, 64, 318, 290, 30, 500, 34, 500, 38, 500, 500, 500, 26, 44, 282, 302, 64, 52, 68, 94, 150, 116, 94, 50, 248, 500, 138, 78, 484, 500, 284, 500, 500, 70, 408, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39264169097796686, "mean_inference_ms": 1.2628823592632583, "mean_action_processing_ms": 0.14851422976240716, "mean_env_wait_ms": 0.08764259558130152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023500919342041016, "StateBufferConnector_ms": 0.0060155391693115234, "ViewRequirementAgentConnector_ms": 0.1267554759979248}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.321999999999815, "episode_len_mean": 267.4, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 33.90000000000004, 39.90000000000002, 40.10000000000002, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 40.500000000000014, 44.7, 42.70000000000001, 40.70000000000002, 30.499999999999993, 46.5, 47.1, -50.00000000000044, 33.70000000000004, -50.00000000000044, 47.5, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, 44.5, 35.10000000000004, -50.00000000000044, -50.00000000000044, 34.30000000000004, 45.9, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.5, -50.00000000000044, 46.9, -50.00000000000044, 42.10000000000001, 43.900000000000006, 29.899999999999984, -50.00000000000044, 11.899999999999729, 47.3, 38.90000000000002, 2.699999999999598, -50.00000000000044, 43.7, 18.29999999999982, 21.09999999999986, 47.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.7, 21.89999999999987, 19.899999999999842, 43.7, 44.900000000000006, 43.30000000000001, 40.70000000000002, 35.10000000000004, 38.50000000000003, 40.70000000000002, 45.1, 25.29999999999992, -50.00000000000044, 36.30000000000003, 42.30000000000001, 1.6999999999995836, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 43.10000000000001, 9.299999999999692, -50.00000000000044], "episode_lengths": [110, 500, 52, 500, 500, 34, 500, 162, 102, 100, 500, 38, 40, 500, 500, 500, 500, 500, 500, 500, 500, 124, 96, 54, 74, 94, 196, 36, 30, 500, 164, 500, 26, 98, 76, 500, 500, 240, 500, 56, 150, 500, 500, 158, 42, 62, 44, 500, 500, 500, 500, 58, 26, 500, 32, 500, 80, 62, 202, 500, 382, 28, 112, 474, 500, 64, 318, 290, 30, 500, 34, 500, 38, 500, 500, 500, 26, 44, 282, 302, 64, 52, 68, 94, 150, 116, 94, 50, 248, 500, 138, 78, 484, 500, 284, 500, 500, 70, 408, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39264169097796686, "mean_inference_ms": 1.2628823592632583, "mean_action_processing_ms": 0.14851422976240716, "mean_env_wait_ms": 0.08764259558130152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023500919342041016, "StateBufferConnector_ms": 0.0060155391693115234, "ViewRequirementAgentConnector_ms": 0.1267554759979248}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5323.363151158574, "num_env_steps_trained_throughput_per_sec": 5323.363151158574, "timesteps_total": 756000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 2235.49, "sample_time_ms": 2004.309, "load_time_ms": 11.422, "load_throughput": 1050583.051, "learn_time_ms": 209.491, "learn_throughput": 57281.797, "synch_weights_time_ms": 9.359}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2787, "training_iteration": 63, "trial_id": "9f288_00011", "date": "2023-10-25_16-28-59", "timestamp": 1698247739, "time_this_iter_s": 2.259002447128296, "time_total_s": 149.05114078521729, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 149.05114078521729, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 63.300000000000004, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710096e-20, "cur_lr": 0.0003, "total_loss": 6.256901772816976, "policy_loss": -0.0003147954742113749, "vf_loss": 6.257262484232585, "vf_explained_var": -5.086263020833333e-07, "kl": 0.0005197266611882393, "entropy": 0.45957143902778624, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 953.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.2979999999997993, "episode_len_mean": 277.62, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 34.30000000000004, 45.9, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.5, -50.00000000000044, 46.9, -50.00000000000044, 42.10000000000001, 43.900000000000006, 29.899999999999984, -50.00000000000044, 11.899999999999729, 47.3, 38.90000000000002, 2.699999999999598, -50.00000000000044, 43.7, 18.29999999999982, 21.09999999999986, 47.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.7, 21.89999999999987, 19.899999999999842, 43.7, 44.900000000000006, 43.30000000000001, 40.70000000000002, 35.10000000000004, 38.50000000000003, 40.70000000000002, 45.1, 25.29999999999992, -50.00000000000044, 36.30000000000003, 42.30000000000001, 1.6999999999995836, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 43.10000000000001, 9.299999999999692, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 44.900000000000006, 34.70000000000004, 41.30000000000001, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 21.699999999999868, -50.00000000000044, 38.90000000000002, 2.0999999999995893, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 38.90000000000002], "episode_lengths": [500, 500, 158, 42, 62, 44, 500, 500, 500, 500, 58, 26, 500, 32, 500, 80, 62, 202, 500, 382, 28, 112, 474, 500, 64, 318, 290, 30, 500, 34, 500, 38, 500, 500, 500, 26, 44, 282, 302, 64, 52, 68, 94, 150, 116, 94, 50, 248, 500, 138, 78, 484, 500, 284, 500, 500, 70, 408, 500, 500, 32, 500, 52, 52, 154, 88, 60, 500, 38, 500, 500, 46, 500, 500, 56, 500, 500, 128, 500, 284, 500, 112, 480, 66, 56, 500, 500, 56, 500, 34, 500, 500, 500, 68, 162, 500, 500, 500, 38, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3926917443644269, "mean_inference_ms": 1.2624235519795604, "mean_action_processing_ms": 0.14855735586083457, "mean_env_wait_ms": 0.08763858242788991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023499488830566406, "StateBufferConnector_ms": 0.006014108657836914, "ViewRequirementAgentConnector_ms": 0.11959362030029297}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.2979999999997993, "episode_len_mean": 277.62, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 34.30000000000004, 45.9, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.5, -50.00000000000044, 46.9, -50.00000000000044, 42.10000000000001, 43.900000000000006, 29.899999999999984, -50.00000000000044, 11.899999999999729, 47.3, 38.90000000000002, 2.699999999999598, -50.00000000000044, 43.7, 18.29999999999982, 21.09999999999986, 47.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.7, 21.89999999999987, 19.899999999999842, 43.7, 44.900000000000006, 43.30000000000001, 40.70000000000002, 35.10000000000004, 38.50000000000003, 40.70000000000002, 45.1, 25.29999999999992, -50.00000000000044, 36.30000000000003, 42.30000000000001, 1.6999999999995836, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 43.10000000000001, 9.299999999999692, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 44.900000000000006, 34.70000000000004, 41.30000000000001, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 21.699999999999868, -50.00000000000044, 38.90000000000002, 2.0999999999995893, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 38.90000000000002], "episode_lengths": [500, 500, 158, 42, 62, 44, 500, 500, 500, 500, 58, 26, 500, 32, 500, 80, 62, 202, 500, 382, 28, 112, 474, 500, 64, 318, 290, 30, 500, 34, 500, 38, 500, 500, 500, 26, 44, 282, 302, 64, 52, 68, 94, 150, 116, 94, 50, 248, 500, 138, 78, 484, 500, 284, 500, 500, 70, 408, 500, 500, 32, 500, 52, 52, 154, 88, 60, 500, 38, 500, 500, 46, 500, 500, 56, 500, 500, 128, 500, 284, 500, 112, 480, 66, 56, 500, 500, 56, 500, 34, 500, 500, 500, 68, 162, 500, 500, 500, 38, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3926917443644269, "mean_inference_ms": 1.2624235519795604, "mean_action_processing_ms": 0.14855735586083457, "mean_env_wait_ms": 0.08763858242788991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023499488830566406, "StateBufferConnector_ms": 0.006014108657836914, "ViewRequirementAgentConnector_ms": 0.11959362030029297}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5700.2283187765015, "num_env_steps_trained_throughput_per_sec": 5700.2283187765015, "timesteps_total": 768000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 2233.149, "sample_time_ms": 2002.02, "load_time_ms": 11.35, "load_throughput": 1057309.82, "learn_time_ms": 209.533, "learn_throughput": 57270.215, "synch_weights_time_ms": 9.237}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 2828, "training_iteration": 64, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-01", "timestamp": 1698247741, "time_this_iter_s": 2.1347222328186035, "time_total_s": 151.1858630180359, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 151.1858630180359, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 53.96666666666666, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855048e-20, "cur_lr": 0.0003, "total_loss": 6.09411096572876, "policy_loss": -0.0001244567334651947, "vf_loss": 6.094285202026367, "vf_explained_var": -9.934107462565105e-07, "kl": 0.00011892586733968832, "entropy": 0.49820174773534137, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 968.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7269999999998036, "episode_len_mean": 268.32, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.30000000000003, 42.30000000000001, 1.6999999999995836, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 43.10000000000001, 9.299999999999692, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 44.900000000000006, 34.70000000000004, 41.30000000000001, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 21.699999999999868, -50.00000000000044, 38.90000000000002, 2.0999999999995893, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 38.90000000000002, 15.699999999999783, 44.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.699999999999996, 45.1, 42.500000000000014, 44.10000000000001, 37.90000000000003, 39.300000000000026, 45.3, -50.00000000000044, 31.900000000000013, -50.00000000000044, 35.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.9, 42.70000000000001, -50.00000000000044, -50.00000000000044, 47.5, 46.699999999999996, 44.900000000000006, -50.00000000000044, 44.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, 14.499999999999766, 46.5, 46.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 30.499999999999993, 46.9, 45.5, 44.900000000000006, 40.500000000000014, -50.00000000000044, -50.00000000000044], "episode_lengths": [138, 78, 484, 500, 284, 500, 500, 70, 408, 500, 500, 32, 500, 52, 52, 154, 88, 60, 500, 38, 500, 500, 46, 500, 500, 56, 500, 500, 128, 500, 284, 500, 112, 480, 66, 56, 500, 500, 56, 500, 34, 500, 500, 500, 68, 162, 500, 500, 500, 38, 112, 344, 56, 44, 500, 500, 500, 30, 34, 50, 76, 60, 122, 108, 48, 500, 182, 500, 144, 500, 48, 500, 62, 500, 42, 74, 500, 500, 26, 34, 52, 500, 52, 60, 500, 500, 356, 36, 34, 500, 58, 500, 42, 196, 32, 46, 52, 96, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39232125210629293, "mean_inference_ms": 1.2623702312097913, "mean_action_processing_ms": 0.14788344132957945, "mean_env_wait_ms": 0.08744456720200328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022992610931396484, "StateBufferConnector_ms": 0.006001949310302734, "ViewRequirementAgentConnector_ms": 0.11516189575195312}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7269999999998036, "episode_len_mean": 268.32, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.30000000000003, 42.30000000000001, 1.6999999999995836, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 43.10000000000001, 9.299999999999692, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 44.900000000000006, 34.70000000000004, 41.30000000000001, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 21.699999999999868, -50.00000000000044, 38.90000000000002, 2.0999999999995893, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 38.90000000000002, 15.699999999999783, 44.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.699999999999996, 45.1, 42.500000000000014, 44.10000000000001, 37.90000000000003, 39.300000000000026, 45.3, -50.00000000000044, 31.900000000000013, -50.00000000000044, 35.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.9, 42.70000000000001, -50.00000000000044, -50.00000000000044, 47.5, 46.699999999999996, 44.900000000000006, -50.00000000000044, 44.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, 14.499999999999766, 46.5, 46.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 30.499999999999993, 46.9, 45.5, 44.900000000000006, 40.500000000000014, -50.00000000000044, -50.00000000000044], "episode_lengths": [138, 78, 484, 500, 284, 500, 500, 70, 408, 500, 500, 32, 500, 52, 52, 154, 88, 60, 500, 38, 500, 500, 46, 500, 500, 56, 500, 500, 128, 500, 284, 500, 112, 480, 66, 56, 500, 500, 56, 500, 34, 500, 500, 500, 68, 162, 500, 500, 500, 38, 112, 344, 56, 44, 500, 500, 500, 30, 34, 50, 76, 60, 122, 108, 48, 500, 182, 500, 144, 500, 48, 500, 62, 500, 42, 74, 500, 500, 26, 34, 52, 500, 52, 60, 500, 500, 356, 36, 34, 500, 58, 500, 42, 196, 32, 46, 52, 96, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39232125210629293, "mean_inference_ms": 1.2623702312097913, "mean_action_processing_ms": 0.14788344132957945, "mean_env_wait_ms": 0.08744456720200328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022992610931396484, "StateBufferConnector_ms": 0.006001949310302734, "ViewRequirementAgentConnector_ms": 0.11516189575195312}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5596.118668965673, "num_env_steps_trained_throughput_per_sec": 5596.118668965673, "timesteps_total": 780000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 2231.901, "sample_time_ms": 2007.208, "load_time_ms": 11.202, "load_throughput": 1071191.531, "learn_time_ms": 203.144, "learn_throughput": 59071.453, "synch_weights_time_ms": 9.337}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 2877, "training_iteration": 65, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-03", "timestamp": 1698247743, "time_this_iter_s": 2.149341344833374, "time_total_s": 153.33520436286926, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 153.33520436286926, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 65.0, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427524e-21, "cur_lr": 0.0003, "total_loss": 5.921810785929362, "policy_loss": -0.0005183383667220672, "vf_loss": 5.922375679016113, "vf_explained_var": -1.2556711832682292e-06, "kl": 0.0006032982855723883, "entropy": 0.4654128869374593, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 983.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.26899999999979685, "episode_len_mean": 272.86, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 38.90000000000002, 15.699999999999783, 44.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.699999999999996, 45.1, 42.500000000000014, 44.10000000000001, 37.90000000000003, 39.300000000000026, 45.3, -50.00000000000044, 31.900000000000013, -50.00000000000044, 35.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.9, 42.70000000000001, -50.00000000000044, -50.00000000000044, 47.5, 46.699999999999996, 44.900000000000006, -50.00000000000044, 44.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, 14.499999999999766, 46.5, 46.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 30.499999999999993, 46.9, 45.5, 44.900000000000006, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 42.30000000000001, 47.7, 45.7, -50.00000000000044, 44.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.9, 8.299999999999677, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 30.699999999999996, 44.10000000000001, -50.00000000000044], "episode_lengths": [500, 34, 500, 500, 500, 68, 162, 500, 500, 500, 38, 112, 344, 56, 44, 500, 500, 500, 30, 34, 50, 76, 60, 122, 108, 48, 500, 182, 500, 144, 500, 48, 500, 62, 500, 42, 74, 500, 500, 26, 34, 52, 500, 52, 60, 500, 500, 356, 36, 34, 500, 58, 500, 42, 196, 32, 46, 52, 96, 500, 500, 500, 500, 70, 50, 500, 500, 500, 40, 500, 40, 78, 24, 44, 500, 54, 42, 500, 500, 500, 90, 500, 500, 70, 500, 42, 418, 500, 500, 226, 500, 500, 500, 500, 500, 52, 82, 194, 60, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39221090931023, "mean_inference_ms": 1.2630229420106778, "mean_action_processing_ms": 0.14788819894083136, "mean_env_wait_ms": 0.08747983278279348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018999576568603516, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.12032818794250488}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.26899999999979685, "episode_len_mean": 272.86, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 38.90000000000002, 15.699999999999783, 44.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.699999999999996, 45.1, 42.500000000000014, 44.10000000000001, 37.90000000000003, 39.300000000000026, 45.3, -50.00000000000044, 31.900000000000013, -50.00000000000044, 35.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.9, 42.70000000000001, -50.00000000000044, -50.00000000000044, 47.5, 46.699999999999996, 44.900000000000006, -50.00000000000044, 44.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, 14.499999999999766, 46.5, 46.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 30.499999999999993, 46.9, 45.5, 44.900000000000006, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 42.30000000000001, 47.7, 45.7, -50.00000000000044, 44.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.9, 8.299999999999677, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 30.699999999999996, 44.10000000000001, -50.00000000000044], "episode_lengths": [500, 34, 500, 500, 500, 68, 162, 500, 500, 500, 38, 112, 344, 56, 44, 500, 500, 500, 30, 34, 50, 76, 60, 122, 108, 48, 500, 182, 500, 144, 500, 48, 500, 62, 500, 42, 74, 500, 500, 26, 34, 52, 500, 52, 60, 500, 500, 356, 36, 34, 500, 58, 500, 42, 196, 32, 46, 52, 96, 500, 500, 500, 500, 70, 50, 500, 500, 500, 40, 500, 40, 78, 24, 44, 500, 54, 42, 500, 500, 500, 90, 500, 500, 70, 500, 42, 418, 500, 500, 226, 500, 500, 500, 500, 500, 52, 82, 194, 60, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39221090931023, "mean_inference_ms": 1.2630229420106778, "mean_action_processing_ms": 0.14788819894083136, "mean_env_wait_ms": 0.08747983278279348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018999576568603516, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.12032818794250488}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5541.321125284035, "num_env_steps_trained_throughput_per_sec": 5541.321125284035, "timesteps_total": 792000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 2216.93, "sample_time_ms": 2011.399, "load_time_ms": 10.282, "load_throughput": 1167110.678, "learn_time_ms": 184.857, "learn_throughput": 64915.089, "synch_weights_time_ms": 9.183}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 2916, "training_iteration": 66, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-05", "timestamp": 1698247745, "time_this_iter_s": 2.1705589294433594, "time_total_s": 155.50576329231262, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 155.50576329231262, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 66.66666666666667, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.710505431213762e-21, "cur_lr": 0.0003, "total_loss": 6.653844102223714, "policy_loss": -7.286742329597473e-05, "vf_loss": 6.653965695699056, "vf_explained_var": -2.582867940266927e-07, "kl": 0.00018451918371435264, "entropy": 0.48749396999677025, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 998.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.661999999999805, "episode_len_mean": 273.96, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 30.499999999999993, 46.9, 45.5, 44.900000000000006, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 42.30000000000001, 47.7, 45.7, -50.00000000000044, 44.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.9, 8.299999999999677, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 30.699999999999996, 44.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 19.499999999999837, 42.10000000000001, -50.00000000000044, 28.09999999999996, 3.0999999999996035, 32.700000000000024, 36.30000000000003, 39.90000000000002, -50.00000000000044, 41.100000000000016, 2.0999999999995893, 35.30000000000004, 37.300000000000026, 46.5, -50.00000000000044, 38.10000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.5, 43.30000000000001, -50.00000000000044, 40.500000000000014, 47.7, -50.00000000000044, 28.699999999999967, -50.00000000000044, 35.30000000000004, 44.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.900000000000006, 46.5, 46.5, -50.00000000000044, 40.10000000000002, 42.30000000000001, 45.1, -50.00000000000044, 25.699999999999925], "episode_lengths": [34, 500, 58, 500, 42, 196, 32, 46, 52, 96, 500, 500, 500, 500, 70, 50, 500, 500, 500, 40, 500, 40, 78, 24, 44, 500, 54, 42, 500, 500, 500, 90, 500, 500, 70, 500, 42, 418, 500, 500, 226, 500, 500, 500, 500, 500, 52, 82, 194, 60, 500, 500, 96, 68, 500, 500, 306, 80, 500, 220, 470, 174, 138, 102, 500, 90, 480, 148, 128, 36, 500, 120, 62, 500, 500, 500, 84, 500, 36, 68, 500, 96, 24, 500, 214, 500, 148, 60, 500, 100, 500, 72, 36, 36, 500, 100, 78, 50, 500, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39251931393791845, "mean_inference_ms": 1.2639733408868432, "mean_action_processing_ms": 0.14828748272519596, "mean_env_wait_ms": 0.08724398200032525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099919319152832, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.11398744583129883}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.661999999999805, "episode_len_mean": 273.96, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 30.499999999999993, 46.9, 45.5, 44.900000000000006, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 42.30000000000001, 47.7, 45.7, -50.00000000000044, 44.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.9, 8.299999999999677, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 30.699999999999996, 44.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 19.499999999999837, 42.10000000000001, -50.00000000000044, 28.09999999999996, 3.0999999999996035, 32.700000000000024, 36.30000000000003, 39.90000000000002, -50.00000000000044, 41.100000000000016, 2.0999999999995893, 35.30000000000004, 37.300000000000026, 46.5, -50.00000000000044, 38.10000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.5, 43.30000000000001, -50.00000000000044, 40.500000000000014, 47.7, -50.00000000000044, 28.699999999999967, -50.00000000000044, 35.30000000000004, 44.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.900000000000006, 46.5, 46.5, -50.00000000000044, 40.10000000000002, 42.30000000000001, 45.1, -50.00000000000044, 25.699999999999925], "episode_lengths": [34, 500, 58, 500, 42, 196, 32, 46, 52, 96, 500, 500, 500, 500, 70, 50, 500, 500, 500, 40, 500, 40, 78, 24, 44, 500, 54, 42, 500, 500, 500, 90, 500, 500, 70, 500, 42, 418, 500, 500, 226, 500, 500, 500, 500, 500, 52, 82, 194, 60, 500, 500, 96, 68, 500, 500, 306, 80, 500, 220, 470, 174, 138, 102, 500, 90, 480, 148, 128, 36, 500, 120, 62, 500, 500, 500, 84, 500, 36, 68, 500, 96, 24, 500, 214, 500, 148, 60, 500, 100, 500, 72, 36, 36, 500, 100, 78, 50, 500, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39251931393791845, "mean_inference_ms": 1.2639733408868432, "mean_action_processing_ms": 0.14828748272519596, "mean_env_wait_ms": 0.08724398200032525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099919319152832, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.11398744583129883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5532.57544771118, "num_env_steps_trained_throughput_per_sec": 5532.57544771118, "timesteps_total": 804000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 2223.631, "sample_time_ms": 2008.991, "load_time_ms": 10.5, "load_throughput": 1142859.53, "learn_time_ms": 193.887, "learn_throughput": 61891.691, "synch_weights_time_ms": 9.044}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 2965, "training_iteration": 67, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-08", "timestamp": 1698247748, "time_this_iter_s": 2.1739695072174072, "time_total_s": 157.67973279953003, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 157.67973279953003, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 64.0, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.355252715606881e-21, "cur_lr": 0.0003, "total_loss": 6.448761653900147, "policy_loss": 8.014403283596038e-06, "vf_loss": 6.4488012313842775, "vf_explained_var": -1.7722447713216146e-06, "kl": 0.00011597877606277507, "entropy": 0.47516478498776754, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.528999999999825, "episode_len_mean": 260.36, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 30.699999999999996, 44.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 19.499999999999837, 42.10000000000001, -50.00000000000044, 28.09999999999996, 3.0999999999996035, 32.700000000000024, 36.30000000000003, 39.90000000000002, -50.00000000000044, 41.100000000000016, 2.0999999999995893, 35.30000000000004, 37.300000000000026, 46.5, -50.00000000000044, 38.10000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.5, 43.30000000000001, -50.00000000000044, 40.500000000000014, 47.7, -50.00000000000044, 28.699999999999967, -50.00000000000044, 35.30000000000004, 44.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.900000000000006, 46.5, 46.5, -50.00000000000044, 40.10000000000002, 42.30000000000001, 45.1, -50.00000000000044, 25.699999999999925, 11.499999999999723, 38.10000000000002, 3.499999999999609, 43.30000000000001, -50.00000000000044, 42.30000000000001, 23.499999999999893, -50.00000000000044, 8.099999999999675, 28.499999999999964, 43.7, 19.09999999999983, 45.5, 38.10000000000002, -50.00000000000044, 42.500000000000014, 40.30000000000002, 46.9, 36.50000000000003, 45.9, 44.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.7, 44.7, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 21.89999999999987, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 52, 82, 194, 60, 500, 500, 96, 68, 500, 500, 306, 80, 500, 220, 470, 174, 138, 102, 500, 90, 480, 148, 128, 36, 500, 120, 62, 500, 500, 500, 84, 500, 36, 68, 500, 96, 24, 500, 214, 500, 148, 60, 500, 100, 500, 72, 36, 36, 500, 100, 78, 50, 500, 244, 386, 120, 466, 68, 500, 78, 266, 500, 420, 216, 64, 310, 46, 120, 500, 76, 98, 32, 136, 42, 52, 60, 500, 500, 100, 64, 54, 500, 500, 204, 500, 500, 500, 36, 282, 500, 34, 46, 500, 48, 500, 60, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39225678992948176, "mean_inference_ms": 1.263108051709854, "mean_action_processing_ms": 0.14821562361679988, "mean_env_wait_ms": 0.08728159450093458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099822998046875, "StateBufferConnector_ms": 0.002001047134399414, "ViewRequirementAgentConnector_ms": 0.10949468612670898}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.528999999999825, "episode_len_mean": 260.36, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 30.699999999999996, 44.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 19.499999999999837, 42.10000000000001, -50.00000000000044, 28.09999999999996, 3.0999999999996035, 32.700000000000024, 36.30000000000003, 39.90000000000002, -50.00000000000044, 41.100000000000016, 2.0999999999995893, 35.30000000000004, 37.300000000000026, 46.5, -50.00000000000044, 38.10000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.5, 43.30000000000001, -50.00000000000044, 40.500000000000014, 47.7, -50.00000000000044, 28.699999999999967, -50.00000000000044, 35.30000000000004, 44.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.900000000000006, 46.5, 46.5, -50.00000000000044, 40.10000000000002, 42.30000000000001, 45.1, -50.00000000000044, 25.699999999999925, 11.499999999999723, 38.10000000000002, 3.499999999999609, 43.30000000000001, -50.00000000000044, 42.30000000000001, 23.499999999999893, -50.00000000000044, 8.099999999999675, 28.499999999999964, 43.7, 19.09999999999983, 45.5, 38.10000000000002, -50.00000000000044, 42.500000000000014, 40.30000000000002, 46.9, 36.50000000000003, 45.9, 44.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.7, 44.7, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 21.89999999999987, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 52, 82, 194, 60, 500, 500, 96, 68, 500, 500, 306, 80, 500, 220, 470, 174, 138, 102, 500, 90, 480, 148, 128, 36, 500, 120, 62, 500, 500, 500, 84, 500, 36, 68, 500, 96, 24, 500, 214, 500, 148, 60, 500, 100, 500, 72, 36, 36, 500, 100, 78, 50, 500, 244, 386, 120, 466, 68, 500, 78, 266, 500, 420, 216, 64, 310, 46, 120, 500, 76, 98, 32, 136, 42, 52, 60, 500, 500, 100, 64, 54, 500, 500, 204, 500, 500, 500, 36, 282, 500, 34, 46, 500, 48, 500, 60, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39225678992948176, "mean_inference_ms": 1.263108051709854, "mean_action_processing_ms": 0.14821562361679988, "mean_env_wait_ms": 0.08728159450093458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099822998046875, "StateBufferConnector_ms": 0.002001047134399414, "ViewRequirementAgentConnector_ms": 0.10949468612670898}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5462.155382977017, "num_env_steps_trained_throughput_per_sec": 5462.155382977017, "timesteps_total": 816000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 2196.471, "sample_time_ms": 1991.662, "load_time_ms": 10.337, "load_throughput": 1160881.623, "learn_time_ms": 184.254, "learn_throughput": 65127.579, "synch_weights_time_ms": 8.92}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 3009, "training_iteration": 68, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-11", "timestamp": 1698247751, "time_this_iter_s": 3.028352975845337, "time_total_s": 160.70808577537537, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 160.70808577537537, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 45.68, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034405e-22, "cur_lr": 0.0003, "total_loss": 6.781524531046549, "policy_loss": -0.0008599125469724337, "vf_loss": 6.782434177398682, "vf_explained_var": -9.139378865559896e-07, "kl": 0.0007488277598232192, "entropy": 0.49715485572814944, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1028.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.904999999999828, "episode_len_mean": 256.6, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 46.5, -50.00000000000044, 40.10000000000002, 42.30000000000001, 45.1, -50.00000000000044, 25.699999999999925, 11.499999999999723, 38.10000000000002, 3.499999999999609, 43.30000000000001, -50.00000000000044, 42.30000000000001, 23.499999999999893, -50.00000000000044, 8.099999999999675, 28.499999999999964, 43.7, 19.09999999999983, 45.5, 38.10000000000002, -50.00000000000044, 42.500000000000014, 40.30000000000002, 46.9, 36.50000000000003, 45.9, 44.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.7, 44.7, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 21.89999999999987, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 9.499999999999694, 45.5, 27.299999999999947, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 39.50000000000002, 46.699999999999996, 38.90000000000002, 27.099999999999945, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 44.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, 34.50000000000004, 38.10000000000002, 32.30000000000002, 44.300000000000004, -50.00000000000044, 45.3, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 37.10000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.5, 45.1, -50.00000000000044, 37.50000000000003, 43.50000000000001, 39.70000000000002, 41.100000000000016, 27.099999999999945], "episode_lengths": [36, 36, 500, 100, 78, 50, 500, 244, 386, 120, 466, 68, 500, 78, 266, 500, 420, 216, 64, 310, 46, 120, 500, 76, 98, 32, 136, 42, 52, 60, 500, 500, 100, 64, 54, 500, 500, 204, 500, 500, 500, 36, 282, 500, 34, 46, 500, 48, 500, 60, 500, 500, 406, 46, 228, 36, 500, 500, 500, 500, 184, 106, 34, 112, 230, 500, 118, 500, 500, 500, 500, 262, 54, 500, 74, 500, 156, 120, 178, 58, 500, 48, 46, 500, 72, 500, 64, 500, 130, 500, 148, 500, 56, 50, 500, 126, 66, 104, 90, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924839707889356, "mean_inference_ms": 1.2631966218321908, "mean_action_processing_ms": 0.14781666869443502, "mean_env_wait_ms": 0.08721802236206053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030004262924194336, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.13654685020446777}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.904999999999828, "episode_len_mean": 256.6, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 46.5, -50.00000000000044, 40.10000000000002, 42.30000000000001, 45.1, -50.00000000000044, 25.699999999999925, 11.499999999999723, 38.10000000000002, 3.499999999999609, 43.30000000000001, -50.00000000000044, 42.30000000000001, 23.499999999999893, -50.00000000000044, 8.099999999999675, 28.499999999999964, 43.7, 19.09999999999983, 45.5, 38.10000000000002, -50.00000000000044, 42.500000000000014, 40.30000000000002, 46.9, 36.50000000000003, 45.9, 44.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.7, 44.7, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 21.89999999999987, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 9.499999999999694, 45.5, 27.299999999999947, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 39.50000000000002, 46.699999999999996, 38.90000000000002, 27.099999999999945, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 44.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, 34.50000000000004, 38.10000000000002, 32.30000000000002, 44.300000000000004, -50.00000000000044, 45.3, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 37.10000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.5, 45.1, -50.00000000000044, 37.50000000000003, 43.50000000000001, 39.70000000000002, 41.100000000000016, 27.099999999999945], "episode_lengths": [36, 36, 500, 100, 78, 50, 500, 244, 386, 120, 466, 68, 500, 78, 266, 500, 420, 216, 64, 310, 46, 120, 500, 76, 98, 32, 136, 42, 52, 60, 500, 500, 100, 64, 54, 500, 500, 204, 500, 500, 500, 36, 282, 500, 34, 46, 500, 48, 500, 60, 500, 500, 406, 46, 228, 36, 500, 500, 500, 500, 184, 106, 34, 112, 230, 500, 118, 500, 500, 500, 500, 262, 54, 500, 74, 500, 156, 120, 178, 58, 500, 48, 46, 500, 72, 500, 64, 500, 130, 500, 148, 500, 56, 50, 500, 126, 66, 104, 90, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924839707889356, "mean_inference_ms": 1.2631966218321908, "mean_action_processing_ms": 0.14781666869443502, "mean_env_wait_ms": 0.08721802236206053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030004262924194336, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.13654685020446777}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5385.478494743312, "num_env_steps_trained_throughput_per_sec": 5385.478494743312, "timesteps_total": 828000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 2203.287, "sample_time_ms": 1988.553, "load_time_ms": 10.494, "load_throughput": 1143485.278, "learn_time_ms": 194.134, "learn_throughput": 61812.892, "synch_weights_time_ms": 9.006}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3057, "training_iteration": 69, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-13", "timestamp": 1698247753, "time_this_iter_s": 2.2339844703674316, "time_total_s": 162.9420702457428, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 162.9420702457428, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 61.166666666666664, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3881317890172025e-22, "cur_lr": 0.0003, "total_loss": 7.107744916280111, "policy_loss": -1.7642229795455933e-05, "vf_loss": 7.107817808787028, "vf_explained_var": -2.0503997802734374e-06, "kl": 0.0003280007394891982, "entropy": 0.5534308234850566, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1043.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.815999999999859, "episode_len_mean": 232.54, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 31.70000000000001, 39.50000000000002, 46.699999999999996, 38.90000000000002, 27.099999999999945, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 44.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, 34.50000000000004, 38.10000000000002, 32.30000000000002, 44.300000000000004, -50.00000000000044, 45.3, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 37.10000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.5, 45.1, -50.00000000000044, 37.50000000000003, 43.50000000000001, 39.70000000000002, 41.100000000000016, 27.099999999999945, -50.00000000000044, 37.70000000000003, 1.8999999999995865, 25.099999999999916, 26.69999999999994, -50.00000000000044, 44.5, 44.5, 42.900000000000006, 40.90000000000002, 46.5, 45.1, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, -50.00000000000044, 24.69999999999991, 27.699999999999953, 37.90000000000003, 16.699999999999797, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.50000000000002, 43.30000000000001, 44.10000000000001, 32.90000000000003, 44.900000000000006, -50.00000000000044, 46.5, 42.10000000000001, 39.300000000000026, -50.00000000000044, 42.10000000000001, 44.5, 18.29999999999982, 40.90000000000002, -50.00000000000044, 41.500000000000014, 45.5, 42.70000000000001, 46.5, 45.7, 46.099999999999994, -50.00000000000044, 43.30000000000001, 28.89999999999997, 39.70000000000002, 38.700000000000024, 35.70000000000003, -50.00000000000044, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, 21.09999999999986], "episode_lengths": [500, 500, 184, 106, 34, 112, 230, 500, 118, 500, 500, 500, 500, 262, 54, 500, 74, 500, 156, 120, 178, 58, 500, 48, 46, 500, 72, 500, 64, 500, 130, 500, 148, 500, 56, 50, 500, 126, 66, 104, 90, 230, 500, 124, 482, 250, 234, 500, 56, 56, 72, 92, 36, 50, 500, 500, 72, 52, 500, 254, 224, 122, 334, 500, 500, 68, 106, 68, 60, 172, 52, 500, 36, 80, 108, 500, 80, 56, 318, 92, 500, 86, 46, 74, 36, 44, 40, 500, 68, 212, 104, 114, 144, 500, 78, 68, 500, 500, 128, 290]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3922813267695139, "mean_inference_ms": 1.2627056767362885, "mean_action_processing_ms": 0.1477105263047788, "mean_env_wait_ms": 0.08740261039506972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028227806091308594, "StateBufferConnector_ms": 0.00799870491027832, "ViewRequirementAgentConnector_ms": 0.1368722915649414}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.815999999999859, "episode_len_mean": 232.54, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 31.70000000000001, 39.50000000000002, 46.699999999999996, 38.90000000000002, 27.099999999999945, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 44.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, 34.50000000000004, 38.10000000000002, 32.30000000000002, 44.300000000000004, -50.00000000000044, 45.3, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 37.10000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.5, 45.1, -50.00000000000044, 37.50000000000003, 43.50000000000001, 39.70000000000002, 41.100000000000016, 27.099999999999945, -50.00000000000044, 37.70000000000003, 1.8999999999995865, 25.099999999999916, 26.69999999999994, -50.00000000000044, 44.5, 44.5, 42.900000000000006, 40.90000000000002, 46.5, 45.1, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, -50.00000000000044, 24.69999999999991, 27.699999999999953, 37.90000000000003, 16.699999999999797, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.50000000000002, 43.30000000000001, 44.10000000000001, 32.90000000000003, 44.900000000000006, -50.00000000000044, 46.5, 42.10000000000001, 39.300000000000026, -50.00000000000044, 42.10000000000001, 44.5, 18.29999999999982, 40.90000000000002, -50.00000000000044, 41.500000000000014, 45.5, 42.70000000000001, 46.5, 45.7, 46.099999999999994, -50.00000000000044, 43.30000000000001, 28.89999999999997, 39.70000000000002, 38.700000000000024, 35.70000000000003, -50.00000000000044, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, 21.09999999999986], "episode_lengths": [500, 500, 184, 106, 34, 112, 230, 500, 118, 500, 500, 500, 500, 262, 54, 500, 74, 500, 156, 120, 178, 58, 500, 48, 46, 500, 72, 500, 64, 500, 130, 500, 148, 500, 56, 50, 500, 126, 66, 104, 90, 230, 500, 124, 482, 250, 234, 500, 56, 56, 72, 92, 36, 50, 500, 500, 72, 52, 500, 254, 224, 122, 334, 500, 500, 68, 106, 68, 60, 172, 52, 500, 36, 80, 108, 500, 80, 56, 318, 92, 500, 86, 46, 74, 36, 44, 40, 500, 68, 212, 104, 114, 144, 500, 78, 68, 500, 500, 128, 290]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3922813267695139, "mean_inference_ms": 1.2627056767362885, "mean_action_processing_ms": 0.1477105263047788, "mean_env_wait_ms": 0.08740261039506972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028227806091308594, "StateBufferConnector_ms": 0.00799870491027832, "ViewRequirementAgentConnector_ms": 0.1368722915649414}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5304.112665654566, "num_env_steps_trained_throughput_per_sec": 5304.112665654566, "timesteps_total": 840000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 2198.116, "sample_time_ms": 1979.652, "load_time_ms": 9.966, "load_throughput": 1204143.861, "learn_time_ms": 198.664, "learn_throughput": 60403.496, "synch_weights_time_ms": 8.735}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 3115, "training_iteration": 70, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-15", "timestamp": 1698247755, "time_this_iter_s": 2.266568422317505, "time_total_s": 165.2086386680603, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 165.2086386680603, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 58.26666666666667, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6940658945086012e-22, "cur_lr": 0.0003, "total_loss": 7.47341168721517, "policy_loss": -0.00019194235404332478, "vf_loss": 7.47365550994873, "vf_explained_var": -1.5020370483398437e-06, "kl": 0.00015099224643790876, "entropy": 0.5180017113685608, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1058.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.94599999999987, "episode_len_mean": 221.28, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, -50.00000000000044, 24.69999999999991, 27.699999999999953, 37.90000000000003, 16.699999999999797, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.50000000000002, 43.30000000000001, 44.10000000000001, 32.90000000000003, 44.900000000000006, -50.00000000000044, 46.5, 42.10000000000001, 39.300000000000026, -50.00000000000044, 42.10000000000001, 44.5, 18.29999999999982, 40.90000000000002, -50.00000000000044, 41.500000000000014, 45.5, 42.70000000000001, 46.5, 45.7, 46.099999999999994, -50.00000000000044, 43.30000000000001, 28.89999999999997, 39.70000000000002, 38.700000000000024, 35.70000000000003, -50.00000000000044, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, 21.09999999999986, -50.00000000000044, 29.299999999999976, 43.900000000000006, 10.899999999999714, 39.50000000000002, 45.7, 44.300000000000004, 20.699999999999854, 44.300000000000004, 43.10000000000001, -50.00000000000044, 46.099999999999994, 36.70000000000003, -50.00000000000044, 44.10000000000001, 41.90000000000001, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.7, 45.7, 42.500000000000014, -50.00000000000044, 45.1, 38.300000000000026, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.30000000000001, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 45.7, 40.30000000000002, 38.700000000000024, 35.30000000000004, 40.90000000000002, 29.69999999999998, 44.900000000000006, 40.70000000000002, 44.7, 39.90000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.900000000000034, 25.499999999999922, 5.499999999999638, 22.899999999999885], "episode_lengths": [500, 500, 72, 52, 500, 254, 224, 122, 334, 500, 500, 68, 106, 68, 60, 172, 52, 500, 36, 80, 108, 500, 80, 56, 318, 92, 500, 86, 46, 74, 36, 44, 40, 500, 68, 212, 104, 114, 144, 500, 78, 68, 500, 500, 128, 290, 500, 208, 62, 392, 106, 44, 58, 294, 58, 70, 500, 40, 134, 500, 60, 82, 40, 500, 38, 500, 500, 102, 64, 44, 76, 500, 50, 118, 500, 286, 500, 500, 68, 78, 500, 480, 500, 44, 98, 114, 148, 92, 204, 52, 94, 54, 102, 72, 500, 500, 152, 246, 446, 272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39227136471679463, "mean_inference_ms": 1.2613335658687423, "mean_action_processing_ms": 0.14773489510528542, "mean_env_wait_ms": 0.08750041269286069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02226114273071289, "StateBufferConnector_ms": 0.00899648666381836, "ViewRequirementAgentConnector_ms": 0.13042902946472168}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.94599999999987, "episode_len_mean": 221.28, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, -50.00000000000044, 24.69999999999991, 27.699999999999953, 37.90000000000003, 16.699999999999797, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.50000000000002, 43.30000000000001, 44.10000000000001, 32.90000000000003, 44.900000000000006, -50.00000000000044, 46.5, 42.10000000000001, 39.300000000000026, -50.00000000000044, 42.10000000000001, 44.5, 18.29999999999982, 40.90000000000002, -50.00000000000044, 41.500000000000014, 45.5, 42.70000000000001, 46.5, 45.7, 46.099999999999994, -50.00000000000044, 43.30000000000001, 28.89999999999997, 39.70000000000002, 38.700000000000024, 35.70000000000003, -50.00000000000044, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, 21.09999999999986, -50.00000000000044, 29.299999999999976, 43.900000000000006, 10.899999999999714, 39.50000000000002, 45.7, 44.300000000000004, 20.699999999999854, 44.300000000000004, 43.10000000000001, -50.00000000000044, 46.099999999999994, 36.70000000000003, -50.00000000000044, 44.10000000000001, 41.90000000000001, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.7, 45.7, 42.500000000000014, -50.00000000000044, 45.1, 38.300000000000026, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.30000000000001, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 45.7, 40.30000000000002, 38.700000000000024, 35.30000000000004, 40.90000000000002, 29.69999999999998, 44.900000000000006, 40.70000000000002, 44.7, 39.90000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.900000000000034, 25.499999999999922, 5.499999999999638, 22.899999999999885], "episode_lengths": [500, 500, 72, 52, 500, 254, 224, 122, 334, 500, 500, 68, 106, 68, 60, 172, 52, 500, 36, 80, 108, 500, 80, 56, 318, 92, 500, 86, 46, 74, 36, 44, 40, 500, 68, 212, 104, 114, 144, 500, 78, 68, 500, 500, 128, 290, 500, 208, 62, 392, 106, 44, 58, 294, 58, 70, 500, 40, 134, 500, 60, 82, 40, 500, 38, 500, 500, 102, 64, 44, 76, 500, 50, 118, 500, 286, 500, 500, 68, 78, 500, 480, 500, 44, 98, 114, 148, 92, 204, 52, 94, 54, 102, 72, 500, 500, 152, 246, 446, 272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39227136471679463, "mean_inference_ms": 1.2613335658687423, "mean_action_processing_ms": 0.14773489510528542, "mean_env_wait_ms": 0.08750041269286069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02226114273071289, "StateBufferConnector_ms": 0.00899648666381836, "ViewRequirementAgentConnector_ms": 0.13042902946472168}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5466.793008121392, "num_env_steps_trained_throughput_per_sec": 5466.793008121392, "timesteps_total": 852000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 2200.603, "sample_time_ms": 1976.909, "load_time_ms": 10.064, "load_throughput": 1192348.373, "learn_time_ms": 202.973, "learn_throughput": 59121.092, "synch_weights_time_ms": 9.458}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 3169, "training_iteration": 71, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-18", "timestamp": 1698247758, "time_this_iter_s": 2.199071168899536, "time_total_s": 167.40770983695984, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 167.40770983695984, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 53.725, "ram_util_percent": 35.324999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543006e-23, "cur_lr": 0.0003, "total_loss": 6.337517642974854, "policy_loss": -5.396554867426554e-05, "vf_loss": 6.337622261047363, "vf_explained_var": -1.0291735331217447e-06, "kl": 0.00024353422032087716, "entropy": 0.5058969120184581, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1073.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.237999999999852, "episode_len_mean": 238.32, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.300000000000026, 21.09999999999986, -50.00000000000044, 29.299999999999976, 43.900000000000006, 10.899999999999714, 39.50000000000002, 45.7, 44.300000000000004, 20.699999999999854, 44.300000000000004, 43.10000000000001, -50.00000000000044, 46.099999999999994, 36.70000000000003, -50.00000000000044, 44.10000000000001, 41.90000000000001, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.7, 45.7, 42.500000000000014, -50.00000000000044, 45.1, 38.300000000000026, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.30000000000001, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 45.7, 40.30000000000002, 38.700000000000024, 35.30000000000004, 40.90000000000002, 29.69999999999998, 44.900000000000006, 40.70000000000002, 44.7, 39.90000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.900000000000034, 25.499999999999922, 5.499999999999638, 22.899999999999885, -50.00000000000044, 42.500000000000014, 36.30000000000003, 3.499999999999609, -50.00000000000044, 32.100000000000016, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.5, 34.70000000000004, 42.10000000000001, 46.9, 41.100000000000016, 38.300000000000026, -50.00000000000044, 43.50000000000001, 16.09999999999979, 42.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 47.5, 37.50000000000003, 43.30000000000001, 32.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, 38.10000000000002, -50.00000000000044, 40.90000000000002, 45.1, 37.90000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001], "episode_lengths": [128, 290, 500, 208, 62, 392, 106, 44, 58, 294, 58, 70, 500, 40, 134, 500, 60, 82, 40, 500, 38, 500, 500, 102, 64, 44, 76, 500, 50, 118, 500, 286, 500, 500, 68, 78, 500, 480, 500, 44, 98, 114, 148, 92, 204, 52, 94, 54, 102, 72, 500, 500, 152, 246, 446, 272, 500, 76, 138, 466, 500, 180, 50, 500, 40, 500, 500, 26, 154, 80, 32, 90, 118, 500, 66, 340, 78, 96, 500, 500, 500, 200, 500, 500, 26, 126, 68, 176, 500, 34, 500, 62, 120, 500, 92, 50, 122, 500, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924507764612559, "mean_inference_ms": 1.2610812239384497, "mean_action_processing_ms": 0.1477107160300929, "mean_env_wait_ms": 0.08745427994184957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020085811614990234, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.13468027114868164}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.237999999999852, "episode_len_mean": 238.32, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.300000000000026, 21.09999999999986, -50.00000000000044, 29.299999999999976, 43.900000000000006, 10.899999999999714, 39.50000000000002, 45.7, 44.300000000000004, 20.699999999999854, 44.300000000000004, 43.10000000000001, -50.00000000000044, 46.099999999999994, 36.70000000000003, -50.00000000000044, 44.10000000000001, 41.90000000000001, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.7, 45.7, 42.500000000000014, -50.00000000000044, 45.1, 38.300000000000026, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.30000000000001, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 45.7, 40.30000000000002, 38.700000000000024, 35.30000000000004, 40.90000000000002, 29.69999999999998, 44.900000000000006, 40.70000000000002, 44.7, 39.90000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.900000000000034, 25.499999999999922, 5.499999999999638, 22.899999999999885, -50.00000000000044, 42.500000000000014, 36.30000000000003, 3.499999999999609, -50.00000000000044, 32.100000000000016, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.5, 34.70000000000004, 42.10000000000001, 46.9, 41.100000000000016, 38.300000000000026, -50.00000000000044, 43.50000000000001, 16.09999999999979, 42.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 47.5, 37.50000000000003, 43.30000000000001, 32.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, 38.10000000000002, -50.00000000000044, 40.90000000000002, 45.1, 37.90000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001], "episode_lengths": [128, 290, 500, 208, 62, 392, 106, 44, 58, 294, 58, 70, 500, 40, 134, 500, 60, 82, 40, 500, 38, 500, 500, 102, 64, 44, 76, 500, 50, 118, 500, 286, 500, 500, 68, 78, 500, 480, 500, 44, 98, 114, 148, 92, 204, 52, 94, 54, 102, 72, 500, 500, 152, 246, 446, 272, 500, 76, 138, 466, 500, 180, 50, 500, 40, 500, 500, 26, 154, 80, 32, 90, 118, 500, 66, 340, 78, 96, 500, 500, 500, 200, 500, 500, 26, 126, 68, 176, 500, 34, 500, 62, 120, 500, 92, 50, 122, 500, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924507764612559, "mean_inference_ms": 1.2610812239384497, "mean_action_processing_ms": 0.1477107160300929, "mean_env_wait_ms": 0.08745427994184957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020085811614990234, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.13468027114868164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5115.042305187599, "num_env_steps_trained_throughput_per_sec": 5115.042305187599, "timesteps_total": 864000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 2206.689, "sample_time_ms": 1982.763, "load_time_ms": 10.182, "load_throughput": 1178533.917, "learn_time_ms": 203.083, "learn_throughput": 59089.262, "synch_weights_time_ms": 9.403}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3213, "training_iteration": 72, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-20", "timestamp": 1698247760, "time_this_iter_s": 2.3510162830352783, "time_total_s": 169.75872611999512, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 169.75872611999512, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 66.0, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.235164736271503e-23, "cur_lr": 0.0003, "total_loss": 7.130352306365967, "policy_loss": -4.579753925402959e-05, "vf_loss": 7.1304521560668945, "vf_explained_var": -8.106231689453125e-07, "kl": 0.00022919684234542123, "entropy": 0.5407671968142191, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1088.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.745999999999828, "episode_len_mean": 263.2, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 39.90000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.900000000000034, 25.499999999999922, 5.499999999999638, 22.899999999999885, -50.00000000000044, 42.500000000000014, 36.30000000000003, 3.499999999999609, -50.00000000000044, 32.100000000000016, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.5, 34.70000000000004, 42.10000000000001, 46.9, 41.100000000000016, 38.300000000000026, -50.00000000000044, 43.50000000000001, 16.09999999999979, 42.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 47.5, 37.50000000000003, 43.30000000000001, 32.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, 38.10000000000002, -50.00000000000044, 40.90000000000002, 45.1, 37.90000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 27.899999999999956, 0.8999999999995723, -50.00000000000044, 46.699999999999996, 42.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 44.5, 44.7, 38.50000000000003, 45.1, 33.30000000000003, 40.10000000000002, 33.90000000000004, 41.100000000000016, 38.700000000000024, 42.70000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 21.699999999999868, -50.00000000000044, 13.099999999999746, -50.00000000000044, 30.099999999999987, 45.1, 41.500000000000014, 44.5, -50.00000000000044, 22.49999999999988, 46.099999999999994, 2.499999999999595, 29.299999999999976, 36.70000000000003], "episode_lengths": [54, 102, 72, 500, 500, 152, 246, 446, 272, 500, 76, 138, 466, 500, 180, 50, 500, 40, 500, 500, 26, 154, 80, 32, 90, 118, 500, 66, 340, 78, 96, 500, 500, 500, 200, 500, 500, 26, 126, 68, 176, 500, 34, 500, 62, 120, 500, 92, 50, 122, 500, 500, 66, 500, 500, 266, 78, 500, 500, 42, 222, 492, 500, 34, 78, 52, 500, 500, 500, 500, 500, 214, 500, 56, 54, 116, 50, 168, 100, 162, 90, 114, 74, 500, 500, 162, 284, 500, 370, 500, 200, 50, 86, 56, 500, 276, 40, 476, 208, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3926880044436477, "mean_inference_ms": 1.2629354470664962, "mean_action_processing_ms": 0.14802019900127622, "mean_env_wait_ms": 0.0871913617498895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029360532760620117, "StateBufferConnector_ms": 0.005514621734619141, "ViewRequirementAgentConnector_ms": 0.11649465560913086}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.745999999999828, "episode_len_mean": 263.2, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 39.90000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.900000000000034, 25.499999999999922, 5.499999999999638, 22.899999999999885, -50.00000000000044, 42.500000000000014, 36.30000000000003, 3.499999999999609, -50.00000000000044, 32.100000000000016, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.5, 34.70000000000004, 42.10000000000001, 46.9, 41.100000000000016, 38.300000000000026, -50.00000000000044, 43.50000000000001, 16.09999999999979, 42.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 47.5, 37.50000000000003, 43.30000000000001, 32.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, 38.10000000000002, -50.00000000000044, 40.90000000000002, 45.1, 37.90000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 27.899999999999956, 0.8999999999995723, -50.00000000000044, 46.699999999999996, 42.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 44.5, 44.7, 38.50000000000003, 45.1, 33.30000000000003, 40.10000000000002, 33.90000000000004, 41.100000000000016, 38.700000000000024, 42.70000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 21.699999999999868, -50.00000000000044, 13.099999999999746, -50.00000000000044, 30.099999999999987, 45.1, 41.500000000000014, 44.5, -50.00000000000044, 22.49999999999988, 46.099999999999994, 2.499999999999595, 29.299999999999976, 36.70000000000003], "episode_lengths": [54, 102, 72, 500, 500, 152, 246, 446, 272, 500, 76, 138, 466, 500, 180, 50, 500, 40, 500, 500, 26, 154, 80, 32, 90, 118, 500, 66, 340, 78, 96, 500, 500, 500, 200, 500, 500, 26, 126, 68, 176, 500, 34, 500, 62, 120, 500, 92, 50, 122, 500, 500, 66, 500, 500, 266, 78, 500, 500, 42, 222, 492, 500, 34, 78, 52, 500, 500, 500, 500, 500, 214, 500, 56, 54, 116, 50, 168, 100, 162, 90, 114, 74, 500, 500, 162, 284, 500, 370, 500, 200, 50, 86, 56, 500, 276, 40, 476, 208, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3926880044436477, "mean_inference_ms": 1.2629354470664962, "mean_action_processing_ms": 0.14802019900127622, "mean_env_wait_ms": 0.0871913617498895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029360532760620117, "StateBufferConnector_ms": 0.005514621734619141, "ViewRequirementAgentConnector_ms": 0.11649465560913086}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5620.577541497164, "num_env_steps_trained_throughput_per_sec": 5620.577541497164, "timesteps_total": 876000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 2194.769, "sample_time_ms": 1984.094, "load_time_ms": 9.981, "load_throughput": 1202259.878, "learn_time_ms": 190.129, "learn_throughput": 63114.91, "synch_weights_time_ms": 9.406}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 3260, "training_iteration": 73, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-22", "timestamp": 1698247762, "time_this_iter_s": 2.141011953353882, "time_total_s": 171.899738073349, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 171.899738073349, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 60.06666666666666, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357516e-23, "cur_lr": 0.0003, "total_loss": 6.694769032796224, "policy_loss": -0.0002870496362447739, "vf_loss": 6.695109049479167, "vf_explained_var": -2.0265579223632812e-06, "kl": 0.0006049314411257, "entropy": 0.5305322686831156, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1103.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.532999999999812, "episode_len_mean": 280.3, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.5, 37.50000000000003, 43.30000000000001, 32.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, 38.10000000000002, -50.00000000000044, 40.90000000000002, 45.1, 37.90000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 27.899999999999956, 0.8999999999995723, -50.00000000000044, 46.699999999999996, 42.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 44.5, 44.7, 38.50000000000003, 45.1, 33.30000000000003, 40.10000000000002, 33.90000000000004, 41.100000000000016, 38.700000000000024, 42.70000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 21.699999999999868, -50.00000000000044, 13.099999999999746, -50.00000000000044, 30.099999999999987, 45.1, 41.500000000000014, 44.5, -50.00000000000044, 22.49999999999988, 46.099999999999994, 2.499999999999595, 29.299999999999976, 36.70000000000003, -50.00000000000044, -50.00000000000044, 4.499999999999623, 27.49999999999995, 0.49999999999956657, 0.2999999999995637, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 26.89999999999994, 32.30000000000002, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 45.7, 44.10000000000001, 41.100000000000016, 40.30000000000002, -50.00000000000044, 44.900000000000006, 37.90000000000003, 40.30000000000002, 31.500000000000007, 38.10000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.5, -50.00000000000044], "episode_lengths": [26, 126, 68, 176, 500, 34, 500, 62, 120, 500, 92, 50, 122, 500, 500, 66, 500, 500, 266, 78, 500, 500, 42, 222, 492, 500, 34, 78, 52, 500, 500, 500, 500, 500, 214, 500, 56, 54, 116, 50, 168, 100, 162, 90, 114, 74, 500, 500, 162, 284, 500, 370, 500, 200, 50, 86, 56, 500, 276, 40, 476, 208, 134, 500, 500, 456, 226, 496, 498, 500, 500, 58, 500, 500, 302, 500, 500, 66, 500, 232, 178, 500, 500, 256, 500, 44, 60, 90, 98, 500, 52, 122, 98, 186, 120, 500, 90, 500, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39302774668795637, "mean_inference_ms": 1.2633319206396978, "mean_action_processing_ms": 0.1480093563218962, "mean_env_wait_ms": 0.0871364608638345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03248405456542969, "StateBufferConnector_ms": 0.0055158138275146484, "ViewRequirementAgentConnector_ms": 0.11820411682128906}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.532999999999812, "episode_len_mean": 280.3, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.5, 37.50000000000003, 43.30000000000001, 32.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, 38.10000000000002, -50.00000000000044, 40.90000000000002, 45.1, 37.90000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 27.899999999999956, 0.8999999999995723, -50.00000000000044, 46.699999999999996, 42.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 44.5, 44.7, 38.50000000000003, 45.1, 33.30000000000003, 40.10000000000002, 33.90000000000004, 41.100000000000016, 38.700000000000024, 42.70000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 21.699999999999868, -50.00000000000044, 13.099999999999746, -50.00000000000044, 30.099999999999987, 45.1, 41.500000000000014, 44.5, -50.00000000000044, 22.49999999999988, 46.099999999999994, 2.499999999999595, 29.299999999999976, 36.70000000000003, -50.00000000000044, -50.00000000000044, 4.499999999999623, 27.49999999999995, 0.49999999999956657, 0.2999999999995637, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 26.89999999999994, 32.30000000000002, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 45.7, 44.10000000000001, 41.100000000000016, 40.30000000000002, -50.00000000000044, 44.900000000000006, 37.90000000000003, 40.30000000000002, 31.500000000000007, 38.10000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.5, -50.00000000000044], "episode_lengths": [26, 126, 68, 176, 500, 34, 500, 62, 120, 500, 92, 50, 122, 500, 500, 66, 500, 500, 266, 78, 500, 500, 42, 222, 492, 500, 34, 78, 52, 500, 500, 500, 500, 500, 214, 500, 56, 54, 116, 50, 168, 100, 162, 90, 114, 74, 500, 500, 162, 284, 500, 370, 500, 200, 50, 86, 56, 500, 276, 40, 476, 208, 134, 500, 500, 456, 226, 496, 498, 500, 500, 58, 500, 500, 302, 500, 500, 66, 500, 232, 178, 500, 500, 256, 500, 44, 60, 90, 98, 500, 52, 122, 98, 186, 120, 500, 90, 500, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39302774668795637, "mean_inference_ms": 1.2633319206396978, "mean_action_processing_ms": 0.1480093563218962, "mean_env_wait_ms": 0.0871364608638345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03248405456542969, "StateBufferConnector_ms": 0.0055158138275146484, "ViewRequirementAgentConnector_ms": 0.11820411682128906}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5414.982237008368, "num_env_steps_trained_throughput_per_sec": 5414.982237008368, "timesteps_total": 888000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 2205.859, "sample_time_ms": 1995.18, "load_time_ms": 10.154, "load_throughput": 1181799.244, "learn_time_ms": 190.138, "learn_throughput": 63112.196, "synch_weights_time_ms": 9.328}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 3297, "training_iteration": 74, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-25", "timestamp": 1698247765, "time_this_iter_s": 2.3088111877441406, "time_total_s": 174.20854926109314, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 174.20854926109314, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 65.06666666666666, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678758e-23, "cur_lr": 0.0003, "total_loss": 6.496070353190104, "policy_loss": -1.4046827952067057e-06, "vf_loss": 6.496122805277507, "vf_explained_var": -5.642573038736979e-07, "kl": 4.0243610222508626e-05, "entropy": 0.5109853665033977, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1118.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8469999999997944, "episode_len_mean": 297.14, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 44.7, 38.50000000000003, 45.1, 33.30000000000003, 40.10000000000002, 33.90000000000004, 41.100000000000016, 38.700000000000024, 42.70000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 21.699999999999868, -50.00000000000044, 13.099999999999746, -50.00000000000044, 30.099999999999987, 45.1, 41.500000000000014, 44.5, -50.00000000000044, 22.49999999999988, 46.099999999999994, 2.499999999999595, 29.299999999999976, 36.70000000000003, -50.00000000000044, -50.00000000000044, 4.499999999999623, 27.49999999999995, 0.49999999999956657, 0.2999999999995637, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 26.89999999999994, 32.30000000000002, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 45.7, 44.10000000000001, 41.100000000000016, 40.30000000000002, -50.00000000000044, 44.900000000000006, 37.90000000000003, 40.30000000000002, 31.500000000000007, 38.10000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 10.299999999999706, -50.00000000000044, 8.299999999999677, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 41.30000000000001, 46.699999999999996, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 40.30000000000002, 35.70000000000003, -50.00000000000044, 16.29999999999979, 26.299999999999933, 37.50000000000003, 29.69999999999998, 44.300000000000004], "episode_lengths": [56, 54, 116, 50, 168, 100, 162, 90, 114, 74, 500, 500, 162, 284, 500, 370, 500, 200, 50, 86, 56, 500, 276, 40, 476, 208, 134, 500, 500, 456, 226, 496, 498, 500, 500, 58, 500, 500, 302, 500, 500, 66, 500, 232, 178, 500, 500, 256, 500, 44, 60, 90, 98, 500, 52, 122, 98, 186, 120, 500, 90, 500, 56, 500, 500, 398, 500, 418, 132, 500, 500, 500, 500, 60, 500, 66, 500, 60, 500, 500, 486, 88, 34, 500, 114, 500, 500, 500, 500, 42, 500, 500, 98, 144, 500, 338, 238, 126, 204, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39307242863414543, "mean_inference_ms": 1.2641397891792678, "mean_action_processing_ms": 0.14795366632018792, "mean_env_wait_ms": 0.08721464889372171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026558637619018555, "StateBufferConnector_ms": 0.005010366439819336, "ViewRequirementAgentConnector_ms": 0.12238025665283203}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8469999999997944, "episode_len_mean": 297.14, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 44.7, 38.50000000000003, 45.1, 33.30000000000003, 40.10000000000002, 33.90000000000004, 41.100000000000016, 38.700000000000024, 42.70000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 21.699999999999868, -50.00000000000044, 13.099999999999746, -50.00000000000044, 30.099999999999987, 45.1, 41.500000000000014, 44.5, -50.00000000000044, 22.49999999999988, 46.099999999999994, 2.499999999999595, 29.299999999999976, 36.70000000000003, -50.00000000000044, -50.00000000000044, 4.499999999999623, 27.49999999999995, 0.49999999999956657, 0.2999999999995637, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 26.89999999999994, 32.30000000000002, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 45.7, 44.10000000000001, 41.100000000000016, 40.30000000000002, -50.00000000000044, 44.900000000000006, 37.90000000000003, 40.30000000000002, 31.500000000000007, 38.10000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 10.299999999999706, -50.00000000000044, 8.299999999999677, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 41.30000000000001, 46.699999999999996, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 40.30000000000002, 35.70000000000003, -50.00000000000044, 16.29999999999979, 26.299999999999933, 37.50000000000003, 29.69999999999998, 44.300000000000004], "episode_lengths": [56, 54, 116, 50, 168, 100, 162, 90, 114, 74, 500, 500, 162, 284, 500, 370, 500, 200, 50, 86, 56, 500, 276, 40, 476, 208, 134, 500, 500, 456, 226, 496, 498, 500, 500, 58, 500, 500, 302, 500, 500, 66, 500, 232, 178, 500, 500, 256, 500, 44, 60, 90, 98, 500, 52, 122, 98, 186, 120, 500, 90, 500, 56, 500, 500, 398, 500, 418, 132, 500, 500, 500, 500, 60, 500, 66, 500, 60, 500, 500, 486, 88, 34, 500, 114, 500, 500, 500, 500, 42, 500, 500, 98, 144, 500, 338, 238, 126, 204, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39307242863414543, "mean_inference_ms": 1.2641397891792678, "mean_action_processing_ms": 0.14795366632018792, "mean_env_wait_ms": 0.08721464889372171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026558637619018555, "StateBufferConnector_ms": 0.005010366439819336, "ViewRequirementAgentConnector_ms": 0.12238025665283203}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4130.197483936207, "num_env_steps_trained_throughput_per_sec": 4130.197483936207, "timesteps_total": 900000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 2281.867, "sample_time_ms": 1999.359, "load_time_ms": 10.216, "load_throughput": 1174617.334, "learn_time_ms": 185.338, "learn_throughput": 64746.664, "synch_weights_time_ms": 85.811}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3333, "training_iteration": 75, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-28", "timestamp": 1698247768, "time_this_iter_s": 2.9104316234588623, "time_total_s": 177.118980884552, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 177.118980884552, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 57.0, "ram_util_percent": 35.324999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339379e-24, "cur_lr": 0.0003, "total_loss": 6.573880545298258, "policy_loss": -0.0005235880613327027, "vf_loss": 6.5744572957356775, "vf_explained_var": -1.0251998901367187e-06, "kl": 0.000638968420191599, "entropy": 0.530886709690094, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1133.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.12099999999979694, "episode_len_mean": 294.38, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 26.89999999999994, 32.30000000000002, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 45.7, 44.10000000000001, 41.100000000000016, 40.30000000000002, -50.00000000000044, 44.900000000000006, 37.90000000000003, 40.30000000000002, 31.500000000000007, 38.10000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 10.299999999999706, -50.00000000000044, 8.299999999999677, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 41.30000000000001, 46.699999999999996, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 40.30000000000002, 35.70000000000003, -50.00000000000044, 16.29999999999979, 26.299999999999933, 37.50000000000003, 29.69999999999998, 44.300000000000004, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 39.90000000000002, 31.300000000000004, 22.299999999999876, 44.900000000000006, 41.500000000000014, 43.10000000000001, 43.10000000000001, 8.299999999999677, 45.3, 37.50000000000003, 34.50000000000004, 4.699999999999626, -50.00000000000044, 47.1, 35.900000000000034, 41.70000000000002, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 42.900000000000006, 33.90000000000004, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 40.30000000000002, 41.30000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.90000000000002, 4.299999999999621, 43.900000000000006, -50.00000000000044], "episode_lengths": [500, 232, 178, 500, 500, 256, 500, 44, 60, 90, 98, 500, 52, 122, 98, 186, 120, 500, 90, 500, 56, 500, 500, 398, 500, 418, 132, 500, 500, 500, 500, 60, 500, 66, 500, 60, 500, 500, 486, 88, 34, 500, 114, 500, 500, 500, 500, 42, 500, 500, 98, 144, 500, 338, 238, 126, 204, 58, 500, 500, 260, 500, 102, 188, 278, 52, 86, 70, 70, 418, 48, 126, 156, 454, 500, 30, 142, 84, 500, 200, 500, 500, 72, 162, 220, 500, 500, 500, 500, 46, 98, 88, 500, 90, 500, 500, 92, 458, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39280272194085347, "mean_inference_ms": 1.2637728893108728, "mean_action_processing_ms": 0.14777122850923793, "mean_env_wait_ms": 0.0873724072893235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017000913619995117, "StateBufferConnector_ms": 0.005509138107299805, "ViewRequirementAgentConnector_ms": 0.13404035568237305}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.12099999999979694, "episode_len_mean": 294.38, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 26.89999999999994, 32.30000000000002, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 45.7, 44.10000000000001, 41.100000000000016, 40.30000000000002, -50.00000000000044, 44.900000000000006, 37.90000000000003, 40.30000000000002, 31.500000000000007, 38.10000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 10.299999999999706, -50.00000000000044, 8.299999999999677, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 41.30000000000001, 46.699999999999996, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 40.30000000000002, 35.70000000000003, -50.00000000000044, 16.29999999999979, 26.299999999999933, 37.50000000000003, 29.69999999999998, 44.300000000000004, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 39.90000000000002, 31.300000000000004, 22.299999999999876, 44.900000000000006, 41.500000000000014, 43.10000000000001, 43.10000000000001, 8.299999999999677, 45.3, 37.50000000000003, 34.50000000000004, 4.699999999999626, -50.00000000000044, 47.1, 35.900000000000034, 41.70000000000002, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 42.900000000000006, 33.90000000000004, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 40.30000000000002, 41.30000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.90000000000002, 4.299999999999621, 43.900000000000006, -50.00000000000044], "episode_lengths": [500, 232, 178, 500, 500, 256, 500, 44, 60, 90, 98, 500, 52, 122, 98, 186, 120, 500, 90, 500, 56, 500, 500, 398, 500, 418, 132, 500, 500, 500, 500, 60, 500, 66, 500, 60, 500, 500, 486, 88, 34, 500, 114, 500, 500, 500, 500, 42, 500, 500, 98, 144, 500, 338, 238, 126, 204, 58, 500, 500, 260, 500, 102, 188, 278, 52, 86, 70, 70, 418, 48, 126, 156, 454, 500, 30, 142, 84, 500, 200, 500, 500, 72, 162, 220, 500, 500, 500, 500, 46, 98, 88, 500, 90, 500, 500, 92, 458, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39280272194085347, "mean_inference_ms": 1.2637728893108728, "mean_action_processing_ms": 0.14777122850923793, "mean_env_wait_ms": 0.0873724072893235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017000913619995117, "StateBufferConnector_ms": 0.005509138107299805, "ViewRequirementAgentConnector_ms": 0.13404035568237305}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5411.931838342835, "num_env_steps_trained_throughput_per_sec": 5411.931838342835, "timesteps_total": 912000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 2287.045, "sample_time_ms": 1983.483, "load_time_ms": 10.899, "load_throughput": 1101055.036, "learn_time_ms": 205.654, "learn_throughput": 58350.318, "synch_weights_time_ms": 85.965}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 3375, "training_iteration": 76, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-30", "timestamp": 1698247770, "time_this_iter_s": 2.222914934158325, "time_total_s": 179.34189581871033, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 179.34189581871033, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 45.65, "ram_util_percent": 35.324999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.6469779601696894e-24, "cur_lr": 0.0003, "total_loss": 7.195244820912679, "policy_loss": 0.0001655682921409607, "vf_loss": 7.195130411783854, "vf_explained_var": -1.4781951904296875e-06, "kl": 0.00020215654381748512, "entropy": 0.5132654090722402, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1148.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.785999999999836, "episode_len_mean": 252.82, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.29999999999979, 26.299999999999933, 37.50000000000003, 29.69999999999998, 44.300000000000004, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 39.90000000000002, 31.300000000000004, 22.299999999999876, 44.900000000000006, 41.500000000000014, 43.10000000000001, 43.10000000000001, 8.299999999999677, 45.3, 37.50000000000003, 34.50000000000004, 4.699999999999626, -50.00000000000044, 47.1, 35.900000000000034, 41.70000000000002, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 42.900000000000006, 33.90000000000004, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 40.30000000000002, 41.30000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.90000000000002, 4.299999999999621, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.10000000000001, 37.70000000000003, 46.099999999999994, 38.50000000000003, -50.00000000000044, 41.100000000000016, 42.70000000000001, 46.3, 45.3, 40.500000000000014, 44.10000000000001, -50.00000000000044, 4.299999999999621, 45.1, 41.500000000000014, 38.10000000000002, 46.3, 43.50000000000001, -50.00000000000044, 42.500000000000014, 30.699999999999996, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.10000000000001, 45.3, -50.00000000000044, 41.100000000000016, 45.3, -50.00000000000044, 38.300000000000026, 43.900000000000006, 42.500000000000014, 42.30000000000001, 42.70000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 6.099999999999646, 19.499999999999837, -50.00000000000044, 32.90000000000003, 14.299999999999763, -50.00000000000044, -50.00000000000044], "episode_lengths": [338, 238, 126, 204, 58, 500, 500, 260, 500, 102, 188, 278, 52, 86, 70, 70, 418, 48, 126, 156, 454, 500, 30, 142, 84, 500, 200, 500, 500, 72, 162, 220, 500, 500, 500, 500, 46, 98, 88, 500, 90, 500, 500, 92, 458, 62, 500, 500, 500, 52, 500, 500, 80, 124, 40, 116, 500, 90, 74, 38, 48, 96, 60, 500, 458, 50, 86, 120, 38, 66, 500, 76, 194, 82, 500, 500, 94, 60, 48, 500, 90, 48, 500, 118, 62, 76, 78, 74, 500, 88, 500, 500, 66, 440, 306, 500, 172, 358, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924847056679197, "mean_inference_ms": 1.2628508343045568, "mean_action_processing_ms": 0.14779759705215606, "mean_env_wait_ms": 0.08760460783193935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999380111694336, "StateBufferConnector_ms": 0.009508371353149414, "ViewRequirementAgentConnector_ms": 0.11454582214355469}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.785999999999836, "episode_len_mean": 252.82, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.29999999999979, 26.299999999999933, 37.50000000000003, 29.69999999999998, 44.300000000000004, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 39.90000000000002, 31.300000000000004, 22.299999999999876, 44.900000000000006, 41.500000000000014, 43.10000000000001, 43.10000000000001, 8.299999999999677, 45.3, 37.50000000000003, 34.50000000000004, 4.699999999999626, -50.00000000000044, 47.1, 35.900000000000034, 41.70000000000002, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 42.900000000000006, 33.90000000000004, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 40.30000000000002, 41.30000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.90000000000002, 4.299999999999621, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.10000000000001, 37.70000000000003, 46.099999999999994, 38.50000000000003, -50.00000000000044, 41.100000000000016, 42.70000000000001, 46.3, 45.3, 40.500000000000014, 44.10000000000001, -50.00000000000044, 4.299999999999621, 45.1, 41.500000000000014, 38.10000000000002, 46.3, 43.50000000000001, -50.00000000000044, 42.500000000000014, 30.699999999999996, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.10000000000001, 45.3, -50.00000000000044, 41.100000000000016, 45.3, -50.00000000000044, 38.300000000000026, 43.900000000000006, 42.500000000000014, 42.30000000000001, 42.70000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 6.099999999999646, 19.499999999999837, -50.00000000000044, 32.90000000000003, 14.299999999999763, -50.00000000000044, -50.00000000000044], "episode_lengths": [338, 238, 126, 204, 58, 500, 500, 260, 500, 102, 188, 278, 52, 86, 70, 70, 418, 48, 126, 156, 454, 500, 30, 142, 84, 500, 200, 500, 500, 72, 162, 220, 500, 500, 500, 500, 46, 98, 88, 500, 90, 500, 500, 92, 458, 62, 500, 500, 500, 52, 500, 500, 80, 124, 40, 116, 500, 90, 74, 38, 48, 96, 60, 500, 458, 50, 86, 120, 38, 66, 500, 76, 194, 82, 500, 500, 94, 60, 48, 500, 90, 48, 500, 118, 62, 76, 78, 74, 500, 88, 500, 500, 66, 440, 306, 500, 172, 358, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924847056679197, "mean_inference_ms": 1.2628508343045568, "mean_action_processing_ms": 0.14779759705215606, "mean_env_wait_ms": 0.08760460783193935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999380111694336, "StateBufferConnector_ms": 0.009508371353149414, "ViewRequirementAgentConnector_ms": 0.11454582214355469}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5355.905791499382, "num_env_steps_trained_throughput_per_sec": 5355.905791499382, "timesteps_total": 924000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 2294.199, "sample_time_ms": 1987.853, "load_time_ms": 10.898, "load_throughput": 1101069.488, "learn_time_ms": 208.357, "learn_throughput": 57593.47, "synch_weights_time_ms": 86.046}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 3428, "training_iteration": 77, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-32", "timestamp": 1698247772, "time_this_iter_s": 2.246516227722168, "time_total_s": 181.5884120464325, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 181.5884120464325, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 63.166666666666664, "ram_util_percent": 35.333333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848447e-24, "cur_lr": 0.0003, "total_loss": 6.288088544209798, "policy_loss": 2.045184373855591e-06, "vf_loss": 6.288139533996582, "vf_explained_var": -8.662541707356771e-07, "kl": 1.2162558990288138e-05, "entropy": 0.5295417110125223, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1163.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.462999999999821, "episode_len_mean": 261.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, -50.00000000000044, 40.90000000000002, 4.299999999999621, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.10000000000001, 37.70000000000003, 46.099999999999994, 38.50000000000003, -50.00000000000044, 41.100000000000016, 42.70000000000001, 46.3, 45.3, 40.500000000000014, 44.10000000000001, -50.00000000000044, 4.299999999999621, 45.1, 41.500000000000014, 38.10000000000002, 46.3, 43.50000000000001, -50.00000000000044, 42.500000000000014, 30.699999999999996, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.10000000000001, 45.3, -50.00000000000044, 41.100000000000016, 45.3, -50.00000000000044, 38.300000000000026, 43.900000000000006, 42.500000000000014, 42.30000000000001, 42.70000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 6.099999999999646, 19.499999999999837, -50.00000000000044, 32.90000000000003, 14.299999999999763, -50.00000000000044, -50.00000000000044, 38.300000000000026, 46.099999999999994, 39.90000000000002, -50.00000000000044, 44.7, 42.500000000000014, -50.00000000000044, 43.30000000000001, 23.499999999999893, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.10000000000001, 35.30000000000004, 33.30000000000003, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.500000000000014, 39.300000000000026, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.10000000000001, 27.899999999999956, -50.00000000000044, 34.50000000000004, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697], "episode_lengths": [90, 500, 500, 92, 458, 62, 500, 500, 500, 52, 500, 500, 80, 124, 40, 116, 500, 90, 74, 38, 48, 96, 60, 500, 458, 50, 86, 120, 38, 66, 500, 76, 194, 82, 500, 500, 94, 60, 48, 500, 90, 48, 500, 118, 62, 76, 78, 74, 500, 88, 500, 500, 66, 440, 306, 500, 172, 358, 500, 500, 118, 40, 102, 500, 54, 76, 500, 68, 266, 72, 500, 500, 92, 60, 148, 168, 162, 500, 500, 500, 500, 500, 70, 76, 108, 500, 76, 500, 500, 500, 68, 70, 222, 500, 156, 56, 500, 500, 500, 404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39267827068022426, "mean_inference_ms": 1.2625398017518865, "mean_action_processing_ms": 0.14808255273349008, "mean_env_wait_ms": 0.0875056473330547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0310056209564209, "StateBufferConnector_ms": 0.009998559951782227, "ViewRequirementAgentConnector_ms": 0.10425901412963867}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.462999999999821, "episode_len_mean": 261.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, -50.00000000000044, 40.90000000000002, 4.299999999999621, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.10000000000001, 37.70000000000003, 46.099999999999994, 38.50000000000003, -50.00000000000044, 41.100000000000016, 42.70000000000001, 46.3, 45.3, 40.500000000000014, 44.10000000000001, -50.00000000000044, 4.299999999999621, 45.1, 41.500000000000014, 38.10000000000002, 46.3, 43.50000000000001, -50.00000000000044, 42.500000000000014, 30.699999999999996, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.10000000000001, 45.3, -50.00000000000044, 41.100000000000016, 45.3, -50.00000000000044, 38.300000000000026, 43.900000000000006, 42.500000000000014, 42.30000000000001, 42.70000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 6.099999999999646, 19.499999999999837, -50.00000000000044, 32.90000000000003, 14.299999999999763, -50.00000000000044, -50.00000000000044, 38.300000000000026, 46.099999999999994, 39.90000000000002, -50.00000000000044, 44.7, 42.500000000000014, -50.00000000000044, 43.30000000000001, 23.499999999999893, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.10000000000001, 35.30000000000004, 33.30000000000003, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.500000000000014, 39.300000000000026, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.10000000000001, 27.899999999999956, -50.00000000000044, 34.50000000000004, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697], "episode_lengths": [90, 500, 500, 92, 458, 62, 500, 500, 500, 52, 500, 500, 80, 124, 40, 116, 500, 90, 74, 38, 48, 96, 60, 500, 458, 50, 86, 120, 38, 66, 500, 76, 194, 82, 500, 500, 94, 60, 48, 500, 90, 48, 500, 118, 62, 76, 78, 74, 500, 88, 500, 500, 66, 440, 306, 500, 172, 358, 500, 500, 118, 40, 102, 500, 54, 76, 500, 68, 266, 72, 500, 500, 92, 60, 148, 168, 162, 500, 500, 500, 500, 500, 70, 76, 108, 500, 76, 500, 500, 500, 68, 70, 222, 500, 156, 56, 500, 500, 500, 404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39267827068022426, "mean_inference_ms": 1.2625398017518865, "mean_action_processing_ms": 0.14808255273349008, "mean_env_wait_ms": 0.0875056473330547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0310056209564209, "StateBufferConnector_ms": 0.009998559951782227, "ViewRequirementAgentConnector_ms": 0.10425901412963867}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5145.71233475704, "num_env_steps_trained_throughput_per_sec": 5145.71233475704, "timesteps_total": 936000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 2307.71, "sample_time_ms": 1996.596, "load_time_ms": 10.755, "load_throughput": 1115783.35, "learn_time_ms": 213.341, "learn_throughput": 56247.916, "synch_weights_time_ms": 86.073}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3468, "training_iteration": 78, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-34", "timestamp": 1698247774, "time_this_iter_s": 2.338107109069824, "time_total_s": 183.92651915550232, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 183.92651915550232, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 64.23333333333333, "ram_util_percent": 35.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424224e-25, "cur_lr": 0.0003, "total_loss": 6.774583244323731, "policy_loss": -4.0969997644424436e-05, "vf_loss": 6.77467565536499, "vf_explained_var": -4.3710072835286457e-07, "kl": 0.00019586818632954343, "entropy": 0.5138036449750264, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1178.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.017999999999808, "episode_len_mean": 280.44, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 6.099999999999646, 19.499999999999837, -50.00000000000044, 32.90000000000003, 14.299999999999763, -50.00000000000044, -50.00000000000044, 38.300000000000026, 46.099999999999994, 39.90000000000002, -50.00000000000044, 44.7, 42.500000000000014, -50.00000000000044, 43.30000000000001, 23.499999999999893, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.10000000000001, 35.30000000000004, 33.30000000000003, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.500000000000014, 39.300000000000026, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.10000000000001, 27.899999999999956, -50.00000000000044, 34.50000000000004, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, 14.899999999999771, 34.30000000000004, 41.30000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.900000000000006, 44.10000000000001, 39.300000000000026, 8.299999999999677, 41.90000000000001, 33.500000000000036, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, 16.29999999999979, 18.699999999999825, 29.69999999999998, 14.09999999999976, 44.7, 46.099999999999994, 45.9, -50.00000000000044, 42.10000000000001, -50.00000000000044, 46.099999999999994, 44.900000000000006, 6.299999999999649, 39.70000000000002, -50.00000000000044, 17.69999999999981, -50.00000000000044, 17.299999999999805, 45.7, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.10000000000001, 41.30000000000001], "episode_lengths": [74, 500, 88, 500, 500, 66, 440, 306, 500, 172, 358, 500, 500, 118, 40, 102, 500, 54, 76, 500, 68, 266, 72, 500, 500, 92, 60, 148, 168, 162, 500, 500, 500, 500, 500, 70, 76, 108, 500, 76, 500, 500, 500, 68, 70, 222, 500, 156, 56, 500, 500, 500, 404, 500, 352, 158, 88, 102, 500, 500, 500, 500, 44, 72, 60, 108, 418, 82, 166, 500, 46, 500, 500, 78, 338, 314, 204, 360, 54, 40, 42, 500, 80, 500, 40, 52, 438, 104, 500, 324, 500, 328, 44, 64, 500, 500, 500, 60, 60, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3930209250631741, "mean_inference_ms": 1.2627732728019314, "mean_action_processing_ms": 0.1478304459698503, "mean_env_wait_ms": 0.08753310148729831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026010751724243164, "StateBufferConnector_ms": 0.009999752044677734, "ViewRequirementAgentConnector_ms": 0.10526585578918457}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.017999999999808, "episode_len_mean": 280.44, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 6.099999999999646, 19.499999999999837, -50.00000000000044, 32.90000000000003, 14.299999999999763, -50.00000000000044, -50.00000000000044, 38.300000000000026, 46.099999999999994, 39.90000000000002, -50.00000000000044, 44.7, 42.500000000000014, -50.00000000000044, 43.30000000000001, 23.499999999999893, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.10000000000001, 35.30000000000004, 33.30000000000003, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.500000000000014, 39.300000000000026, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.10000000000001, 27.899999999999956, -50.00000000000044, 34.50000000000004, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, 14.899999999999771, 34.30000000000004, 41.30000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.900000000000006, 44.10000000000001, 39.300000000000026, 8.299999999999677, 41.90000000000001, 33.500000000000036, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, 16.29999999999979, 18.699999999999825, 29.69999999999998, 14.09999999999976, 44.7, 46.099999999999994, 45.9, -50.00000000000044, 42.10000000000001, -50.00000000000044, 46.099999999999994, 44.900000000000006, 6.299999999999649, 39.70000000000002, -50.00000000000044, 17.69999999999981, -50.00000000000044, 17.299999999999805, 45.7, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.10000000000001, 41.30000000000001], "episode_lengths": [74, 500, 88, 500, 500, 66, 440, 306, 500, 172, 358, 500, 500, 118, 40, 102, 500, 54, 76, 500, 68, 266, 72, 500, 500, 92, 60, 148, 168, 162, 500, 500, 500, 500, 500, 70, 76, 108, 500, 76, 500, 500, 500, 68, 70, 222, 500, 156, 56, 500, 500, 500, 404, 500, 352, 158, 88, 102, 500, 500, 500, 500, 44, 72, 60, 108, 418, 82, 166, 500, 46, 500, 500, 78, 338, 314, 204, 360, 54, 40, 42, 500, 80, 500, 40, 52, 438, 104, 500, 324, 500, 328, 44, 64, 500, 500, 500, 60, 60, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3930209250631741, "mean_inference_ms": 1.2627732728019314, "mean_action_processing_ms": 0.1478304459698503, "mean_env_wait_ms": 0.08753310148729831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026010751724243164, "StateBufferConnector_ms": 0.009999752044677734, "ViewRequirementAgentConnector_ms": 0.10526585578918457}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5851.665315700551, "num_env_steps_trained_throughput_per_sec": 5851.665315700551, "timesteps_total": 948000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 2289.958, "sample_time_ms": 1992.352, "load_time_ms": 10.464, "load_throughput": 1146794.14, "learn_time_ms": 200.116, "learn_throughput": 59965.073, "synch_weights_time_ms": 85.981}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 3515, "training_iteration": 79, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-37", "timestamp": 1698247777, "time_this_iter_s": 2.055694818496704, "time_total_s": 185.98221397399902, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 185.98221397399902, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 57.833333333333336, "ram_util_percent": 35.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.308722450212112e-25, "cur_lr": 0.0003, "total_loss": 6.37154188156128, "policy_loss": -0.00021890072772900264, "vf_loss": 6.371811103820801, "vf_explained_var": -9.139378865559896e-07, "kl": 0.00015361518527470252, "entropy": 0.5024629016717275, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1193.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.110999999999846, "episode_len_mean": 234.58, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 14.899999999999771, 34.30000000000004, 41.30000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.900000000000006, 44.10000000000001, 39.300000000000026, 8.299999999999677, 41.90000000000001, 33.500000000000036, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, 16.29999999999979, 18.699999999999825, 29.69999999999998, 14.09999999999976, 44.7, 46.099999999999994, 45.9, -50.00000000000044, 42.10000000000001, -50.00000000000044, 46.099999999999994, 44.900000000000006, 6.299999999999649, 39.70000000000002, -50.00000000000044, 17.69999999999981, -50.00000000000044, 17.299999999999805, 45.7, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.10000000000001, 41.30000000000001, -50.00000000000044, 40.90000000000002, 35.30000000000004, 45.7, 27.49999999999995, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.5, 45.3, -50.00000000000044, -50.00000000000044, 38.50000000000003, 43.50000000000001, 47.1, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 41.30000000000001, 38.50000000000003, 31.500000000000007, 43.7, 45.5, 44.10000000000001, 45.3, 39.50000000000002, -50.00000000000044, 37.90000000000003, 44.10000000000001, 42.10000000000001, -50.00000000000044, 41.30000000000001, 44.7, 45.7, 28.499999999999964, 45.3, 45.5, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.10000000000001, 44.300000000000004, 42.70000000000001, 31.300000000000004, 37.50000000000003], "episode_lengths": [500, 352, 158, 88, 102, 500, 500, 500, 500, 44, 72, 60, 108, 418, 82, 166, 500, 46, 500, 500, 78, 338, 314, 204, 360, 54, 40, 42, 500, 80, 500, 40, 52, 438, 104, 500, 324, 500, 328, 44, 64, 500, 500, 500, 60, 60, 88, 500, 92, 148, 44, 226, 40, 50, 500, 500, 500, 54, 500, 500, 56, 48, 500, 500, 116, 66, 30, 500, 54, 500, 500, 46, 500, 88, 116, 186, 64, 46, 60, 48, 106, 500, 122, 60, 80, 500, 88, 54, 44, 216, 48, 46, 500, 500, 102, 60, 58, 74, 188, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39271850762390925, "mean_inference_ms": 1.2614384130115917, "mean_action_processing_ms": 0.1477791816912041, "mean_env_wait_ms": 0.0876171248802255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002904891967773, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.12451481819152832}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.110999999999846, "episode_len_mean": 234.58, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 14.899999999999771, 34.30000000000004, 41.30000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.900000000000006, 44.10000000000001, 39.300000000000026, 8.299999999999677, 41.90000000000001, 33.500000000000036, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, 16.29999999999979, 18.699999999999825, 29.69999999999998, 14.09999999999976, 44.7, 46.099999999999994, 45.9, -50.00000000000044, 42.10000000000001, -50.00000000000044, 46.099999999999994, 44.900000000000006, 6.299999999999649, 39.70000000000002, -50.00000000000044, 17.69999999999981, -50.00000000000044, 17.299999999999805, 45.7, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.10000000000001, 41.30000000000001, -50.00000000000044, 40.90000000000002, 35.30000000000004, 45.7, 27.49999999999995, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.5, 45.3, -50.00000000000044, -50.00000000000044, 38.50000000000003, 43.50000000000001, 47.1, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 41.30000000000001, 38.50000000000003, 31.500000000000007, 43.7, 45.5, 44.10000000000001, 45.3, 39.50000000000002, -50.00000000000044, 37.90000000000003, 44.10000000000001, 42.10000000000001, -50.00000000000044, 41.30000000000001, 44.7, 45.7, 28.499999999999964, 45.3, 45.5, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.10000000000001, 44.300000000000004, 42.70000000000001, 31.300000000000004, 37.50000000000003], "episode_lengths": [500, 352, 158, 88, 102, 500, 500, 500, 500, 44, 72, 60, 108, 418, 82, 166, 500, 46, 500, 500, 78, 338, 314, 204, 360, 54, 40, 42, 500, 80, 500, 40, 52, 438, 104, 500, 324, 500, 328, 44, 64, 500, 500, 500, 60, 60, 88, 500, 92, 148, 44, 226, 40, 50, 500, 500, 500, 54, 500, 500, 56, 48, 500, 500, 116, 66, 30, 500, 54, 500, 500, 46, 500, 88, 116, 186, 64, 46, 60, 48, 106, 500, 122, 60, 80, 500, 88, 54, 44, 216, 48, 46, 500, 500, 102, 60, 58, 74, 188, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39271850762390925, "mean_inference_ms": 1.2614384130115917, "mean_action_processing_ms": 0.1477791816912041, "mean_env_wait_ms": 0.0876171248802255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002904891967773, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.12451481819152832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5825.354799134269, "num_env_steps_trained_throughput_per_sec": 5825.354799134269, "timesteps_total": 960000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 2269.715, "sample_time_ms": 1988.75, "load_time_ms": 9.865, "load_throughput": 1216430.776, "learn_time_ms": 183.892, "learn_throughput": 65255.529, "synch_weights_time_ms": 86.061}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 3568, "training_iteration": 80, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-39", "timestamp": 1698247779, "time_this_iter_s": 2.0649526119232178, "time_total_s": 188.04716658592224, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 188.04716658592224, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 60.166666666666664, "ram_util_percent": 34.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.654361225106056e-25, "cur_lr": 0.0003, "total_loss": 6.6011073112487795, "policy_loss": -2.6263296604156494e-05, "vf_loss": 6.601184304555257, "vf_explained_var": -7.549921671549479e-07, "kl": 0.00036980097740979545, "entropy": 0.5064920266469319, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1208.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.639999999999848, "episode_len_mean": 234.28, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, -50.00000000000044, 40.90000000000002, 35.30000000000004, 45.7, 27.49999999999995, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.5, 45.3, -50.00000000000044, -50.00000000000044, 38.50000000000003, 43.50000000000001, 47.1, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 41.30000000000001, 38.50000000000003, 31.500000000000007, 43.7, 45.5, 44.10000000000001, 45.3, 39.50000000000002, -50.00000000000044, 37.90000000000003, 44.10000000000001, 42.10000000000001, -50.00000000000044, 41.30000000000001, 44.7, 45.7, 28.499999999999964, 45.3, 45.5, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.10000000000001, 44.300000000000004, 42.70000000000001, 31.300000000000004, 37.50000000000003, 1.6999999999995836, 39.50000000000002, 9.699999999999697, 40.30000000000002, 42.10000000000001, 5.299999999999635, 44.10000000000001, -50.00000000000044, 44.900000000000006, 43.10000000000001, 33.90000000000004, -50.00000000000044, 40.500000000000014, 41.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 18.499999999999822, 46.5, 43.50000000000001, 45.1, 35.30000000000004, 45.1, 44.300000000000004, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, 42.500000000000014, 11.699999999999726, -50.00000000000044, -50.00000000000044, 26.499999999999936, 45.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [88, 500, 92, 148, 44, 226, 40, 50, 500, 500, 500, 54, 500, 500, 56, 48, 500, 500, 116, 66, 30, 500, 54, 500, 500, 46, 500, 88, 116, 186, 64, 46, 60, 48, 106, 500, 122, 60, 80, 500, 88, 54, 44, 216, 48, 46, 500, 500, 102, 60, 58, 74, 188, 126, 484, 106, 404, 98, 80, 448, 60, 500, 52, 70, 162, 500, 96, 88, 36, 500, 500, 500, 74, 316, 36, 66, 50, 148, 50, 58, 72, 46, 500, 500, 78, 76, 384, 500, 500, 236, 44, 500, 188, 500, 500, 500, 500, 84, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39209013179439434, "mean_inference_ms": 1.2593070366144665, "mean_action_processing_ms": 0.14780694722891055, "mean_env_wait_ms": 0.08754748572958616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023996829986572266, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.1257767677307129}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.639999999999848, "episode_len_mean": 234.28, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, -50.00000000000044, 40.90000000000002, 35.30000000000004, 45.7, 27.49999999999995, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.5, 45.3, -50.00000000000044, -50.00000000000044, 38.50000000000003, 43.50000000000001, 47.1, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 41.30000000000001, 38.50000000000003, 31.500000000000007, 43.7, 45.5, 44.10000000000001, 45.3, 39.50000000000002, -50.00000000000044, 37.90000000000003, 44.10000000000001, 42.10000000000001, -50.00000000000044, 41.30000000000001, 44.7, 45.7, 28.499999999999964, 45.3, 45.5, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.10000000000001, 44.300000000000004, 42.70000000000001, 31.300000000000004, 37.50000000000003, 1.6999999999995836, 39.50000000000002, 9.699999999999697, 40.30000000000002, 42.10000000000001, 5.299999999999635, 44.10000000000001, -50.00000000000044, 44.900000000000006, 43.10000000000001, 33.90000000000004, -50.00000000000044, 40.500000000000014, 41.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 18.499999999999822, 46.5, 43.50000000000001, 45.1, 35.30000000000004, 45.1, 44.300000000000004, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, 42.500000000000014, 11.699999999999726, -50.00000000000044, -50.00000000000044, 26.499999999999936, 45.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [88, 500, 92, 148, 44, 226, 40, 50, 500, 500, 500, 54, 500, 500, 56, 48, 500, 500, 116, 66, 30, 500, 54, 500, 500, 46, 500, 88, 116, 186, 64, 46, 60, 48, 106, 500, 122, 60, 80, 500, 88, 54, 44, 216, 48, 46, 500, 500, 102, 60, 58, 74, 188, 126, 484, 106, 404, 98, 80, 448, 60, 500, 52, 70, 162, 500, 96, 88, 36, 500, 500, 500, 74, 316, 36, 66, 50, 148, 50, 58, 72, 46, 500, 500, 78, 76, 384, 500, 500, 236, 44, 500, 188, 500, 500, 500, 500, 84, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39209013179439434, "mean_inference_ms": 1.2593070366144665, "mean_action_processing_ms": 0.14780694722891055, "mean_env_wait_ms": 0.08754748572958616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023996829986572266, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.1257767677307129}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5526.6116358761865, "num_env_steps_trained_throughput_per_sec": 5526.6116358761865, "timesteps_total": 972000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 2267.339, "sample_time_ms": 1970.65, "load_time_ms": 10.894, "load_throughput": 1101539.391, "learn_time_ms": 199.172, "learn_throughput": 60249.326, "synch_weights_time_ms": 85.376}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3614, "training_iteration": 81, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-41", "timestamp": 1698247781, "time_this_iter_s": 2.176307201385498, "time_total_s": 190.22347378730774, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 190.22347378730774, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 58.96666666666666, "ram_util_percent": 34.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.27180612553028e-26, "cur_lr": 0.0003, "total_loss": 6.3739652315775555, "policy_loss": -4.729628562927246e-05, "vf_loss": 6.374067815144857, "vf_explained_var": -1.223882039388021e-06, "kl": 8.795981702102533e-05, "entropy": 0.5533580462137858, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1223.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.627999999999835, "episode_len_mean": 254.38, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.10000000000001, 44.300000000000004, 42.70000000000001, 31.300000000000004, 37.50000000000003, 1.6999999999995836, 39.50000000000002, 9.699999999999697, 40.30000000000002, 42.10000000000001, 5.299999999999635, 44.10000000000001, -50.00000000000044, 44.900000000000006, 43.10000000000001, 33.90000000000004, -50.00000000000044, 40.500000000000014, 41.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 18.499999999999822, 46.5, 43.50000000000001, 45.1, 35.30000000000004, 45.1, 44.300000000000004, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, 42.500000000000014, 11.699999999999726, -50.00000000000044, -50.00000000000044, 26.499999999999936, 45.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, 38.10000000000002, 44.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, 35.500000000000036, 40.500000000000014, -50.00000000000044, 21.09999999999986, 22.899999999999885, 45.1, 28.499999999999964, 42.900000000000006, -50.00000000000044, 45.5, 39.70000000000002, 44.900000000000006, 23.29999999999989, 32.30000000000002, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 36.10000000000004, -50.00000000000044, 44.7, 44.5, 37.300000000000026, 32.700000000000024, -50.00000000000044, -50.00000000000044], "episode_lengths": [46, 500, 500, 102, 60, 58, 74, 188, 126, 484, 106, 404, 98, 80, 448, 60, 500, 52, 70, 162, 500, 96, 88, 36, 500, 500, 500, 74, 316, 36, 66, 50, 148, 50, 58, 72, 46, 500, 500, 78, 76, 384, 500, 500, 236, 44, 500, 188, 500, 500, 500, 500, 84, 500, 500, 188, 500, 66, 500, 302, 500, 500, 82, 100, 500, 500, 100, 120, 52, 54, 500, 500, 146, 96, 500, 290, 272, 50, 216, 72, 500, 46, 104, 52, 268, 178, 74, 46, 500, 500, 500, 68, 140, 500, 54, 56, 128, 174, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39165718895839574, "mean_inference_ms": 1.2593656171118643, "mean_action_processing_ms": 0.1476585102735017, "mean_env_wait_ms": 0.08720360667819463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014999151229858398, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.12926459312438965}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.627999999999835, "episode_len_mean": 254.38, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.10000000000001, 44.300000000000004, 42.70000000000001, 31.300000000000004, 37.50000000000003, 1.6999999999995836, 39.50000000000002, 9.699999999999697, 40.30000000000002, 42.10000000000001, 5.299999999999635, 44.10000000000001, -50.00000000000044, 44.900000000000006, 43.10000000000001, 33.90000000000004, -50.00000000000044, 40.500000000000014, 41.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 18.499999999999822, 46.5, 43.50000000000001, 45.1, 35.30000000000004, 45.1, 44.300000000000004, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, 42.500000000000014, 11.699999999999726, -50.00000000000044, -50.00000000000044, 26.499999999999936, 45.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, 38.10000000000002, 44.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, 35.500000000000036, 40.500000000000014, -50.00000000000044, 21.09999999999986, 22.899999999999885, 45.1, 28.499999999999964, 42.900000000000006, -50.00000000000044, 45.5, 39.70000000000002, 44.900000000000006, 23.29999999999989, 32.30000000000002, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 36.10000000000004, -50.00000000000044, 44.7, 44.5, 37.300000000000026, 32.700000000000024, -50.00000000000044, -50.00000000000044], "episode_lengths": [46, 500, 500, 102, 60, 58, 74, 188, 126, 484, 106, 404, 98, 80, 448, 60, 500, 52, 70, 162, 500, 96, 88, 36, 500, 500, 500, 74, 316, 36, 66, 50, 148, 50, 58, 72, 46, 500, 500, 78, 76, 384, 500, 500, 236, 44, 500, 188, 500, 500, 500, 500, 84, 500, 500, 188, 500, 66, 500, 302, 500, 500, 82, 100, 500, 500, 100, 120, 52, 54, 500, 500, 146, 96, 500, 290, 272, 50, 216, 72, 500, 46, 104, 52, 268, 178, 74, 46, 500, 500, 500, 68, 140, 500, 54, 56, 128, 174, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39165718895839574, "mean_inference_ms": 1.2593656171118643, "mean_action_processing_ms": 0.1476585102735017, "mean_env_wait_ms": 0.08720360667819463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014999151229858398, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.12926459312438965}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5963.59329506948, "num_env_steps_trained_throughput_per_sec": 5963.59329506948, "timesteps_total": 984000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 2233.958, "sample_time_ms": 1954.864, "load_time_ms": 9.97, "load_throughput": 1203565.095, "learn_time_ms": 182.363, "learn_throughput": 65802.75, "synch_weights_time_ms": 85.373}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 3659, "training_iteration": 82, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-43", "timestamp": 1698247783, "time_this_iter_s": 2.0182044506073, "time_total_s": 192.24167823791504, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 192.24167823791504, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 58.0, "ram_util_percent": 34.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.13590306276514e-26, "cur_lr": 0.0003, "total_loss": 7.1051817258199055, "policy_loss": -0.0001230339209238688, "vf_loss": 7.105359172821045, "vf_explained_var": -1.3510386149088542e-06, "kl": 0.00019415937310138058, "entropy": 0.5434553027153015, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1238.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.08399999999984, "episode_len_mean": 249.82, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, 38.10000000000002, 44.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, 35.500000000000036, 40.500000000000014, -50.00000000000044, 21.09999999999986, 22.899999999999885, 45.1, 28.499999999999964, 42.900000000000006, -50.00000000000044, 45.5, 39.70000000000002, 44.900000000000006, 23.29999999999989, 32.30000000000002, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 36.10000000000004, -50.00000000000044, 44.7, 44.5, 37.300000000000026, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.70000000000001, 42.10000000000001, 44.10000000000001, 40.30000000000002, 45.7, 16.499999999999794, 11.29999999999972, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 40.90000000000002, 46.9, -50.00000000000044, 37.10000000000003, 21.09999999999986, 39.10000000000002, 38.10000000000002, 29.69999999999998, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 26.89999999999994, 41.90000000000001, -50.00000000000044, -50.00000000000044, 26.89999999999994, 44.10000000000001, 42.900000000000006, -50.00000000000044, 45.1, 43.7, 14.699999999999768, -50.00000000000044, 44.5, 36.10000000000004, -50.00000000000044, 45.5, 39.70000000000002, 33.10000000000003, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, 46.5], "episode_lengths": [188, 500, 66, 500, 302, 500, 500, 82, 100, 500, 500, 100, 120, 52, 54, 500, 500, 146, 96, 500, 290, 272, 50, 216, 72, 500, 46, 104, 52, 268, 178, 74, 46, 500, 500, 500, 68, 140, 500, 54, 56, 128, 174, 500, 500, 500, 98, 74, 80, 60, 98, 44, 336, 388, 154, 500, 500, 500, 108, 500, 92, 32, 500, 130, 290, 110, 120, 204, 500, 500, 32, 500, 232, 82, 500, 500, 232, 60, 72, 500, 50, 64, 354, 500, 56, 140, 500, 46, 104, 170, 44, 500, 38, 500, 58, 500, 48, 500, 52, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3917563406383772, "mean_inference_ms": 1.2585074568733938, "mean_action_processing_ms": 0.14788666639560957, "mean_env_wait_ms": 0.08707164545288518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023015737533569336, "StateBufferConnector_ms": 0.006018161773681641, "ViewRequirementAgentConnector_ms": 0.11397576332092285}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.08399999999984, "episode_len_mean": 249.82, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, 38.10000000000002, 44.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, 35.500000000000036, 40.500000000000014, -50.00000000000044, 21.09999999999986, 22.899999999999885, 45.1, 28.499999999999964, 42.900000000000006, -50.00000000000044, 45.5, 39.70000000000002, 44.900000000000006, 23.29999999999989, 32.30000000000002, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 36.10000000000004, -50.00000000000044, 44.7, 44.5, 37.300000000000026, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.70000000000001, 42.10000000000001, 44.10000000000001, 40.30000000000002, 45.7, 16.499999999999794, 11.29999999999972, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 40.90000000000002, 46.9, -50.00000000000044, 37.10000000000003, 21.09999999999986, 39.10000000000002, 38.10000000000002, 29.69999999999998, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 26.89999999999994, 41.90000000000001, -50.00000000000044, -50.00000000000044, 26.89999999999994, 44.10000000000001, 42.900000000000006, -50.00000000000044, 45.1, 43.7, 14.699999999999768, -50.00000000000044, 44.5, 36.10000000000004, -50.00000000000044, 45.5, 39.70000000000002, 33.10000000000003, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, 46.5], "episode_lengths": [188, 500, 66, 500, 302, 500, 500, 82, 100, 500, 500, 100, 120, 52, 54, 500, 500, 146, 96, 500, 290, 272, 50, 216, 72, 500, 46, 104, 52, 268, 178, 74, 46, 500, 500, 500, 68, 140, 500, 54, 56, 128, 174, 500, 500, 500, 98, 74, 80, 60, 98, 44, 336, 388, 154, 500, 500, 500, 108, 500, 92, 32, 500, 130, 290, 110, 120, 204, 500, 500, 32, 500, 232, 82, 500, 500, 232, 60, 72, 500, 50, 64, 354, 500, 56, 140, 500, 46, 104, 170, 44, 500, 38, 500, 58, 500, 48, 500, 52, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3917563406383772, "mean_inference_ms": 1.2585074568733938, "mean_action_processing_ms": 0.14788666639560957, "mean_env_wait_ms": 0.08707164545288518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023015737533569336, "StateBufferConnector_ms": 0.006018161773681641, "ViewRequirementAgentConnector_ms": 0.11397576332092285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6040.227824221084, "num_env_steps_trained_throughput_per_sec": 6040.227824221084, "timesteps_total": 996000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 2219.118, "sample_time_ms": 1942.449, "load_time_ms": 10.532, "load_throughput": 1139405.618, "learn_time_ms": 179.278, "learn_throughput": 66935.296, "synch_weights_time_ms": 85.371}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 3714, "training_iteration": 83, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-45", "timestamp": 1698247785, "time_this_iter_s": 1.9916744232177734, "time_total_s": 194.2333526611328, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 194.2333526611328, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 57.6, "ram_util_percent": 34.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.06795153138257e-26, "cur_lr": 0.0003, "total_loss": 6.652384916941325, "policy_loss": -0.000989384949207306, "vf_loss": 6.653427982330323, "vf_explained_var": -4.5299530029296873e-07, "kl": 0.0014837053320813235, "entropy": 0.5370194772879283, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1253.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.054999999999842, "episode_len_mean": 245.12, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, 42.10000000000001, 44.10000000000001, 40.30000000000002, 45.7, 16.499999999999794, 11.29999999999972, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 40.90000000000002, 46.9, -50.00000000000044, 37.10000000000003, 21.09999999999986, 39.10000000000002, 38.10000000000002, 29.69999999999998, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 26.89999999999994, 41.90000000000001, -50.00000000000044, -50.00000000000044, 26.89999999999994, 44.10000000000001, 42.900000000000006, -50.00000000000044, 45.1, 43.7, 14.699999999999768, -50.00000000000044, 44.5, 36.10000000000004, -50.00000000000044, 45.5, 39.70000000000002, 33.10000000000003, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, 39.10000000000002, 18.29999999999982, 43.50000000000001, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 14.899999999999771, 41.90000000000001, 26.299999999999933, 42.10000000000001, -50.00000000000044, 44.7, 46.3, 43.7, 43.30000000000001, -50.00000000000044, 17.299999999999805, -50.00000000000044, 42.30000000000001, 38.50000000000003, 41.100000000000016, -50.00000000000044, 44.10000000000001, 42.500000000000014, 42.500000000000014, 41.500000000000014, -50.00000000000044, 32.30000000000002, 44.5, 40.70000000000002, -50.00000000000044, 46.3, 44.900000000000006, 47.5, 38.300000000000026, -50.00000000000044, 34.10000000000004, -50.00000000000044, 43.10000000000001, 46.699999999999996], "episode_lengths": [74, 80, 60, 98, 44, 336, 388, 154, 500, 500, 500, 108, 500, 92, 32, 500, 130, 290, 110, 120, 204, 500, 500, 32, 500, 232, 82, 500, 500, 232, 60, 72, 500, 50, 64, 354, 500, 56, 140, 500, 46, 104, 170, 44, 500, 38, 500, 58, 500, 48, 500, 52, 36, 500, 110, 318, 66, 500, 388, 500, 500, 500, 500, 500, 128, 500, 352, 82, 238, 80, 500, 54, 38, 64, 68, 500, 328, 500, 78, 116, 90, 500, 60, 76, 76, 86, 500, 178, 56, 94, 500, 38, 52, 26, 118, 500, 160, 500, 70, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3913812652902851, "mean_inference_ms": 1.2573162284488355, "mean_action_processing_ms": 0.1473664722486299, "mean_env_wait_ms": 0.08687341697360736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030307769775390625, "StateBufferConnector_ms": 0.0070188045501708984, "ViewRequirementAgentConnector_ms": 0.09900283813476562}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.054999999999842, "episode_len_mean": 245.12, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, 42.10000000000001, 44.10000000000001, 40.30000000000002, 45.7, 16.499999999999794, 11.29999999999972, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 40.90000000000002, 46.9, -50.00000000000044, 37.10000000000003, 21.09999999999986, 39.10000000000002, 38.10000000000002, 29.69999999999998, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 26.89999999999994, 41.90000000000001, -50.00000000000044, -50.00000000000044, 26.89999999999994, 44.10000000000001, 42.900000000000006, -50.00000000000044, 45.1, 43.7, 14.699999999999768, -50.00000000000044, 44.5, 36.10000000000004, -50.00000000000044, 45.5, 39.70000000000002, 33.10000000000003, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, 39.10000000000002, 18.29999999999982, 43.50000000000001, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 14.899999999999771, 41.90000000000001, 26.299999999999933, 42.10000000000001, -50.00000000000044, 44.7, 46.3, 43.7, 43.30000000000001, -50.00000000000044, 17.299999999999805, -50.00000000000044, 42.30000000000001, 38.50000000000003, 41.100000000000016, -50.00000000000044, 44.10000000000001, 42.500000000000014, 42.500000000000014, 41.500000000000014, -50.00000000000044, 32.30000000000002, 44.5, 40.70000000000002, -50.00000000000044, 46.3, 44.900000000000006, 47.5, 38.300000000000026, -50.00000000000044, 34.10000000000004, -50.00000000000044, 43.10000000000001, 46.699999999999996], "episode_lengths": [74, 80, 60, 98, 44, 336, 388, 154, 500, 500, 500, 108, 500, 92, 32, 500, 130, 290, 110, 120, 204, 500, 500, 32, 500, 232, 82, 500, 500, 232, 60, 72, 500, 50, 64, 354, 500, 56, 140, 500, 46, 104, 170, 44, 500, 38, 500, 58, 500, 48, 500, 52, 36, 500, 110, 318, 66, 500, 388, 500, 500, 500, 500, 500, 128, 500, 352, 82, 238, 80, 500, 54, 38, 64, 68, 500, 328, 500, 78, 116, 90, 500, 60, 76, 76, 86, 500, 178, 56, 94, 500, 38, 52, 26, 118, 500, 160, 500, 70, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3913812652902851, "mean_inference_ms": 1.2573162284488355, "mean_action_processing_ms": 0.1473664722486299, "mean_env_wait_ms": 0.08687341697360736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030307769775390625, "StateBufferConnector_ms": 0.0070188045501708984, "ViewRequirementAgentConnector_ms": 0.09900283813476562}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5721.4227813388825, "num_env_steps_trained_throughput_per_sec": 5721.4227813388825, "timesteps_total": 1008000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 2207.248, "sample_time_ms": 1911.963, "load_time_ms": 10.632, "load_throughput": 1128697.029, "learn_time_ms": 197.493, "learn_throughput": 60761.543, "synch_weights_time_ms": 85.571}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3761, "training_iteration": 84, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-47", "timestamp": 1698247787, "time_this_iter_s": 2.102369785308838, "time_total_s": 196.33572244644165, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 196.33572244644165, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 55.46666666666667, "ram_util_percent": 34.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.033975765691285e-26, "cur_lr": 0.0003, "total_loss": 6.666157817840576, "policy_loss": -0.0003817640244960785, "vf_loss": 6.666590722401937, "vf_explained_var": -1.8278757731119792e-06, "kl": 0.0013894732470362214, "entropy": 0.512735003232956, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1268.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.155999999999842, "episode_len_mean": 239.1, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.10000000000002, 18.29999999999982, 43.50000000000001, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 14.899999999999771, 41.90000000000001, 26.299999999999933, 42.10000000000001, -50.00000000000044, 44.7, 46.3, 43.7, 43.30000000000001, -50.00000000000044, 17.299999999999805, -50.00000000000044, 42.30000000000001, 38.50000000000003, 41.100000000000016, -50.00000000000044, 44.10000000000001, 42.500000000000014, 42.500000000000014, 41.500000000000014, -50.00000000000044, 32.30000000000002, 44.5, 40.70000000000002, -50.00000000000044, 46.3, 44.900000000000006, 47.5, 38.300000000000026, -50.00000000000044, 34.10000000000004, -50.00000000000044, 43.10000000000001, 46.699999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.10000000000002, 39.10000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 36.10000000000004, 30.9, 31.900000000000013, 44.300000000000004, 36.30000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.10000000000002, 43.30000000000001, 45.3, 38.90000000000002, 42.10000000000001, 47.3, 42.70000000000001, 44.10000000000001, 43.30000000000001, 45.5, 32.700000000000024, 10.499999999999709, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 44.7, 42.500000000000014, 41.90000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, 42.900000000000006, 47.3, -50.00000000000044], "episode_lengths": [500, 110, 318, 66, 500, 388, 500, 500, 500, 500, 500, 128, 500, 352, 82, 238, 80, 500, 54, 38, 64, 68, 500, 328, 500, 78, 116, 90, 500, 60, 76, 76, 86, 500, 178, 56, 94, 500, 38, 52, 26, 118, 500, 160, 500, 70, 34, 500, 60, 500, 120, 110, 48, 500, 500, 500, 500, 500, 500, 124, 140, 192, 182, 58, 138, 66, 500, 500, 42, 500, 32, 500, 500, 98, 100, 68, 48, 112, 80, 28, 74, 60, 68, 46, 174, 396, 56, 500, 44, 500, 54, 76, 82, 500, 34, 500, 78, 72, 28, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39108549349274135, "mean_inference_ms": 1.2558875358829098, "mean_action_processing_ms": 0.1471448710283798, "mean_env_wait_ms": 0.08676382280020693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025285005569458008, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.10501408576965332}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.155999999999842, "episode_len_mean": 239.1, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.10000000000002, 18.29999999999982, 43.50000000000001, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 14.899999999999771, 41.90000000000001, 26.299999999999933, 42.10000000000001, -50.00000000000044, 44.7, 46.3, 43.7, 43.30000000000001, -50.00000000000044, 17.299999999999805, -50.00000000000044, 42.30000000000001, 38.50000000000003, 41.100000000000016, -50.00000000000044, 44.10000000000001, 42.500000000000014, 42.500000000000014, 41.500000000000014, -50.00000000000044, 32.30000000000002, 44.5, 40.70000000000002, -50.00000000000044, 46.3, 44.900000000000006, 47.5, 38.300000000000026, -50.00000000000044, 34.10000000000004, -50.00000000000044, 43.10000000000001, 46.699999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.10000000000002, 39.10000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 36.10000000000004, 30.9, 31.900000000000013, 44.300000000000004, 36.30000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.10000000000002, 43.30000000000001, 45.3, 38.90000000000002, 42.10000000000001, 47.3, 42.70000000000001, 44.10000000000001, 43.30000000000001, 45.5, 32.700000000000024, 10.499999999999709, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 44.7, 42.500000000000014, 41.90000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, 42.900000000000006, 47.3, -50.00000000000044], "episode_lengths": [500, 110, 318, 66, 500, 388, 500, 500, 500, 500, 500, 128, 500, 352, 82, 238, 80, 500, 54, 38, 64, 68, 500, 328, 500, 78, 116, 90, 500, 60, 76, 76, 86, 500, 178, 56, 94, 500, 38, 52, 26, 118, 500, 160, 500, 70, 34, 500, 60, 500, 120, 110, 48, 500, 500, 500, 500, 500, 500, 124, 140, 192, 182, 58, 138, 66, 500, 500, 42, 500, 32, 500, 500, 98, 100, 68, 48, 112, 80, 28, 74, 60, 68, 46, 174, 396, 56, 500, 44, 500, 54, 76, 82, 500, 34, 500, 78, 72, 28, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39108549349274135, "mean_inference_ms": 1.2558875358829098, "mean_action_processing_ms": 0.1471448710283798, "mean_env_wait_ms": 0.08676382280020693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025285005569458008, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.10501408576965332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6030.06908773661, "num_env_steps_trained_throughput_per_sec": 6030.06908773661, "timesteps_total": 1020000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 2115.808, "sample_time_ms": 1894.317, "load_time_ms": 10.617, "load_throughput": 1130281.202, "learn_time_ms": 200.282, "learn_throughput": 59915.469, "synch_weights_time_ms": 8.988}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 3814, "training_iteration": 85, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-49", "timestamp": 1698247789, "time_this_iter_s": 1.9950242042541504, "time_total_s": 198.3307466506958, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 198.3307466506958, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 62.5, "ram_util_percent": 33.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.169878828456425e-27, "cur_lr": 0.0003, "total_loss": 6.784121894836426, "policy_loss": -0.0006247769730786482, "vf_loss": 6.7847956339518225, "vf_explained_var": -1.3907750447591145e-06, "kl": 0.0012796848269166123, "entropy": 0.48749255339304604, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1283.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.521999999999844, "episode_len_mean": 235.44, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.10000000000002, 39.10000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 36.10000000000004, 30.9, 31.900000000000013, 44.300000000000004, 36.30000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.10000000000002, 43.30000000000001, 45.3, 38.90000000000002, 42.10000000000001, 47.3, 42.70000000000001, 44.10000000000001, 43.30000000000001, 45.5, 32.700000000000024, 10.499999999999709, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 44.7, 42.500000000000014, 41.90000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, 42.900000000000006, 47.3, -50.00000000000044, 22.299999999999876, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.900000000000006, 40.500000000000014, 43.900000000000006, -50.00000000000044, 10.499999999999709, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, -50.00000000000044, 11.29999999999972, 40.10000000000002, 46.5, 44.7, 42.900000000000006, 25.099999999999916, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.30000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.900000000000006, 41.90000000000001, 42.70000000000001, 43.50000000000001, 46.9, -50.00000000000044, 45.9, 24.69999999999991, 42.500000000000014, 44.300000000000004], "episode_lengths": [500, 120, 110, 48, 500, 500, 500, 500, 500, 500, 124, 140, 192, 182, 58, 138, 66, 500, 500, 42, 500, 32, 500, 500, 98, 100, 68, 48, 112, 80, 28, 74, 60, 68, 46, 174, 396, 56, 500, 44, 500, 54, 76, 82, 500, 34, 500, 78, 72, 28, 500, 278, 36, 500, 500, 500, 92, 52, 96, 62, 500, 396, 104, 500, 500, 500, 500, 76, 46, 500, 388, 100, 36, 54, 72, 250, 50, 52, 500, 500, 98, 78, 500, 500, 158, 34, 500, 500, 62, 500, 62, 82, 74, 66, 32, 500, 42, 254, 76, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3905481862368546, "mean_inference_ms": 1.2543520199302152, "mean_action_processing_ms": 0.14718613760554877, "mean_env_wait_ms": 0.0866901451447287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02698802947998047, "StateBufferConnector_ms": 0.0029990673065185547, "ViewRequirementAgentConnector_ms": 0.12700152397155762}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.521999999999844, "episode_len_mean": 235.44, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.10000000000002, 39.10000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 36.10000000000004, 30.9, 31.900000000000013, 44.300000000000004, 36.30000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.10000000000002, 43.30000000000001, 45.3, 38.90000000000002, 42.10000000000001, 47.3, 42.70000000000001, 44.10000000000001, 43.30000000000001, 45.5, 32.700000000000024, 10.499999999999709, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 44.7, 42.500000000000014, 41.90000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, 42.900000000000006, 47.3, -50.00000000000044, 22.299999999999876, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.900000000000006, 40.500000000000014, 43.900000000000006, -50.00000000000044, 10.499999999999709, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, -50.00000000000044, 11.29999999999972, 40.10000000000002, 46.5, 44.7, 42.900000000000006, 25.099999999999916, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.30000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.900000000000006, 41.90000000000001, 42.70000000000001, 43.50000000000001, 46.9, -50.00000000000044, 45.9, 24.69999999999991, 42.500000000000014, 44.300000000000004], "episode_lengths": [500, 120, 110, 48, 500, 500, 500, 500, 500, 500, 124, 140, 192, 182, 58, 138, 66, 500, 500, 42, 500, 32, 500, 500, 98, 100, 68, 48, 112, 80, 28, 74, 60, 68, 46, 174, 396, 56, 500, 44, 500, 54, 76, 82, 500, 34, 500, 78, 72, 28, 500, 278, 36, 500, 500, 500, 92, 52, 96, 62, 500, 396, 104, 500, 500, 500, 500, 76, 46, 500, 388, 100, 36, 54, 72, 250, 50, 52, 500, 500, 98, 78, 500, 500, 158, 34, 500, 500, 62, 500, 62, 82, 74, 66, 32, 500, 42, 254, 76, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3905481862368546, "mean_inference_ms": 1.2543520199302152, "mean_action_processing_ms": 0.14718613760554877, "mean_env_wait_ms": 0.0866901451447287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02698802947998047, "StateBufferConnector_ms": 0.0029990673065185547, "ViewRequirementAgentConnector_ms": 0.12700152397155762}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5638.066783307612, "num_env_steps_trained_throughput_per_sec": 5638.066783307612, "timesteps_total": 1032000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 2106.915, "sample_time_ms": 1892.199, "load_time_ms": 10.234, "load_throughput": 1172532.195, "learn_time_ms": 193.889, "learn_throughput": 61891.083, "synch_weights_time_ms": 8.888}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 3863, "training_iteration": 86, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-51", "timestamp": 1698247791, "time_this_iter_s": 2.133382558822632, "time_total_s": 200.46412920951843, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 200.46412920951843, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 60.06666666666666, "ram_util_percent": 33.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5849394142282123e-27, "cur_lr": 0.0003, "total_loss": 6.345767529805501, "policy_loss": 7.851719856262207e-05, "vf_loss": 6.345733610788981, "vf_explained_var": -8.265177408854167e-07, "kl": 0.0002417026513436819, "entropy": 0.44670520424842836, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1298.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.516999999999812, "episode_len_mean": 260.44, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 42.500000000000014, 41.90000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, 42.900000000000006, 47.3, -50.00000000000044, 22.299999999999876, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.900000000000006, 40.500000000000014, 43.900000000000006, -50.00000000000044, 10.499999999999709, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, -50.00000000000044, 11.29999999999972, 40.10000000000002, 46.5, 44.7, 42.900000000000006, 25.099999999999916, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.30000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.900000000000006, 41.90000000000001, 42.70000000000001, 43.50000000000001, 46.9, -50.00000000000044, 45.9, 24.69999999999991, 42.500000000000014, 44.300000000000004, 14.499999999999766, 39.70000000000002, 43.900000000000006, -50.00000000000044, 45.3, 43.900000000000006, 32.700000000000024, 44.7, 4.099999999999618, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.100000000000016, 31.300000000000004, -50.00000000000044, 44.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, 45.3], "episode_lengths": [500, 54, 76, 82, 500, 34, 500, 78, 72, 28, 500, 278, 36, 500, 500, 500, 92, 52, 96, 62, 500, 396, 104, 500, 500, 500, 500, 76, 46, 500, 388, 100, 36, 54, 72, 250, 50, 52, 500, 500, 98, 78, 500, 500, 158, 34, 500, 500, 62, 500, 62, 82, 74, 66, 32, 500, 42, 254, 76, 58, 356, 104, 62, 500, 48, 62, 174, 54, 460, 500, 500, 106, 116, 500, 40, 500, 500, 500, 38, 500, 34, 500, 500, 44, 500, 46, 62, 500, 500, 90, 188, 500, 56, 52, 500, 500, 464, 500, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3906931439457481, "mean_inference_ms": 1.253513351455732, "mean_action_processing_ms": 0.14681344625051115, "mean_env_wait_ms": 0.0867060472647796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299213409423828, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.12302708625793457}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.516999999999812, "episode_len_mean": 260.44, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 42.500000000000014, 41.90000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, 42.900000000000006, 47.3, -50.00000000000044, 22.299999999999876, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.900000000000006, 40.500000000000014, 43.900000000000006, -50.00000000000044, 10.499999999999709, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, -50.00000000000044, 11.29999999999972, 40.10000000000002, 46.5, 44.7, 42.900000000000006, 25.099999999999916, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.30000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.900000000000006, 41.90000000000001, 42.70000000000001, 43.50000000000001, 46.9, -50.00000000000044, 45.9, 24.69999999999991, 42.500000000000014, 44.300000000000004, 14.499999999999766, 39.70000000000002, 43.900000000000006, -50.00000000000044, 45.3, 43.900000000000006, 32.700000000000024, 44.7, 4.099999999999618, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.100000000000016, 31.300000000000004, -50.00000000000044, 44.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, 45.3], "episode_lengths": [500, 54, 76, 82, 500, 34, 500, 78, 72, 28, 500, 278, 36, 500, 500, 500, 92, 52, 96, 62, 500, 396, 104, 500, 500, 500, 500, 76, 46, 500, 388, 100, 36, 54, 72, 250, 50, 52, 500, 500, 98, 78, 500, 500, 158, 34, 500, 500, 62, 500, 62, 82, 74, 66, 32, 500, 42, 254, 76, 58, 356, 104, 62, 500, 48, 62, 174, 54, 460, 500, 500, 106, 116, 500, 40, 500, 500, 500, 38, 500, 34, 500, 500, 44, 500, 46, 62, 500, 500, 90, 188, 500, 56, 52, 500, 500, 464, 500, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3906931439457481, "mean_inference_ms": 1.253513351455732, "mean_action_processing_ms": 0.14681344625051115, "mean_env_wait_ms": 0.0867060472647796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299213409423828, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.12302708625793457}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5902.5966235625865, "num_env_steps_trained_throughput_per_sec": 5902.5966235625865, "timesteps_total": 1044000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 2086.163, "sample_time_ms": 1874.432, "load_time_ms": 10.334, "load_throughput": 1161176.226, "learn_time_ms": 190.686, "learn_throughput": 62930.536, "synch_weights_time_ms": 8.806}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 3903, "training_iteration": 87, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-53", "timestamp": 1698247793, "time_this_iter_s": 2.0380003452301025, "time_total_s": 202.50212955474854, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 202.50212955474854, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 56.1, "ram_util_percent": 33.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2924697071141062e-27, "cur_lr": 0.0003, "total_loss": 6.769721539815267, "policy_loss": -0.0002237260341644287, "vf_loss": 6.769994926452637, "vf_explained_var": -1.2715657552083333e-06, "kl": 0.000302002414840293, "entropy": 0.4963042418162028, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1313.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.951999999999815, "episode_len_mean": 261.1, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, 41.90000000000001, 42.70000000000001, 43.50000000000001, 46.9, -50.00000000000044, 45.9, 24.69999999999991, 42.500000000000014, 44.300000000000004, 14.499999999999766, 39.70000000000002, 43.900000000000006, -50.00000000000044, 45.3, 43.900000000000006, 32.700000000000024, 44.7, 4.099999999999618, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.100000000000016, 31.300000000000004, -50.00000000000044, 44.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, 45.3, 32.30000000000002, 26.69999999999994, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.900000000000006, 29.69999999999998, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, 38.700000000000024, -50.00000000000044, 44.7, -50.00000000000044, 43.10000000000001, 2.499999999999595, 47.3, -50.00000000000044, 30.099999999999987, 44.900000000000006, 44.10000000000001, 45.5, -50.00000000000044, 45.7, 25.099999999999916, 44.900000000000006, 42.70000000000001, 39.10000000000002, -50.00000000000044, 37.70000000000003, 45.7, -50.00000000000044, 42.10000000000001, 41.70000000000002, 39.50000000000002, -50.00000000000044, 42.10000000000001], "episode_lengths": [500, 62, 82, 74, 66, 32, 500, 42, 254, 76, 58, 356, 104, 62, 500, 48, 62, 174, 54, 460, 500, 500, 106, 116, 500, 40, 500, 500, 500, 38, 500, 34, 500, 500, 44, 500, 46, 62, 500, 500, 90, 188, 500, 56, 52, 500, 500, 464, 500, 500, 48, 178, 234, 500, 58, 500, 52, 204, 78, 40, 500, 500, 46, 60, 500, 500, 500, 500, 84, 500, 500, 478, 500, 114, 500, 54, 500, 70, 476, 28, 500, 200, 52, 60, 46, 500, 44, 250, 52, 74, 110, 500, 124, 44, 500, 80, 84, 106, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39063076912676187, "mean_inference_ms": 1.2526877558830705, "mean_action_processing_ms": 0.14658790405073208, "mean_env_wait_ms": 0.0865344343370688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017997264862060547, "StateBufferConnector_ms": 0.0050008296966552734, "ViewRequirementAgentConnector_ms": 0.11699891090393066}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.951999999999815, "episode_len_mean": 261.1, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, 41.90000000000001, 42.70000000000001, 43.50000000000001, 46.9, -50.00000000000044, 45.9, 24.69999999999991, 42.500000000000014, 44.300000000000004, 14.499999999999766, 39.70000000000002, 43.900000000000006, -50.00000000000044, 45.3, 43.900000000000006, 32.700000000000024, 44.7, 4.099999999999618, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.100000000000016, 31.300000000000004, -50.00000000000044, 44.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, 45.3, 32.30000000000002, 26.69999999999994, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.900000000000006, 29.69999999999998, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, 38.700000000000024, -50.00000000000044, 44.7, -50.00000000000044, 43.10000000000001, 2.499999999999595, 47.3, -50.00000000000044, 30.099999999999987, 44.900000000000006, 44.10000000000001, 45.5, -50.00000000000044, 45.7, 25.099999999999916, 44.900000000000006, 42.70000000000001, 39.10000000000002, -50.00000000000044, 37.70000000000003, 45.7, -50.00000000000044, 42.10000000000001, 41.70000000000002, 39.50000000000002, -50.00000000000044, 42.10000000000001], "episode_lengths": [500, 62, 82, 74, 66, 32, 500, 42, 254, 76, 58, 356, 104, 62, 500, 48, 62, 174, 54, 460, 500, 500, 106, 116, 500, 40, 500, 500, 500, 38, 500, 34, 500, 500, 44, 500, 46, 62, 500, 500, 90, 188, 500, 56, 52, 500, 500, 464, 500, 500, 48, 178, 234, 500, 58, 500, 52, 204, 78, 40, 500, 500, 46, 60, 500, 500, 500, 500, 84, 500, 500, 478, 500, 114, 500, 54, 500, 70, 476, 28, 500, 200, 52, 60, 46, 500, 44, 250, 52, 74, 110, 500, 124, 44, 500, 80, 84, 106, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39063076912676187, "mean_inference_ms": 1.2526877558830705, "mean_action_processing_ms": 0.14658790405073208, "mean_env_wait_ms": 0.0865344343370688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017997264862060547, "StateBufferConnector_ms": 0.0050008296966552734, "ViewRequirementAgentConnector_ms": 0.11699891090393066}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5615.346519575363, "num_env_steps_trained_throughput_per_sec": 5615.346519575363, "timesteps_total": 1056000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 2066.659, "sample_time_ms": 1856.844, "load_time_ms": 9.933, "load_throughput": 1208039.766, "learn_time_ms": 188.972, "learn_throughput": 63501.392, "synch_weights_time_ms": 8.906}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 3952, "training_iteration": 88, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-55", "timestamp": 1698247795, "time_this_iter_s": 2.142000198364258, "time_total_s": 204.6441297531128, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 204.6441297531128, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 59.23333333333333, "ram_util_percent": 33.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.462348535570531e-28, "cur_lr": 0.0003, "total_loss": 6.653135204315186, "policy_loss": -7.441708197196325e-05, "vf_loss": 6.6532564481099445, "vf_explained_var": -1.6053517659505208e-06, "kl": 0.00017374973214524895, "entropy": 0.4686511556307475, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1328.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.352999999999807, "episode_len_mean": 272.08, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, 45.3, 32.30000000000002, 26.69999999999994, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.900000000000006, 29.69999999999998, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, 38.700000000000024, -50.00000000000044, 44.7, -50.00000000000044, 43.10000000000001, 2.499999999999595, 47.3, -50.00000000000044, 30.099999999999987, 44.900000000000006, 44.10000000000001, 45.5, -50.00000000000044, 45.7, 25.099999999999916, 44.900000000000006, 42.70000000000001, 39.10000000000002, -50.00000000000044, 37.70000000000003, 45.7, -50.00000000000044, 42.10000000000001, 41.70000000000002, 39.50000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 32.30000000000002, 45.5, -50.00000000000044, 36.10000000000004, 44.5, 45.3, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, 46.699999999999996, 38.10000000000002, -50.00000000000044, -50.00000000000044, 32.90000000000003, 30.9, 43.30000000000001, 46.099999999999994, -50.00000000000044, 39.70000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 11.29999999999972, -50.00000000000044, 45.7, 45.3, 19.69999999999984, 9.699999999999697, 27.299999999999947, 41.500000000000014, -50.00000000000044, 10.299999999999706], "episode_lengths": [500, 56, 52, 500, 500, 464, 500, 500, 48, 178, 234, 500, 58, 500, 52, 204, 78, 40, 500, 500, 46, 60, 500, 500, 500, 500, 84, 500, 500, 478, 500, 114, 500, 54, 500, 70, 476, 28, 500, 200, 52, 60, 46, 500, 44, 250, 52, 74, 110, 500, 124, 44, 500, 80, 84, 106, 500, 80, 500, 178, 46, 500, 140, 56, 48, 500, 74, 48, 500, 34, 120, 500, 500, 172, 192, 68, 40, 500, 104, 500, 82, 500, 500, 500, 34, 500, 58, 500, 500, 34, 388, 500, 44, 48, 304, 404, 228, 86, 500, 398]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38994585446487035, "mean_inference_ms": 1.251096277236823, "mean_action_processing_ms": 0.1468126644097407, "mean_env_wait_ms": 0.0864632557907598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01600193977355957, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.1088724136352539}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.352999999999807, "episode_len_mean": 272.08, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, 45.3, 32.30000000000002, 26.69999999999994, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.900000000000006, 29.69999999999998, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, 38.700000000000024, -50.00000000000044, 44.7, -50.00000000000044, 43.10000000000001, 2.499999999999595, 47.3, -50.00000000000044, 30.099999999999987, 44.900000000000006, 44.10000000000001, 45.5, -50.00000000000044, 45.7, 25.099999999999916, 44.900000000000006, 42.70000000000001, 39.10000000000002, -50.00000000000044, 37.70000000000003, 45.7, -50.00000000000044, 42.10000000000001, 41.70000000000002, 39.50000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 32.30000000000002, 45.5, -50.00000000000044, 36.10000000000004, 44.5, 45.3, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, 46.699999999999996, 38.10000000000002, -50.00000000000044, -50.00000000000044, 32.90000000000003, 30.9, 43.30000000000001, 46.099999999999994, -50.00000000000044, 39.70000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 11.29999999999972, -50.00000000000044, 45.7, 45.3, 19.69999999999984, 9.699999999999697, 27.299999999999947, 41.500000000000014, -50.00000000000044, 10.299999999999706], "episode_lengths": [500, 56, 52, 500, 500, 464, 500, 500, 48, 178, 234, 500, 58, 500, 52, 204, 78, 40, 500, 500, 46, 60, 500, 500, 500, 500, 84, 500, 500, 478, 500, 114, 500, 54, 500, 70, 476, 28, 500, 200, 52, 60, 46, 500, 44, 250, 52, 74, 110, 500, 124, 44, 500, 80, 84, 106, 500, 80, 500, 178, 46, 500, 140, 56, 48, 500, 74, 48, 500, 34, 120, 500, 500, 172, 192, 68, 40, 500, 104, 500, 82, 500, 500, 500, 34, 500, 58, 500, 500, 34, 388, 500, 44, 48, 304, 404, 228, 86, 500, 398]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38994585446487035, "mean_inference_ms": 1.251096277236823, "mean_action_processing_ms": 0.1468126644097407, "mean_env_wait_ms": 0.0864632557907598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01600193977355957, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.1088724136352539}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6113.971236243863, "num_env_steps_trained_throughput_per_sec": 6113.971236243863, "timesteps_total": 1068000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 2057.861, "sample_time_ms": 1844.938, "load_time_ms": 10.166, "load_throughput": 1180399.583, "learn_time_ms": 191.844, "learn_throughput": 62550.78, "synch_weights_time_ms": 8.909}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 3994, "training_iteration": 89, "trial_id": "9f288_00011", "date": "2023-10-25_16-29-57", "timestamp": 1698247797, "time_this_iter_s": 1.9677143096923828, "time_total_s": 206.61184406280518, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 206.61184406280518, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 56.9, "ram_util_percent": 33.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.2311742677852654e-28, "cur_lr": 0.0003, "total_loss": 6.5586012840271, "policy_loss": -1.9828975200653077e-05, "vf_loss": 6.558666451772054, "vf_explained_var": -1.1841456095377604e-06, "kl": 0.00018120772266361958, "entropy": 0.4520727276802063, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1343.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.032999999999827, "episode_len_mean": 255.3, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, 37.70000000000003, 45.7, -50.00000000000044, 42.10000000000001, 41.70000000000002, 39.50000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 32.30000000000002, 45.5, -50.00000000000044, 36.10000000000004, 44.5, 45.3, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, 46.699999999999996, 38.10000000000002, -50.00000000000044, -50.00000000000044, 32.90000000000003, 30.9, 43.30000000000001, 46.099999999999994, -50.00000000000044, 39.70000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 11.29999999999972, -50.00000000000044, 45.7, 45.3, 19.69999999999984, 9.699999999999697, 27.299999999999947, 41.500000000000014, -50.00000000000044, 10.299999999999706, -50.00000000000044, 32.100000000000016, -50.00000000000044, 36.10000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 47.3, -50.00000000000044, 47.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.5, 45.1, 22.299999999999876, -50.00000000000044, -50.00000000000044, 20.49999999999985, 47.3, 22.699999999999882, -50.00000000000044, 42.70000000000001, 37.90000000000003, 42.30000000000001, 45.1, 43.7, 46.9, 45.3, 31.300000000000004, 45.7, 44.5, -50.00000000000044, 26.89999999999994, -50.00000000000044, 39.50000000000002, 39.10000000000002, 42.900000000000006, 42.30000000000001, -50.00000000000044, 39.70000000000002], "episode_lengths": [110, 500, 124, 44, 500, 80, 84, 106, 500, 80, 500, 178, 46, 500, 140, 56, 48, 500, 74, 48, 500, 34, 120, 500, 500, 172, 192, 68, 40, 500, 104, 500, 82, 500, 500, 500, 34, 500, 58, 500, 500, 34, 388, 500, 44, 48, 304, 404, 228, 86, 500, 398, 500, 180, 500, 140, 40, 500, 500, 500, 500, 36, 500, 28, 500, 28, 500, 52, 500, 500, 500, 30, 56, 50, 278, 500, 500, 296, 28, 274, 500, 74, 122, 78, 50, 64, 32, 48, 188, 44, 56, 500, 232, 500, 106, 110, 72, 78, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3899009764177006, "mean_inference_ms": 1.250407811821588, "mean_action_processing_ms": 0.14669757338606843, "mean_env_wait_ms": 0.08655364978653092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016001224517822266, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.10186219215393066}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.032999999999827, "episode_len_mean": 255.3, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, 37.70000000000003, 45.7, -50.00000000000044, 42.10000000000001, 41.70000000000002, 39.50000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 32.30000000000002, 45.5, -50.00000000000044, 36.10000000000004, 44.5, 45.3, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, 46.699999999999996, 38.10000000000002, -50.00000000000044, -50.00000000000044, 32.90000000000003, 30.9, 43.30000000000001, 46.099999999999994, -50.00000000000044, 39.70000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 11.29999999999972, -50.00000000000044, 45.7, 45.3, 19.69999999999984, 9.699999999999697, 27.299999999999947, 41.500000000000014, -50.00000000000044, 10.299999999999706, -50.00000000000044, 32.100000000000016, -50.00000000000044, 36.10000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 47.3, -50.00000000000044, 47.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.5, 45.1, 22.299999999999876, -50.00000000000044, -50.00000000000044, 20.49999999999985, 47.3, 22.699999999999882, -50.00000000000044, 42.70000000000001, 37.90000000000003, 42.30000000000001, 45.1, 43.7, 46.9, 45.3, 31.300000000000004, 45.7, 44.5, -50.00000000000044, 26.89999999999994, -50.00000000000044, 39.50000000000002, 39.10000000000002, 42.900000000000006, 42.30000000000001, -50.00000000000044, 39.70000000000002], "episode_lengths": [110, 500, 124, 44, 500, 80, 84, 106, 500, 80, 500, 178, 46, 500, 140, 56, 48, 500, 74, 48, 500, 34, 120, 500, 500, 172, 192, 68, 40, 500, 104, 500, 82, 500, 500, 500, 34, 500, 58, 500, 500, 34, 388, 500, 44, 48, 304, 404, 228, 86, 500, 398, 500, 180, 500, 140, 40, 500, 500, 500, 500, 36, 500, 28, 500, 28, 500, 52, 500, 500, 500, 30, 56, 50, 278, 500, 500, 296, 28, 274, 500, 74, 122, 78, 50, 64, 32, 48, 188, 44, 56, 500, 232, 500, 106, 110, 72, 78, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3899009764177006, "mean_inference_ms": 1.250407811821588, "mean_action_processing_ms": 0.14669757338606843, "mean_env_wait_ms": 0.08655364978653092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016001224517822266, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.10186219215393066}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5594.285013097734, "num_env_steps_trained_throughput_per_sec": 5594.285013097734, "timesteps_total": 1080000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 2066.37, "sample_time_ms": 1845.563, "load_time_ms": 10.065, "load_throughput": 1192209.981, "learn_time_ms": 199.928, "learn_throughput": 60021.473, "synch_weights_time_ms": 8.91}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4042, "training_iteration": 90, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-00", "timestamp": 1698247800, "time_this_iter_s": 2.151042938232422, "time_total_s": 208.7628870010376, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 208.7628870010376, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 61.26666666666667, "ram_util_percent": 32.76666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6155871338926327e-28, "cur_lr": 0.0003, "total_loss": 6.478280639648437, "policy_loss": -0.00013454270859559377, "vf_loss": 6.478464539845785, "vf_explained_var": -1.0093053181966146e-06, "kl": 0.00011252159020690063, "entropy": 0.49402477343877155, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1358.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.575999999999818, "episode_len_mean": 254.84, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, -50.00000000000044, 10.299999999999706, -50.00000000000044, 32.100000000000016, -50.00000000000044, 36.10000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 47.3, -50.00000000000044, 47.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.5, 45.1, 22.299999999999876, -50.00000000000044, -50.00000000000044, 20.49999999999985, 47.3, 22.699999999999882, -50.00000000000044, 42.70000000000001, 37.90000000000003, 42.30000000000001, 45.1, 43.7, 46.9, 45.3, 31.300000000000004, 45.7, 44.5, -50.00000000000044, 26.89999999999994, -50.00000000000044, 39.50000000000002, 39.10000000000002, 42.900000000000006, 42.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.900000000000006, 47.7, 45.9, 44.7, 40.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 40.70000000000002, 45.5, 30.699999999999996, -50.00000000000044, 43.30000000000001, 38.50000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.699999999999996, 44.10000000000001, 45.5, -50.00000000000044, 47.1, -50.00000000000044, 44.7, -50.00000000000044, 39.70000000000002, 43.7, 46.9, 25.099999999999916, 46.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [86, 500, 398, 500, 180, 500, 140, 40, 500, 500, 500, 500, 36, 500, 28, 500, 28, 500, 52, 500, 500, 500, 30, 56, 50, 278, 500, 500, 296, 28, 274, 500, 74, 122, 78, 50, 64, 32, 48, 188, 44, 56, 500, 232, 500, 106, 110, 72, 78, 500, 104, 500, 500, 500, 46, 62, 24, 42, 54, 96, 96, 500, 500, 500, 500, 500, 36, 40, 500, 94, 46, 194, 500, 68, 116, 500, 36, 500, 500, 90, 34, 60, 46, 500, 30, 500, 54, 500, 104, 64, 32, 250, 36, 500, 500, 32, 500, 144, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38921351122042674, "mean_inference_ms": 1.248422934960559, "mean_action_processing_ms": 0.14676367181691682, "mean_env_wait_ms": 0.08664026935608028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016998291015625, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.10699081420898438}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.575999999999818, "episode_len_mean": 254.84, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, -50.00000000000044, 10.299999999999706, -50.00000000000044, 32.100000000000016, -50.00000000000044, 36.10000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 47.3, -50.00000000000044, 47.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.5, 45.1, 22.299999999999876, -50.00000000000044, -50.00000000000044, 20.49999999999985, 47.3, 22.699999999999882, -50.00000000000044, 42.70000000000001, 37.90000000000003, 42.30000000000001, 45.1, 43.7, 46.9, 45.3, 31.300000000000004, 45.7, 44.5, -50.00000000000044, 26.89999999999994, -50.00000000000044, 39.50000000000002, 39.10000000000002, 42.900000000000006, 42.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.900000000000006, 47.7, 45.9, 44.7, 40.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 40.70000000000002, 45.5, 30.699999999999996, -50.00000000000044, 43.30000000000001, 38.50000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.699999999999996, 44.10000000000001, 45.5, -50.00000000000044, 47.1, -50.00000000000044, 44.7, -50.00000000000044, 39.70000000000002, 43.7, 46.9, 25.099999999999916, 46.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [86, 500, 398, 500, 180, 500, 140, 40, 500, 500, 500, 500, 36, 500, 28, 500, 28, 500, 52, 500, 500, 500, 30, 56, 50, 278, 500, 500, 296, 28, 274, 500, 74, 122, 78, 50, 64, 32, 48, 188, 44, 56, 500, 232, 500, 106, 110, 72, 78, 500, 104, 500, 500, 500, 46, 62, 24, 42, 54, 96, 96, 500, 500, 500, 500, 500, 36, 40, 500, 94, 46, 194, 500, 68, 116, 500, 36, 500, 500, 90, 34, 60, 46, 500, 30, 500, 54, 500, 104, 64, 32, 250, 36, 500, 500, 32, 500, 144, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38921351122042674, "mean_inference_ms": 1.248422934960559, "mean_action_processing_ms": 0.14676367181691682, "mean_env_wait_ms": 0.08664026935608028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016998291015625, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.10699081420898438}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5879.318012096303, "num_env_steps_trained_throughput_per_sec": 5879.318012096303, "timesteps_total": 1092000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 2053.344, "sample_time_ms": 1843.77, "load_time_ms": 9.262, "load_throughput": 1295644.635, "learn_time_ms": 189.536, "learn_throughput": 63312.574, "synch_weights_time_ms": 8.872}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 4091, "training_iteration": 91, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-02", "timestamp": 1698247802, "time_this_iter_s": 2.047048807144165, "time_total_s": 210.80993580818176, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 210.80993580818176, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 55.96666666666667, "ram_util_percent": 32.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.077935669463164e-29, "cur_lr": 0.0003, "total_loss": 5.948325443267822, "policy_loss": -0.0003194461266199748, "vf_loss": 5.948691177368164, "vf_explained_var": -8.265177408854167e-07, "kl": 0.000586987807158342, "entropy": 0.4629408379395803, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1373.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3789999999998117, "episode_len_mean": 261.78, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, 46.9, 45.3, 31.300000000000004, 45.7, 44.5, -50.00000000000044, 26.89999999999994, -50.00000000000044, 39.50000000000002, 39.10000000000002, 42.900000000000006, 42.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.900000000000006, 47.7, 45.9, 44.7, 40.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 40.70000000000002, 45.5, 30.699999999999996, -50.00000000000044, 43.30000000000001, 38.50000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.699999999999996, 44.10000000000001, 45.5, -50.00000000000044, 47.1, -50.00000000000044, 44.7, -50.00000000000044, 39.70000000000002, 43.7, 46.9, 25.099999999999916, 46.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.900000000000006, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 36.900000000000034, -50.00000000000044, 45.9, 17.099999999999802, 31.500000000000007, -50.00000000000044], "episode_lengths": [64, 32, 48, 188, 44, 56, 500, 232, 500, 106, 110, 72, 78, 500, 104, 500, 500, 500, 46, 62, 24, 42, 54, 96, 96, 500, 500, 500, 500, 500, 36, 40, 500, 94, 46, 194, 500, 68, 116, 500, 36, 500, 500, 90, 34, 60, 46, 500, 30, 500, 54, 500, 104, 64, 32, 250, 36, 500, 500, 32, 500, 144, 500, 500, 46, 500, 500, 500, 500, 68, 66, 500, 500, 42, 500, 500, 102, 500, 34, 500, 126, 500, 500, 52, 62, 54, 500, 96, 500, 44, 500, 500, 500, 36, 132, 500, 42, 330, 186, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38885113232149715, "mean_inference_ms": 1.2478895838927455, "mean_action_processing_ms": 0.14683081560248518, "mean_env_wait_ms": 0.08635560903100543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023006439208984375, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.11600232124328613}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3789999999998117, "episode_len_mean": 261.78, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, 46.9, 45.3, 31.300000000000004, 45.7, 44.5, -50.00000000000044, 26.89999999999994, -50.00000000000044, 39.50000000000002, 39.10000000000002, 42.900000000000006, 42.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.900000000000006, 47.7, 45.9, 44.7, 40.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 40.70000000000002, 45.5, 30.699999999999996, -50.00000000000044, 43.30000000000001, 38.50000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.699999999999996, 44.10000000000001, 45.5, -50.00000000000044, 47.1, -50.00000000000044, 44.7, -50.00000000000044, 39.70000000000002, 43.7, 46.9, 25.099999999999916, 46.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.900000000000006, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 36.900000000000034, -50.00000000000044, 45.9, 17.099999999999802, 31.500000000000007, -50.00000000000044], "episode_lengths": [64, 32, 48, 188, 44, 56, 500, 232, 500, 106, 110, 72, 78, 500, 104, 500, 500, 500, 46, 62, 24, 42, 54, 96, 96, 500, 500, 500, 500, 500, 36, 40, 500, 94, 46, 194, 500, 68, 116, 500, 36, 500, 500, 90, 34, 60, 46, 500, 30, 500, 54, 500, 104, 64, 32, 250, 36, 500, 500, 32, 500, 144, 500, 500, 46, 500, 500, 500, 500, 68, 66, 500, 500, 42, 500, 500, 102, 500, 34, 500, 126, 500, 500, 52, 62, 54, 500, 96, 500, 44, 500, 500, 500, 36, 132, 500, 42, 330, 186, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38885113232149715, "mean_inference_ms": 1.2478895838927455, "mean_action_processing_ms": 0.14683081560248518, "mean_env_wait_ms": 0.08635560903100543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023006439208984375, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.11600232124328613}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5579.484487146544, "num_env_steps_trained_throughput_per_sec": 5579.484487146544, "timesteps_total": 1104000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 2067.197, "sample_time_ms": 1841.949, "load_time_ms": 9.261, "load_throughput": 1295818.092, "learn_time_ms": 205.23, "learn_throughput": 58470.855, "synch_weights_time_ms": 8.953}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 4127, "training_iteration": 92, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-04", "timestamp": 1698247804, "time_this_iter_s": 2.1564762592315674, "time_total_s": 212.96641206741333, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 212.96641206741333, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 62.36666666666667, "ram_util_percent": 32.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.038967834731582e-29, "cur_lr": 0.0003, "total_loss": 6.203934097290039, "policy_loss": -0.00013302514950434366, "vf_loss": 6.204118728637695, "vf_explained_var": -1.0728836059570312e-06, "kl": 0.0001293905968244265, "entropy": 0.5144353528817495, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1388.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.9489999999997957, "episode_len_mean": 276.08, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 44.10000000000001, 45.5, -50.00000000000044, 47.1, -50.00000000000044, 44.7, -50.00000000000044, 39.70000000000002, 43.7, 46.9, 25.099999999999916, 46.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.900000000000006, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 36.900000000000034, -50.00000000000044, 45.9, 17.099999999999802, 31.500000000000007, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.5, 8.49999999999968, 47.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 45.7, 43.900000000000006, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, 43.7, -50.00000000000044, 22.099999999999874, 43.50000000000001, 17.899999999999814, 38.300000000000026, 28.29999999999996, 45.7, 45.7, 41.90000000000001, 9.499999999999694, -50.00000000000044, -50.00000000000044, 44.7, 41.30000000000001, 42.30000000000001, 44.7], "episode_lengths": [34, 60, 46, 500, 30, 500, 54, 500, 104, 64, 32, 250, 36, 500, 500, 32, 500, 144, 500, 500, 46, 500, 500, 500, 500, 68, 66, 500, 500, 42, 500, 500, 102, 500, 34, 500, 126, 500, 500, 52, 62, 54, 500, 96, 500, 44, 500, 500, 500, 36, 132, 500, 42, 330, 186, 500, 500, 56, 500, 36, 416, 28, 52, 500, 500, 500, 248, 500, 500, 152, 58, 60, 500, 500, 500, 468, 500, 44, 62, 500, 46, 60, 500, 64, 500, 280, 66, 322, 118, 218, 44, 44, 82, 406, 500, 500, 54, 88, 78, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38903300276142383, "mean_inference_ms": 1.2477935488119574, "mean_action_processing_ms": 0.1463215777499221, "mean_env_wait_ms": 0.0862733377806418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021010398864746094, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.11299920082092285}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.9489999999997957, "episode_len_mean": 276.08, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 44.10000000000001, 45.5, -50.00000000000044, 47.1, -50.00000000000044, 44.7, -50.00000000000044, 39.70000000000002, 43.7, 46.9, 25.099999999999916, 46.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.900000000000006, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 36.900000000000034, -50.00000000000044, 45.9, 17.099999999999802, 31.500000000000007, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.5, 8.49999999999968, 47.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 45.7, 43.900000000000006, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, 43.7, -50.00000000000044, 22.099999999999874, 43.50000000000001, 17.899999999999814, 38.300000000000026, 28.29999999999996, 45.7, 45.7, 41.90000000000001, 9.499999999999694, -50.00000000000044, -50.00000000000044, 44.7, 41.30000000000001, 42.30000000000001, 44.7], "episode_lengths": [34, 60, 46, 500, 30, 500, 54, 500, 104, 64, 32, 250, 36, 500, 500, 32, 500, 144, 500, 500, 46, 500, 500, 500, 500, 68, 66, 500, 500, 42, 500, 500, 102, 500, 34, 500, 126, 500, 500, 52, 62, 54, 500, 96, 500, 44, 500, 500, 500, 36, 132, 500, 42, 330, 186, 500, 500, 56, 500, 36, 416, 28, 52, 500, 500, 500, 248, 500, 500, 152, 58, 60, 500, 500, 500, 468, 500, 44, 62, 500, 46, 60, 500, 64, 500, 280, 66, 322, 118, 218, 44, 44, 82, 406, 500, 500, 54, 88, 78, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38903300276142383, "mean_inference_ms": 1.2477935488119574, "mean_action_processing_ms": 0.1463215777499221, "mean_env_wait_ms": 0.0862733377806418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021010398864746094, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.11299920082092285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6089.879467166908, "num_env_steps_trained_throughput_per_sec": 6089.879467166908, "timesteps_total": 1116000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 2065.584, "sample_time_ms": 1838.136, "load_time_ms": 8.8, "load_throughput": 1363576.338, "learn_time_ms": 207.988, "learn_throughput": 57695.537, "synch_weights_time_ms": 8.954}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4171, "training_iteration": 93, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-06", "timestamp": 1698247806, "time_this_iter_s": 1.9764697551727295, "time_total_s": 214.94288182258606, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 214.94288182258606, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 56.866666666666674, "ram_util_percent": 32.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.019483917365791e-29, "cur_lr": 0.0003, "total_loss": 6.334625275929769, "policy_loss": -0.0005126699805259704, "vf_loss": 6.335186831156412, "vf_explained_var": -5.80151875813802e-07, "kl": 0.0009192256069354698, "entropy": 0.4892423431078593, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1403.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.534999999999807, "episode_len_mean": 270.28, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 36.900000000000034, -50.00000000000044, 45.9, 17.099999999999802, 31.500000000000007, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.5, 8.49999999999968, 47.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 45.7, 43.900000000000006, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, 43.7, -50.00000000000044, 22.099999999999874, 43.50000000000001, 17.899999999999814, 38.300000000000026, 28.29999999999996, 45.7, 45.7, 41.90000000000001, 9.499999999999694, -50.00000000000044, -50.00000000000044, 44.7, 41.30000000000001, 42.30000000000001, 44.7, -50.00000000000044, 5.499999999999638, 46.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 44.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 29.49999999999998, 34.10000000000004, 44.7, 35.30000000000004, 7.09999999999966, 44.900000000000006, -50.00000000000044, 41.70000000000002, 19.09999999999983, 45.3, 24.099999999999902, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 35.500000000000036, -50.00000000000044, 45.3, 11.499999999999723, -50.00000000000044, 46.099999999999994, 45.7, 46.9, 43.50000000000001, 24.69999999999991, -50.00000000000044, 13.899999999999757], "episode_lengths": [500, 44, 500, 500, 500, 36, 132, 500, 42, 330, 186, 500, 500, 56, 500, 36, 416, 28, 52, 500, 500, 500, 248, 500, 500, 152, 58, 60, 500, 500, 500, 468, 500, 44, 62, 500, 46, 60, 500, 64, 500, 280, 66, 322, 118, 218, 44, 44, 82, 406, 500, 500, 54, 88, 78, 54, 500, 446, 36, 96, 500, 500, 56, 54, 500, 500, 52, 500, 500, 500, 500, 72, 206, 160, 54, 148, 430, 52, 500, 84, 310, 48, 260, 32, 500, 34, 500, 46, 146, 500, 48, 386, 500, 40, 44, 32, 66, 254, 500, 362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3886151723457128, "mean_inference_ms": 1.2466178886448445, "mean_action_processing_ms": 0.1461337131399467, "mean_env_wait_ms": 0.08607747655147166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018004894256591797, "StateBufferConnector_ms": 0.009002447128295898, "ViewRequirementAgentConnector_ms": 0.09699797630310059}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.534999999999807, "episode_len_mean": 270.28, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 36.900000000000034, -50.00000000000044, 45.9, 17.099999999999802, 31.500000000000007, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.5, 8.49999999999968, 47.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 45.7, 43.900000000000006, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, 43.7, -50.00000000000044, 22.099999999999874, 43.50000000000001, 17.899999999999814, 38.300000000000026, 28.29999999999996, 45.7, 45.7, 41.90000000000001, 9.499999999999694, -50.00000000000044, -50.00000000000044, 44.7, 41.30000000000001, 42.30000000000001, 44.7, -50.00000000000044, 5.499999999999638, 46.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 44.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 29.49999999999998, 34.10000000000004, 44.7, 35.30000000000004, 7.09999999999966, 44.900000000000006, -50.00000000000044, 41.70000000000002, 19.09999999999983, 45.3, 24.099999999999902, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 35.500000000000036, -50.00000000000044, 45.3, 11.499999999999723, -50.00000000000044, 46.099999999999994, 45.7, 46.9, 43.50000000000001, 24.69999999999991, -50.00000000000044, 13.899999999999757], "episode_lengths": [500, 44, 500, 500, 500, 36, 132, 500, 42, 330, 186, 500, 500, 56, 500, 36, 416, 28, 52, 500, 500, 500, 248, 500, 500, 152, 58, 60, 500, 500, 500, 468, 500, 44, 62, 500, 46, 60, 500, 64, 500, 280, 66, 322, 118, 218, 44, 44, 82, 406, 500, 500, 54, 88, 78, 54, 500, 446, 36, 96, 500, 500, 56, 54, 500, 500, 52, 500, 500, 500, 500, 72, 206, 160, 54, 148, 430, 52, 500, 84, 310, 48, 260, 32, 500, 34, 500, 46, 146, 500, 48, 386, 500, 40, 44, 32, 66, 254, 500, 362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3886151723457128, "mean_inference_ms": 1.2466178886448445, "mean_action_processing_ms": 0.1461337131399467, "mean_env_wait_ms": 0.08607747655147166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018004894256591797, "StateBufferConnector_ms": 0.009002447128295898, "ViewRequirementAgentConnector_ms": 0.09699797630310059}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5606.111028996779, "num_env_steps_trained_throughput_per_sec": 5606.111028996779, "timesteps_total": 1128000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 2069.898, "sample_time_ms": 1847.605, "load_time_ms": 8.878, "load_throughput": 1351678.68, "learn_time_ms": 202.779, "learn_throughput": 59177.73, "synch_weights_time_ms": 9.032}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 4215, "training_iteration": 94, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-08", "timestamp": 1698247808, "time_this_iter_s": 2.146267890930176, "time_total_s": 217.08914971351624, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 217.08914971351624, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 58.36666666666667, "ram_util_percent": 31.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0097419586828954e-29, "cur_lr": 0.0003, "total_loss": 6.737866655985514, "policy_loss": -0.00017908612887064616, "vf_loss": 6.7380929311116535, "vf_explained_var": -1.708666483561198e-06, "kl": 0.0007235962120830663, "entropy": 0.4723519484202067, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.8339999999998255, "episode_len_mean": 252.3, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 41.30000000000001, 42.30000000000001, 44.7, -50.00000000000044, 5.499999999999638, 46.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 44.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 29.49999999999998, 34.10000000000004, 44.7, 35.30000000000004, 7.09999999999966, 44.900000000000006, -50.00000000000044, 41.70000000000002, 19.09999999999983, 45.3, 24.099999999999902, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 35.500000000000036, -50.00000000000044, 45.3, 11.499999999999723, -50.00000000000044, 46.099999999999994, 45.7, 46.9, 43.50000000000001, 24.69999999999991, -50.00000000000044, 13.899999999999757, -50.00000000000044, 44.900000000000006, 41.500000000000014, 38.700000000000024, 43.50000000000001, 47.7, 29.49999999999998, 42.10000000000001, 43.30000000000001, 44.300000000000004, 45.3, 47.5, -50.00000000000044, 38.50000000000003, 33.90000000000004, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, 25.499999999999922, -50.00000000000044, 44.900000000000006, 10.099999999999703, -50.00000000000044, 46.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.1, 27.899999999999956, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.70000000000001], "episode_lengths": [54, 88, 78, 54, 500, 446, 36, 96, 500, 500, 56, 54, 500, 500, 52, 500, 500, 500, 500, 72, 206, 160, 54, 148, 430, 52, 500, 84, 310, 48, 260, 32, 500, 34, 500, 46, 146, 500, 48, 386, 500, 40, 44, 32, 66, 254, 500, 362, 500, 52, 86, 114, 66, 24, 206, 80, 68, 58, 48, 26, 500, 116, 162, 90, 500, 500, 40, 90, 500, 246, 500, 52, 400, 500, 36, 38, 500, 500, 500, 500, 500, 130, 500, 500, 80, 68, 38, 500, 500, 66, 50, 222, 500, 26, 500, 500, 500, 50, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38886025636723226, "mean_inference_ms": 1.24563646302004, "mean_action_processing_ms": 0.14597898212659277, "mean_env_wait_ms": 0.08628663164898304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02602553367614746, "StateBufferConnector_ms": 0.01100301742553711, "ViewRequirementAgentConnector_ms": 0.08399152755737305}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.8339999999998255, "episode_len_mean": 252.3, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 41.30000000000001, 42.30000000000001, 44.7, -50.00000000000044, 5.499999999999638, 46.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 44.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 29.49999999999998, 34.10000000000004, 44.7, 35.30000000000004, 7.09999999999966, 44.900000000000006, -50.00000000000044, 41.70000000000002, 19.09999999999983, 45.3, 24.099999999999902, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 35.500000000000036, -50.00000000000044, 45.3, 11.499999999999723, -50.00000000000044, 46.099999999999994, 45.7, 46.9, 43.50000000000001, 24.69999999999991, -50.00000000000044, 13.899999999999757, -50.00000000000044, 44.900000000000006, 41.500000000000014, 38.700000000000024, 43.50000000000001, 47.7, 29.49999999999998, 42.10000000000001, 43.30000000000001, 44.300000000000004, 45.3, 47.5, -50.00000000000044, 38.50000000000003, 33.90000000000004, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, 25.499999999999922, -50.00000000000044, 44.900000000000006, 10.099999999999703, -50.00000000000044, 46.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.1, 27.899999999999956, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.70000000000001], "episode_lengths": [54, 88, 78, 54, 500, 446, 36, 96, 500, 500, 56, 54, 500, 500, 52, 500, 500, 500, 500, 72, 206, 160, 54, 148, 430, 52, 500, 84, 310, 48, 260, 32, 500, 34, 500, 46, 146, 500, 48, 386, 500, 40, 44, 32, 66, 254, 500, 362, 500, 52, 86, 114, 66, 24, 206, 80, 68, 58, 48, 26, 500, 116, 162, 90, 500, 500, 40, 90, 500, 246, 500, 52, 400, 500, 36, 38, 500, 500, 500, 500, 500, 130, 500, 500, 80, 68, 38, 500, 500, 66, 50, 222, 500, 26, 500, 500, 500, 50, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38886025636723226, "mean_inference_ms": 1.24563646302004, "mean_action_processing_ms": 0.14597898212659277, "mean_env_wait_ms": 0.08628663164898304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02602553367614746, "StateBufferConnector_ms": 0.01100301742553711, "ViewRequirementAgentConnector_ms": 0.08399152755737305}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5671.102593906463, "num_env_steps_trained_throughput_per_sec": 5671.102593906463, "timesteps_total": 1140000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 2082.494, "sample_time_ms": 1852.4, "load_time_ms": 9.078, "load_throughput": 1321921.911, "learn_time_ms": 210.382, "learn_throughput": 57039.156, "synch_weights_time_ms": 8.932}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 4267, "training_iteration": 95, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-10", "timestamp": 1698247810, "time_this_iter_s": 2.1209876537323, "time_total_s": 219.21013736724854, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 219.21013736724854, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 57.43333333333334, "ram_util_percent": 31.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.048709793414477e-30, "cur_lr": 0.0003, "total_loss": 6.29129155476888, "policy_loss": -3.122451404730479e-05, "vf_loss": 6.291372617085774, "vf_explained_var": -1.1046727498372397e-06, "kl": 0.0009189508178243008, "entropy": 0.4971470375855764, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1433.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9439999999998165, "episode_len_mean": 261.16, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.69999999999991, -50.00000000000044, 13.899999999999757, -50.00000000000044, 44.900000000000006, 41.500000000000014, 38.700000000000024, 43.50000000000001, 47.7, 29.49999999999998, 42.10000000000001, 43.30000000000001, 44.300000000000004, 45.3, 47.5, -50.00000000000044, 38.50000000000003, 33.90000000000004, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, 25.499999999999922, -50.00000000000044, 44.900000000000006, 10.099999999999703, -50.00000000000044, 46.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.1, 27.899999999999956, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.70000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 37.50000000000003, 28.699999999999967, 46.699999999999996, -50.00000000000044, 46.9, -50.00000000000044, 43.7, 45.9, 34.50000000000004, 46.699999999999996, -50.00000000000044, 44.5, 35.30000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 33.30000000000003, 3.499999999999609, 46.699999999999996, 45.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 46.3, 40.30000000000002, 42.10000000000001, 42.10000000000001, 40.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.5], "episode_lengths": [254, 500, 362, 500, 52, 86, 114, 66, 24, 206, 80, 68, 58, 48, 26, 500, 116, 162, 90, 500, 500, 40, 90, 500, 246, 500, 52, 400, 500, 36, 38, 500, 500, 500, 500, 500, 130, 500, 500, 80, 68, 38, 500, 500, 66, 50, 222, 500, 26, 500, 500, 500, 50, 500, 74, 100, 500, 500, 126, 214, 34, 500, 32, 500, 64, 42, 156, 34, 500, 56, 148, 60, 500, 500, 500, 144, 500, 500, 168, 466, 34, 46, 500, 500, 44, 500, 500, 500, 56, 38, 98, 80, 80, 92, 500, 52, 500, 500, 88, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.388251699803291, "mean_inference_ms": 1.2449397228978634, "mean_action_processing_ms": 0.14588151223358914, "mean_env_wait_ms": 0.08615683082822741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030019044876098633, "StateBufferConnector_ms": 0.011003255844116211, "ViewRequirementAgentConnector_ms": 0.1019747257232666}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9439999999998165, "episode_len_mean": 261.16, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.69999999999991, -50.00000000000044, 13.899999999999757, -50.00000000000044, 44.900000000000006, 41.500000000000014, 38.700000000000024, 43.50000000000001, 47.7, 29.49999999999998, 42.10000000000001, 43.30000000000001, 44.300000000000004, 45.3, 47.5, -50.00000000000044, 38.50000000000003, 33.90000000000004, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, 25.499999999999922, -50.00000000000044, 44.900000000000006, 10.099999999999703, -50.00000000000044, 46.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.1, 27.899999999999956, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.70000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 37.50000000000003, 28.699999999999967, 46.699999999999996, -50.00000000000044, 46.9, -50.00000000000044, 43.7, 45.9, 34.50000000000004, 46.699999999999996, -50.00000000000044, 44.5, 35.30000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 33.30000000000003, 3.499999999999609, 46.699999999999996, 45.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 46.3, 40.30000000000002, 42.10000000000001, 42.10000000000001, 40.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.5], "episode_lengths": [254, 500, 362, 500, 52, 86, 114, 66, 24, 206, 80, 68, 58, 48, 26, 500, 116, 162, 90, 500, 500, 40, 90, 500, 246, 500, 52, 400, 500, 36, 38, 500, 500, 500, 500, 500, 130, 500, 500, 80, 68, 38, 500, 500, 66, 50, 222, 500, 26, 500, 500, 500, 50, 500, 74, 100, 500, 500, 126, 214, 34, 500, 32, 500, 64, 42, 156, 34, 500, 56, 148, 60, 500, 500, 500, 144, 500, 500, 168, 466, 34, 46, 500, 500, 44, 500, 500, 500, 56, 38, 98, 80, 80, 92, 500, 52, 500, 500, 88, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.388251699803291, "mean_inference_ms": 1.2449397228978634, "mean_action_processing_ms": 0.14588151223358914, "mean_env_wait_ms": 0.08615683082822741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030019044876098633, "StateBufferConnector_ms": 0.011003255844116211, "ViewRequirementAgentConnector_ms": 0.1019747257232666}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5387.074591040453, "num_env_steps_trained_throughput_per_sec": 5387.074591040453, "timesteps_total": 1152000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 2092.411, "sample_time_ms": 1849.529, "load_time_ms": 9.365, "load_throughput": 1281349.077, "learn_time_ms": 222.981, "learn_throughput": 53816.25, "synch_weights_time_ms": 8.933}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4312, "training_iteration": 96, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-12", "timestamp": 1698247812, "time_this_iter_s": 2.233934164047241, "time_total_s": 221.44407153129578, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 221.44407153129578, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 58.23333333333333, "ram_util_percent": 31.366666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5243548967072386e-30, "cur_lr": 0.0003, "total_loss": 6.941490904490153, "policy_loss": -8.869618177413941e-05, "vf_loss": 6.941632970174154, "vf_explained_var": -1.1126200358072917e-06, "kl": 0.00021544226066604703, "entropy": 0.53282763560613, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1448.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.328999999999825, "episode_len_mean": 252.32, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 37.50000000000003, 28.699999999999967, 46.699999999999996, -50.00000000000044, 46.9, -50.00000000000044, 43.7, 45.9, 34.50000000000004, 46.699999999999996, -50.00000000000044, 44.5, 35.30000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 33.30000000000003, 3.499999999999609, 46.699999999999996, 45.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 46.3, 40.30000000000002, 42.10000000000001, 42.10000000000001, 40.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, 45.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.7, 46.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.9, 26.69999999999994, 35.500000000000036, 24.899999999999913, 44.7, 46.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 45.3, 42.10000000000001, -50.00000000000044, 24.499999999999908, 42.900000000000006, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 46.5, -50.00000000000044, 10.699999999999712, 38.10000000000002, 46.9, 44.5, 43.10000000000001, 36.50000000000003], "episode_lengths": [500, 74, 100, 500, 500, 126, 214, 34, 500, 32, 500, 64, 42, 156, 34, 500, 56, 148, 60, 500, 500, 500, 144, 500, 500, 168, 466, 34, 46, 500, 500, 44, 500, 500, 500, 56, 38, 98, 80, 80, 92, 500, 52, 500, 500, 88, 46, 500, 44, 86, 500, 500, 80, 52, 500, 500, 500, 40, 24, 38, 76, 500, 500, 500, 142, 42, 234, 146, 252, 54, 32, 500, 76, 500, 500, 500, 500, 46, 54, 500, 48, 80, 500, 256, 72, 76, 60, 500, 500, 62, 500, 44, 36, 500, 394, 120, 32, 56, 70, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873872174046544, "mean_inference_ms": 1.2440579028964145, "mean_action_processing_ms": 0.14571536032631988, "mean_env_wait_ms": 0.08597492180670041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027215003967285156, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.12796568870544434}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.328999999999825, "episode_len_mean": 252.32, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 37.50000000000003, 28.699999999999967, 46.699999999999996, -50.00000000000044, 46.9, -50.00000000000044, 43.7, 45.9, 34.50000000000004, 46.699999999999996, -50.00000000000044, 44.5, 35.30000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 33.30000000000003, 3.499999999999609, 46.699999999999996, 45.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 46.3, 40.30000000000002, 42.10000000000001, 42.10000000000001, 40.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, 45.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.7, 46.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.9, 26.69999999999994, 35.500000000000036, 24.899999999999913, 44.7, 46.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 45.3, 42.10000000000001, -50.00000000000044, 24.499999999999908, 42.900000000000006, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 46.5, -50.00000000000044, 10.699999999999712, 38.10000000000002, 46.9, 44.5, 43.10000000000001, 36.50000000000003], "episode_lengths": [500, 74, 100, 500, 500, 126, 214, 34, 500, 32, 500, 64, 42, 156, 34, 500, 56, 148, 60, 500, 500, 500, 144, 500, 500, 168, 466, 34, 46, 500, 500, 44, 500, 500, 500, 56, 38, 98, 80, 80, 92, 500, 52, 500, 500, 88, 46, 500, 44, 86, 500, 500, 80, 52, 500, 500, 500, 40, 24, 38, 76, 500, 500, 500, 142, 42, 234, 146, 252, 54, 32, 500, 76, 500, 500, 500, 500, 46, 54, 500, 48, 80, 500, 256, 72, 76, 60, 500, 500, 62, 500, 44, 36, 500, 394, 120, 32, 56, 70, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873872174046544, "mean_inference_ms": 1.2440579028964145, "mean_action_processing_ms": 0.14571536032631988, "mean_env_wait_ms": 0.08597492180670041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027215003967285156, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.12796568870544434}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5958.153892193736, "num_env_steps_trained_throughput_per_sec": 5958.153892193736, "timesteps_total": 1164000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 2090.515, "sample_time_ms": 1851.637, "load_time_ms": 9.065, "load_throughput": 1323740.226, "learn_time_ms": 219.486, "learn_throughput": 54673.126, "synch_weights_time_ms": 8.924}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 4365, "training_iteration": 97, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-14", "timestamp": 1698247814, "time_this_iter_s": 2.0200467109680176, "time_total_s": 223.4641182422638, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 223.4641182422638, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 55.4, "ram_util_percent": 31.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2621774483536193e-30, "cur_lr": 0.0003, "total_loss": 5.970178127288818, "policy_loss": -0.0002628527581691742, "vf_loss": 5.970484892527263, "vf_explained_var": -9.695688883463541e-07, "kl": 0.0003277567924783398, "entropy": 0.4388383646806081, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1463.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.03799999999982, "episode_len_mean": 250.22, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, 45.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.7, 46.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.9, 26.69999999999994, 35.500000000000036, 24.899999999999913, 44.7, 46.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 45.3, 42.10000000000001, -50.00000000000044, 24.499999999999908, 42.900000000000006, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 46.5, -50.00000000000044, 10.699999999999712, 38.10000000000002, 46.9, 44.5, 43.10000000000001, 36.50000000000003, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 44.900000000000006, 42.30000000000001, -50.00000000000044, 39.10000000000002, 43.900000000000006, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 44.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.7, 30.699999999999996, -50.00000000000044, 44.300000000000004, 36.70000000000003, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 38.10000000000002, 46.9, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.7, 46.099999999999994], "episode_lengths": [52, 500, 500, 88, 46, 500, 44, 86, 500, 500, 80, 52, 500, 500, 500, 40, 24, 38, 76, 500, 500, 500, 142, 42, 234, 146, 252, 54, 32, 500, 76, 500, 500, 500, 500, 46, 54, 500, 48, 80, 500, 256, 72, 76, 60, 500, 500, 62, 500, 44, 36, 500, 394, 120, 32, 56, 70, 136, 500, 46, 500, 500, 500, 42, 52, 78, 500, 110, 62, 500, 40, 44, 500, 56, 100, 500, 500, 500, 500, 500, 134, 54, 194, 500, 58, 134, 48, 52, 500, 500, 32, 120, 32, 500, 132, 500, 52, 500, 64, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38752277759530157, "mean_inference_ms": 1.2432142749505632, "mean_action_processing_ms": 0.1453906012308854, "mean_env_wait_ms": 0.08607772486430988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022209644317626953, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.1089792251586914}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.03799999999982, "episode_len_mean": 250.22, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, 45.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.7, 46.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.9, 26.69999999999994, 35.500000000000036, 24.899999999999913, 44.7, 46.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 45.3, 42.10000000000001, -50.00000000000044, 24.499999999999908, 42.900000000000006, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 46.5, -50.00000000000044, 10.699999999999712, 38.10000000000002, 46.9, 44.5, 43.10000000000001, 36.50000000000003, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 44.900000000000006, 42.30000000000001, -50.00000000000044, 39.10000000000002, 43.900000000000006, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 44.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.7, 30.699999999999996, -50.00000000000044, 44.300000000000004, 36.70000000000003, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 38.10000000000002, 46.9, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.7, 46.099999999999994], "episode_lengths": [52, 500, 500, 88, 46, 500, 44, 86, 500, 500, 80, 52, 500, 500, 500, 40, 24, 38, 76, 500, 500, 500, 142, 42, 234, 146, 252, 54, 32, 500, 76, 500, 500, 500, 500, 46, 54, 500, 48, 80, 500, 256, 72, 76, 60, 500, 500, 62, 500, 44, 36, 500, 394, 120, 32, 56, 70, 136, 500, 46, 500, 500, 500, 42, 52, 78, 500, 110, 62, 500, 40, 44, 500, 56, 100, 500, 500, 500, 500, 500, 134, 54, 194, 500, 58, 134, 48, 52, 500, 500, 32, 120, 32, 500, 132, 500, 52, 500, 64, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38752277759530157, "mean_inference_ms": 1.2432142749505632, "mean_action_processing_ms": 0.1453906012308854, "mean_env_wait_ms": 0.08607772486430988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022209644317626953, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.1089792251586914}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5583.876272542373, "num_env_steps_trained_throughput_per_sec": 5583.876272542373, "timesteps_total": 1176000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 2091.619, "sample_time_ms": 1853.804, "load_time_ms": 9.677, "load_throughput": 1240074.506, "learn_time_ms": 217.912, "learn_throughput": 55068.081, "synch_weights_time_ms": 8.924}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 4407, "training_iteration": 98, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-17", "timestamp": 1698247817, "time_this_iter_s": 2.153764009475708, "time_total_s": 225.6178822517395, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 225.6178822517395, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 59.73333333333333, "ram_util_percent": 31.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.3108872417680965e-31, "cur_lr": 0.0003, "total_loss": 6.391028149922689, "policy_loss": -0.0003016830732425054, "vf_loss": 6.391372521718343, "vf_explained_var": -1.1841456095377604e-06, "kl": 0.0006027405141670291, "entropy": 0.42829773426055906, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1478.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.272999999999808, "episode_len_mean": 262.84, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 46.5, -50.00000000000044, 10.699999999999712, 38.10000000000002, 46.9, 44.5, 43.10000000000001, 36.50000000000003, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 44.900000000000006, 42.30000000000001, -50.00000000000044, 39.10000000000002, 43.900000000000006, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 44.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.7, 30.699999999999996, -50.00000000000044, 44.300000000000004, 36.70000000000003, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 38.10000000000002, 46.9, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.7, 46.099999999999994, -50.00000000000044, 13.899999999999757, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 32.100000000000016, 45.9, -50.00000000000044, 47.1, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.7, 47.1, 46.3, 28.89999999999997, 47.5, 47.1, 43.7, -50.00000000000044, 47.1, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9], "episode_lengths": [500, 500, 62, 500, 44, 36, 500, 394, 120, 32, 56, 70, 136, 500, 46, 500, 500, 500, 42, 52, 78, 500, 110, 62, 500, 40, 44, 500, 56, 100, 500, 500, 500, 500, 500, 134, 54, 194, 500, 58, 134, 48, 52, 500, 500, 32, 120, 32, 500, 132, 500, 52, 500, 64, 40, 500, 362, 100, 500, 500, 500, 156, 30, 500, 500, 500, 100, 500, 500, 76, 180, 42, 500, 30, 500, 152, 500, 56, 500, 500, 64, 500, 82, 500, 500, 74, 54, 30, 38, 212, 26, 30, 64, 500, 30, 38, 500, 500, 500, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873150899093658, "mean_inference_ms": 1.2424972688002287, "mean_action_processing_ms": 0.1456357851586174, "mean_env_wait_ms": 0.08589235451702441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599644660949707, "StateBufferConnector_ms": 0.0029981136322021484, "ViewRequirementAgentConnector_ms": 0.10098671913146973}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.272999999999808, "episode_len_mean": 262.84, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 46.5, -50.00000000000044, 10.699999999999712, 38.10000000000002, 46.9, 44.5, 43.10000000000001, 36.50000000000003, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 44.900000000000006, 42.30000000000001, -50.00000000000044, 39.10000000000002, 43.900000000000006, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 44.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.7, 30.699999999999996, -50.00000000000044, 44.300000000000004, 36.70000000000003, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 38.10000000000002, 46.9, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.7, 46.099999999999994, -50.00000000000044, 13.899999999999757, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 32.100000000000016, 45.9, -50.00000000000044, 47.1, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.7, 47.1, 46.3, 28.89999999999997, 47.5, 47.1, 43.7, -50.00000000000044, 47.1, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9], "episode_lengths": [500, 500, 62, 500, 44, 36, 500, 394, 120, 32, 56, 70, 136, 500, 46, 500, 500, 500, 42, 52, 78, 500, 110, 62, 500, 40, 44, 500, 56, 100, 500, 500, 500, 500, 500, 134, 54, 194, 500, 58, 134, 48, 52, 500, 500, 32, 120, 32, 500, 132, 500, 52, 500, 64, 40, 500, 362, 100, 500, 500, 500, 156, 30, 500, 500, 500, 100, 500, 500, 76, 180, 42, 500, 30, 500, 152, 500, 56, 500, 500, 64, 500, 82, 500, 500, 74, 54, 30, 38, 212, 26, 30, 64, 500, 30, 38, 500, 500, 500, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873150899093658, "mean_inference_ms": 1.2424972688002287, "mean_action_processing_ms": 0.1456357851586174, "mean_env_wait_ms": 0.08589235451702441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599644660949707, "StateBufferConnector_ms": 0.0029981136322021484, "ViewRequirementAgentConnector_ms": 0.10098671913146973}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5796.527472026308, "num_env_steps_trained_throughput_per_sec": 5796.527472026308, "timesteps_total": 1188000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 2102.368, "sample_time_ms": 1858.49, "load_time_ms": 9.783, "load_throughput": 1226640.801, "learn_time_ms": 223.691, "learn_throughput": 53645.479, "synch_weights_time_ms": 8.903}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4452, "training_iteration": 99, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-19", "timestamp": 1698247819, "time_this_iter_s": 2.075181245803833, "time_total_s": 227.69306349754333, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 227.69306349754333, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 56.46666666666666, "ram_util_percent": 30.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.1554436208840483e-31, "cur_lr": 0.0003, "total_loss": 6.40664218266805, "policy_loss": -3.1925489505132036e-05, "vf_loss": 6.406717967987061, "vf_explained_var": -1.2954076131184896e-06, "kl": 8.426978180580136e-05, "entropy": 0.4390753169854482, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1493.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8839999999998028, "episode_len_mean": 271.72, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 38.10000000000002, 46.9, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.7, 46.099999999999994, -50.00000000000044, 13.899999999999757, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 32.100000000000016, 45.9, -50.00000000000044, 47.1, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.7, 47.1, 46.3, 28.89999999999997, 47.5, 47.1, 43.7, -50.00000000000044, 47.1, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.300000000000004, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 43.30000000000001, 46.3, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.7, -50.00000000000044, 43.900000000000006, 45.3, 47.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 35.30000000000004, 43.10000000000001, 32.100000000000016, -50.00000000000044, 31.300000000000004, -50.00000000000044, 34.30000000000004, 5.6999999999996405, 39.50000000000002, 45.5, 46.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.5], "episode_lengths": [52, 500, 500, 32, 120, 32, 500, 132, 500, 52, 500, 64, 40, 500, 362, 100, 500, 500, 500, 156, 30, 500, 500, 500, 100, 500, 500, 76, 180, 42, 500, 30, 500, 152, 500, 56, 500, 500, 64, 500, 82, 500, 500, 74, 54, 30, 38, 212, 26, 30, 64, 500, 30, 38, 500, 500, 500, 32, 500, 58, 192, 500, 500, 500, 216, 68, 38, 500, 110, 500, 500, 132, 44, 500, 62, 48, 28, 500, 118, 500, 500, 148, 70, 180, 500, 188, 500, 158, 444, 106, 46, 32, 500, 40, 500, 500, 38, 500, 500, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38709051033430414, "mean_inference_ms": 1.241952329683027, "mean_action_processing_ms": 0.14573606953181042, "mean_env_wait_ms": 0.08590712634685885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026988983154296875, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.09198927879333496}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8839999999998028, "episode_len_mean": 271.72, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 38.10000000000002, 46.9, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.7, 46.099999999999994, -50.00000000000044, 13.899999999999757, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 32.100000000000016, 45.9, -50.00000000000044, 47.1, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.7, 47.1, 46.3, 28.89999999999997, 47.5, 47.1, 43.7, -50.00000000000044, 47.1, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.300000000000004, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 43.30000000000001, 46.3, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.7, -50.00000000000044, 43.900000000000006, 45.3, 47.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 35.30000000000004, 43.10000000000001, 32.100000000000016, -50.00000000000044, 31.300000000000004, -50.00000000000044, 34.30000000000004, 5.6999999999996405, 39.50000000000002, 45.5, 46.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.5], "episode_lengths": [52, 500, 500, 32, 120, 32, 500, 132, 500, 52, 500, 64, 40, 500, 362, 100, 500, 500, 500, 156, 30, 500, 500, 500, 100, 500, 500, 76, 180, 42, 500, 30, 500, 152, 500, 56, 500, 500, 64, 500, 82, 500, 500, 74, 54, 30, 38, 212, 26, 30, 64, 500, 30, 38, 500, 500, 500, 32, 500, 58, 192, 500, 500, 500, 216, 68, 38, 500, 110, 500, 500, 132, 44, 500, 62, 48, 28, 500, 118, 500, 500, 148, 70, 180, 500, 188, 500, 158, 444, 106, 46, 32, 500, 40, 500, 500, 38, 500, 500, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38709051033430414, "mean_inference_ms": 1.241952329683027, "mean_action_processing_ms": 0.14573606953181042, "mean_env_wait_ms": 0.08590712634685885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026988983154296875, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.09198927879333496}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5813.395088286676, "num_env_steps_trained_throughput_per_sec": 5813.395088286676, "timesteps_total": 1200000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 2094.283, "sample_time_ms": 1866.222, "load_time_ms": 9.687, "load_throughput": 1238765.164, "learn_time_ms": 208.073, "learn_throughput": 57672.128, "synch_weights_time_ms": 8.8}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "episodes_total": 4494, "training_iteration": 100, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-21", "timestamp": 1698247821, "time_this_iter_s": 2.0701959133148193, "time_total_s": 229.76325941085815, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 229.76325941085815, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 60.56666666666666, "ram_util_percent": 30.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5777218104420241e-31, "cur_lr": 0.0003, "total_loss": 5.974991257985433, "policy_loss": -0.0005086777110894521, "vf_loss": 5.975540733337402, "vf_explained_var": -9.934107462565105e-07, "kl": 0.0004199275362954798, "entropy": 0.4069297671318054, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1508.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.277999999999812, "episode_len_mean": 257.8, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 28.89999999999997, 47.5, 47.1, 43.7, -50.00000000000044, 47.1, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.300000000000004, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 43.30000000000001, 46.3, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.7, -50.00000000000044, 43.900000000000006, 45.3, 47.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 35.30000000000004, 43.10000000000001, 32.100000000000016, -50.00000000000044, 31.300000000000004, -50.00000000000044, 34.30000000000004, 5.6999999999996405, 39.50000000000002, 45.5, 46.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.50000000000001, 31.70000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, 47.5, 45.3, 19.69999999999984, -50.00000000000044, 47.3, 41.90000000000001, -50.00000000000044, 47.1, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 45.3, 46.9, -50.00000000000044, 42.30000000000001, 45.9, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.5], "episode_lengths": [38, 212, 26, 30, 64, 500, 30, 38, 500, 500, 500, 32, 500, 58, 192, 500, 500, 500, 216, 68, 38, 500, 110, 500, 500, 132, 44, 500, 62, 48, 28, 500, 118, 500, 500, 148, 70, 180, 500, 188, 500, 158, 444, 106, 46, 32, 500, 40, 500, 500, 38, 500, 500, 26, 500, 500, 86, 66, 184, 500, 36, 500, 500, 42, 30, 42, 500, 50, 500, 60, 500, 134, 500, 26, 48, 304, 500, 28, 82, 500, 30, 500, 46, 54, 500, 48, 32, 500, 78, 42, 50, 500, 34, 500, 500, 500, 42, 500, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38669737339869975, "mean_inference_ms": 1.2416937838352304, "mean_action_processing_ms": 0.1455530115423468, "mean_env_wait_ms": 0.08582162146042421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023990154266357422, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.08899497985839844}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.277999999999812, "episode_len_mean": 257.8, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 28.89999999999997, 47.5, 47.1, 43.7, -50.00000000000044, 47.1, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.300000000000004, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 43.30000000000001, 46.3, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.7, -50.00000000000044, 43.900000000000006, 45.3, 47.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 35.30000000000004, 43.10000000000001, 32.100000000000016, -50.00000000000044, 31.300000000000004, -50.00000000000044, 34.30000000000004, 5.6999999999996405, 39.50000000000002, 45.5, 46.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.50000000000001, 31.70000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, 47.5, 45.3, 19.69999999999984, -50.00000000000044, 47.3, 41.90000000000001, -50.00000000000044, 47.1, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 45.3, 46.9, -50.00000000000044, 42.30000000000001, 45.9, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.5], "episode_lengths": [38, 212, 26, 30, 64, 500, 30, 38, 500, 500, 500, 32, 500, 58, 192, 500, 500, 500, 216, 68, 38, 500, 110, 500, 500, 132, 44, 500, 62, 48, 28, 500, 118, 500, 500, 148, 70, 180, 500, 188, 500, 158, 444, 106, 46, 32, 500, 40, 500, 500, 38, 500, 500, 26, 500, 500, 86, 66, 184, 500, 36, 500, 500, 42, 30, 42, 500, 50, 500, 60, 500, 134, 500, 26, 48, 304, 500, 28, 82, 500, 30, 500, 46, 54, 500, 48, 32, 500, 78, 42, 50, 500, 34, 500, 500, 500, 42, 500, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38669737339869975, "mean_inference_ms": 1.2416937838352304, "mean_action_processing_ms": 0.1455530115423468, "mean_env_wait_ms": 0.08582162146042421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023990154266357422, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.08899497985839844}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5542.132648082576, "num_env_steps_trained_throughput_per_sec": 5542.132648082576, "timesteps_total": 1212000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 2106.701, "sample_time_ms": 1869.354, "load_time_ms": 9.864, "load_throughput": 1216586.611, "learn_time_ms": 217.223, "learn_throughput": 55242.872, "synch_weights_time_ms": 8.86}, "counters": {"num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "episodes_total": 4540, "training_iteration": 101, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-23", "timestamp": 1698247823, "time_this_iter_s": 2.1702287197113037, "time_total_s": 231.93348813056946, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 231.93348813056946, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 58.26666666666667, "ram_util_percent": 30.366666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.888609052210121e-32, "cur_lr": 0.0003, "total_loss": 5.844948196411133, "policy_loss": -0.0003567943970362345, "vf_loss": 5.845347181955973, "vf_explained_var": -1.0887781778971354e-06, "kl": 0.00037696995841921915, "entropy": 0.42174601356188457, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1523.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0559999999998024, "episode_len_mean": 260.0, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.6999999999996405, 39.50000000000002, 45.5, 46.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.50000000000001, 31.70000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, 47.5, 45.3, 19.69999999999984, -50.00000000000044, 47.3, 41.90000000000001, -50.00000000000044, 47.1, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 45.3, 46.9, -50.00000000000044, 42.30000000000001, 45.9, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.5, 40.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.100000000000016, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 47.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 45.7, 44.900000000000006, 44.10000000000001, 40.500000000000014, 45.5, 45.9, 46.699999999999996, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.9, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 35.30000000000004, -50.00000000000044], "episode_lengths": [444, 106, 46, 32, 500, 40, 500, 500, 38, 500, 500, 26, 500, 500, 86, 66, 184, 500, 36, 500, 500, 42, 30, 42, 500, 50, 500, 60, 500, 134, 500, 26, 48, 304, 500, 28, 82, 500, 30, 500, 46, 54, 500, 48, 32, 500, 78, 42, 50, 500, 34, 500, 500, 500, 42, 500, 500, 46, 94, 90, 500, 500, 500, 42, 500, 90, 46, 500, 500, 500, 194, 26, 116, 500, 500, 34, 46, 500, 44, 52, 60, 96, 46, 42, 34, 34, 40, 500, 500, 500, 500, 500, 34, 22, 500, 500, 118, 500, 148, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3863081905473169, "mean_inference_ms": 1.2412675253152339, "mean_action_processing_ms": 0.14550028702311738, "mean_env_wait_ms": 0.08582308822566909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0249941349029541, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.09454464912414551}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0559999999998024, "episode_len_mean": 260.0, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.6999999999996405, 39.50000000000002, 45.5, 46.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.50000000000001, 31.70000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, 47.5, 45.3, 19.69999999999984, -50.00000000000044, 47.3, 41.90000000000001, -50.00000000000044, 47.1, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 45.3, 46.9, -50.00000000000044, 42.30000000000001, 45.9, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.5, 40.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.100000000000016, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 47.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 45.7, 44.900000000000006, 44.10000000000001, 40.500000000000014, 45.5, 45.9, 46.699999999999996, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.9, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 35.30000000000004, -50.00000000000044], "episode_lengths": [444, 106, 46, 32, 500, 40, 500, 500, 38, 500, 500, 26, 500, 500, 86, 66, 184, 500, 36, 500, 500, 42, 30, 42, 500, 50, 500, 60, 500, 134, 500, 26, 48, 304, 500, 28, 82, 500, 30, 500, 46, 54, 500, 48, 32, 500, 78, 42, 50, 500, 34, 500, 500, 500, 42, 500, 500, 46, 94, 90, 500, 500, 500, 42, 500, 90, 46, 500, 500, 500, 194, 26, 116, 500, 500, 34, 46, 500, 44, 52, 60, 96, 46, 42, 34, 34, 40, 500, 500, 500, 500, 500, 34, 22, 500, 500, 118, 500, 148, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3863081905473169, "mean_inference_ms": 1.2412675253152339, "mean_action_processing_ms": 0.14550028702311738, "mean_env_wait_ms": 0.08582308822566909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0249941349029541, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.09454464912414551}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5703.886527992609, "num_env_steps_trained_throughput_per_sec": 5703.886527992609, "timesteps_total": 1224000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 2102.01, "sample_time_ms": 1877.522, "load_time_ms": 9.768, "load_throughput": 1228509.069, "learn_time_ms": 204.54, "learn_throughput": 58668.241, "synch_weights_time_ms": 8.679}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4582, "training_iteration": 102, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-25", "timestamp": 1698247825, "time_this_iter_s": 2.1093859672546387, "time_total_s": 234.0428740978241, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 234.0428740978241, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 56.43333333333334, "ram_util_percent": 30.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.9443045261050603e-32, "cur_lr": 0.0003, "total_loss": 5.899941221872965, "policy_loss": -0.000655984381834666, "vf_loss": 5.900638802846273, "vf_explained_var": -1.4702479044596355e-06, "kl": 0.0009838797310142884, "entropy": 0.4152335782845815, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1538.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7529999999998015, "episode_len_mean": 268.02, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 45.9, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.5, 40.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.100000000000016, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 47.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 45.7, 44.900000000000006, 44.10000000000001, 40.500000000000014, 45.5, 45.9, 46.699999999999996, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.9, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, 31.300000000000004, 32.700000000000024, 46.3, -50.00000000000044, -50.00000000000044, 46.9, 46.3, 46.099999999999994, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 40.30000000000002, 47.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 39.70000000000002, -50.00000000000044, 46.9, 43.900000000000006, 0.8999999999995723, 34.900000000000034, 40.30000000000002, 42.900000000000006, 46.5, -50.00000000000044, 31.500000000000007, 47.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006], "episode_lengths": [500, 78, 42, 50, 500, 34, 500, 500, 500, 42, 500, 500, 46, 94, 90, 500, 500, 500, 42, 500, 90, 46, 500, 500, 500, 194, 26, 116, 500, 500, 34, 46, 500, 44, 52, 60, 96, 46, 42, 34, 34, 40, 500, 500, 500, 500, 500, 34, 22, 500, 500, 118, 500, 148, 500, 500, 90, 188, 174, 38, 500, 500, 32, 38, 40, 500, 26, 500, 500, 500, 112, 98, 26, 500, 500, 80, 500, 500, 500, 30, 500, 500, 500, 142, 104, 500, 32, 62, 492, 152, 98, 72, 36, 500, 186, 28, 500, 500, 34, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38650063032497683, "mean_inference_ms": 1.2403065493892695, "mean_action_processing_ms": 0.14504567742554697, "mean_env_wait_ms": 0.08592901896557478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400517463684082, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.10120129585266113}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7529999999998015, "episode_len_mean": 268.02, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 45.9, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.5, 40.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.100000000000016, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 47.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 45.7, 44.900000000000006, 44.10000000000001, 40.500000000000014, 45.5, 45.9, 46.699999999999996, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.9, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, 31.300000000000004, 32.700000000000024, 46.3, -50.00000000000044, -50.00000000000044, 46.9, 46.3, 46.099999999999994, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 40.30000000000002, 47.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 39.70000000000002, -50.00000000000044, 46.9, 43.900000000000006, 0.8999999999995723, 34.900000000000034, 40.30000000000002, 42.900000000000006, 46.5, -50.00000000000044, 31.500000000000007, 47.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006], "episode_lengths": [500, 78, 42, 50, 500, 34, 500, 500, 500, 42, 500, 500, 46, 94, 90, 500, 500, 500, 42, 500, 90, 46, 500, 500, 500, 194, 26, 116, 500, 500, 34, 46, 500, 44, 52, 60, 96, 46, 42, 34, 34, 40, 500, 500, 500, 500, 500, 34, 22, 500, 500, 118, 500, 148, 500, 500, 90, 188, 174, 38, 500, 500, 32, 38, 40, 500, 26, 500, 500, 500, 112, 98, 26, 500, 500, 80, 500, 500, 500, 30, 500, 500, 500, 142, 104, 500, 32, 62, 492, 152, 98, 72, 36, 500, 186, 28, 500, 500, 34, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38650063032497683, "mean_inference_ms": 1.2403065493892695, "mean_action_processing_ms": 0.14504567742554697, "mean_env_wait_ms": 0.08592901896557478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400517463684082, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.10120129585266113}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5995.590115664762, "num_env_steps_trained_throughput_per_sec": 5995.590115664762, "timesteps_total": 1236000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 2105.109, "sample_time_ms": 1883.181, "load_time_ms": 9.842, "load_throughput": 1219277.372, "learn_time_ms": 201.806, "learn_throughput": 59463.134, "synch_weights_time_ms": 8.68}, "counters": {"num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "episodes_total": 4627, "training_iteration": 103, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-27", "timestamp": 1698247827, "time_this_iter_s": 2.0074689388275146, "time_total_s": 236.0503430366516, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 236.0503430366516, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 58.5, "ram_util_percent": 29.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9721522630525302e-32, "cur_lr": 0.0003, "total_loss": 6.139668305714925, "policy_loss": -0.0002853121608495712, "vf_loss": 6.139994208017985, "vf_explained_var": -4.76837158203125e-07, "kl": 0.0004626222062900827, "entropy": 0.40607345501581826, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1553.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.5260000000002105, "episode_len_mean": 285.8, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.9, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, 31.300000000000004, 32.700000000000024, 46.3, -50.00000000000044, -50.00000000000044, 46.9, 46.3, 46.099999999999994, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 40.30000000000002, 47.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 39.70000000000002, -50.00000000000044, 46.9, 43.900000000000006, 0.8999999999995723, 34.900000000000034, 40.30000000000002, 42.900000000000006, 46.5, -50.00000000000044, 31.500000000000007, 47.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, 32.100000000000016, 22.699999999999882, 47.3, 46.099999999999994, 40.90000000000002, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 42.500000000000014, 42.70000000000001, 22.49999999999988, -50.00000000000044, 38.700000000000024, 46.3, 26.299999999999933, 43.900000000000006, -50.00000000000044, 47.5, 47.9, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 8.899999999999686, -50.00000000000044, 42.70000000000001, 47.5, 43.7], "episode_lengths": [500, 500, 500, 34, 22, 500, 500, 118, 500, 148, 500, 500, 90, 188, 174, 38, 500, 500, 32, 38, 40, 500, 26, 500, 500, 500, 112, 98, 26, 500, 500, 80, 500, 500, 500, 30, 500, 500, 500, 142, 104, 500, 32, 62, 492, 152, 98, 72, 36, 500, 186, 28, 500, 500, 34, 52, 500, 500, 180, 274, 28, 40, 92, 500, 500, 198, 500, 76, 74, 276, 500, 114, 38, 238, 62, 500, 26, 22, 54, 500, 500, 500, 500, 500, 500, 500, 214, 500, 106, 500, 500, 60, 500, 48, 500, 412, 500, 74, 26, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862088618041218, "mean_inference_ms": 1.2394351143605633, "mean_action_processing_ms": 0.14494879009092648, "mean_env_wait_ms": 0.08584458445656405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022004365921020508, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.11265134811401367}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.5260000000002105, "episode_len_mean": 285.8, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.9, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, 31.300000000000004, 32.700000000000024, 46.3, -50.00000000000044, -50.00000000000044, 46.9, 46.3, 46.099999999999994, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 40.30000000000002, 47.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 39.70000000000002, -50.00000000000044, 46.9, 43.900000000000006, 0.8999999999995723, 34.900000000000034, 40.30000000000002, 42.900000000000006, 46.5, -50.00000000000044, 31.500000000000007, 47.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, 32.100000000000016, 22.699999999999882, 47.3, 46.099999999999994, 40.90000000000002, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 42.500000000000014, 42.70000000000001, 22.49999999999988, -50.00000000000044, 38.700000000000024, 46.3, 26.299999999999933, 43.900000000000006, -50.00000000000044, 47.5, 47.9, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 8.899999999999686, -50.00000000000044, 42.70000000000001, 47.5, 43.7], "episode_lengths": [500, 500, 500, 34, 22, 500, 500, 118, 500, 148, 500, 500, 90, 188, 174, 38, 500, 500, 32, 38, 40, 500, 26, 500, 500, 500, 112, 98, 26, 500, 500, 80, 500, 500, 500, 30, 500, 500, 500, 142, 104, 500, 32, 62, 492, 152, 98, 72, 36, 500, 186, 28, 500, 500, 34, 52, 500, 500, 180, 274, 28, 40, 92, 500, 500, 198, 500, 76, 74, 276, 500, 114, 38, 238, 62, 500, 26, 22, 54, 500, 500, 500, 500, 500, 500, 500, 214, 500, 106, 500, 500, 60, 500, 48, 500, 412, 500, 74, 26, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862088618041218, "mean_inference_ms": 1.2394351143605633, "mean_action_processing_ms": 0.14494879009092648, "mean_env_wait_ms": 0.08584458445656405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022004365921020508, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.11265134811401367}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5782.827414736823, "num_env_steps_trained_throughput_per_sec": 5782.827414736823, "timesteps_total": 1248000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 2098.568, "sample_time_ms": 1890.202, "load_time_ms": 9.565, "load_throughput": 1254568.269, "learn_time_ms": 188.625, "learn_throughput": 63618.233, "synch_weights_time_ms": 8.576}, "counters": {"num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "episodes_total": 4671, "training_iteration": 104, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-29", "timestamp": 1698247829, "time_this_iter_s": 2.0811002254486084, "time_total_s": 238.13144326210022, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 238.13144326210022, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 62.96666666666667, "ram_util_percent": 29.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.860761315262651e-33, "cur_lr": 0.0003, "total_loss": 6.436243406931559, "policy_loss": -3.708998362223307e-05, "vf_loss": 6.436320209503174, "vf_explained_var": -8.185704549153645e-07, "kl": 0.00010843706413652399, "entropy": 0.39649149775505066, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1568.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.12399999999979514, "episode_len_mean": 279.32, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 0.8999999999995723, 34.900000000000034, 40.30000000000002, 42.900000000000006, 46.5, -50.00000000000044, 31.500000000000007, 47.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, 32.100000000000016, 22.699999999999882, 47.3, 46.099999999999994, 40.90000000000002, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 42.500000000000014, 42.70000000000001, 22.49999999999988, -50.00000000000044, 38.700000000000024, 46.3, 26.299999999999933, 43.900000000000006, -50.00000000000044, 47.5, 47.9, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 8.899999999999686, -50.00000000000044, 42.70000000000001, 47.5, 43.7, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 45.7, 44.900000000000006, 40.500000000000014, 32.50000000000002, 44.300000000000004, 40.70000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.10000000000001, -50.00000000000044, 42.30000000000001, 38.50000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 43.7, -50.00000000000044, 45.9, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004], "episode_lengths": [62, 492, 152, 98, 72, 36, 500, 186, 28, 500, 500, 34, 52, 500, 500, 180, 274, 28, 40, 92, 500, 500, 198, 500, 76, 74, 276, 500, 114, 38, 238, 62, 500, 26, 22, 54, 500, 500, 500, 500, 500, 500, 500, 214, 500, 106, 500, 500, 60, 500, 48, 500, 412, 500, 74, 26, 64, 500, 500, 26, 500, 44, 52, 96, 176, 58, 94, 500, 500, 110, 60, 500, 78, 116, 66, 500, 500, 500, 450, 500, 26, 42, 500, 500, 36, 64, 500, 42, 42, 500, 40, 500, 46, 500, 500, 500, 500, 500, 500, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38599503298267807, "mean_inference_ms": 1.2396909285109745, "mean_action_processing_ms": 0.14514268835425093, "mean_env_wait_ms": 0.08579012052845587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029000043869018555, "StateBufferConnector_ms": 0.006008148193359375, "ViewRequirementAgentConnector_ms": 0.1110072135925293}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.12399999999979514, "episode_len_mean": 279.32, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 0.8999999999995723, 34.900000000000034, 40.30000000000002, 42.900000000000006, 46.5, -50.00000000000044, 31.500000000000007, 47.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, -50.00000000000044, -50.00000000000044, 32.100000000000016, 22.699999999999882, 47.3, 46.099999999999994, 40.90000000000002, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 42.500000000000014, 42.70000000000001, 22.49999999999988, -50.00000000000044, 38.700000000000024, 46.3, 26.299999999999933, 43.900000000000006, -50.00000000000044, 47.5, 47.9, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 8.899999999999686, -50.00000000000044, 42.70000000000001, 47.5, 43.7, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 45.7, 44.900000000000006, 40.500000000000014, 32.50000000000002, 44.300000000000004, 40.70000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.10000000000001, -50.00000000000044, 42.30000000000001, 38.50000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 43.7, -50.00000000000044, 45.9, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004], "episode_lengths": [62, 492, 152, 98, 72, 36, 500, 186, 28, 500, 500, 34, 52, 500, 500, 180, 274, 28, 40, 92, 500, 500, 198, 500, 76, 74, 276, 500, 114, 38, 238, 62, 500, 26, 22, 54, 500, 500, 500, 500, 500, 500, 500, 214, 500, 106, 500, 500, 60, 500, 48, 500, 412, 500, 74, 26, 64, 500, 500, 26, 500, 44, 52, 96, 176, 58, 94, 500, 500, 110, 60, 500, 78, 116, 66, 500, 500, 500, 450, 500, 26, 42, 500, 500, 36, 64, 500, 42, 42, 500, 40, 500, 46, 500, 500, 500, 500, 500, 500, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38599503298267807, "mean_inference_ms": 1.2396909285109745, "mean_action_processing_ms": 0.14514268835425093, "mean_env_wait_ms": 0.08579012052845587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029000043869018555, "StateBufferConnector_ms": 0.006008148193359375, "ViewRequirementAgentConnector_ms": 0.1110072135925293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5499.686725897726, "num_env_steps_trained_throughput_per_sec": 5499.686725897726, "timesteps_total": 1260000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 2105.163, "sample_time_ms": 1896.706, "load_time_ms": 9.565, "load_throughput": 1254555.76, "learn_time_ms": 188.695, "learn_throughput": 63594.721, "synch_weights_time_ms": 8.596}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4714, "training_iteration": 105, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-32", "timestamp": 1698247832, "time_this_iter_s": 2.1869425773620605, "time_total_s": 240.31838583946228, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 240.31838583946228, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 64.03333333333333, "ram_util_percent": 29.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.9303806576313254e-33, "cur_lr": 0.0003, "total_loss": 6.167631689707438, "policy_loss": 1.6437470912933348e-05, "vf_loss": 6.167658551534017, "vf_explained_var": -1.1046727498372397e-06, "kl": 3.14338920247792e-05, "entropy": 0.4312913537025452, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1583.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.21500000000020947, "episode_len_mean": 277.7, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.699999999999967, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 8.899999999999686, -50.00000000000044, 42.70000000000001, 47.5, 43.7, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 45.7, 44.900000000000006, 40.500000000000014, 32.50000000000002, 44.300000000000004, 40.70000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.10000000000001, -50.00000000000044, 42.30000000000001, 38.50000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 43.7, -50.00000000000044, 45.9, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.7, 14.299999999999763, 45.7, 46.3, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, 47.1, 46.099999999999994, 26.299999999999933, 41.100000000000016, 45.1, 46.3, -50.00000000000044, 46.3, 45.9, 46.3, 47.5, 11.099999999999717, 36.50000000000003, -50.00000000000044, 43.30000000000001], "episode_lengths": [214, 500, 106, 500, 500, 60, 500, 48, 500, 412, 500, 74, 26, 64, 500, 500, 26, 500, 44, 52, 96, 176, 58, 94, 500, 500, 110, 60, 500, 78, 116, 66, 500, 500, 500, 450, 500, 26, 42, 500, 500, 36, 64, 500, 42, 42, 500, 40, 500, 46, 500, 500, 500, 500, 500, 500, 160, 500, 500, 500, 500, 98, 50, 500, 500, 500, 46, 64, 358, 44, 38, 500, 104, 500, 500, 500, 500, 40, 148, 500, 500, 44, 500, 500, 84, 30, 40, 238, 90, 50, 38, 500, 38, 42, 38, 26, 390, 136, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859687656376636, "mean_inference_ms": 1.239768175305872, "mean_action_processing_ms": 0.14519208692140406, "mean_env_wait_ms": 0.08562780370629017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0307919979095459, "StateBufferConnector_ms": 0.008010625839233398, "ViewRequirementAgentConnector_ms": 0.1229100227355957}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.21500000000020947, "episode_len_mean": 277.7, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.699999999999967, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 8.899999999999686, -50.00000000000044, 42.70000000000001, 47.5, 43.7, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 45.7, 44.900000000000006, 40.500000000000014, 32.50000000000002, 44.300000000000004, 40.70000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.10000000000001, -50.00000000000044, 42.30000000000001, 38.50000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 43.7, -50.00000000000044, 45.9, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.7, 14.299999999999763, 45.7, 46.3, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, 47.1, 46.099999999999994, 26.299999999999933, 41.100000000000016, 45.1, 46.3, -50.00000000000044, 46.3, 45.9, 46.3, 47.5, 11.099999999999717, 36.50000000000003, -50.00000000000044, 43.30000000000001], "episode_lengths": [214, 500, 106, 500, 500, 60, 500, 48, 500, 412, 500, 74, 26, 64, 500, 500, 26, 500, 44, 52, 96, 176, 58, 94, 500, 500, 110, 60, 500, 78, 116, 66, 500, 500, 500, 450, 500, 26, 42, 500, 500, 36, 64, 500, 42, 42, 500, 40, 500, 46, 500, 500, 500, 500, 500, 500, 160, 500, 500, 500, 500, 98, 50, 500, 500, 500, 46, 64, 358, 44, 38, 500, 104, 500, 500, 500, 500, 40, 148, 500, 500, 44, 500, 500, 84, 30, 40, 238, 90, 50, 38, 500, 38, 42, 38, 26, 390, 136, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859687656376636, "mean_inference_ms": 1.239768175305872, "mean_action_processing_ms": 0.14519208692140406, "mean_env_wait_ms": 0.08562780370629017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0307919979095459, "StateBufferConnector_ms": 0.008010625839233398, "ViewRequirementAgentConnector_ms": 0.1229100227355957}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5243.399424255465, "num_env_steps_trained_throughput_per_sec": 5243.399424255465, "timesteps_total": 1272000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 2111.267, "sample_time_ms": 1904.495, "load_time_ms": 9.452, "load_throughput": 1269545.723, "learn_time_ms": 187.132, "learn_throughput": 64125.776, "synch_weights_time_ms": 8.604}, "counters": {"num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "episodes_total": 4757, "training_iteration": 106, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-34", "timestamp": 1698247834, "time_this_iter_s": 2.294588088989258, "time_total_s": 242.61297392845154, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 242.61297392845154, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 61.56666666666666, "ram_util_percent": 29.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4651903288156627e-33, "cur_lr": 0.0003, "total_loss": 6.978743775685628, "policy_loss": -0.0001424570878346761, "vf_loss": 6.97893164952596, "vf_explained_var": -1.3113021850585938e-06, "kl": 0.0002687189415487031, "entropy": 0.4551587144533793, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1598.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.5640000000002131, "episode_len_mean": 286.2, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.7, 14.299999999999763, 45.7, 46.3, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, 47.1, 46.099999999999994, 26.299999999999933, 41.100000000000016, 45.1, 46.3, -50.00000000000044, 46.3, 45.9, 46.3, 47.5, 11.099999999999717, 36.50000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.30000000000001, 35.30000000000004, 26.299999999999933, -50.00000000000044, 43.10000000000001, -50.00000000000044, 33.10000000000003, -50.00000000000044, 40.30000000000002, 44.7, 46.099999999999994, 44.900000000000006, 19.899999999999842, -50.00000000000044, -50.00000000000044, 18.899999999999828, 43.50000000000001, 46.9, 45.9, 44.300000000000004, 42.10000000000001, 46.099999999999994, -50.00000000000044, 3.899999999999615, 28.89999999999997, 1.6999999999995836, 41.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044], "episode_lengths": [42, 500, 40, 500, 46, 500, 500, 500, 500, 500, 500, 160, 500, 500, 500, 500, 98, 50, 500, 500, 500, 46, 64, 358, 44, 38, 500, 104, 500, 500, 500, 500, 40, 148, 500, 500, 44, 500, 500, 84, 30, 40, 238, 90, 50, 38, 500, 38, 42, 38, 26, 390, 136, 500, 68, 500, 500, 500, 500, 76, 500, 78, 148, 238, 500, 70, 500, 170, 500, 98, 54, 40, 52, 302, 500, 500, 312, 66, 32, 42, 58, 80, 40, 500, 462, 212, 484, 90, 58, 500, 500, 46, 44, 500, 338, 500, 500, 500, 300, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38574026341224354, "mean_inference_ms": 1.2397141135011807, "mean_action_processing_ms": 0.14523153056356214, "mean_env_wait_ms": 0.08564185548887945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022793054580688477, "StateBufferConnector_ms": 0.0060045719146728516, "ViewRequirementAgentConnector_ms": 0.11591315269470215}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.5640000000002131, "episode_len_mean": 286.2, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.7, 14.299999999999763, 45.7, 46.3, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, 47.1, 46.099999999999994, 26.299999999999933, 41.100000000000016, 45.1, 46.3, -50.00000000000044, 46.3, 45.9, 46.3, 47.5, 11.099999999999717, 36.50000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.30000000000001, 35.30000000000004, 26.299999999999933, -50.00000000000044, 43.10000000000001, -50.00000000000044, 33.10000000000003, -50.00000000000044, 40.30000000000002, 44.7, 46.099999999999994, 44.900000000000006, 19.899999999999842, -50.00000000000044, -50.00000000000044, 18.899999999999828, 43.50000000000001, 46.9, 45.9, 44.300000000000004, 42.10000000000001, 46.099999999999994, -50.00000000000044, 3.899999999999615, 28.89999999999997, 1.6999999999995836, 41.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044], "episode_lengths": [42, 500, 40, 500, 46, 500, 500, 500, 500, 500, 500, 160, 500, 500, 500, 500, 98, 50, 500, 500, 500, 46, 64, 358, 44, 38, 500, 104, 500, 500, 500, 500, 40, 148, 500, 500, 44, 500, 500, 84, 30, 40, 238, 90, 50, 38, 500, 38, 42, 38, 26, 390, 136, 500, 68, 500, 500, 500, 500, 76, 500, 78, 148, 238, 500, 70, 500, 170, 500, 98, 54, 40, 52, 302, 500, 500, 312, 66, 32, 42, 58, 80, 40, 500, 462, 212, 484, 90, 58, 500, 500, 46, 44, 500, 338, 500, 500, 500, 300, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38574026341224354, "mean_inference_ms": 1.2397141135011807, "mean_action_processing_ms": 0.14523153056356214, "mean_env_wait_ms": 0.08564185548887945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022793054580688477, "StateBufferConnector_ms": 0.0060045719146728516, "ViewRequirementAgentConnector_ms": 0.11591315269470215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5883.997966796306, "num_env_steps_trained_throughput_per_sec": 5883.997966796306, "timesteps_total": 1284000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 2113.805, "sample_time_ms": 1909.034, "load_time_ms": 9.633, "load_throughput": 1245684.869, "learn_time_ms": 184.942, "learn_throughput": 64885.163, "synch_weights_time_ms": 8.612}, "counters": {"num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "episodes_total": 4802, "training_iteration": 107, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-36", "timestamp": 1698247836, "time_this_iter_s": 2.045424699783325, "time_total_s": 244.65839862823486, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 244.65839862823486, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 55.833333333333336, "ram_util_percent": 29.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2325951644078314e-33, "cur_lr": 0.0003, "total_loss": 6.720415878295898, "policy_loss": -4.776914914449056e-05, "vf_loss": 6.72050568262736, "vf_explained_var": -9.298324584960937e-07, "kl": 0.00010088585377161507, "entropy": 0.4218013346195221, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1613.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.491999999999802, "episode_len_mean": 275.68, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 45.1, 46.3, -50.00000000000044, 46.3, 45.9, 46.3, 47.5, 11.099999999999717, 36.50000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.30000000000001, 35.30000000000004, 26.299999999999933, -50.00000000000044, 43.10000000000001, -50.00000000000044, 33.10000000000003, -50.00000000000044, 40.30000000000002, 44.7, 46.099999999999994, 44.900000000000006, 19.899999999999842, -50.00000000000044, -50.00000000000044, 18.899999999999828, 43.50000000000001, 46.9, 45.9, 44.300000000000004, 42.10000000000001, 46.099999999999994, -50.00000000000044, 3.899999999999615, 28.89999999999997, 1.6999999999995836, 41.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 46.099999999999994, 13.299999999999748, 46.099999999999994, -50.00000000000044, 32.700000000000024, 46.5, -50.00000000000044, -50.00000000000044, 31.70000000000001, 29.299999999999976, -50.00000000000044, 37.50000000000003, 46.9, -50.00000000000044, 40.500000000000014, 46.099999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.3, 39.50000000000002, 43.10000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, 46.9, 8.299999999999677, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001], "episode_lengths": [90, 50, 38, 500, 38, 42, 38, 26, 390, 136, 500, 68, 500, 500, 500, 500, 76, 500, 78, 148, 238, 500, 70, 500, 170, 500, 98, 54, 40, 52, 302, 500, 500, 312, 66, 32, 42, 58, 80, 40, 500, 462, 212, 484, 90, 58, 500, 500, 46, 44, 500, 338, 500, 500, 500, 300, 500, 500, 58, 500, 76, 40, 368, 40, 500, 174, 36, 500, 500, 184, 208, 500, 126, 32, 500, 96, 40, 142, 500, 500, 48, 106, 70, 188, 500, 500, 40, 70, 32, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38564151695769183, "mean_inference_ms": 1.2395404656798994, "mean_action_processing_ms": 0.14531719302969934, "mean_env_wait_ms": 0.08554122879824348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024804353713989258, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.13016080856323242}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.491999999999802, "episode_len_mean": 275.68, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 45.1, 46.3, -50.00000000000044, 46.3, 45.9, 46.3, 47.5, 11.099999999999717, 36.50000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.30000000000001, 35.30000000000004, 26.299999999999933, -50.00000000000044, 43.10000000000001, -50.00000000000044, 33.10000000000003, -50.00000000000044, 40.30000000000002, 44.7, 46.099999999999994, 44.900000000000006, 19.899999999999842, -50.00000000000044, -50.00000000000044, 18.899999999999828, 43.50000000000001, 46.9, 45.9, 44.300000000000004, 42.10000000000001, 46.099999999999994, -50.00000000000044, 3.899999999999615, 28.89999999999997, 1.6999999999995836, 41.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 46.099999999999994, 13.299999999999748, 46.099999999999994, -50.00000000000044, 32.700000000000024, 46.5, -50.00000000000044, -50.00000000000044, 31.70000000000001, 29.299999999999976, -50.00000000000044, 37.50000000000003, 46.9, -50.00000000000044, 40.500000000000014, 46.099999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.3, 39.50000000000002, 43.10000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, 46.9, 8.299999999999677, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001], "episode_lengths": [90, 50, 38, 500, 38, 42, 38, 26, 390, 136, 500, 68, 500, 500, 500, 500, 76, 500, 78, 148, 238, 500, 70, 500, 170, 500, 98, 54, 40, 52, 302, 500, 500, 312, 66, 32, 42, 58, 80, 40, 500, 462, 212, 484, 90, 58, 500, 500, 46, 44, 500, 338, 500, 500, 500, 300, 500, 500, 58, 500, 76, 40, 368, 40, 500, 174, 36, 500, 500, 184, 208, 500, 126, 32, 500, 96, 40, 142, 500, 500, 48, 106, 70, 188, 500, 500, 40, 70, 32, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38564151695769183, "mean_inference_ms": 1.2395404656798994, "mean_action_processing_ms": 0.14531719302969934, "mean_env_wait_ms": 0.08554122879824348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024804353713989258, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.13016080856323242}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5873.010601761425, "num_env_steps_trained_throughput_per_sec": 5873.010601761425, "timesteps_total": 1296000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 2103.325, "sample_time_ms": 1916.535, "load_time_ms": 8.722, "load_throughput": 1375843.247, "learn_time_ms": 167.721, "learn_throughput": 71547.347, "synch_weights_time_ms": 8.662}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4845, "training_iteration": 108, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-38", "timestamp": 1698247838, "time_this_iter_s": 2.0492403507232666, "time_total_s": 246.70763897895813, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 246.70763897895813, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 61.46666666666667, "ram_util_percent": 29.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.162975822039157e-34, "cur_lr": 0.0003, "total_loss": 6.264834467569987, "policy_loss": -0.0002219383915265401, "vf_loss": 6.2651017506917315, "vf_explained_var": -1.2159347534179687e-06, "kl": 0.00037436605834955116, "entropy": 0.4554465413093567, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1628.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.623000000000233, "episode_len_mean": 311.76, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 18.899999999999828, 43.50000000000001, 46.9, 45.9, 44.300000000000004, 42.10000000000001, 46.099999999999994, -50.00000000000044, 3.899999999999615, 28.89999999999997, 1.6999999999995836, 41.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 46.099999999999994, 13.299999999999748, 46.099999999999994, -50.00000000000044, 32.700000000000024, 46.5, -50.00000000000044, -50.00000000000044, 31.70000000000001, 29.299999999999976, -50.00000000000044, 37.50000000000003, 46.9, -50.00000000000044, 40.500000000000014, 46.099999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.3, 39.50000000000002, 43.10000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, 46.9, 8.299999999999677, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 1.8999999999995865, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, 21.499999999999865, -50.00000000000044, 42.30000000000001, 30.699999999999996, 40.500000000000014, 35.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 44.5, 29.099999999999973, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 312, 66, 32, 42, 58, 80, 40, 500, 462, 212, 484, 90, 58, 500, 500, 46, 44, 500, 338, 500, 500, 500, 300, 500, 500, 58, 500, 76, 40, 368, 40, 500, 174, 36, 500, 500, 184, 208, 500, 126, 32, 500, 96, 40, 142, 500, 500, 48, 106, 70, 188, 500, 500, 40, 70, 32, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 70, 482, 500, 500, 500, 500, 360, 286, 500, 78, 194, 96, 144, 500, 48, 500, 56, 210, 500, 500, 52, 500, 500, 500, 214, 500, 500, 62, 500, 68, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859283528388, "mean_inference_ms": 1.2395215149488632, "mean_action_processing_ms": 0.14540778394967352, "mean_env_wait_ms": 0.08574639368830866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031014442443847656, "StateBufferConnector_ms": 0.009001970291137695, "ViewRequirementAgentConnector_ms": 0.13599443435668945}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.623000000000233, "episode_len_mean": 311.76, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 18.899999999999828, 43.50000000000001, 46.9, 45.9, 44.300000000000004, 42.10000000000001, 46.099999999999994, -50.00000000000044, 3.899999999999615, 28.89999999999997, 1.6999999999995836, 41.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 46.099999999999994, 13.299999999999748, 46.099999999999994, -50.00000000000044, 32.700000000000024, 46.5, -50.00000000000044, -50.00000000000044, 31.70000000000001, 29.299999999999976, -50.00000000000044, 37.50000000000003, 46.9, -50.00000000000044, 40.500000000000014, 46.099999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.3, 39.50000000000002, 43.10000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, 46.9, 8.299999999999677, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 1.8999999999995865, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, 21.499999999999865, -50.00000000000044, 42.30000000000001, 30.699999999999996, 40.500000000000014, 35.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 44.5, 29.099999999999973, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 312, 66, 32, 42, 58, 80, 40, 500, 462, 212, 484, 90, 58, 500, 500, 46, 44, 500, 338, 500, 500, 500, 300, 500, 500, 58, 500, 76, 40, 368, 40, 500, 174, 36, 500, 500, 184, 208, 500, 126, 32, 500, 96, 40, 142, 500, 500, 48, 106, 70, 188, 500, 500, 40, 70, 32, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 70, 482, 500, 500, 500, 500, 360, 286, 500, 78, 194, 96, 144, 500, 48, 500, 56, 210, 500, 500, 52, 500, 500, 500, 214, 500, 500, 62, 500, 68, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859283528388, "mean_inference_ms": 1.2395215149488632, "mean_action_processing_ms": 0.14540778394967352, "mean_env_wait_ms": 0.08574639368830866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031014442443847656, "StateBufferConnector_ms": 0.009001970291137695, "ViewRequirementAgentConnector_ms": 0.13599443435668945}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5981.743029738617, "num_env_steps_trained_throughput_per_sec": 5981.743029738617, "timesteps_total": 1308000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 2096.915, "sample_time_ms": 1918.758, "load_time_ms": 8.816, "load_throughput": 1361186.706, "learn_time_ms": 159.176, "learn_throughput": 75388.344, "synch_weights_time_ms": 8.68}, "counters": {"num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "episodes_total": 4877, "training_iteration": 109, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-40", "timestamp": 1698247840, "time_this_iter_s": 2.0121030807495117, "time_total_s": 248.71974205970764, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 248.71974205970764, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 59.833333333333336, "ram_util_percent": 28.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0814879110195784e-34, "cur_lr": 0.0003, "total_loss": 6.0738500912984215, "policy_loss": -0.00032463371753692626, "vf_loss": 6.074221134185791, "vf_explained_var": -3.0994415283203126e-07, "kl": 0.0007216525129630706, "entropy": 0.4638679524262746, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1643.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -10.675000000000257, "episode_len_mean": 332.2, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 31.70000000000001, 29.299999999999976, -50.00000000000044, 37.50000000000003, 46.9, -50.00000000000044, 40.500000000000014, 46.099999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.3, 39.50000000000002, 43.10000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, 46.9, 8.299999999999677, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 1.8999999999995865, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, 21.499999999999865, -50.00000000000044, 42.30000000000001, 30.699999999999996, 40.500000000000014, 35.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 44.5, 29.099999999999973, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, -50.00000000000044, 41.100000000000016, 43.10000000000001, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.9], "episode_lengths": [500, 184, 208, 500, 126, 32, 500, 96, 40, 142, 500, 500, 48, 106, 70, 188, 500, 500, 40, 70, 32, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 70, 482, 500, 500, 500, 500, 360, 286, 500, 78, 194, 96, 144, 500, 48, 500, 56, 210, 500, 500, 52, 500, 500, 500, 214, 500, 500, 62, 500, 68, 500, 500, 500, 500, 74, 60, 500, 500, 54, 500, 500, 396, 500, 500, 500, 500, 36, 296, 500, 500, 500, 38, 500, 50, 500, 500, 500, 76, 36, 500, 90, 70, 500, 154, 500, 500, 28, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856857621279957, "mean_inference_ms": 1.2389028832800013, "mean_action_processing_ms": 0.14564566509029808, "mean_env_wait_ms": 0.08564027054522469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031003952026367188, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.1350104808807373}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -10.675000000000257, "episode_len_mean": 332.2, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 31.70000000000001, 29.299999999999976, -50.00000000000044, 37.50000000000003, 46.9, -50.00000000000044, 40.500000000000014, 46.099999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.3, 39.50000000000002, 43.10000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, 46.9, 8.299999999999677, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 1.8999999999995865, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, 21.499999999999865, -50.00000000000044, 42.30000000000001, 30.699999999999996, 40.500000000000014, 35.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 44.5, 29.099999999999973, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, -50.00000000000044, 41.100000000000016, 43.10000000000001, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.9], "episode_lengths": [500, 184, 208, 500, 126, 32, 500, 96, 40, 142, 500, 500, 48, 106, 70, 188, 500, 500, 40, 70, 32, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 70, 482, 500, 500, 500, 500, 360, 286, 500, 78, 194, 96, 144, 500, 48, 500, 56, 210, 500, 500, 52, 500, 500, 500, 214, 500, 500, 62, 500, 68, 500, 500, 500, 500, 74, 60, 500, 500, 54, 500, 500, 396, 500, 500, 500, 500, 36, 296, 500, 500, 500, 38, 500, 50, 500, 500, 500, 76, 36, 500, 90, 70, 500, 154, 500, 500, 28, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856857621279957, "mean_inference_ms": 1.2389028832800013, "mean_action_processing_ms": 0.14564566509029808, "mean_env_wait_ms": 0.08564027054522469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031003952026367188, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.1350104808807373}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5418.913401859402, "num_env_steps_trained_throughput_per_sec": 5418.913401859402, "timesteps_total": 1320000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 2111.942, "sample_time_ms": 1914.193, "load_time_ms": 9.711, "load_throughput": 1235650.985, "learn_time_ms": 177.573, "learn_throughput": 67577.882, "synch_weights_time_ms": 8.783}, "counters": {"num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "episodes_total": 4913, "training_iteration": 110, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-42", "timestamp": 1698247842, "time_this_iter_s": 2.220466136932373, "time_total_s": 250.94020819664001, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 250.94020819664001, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 61.5, "ram_util_percent": 28.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5407439555097892e-34, "cur_lr": 0.0003, "total_loss": 6.519223848978679, "policy_loss": -0.00017830307284990947, "vf_loss": 6.519448598225911, "vf_explained_var": -1.1761983235677084e-06, "kl": 0.001092794430523251, "entropy": 0.4624454855918884, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1658.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -6.275000000000233, "episode_len_mean": 308.24, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 44.5, 29.099999999999973, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, -50.00000000000044, 41.100000000000016, 43.10000000000001, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 41.70000000000002, 47.1, 44.10000000000001, 40.90000000000002, 44.5, 44.5, 44.5, -50.00000000000044, -50.00000000000044, 35.900000000000034, 32.700000000000024, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 18.29999999999982, 44.300000000000004, 18.899999999999828, 43.7, 24.099999999999902, 43.50000000000001, 40.90000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.5, 27.299999999999947, 47.1, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [48, 500, 56, 210, 500, 500, 52, 500, 500, 500, 214, 500, 500, 62, 500, 68, 500, 500, 500, 500, 74, 60, 500, 500, 54, 500, 500, 396, 500, 500, 500, 500, 36, 296, 500, 500, 500, 38, 500, 50, 500, 500, 500, 76, 36, 500, 90, 70, 500, 154, 500, 500, 28, 500, 42, 500, 500, 84, 30, 60, 92, 56, 56, 56, 500, 500, 142, 174, 142, 500, 500, 54, 500, 318, 58, 312, 64, 260, 66, 92, 92, 500, 500, 56, 228, 30, 500, 500, 38, 500, 500, 84, 68, 500, 500, 362, 500, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38570067632299826, "mean_inference_ms": 1.2379682166855395, "mean_action_processing_ms": 0.14517280622424467, "mean_env_wait_ms": 0.08555712493159899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022994041442871094, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.12558507919311523}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -6.275000000000233, "episode_len_mean": 308.24, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 44.5, 29.099999999999973, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, -50.00000000000044, 41.100000000000016, 43.10000000000001, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 41.70000000000002, 47.1, 44.10000000000001, 40.90000000000002, 44.5, 44.5, 44.5, -50.00000000000044, -50.00000000000044, 35.900000000000034, 32.700000000000024, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 18.29999999999982, 44.300000000000004, 18.899999999999828, 43.7, 24.099999999999902, 43.50000000000001, 40.90000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.5, 27.299999999999947, 47.1, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [48, 500, 56, 210, 500, 500, 52, 500, 500, 500, 214, 500, 500, 62, 500, 68, 500, 500, 500, 500, 74, 60, 500, 500, 54, 500, 500, 396, 500, 500, 500, 500, 36, 296, 500, 500, 500, 38, 500, 50, 500, 500, 500, 76, 36, 500, 90, 70, 500, 154, 500, 500, 28, 500, 42, 500, 500, 84, 30, 60, 92, 56, 56, 56, 500, 500, 142, 174, 142, 500, 500, 54, 500, 318, 58, 312, 64, 260, 66, 92, 92, 500, 500, 56, 228, 30, 500, 500, 38, 500, 500, 84, 68, 500, 500, 362, 500, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38570067632299826, "mean_inference_ms": 1.2379682166855395, "mean_action_processing_ms": 0.14517280622424467, "mean_env_wait_ms": 0.08555712493159899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022994041442871094, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.12558507919311523}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5830.584043674777, "num_env_steps_trained_throughput_per_sec": 5830.584043674777, "timesteps_total": 1332000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 2101.23, "sample_time_ms": 1919.599, "load_time_ms": 9.535, "load_throughput": 1258473.679, "learn_time_ms": 161.494, "learn_throughput": 74305.994, "synch_weights_time_ms": 8.92}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 4958, "training_iteration": 111, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-45", "timestamp": 1698247845, "time_this_iter_s": 2.3734519481658936, "time_total_s": 253.3136601448059, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 253.3136601448059, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 58.9, "ram_util_percent": 28.400000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.703719777548946e-35, "cur_lr": 0.0003, "total_loss": 6.797691853841146, "policy_loss": -0.0003263240059216817, "vf_loss": 6.798066806793213, "vf_explained_var": -1.7325083414713542e-06, "kl": 0.0005673109430707275, "entropy": 0.48831614057223, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1673.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.954999999999824, "episode_len_mean": 256.08, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 41.70000000000002, 47.1, 44.10000000000001, 40.90000000000002, 44.5, 44.5, 44.5, -50.00000000000044, -50.00000000000044, 35.900000000000034, 32.700000000000024, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 18.29999999999982, 44.300000000000004, 18.899999999999828, 43.7, 24.099999999999902, 43.50000000000001, 40.90000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.5, 27.299999999999947, 47.1, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 24.099999999999902, -50.00000000000044, 47.7, 37.90000000000003, 42.900000000000006, 25.499999999999922, 3.899999999999615, 43.30000000000001, 34.900000000000034, -50.00000000000044, 35.10000000000004, 39.300000000000026, 43.30000000000001, 31.300000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.500000000000014, 47.1, 46.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.100000000000016, -50.00000000000044, 46.3, 47.3, 33.70000000000004, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.099999999999689, 46.099999999999994, -50.00000000000044, 47.7, 46.5, 43.900000000000006, 46.9, 29.299999999999976], "episode_lengths": [500, 500, 28, 500, 42, 500, 500, 84, 30, 60, 92, 56, 56, 56, 500, 500, 142, 174, 142, 500, 500, 54, 500, 318, 58, 312, 64, 260, 66, 92, 92, 500, 500, 56, 228, 30, 500, 500, 38, 500, 500, 84, 68, 500, 500, 362, 500, 40, 500, 500, 500, 42, 500, 260, 500, 24, 122, 72, 246, 462, 68, 152, 500, 150, 108, 68, 188, 68, 500, 500, 80, 62, 500, 72, 500, 76, 30, 38, 52, 500, 500, 66, 90, 500, 38, 28, 164, 500, 286, 500, 500, 500, 410, 40, 500, 24, 36, 62, 32, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38568880346359125, "mean_inference_ms": 1.2379664255678606, "mean_action_processing_ms": 0.14484525286739203, "mean_env_wait_ms": 0.08558901578808463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0250089168548584, "StateBufferConnector_ms": 0.004996538162231445, "ViewRequirementAgentConnector_ms": 0.12455105781555176}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.954999999999824, "episode_len_mean": 256.08, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 41.70000000000002, 47.1, 44.10000000000001, 40.90000000000002, 44.5, 44.5, 44.5, -50.00000000000044, -50.00000000000044, 35.900000000000034, 32.700000000000024, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 18.29999999999982, 44.300000000000004, 18.899999999999828, 43.7, 24.099999999999902, 43.50000000000001, 40.90000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.5, 27.299999999999947, 47.1, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 24.099999999999902, -50.00000000000044, 47.7, 37.90000000000003, 42.900000000000006, 25.499999999999922, 3.899999999999615, 43.30000000000001, 34.900000000000034, -50.00000000000044, 35.10000000000004, 39.300000000000026, 43.30000000000001, 31.300000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.500000000000014, 47.1, 46.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.100000000000016, -50.00000000000044, 46.3, 47.3, 33.70000000000004, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.099999999999689, 46.099999999999994, -50.00000000000044, 47.7, 46.5, 43.900000000000006, 46.9, 29.299999999999976], "episode_lengths": [500, 500, 28, 500, 42, 500, 500, 84, 30, 60, 92, 56, 56, 56, 500, 500, 142, 174, 142, 500, 500, 54, 500, 318, 58, 312, 64, 260, 66, 92, 92, 500, 500, 56, 228, 30, 500, 500, 38, 500, 500, 84, 68, 500, 500, 362, 500, 40, 500, 500, 500, 42, 500, 260, 500, 24, 122, 72, 246, 462, 68, 152, 500, 150, 108, 68, 188, 68, 500, 500, 80, 62, 500, 72, 500, 76, 30, 38, 52, 500, 500, 66, 90, 500, 38, 28, 164, 500, 286, 500, 500, 500, 410, 40, 500, 24, 36, 62, 32, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38568880346359125, "mean_inference_ms": 1.2379664255678606, "mean_action_processing_ms": 0.14484525286739203, "mean_env_wait_ms": 0.08558901578808463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0250089168548584, "StateBufferConnector_ms": 0.004996538162231445, "ViewRequirementAgentConnector_ms": 0.12455105781555176}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5111.73368018454, "num_env_steps_trained_throughput_per_sec": 5111.73368018454, "timesteps_total": 1344000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 2125.601, "sample_time_ms": 1916.813, "load_time_ms": 10.061, "load_throughput": 1192710.039, "learn_time_ms": 188.141, "learn_throughput": 63782.036, "synch_weights_time_ms": 9.005}, "counters": {"num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "episodes_total": 5008, "training_iteration": 112, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-47", "timestamp": 1698247847, "time_this_iter_s": 2.3532352447509766, "time_total_s": 255.66689538955688, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 255.66689538955688, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 55.03333333333333, "ram_util_percent": 28.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.851859888774473e-35, "cur_lr": 0.0003, "total_loss": 6.694700431823731, "policy_loss": -0.0002625045677026113, "vf_loss": 6.695008214314779, "vf_explained_var": -1.1444091796875e-06, "kl": 0.0011064062041877302, "entropy": 0.4525155166784922, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1688.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.132999999999836, "episode_len_mean": 244.32, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 24.099999999999902, -50.00000000000044, 47.7, 37.90000000000003, 42.900000000000006, 25.499999999999922, 3.899999999999615, 43.30000000000001, 34.900000000000034, -50.00000000000044, 35.10000000000004, 39.300000000000026, 43.30000000000001, 31.300000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.500000000000014, 47.1, 46.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.100000000000016, -50.00000000000044, 46.3, 47.3, 33.70000000000004, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.099999999999689, 46.099999999999994, -50.00000000000044, 47.7, 46.5, 43.900000000000006, 46.9, 29.299999999999976, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.699999999999996, 43.30000000000001, 45.9, -50.00000000000044, 40.90000000000002, 45.5, 45.7, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 39.10000000000002, 45.1, 43.7, -50.00000000000044, 25.899999999999928, 38.50000000000003, 29.69999999999998, -50.00000000000044, 45.1, 39.90000000000002, 30.699999999999996, -50.00000000000044, 45.3, 38.50000000000003, -50.00000000000044, 46.099999999999994, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 45.3, 14.699999999999768, -50.00000000000044, -50.00000000000044, 37.300000000000026, 44.10000000000001, 37.300000000000026, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 26.69999999999994, -50.00000000000044, 43.50000000000001], "episode_lengths": [500, 500, 42, 500, 260, 500, 24, 122, 72, 246, 462, 68, 152, 500, 150, 108, 68, 188, 68, 500, 500, 80, 62, 500, 72, 500, 76, 30, 38, 52, 500, 500, 66, 90, 500, 38, 28, 164, 500, 286, 500, 500, 500, 410, 40, 500, 24, 36, 62, 32, 208, 500, 62, 500, 34, 68, 42, 500, 92, 46, 44, 500, 500, 42, 500, 110, 50, 64, 500, 242, 116, 204, 500, 50, 102, 194, 500, 48, 116, 500, 40, 48, 500, 54, 500, 48, 354, 500, 500, 128, 60, 128, 500, 72, 500, 500, 50, 234, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3860073522426702, "mean_inference_ms": 1.237669091656437, "mean_action_processing_ms": 0.14479480479570664, "mean_env_wait_ms": 0.08568995334622687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02705097198486328, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.13520193099975586}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.132999999999836, "episode_len_mean": 244.32, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 24.099999999999902, -50.00000000000044, 47.7, 37.90000000000003, 42.900000000000006, 25.499999999999922, 3.899999999999615, 43.30000000000001, 34.900000000000034, -50.00000000000044, 35.10000000000004, 39.300000000000026, 43.30000000000001, 31.300000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.500000000000014, 47.1, 46.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.100000000000016, -50.00000000000044, 46.3, 47.3, 33.70000000000004, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.099999999999689, 46.099999999999994, -50.00000000000044, 47.7, 46.5, 43.900000000000006, 46.9, 29.299999999999976, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.699999999999996, 43.30000000000001, 45.9, -50.00000000000044, 40.90000000000002, 45.5, 45.7, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 39.10000000000002, 45.1, 43.7, -50.00000000000044, 25.899999999999928, 38.50000000000003, 29.69999999999998, -50.00000000000044, 45.1, 39.90000000000002, 30.699999999999996, -50.00000000000044, 45.3, 38.50000000000003, -50.00000000000044, 46.099999999999994, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 45.3, 14.699999999999768, -50.00000000000044, -50.00000000000044, 37.300000000000026, 44.10000000000001, 37.300000000000026, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 26.69999999999994, -50.00000000000044, 43.50000000000001], "episode_lengths": [500, 500, 42, 500, 260, 500, 24, 122, 72, 246, 462, 68, 152, 500, 150, 108, 68, 188, 68, 500, 500, 80, 62, 500, 72, 500, 76, 30, 38, 52, 500, 500, 66, 90, 500, 38, 28, 164, 500, 286, 500, 500, 500, 410, 40, 500, 24, 36, 62, 32, 208, 500, 62, 500, 34, 68, 42, 500, 92, 46, 44, 500, 500, 42, 500, 110, 50, 64, 500, 242, 116, 204, 500, 50, 102, 194, 500, 48, 116, 500, 40, 48, 500, 54, 500, 48, 354, 500, 500, 128, 60, 128, 500, 72, 500, 500, 50, 234, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3860073522426702, "mean_inference_ms": 1.237669091656437, "mean_action_processing_ms": 0.14479480479570664, "mean_env_wait_ms": 0.08568995334622687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02705097198486328, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.13520193099975586}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5927.20690844985, "num_env_steps_trained_throughput_per_sec": 5927.20690844985, "timesteps_total": 1356000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 2127.91, "sample_time_ms": 1916.326, "load_time_ms": 10.087, "load_throughput": 1189637.235, "learn_time_ms": 190.815, "learn_throughput": 62888.006, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "episodes_total": 5057, "training_iteration": 113, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-49", "timestamp": 1698247849, "time_this_iter_s": 2.0305612087249756, "time_total_s": 257.69745659828186, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 257.69745659828186, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 53.03333333333333, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9259299443872365e-35, "cur_lr": 0.0003, "total_loss": 6.022540696461996, "policy_loss": -6.387308239936828e-05, "vf_loss": 6.022646427154541, "vf_explained_var": -1.223882039388021e-06, "kl": 5.073266146003637e-05, "entropy": 0.4178967197736104, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1703.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.95299999999982, "episode_len_mean": 256.1, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 9.099999999999689, 46.099999999999994, -50.00000000000044, 47.7, 46.5, 43.900000000000006, 46.9, 29.299999999999976, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.699999999999996, 43.30000000000001, 45.9, -50.00000000000044, 40.90000000000002, 45.5, 45.7, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 39.10000000000002, 45.1, 43.7, -50.00000000000044, 25.899999999999928, 38.50000000000003, 29.69999999999998, -50.00000000000044, 45.1, 39.90000000000002, 30.699999999999996, -50.00000000000044, 45.3, 38.50000000000003, -50.00000000000044, 46.099999999999994, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 45.3, 14.699999999999768, -50.00000000000044, -50.00000000000044, 37.300000000000026, 44.10000000000001, 37.300000000000026, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 26.69999999999994, -50.00000000000044, 43.50000000000001, 36.70000000000003, -50.00000000000044, 21.499999999999865, 43.900000000000006, 46.3, -50.00000000000044, 45.1, 39.10000000000002, 42.900000000000006, -50.00000000000044, 41.90000000000001, 7.299999999999663, -50.00000000000044, 46.3, 4.699999999999626, -50.00000000000044, -50.00000000000044, 23.8999999999999, 42.500000000000014, 45.9, -50.00000000000044, 41.500000000000014, 45.1, -50.00000000000044, 30.699999999999996, 39.90000000000002, 46.3, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.9, 18.29999999999982, 36.30000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 410, 40, 500, 24, 36, 62, 32, 208, 500, 62, 500, 34, 68, 42, 500, 92, 46, 44, 500, 500, 42, 500, 110, 50, 64, 500, 242, 116, 204, 500, 50, 102, 194, 500, 48, 116, 500, 40, 48, 500, 54, 500, 48, 354, 500, 500, 128, 60, 128, 500, 72, 500, 500, 50, 234, 500, 66, 134, 500, 286, 62, 38, 500, 50, 110, 72, 500, 82, 428, 500, 38, 454, 500, 500, 262, 76, 42, 500, 86, 50, 500, 194, 102, 38, 94, 500, 500, 500, 500, 500, 46, 32, 318, 138, 58, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3857598410591887, "mean_inference_ms": 1.2371872307016505, "mean_action_processing_ms": 0.1447210066306948, "mean_env_wait_ms": 0.0855380335175791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02004837989807129, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.11893630027770996}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.95299999999982, "episode_len_mean": 256.1, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 9.099999999999689, 46.099999999999994, -50.00000000000044, 47.7, 46.5, 43.900000000000006, 46.9, 29.299999999999976, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.699999999999996, 43.30000000000001, 45.9, -50.00000000000044, 40.90000000000002, 45.5, 45.7, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 39.10000000000002, 45.1, 43.7, -50.00000000000044, 25.899999999999928, 38.50000000000003, 29.69999999999998, -50.00000000000044, 45.1, 39.90000000000002, 30.699999999999996, -50.00000000000044, 45.3, 38.50000000000003, -50.00000000000044, 46.099999999999994, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 45.3, 14.699999999999768, -50.00000000000044, -50.00000000000044, 37.300000000000026, 44.10000000000001, 37.300000000000026, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 26.69999999999994, -50.00000000000044, 43.50000000000001, 36.70000000000003, -50.00000000000044, 21.499999999999865, 43.900000000000006, 46.3, -50.00000000000044, 45.1, 39.10000000000002, 42.900000000000006, -50.00000000000044, 41.90000000000001, 7.299999999999663, -50.00000000000044, 46.3, 4.699999999999626, -50.00000000000044, -50.00000000000044, 23.8999999999999, 42.500000000000014, 45.9, -50.00000000000044, 41.500000000000014, 45.1, -50.00000000000044, 30.699999999999996, 39.90000000000002, 46.3, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.9, 18.29999999999982, 36.30000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 410, 40, 500, 24, 36, 62, 32, 208, 500, 62, 500, 34, 68, 42, 500, 92, 46, 44, 500, 500, 42, 500, 110, 50, 64, 500, 242, 116, 204, 500, 50, 102, 194, 500, 48, 116, 500, 40, 48, 500, 54, 500, 48, 354, 500, 500, 128, 60, 128, 500, 72, 500, 500, 50, 234, 500, 66, 134, 500, 286, 62, 38, 500, 50, 110, 72, 500, 82, 428, 500, 38, 454, 500, 500, 262, 76, 42, 500, 86, 50, 500, 194, 102, 38, 94, 500, 500, 500, 500, 500, 46, 32, 318, 138, 58, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3857598410591887, "mean_inference_ms": 1.2371872307016505, "mean_action_processing_ms": 0.1447210066306948, "mean_env_wait_ms": 0.0855380335175791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02004837989807129, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.11893630027770996}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5459.463159158695, "num_env_steps_trained_throughput_per_sec": 5459.463159158695, "timesteps_total": 1368000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 2140.201, "sample_time_ms": 1913.15, "load_time_ms": 10.341, "load_throughput": 1160410.569, "learn_time_ms": 206.004, "learn_throughput": 58251.188, "synch_weights_time_ms": 9.125}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5098, "training_iteration": 114, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-51", "timestamp": 1698247851, "time_this_iter_s": 2.2040159702301025, "time_total_s": 259.90147256851196, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 259.90147256851196, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 62.56666666666667, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.629649721936182e-36, "cur_lr": 0.0003, "total_loss": 6.491062037150065, "policy_loss": -0.00015915948897600175, "vf_loss": 6.491261100769043, "vf_explained_var": -1.1205673217773438e-06, "kl": 0.00013936790149860674, "entropy": 0.3980354567368825, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1718.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8839999999997987, "episode_len_mean": 281.74, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.699999999999768, -50.00000000000044, -50.00000000000044, 37.300000000000026, 44.10000000000001, 37.300000000000026, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 26.69999999999994, -50.00000000000044, 43.50000000000001, 36.70000000000003, -50.00000000000044, 21.499999999999865, 43.900000000000006, 46.3, -50.00000000000044, 45.1, 39.10000000000002, 42.900000000000006, -50.00000000000044, 41.90000000000001, 7.299999999999663, -50.00000000000044, 46.3, 4.699999999999626, -50.00000000000044, -50.00000000000044, 23.8999999999999, 42.500000000000014, 45.9, -50.00000000000044, 41.500000000000014, 45.1, -50.00000000000044, 30.699999999999996, 39.90000000000002, 46.3, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.9, 18.29999999999982, 36.30000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 30.9, 47.1, 44.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 37.300000000000026, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, 6.699999999999655, 46.3, -50.00000000000044, 45.1, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.699999999999996, 32.100000000000016, 25.899999999999928, -50.00000000000044, 45.9, 45.9, 46.099999999999994, -50.00000000000044, 21.89999999999987, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 47.3], "episode_lengths": [354, 500, 500, 128, 60, 128, 500, 72, 500, 500, 50, 234, 500, 66, 134, 500, 286, 62, 38, 500, 50, 110, 72, 500, 82, 428, 500, 38, 454, 500, 500, 262, 76, 42, 500, 86, 50, 500, 194, 102, 38, 94, 500, 500, 500, 500, 500, 46, 32, 318, 138, 58, 500, 500, 500, 500, 38, 500, 230, 500, 500, 500, 142, 192, 30, 54, 82, 500, 500, 500, 500, 98, 128, 500, 58, 500, 86, 434, 38, 500, 50, 98, 500, 500, 88, 500, 34, 180, 242, 500, 42, 42, 40, 500, 282, 500, 56, 500, 500, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856779120303586, "mean_inference_ms": 1.2371496078829283, "mean_action_processing_ms": 0.14478279704965602, "mean_env_wait_ms": 0.08550366207302128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019001245498657227, "StateBufferConnector_ms": 0.01000070571899414, "ViewRequirementAgentConnector_ms": 0.12468576431274414}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8839999999997987, "episode_len_mean": 281.74, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.699999999999768, -50.00000000000044, -50.00000000000044, 37.300000000000026, 44.10000000000001, 37.300000000000026, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 26.69999999999994, -50.00000000000044, 43.50000000000001, 36.70000000000003, -50.00000000000044, 21.499999999999865, 43.900000000000006, 46.3, -50.00000000000044, 45.1, 39.10000000000002, 42.900000000000006, -50.00000000000044, 41.90000000000001, 7.299999999999663, -50.00000000000044, 46.3, 4.699999999999626, -50.00000000000044, -50.00000000000044, 23.8999999999999, 42.500000000000014, 45.9, -50.00000000000044, 41.500000000000014, 45.1, -50.00000000000044, 30.699999999999996, 39.90000000000002, 46.3, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.9, 18.29999999999982, 36.30000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 30.9, 47.1, 44.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 37.300000000000026, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, 6.699999999999655, 46.3, -50.00000000000044, 45.1, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.699999999999996, 32.100000000000016, 25.899999999999928, -50.00000000000044, 45.9, 45.9, 46.099999999999994, -50.00000000000044, 21.89999999999987, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 47.3], "episode_lengths": [354, 500, 500, 128, 60, 128, 500, 72, 500, 500, 50, 234, 500, 66, 134, 500, 286, 62, 38, 500, 50, 110, 72, 500, 82, 428, 500, 38, 454, 500, 500, 262, 76, 42, 500, 86, 50, 500, 194, 102, 38, 94, 500, 500, 500, 500, 500, 46, 32, 318, 138, 58, 500, 500, 500, 500, 38, 500, 230, 500, 500, 500, 142, 192, 30, 54, 82, 500, 500, 500, 500, 98, 128, 500, 58, 500, 86, 434, 38, 500, 50, 98, 500, 500, 88, 500, 34, 180, 242, 500, 42, 42, 40, 500, 282, 500, 56, 500, 500, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856779120303586, "mean_inference_ms": 1.2371496078829283, "mean_action_processing_ms": 0.14478279704965602, "mean_env_wait_ms": 0.08550366207302128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019001245498657227, "StateBufferConnector_ms": 0.01000070571899414, "ViewRequirementAgentConnector_ms": 0.12468576431274414}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5236.80149176846, "num_env_steps_trained_throughput_per_sec": 5236.80149176846, "timesteps_total": 1380000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 2151.155, "sample_time_ms": 1908.148, "load_time_ms": 11.143, "load_throughput": 1076919.166, "learn_time_ms": 221.153, "learn_throughput": 54261.16, "synch_weights_time_ms": 9.33}, "counters": {"num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "episodes_total": 5143, "training_iteration": 115, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-54", "timestamp": 1698247854, "time_this_iter_s": 2.296145439147949, "time_total_s": 262.1976180076599, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 262.1976180076599, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 54.800000000000004, "ram_util_percent": 27.424999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.814824860968091e-36, "cur_lr": 0.0003, "total_loss": 6.315562470753988, "policy_loss": -0.00018503740429878234, "vf_loss": 6.315787633260091, "vf_explained_var": -9.139378865559896e-07, "kl": 0.00022037217660226817, "entropy": 0.40295171936353047, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1733.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0439999999998009, "episode_len_mean": 270.12, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 46.9, 18.29999999999982, 36.30000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 30.9, 47.1, 44.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 37.300000000000026, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, 6.699999999999655, 46.3, -50.00000000000044, 45.1, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.699999999999996, 32.100000000000016, 25.899999999999928, -50.00000000000044, 45.9, 45.9, 46.099999999999994, -50.00000000000044, 21.89999999999987, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 39.90000000000002, 41.90000000000001, 45.3, 39.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 46.5, 46.699999999999996, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.30000000000001, -50.00000000000044, 46.3, 44.10000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.300000000000026, 45.7, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 47.3, -50.00000000000044], "episode_lengths": [46, 32, 318, 138, 58, 500, 500, 500, 500, 38, 500, 230, 500, 500, 500, 142, 192, 30, 54, 82, 500, 500, 500, 500, 98, 128, 500, 58, 500, 86, 434, 38, 500, 50, 98, 500, 500, 88, 500, 34, 180, 242, 500, 42, 42, 40, 500, 282, 500, 56, 500, 500, 28, 500, 102, 82, 48, 110, 500, 66, 500, 500, 34, 42, 36, 34, 50, 500, 500, 500, 500, 500, 150, 68, 500, 38, 60, 500, 34, 500, 118, 44, 500, 44, 48, 500, 106, 500, 56, 76, 500, 500, 68, 500, 500, 38, 500, 48, 28, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3858725490879131, "mean_inference_ms": 1.236632225669537, "mean_action_processing_ms": 0.14460525578133693, "mean_env_wait_ms": 0.08552065760560744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019996166229248047, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.11396527290344238}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0439999999998009, "episode_len_mean": 270.12, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 46.9, 18.29999999999982, 36.30000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 30.9, 47.1, 44.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 37.300000000000026, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, 6.699999999999655, 46.3, -50.00000000000044, 45.1, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.699999999999996, 32.100000000000016, 25.899999999999928, -50.00000000000044, 45.9, 45.9, 46.099999999999994, -50.00000000000044, 21.89999999999987, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 39.90000000000002, 41.90000000000001, 45.3, 39.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 46.5, 46.699999999999996, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.30000000000001, -50.00000000000044, 46.3, 44.10000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.300000000000026, 45.7, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 47.3, -50.00000000000044], "episode_lengths": [46, 32, 318, 138, 58, 500, 500, 500, 500, 38, 500, 230, 500, 500, 500, 142, 192, 30, 54, 82, 500, 500, 500, 500, 98, 128, 500, 58, 500, 86, 434, 38, 500, 50, 98, 500, 500, 88, 500, 34, 180, 242, 500, 42, 42, 40, 500, 282, 500, 56, 500, 500, 28, 500, 102, 82, 48, 110, 500, 66, 500, 500, 34, 42, 36, 34, 50, 500, 500, 500, 500, 500, 150, 68, 500, 38, 60, 500, 34, 500, 118, 44, 500, 44, 48, 500, 106, 500, 56, 76, 500, 500, 68, 500, 500, 38, 500, 48, 28, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3858725490879131, "mean_inference_ms": 1.236632225669537, "mean_action_processing_ms": 0.14460525578133693, "mean_env_wait_ms": 0.08552065760560744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019996166229248047, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.11396527290344238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5976.802737293149, "num_env_steps_trained_throughput_per_sec": 5976.802737293149, "timesteps_total": 1392000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 2123.072, "sample_time_ms": 1902.022, "load_time_ms": 10.468, "load_throughput": 1146305.728, "learn_time_ms": 199.761, "learn_throughput": 60071.726, "synch_weights_time_ms": 9.422}, "counters": {"num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "episodes_total": 5190, "training_iteration": 116, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-56", "timestamp": 1698247856, "time_this_iter_s": 2.085683822631836, "time_total_s": 264.28330183029175, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 264.28330183029175, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 57.76666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4074124304840456e-36, "cur_lr": 0.0003, "total_loss": 6.002873198191325, "policy_loss": -0.0005479509631792705, "vf_loss": 6.003462378184, "vf_explained_var": -1.0967254638671874e-06, "kl": 0.0008902129474790855, "entropy": 0.41078346967697144, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1748.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6339999999998047, "episode_len_mean": 264.22, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.899999999999928, -50.00000000000044, 45.9, 45.9, 46.099999999999994, -50.00000000000044, 21.89999999999987, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 39.90000000000002, 41.90000000000001, 45.3, 39.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 46.5, 46.699999999999996, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.30000000000001, -50.00000000000044, 46.3, 44.10000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.300000000000026, 45.7, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 38.90000000000002, -50.00000000000044, 40.90000000000002, 36.70000000000003, -50.00000000000044, 41.30000000000001, 44.5, 39.90000000000002, 45.9, -50.00000000000044, 40.10000000000002, 19.499999999999837, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.70000000000003, 38.50000000000003, -50.00000000000044, 45.3, 46.3, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001], "episode_lengths": [242, 500, 42, 42, 40, 500, 282, 500, 56, 500, 500, 28, 500, 102, 82, 48, 110, 500, 66, 500, 500, 34, 42, 36, 34, 50, 500, 500, 500, 500, 500, 150, 68, 500, 38, 60, 500, 34, 500, 118, 44, 500, 44, 48, 500, 106, 500, 56, 76, 500, 500, 68, 500, 500, 38, 500, 48, 28, 500, 500, 500, 50, 44, 112, 500, 92, 134, 500, 88, 56, 102, 42, 500, 100, 306, 246, 500, 500, 500, 500, 56, 76, 500, 500, 134, 116, 500, 48, 38, 48, 500, 500, 40, 44, 500, 500, 500, 500, 30, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38579711407936995, "mean_inference_ms": 1.235975675474838, "mean_action_processing_ms": 0.14448016643136957, "mean_env_wait_ms": 0.0855177977465016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02202773094177246, "StateBufferConnector_ms": 0.0040035247802734375, "ViewRequirementAgentConnector_ms": 0.1179361343383789}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6339999999998047, "episode_len_mean": 264.22, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.899999999999928, -50.00000000000044, 45.9, 45.9, 46.099999999999994, -50.00000000000044, 21.89999999999987, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 39.90000000000002, 41.90000000000001, 45.3, 39.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 46.5, 46.699999999999996, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.30000000000001, -50.00000000000044, 46.3, 44.10000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.300000000000026, 45.7, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 38.90000000000002, -50.00000000000044, 40.90000000000002, 36.70000000000003, -50.00000000000044, 41.30000000000001, 44.5, 39.90000000000002, 45.9, -50.00000000000044, 40.10000000000002, 19.499999999999837, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.70000000000003, 38.50000000000003, -50.00000000000044, 45.3, 46.3, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001], "episode_lengths": [242, 500, 42, 42, 40, 500, 282, 500, 56, 500, 500, 28, 500, 102, 82, 48, 110, 500, 66, 500, 500, 34, 42, 36, 34, 50, 500, 500, 500, 500, 500, 150, 68, 500, 38, 60, 500, 34, 500, 118, 44, 500, 44, 48, 500, 106, 500, 56, 76, 500, 500, 68, 500, 500, 38, 500, 48, 28, 500, 500, 500, 50, 44, 112, 500, 92, 134, 500, 88, 56, 102, 42, 500, 100, 306, 246, 500, 500, 500, 500, 56, 76, 500, 500, 134, 116, 500, 48, 38, 48, 500, 500, 40, 44, 500, 500, 500, 500, 30, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38579711407936995, "mean_inference_ms": 1.235975675474838, "mean_action_processing_ms": 0.14448016643136957, "mean_env_wait_ms": 0.0855177977465016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02202773094177246, "StateBufferConnector_ms": 0.0040035247802734375, "ViewRequirementAgentConnector_ms": 0.1179361343383789}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5591.146082987754, "num_env_steps_trained_throughput_per_sec": 5591.146082987754, "timesteps_total": 1404000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 2133.754, "sample_time_ms": 1895.498, "load_time_ms": 10.562, "load_throughput": 1136182.795, "learn_time_ms": 216.619, "learn_throughput": 55396.781, "synch_weights_time_ms": 9.477}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5231, "training_iteration": 117, "trial_id": "9f288_00011", "date": "2023-10-25_16-30-58", "timestamp": 1698247858, "time_this_iter_s": 2.152256488800049, "time_total_s": 266.4355583190918, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 266.4355583190918, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 56.53333333333333, "ram_util_percent": 26.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2037062152420228e-36, "cur_lr": 0.0003, "total_loss": 6.056666660308838, "policy_loss": -1.3184982041517893e-05, "vf_loss": 6.056718508402507, "vf_explained_var": -3.894170125325521e-07, "kl": 0.0007268379468068057, "entropy": 0.3881066501140594, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1763.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.734000000000231, "episode_len_mean": 297.82, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, -50.00000000000044, 38.300000000000026, 45.7, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 38.90000000000002, -50.00000000000044, 40.90000000000002, 36.70000000000003, -50.00000000000044, 41.30000000000001, 44.5, 39.90000000000002, 45.9, -50.00000000000044, 40.10000000000002, 19.499999999999837, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.70000000000003, 38.50000000000003, -50.00000000000044, 45.3, 46.3, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 37.300000000000026, 46.3, -50.00000000000044, 45.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003], "episode_lengths": [500, 34, 500, 118, 44, 500, 44, 48, 500, 106, 500, 56, 76, 500, 500, 68, 500, 500, 38, 500, 48, 28, 500, 500, 500, 50, 44, 112, 500, 92, 134, 500, 88, 56, 102, 42, 500, 100, 306, 246, 500, 500, 500, 500, 56, 76, 500, 500, 134, 116, 500, 48, 38, 48, 500, 500, 40, 44, 500, 500, 500, 500, 30, 60, 500, 500, 500, 500, 46, 74, 500, 40, 500, 210, 500, 500, 34, 500, 500, 500, 500, 500, 500, 500, 106, 500, 128, 38, 500, 48, 84, 500, 500, 36, 46, 500, 500, 500, 500, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38566748797020844, "mean_inference_ms": 1.235715998989, "mean_action_processing_ms": 0.14444100296078002, "mean_env_wait_ms": 0.08550324236327445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025028467178344727, "StateBufferConnector_ms": 0.0050008296966552734, "ViewRequirementAgentConnector_ms": 0.12496709823608398}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.734000000000231, "episode_len_mean": 297.82, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, -50.00000000000044, 38.300000000000026, 45.7, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 38.90000000000002, -50.00000000000044, 40.90000000000002, 36.70000000000003, -50.00000000000044, 41.30000000000001, 44.5, 39.90000000000002, 45.9, -50.00000000000044, 40.10000000000002, 19.499999999999837, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.70000000000003, 38.50000000000003, -50.00000000000044, 45.3, 46.3, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 37.300000000000026, 46.3, -50.00000000000044, 45.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003], "episode_lengths": [500, 34, 500, 118, 44, 500, 44, 48, 500, 106, 500, 56, 76, 500, 500, 68, 500, 500, 38, 500, 48, 28, 500, 500, 500, 50, 44, 112, 500, 92, 134, 500, 88, 56, 102, 42, 500, 100, 306, 246, 500, 500, 500, 500, 56, 76, 500, 500, 134, 116, 500, 48, 38, 48, 500, 500, 40, 44, 500, 500, 500, 500, 30, 60, 500, 500, 500, 500, 46, 74, 500, 40, 500, 210, 500, 500, 34, 500, 500, 500, 500, 500, 500, 500, 106, 500, 128, 38, 500, 48, 84, 500, 500, 36, 46, 500, 500, 500, 500, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38566748797020844, "mean_inference_ms": 1.235715998989, "mean_action_processing_ms": 0.14444100296078002, "mean_env_wait_ms": 0.08550324236327445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025028467178344727, "StateBufferConnector_ms": 0.0050008296966552734, "ViewRequirementAgentConnector_ms": 0.12496709823608398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5183.477883401828, "num_env_steps_trained_throughput_per_sec": 5183.477883401828, "timesteps_total": 1416000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 2160.934, "sample_time_ms": 1894.302, "load_time_ms": 11.462, "load_throughput": 1046909.669, "learn_time_ms": 244.001, "learn_throughput": 49180.038, "synch_weights_time_ms": 9.57}, "counters": {"num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "episodes_total": 5267, "training_iteration": 118, "trial_id": "9f288_00011", "date": "2023-10-25_16-31-00", "timestamp": 1698247860, "time_this_iter_s": 2.3203775882720947, "time_total_s": 268.7559359073639, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 268.7559359073639, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 58.099999999999994, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.018531076210114e-37, "cur_lr": 0.0003, "total_loss": 6.443867270151774, "policy_loss": -0.00013517414530118306, "vf_loss": 6.444047196706136, "vf_explained_var": -1.3669331868489583e-06, "kl": 0.00018102326478886728, "entropy": 0.4494134565194448, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1778.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.3570000000002125, "episode_len_mean": 279.1, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 37.300000000000026, 46.3, -50.00000000000044, 45.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 20.099999999999845, 19.69999999999984, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.1, 47.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, 45.3, 44.7, 45.1, 45.5, 21.499999999999865, 46.9, 46.9, -50.00000000000044, 44.7, 29.899999999999984, 46.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 42.900000000000006, -50.00000000000044, 46.9, 31.300000000000004, 46.5, 41.90000000000001, 41.70000000000002, 44.300000000000004, 39.70000000000002, -50.00000000000044, 45.9, 41.90000000000001, 46.699999999999996], "episode_lengths": [38, 48, 500, 500, 40, 44, 500, 500, 500, 500, 30, 60, 500, 500, 500, 500, 46, 74, 500, 40, 500, 210, 500, 500, 34, 500, 500, 500, 500, 500, 500, 500, 106, 500, 128, 38, 500, 48, 84, 500, 500, 36, 46, 500, 500, 500, 500, 122, 500, 300, 304, 500, 66, 500, 500, 60, 500, 108, 500, 40, 500, 30, 24, 500, 34, 500, 78, 500, 500, 46, 48, 54, 50, 46, 286, 32, 32, 500, 54, 202, 36, 500, 46, 500, 500, 500, 348, 72, 500, 32, 188, 36, 82, 84, 58, 104, 500, 42, 82, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3851031006841601, "mean_inference_ms": 1.2353379894833787, "mean_action_processing_ms": 0.14460954384616528, "mean_env_wait_ms": 0.08525553832185034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02503180503845215, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.11007142066955566}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.3570000000002125, "episode_len_mean": 279.1, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 37.300000000000026, 46.3, -50.00000000000044, 45.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 20.099999999999845, 19.69999999999984, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.1, 47.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, 45.3, 44.7, 45.1, 45.5, 21.499999999999865, 46.9, 46.9, -50.00000000000044, 44.7, 29.899999999999984, 46.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 42.900000000000006, -50.00000000000044, 46.9, 31.300000000000004, 46.5, 41.90000000000001, 41.70000000000002, 44.300000000000004, 39.70000000000002, -50.00000000000044, 45.9, 41.90000000000001, 46.699999999999996], "episode_lengths": [38, 48, 500, 500, 40, 44, 500, 500, 500, 500, 30, 60, 500, 500, 500, 500, 46, 74, 500, 40, 500, 210, 500, 500, 34, 500, 500, 500, 500, 500, 500, 500, 106, 500, 128, 38, 500, 48, 84, 500, 500, 36, 46, 500, 500, 500, 500, 122, 500, 300, 304, 500, 66, 500, 500, 60, 500, 108, 500, 40, 500, 30, 24, 500, 34, 500, 78, 500, 500, 46, 48, 54, 50, 46, 286, 32, 32, 500, 54, 202, 36, 500, 46, 500, 500, 500, 348, 72, 500, 32, 188, 36, 82, 84, 58, 104, 500, 42, 82, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3851031006841601, "mean_inference_ms": 1.2353379894833787, "mean_action_processing_ms": 0.14460954384616528, "mean_env_wait_ms": 0.08525553832185034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02503180503845215, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.11007142066955566}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5873.77069727416, "num_env_steps_trained_throughput_per_sec": 5873.77069727416, "timesteps_total": 1428000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 2164.622, "sample_time_ms": 1895.39, "load_time_ms": 11.052, "load_throughput": 1085821.955, "learn_time_ms": 246.809, "learn_throughput": 48620.677, "synch_weights_time_ms": 9.649}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "episodes_total": 5319, "training_iteration": 119, "trial_id": "9f288_00011", "date": "2023-10-25_16-31-02", "timestamp": 1698247862, "time_this_iter_s": 2.048975944519043, "time_total_s": 270.80491185188293, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 270.80491185188293, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 57.63333333333333, "ram_util_percent": 26.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.009265538105057e-37, "cur_lr": 0.0003, "total_loss": 6.422488784790039, "policy_loss": -7.395396629969278e-05, "vf_loss": 6.422606341044108, "vf_explained_var": -5.443890889485677e-07, "kl": 0.0002859981189052026, "entropy": 0.4335484405358632, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1793.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.849999999999812, "episode_len_mean": 262.12, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 20.099999999999845, 19.69999999999984, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.1, 47.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, 45.3, 44.7, 45.1, 45.5, 21.499999999999865, 46.9, 46.9, -50.00000000000044, 44.7, 29.899999999999984, 46.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 42.900000000000006, -50.00000000000044, 46.9, 31.300000000000004, 46.5, 41.90000000000001, 41.70000000000002, 44.300000000000004, 39.70000000000002, -50.00000000000044, 45.9, 41.90000000000001, 46.699999999999996, -50.00000000000044, 27.49999999999995, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 41.70000000000002, 21.299999999999862, 47.1, -50.00000000000044, 15.699999999999783, 33.10000000000003, 41.100000000000016, 44.7, 44.5, 44.300000000000004, 29.49999999999998, 10.299999999999706, 39.90000000000002, -50.00000000000044, 34.10000000000004, 44.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.3, 45.3, 5.899999999999643, -50.00000000000044, 26.89999999999994], "episode_lengths": [500, 36, 46, 500, 500, 500, 500, 122, 500, 300, 304, 500, 66, 500, 500, 60, 500, 108, 500, 40, 500, 30, 24, 500, 34, 500, 78, 500, 500, 46, 48, 54, 50, 46, 286, 32, 32, 500, 54, 202, 36, 500, 46, 500, 500, 500, 348, 72, 500, 32, 188, 36, 82, 84, 58, 104, 500, 42, 82, 34, 500, 226, 500, 474, 500, 500, 132, 500, 500, 48, 500, 54, 500, 84, 288, 30, 500, 344, 170, 90, 54, 56, 58, 206, 398, 102, 500, 160, 56, 38, 500, 500, 500, 42, 500, 38, 48, 442, 500, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3849185590534286, "mean_inference_ms": 1.235567008682427, "mean_action_processing_ms": 0.14477475081972108, "mean_env_wait_ms": 0.08513039569757794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022777318954467773, "StateBufferConnector_ms": 0.002995014190673828, "ViewRequirementAgentConnector_ms": 0.09608769416809082}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.849999999999812, "episode_len_mean": 262.12, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 20.099999999999845, 19.69999999999984, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.1, 47.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, 45.3, 44.7, 45.1, 45.5, 21.499999999999865, 46.9, 46.9, -50.00000000000044, 44.7, 29.899999999999984, 46.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 42.900000000000006, -50.00000000000044, 46.9, 31.300000000000004, 46.5, 41.90000000000001, 41.70000000000002, 44.300000000000004, 39.70000000000002, -50.00000000000044, 45.9, 41.90000000000001, 46.699999999999996, -50.00000000000044, 27.49999999999995, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 41.70000000000002, 21.299999999999862, 47.1, -50.00000000000044, 15.699999999999783, 33.10000000000003, 41.100000000000016, 44.7, 44.5, 44.300000000000004, 29.49999999999998, 10.299999999999706, 39.90000000000002, -50.00000000000044, 34.10000000000004, 44.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.3, 45.3, 5.899999999999643, -50.00000000000044, 26.89999999999994], "episode_lengths": [500, 36, 46, 500, 500, 500, 500, 122, 500, 300, 304, 500, 66, 500, 500, 60, 500, 108, 500, 40, 500, 30, 24, 500, 34, 500, 78, 500, 500, 46, 48, 54, 50, 46, 286, 32, 32, 500, 54, 202, 36, 500, 46, 500, 500, 500, 348, 72, 500, 32, 188, 36, 82, 84, 58, 104, 500, 42, 82, 34, 500, 226, 500, 474, 500, 500, 132, 500, 500, 48, 500, 54, 500, 84, 288, 30, 500, 344, 170, 90, 54, 56, 58, 206, 398, 102, 500, 160, 56, 38, 500, 500, 500, 42, 500, 38, 48, 442, 500, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3849185590534286, "mean_inference_ms": 1.235567008682427, "mean_action_processing_ms": 0.14477475081972108, "mean_env_wait_ms": 0.08513039569757794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022777318954467773, "StateBufferConnector_ms": 0.002995014190673828, "ViewRequirementAgentConnector_ms": 0.09608769416809082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5472.965165874999, "num_env_steps_trained_throughput_per_sec": 5472.965165874999, "timesteps_total": 1440000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 2162.435, "sample_time_ms": 1894.781, "load_time_ms": 10.552, "load_throughput": 1137212.215, "learn_time_ms": 245.76, "learn_throughput": 48828.213, "synch_weights_time_ms": 9.816}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5359, "training_iteration": 120, "trial_id": "9f288_00011", "date": "2023-10-25_16-31-05", "timestamp": 1698247865, "time_this_iter_s": 2.197594404220581, "time_total_s": 273.0025062561035, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 273.0025062561035, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 60.833333333333336, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5046327690525285e-37, "cur_lr": 0.0003, "total_loss": 6.56451743443807, "policy_loss": -0.0001839160919189453, "vf_loss": 6.564743264516195, "vf_explained_var": -1.0728836059570312e-06, "kl": 0.0001407615673277481, "entropy": 0.41867614587148033, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1808.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.29599999999984, "episode_len_mean": 227.72, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 41.70000000000002, 21.299999999999862, 47.1, -50.00000000000044, 15.699999999999783, 33.10000000000003, 41.100000000000016, 44.7, 44.5, 44.300000000000004, 29.49999999999998, 10.299999999999706, 39.90000000000002, -50.00000000000044, 34.10000000000004, 44.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.3, 45.3, 5.899999999999643, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 44.900000000000006, 47.3, 42.900000000000006, 33.70000000000004, -50.00000000000044, 43.50000000000001, 44.5, 40.10000000000002, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.9, 44.7, 23.499999999999893, 45.3, 47.1, 45.5, 47.5, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, 18.499999999999822, 44.7, -50.00000000000044, 45.5, 47.1, 46.5, 12.899999999999743, 39.300000000000026, 44.300000000000004, -50.00000000000044, 46.099999999999994, 44.7, -50.00000000000044, 46.5, 46.5, 41.90000000000001, 47.5, -50.00000000000044, 47.1, 46.5, 44.10000000000001, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 34.50000000000004, 46.9, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 43.30000000000001, 46.5, -50.00000000000044, 46.5], "episode_lengths": [500, 474, 500, 500, 132, 500, 500, 48, 500, 54, 500, 84, 288, 30, 500, 344, 170, 90, 54, 56, 58, 206, 398, 102, 500, 160, 56, 38, 500, 500, 500, 42, 500, 38, 48, 442, 500, 232, 500, 500, 28, 500, 52, 28, 72, 164, 500, 66, 56, 100, 54, 500, 500, 58, 32, 54, 266, 48, 30, 46, 26, 500, 20, 500, 500, 316, 54, 500, 46, 30, 36, 372, 108, 58, 500, 40, 54, 500, 36, 36, 82, 26, 500, 30, 36, 60, 36, 500, 46, 500, 156, 32, 500, 42, 500, 56, 68, 36, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.384832060672166, "mean_inference_ms": 1.2349130699241417, "mean_action_processing_ms": 0.14447076790916563, "mean_env_wait_ms": 0.08538005572854106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020784378051757812, "StateBufferConnector_ms": 0.007992267608642578, "ViewRequirementAgentConnector_ms": 0.10498929023742676}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.29599999999984, "episode_len_mean": 227.72, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 41.70000000000002, 21.299999999999862, 47.1, -50.00000000000044, 15.699999999999783, 33.10000000000003, 41.100000000000016, 44.7, 44.5, 44.300000000000004, 29.49999999999998, 10.299999999999706, 39.90000000000002, -50.00000000000044, 34.10000000000004, 44.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.3, 45.3, 5.899999999999643, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 44.900000000000006, 47.3, 42.900000000000006, 33.70000000000004, -50.00000000000044, 43.50000000000001, 44.5, 40.10000000000002, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.9, 44.7, 23.499999999999893, 45.3, 47.1, 45.5, 47.5, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, 18.499999999999822, 44.7, -50.00000000000044, 45.5, 47.1, 46.5, 12.899999999999743, 39.300000000000026, 44.300000000000004, -50.00000000000044, 46.099999999999994, 44.7, -50.00000000000044, 46.5, 46.5, 41.90000000000001, 47.5, -50.00000000000044, 47.1, 46.5, 44.10000000000001, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 34.50000000000004, 46.9, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 43.30000000000001, 46.5, -50.00000000000044, 46.5], "episode_lengths": [500, 474, 500, 500, 132, 500, 500, 48, 500, 54, 500, 84, 288, 30, 500, 344, 170, 90, 54, 56, 58, 206, 398, 102, 500, 160, 56, 38, 500, 500, 500, 42, 500, 38, 48, 442, 500, 232, 500, 500, 28, 500, 52, 28, 72, 164, 500, 66, 56, 100, 54, 500, 500, 58, 32, 54, 266, 48, 30, 46, 26, 500, 20, 500, 500, 316, 54, 500, 46, 30, 36, 372, 108, 58, 500, 40, 54, 500, 36, 36, 82, 26, 500, 30, 36, 60, 36, 500, 46, 500, 156, 32, 500, 42, 500, 56, 68, 36, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.384832060672166, "mean_inference_ms": 1.2349130699241417, "mean_action_processing_ms": 0.14447076790916563, "mean_env_wait_ms": 0.08538005572854106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020784378051757812, "StateBufferConnector_ms": 0.007992267608642578, "ViewRequirementAgentConnector_ms": 0.10498929023742676}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5225.211708617351, "num_env_steps_trained_throughput_per_sec": 5225.211708617351, "timesteps_total": 1452000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 2186.279, "sample_time_ms": 1900.405, "load_time_ms": 10.953, "load_throughput": 1095623.917, "learn_time_ms": 263.776, "learn_throughput": 45493.131, "synch_weights_time_ms": 9.617}, "counters": {"num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "episodes_total": 5421, "training_iteration": 121, "trial_id": "9f288_00011", "date": "2023-10-25_16-31-07", "timestamp": 1698247867, "time_this_iter_s": 2.3035402297973633, "time_total_s": 275.3060464859009, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 275.3060464859009, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 58.26666666666667, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.523163845262643e-38, "cur_lr": 0.0003, "total_loss": 6.544294643402099, "policy_loss": -0.00017308493455251057, "vf_loss": 6.5445098876953125, "vf_explained_var": -1.1046727498372397e-06, "kl": 0.00048254511530103627, "entropy": 0.4223279615243276, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1823.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.032999999999852, "episode_len_mean": 215.36, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 40.10000000000002, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.9, 44.7, 23.499999999999893, 45.3, 47.1, 45.5, 47.5, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, 18.499999999999822, 44.7, -50.00000000000044, 45.5, 47.1, 46.5, 12.899999999999743, 39.300000000000026, 44.300000000000004, -50.00000000000044, 46.099999999999994, 44.7, -50.00000000000044, 46.5, 46.5, 41.90000000000001, 47.5, -50.00000000000044, 47.1, 46.5, 44.10000000000001, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 34.50000000000004, 46.9, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 43.30000000000001, 46.5, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.900000000000006, 47.1, 41.500000000000014, 39.50000000000002, 38.90000000000002, 46.9, -50.00000000000044, 43.50000000000001, 45.5, 42.10000000000001, 39.10000000000002, -50.00000000000044, 35.10000000000004, 1.6999999999995836, 45.5, 18.899999999999828, 44.900000000000006, 42.900000000000006, -50.00000000000044, 20.899999999999856, 33.30000000000003, 42.900000000000006, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 21.699999999999868, 47.1, -50.00000000000044, 47.5, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 47.3, 33.70000000000004], "episode_lengths": [56, 100, 54, 500, 500, 58, 32, 54, 266, 48, 30, 46, 26, 500, 20, 500, 500, 316, 54, 500, 46, 30, 36, 372, 108, 58, 500, 40, 54, 500, 36, 36, 82, 26, 500, 30, 36, 60, 36, 500, 46, 500, 156, 32, 500, 42, 500, 56, 68, 36, 500, 36, 500, 500, 500, 72, 62, 30, 86, 106, 112, 32, 500, 66, 46, 80, 110, 500, 150, 484, 46, 312, 52, 72, 500, 292, 168, 72, 26, 500, 500, 500, 78, 500, 500, 500, 500, 110, 284, 30, 500, 26, 500, 58, 40, 500, 500, 24, 28, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38457335123784875, "mean_inference_ms": 1.2341498450954613, "mean_action_processing_ms": 0.1444389821466077, "mean_env_wait_ms": 0.08528196232437675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01800680160522461, "StateBufferConnector_ms": 0.009999990463256836, "ViewRequirementAgentConnector_ms": 0.10500741004943848}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.032999999999852, "episode_len_mean": 215.36, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 40.10000000000002, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.9, 44.7, 23.499999999999893, 45.3, 47.1, 45.5, 47.5, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, 18.499999999999822, 44.7, -50.00000000000044, 45.5, 47.1, 46.5, 12.899999999999743, 39.300000000000026, 44.300000000000004, -50.00000000000044, 46.099999999999994, 44.7, -50.00000000000044, 46.5, 46.5, 41.90000000000001, 47.5, -50.00000000000044, 47.1, 46.5, 44.10000000000001, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 34.50000000000004, 46.9, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 43.30000000000001, 46.5, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.900000000000006, 47.1, 41.500000000000014, 39.50000000000002, 38.90000000000002, 46.9, -50.00000000000044, 43.50000000000001, 45.5, 42.10000000000001, 39.10000000000002, -50.00000000000044, 35.10000000000004, 1.6999999999995836, 45.5, 18.899999999999828, 44.900000000000006, 42.900000000000006, -50.00000000000044, 20.899999999999856, 33.30000000000003, 42.900000000000006, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 21.699999999999868, 47.1, -50.00000000000044, 47.5, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 47.3, 33.70000000000004], "episode_lengths": [56, 100, 54, 500, 500, 58, 32, 54, 266, 48, 30, 46, 26, 500, 20, 500, 500, 316, 54, 500, 46, 30, 36, 372, 108, 58, 500, 40, 54, 500, 36, 36, 82, 26, 500, 30, 36, 60, 36, 500, 46, 500, 156, 32, 500, 42, 500, 56, 68, 36, 500, 36, 500, 500, 500, 72, 62, 30, 86, 106, 112, 32, 500, 66, 46, 80, 110, 500, 150, 484, 46, 312, 52, 72, 500, 292, 168, 72, 26, 500, 500, 500, 78, 500, 500, 500, 500, 110, 284, 30, 500, 26, 500, 58, 40, 500, 500, 24, 28, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38457335123784875, "mean_inference_ms": 1.2341498450954613, "mean_action_processing_ms": 0.1444389821466077, "mean_env_wait_ms": 0.08528196232437675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01800680160522461, "StateBufferConnector_ms": 0.009999990463256836, "ViewRequirementAgentConnector_ms": 0.10500741004943848}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5084.3242878491965, "num_env_steps_trained_throughput_per_sec": 5084.3242878491965, "timesteps_total": 1464000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 2187.545, "sample_time_ms": 1926.684, "load_time_ms": 10.405, "load_throughput": 1153255.566, "learn_time_ms": 239.319, "learn_throughput": 50142.281, "synch_weights_time_ms": 9.607}, "counters": {"num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "episodes_total": 5469, "training_iteration": 122, "trial_id": "9f288_00011", "date": "2023-10-25_16-31-09", "timestamp": 1698247869, "time_this_iter_s": 2.3661928176879883, "time_total_s": 277.67223930358887, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 277.67223930358887, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 48.425, "ram_util_percent": 26.424999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7615819226313213e-38, "cur_lr": 0.0003, "total_loss": 6.781552282969157, "policy_loss": -3.0193726221720377e-05, "vf_loss": 6.781627178192139, "vf_explained_var": -1.2954076131184896e-06, "kl": 0.00030351587602884443, "entropy": 0.44648764928181967, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1838.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.140999999999823, "episode_len_mean": 254.2, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.900000000000006, 47.1, 41.500000000000014, 39.50000000000002, 38.90000000000002, 46.9, -50.00000000000044, 43.50000000000001, 45.5, 42.10000000000001, 39.10000000000002, -50.00000000000044, 35.10000000000004, 1.6999999999995836, 45.5, 18.899999999999828, 44.900000000000006, 42.900000000000006, -50.00000000000044, 20.899999999999856, 33.30000000000003, 42.900000000000006, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 21.699999999999868, 47.1, -50.00000000000044, 47.5, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 47.3, 33.70000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 43.7, 29.099999999999973, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 47.5, 45.9, -50.00000000000044, 45.3, 36.30000000000003, 41.100000000000016, 41.500000000000014, 28.499999999999964, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 28.09999999999996, -50.00000000000044, 36.30000000000003, 38.50000000000003, 45.1, 46.699999999999996, 41.30000000000001, 44.10000000000001, 46.3, 46.3, 43.7], "episode_lengths": [500, 36, 500, 500, 500, 72, 62, 30, 86, 106, 112, 32, 500, 66, 46, 80, 110, 500, 150, 484, 46, 312, 52, 72, 500, 292, 168, 72, 26, 500, 500, 500, 78, 500, 500, 500, 500, 110, 284, 30, 500, 26, 500, 58, 40, 500, 500, 24, 28, 164, 500, 72, 500, 500, 34, 48, 500, 46, 500, 500, 64, 210, 500, 500, 118, 500, 500, 500, 50, 244, 500, 500, 500, 38, 26, 42, 500, 48, 138, 90, 86, 216, 44, 500, 500, 500, 500, 106, 500, 220, 500, 138, 116, 50, 34, 88, 60, 38, 38, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38441193615504476, "mean_inference_ms": 1.2335746112145907, "mean_action_processing_ms": 0.14432393189549286, "mean_env_wait_ms": 0.08518583487382866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019014596939086914, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.11190032958984375}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.140999999999823, "episode_len_mean": 254.2, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.900000000000006, 47.1, 41.500000000000014, 39.50000000000002, 38.90000000000002, 46.9, -50.00000000000044, 43.50000000000001, 45.5, 42.10000000000001, 39.10000000000002, -50.00000000000044, 35.10000000000004, 1.6999999999995836, 45.5, 18.899999999999828, 44.900000000000006, 42.900000000000006, -50.00000000000044, 20.899999999999856, 33.30000000000003, 42.900000000000006, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 21.699999999999868, 47.1, -50.00000000000044, 47.5, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 47.3, 33.70000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 43.7, 29.099999999999973, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 47.5, 45.9, -50.00000000000044, 45.3, 36.30000000000003, 41.100000000000016, 41.500000000000014, 28.499999999999964, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 28.09999999999996, -50.00000000000044, 36.30000000000003, 38.50000000000003, 45.1, 46.699999999999996, 41.30000000000001, 44.10000000000001, 46.3, 46.3, 43.7], "episode_lengths": [500, 36, 500, 500, 500, 72, 62, 30, 86, 106, 112, 32, 500, 66, 46, 80, 110, 500, 150, 484, 46, 312, 52, 72, 500, 292, 168, 72, 26, 500, 500, 500, 78, 500, 500, 500, 500, 110, 284, 30, 500, 26, 500, 58, 40, 500, 500, 24, 28, 164, 500, 72, 500, 500, 34, 48, 500, 46, 500, 500, 64, 210, 500, 500, 118, 500, 500, 500, 50, 244, 500, 500, 500, 38, 26, 42, 500, 48, 138, 90, 86, 216, 44, 500, 500, 500, 500, 106, 500, 220, 500, 138, 116, 50, 34, 88, 60, 38, 38, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38441193615504476, "mean_inference_ms": 1.2335746112145907, "mean_action_processing_ms": 0.14432393189549286, "mean_env_wait_ms": 0.08518583487382866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019014596939086914, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.11190032958984375}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5389.6491285180955, "num_env_steps_trained_throughput_per_sec": 5389.6491285180955, "timesteps_total": 1476000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 2207.737, "sample_time_ms": 1931.511, "load_time_ms": 10.483, "load_throughput": 1144691.969, "learn_time_ms": 254.6, "learn_throughput": 47132.744, "synch_weights_time_ms": 9.714}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5519, "training_iteration": 123, "trial_id": "9f288_00011", "date": "2023-10-25_16-31-12", "timestamp": 1698247872, "time_this_iter_s": 2.232482671737671, "time_total_s": 279.90472197532654, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 279.90472197532654, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 61.833333333333336, "ram_util_percent": 26.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8807909613156606e-38, "cur_lr": 0.0003, "total_loss": 5.875578053792318, "policy_loss": -0.0001962969700495402, "vf_loss": 5.8758192698160805, "vf_explained_var": -7.232030232747396e-07, "kl": 0.00030890187431206566, "entropy": 0.4492617150147756, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1853.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.0689999999998205, "episode_len_mean": 254.9, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 47.3, 33.70000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 43.7, 29.099999999999973, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 47.5, 45.9, -50.00000000000044, 45.3, 36.30000000000003, 41.100000000000016, 41.500000000000014, 28.499999999999964, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 28.09999999999996, -50.00000000000044, 36.30000000000003, 38.50000000000003, 45.1, 46.699999999999996, 41.30000000000001, 44.10000000000001, 46.3, 46.3, 43.7, 45.5, 45.3, 21.299999999999862, 43.7, 44.900000000000006, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 30.499999999999993, 45.1, 46.5, 32.700000000000024, 45.1, 45.9, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 43.10000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.7, 47.3, 44.900000000000006, -50.00000000000044, 40.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 40.90000000000002, -50.00000000000044], "episode_lengths": [500, 58, 40, 500, 500, 24, 28, 164, 500, 72, 500, 500, 34, 48, 500, 46, 500, 500, 64, 210, 500, 500, 118, 500, 500, 500, 50, 244, 500, 500, 500, 38, 26, 42, 500, 48, 138, 90, 86, 216, 44, 500, 500, 500, 500, 106, 500, 220, 500, 138, 116, 50, 34, 88, 60, 38, 38, 64, 46, 48, 288, 64, 52, 168, 500, 500, 500, 500, 500, 80, 196, 50, 36, 174, 50, 42, 40, 58, 500, 500, 500, 500, 500, 500, 124, 70, 60, 500, 500, 64, 28, 52, 500, 92, 88, 500, 500, 48, 92, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847752673117718, "mean_inference_ms": 1.2340974859775393, "mean_action_processing_ms": 0.14433847946129988, "mean_env_wait_ms": 0.08524273499177198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023553848266601562, "StateBufferConnector_ms": 0.008013486862182617, "ViewRequirementAgentConnector_ms": 0.12169241905212402}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.0689999999998205, "episode_len_mean": 254.9, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 47.3, 33.70000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 43.7, 29.099999999999973, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 47.5, 45.9, -50.00000000000044, 45.3, 36.30000000000003, 41.100000000000016, 41.500000000000014, 28.499999999999964, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 28.09999999999996, -50.00000000000044, 36.30000000000003, 38.50000000000003, 45.1, 46.699999999999996, 41.30000000000001, 44.10000000000001, 46.3, 46.3, 43.7, 45.5, 45.3, 21.299999999999862, 43.7, 44.900000000000006, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 30.499999999999993, 45.1, 46.5, 32.700000000000024, 45.1, 45.9, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 43.10000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.7, 47.3, 44.900000000000006, -50.00000000000044, 40.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 40.90000000000002, -50.00000000000044], "episode_lengths": [500, 58, 40, 500, 500, 24, 28, 164, 500, 72, 500, 500, 34, 48, 500, 46, 500, 500, 64, 210, 500, 500, 118, 500, 500, 500, 50, 244, 500, 500, 500, 38, 26, 42, 500, 48, 138, 90, 86, 216, 44, 500, 500, 500, 500, 106, 500, 220, 500, 138, 116, 50, 34, 88, 60, 38, 38, 64, 46, 48, 288, 64, 52, 168, 500, 500, 500, 500, 500, 80, 196, 50, 36, 174, 50, 42, 40, 58, 500, 500, 500, 500, 500, 500, 124, 70, 60, 500, 500, 64, 28, 52, 500, 92, 88, 500, 500, 48, 92, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847752673117718, "mean_inference_ms": 1.2340974859775393, "mean_action_processing_ms": 0.14433847946129988, "mean_env_wait_ms": 0.08524273499177198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023553848266601562, "StateBufferConnector_ms": 0.008013486862182617, "ViewRequirementAgentConnector_ms": 0.12169241905212402}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5249.28303169804, "num_env_steps_trained_throughput_per_sec": 5249.28303169804, "timesteps_total": 1488000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 2216.538, "sample_time_ms": 1930.654, "load_time_ms": 11.388, "load_throughput": 1053699.614, "learn_time_ms": 263.166, "learn_throughput": 45598.658, "synch_weights_time_ms": 9.8}, "counters": {"num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "episodes_total": 5561, "training_iteration": 124, "trial_id": "9f288_00011", "date": "2023-10-25_16-31-14", "timestamp": 1698247874, "time_this_iter_s": 2.292025327682495, "time_total_s": 282.19674730300903, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 282.19674730300903, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 59.0, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.403954806578303e-39, "cur_lr": 0.0003, "total_loss": 6.113855584462484, "policy_loss": -0.00037178186078866323, "vf_loss": 6.114272785186768, "vf_explained_var": -9.61621602376302e-07, "kl": 0.0003987694536647268, "entropy": 0.4548462192217509, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1868.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8359999999998047, "episode_len_mean": 272.22, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 41.500000000000014, 28.499999999999964, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 28.09999999999996, -50.00000000000044, 36.30000000000003, 38.50000000000003, 45.1, 46.699999999999996, 41.30000000000001, 44.10000000000001, 46.3, 46.3, 43.7, 45.5, 45.3, 21.299999999999862, 43.7, 44.900000000000006, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 30.499999999999993, 45.1, 46.5, 32.700000000000024, 45.1, 45.9, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 43.10000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.7, 47.3, 44.900000000000006, -50.00000000000044, 40.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 8.49999999999968, 43.7, 37.10000000000003, 9.299999999999692, 22.899999999999885, 22.49999999999988, -50.00000000000044, -50.00000000000044, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 43.50000000000001, -50.00000000000044, 45.1, 5.899999999999643, 40.70000000000002, -50.00000000000044], "episode_lengths": [90, 86, 216, 44, 500, 500, 500, 500, 106, 500, 220, 500, 138, 116, 50, 34, 88, 60, 38, 38, 64, 46, 48, 288, 64, 52, 168, 500, 500, 500, 500, 500, 80, 196, 50, 36, 174, 50, 42, 40, 58, 500, 500, 500, 500, 500, 500, 124, 70, 60, 500, 500, 64, 28, 52, 500, 92, 88, 500, 500, 48, 92, 500, 500, 500, 38, 78, 500, 500, 500, 500, 500, 88, 500, 500, 416, 64, 130, 408, 272, 276, 500, 500, 46, 44, 500, 500, 500, 48, 48, 500, 500, 500, 116, 66, 500, 50, 442, 94, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3849683317206041, "mean_inference_ms": 1.2339854033846174, "mean_action_processing_ms": 0.14437316360695396, "mean_env_wait_ms": 0.08518067577623553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02655172348022461, "StateBufferConnector_ms": 0.00700831413269043, "ViewRequirementAgentConnector_ms": 0.14743494987487793}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8359999999998047, "episode_len_mean": 272.22, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 41.500000000000014, 28.499999999999964, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 28.09999999999996, -50.00000000000044, 36.30000000000003, 38.50000000000003, 45.1, 46.699999999999996, 41.30000000000001, 44.10000000000001, 46.3, 46.3, 43.7, 45.5, 45.3, 21.299999999999862, 43.7, 44.900000000000006, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 30.499999999999993, 45.1, 46.5, 32.700000000000024, 45.1, 45.9, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 43.10000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.7, 47.3, 44.900000000000006, -50.00000000000044, 40.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 8.49999999999968, 43.7, 37.10000000000003, 9.299999999999692, 22.899999999999885, 22.49999999999988, -50.00000000000044, -50.00000000000044, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 43.50000000000001, -50.00000000000044, 45.1, 5.899999999999643, 40.70000000000002, -50.00000000000044], "episode_lengths": [90, 86, 216, 44, 500, 500, 500, 500, 106, 500, 220, 500, 138, 116, 50, 34, 88, 60, 38, 38, 64, 46, 48, 288, 64, 52, 168, 500, 500, 500, 500, 500, 80, 196, 50, 36, 174, 50, 42, 40, 58, 500, 500, 500, 500, 500, 500, 124, 70, 60, 500, 500, 64, 28, 52, 500, 92, 88, 500, 500, 48, 92, 500, 500, 500, 38, 78, 500, 500, 500, 500, 500, 88, 500, 500, 416, 64, 130, 408, 272, 276, 500, 500, 46, 44, 500, 500, 500, 48, 48, 500, 500, 500, 116, 66, 500, 50, 442, 94, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3849683317206041, "mean_inference_ms": 1.2339854033846174, "mean_action_processing_ms": 0.14437316360695396, "mean_env_wait_ms": 0.08518067577623553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02655172348022461, "StateBufferConnector_ms": 0.00700831413269043, "ViewRequirementAgentConnector_ms": 0.14743494987487793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5400.354332330765, "num_env_steps_trained_throughput_per_sec": 5400.354332330765, "timesteps_total": 1500000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 2209.598, "sample_time_ms": 1939.825, "load_time_ms": 10.687, "load_throughput": 1122877.757, "learn_time_ms": 247.855, "learn_throughput": 48415.493, "synch_weights_time_ms": 9.703}, "counters": {"num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": true, "episodes_total": 5598, "training_iteration": 125, "trial_id": "9f288_00011", "date": "2023-10-25_16-31-16", "timestamp": 1698247876, "time_this_iter_s": 2.2280731201171875, "time_total_s": 284.4248204231262, "pid": 26656, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 284.4248204231262, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 59.63333333333333, "ram_util_percent": 26.266666666666666}}
