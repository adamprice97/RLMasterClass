{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000007, "cur_lr": 0.0003, "total_loss": 9.379009819030761, "policy_loss": -0.0026595170299212136, "vf_loss": 9.381005032857258, "vf_explained_var": 0.0001871466636657715, "kl": 0.0036886357431361225, "entropy": 0.7345576961835225, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 40.70000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -29.252000000000344, "episode_len_mean": 432.8, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, -50.00000000000044, 34.50000000000004, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.699999999999925, 19.09999999999983, -50.00000000000044, 40.70000000000002], "episode_lengths": [500, 500, 500, 500, 304, 500, 500, 500, 500, 500, 500, 474, 500, 156, 238, 500, 500, 500, 500, 500, 500, 244, 310, 500, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.397316097141384, "mean_inference_ms": 1.2446929977371262, "mean_action_processing_ms": 0.14691498610642287, "mean_env_wait_ms": 0.08592012045266743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028000831604003906, "StateBufferConnector_ms": 0.011998176574707031, "ViewRequirementAgentConnector_ms": 0.17189979553222656}}, "episode_reward_max": 40.70000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -29.252000000000344, "episode_len_mean": 432.8, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, -50.00000000000044, 34.50000000000004, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.699999999999925, 19.09999999999983, -50.00000000000044, 40.70000000000002], "episode_lengths": [500, 500, 500, 500, 304, 500, 500, 500, 500, 500, 500, 474, 500, 156, 238, 500, 500, 500, 500, 500, 500, 244, 310, 500, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.397316097141384, "mean_inference_ms": 1.2446929977371262, "mean_action_processing_ms": 0.14691498610642287, "mean_env_wait_ms": 0.08592012045266743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028000831604003906, "StateBufferConnector_ms": 0.011998176574707031, "ViewRequirementAgentConnector_ms": 0.17189979553222656}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5777.567380553021, "num_env_steps_trained_throughput_per_sec": 5777.567380553021, "timesteps_total": 12000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 2076.999, "sample_time_ms": 1954.997, "load_time_ms": 7.001, "load_throughput": 1714001.294, "learn_time_ms": 102.999, "learn_throughput": 116505.478, "synch_weights_time_ms": 11.002}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 25, "training_iteration": 1, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-10", "timestamp": 1698244990, "time_this_iter_s": 2.0809977054595947, "time_total_s": 2.0809977054595947, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 2.0809977054595947, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 61.26666666666667, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000003, "cur_lr": 0.0003, "total_loss": 9.086120859781902, "policy_loss": -0.0014969895283381144, "vf_loss": 9.087396558125814, "vf_explained_var": -0.00038939317067464193, "kl": 0.0029365865667008014, "entropy": 0.7240477522214254, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 40.70000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -24.515384615384942, "episode_len_mean": 418.5769230769231, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, -50.00000000000044, 34.50000000000004, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.699999999999925, 19.09999999999983, -50.00000000000044, 40.70000000000002, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 3.699999999999612, 21.09999999999986, 17.299999999999805, 18.29999999999982, 21.299999999999862, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 15.699999999999783, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 304, 500, 500, 500, 500, 500, 500, 474, 500, 156, 238, 500, 500, 500, 500, 500, 500, 244, 310, 500, 94, 500, 194, 500, 500, 464, 290, 328, 318, 288, 500, 176, 500, 500, 500, 110, 500, 344, 236, 500, 500, 500, 198, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3936030499375339, "mean_inference_ms": 1.237010393697756, "mean_action_processing_ms": 0.14582964513446212, "mean_env_wait_ms": 0.0850981849527944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03269773263197679, "StateBufferConnector_ms": 0.00961010272686298, "ViewRequirementAgentConnector_ms": 0.1480070444253775}}, "episode_reward_max": 40.70000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -24.515384615384942, "episode_len_mean": 418.5769230769231, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, -50.00000000000044, 34.50000000000004, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.699999999999925, 19.09999999999983, -50.00000000000044, 40.70000000000002, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 3.699999999999612, 21.09999999999986, 17.299999999999805, 18.29999999999982, 21.299999999999862, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 15.699999999999783, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 304, 500, 500, 500, 500, 500, 500, 474, 500, 156, 238, 500, 500, 500, 500, 500, 500, 244, 310, 500, 94, 500, 194, 500, 500, 464, 290, 328, 318, 288, 500, 176, 500, 500, 500, 110, 500, 344, 236, 500, 500, 500, 198, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3936030499375339, "mean_inference_ms": 1.237010393697756, "mean_action_processing_ms": 0.14582964513446212, "mean_env_wait_ms": 0.0850981849527944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03269773263197679, "StateBufferConnector_ms": 0.00961010272686298, "ViewRequirementAgentConnector_ms": 0.1480070444253775}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5943.529930237548, "num_env_steps_trained_throughput_per_sec": 5943.529930237548, "timesteps_total": 24000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 2048.0, "sample_time_ms": 1925.499, "load_time_ms": 7.001, "load_throughput": 1714118.04, "learn_time_ms": 104.5, "learn_throughput": 114832.344, "synch_weights_time_ms": 10.001}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 52, "training_iteration": 2, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-12", "timestamp": 1698244992, "time_this_iter_s": 2.024001121520996, "time_total_s": 4.104998826980591, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 4.104998826980591, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 63.46666666666666, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000002, "cur_lr": 0.0003, "total_loss": 8.797286097208659, "policy_loss": -0.0019899378220240276, "vf_loss": 8.79917418162028, "vf_explained_var": -2.137422561645508e-05, "kl": 0.0034642445349239398, "entropy": 0.7129889766375224, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 45.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -20.347126436781917, "episode_len_mean": 399.264367816092, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, -50.00000000000044, 34.50000000000004, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.699999999999925, 19.09999999999983, -50.00000000000044, 40.70000000000002, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 3.699999999999612, 21.09999999999986, 17.299999999999805, 18.29999999999982, 21.299999999999862, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 15.699999999999783, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 16.09999999999979, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.1, 38.300000000000026, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.699999999999783, 26.89999999999994, -50.00000000000044, 34.30000000000004, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 7.899999999999672, 40.90000000000002, -50.00000000000044, 42.500000000000014, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.8999999999995865], "episode_lengths": [500, 500, 500, 500, 304, 500, 500, 500, 500, 500, 500, 474, 500, 156, 238, 500, 500, 500, 500, 500, 500, 244, 310, 500, 94, 500, 194, 500, 500, 464, 290, 328, 318, 288, 500, 176, 500, 500, 500, 110, 500, 344, 236, 500, 500, 500, 198, 500, 500, 500, 500, 500, 500, 500, 178, 340, 142, 500, 500, 50, 118, 198, 500, 500, 500, 344, 232, 500, 158, 384, 500, 500, 500, 500, 500, 156, 500, 500, 422, 92, 500, 76, 98, 500, 500, 500, 482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3914527852479378, "mean_inference_ms": 1.2308678186155986, "mean_action_processing_ms": 0.14557134798010501, "mean_env_wait_ms": 0.08548902231155567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031037440245178925, "StateBufferConnector_ms": 0.00919336560128749, "ViewRequirementAgentConnector_ms": 0.14478584815715922}}, "episode_reward_max": 45.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -20.347126436781917, "episode_len_mean": 399.264367816092, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, -50.00000000000044, 34.50000000000004, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.699999999999925, 19.09999999999983, -50.00000000000044, 40.70000000000002, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 3.699999999999612, 21.09999999999986, 17.299999999999805, 18.29999999999982, 21.299999999999862, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 15.699999999999783, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 16.09999999999979, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.1, 38.300000000000026, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.699999999999783, 26.89999999999994, -50.00000000000044, 34.30000000000004, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 7.899999999999672, 40.90000000000002, -50.00000000000044, 42.500000000000014, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.8999999999995865], "episode_lengths": [500, 500, 500, 500, 304, 500, 500, 500, 500, 500, 500, 474, 500, 156, 238, 500, 500, 500, 500, 500, 500, 244, 310, 500, 94, 500, 194, 500, 500, 464, 290, 328, 318, 288, 500, 176, 500, 500, 500, 110, 500, 344, 236, 500, 500, 500, 198, 500, 500, 500, 500, 500, 500, 500, 178, 340, 142, 500, 500, 50, 118, 198, 500, 500, 500, 344, 232, 500, 158, 384, 500, 500, 500, 500, 500, 156, 500, 500, 422, 92, 500, 76, 98, 500, 500, 500, 482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3914527852479378, "mean_inference_ms": 1.2308678186155986, "mean_action_processing_ms": 0.14557134798010501, "mean_env_wait_ms": 0.08548902231155567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031037440245178925, "StateBufferConnector_ms": 0.00919336560128749, "ViewRequirementAgentConnector_ms": 0.14478584815715922}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5504.580967241215, "num_env_steps_trained_throughput_per_sec": 5504.580967241215, "timesteps_total": 36000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 2092.001, "sample_time_ms": 1930.999, "load_time_ms": 7.333, "load_throughput": 1636340.37, "learn_time_ms": 142.334, "learn_throughput": 84308.983, "synch_weights_time_ms": 10.008}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 87, "training_iteration": 3, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-14", "timestamp": 1698244994, "time_this_iter_s": 2.185000419616699, "time_total_s": 6.28999924659729, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.28999924659729, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 63.93333333333334, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.02500000000000001, "cur_lr": 0.0003, "total_loss": 9.080248260498047, "policy_loss": -0.0010948901375134785, "vf_loss": 9.081361007690429, "vf_explained_var": -2.7982393900553384e-05, "kl": 0.001986862576063686, "entropy": 0.6744396328926087, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 45.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.763000000000227, "episode_len_mean": 333.2, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 3.699999999999612, 21.09999999999986, 17.299999999999805, 18.29999999999982, 21.299999999999862, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 15.699999999999783, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 16.09999999999979, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.1, 38.300000000000026, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.699999999999783, 26.89999999999994, -50.00000000000044, 34.30000000000004, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 7.899999999999672, 40.90000000000002, -50.00000000000044, 42.500000000000014, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 30.499999999999993, 32.100000000000016, 38.10000000000002, 11.899999999999729, 39.300000000000026, 29.899999999999984, 40.500000000000014, 37.70000000000003, -50.00000000000044, -50.00000000000044, 13.899999999999757, 17.099999999999802, -50.00000000000044, 36.10000000000004, 10.099999999999703, 39.70000000000002, 34.70000000000004, 44.10000000000001, -50.00000000000044, 40.70000000000002, 11.29999999999972, 34.10000000000004, 39.50000000000002, 26.09999999999993, -50.00000000000044, 34.70000000000004, 33.500000000000036, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.900000000000006, 42.900000000000006, -50.00000000000044, 27.899999999999956, -50.00000000000044, 25.899999999999928, 41.70000000000002, 25.499999999999922, 36.30000000000003, 33.10000000000003], "episode_lengths": [500, 464, 290, 328, 318, 288, 500, 176, 500, 500, 500, 110, 500, 344, 236, 500, 500, 500, 198, 500, 500, 500, 500, 500, 500, 500, 178, 340, 142, 500, 500, 50, 118, 198, 500, 500, 500, 344, 232, 500, 158, 384, 500, 500, 500, 500, 500, 156, 500, 500, 422, 92, 500, 76, 98, 500, 500, 500, 482, 500, 196, 180, 120, 382, 108, 202, 96, 124, 500, 500, 362, 330, 500, 140, 400, 104, 154, 60, 500, 94, 388, 160, 106, 240, 500, 154, 166, 500, 500, 96, 62, 72, 500, 222, 500, 242, 84, 246, 138, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39049536265827867, "mean_inference_ms": 1.2303877031103791, "mean_action_processing_ms": 0.1449228996414406, "mean_env_wait_ms": 0.08530249005282943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279996395111084, "StateBufferConnector_ms": 0.007002592086791992, "ViewRequirementAgentConnector_ms": 0.11897873878479004}}, "episode_reward_max": 45.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.763000000000227, "episode_len_mean": 333.2, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 3.699999999999612, 21.09999999999986, 17.299999999999805, 18.29999999999982, 21.299999999999862, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 15.699999999999783, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 16.09999999999979, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.1, 38.300000000000026, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.699999999999783, 26.89999999999994, -50.00000000000044, 34.30000000000004, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 7.899999999999672, 40.90000000000002, -50.00000000000044, 42.500000000000014, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 30.499999999999993, 32.100000000000016, 38.10000000000002, 11.899999999999729, 39.300000000000026, 29.899999999999984, 40.500000000000014, 37.70000000000003, -50.00000000000044, -50.00000000000044, 13.899999999999757, 17.099999999999802, -50.00000000000044, 36.10000000000004, 10.099999999999703, 39.70000000000002, 34.70000000000004, 44.10000000000001, -50.00000000000044, 40.70000000000002, 11.29999999999972, 34.10000000000004, 39.50000000000002, 26.09999999999993, -50.00000000000044, 34.70000000000004, 33.500000000000036, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.900000000000006, 42.900000000000006, -50.00000000000044, 27.899999999999956, -50.00000000000044, 25.899999999999928, 41.70000000000002, 25.499999999999922, 36.30000000000003, 33.10000000000003], "episode_lengths": [500, 464, 290, 328, 318, 288, 500, 176, 500, 500, 500, 110, 500, 344, 236, 500, 500, 500, 198, 500, 500, 500, 500, 500, 500, 500, 178, 340, 142, 500, 500, 50, 118, 198, 500, 500, 500, 344, 232, 500, 158, 384, 500, 500, 500, 500, 500, 156, 500, 500, 422, 92, 500, 76, 98, 500, 500, 500, 482, 500, 196, 180, 120, 382, 108, 202, 96, 124, 500, 500, 362, 330, 500, 140, 400, 104, 154, 60, 500, 94, 388, 160, 106, 240, 500, 154, 166, 500, 500, 96, 62, 72, 500, 222, 500, 242, 84, 246, 138, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39049536265827867, "mean_inference_ms": 1.2303877031103791, "mean_action_processing_ms": 0.1449228996414406, "mean_env_wait_ms": 0.08530249005282943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279996395111084, "StateBufferConnector_ms": 0.007002592086791992, "ViewRequirementAgentConnector_ms": 0.11897873878479004}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4479.282683231193, "num_env_steps_trained_throughput_per_sec": 4479.282683231193, "timesteps_total": 48000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 2238.751, "sample_time_ms": 2028.75, "load_time_ms": 8.5, "load_throughput": 1411748.233, "learn_time_ms": 190.25, "learn_throughput": 63074.77, "synch_weights_time_ms": 10.256}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 128, "training_iteration": 4, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-17", "timestamp": 1698244997, "time_this_iter_s": 2.6850013732910156, "time_total_s": 8.975000619888306, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 8.975000619888306, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 59.075, "ram_util_percent": 26.825000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000004, "cur_lr": 0.0003, "total_loss": 8.954350725809734, "policy_loss": -0.00047661960124969485, "vf_loss": 8.954881604512533, "vf_explained_var": 2.2490819295247396e-06, "kl": 0.000307337852927958, "entropy": 0.5801360646883646, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.034999999999854, "episode_len_mean": 255.4, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 30.499999999999993, 32.100000000000016, 38.10000000000002, 11.899999999999729, 39.300000000000026, 29.899999999999984, 40.500000000000014, 37.70000000000003, -50.00000000000044, -50.00000000000044, 13.899999999999757, 17.099999999999802, -50.00000000000044, 36.10000000000004, 10.099999999999703, 39.70000000000002, 34.70000000000004, 44.10000000000001, -50.00000000000044, 40.70000000000002, 11.29999999999972, 34.10000000000004, 39.50000000000002, 26.09999999999993, -50.00000000000044, 34.70000000000004, 33.500000000000036, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.900000000000006, 42.900000000000006, -50.00000000000044, 27.899999999999956, -50.00000000000044, 25.899999999999928, 41.70000000000002, 25.499999999999922, 36.30000000000003, 33.10000000000003, -50.00000000000044, 13.899999999999757, 35.900000000000034, 41.30000000000001, 26.299999999999933, 45.7, 45.5, 40.500000000000014, -50.00000000000044, 12.299999999999734, 29.69999999999998, -50.00000000000044, 43.900000000000006, 30.9, 21.09999999999986, 43.7, 29.49999999999998, 40.30000000000002, 47.1, 37.50000000000003, 21.299999999999862, -50.00000000000044, 25.099999999999916, 43.900000000000006, 22.899999999999885, 2.499999999999595, 38.90000000000002, 39.70000000000002, 43.10000000000001, 42.900000000000006, 36.50000000000003, -50.00000000000044, 43.10000000000001, 37.70000000000003, 24.299999999999905, -50.00000000000044, 1.299999999999578, 12.099999999999731, -50.00000000000044, 26.499999999999936, 38.50000000000003, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.3, 39.70000000000002, 45.3, 40.90000000000002, -50.00000000000044, 44.10000000000001, 34.70000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001], "episode_lengths": [98, 500, 500, 500, 482, 500, 196, 180, 120, 382, 108, 202, 96, 124, 500, 500, 362, 330, 500, 140, 400, 104, 154, 60, 500, 94, 388, 160, 106, 240, 500, 154, 166, 500, 500, 96, 62, 72, 500, 222, 500, 242, 84, 246, 138, 170, 500, 362, 142, 88, 238, 44, 46, 96, 500, 378, 204, 500, 62, 192, 290, 64, 206, 98, 30, 126, 288, 500, 250, 62, 272, 476, 112, 104, 70, 72, 136, 500, 70, 124, 258, 500, 488, 380, 500, 236, 116, 500, 500, 88, 48, 104, 48, 92, 500, 60, 154, 500, 500, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3939344823151501, "mean_inference_ms": 1.245657325537485, "mean_action_processing_ms": 0.14671006810008724, "mean_env_wait_ms": 0.08650669222770885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022994518280029297, "StateBufferConnector_ms": 0.0050046443939208984, "ViewRequirementAgentConnector_ms": 0.11898255348205566}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.034999999999854, "episode_len_mean": 255.4, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 30.499999999999993, 32.100000000000016, 38.10000000000002, 11.899999999999729, 39.300000000000026, 29.899999999999984, 40.500000000000014, 37.70000000000003, -50.00000000000044, -50.00000000000044, 13.899999999999757, 17.099999999999802, -50.00000000000044, 36.10000000000004, 10.099999999999703, 39.70000000000002, 34.70000000000004, 44.10000000000001, -50.00000000000044, 40.70000000000002, 11.29999999999972, 34.10000000000004, 39.50000000000002, 26.09999999999993, -50.00000000000044, 34.70000000000004, 33.500000000000036, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.900000000000006, 42.900000000000006, -50.00000000000044, 27.899999999999956, -50.00000000000044, 25.899999999999928, 41.70000000000002, 25.499999999999922, 36.30000000000003, 33.10000000000003, -50.00000000000044, 13.899999999999757, 35.900000000000034, 41.30000000000001, 26.299999999999933, 45.7, 45.5, 40.500000000000014, -50.00000000000044, 12.299999999999734, 29.69999999999998, -50.00000000000044, 43.900000000000006, 30.9, 21.09999999999986, 43.7, 29.49999999999998, 40.30000000000002, 47.1, 37.50000000000003, 21.299999999999862, -50.00000000000044, 25.099999999999916, 43.900000000000006, 22.899999999999885, 2.499999999999595, 38.90000000000002, 39.70000000000002, 43.10000000000001, 42.900000000000006, 36.50000000000003, -50.00000000000044, 43.10000000000001, 37.70000000000003, 24.299999999999905, -50.00000000000044, 1.299999999999578, 12.099999999999731, -50.00000000000044, 26.499999999999936, 38.50000000000003, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.3, 39.70000000000002, 45.3, 40.90000000000002, -50.00000000000044, 44.10000000000001, 34.70000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001], "episode_lengths": [98, 500, 500, 500, 482, 500, 196, 180, 120, 382, 108, 202, 96, 124, 500, 500, 362, 330, 500, 140, 400, 104, 154, 60, 500, 94, 388, 160, 106, 240, 500, 154, 166, 500, 500, 96, 62, 72, 500, 222, 500, 242, 84, 246, 138, 170, 500, 362, 142, 88, 238, 44, 46, 96, 500, 378, 204, 500, 62, 192, 290, 64, 206, 98, 30, 126, 288, 500, 250, 62, 272, 476, 112, 104, 70, 72, 136, 500, 70, 124, 258, 500, 488, 380, 500, 236, 116, 500, 500, 88, 48, 104, 48, 92, 500, 60, 154, 500, 500, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3939344823151501, "mean_inference_ms": 1.245657325537485, "mean_action_processing_ms": 0.14671006810008724, "mean_env_wait_ms": 0.08650669222770885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022994518280029297, "StateBufferConnector_ms": 0.0050046443939208984, "ViewRequirementAgentConnector_ms": 0.11898255348205566}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5457.026214335604, "num_env_steps_trained_throughput_per_sec": 5457.026214335604, "timesteps_total": 60000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 2230.801, "sample_time_ms": 2032.8, "load_time_ms": 7.8, "load_throughput": 1538450.779, "learn_time_ms": 179.2, "learn_throughput": 66964.221, "synch_weights_time_ms": 10.004}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 182, "training_iteration": 5, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-19", "timestamp": 1698244999, "time_this_iter_s": 2.2039999961853027, "time_total_s": 11.179000616073608, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 11.179000616073608, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 57.333333333333336, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000002, "cur_lr": 0.0003, "total_loss": 8.77605381011963, "policy_loss": 0.00010115827123324077, "vf_loss": 8.77601235707601, "vf_explained_var": 5.439917246500651e-06, "kl": 9.616246096205335e-05, "entropy": 0.6041879614194234, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.499999999999854, "episode_len_mean": 245.74, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.10000000000003, -50.00000000000044, 13.899999999999757, 35.900000000000034, 41.30000000000001, 26.299999999999933, 45.7, 45.5, 40.500000000000014, -50.00000000000044, 12.299999999999734, 29.69999999999998, -50.00000000000044, 43.900000000000006, 30.9, 21.09999999999986, 43.7, 29.49999999999998, 40.30000000000002, 47.1, 37.50000000000003, 21.299999999999862, -50.00000000000044, 25.099999999999916, 43.900000000000006, 22.899999999999885, 2.499999999999595, 38.90000000000002, 39.70000000000002, 43.10000000000001, 42.900000000000006, 36.50000000000003, -50.00000000000044, 43.10000000000001, 37.70000000000003, 24.299999999999905, -50.00000000000044, 1.299999999999578, 12.099999999999731, -50.00000000000044, 26.499999999999936, 38.50000000000003, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.3, 39.70000000000002, 45.3, 40.90000000000002, -50.00000000000044, 44.10000000000001, 34.70000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 37.50000000000003, -50.00000000000044, 46.5, 5.299999999999635, -50.00000000000044, 10.299999999999706, -50.00000000000044, 19.899999999999842, 41.30000000000001, 42.30000000000001, 45.1, 39.10000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 26.09999999999993, 36.30000000000003, 35.500000000000036, 43.900000000000006, 30.099999999999987, 24.499999999999908, 41.90000000000001, 46.699999999999996, -50.00000000000044, 42.500000000000014, 38.50000000000003, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 12.099999999999731, 44.10000000000001, 36.30000000000003, 43.50000000000001, 25.29999999999992, -50.00000000000044, 41.100000000000016, 44.900000000000006, 37.90000000000003], "episode_lengths": [170, 500, 362, 142, 88, 238, 44, 46, 96, 500, 378, 204, 500, 62, 192, 290, 64, 206, 98, 30, 126, 288, 500, 250, 62, 272, 476, 112, 104, 70, 72, 136, 500, 70, 124, 258, 500, 488, 380, 500, 236, 116, 500, 500, 88, 48, 104, 48, 92, 500, 60, 154, 500, 500, 88, 500, 500, 106, 500, 126, 500, 36, 448, 500, 398, 500, 302, 88, 78, 50, 110, 500, 60, 500, 240, 138, 146, 62, 200, 256, 82, 34, 500, 76, 116, 500, 188, 500, 500, 500, 46, 380, 60, 138, 66, 248, 500, 90, 52, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3958692730671372, "mean_inference_ms": 1.2512335465102868, "mean_action_processing_ms": 0.147010711494659, "mean_env_wait_ms": 0.08638611084850552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799844741821289, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.13599181175231934}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.499999999999854, "episode_len_mean": 245.74, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.10000000000003, -50.00000000000044, 13.899999999999757, 35.900000000000034, 41.30000000000001, 26.299999999999933, 45.7, 45.5, 40.500000000000014, -50.00000000000044, 12.299999999999734, 29.69999999999998, -50.00000000000044, 43.900000000000006, 30.9, 21.09999999999986, 43.7, 29.49999999999998, 40.30000000000002, 47.1, 37.50000000000003, 21.299999999999862, -50.00000000000044, 25.099999999999916, 43.900000000000006, 22.899999999999885, 2.499999999999595, 38.90000000000002, 39.70000000000002, 43.10000000000001, 42.900000000000006, 36.50000000000003, -50.00000000000044, 43.10000000000001, 37.70000000000003, 24.299999999999905, -50.00000000000044, 1.299999999999578, 12.099999999999731, -50.00000000000044, 26.499999999999936, 38.50000000000003, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.3, 39.70000000000002, 45.3, 40.90000000000002, -50.00000000000044, 44.10000000000001, 34.70000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 37.50000000000003, -50.00000000000044, 46.5, 5.299999999999635, -50.00000000000044, 10.299999999999706, -50.00000000000044, 19.899999999999842, 41.30000000000001, 42.30000000000001, 45.1, 39.10000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 26.09999999999993, 36.30000000000003, 35.500000000000036, 43.900000000000006, 30.099999999999987, 24.499999999999908, 41.90000000000001, 46.699999999999996, -50.00000000000044, 42.500000000000014, 38.50000000000003, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 12.099999999999731, 44.10000000000001, 36.30000000000003, 43.50000000000001, 25.29999999999992, -50.00000000000044, 41.100000000000016, 44.900000000000006, 37.90000000000003], "episode_lengths": [170, 500, 362, 142, 88, 238, 44, 46, 96, 500, 378, 204, 500, 62, 192, 290, 64, 206, 98, 30, 126, 288, 500, 250, 62, 272, 476, 112, 104, 70, 72, 136, 500, 70, 124, 258, 500, 488, 380, 500, 236, 116, 500, 500, 88, 48, 104, 48, 92, 500, 60, 154, 500, 500, 88, 500, 500, 106, 500, 126, 500, 36, 448, 500, 398, 500, 302, 88, 78, 50, 110, 500, 60, 500, 240, 138, 146, 62, 200, 256, 82, 34, 500, 76, 116, 500, 188, 500, 500, 500, 46, 380, 60, 138, 66, 248, 500, 90, 52, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3958692730671372, "mean_inference_ms": 1.2512335465102868, "mean_action_processing_ms": 0.147010711494659, "mean_env_wait_ms": 0.08638611084850552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799844741821289, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.13599181175231934}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5349.970811566018, "num_env_steps_trained_throughput_per_sec": 5349.970811566018, "timesteps_total": 72000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 2232.834, "sample_time_ms": 2020.333, "load_time_ms": 8.167, "load_throughput": 1469401.311, "learn_time_ms": 193.333, "learn_throughput": 62068.923, "synch_weights_time_ms": 10.004}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 227, "training_iteration": 6, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-21", "timestamp": 1698245001, "time_this_iter_s": 2.2479991912841797, "time_total_s": 13.426999807357788, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 13.426999807357788, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 62.6, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003125000000000001, "cur_lr": 0.0003, "total_loss": 8.850627772013347, "policy_loss": -0.0002853801536427151, "vf_loss": 8.850972366333007, "vf_explained_var": -1.2000401814778646e-06, "kl": 0.00011579544485679586, "entropy": 0.5939882596333822, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.577999999999863, "episode_len_mean": 234.96, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.50000000000002, -50.00000000000044, 37.50000000000003, -50.00000000000044, 46.5, 5.299999999999635, -50.00000000000044, 10.299999999999706, -50.00000000000044, 19.899999999999842, 41.30000000000001, 42.30000000000001, 45.1, 39.10000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 26.09999999999993, 36.30000000000003, 35.500000000000036, 43.900000000000006, 30.099999999999987, 24.499999999999908, 41.90000000000001, 46.699999999999996, -50.00000000000044, 42.500000000000014, 38.50000000000003, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 12.099999999999731, 44.10000000000001, 36.30000000000003, 43.50000000000001, 25.29999999999992, -50.00000000000044, 41.100000000000016, 44.900000000000006, 37.90000000000003, -50.00000000000044, -50.00000000000044, 26.499999999999936, 26.299999999999933, 19.299999999999834, 46.9, 40.30000000000002, 39.300000000000026, 8.299999999999677, 44.5, 39.70000000000002, 35.30000000000004, 40.500000000000014, 5.099999999999632, 38.700000000000024, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.10000000000001, 45.5, 38.10000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.7, 39.50000000000002, 41.30000000000001, 2.699999999999598, 40.30000000000002, 46.699999999999996, 28.499999999999964, 28.29999999999996, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 25.29999999999992, 45.7, 29.49999999999998, -50.00000000000044, 34.70000000000004, 47.1, 40.500000000000014, 42.500000000000014, -50.00000000000044, 21.89999999999987, 38.90000000000002, 42.10000000000001, 44.5, -50.00000000000044, 41.70000000000002, 35.500000000000036], "episode_lengths": [500, 106, 500, 126, 500, 36, 448, 500, 398, 500, 302, 88, 78, 50, 110, 500, 60, 500, 240, 138, 146, 62, 200, 256, 82, 34, 500, 76, 116, 500, 188, 500, 500, 500, 46, 380, 60, 138, 66, 248, 500, 90, 52, 122, 500, 500, 236, 238, 308, 32, 98, 108, 418, 56, 104, 148, 96, 450, 114, 500, 500, 96, 70, 46, 120, 500, 68, 500, 64, 106, 88, 474, 98, 34, 216, 218, 86, 500, 500, 42, 60, 500, 48, 500, 248, 44, 206, 500, 154, 30, 96, 76, 500, 282, 112, 80, 56, 500, 84, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3955468889669269, "mean_inference_ms": 1.247534443190629, "mean_action_processing_ms": 0.14603388729833583, "mean_env_wait_ms": 0.08466673900703514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000187873840332, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.128997802734375}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.577999999999863, "episode_len_mean": 234.96, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.50000000000002, -50.00000000000044, 37.50000000000003, -50.00000000000044, 46.5, 5.299999999999635, -50.00000000000044, 10.299999999999706, -50.00000000000044, 19.899999999999842, 41.30000000000001, 42.30000000000001, 45.1, 39.10000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 26.09999999999993, 36.30000000000003, 35.500000000000036, 43.900000000000006, 30.099999999999987, 24.499999999999908, 41.90000000000001, 46.699999999999996, -50.00000000000044, 42.500000000000014, 38.50000000000003, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 12.099999999999731, 44.10000000000001, 36.30000000000003, 43.50000000000001, 25.29999999999992, -50.00000000000044, 41.100000000000016, 44.900000000000006, 37.90000000000003, -50.00000000000044, -50.00000000000044, 26.499999999999936, 26.299999999999933, 19.299999999999834, 46.9, 40.30000000000002, 39.300000000000026, 8.299999999999677, 44.5, 39.70000000000002, 35.30000000000004, 40.500000000000014, 5.099999999999632, 38.700000000000024, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.10000000000001, 45.5, 38.10000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.7, 39.50000000000002, 41.30000000000001, 2.699999999999598, 40.30000000000002, 46.699999999999996, 28.499999999999964, 28.29999999999996, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 25.29999999999992, 45.7, 29.49999999999998, -50.00000000000044, 34.70000000000004, 47.1, 40.500000000000014, 42.500000000000014, -50.00000000000044, 21.89999999999987, 38.90000000000002, 42.10000000000001, 44.5, -50.00000000000044, 41.70000000000002, 35.500000000000036], "episode_lengths": [500, 106, 500, 126, 500, 36, 448, 500, 398, 500, 302, 88, 78, 50, 110, 500, 60, 500, 240, 138, 146, 62, 200, 256, 82, 34, 500, 76, 116, 500, 188, 500, 500, 500, 46, 380, 60, 138, 66, 248, 500, 90, 52, 122, 500, 500, 236, 238, 308, 32, 98, 108, 418, 56, 104, 148, 96, 450, 114, 500, 500, 96, 70, 46, 120, 500, 68, 500, 64, 106, 88, 474, 98, 34, 216, 218, 86, 500, 500, 42, 60, 500, 48, 500, 248, 44, 206, 500, 154, 30, 96, 76, 500, 282, 112, 80, 56, 500, 84, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3955468889669269, "mean_inference_ms": 1.247534443190629, "mean_action_processing_ms": 0.14603388729833583, "mean_env_wait_ms": 0.08466673900703514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000187873840332, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.128997802734375}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5295.672894060444, "num_env_steps_trained_throughput_per_sec": 5295.672894060444, "timesteps_total": 84000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 2237.572, "sample_time_ms": 2007.0, "load_time_ms": 9.0, "load_throughput": 1333364.376, "learn_time_ms": 210.714, "learn_throughput": 56949.119, "synch_weights_time_ms": 9.861}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 283, "training_iteration": 7, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-23", "timestamp": 1698245003, "time_this_iter_s": 2.2720000743865967, "time_total_s": 15.698999881744385, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 15.698999881744385, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 56.0, "ram_util_percent": 26.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000005, "cur_lr": 0.0003, "total_loss": 8.761876742045084, "policy_loss": -0.0005017528931299845, "vf_loss": 8.762437693277995, "vf_explained_var": -3.143151601155599e-06, "kl": 0.000600835519416402, "entropy": 0.5999238928159077, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.60899999999988, "episode_len_mean": 219.68, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, 40.30000000000002, 39.300000000000026, 8.299999999999677, 44.5, 39.70000000000002, 35.30000000000004, 40.500000000000014, 5.099999999999632, 38.700000000000024, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.10000000000001, 45.5, 38.10000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.7, 39.50000000000002, 41.30000000000001, 2.699999999999598, 40.30000000000002, 46.699999999999996, 28.499999999999964, 28.29999999999996, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 25.29999999999992, 45.7, 29.49999999999998, -50.00000000000044, 34.70000000000004, 47.1, 40.500000000000014, 42.500000000000014, -50.00000000000044, 21.89999999999987, 38.90000000000002, 42.10000000000001, 44.5, -50.00000000000044, 41.70000000000002, 35.500000000000036, 34.50000000000004, 39.90000000000002, 43.900000000000006, 46.3, -50.00000000000044, 39.300000000000026, 5.299999999999635, 15.099999999999774, 31.900000000000013, 38.50000000000003, 41.70000000000002, 25.499999999999922, 28.499999999999964, 46.5, 18.099999999999817, 34.900000000000034, 28.699999999999967, -50.00000000000044, 38.10000000000002, 25.499999999999922, 20.299999999999848, -50.00000000000044, 32.30000000000002, 44.5, -50.00000000000044, 46.3, 30.699999999999996, -50.00000000000044, 37.50000000000003, 33.90000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.30000000000002, 41.100000000000016, -50.00000000000044, 39.70000000000002, 40.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 39.300000000000026, 35.10000000000004, 45.5, 43.30000000000001], "episode_lengths": [32, 98, 108, 418, 56, 104, 148, 96, 450, 114, 500, 500, 96, 70, 46, 120, 500, 68, 500, 64, 106, 88, 474, 98, 34, 216, 218, 86, 500, 500, 42, 60, 500, 48, 500, 248, 44, 206, 500, 154, 30, 96, 76, 500, 282, 112, 80, 56, 500, 84, 146, 156, 102, 62, 38, 500, 108, 448, 350, 182, 116, 84, 246, 216, 36, 320, 152, 214, 500, 120, 246, 298, 500, 178, 56, 500, 38, 194, 500, 126, 162, 500, 500, 96, 98, 90, 500, 104, 94, 90, 500, 500, 62, 42, 500, 500, 108, 150, 46, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39607601442849005, "mean_inference_ms": 1.2448344337618054, "mean_action_processing_ms": 0.14662654374578, "mean_env_wait_ms": 0.084873430200978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799844741821289, "StateBufferConnector_ms": 0.007002353668212891, "ViewRequirementAgentConnector_ms": 0.13402891159057617}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.60899999999988, "episode_len_mean": 219.68, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, 40.30000000000002, 39.300000000000026, 8.299999999999677, 44.5, 39.70000000000002, 35.30000000000004, 40.500000000000014, 5.099999999999632, 38.700000000000024, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.10000000000001, 45.5, 38.10000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.7, 39.50000000000002, 41.30000000000001, 2.699999999999598, 40.30000000000002, 46.699999999999996, 28.499999999999964, 28.29999999999996, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 25.29999999999992, 45.7, 29.49999999999998, -50.00000000000044, 34.70000000000004, 47.1, 40.500000000000014, 42.500000000000014, -50.00000000000044, 21.89999999999987, 38.90000000000002, 42.10000000000001, 44.5, -50.00000000000044, 41.70000000000002, 35.500000000000036, 34.50000000000004, 39.90000000000002, 43.900000000000006, 46.3, -50.00000000000044, 39.300000000000026, 5.299999999999635, 15.099999999999774, 31.900000000000013, 38.50000000000003, 41.70000000000002, 25.499999999999922, 28.499999999999964, 46.5, 18.099999999999817, 34.900000000000034, 28.699999999999967, -50.00000000000044, 38.10000000000002, 25.499999999999922, 20.299999999999848, -50.00000000000044, 32.30000000000002, 44.5, -50.00000000000044, 46.3, 30.699999999999996, -50.00000000000044, 37.50000000000003, 33.90000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.30000000000002, 41.100000000000016, -50.00000000000044, 39.70000000000002, 40.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 39.300000000000026, 35.10000000000004, 45.5, 43.30000000000001], "episode_lengths": [32, 98, 108, 418, 56, 104, 148, 96, 450, 114, 500, 500, 96, 70, 46, 120, 500, 68, 500, 64, 106, 88, 474, 98, 34, 216, 218, 86, 500, 500, 42, 60, 500, 48, 500, 248, 44, 206, 500, 154, 30, 96, 76, 500, 282, 112, 80, 56, 500, 84, 146, 156, 102, 62, 38, 500, 108, 448, 350, 182, 116, 84, 246, 216, 36, 320, 152, 214, 500, 120, 246, 298, 500, 178, 56, 500, 38, 194, 500, 126, 162, 500, 500, 96, 98, 90, 500, 104, 94, 90, 500, 500, 62, 42, 500, 500, 108, 150, 46, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39607601442849005, "mean_inference_ms": 1.2448344337618054, "mean_action_processing_ms": 0.14662654374578, "mean_env_wait_ms": 0.084873430200978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799844741821289, "StateBufferConnector_ms": 0.007002353668212891, "ViewRequirementAgentConnector_ms": 0.13402891159057617}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5454.540607362121, "num_env_steps_trained_throughput_per_sec": 5454.540607362121, "timesteps_total": 96000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 2232.876, "sample_time_ms": 2004.375, "load_time_ms": 9.125, "load_throughput": 1315086.498, "learn_time_ms": 208.629, "learn_throughput": 57518.441, "synch_weights_time_ms": 9.749}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 332, "training_iteration": 8, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-26", "timestamp": 1698245006, "time_this_iter_s": 2.205002784729004, "time_total_s": 17.90400266647339, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 17.90400266647339, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 64.7, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000003, "cur_lr": 0.0003, "total_loss": 8.33054002126058, "policy_loss": 4.5326352119445803e-05, "vf_loss": 8.330551465352377, "vf_explained_var": -3.6795934041341146e-06, "kl": 0.000282382460742762, "entropy": 0.5650848189989726, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 128.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.99699999999985, "episode_len_mean": 245.74, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.89999999999987, 38.90000000000002, 42.10000000000001, 44.5, -50.00000000000044, 41.70000000000002, 35.500000000000036, 34.50000000000004, 39.90000000000002, 43.900000000000006, 46.3, -50.00000000000044, 39.300000000000026, 5.299999999999635, 15.099999999999774, 31.900000000000013, 38.50000000000003, 41.70000000000002, 25.499999999999922, 28.499999999999964, 46.5, 18.099999999999817, 34.900000000000034, 28.699999999999967, -50.00000000000044, 38.10000000000002, 25.499999999999922, 20.299999999999848, -50.00000000000044, 32.30000000000002, 44.5, -50.00000000000044, 46.3, 30.699999999999996, -50.00000000000044, 37.50000000000003, 33.90000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.30000000000002, 41.100000000000016, -50.00000000000044, 39.70000000000002, 40.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 39.300000000000026, 35.10000000000004, 45.5, 43.30000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, 41.30000000000001, 35.70000000000003, -50.00000000000044, 6.499999999999652, 44.10000000000001, 6.699999999999655, -50.00000000000044, 34.10000000000004, 43.900000000000006, 35.70000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 35.70000000000003, 36.900000000000034, -50.00000000000044, 23.8999999999999, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.9, 46.3, 39.70000000000002, 3.899999999999615, 34.10000000000004, 46.099999999999994, -50.00000000000044, 46.5, 39.300000000000026, 44.10000000000001], "episode_lengths": [282, 112, 80, 56, 500, 84, 146, 156, 102, 62, 38, 500, 108, 448, 350, 182, 116, 84, 246, 216, 36, 320, 152, 214, 500, 120, 246, 298, 500, 178, 56, 500, 38, 194, 500, 126, 162, 500, 500, 96, 98, 90, 500, 104, 94, 90, 500, 500, 62, 42, 500, 500, 108, 150, 46, 68, 102, 500, 500, 500, 500, 66, 500, 70, 88, 144, 500, 436, 60, 434, 500, 160, 62, 144, 76, 500, 500, 500, 500, 416, 144, 132, 500, 262, 60, 48, 500, 500, 74, 500, 32, 38, 104, 462, 160, 40, 500, 36, 108, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39743899638162894, "mean_inference_ms": 1.2462447866000632, "mean_action_processing_ms": 0.14678831344772472, "mean_env_wait_ms": 0.08513166972910985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099989891052246, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.13407444953918457}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.99699999999985, "episode_len_mean": 245.74, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.89999999999987, 38.90000000000002, 42.10000000000001, 44.5, -50.00000000000044, 41.70000000000002, 35.500000000000036, 34.50000000000004, 39.90000000000002, 43.900000000000006, 46.3, -50.00000000000044, 39.300000000000026, 5.299999999999635, 15.099999999999774, 31.900000000000013, 38.50000000000003, 41.70000000000002, 25.499999999999922, 28.499999999999964, 46.5, 18.099999999999817, 34.900000000000034, 28.699999999999967, -50.00000000000044, 38.10000000000002, 25.499999999999922, 20.299999999999848, -50.00000000000044, 32.30000000000002, 44.5, -50.00000000000044, 46.3, 30.699999999999996, -50.00000000000044, 37.50000000000003, 33.90000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.30000000000002, 41.100000000000016, -50.00000000000044, 39.70000000000002, 40.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 39.300000000000026, 35.10000000000004, 45.5, 43.30000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, 41.30000000000001, 35.70000000000003, -50.00000000000044, 6.499999999999652, 44.10000000000001, 6.699999999999655, -50.00000000000044, 34.10000000000004, 43.900000000000006, 35.70000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 35.70000000000003, 36.900000000000034, -50.00000000000044, 23.8999999999999, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.9, 46.3, 39.70000000000002, 3.899999999999615, 34.10000000000004, 46.099999999999994, -50.00000000000044, 46.5, 39.300000000000026, 44.10000000000001], "episode_lengths": [282, 112, 80, 56, 500, 84, 146, 156, 102, 62, 38, 500, 108, 448, 350, 182, 116, 84, 246, 216, 36, 320, 152, 214, 500, 120, 246, 298, 500, 178, 56, 500, 38, 194, 500, 126, 162, 500, 500, 96, 98, 90, 500, 104, 94, 90, 500, 500, 62, 42, 500, 500, 108, 150, 46, 68, 102, 500, 500, 500, 500, 66, 500, 70, 88, 144, 500, 436, 60, 434, 500, 160, 62, 144, 76, 500, 500, 500, 500, 416, 144, 132, 500, 262, 60, 48, 500, 500, 74, 500, 32, 38, 104, 462, 160, 40, 500, 36, 108, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39743899638162894, "mean_inference_ms": 1.2462447866000632, "mean_action_processing_ms": 0.14678831344772472, "mean_env_wait_ms": 0.08513166972910985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099989891052246, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.13407444953918457}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5097.706350330905, "num_env_steps_trained_throughput_per_sec": 5097.706350330905, "timesteps_total": 108000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 2246.334, "sample_time_ms": 2004.111, "load_time_ms": 9.555, "load_throughput": 1255835.344, "learn_time_ms": 222.003, "learn_throughput": 54053.237, "synch_weights_time_ms": 9.667}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 376, "training_iteration": 9, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-28", "timestamp": 1698245008, "time_this_iter_s": 2.3600003719329834, "time_total_s": 20.264003038406372, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 20.264003038406372, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 65.03333333333333, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00039062500000000013, "cur_lr": 0.0003, "total_loss": 8.026599820454916, "policy_loss": -3.082503875096639e-05, "vf_loss": 8.026684474945068, "vf_explained_var": -1.231829325358073e-06, "kl": 0.0001341581110845406, "entropy": 0.5394026120503743, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.823999999999812, "episode_len_mean": 272.38, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, 39.70000000000002, 40.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 39.300000000000026, 35.10000000000004, 45.5, 43.30000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, 41.30000000000001, 35.70000000000003, -50.00000000000044, 6.499999999999652, 44.10000000000001, 6.699999999999655, -50.00000000000044, 34.10000000000004, 43.900000000000006, 35.70000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 35.70000000000003, 36.900000000000034, -50.00000000000044, 23.8999999999999, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.9, 46.3, 39.70000000000002, 3.899999999999615, 34.10000000000004, 46.099999999999994, -50.00000000000044, 46.5, 39.300000000000026, 44.10000000000001, -50.00000000000044, 45.3, 46.3, 17.099999999999802, 8.49999999999968, 43.7, 41.500000000000014, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 27.899999999999956, -50.00000000000044, -50.00000000000044, 42.70000000000001, 41.500000000000014, 42.900000000000006, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 23.499999999999893, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 13.299999999999748, 43.50000000000001, 44.5, -50.00000000000044, 36.900000000000034, 16.8999999999998, 42.900000000000006], "episode_lengths": [90, 500, 104, 94, 90, 500, 500, 62, 42, 500, 500, 108, 150, 46, 68, 102, 500, 500, 500, 500, 66, 500, 70, 88, 144, 500, 436, 60, 434, 500, 160, 62, 144, 76, 500, 500, 500, 500, 416, 144, 132, 500, 262, 60, 48, 500, 500, 74, 500, 32, 38, 104, 462, 160, 40, 500, 36, 108, 60, 500, 48, 38, 330, 416, 64, 86, 500, 80, 500, 500, 500, 118, 222, 500, 500, 74, 86, 72, 500, 122, 500, 98, 500, 266, 500, 72, 500, 104, 500, 500, 500, 44, 500, 368, 66, 56, 500, 132, 332, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.396486292659851, "mean_inference_ms": 1.2452870826630729, "mean_action_processing_ms": 0.14733195554095593, "mean_env_wait_ms": 0.08518082187092137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032007455825805664, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.11506533622741699}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.823999999999812, "episode_len_mean": 272.38, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, 39.70000000000002, 40.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 39.300000000000026, 35.10000000000004, 45.5, 43.30000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, 41.30000000000001, 35.70000000000003, -50.00000000000044, 6.499999999999652, 44.10000000000001, 6.699999999999655, -50.00000000000044, 34.10000000000004, 43.900000000000006, 35.70000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 35.70000000000003, 36.900000000000034, -50.00000000000044, 23.8999999999999, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.9, 46.3, 39.70000000000002, 3.899999999999615, 34.10000000000004, 46.099999999999994, -50.00000000000044, 46.5, 39.300000000000026, 44.10000000000001, -50.00000000000044, 45.3, 46.3, 17.099999999999802, 8.49999999999968, 43.7, 41.500000000000014, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 27.899999999999956, -50.00000000000044, -50.00000000000044, 42.70000000000001, 41.500000000000014, 42.900000000000006, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 23.499999999999893, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 13.299999999999748, 43.50000000000001, 44.5, -50.00000000000044, 36.900000000000034, 16.8999999999998, 42.900000000000006], "episode_lengths": [90, 500, 104, 94, 90, 500, 500, 62, 42, 500, 500, 108, 150, 46, 68, 102, 500, 500, 500, 500, 66, 500, 70, 88, 144, 500, 436, 60, 434, 500, 160, 62, 144, 76, 500, 500, 500, 500, 416, 144, 132, 500, 262, 60, 48, 500, 500, 74, 500, 32, 38, 104, 462, 160, 40, 500, 36, 108, 60, 500, 48, 38, 330, 416, 64, 86, 500, 80, 500, 500, 500, 118, 222, 500, 500, 74, 86, 72, 500, 122, 500, 98, 500, 266, 500, 72, 500, 104, 500, 500, 500, 44, 500, 368, 66, 56, 500, 132, 332, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.396486292659851, "mean_inference_ms": 1.2452870826630729, "mean_action_processing_ms": 0.14733195554095593, "mean_env_wait_ms": 0.08518082187092137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032007455825805664, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.11506533622741699}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5937.648591190649, "num_env_steps_trained_throughput_per_sec": 5937.648591190649, "timesteps_total": 120000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 2223.801, "sample_time_ms": 1991.0, "load_time_ms": 9.2, "load_throughput": 1304395.043, "learn_time_ms": 213.003, "learn_throughput": 56337.224, "synch_weights_time_ms": 9.6}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 417, "training_iteration": 10, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-30", "timestamp": 1698245010, "time_this_iter_s": 2.0249993801116943, "time_total_s": 22.289002418518066, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 22.289002418518066, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 56.666666666666664, "ram_util_percent": 26.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000007, "cur_lr": 0.0003, "total_loss": 8.080048942565918, "policy_loss": -0.00026755680640538535, "vf_loss": 8.080373605092367, "vf_explained_var": -9.059906005859375e-07, "kl": 0.00023135805182429673, "entropy": 0.5726842959721883, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.773999999999853, "episode_len_mean": 242.96, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, 45.3, 46.3, 17.099999999999802, 8.49999999999968, 43.7, 41.500000000000014, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 27.899999999999956, -50.00000000000044, -50.00000000000044, 42.70000000000001, 41.500000000000014, 42.900000000000006, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 23.499999999999893, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 13.299999999999748, 43.50000000000001, 44.5, -50.00000000000044, 36.900000000000034, 16.8999999999998, 42.900000000000006, 46.5, -50.00000000000044, 40.10000000000002, 32.50000000000002, 35.30000000000004, -50.00000000000044, 44.7, 42.900000000000006, 40.90000000000002, 29.099999999999973, 43.50000000000001, 38.10000000000002, 43.30000000000001, 34.70000000000004, 46.099999999999994, 44.300000000000004, 47.1, 42.70000000000001, 42.900000000000006, 40.70000000000002, 40.90000000000002, 33.10000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 25.899999999999928, 40.500000000000014, 37.70000000000003, 31.70000000000001, 26.69999999999994, 28.499999999999964, 45.1, 15.699999999999783, 29.69999999999998, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 45.9, 33.70000000000004, -50.00000000000044, 45.5, 20.099999999999845, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.900000000000006, 25.499999999999922, -50.00000000000044, 37.50000000000003, -50.00000000000044, 25.099999999999916, 9.499999999999694, -50.00000000000044, 27.299999999999947, 46.3, 44.7], "episode_lengths": [60, 500, 48, 38, 330, 416, 64, 86, 500, 80, 500, 500, 500, 118, 222, 500, 500, 74, 86, 72, 500, 122, 500, 98, 500, 266, 500, 72, 500, 104, 500, 500, 500, 44, 500, 368, 66, 56, 500, 132, 332, 72, 36, 500, 100, 176, 148, 500, 54, 72, 92, 210, 66, 120, 68, 154, 40, 58, 30, 74, 72, 94, 92, 170, 102, 500, 500, 242, 96, 124, 184, 234, 216, 50, 344, 204, 52, 500, 500, 44, 42, 164, 500, 46, 300, 500, 500, 100, 500, 52, 246, 500, 126, 500, 250, 406, 500, 228, 38, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39393193152213585, "mean_inference_ms": 1.2429972362829629, "mean_action_processing_ms": 0.14667258386144372, "mean_env_wait_ms": 0.08537429683852124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025005340576171875, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.11002087593078613}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.773999999999853, "episode_len_mean": 242.96, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, 45.3, 46.3, 17.099999999999802, 8.49999999999968, 43.7, 41.500000000000014, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 27.899999999999956, -50.00000000000044, -50.00000000000044, 42.70000000000001, 41.500000000000014, 42.900000000000006, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 23.499999999999893, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 13.299999999999748, 43.50000000000001, 44.5, -50.00000000000044, 36.900000000000034, 16.8999999999998, 42.900000000000006, 46.5, -50.00000000000044, 40.10000000000002, 32.50000000000002, 35.30000000000004, -50.00000000000044, 44.7, 42.900000000000006, 40.90000000000002, 29.099999999999973, 43.50000000000001, 38.10000000000002, 43.30000000000001, 34.70000000000004, 46.099999999999994, 44.300000000000004, 47.1, 42.70000000000001, 42.900000000000006, 40.70000000000002, 40.90000000000002, 33.10000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 25.899999999999928, 40.500000000000014, 37.70000000000003, 31.70000000000001, 26.69999999999994, 28.499999999999964, 45.1, 15.699999999999783, 29.69999999999998, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 45.9, 33.70000000000004, -50.00000000000044, 45.5, 20.099999999999845, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.900000000000006, 25.499999999999922, -50.00000000000044, 37.50000000000003, -50.00000000000044, 25.099999999999916, 9.499999999999694, -50.00000000000044, 27.299999999999947, 46.3, 44.7], "episode_lengths": [60, 500, 48, 38, 330, 416, 64, 86, 500, 80, 500, 500, 500, 118, 222, 500, 500, 74, 86, 72, 500, 122, 500, 98, 500, 266, 500, 72, 500, 104, 500, 500, 500, 44, 500, 368, 66, 56, 500, 132, 332, 72, 36, 500, 100, 176, 148, 500, 54, 72, 92, 210, 66, 120, 68, 154, 40, 58, 30, 74, 72, 94, 92, 170, 102, 500, 500, 242, 96, 124, 184, 234, 216, 50, 344, 204, 52, 500, 500, 44, 42, 164, 500, 46, 300, 500, 500, 100, 500, 52, 246, 500, 126, 500, 250, 406, 500, 228, 38, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39393193152213585, "mean_inference_ms": 1.2429972362829629, "mean_action_processing_ms": 0.14667258386144372, "mean_env_wait_ms": 0.08537429683852124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025005340576171875, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.11002087593078613}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5221.930268504046, "num_env_steps_trained_throughput_per_sec": 5221.930268504046, "timesteps_total": 132000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 2245.901, "sample_time_ms": 1992.1, "load_time_ms": 10.0, "load_throughput": 1200055.506, "learn_time_ms": 233.503, "learn_throughput": 51391.159, "synch_weights_time_ms": 9.4}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 475, "training_iteration": 11, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-32", "timestamp": 1698245012, "time_this_iter_s": 2.30299973487854, "time_total_s": 24.592002153396606, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 24.592002153396606, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 62.96666666666667, "ram_util_percent": 26.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000003e-05, "cur_lr": 0.0003, "total_loss": 6.69077533086141, "policy_loss": 1.183946927388509e-05, "vf_loss": 6.690813891092936, "vf_explained_var": 4.3312708536783854e-07, "kl": 0.0003144888177378865, "entropy": 0.5051134288311004, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.890999999999858, "episode_len_mean": 236.8, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.50000000000002, 35.30000000000004, -50.00000000000044, 44.7, 42.900000000000006, 40.90000000000002, 29.099999999999973, 43.50000000000001, 38.10000000000002, 43.30000000000001, 34.70000000000004, 46.099999999999994, 44.300000000000004, 47.1, 42.70000000000001, 42.900000000000006, 40.70000000000002, 40.90000000000002, 33.10000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 25.899999999999928, 40.500000000000014, 37.70000000000003, 31.70000000000001, 26.69999999999994, 28.499999999999964, 45.1, 15.699999999999783, 29.69999999999998, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 45.9, 33.70000000000004, -50.00000000000044, 45.5, 20.099999999999845, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.900000000000006, 25.499999999999922, -50.00000000000044, 37.50000000000003, -50.00000000000044, 25.099999999999916, 9.499999999999694, -50.00000000000044, 27.299999999999947, 46.3, 44.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.5, 39.70000000000002, 38.300000000000026, 46.3, 4.499999999999623, -50.00000000000044, 42.30000000000001, 32.50000000000002, 45.7, -50.00000000000044, 30.499999999999993, 42.30000000000001, -50.00000000000044, 33.30000000000003, 21.299999999999862, 45.5, 46.099999999999994, 40.30000000000002, 18.899999999999828, -50.00000000000044, 40.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, 20.49999999999985, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.5, 41.100000000000016, -50.00000000000044], "episode_lengths": [176, 148, 500, 54, 72, 92, 210, 66, 120, 68, 154, 40, 58, 30, 74, 72, 94, 92, 170, 102, 500, 500, 242, 96, 124, 184, 234, 216, 50, 344, 204, 52, 500, 500, 44, 42, 164, 500, 46, 300, 500, 500, 100, 500, 52, 246, 500, 126, 500, 250, 406, 500, 228, 38, 54, 84, 500, 500, 500, 500, 52, 500, 56, 104, 118, 38, 456, 500, 78, 176, 44, 500, 196, 78, 500, 168, 288, 46, 40, 98, 312, 500, 92, 38, 500, 500, 72, 296, 80, 500, 500, 56, 72, 500, 162, 500, 500, 56, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39341344096903524, "mean_inference_ms": 1.2450019555410188, "mean_action_processing_ms": 0.14683949092454124, "mean_env_wait_ms": 0.08482824243721368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022004365921020508, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.10401368141174316}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.890999999999858, "episode_len_mean": 236.8, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.50000000000002, 35.30000000000004, -50.00000000000044, 44.7, 42.900000000000006, 40.90000000000002, 29.099999999999973, 43.50000000000001, 38.10000000000002, 43.30000000000001, 34.70000000000004, 46.099999999999994, 44.300000000000004, 47.1, 42.70000000000001, 42.900000000000006, 40.70000000000002, 40.90000000000002, 33.10000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 25.899999999999928, 40.500000000000014, 37.70000000000003, 31.70000000000001, 26.69999999999994, 28.499999999999964, 45.1, 15.699999999999783, 29.69999999999998, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 45.9, 33.70000000000004, -50.00000000000044, 45.5, 20.099999999999845, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.900000000000006, 25.499999999999922, -50.00000000000044, 37.50000000000003, -50.00000000000044, 25.099999999999916, 9.499999999999694, -50.00000000000044, 27.299999999999947, 46.3, 44.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.5, 39.70000000000002, 38.300000000000026, 46.3, 4.499999999999623, -50.00000000000044, 42.30000000000001, 32.50000000000002, 45.7, -50.00000000000044, 30.499999999999993, 42.30000000000001, -50.00000000000044, 33.30000000000003, 21.299999999999862, 45.5, 46.099999999999994, 40.30000000000002, 18.899999999999828, -50.00000000000044, 40.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, 20.49999999999985, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.5, 41.100000000000016, -50.00000000000044], "episode_lengths": [176, 148, 500, 54, 72, 92, 210, 66, 120, 68, 154, 40, 58, 30, 74, 72, 94, 92, 170, 102, 500, 500, 242, 96, 124, 184, 234, 216, 50, 344, 204, 52, 500, 500, 44, 42, 164, 500, 46, 300, 500, 500, 100, 500, 52, 246, 500, 126, 500, 250, 406, 500, 228, 38, 54, 84, 500, 500, 500, 500, 52, 500, 56, 104, 118, 38, 456, 500, 78, 176, 44, 500, 196, 78, 500, 168, 288, 46, 40, 98, 312, 500, 92, 38, 500, 500, 72, 296, 80, 500, 500, 56, 72, 500, 162, 500, 500, 56, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39341344096903524, "mean_inference_ms": 1.2450019555410188, "mean_action_processing_ms": 0.14683949092454124, "mean_env_wait_ms": 0.08482824243721368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022004365921020508, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.10401368141174316}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5555.557174447614, "num_env_steps_trained_throughput_per_sec": 5555.557174447614, "timesteps_total": 144000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 2260.001, "sample_time_ms": 1997.2, "load_time_ms": 10.1, "load_throughput": 1188176.882, "learn_time_ms": 242.303, "learn_throughput": 49524.741, "synch_weights_time_ms": 9.5}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 520, "training_iteration": 12, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-35", "timestamp": 1698245015, "time_this_iter_s": 2.1660008430480957, "time_total_s": 26.758002996444702, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 26.758002996444702, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 59.03333333333333, "ram_util_percent": 26.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.8828125000000016e-05, "cur_lr": 0.0003, "total_loss": 6.668038368225098, "policy_loss": -0.0003129462517487506, "vf_loss": 6.668407885233561, "vf_explained_var": -1.5099843343098958e-06, "kl": 0.00016911418172943133, "entropy": 0.5664908647537231, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 188.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8239999999998155, "episode_len_mean": 272.38, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.50000000000003, -50.00000000000044, 25.099999999999916, 9.499999999999694, -50.00000000000044, 27.299999999999947, 46.3, 44.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.5, 39.70000000000002, 38.300000000000026, 46.3, 4.499999999999623, -50.00000000000044, 42.30000000000001, 32.50000000000002, 45.7, -50.00000000000044, 30.499999999999993, 42.30000000000001, -50.00000000000044, 33.30000000000003, 21.299999999999862, 45.5, 46.099999999999994, 40.30000000000002, 18.899999999999828, -50.00000000000044, 40.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, 20.49999999999985, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 39.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 33.10000000000003, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 34.50000000000004, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 12.299999999999734, 45.1, 10.899999999999714, -50.00000000000044, 46.5, 38.700000000000024, 42.70000000000001, 18.099999999999817, -50.00000000000044, 41.70000000000002, 37.90000000000003, -50.00000000000044, 36.70000000000003, 44.900000000000006, 44.10000000000001, 42.900000000000006, -50.00000000000044, 41.500000000000014, 41.90000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978], "episode_lengths": [500, 126, 500, 250, 406, 500, 228, 38, 54, 84, 500, 500, 500, 500, 52, 500, 56, 104, 118, 38, 456, 500, 78, 176, 44, 500, 196, 78, 500, 168, 288, 46, 40, 98, 312, 500, 92, 38, 500, 500, 72, 296, 80, 500, 500, 56, 72, 500, 162, 500, 500, 56, 90, 500, 500, 40, 500, 108, 74, 500, 500, 206, 500, 170, 60, 38, 500, 500, 62, 156, 120, 500, 500, 500, 128, 378, 50, 392, 500, 36, 114, 74, 320, 500, 84, 122, 500, 134, 52, 60, 72, 500, 86, 82, 500, 126, 500, 500, 500, 346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3931719794955911, "mean_inference_ms": 1.2419379103992993, "mean_action_processing_ms": 0.14813767272976125, "mean_env_wait_ms": 0.08531848260267218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024998903274536133, "StateBufferConnector_ms": 0.006001472473144531, "ViewRequirementAgentConnector_ms": 0.1169888973236084}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8239999999998155, "episode_len_mean": 272.38, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.50000000000003, -50.00000000000044, 25.099999999999916, 9.499999999999694, -50.00000000000044, 27.299999999999947, 46.3, 44.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.5, 39.70000000000002, 38.300000000000026, 46.3, 4.499999999999623, -50.00000000000044, 42.30000000000001, 32.50000000000002, 45.7, -50.00000000000044, 30.499999999999993, 42.30000000000001, -50.00000000000044, 33.30000000000003, 21.299999999999862, 45.5, 46.099999999999994, 40.30000000000002, 18.899999999999828, -50.00000000000044, 40.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, 20.49999999999985, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 39.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 33.10000000000003, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 34.50000000000004, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 12.299999999999734, 45.1, 10.899999999999714, -50.00000000000044, 46.5, 38.700000000000024, 42.70000000000001, 18.099999999999817, -50.00000000000044, 41.70000000000002, 37.90000000000003, -50.00000000000044, 36.70000000000003, 44.900000000000006, 44.10000000000001, 42.900000000000006, -50.00000000000044, 41.500000000000014, 41.90000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978], "episode_lengths": [500, 126, 500, 250, 406, 500, 228, 38, 54, 84, 500, 500, 500, 500, 52, 500, 56, 104, 118, 38, 456, 500, 78, 176, 44, 500, 196, 78, 500, 168, 288, 46, 40, 98, 312, 500, 92, 38, 500, 500, 72, 296, 80, 500, 500, 56, 72, 500, 162, 500, 500, 56, 90, 500, 500, 40, 500, 108, 74, 500, 500, 206, 500, 170, 60, 38, 500, 500, 62, 156, 120, 500, 500, 500, 128, 378, 50, 392, 500, 36, 114, 74, 320, 500, 84, 122, 500, 134, 52, 60, 72, 500, 86, 82, 500, 126, 500, 500, 500, 346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3931719794955911, "mean_inference_ms": 1.2419379103992993, "mean_action_processing_ms": 0.14813767272976125, "mean_env_wait_ms": 0.08531848260267218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024998903274536133, "StateBufferConnector_ms": 0.006001472473144531, "ViewRequirementAgentConnector_ms": 0.1169888973236084}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5417.600435718826, "num_env_steps_trained_throughput_per_sec": 5417.600435718826, "timesteps_total": 156000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 2263.501, "sample_time_ms": 1992.1, "load_time_ms": 10.6, "load_throughput": 1132126.97, "learn_time_ms": 250.403, "learn_throughput": 47922.735, "synch_weights_time_ms": 9.498}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 566, "training_iteration": 13, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-37", "timestamp": 1698245017, "time_this_iter_s": 2.22200083732605, "time_total_s": 28.980003833770752, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 28.980003833770752, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 61.73333333333333, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000008e-05, "cur_lr": 0.0003, "total_loss": 6.318530050913493, "policy_loss": -0.0006746220091978709, "vf_loss": 6.319258562723795, "vf_explained_var": -1.33514404296875e-06, "kl": 0.0008332385564472133, "entropy": 0.5383586168289185, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.8369999999998265, "episode_len_mean": 257.26, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 39.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 33.10000000000003, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 34.50000000000004, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 12.299999999999734, 45.1, 10.899999999999714, -50.00000000000044, 46.5, 38.700000000000024, 42.70000000000001, 18.099999999999817, -50.00000000000044, 41.70000000000002, 37.90000000000003, -50.00000000000044, 36.70000000000003, 44.900000000000006, 44.10000000000001, 42.900000000000006, -50.00000000000044, 41.500000000000014, 41.90000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, -50.00000000000044, 16.09999999999979, 41.30000000000001, -50.00000000000044, -50.00000000000044, 47.1, 46.9, 43.10000000000001, 42.10000000000001, 45.5, 39.90000000000002, 42.500000000000014, -50.00000000000044, 35.30000000000004, 40.10000000000002, 44.900000000000006, -50.00000000000044, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.099999999999994, -50.00000000000044, 45.1, 45.3, 47.3, 41.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, 1.099999999999575, 39.300000000000026, 45.7, -50.00000000000044, -50.00000000000044, 22.49999999999988, 35.70000000000003, -50.00000000000044, 44.7, 35.30000000000004, -50.00000000000044, 46.3, 41.90000000000001, 43.10000000000001, 46.3], "episode_lengths": [500, 162, 500, 500, 56, 90, 500, 500, 40, 500, 108, 74, 500, 500, 206, 500, 170, 60, 38, 500, 500, 62, 156, 120, 500, 500, 500, 128, 378, 50, 392, 500, 36, 114, 74, 320, 500, 84, 122, 500, 134, 52, 60, 72, 500, 86, 82, 500, 126, 500, 500, 500, 346, 500, 500, 340, 88, 500, 500, 30, 32, 70, 80, 46, 102, 76, 500, 148, 100, 52, 500, 60, 74, 500, 500, 120, 40, 500, 50, 48, 28, 88, 64, 500, 500, 490, 108, 44, 500, 500, 276, 144, 500, 54, 148, 500, 38, 82, 70, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39257977818488393, "mean_inference_ms": 1.240688380597, "mean_action_processing_ms": 0.14740135499097834, "mean_env_wait_ms": 0.08568330191488731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100752830505371, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.13599324226379395}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.8369999999998265, "episode_len_mean": 257.26, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 39.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 33.10000000000003, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 34.50000000000004, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 12.299999999999734, 45.1, 10.899999999999714, -50.00000000000044, 46.5, 38.700000000000024, 42.70000000000001, 18.099999999999817, -50.00000000000044, 41.70000000000002, 37.90000000000003, -50.00000000000044, 36.70000000000003, 44.900000000000006, 44.10000000000001, 42.900000000000006, -50.00000000000044, 41.500000000000014, 41.90000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, -50.00000000000044, 16.09999999999979, 41.30000000000001, -50.00000000000044, -50.00000000000044, 47.1, 46.9, 43.10000000000001, 42.10000000000001, 45.5, 39.90000000000002, 42.500000000000014, -50.00000000000044, 35.30000000000004, 40.10000000000002, 44.900000000000006, -50.00000000000044, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.099999999999994, -50.00000000000044, 45.1, 45.3, 47.3, 41.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, 1.099999999999575, 39.300000000000026, 45.7, -50.00000000000044, -50.00000000000044, 22.49999999999988, 35.70000000000003, -50.00000000000044, 44.7, 35.30000000000004, -50.00000000000044, 46.3, 41.90000000000001, 43.10000000000001, 46.3], "episode_lengths": [500, 162, 500, 500, 56, 90, 500, 500, 40, 500, 108, 74, 500, 500, 206, 500, 170, 60, 38, 500, 500, 62, 156, 120, 500, 500, 500, 128, 378, 50, 392, 500, 36, 114, 74, 320, 500, 84, 122, 500, 134, 52, 60, 72, 500, 86, 82, 500, 126, 500, 500, 500, 346, 500, 500, 340, 88, 500, 500, 30, 32, 70, 80, 46, 102, 76, 500, 148, 100, 52, 500, 60, 74, 500, 500, 120, 40, 500, 50, 48, 28, 88, 64, 500, 500, 490, 108, 44, 500, 500, 276, 144, 500, 54, 148, 500, 38, 82, 70, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39257977818488393, "mean_inference_ms": 1.240688380597, "mean_action_processing_ms": 0.14740135499097834, "mean_env_wait_ms": 0.08568330191488731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100752830505371, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.13599324226379395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5447.116807663333, "num_env_steps_trained_throughput_per_sec": 5447.116807663333, "timesteps_total": 168000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 2215.901, "sample_time_ms": 1956.9, "load_time_ms": 10.199, "load_throughput": 1176528.362, "learn_time_ms": 238.403, "learn_throughput": 50334.945, "synch_weights_time_ms": 9.499}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 613, "training_iteration": 14, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-39", "timestamp": 1698245019, "time_this_iter_s": 2.2089991569519043, "time_total_s": 31.189002990722656, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 31.189002990722656, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 57.93333333333334, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000004e-05, "cur_lr": 0.0003, "total_loss": 6.540042877197266, "policy_loss": -0.00032843848069508873, "vf_loss": 6.540425237019857, "vf_explained_var": -2.6305516560872396e-06, "kl": 0.0006056804950427856, "entropy": 0.5411339362462362, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 218.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.7849999999998225, "episode_len_mean": 257.8, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 44.10000000000001, 42.900000000000006, -50.00000000000044, 41.500000000000014, 41.90000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, -50.00000000000044, 16.09999999999979, 41.30000000000001, -50.00000000000044, -50.00000000000044, 47.1, 46.9, 43.10000000000001, 42.10000000000001, 45.5, 39.90000000000002, 42.500000000000014, -50.00000000000044, 35.30000000000004, 40.10000000000002, 44.900000000000006, -50.00000000000044, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.099999999999994, -50.00000000000044, 45.1, 45.3, 47.3, 41.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, 1.099999999999575, 39.300000000000026, 45.7, -50.00000000000044, -50.00000000000044, 22.49999999999988, 35.70000000000003, -50.00000000000044, 44.7, 35.30000000000004, -50.00000000000044, 46.3, 41.90000000000001, 43.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 25.899999999999928, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 6.8999999999996575, 27.299999999999947, 44.300000000000004, -50.00000000000044, 44.900000000000006, 44.300000000000004, 42.900000000000006, 21.89999999999987, 44.10000000000001, 46.3, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 20.899999999999856, 45.9, 33.10000000000003, 26.299999999999933, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 28.699999999999967, -50.00000000000044, 45.9, 11.499999999999723, 47.1, -50.00000000000044, 6.8999999999996575, -50.00000000000044], "episode_lengths": [52, 60, 72, 500, 86, 82, 500, 126, 500, 500, 500, 346, 500, 500, 340, 88, 500, 500, 30, 32, 70, 80, 46, 102, 76, 500, 148, 100, 52, 500, 60, 74, 500, 500, 120, 40, 500, 50, 48, 28, 88, 64, 500, 500, 490, 108, 44, 500, 500, 276, 144, 500, 54, 148, 500, 38, 82, 70, 38, 500, 500, 48, 54, 242, 500, 238, 500, 500, 432, 228, 58, 500, 52, 58, 72, 282, 60, 38, 500, 320, 500, 500, 292, 42, 170, 238, 64, 42, 500, 500, 500, 94, 214, 500, 42, 386, 30, 500, 432, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39270313117940275, "mean_inference_ms": 1.2442471612960468, "mean_action_processing_ms": 0.1469242074122914, "mean_env_wait_ms": 0.08538023257735389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0250093936920166, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.12798213958740234}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.7849999999998225, "episode_len_mean": 257.8, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 44.10000000000001, 42.900000000000006, -50.00000000000044, 41.500000000000014, 41.90000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, -50.00000000000044, 16.09999999999979, 41.30000000000001, -50.00000000000044, -50.00000000000044, 47.1, 46.9, 43.10000000000001, 42.10000000000001, 45.5, 39.90000000000002, 42.500000000000014, -50.00000000000044, 35.30000000000004, 40.10000000000002, 44.900000000000006, -50.00000000000044, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.099999999999994, -50.00000000000044, 45.1, 45.3, 47.3, 41.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, 1.099999999999575, 39.300000000000026, 45.7, -50.00000000000044, -50.00000000000044, 22.49999999999988, 35.70000000000003, -50.00000000000044, 44.7, 35.30000000000004, -50.00000000000044, 46.3, 41.90000000000001, 43.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 25.899999999999928, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 6.8999999999996575, 27.299999999999947, 44.300000000000004, -50.00000000000044, 44.900000000000006, 44.300000000000004, 42.900000000000006, 21.89999999999987, 44.10000000000001, 46.3, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 20.899999999999856, 45.9, 33.10000000000003, 26.299999999999933, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 28.699999999999967, -50.00000000000044, 45.9, 11.499999999999723, 47.1, -50.00000000000044, 6.8999999999996575, -50.00000000000044], "episode_lengths": [52, 60, 72, 500, 86, 82, 500, 126, 500, 500, 500, 346, 500, 500, 340, 88, 500, 500, 30, 32, 70, 80, 46, 102, 76, 500, 148, 100, 52, 500, 60, 74, 500, 500, 120, 40, 500, 50, 48, 28, 88, 64, 500, 500, 490, 108, 44, 500, 500, 276, 144, 500, 54, 148, 500, 38, 82, 70, 38, 500, 500, 48, 54, 242, 500, 238, 500, 500, 432, 228, 58, 500, 52, 58, 72, 282, 60, 38, 500, 320, 500, 500, 292, 42, 170, 238, 64, 42, 500, 500, 500, 94, 214, 500, 42, 386, 30, 500, 432, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39270313117940275, "mean_inference_ms": 1.2442471612960468, "mean_action_processing_ms": 0.1469242074122914, "mean_env_wait_ms": 0.08538023257735389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0250093936920166, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.12798213958740234}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5152.421195259109, "num_env_steps_trained_throughput_per_sec": 5152.421195259109, "timesteps_total": 180000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 2228.901, "sample_time_ms": 1957.1, "load_time_ms": 10.999, "load_throughput": 1090962.152, "learn_time_ms": 250.303, "learn_throughput": 47941.87, "synch_weights_time_ms": 9.599}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 654, "training_iteration": 15, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-42", "timestamp": 1698245022, "time_this_iter_s": 2.3339998722076416, "time_total_s": 33.5230028629303, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 33.5230028629303, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 63.625, "ram_util_percent": 27.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000002e-06, "cur_lr": 0.0003, "total_loss": 7.005110613505045, "policy_loss": -2.2206331292788186e-05, "vf_loss": 7.005184427897135, "vf_explained_var": -3.8544336954752605e-07, "kl": 0.00017018394134993287, "entropy": 0.5155033449331919, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 233.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.506999999999821, "episode_len_mean": 260.58, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 35.30000000000004, -50.00000000000044, 46.3, 41.90000000000001, 43.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 25.899999999999928, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 6.8999999999996575, 27.299999999999947, 44.300000000000004, -50.00000000000044, 44.900000000000006, 44.300000000000004, 42.900000000000006, 21.89999999999987, 44.10000000000001, 46.3, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 20.899999999999856, 45.9, 33.10000000000003, 26.299999999999933, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 28.699999999999967, -50.00000000000044, 45.9, 11.499999999999723, 47.1, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.900000000000006, 38.10000000000002, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 2.0999999999995893, 43.7, 36.900000000000034, 44.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 39.90000000000002, 47.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 42.70000000000001, -50.00000000000044, 44.300000000000004, 24.69999999999991, 47.1, -50.00000000000044, 37.70000000000003, -50.00000000000044, 27.299999999999947, 46.3, 44.10000000000001, 16.8999999999998, 41.30000000000001, 44.900000000000006, 45.3, 4.299999999999621, 39.50000000000002, -50.00000000000044, 21.299999999999862, -50.00000000000044, 43.10000000000001], "episode_lengths": [500, 54, 148, 500, 38, 82, 70, 38, 500, 500, 48, 54, 242, 500, 238, 500, 500, 432, 228, 58, 500, 52, 58, 72, 282, 60, 38, 500, 320, 500, 500, 292, 42, 170, 238, 64, 42, 500, 500, 500, 94, 214, 500, 42, 386, 30, 500, 432, 500, 500, 74, 62, 120, 500, 46, 58, 500, 500, 480, 64, 132, 52, 500, 58, 500, 36, 500, 24, 500, 500, 34, 500, 102, 26, 500, 68, 500, 500, 156, 74, 500, 58, 254, 30, 500, 124, 500, 228, 38, 60, 332, 88, 52, 48, 458, 106, 500, 288, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39276507328929583, "mean_inference_ms": 1.2472926230839725, "mean_action_processing_ms": 0.14719602164435688, "mean_env_wait_ms": 0.08538900247168682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0350034236907959, "StateBufferConnector_ms": 0.004998683929443359, "ViewRequirementAgentConnector_ms": 0.12598252296447754}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.506999999999821, "episode_len_mean": 260.58, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 35.30000000000004, -50.00000000000044, 46.3, 41.90000000000001, 43.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 25.899999999999928, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 6.8999999999996575, 27.299999999999947, 44.300000000000004, -50.00000000000044, 44.900000000000006, 44.300000000000004, 42.900000000000006, 21.89999999999987, 44.10000000000001, 46.3, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 20.899999999999856, 45.9, 33.10000000000003, 26.299999999999933, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 28.699999999999967, -50.00000000000044, 45.9, 11.499999999999723, 47.1, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.900000000000006, 38.10000000000002, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 2.0999999999995893, 43.7, 36.900000000000034, 44.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 39.90000000000002, 47.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 42.70000000000001, -50.00000000000044, 44.300000000000004, 24.69999999999991, 47.1, -50.00000000000044, 37.70000000000003, -50.00000000000044, 27.299999999999947, 46.3, 44.10000000000001, 16.8999999999998, 41.30000000000001, 44.900000000000006, 45.3, 4.299999999999621, 39.50000000000002, -50.00000000000044, 21.299999999999862, -50.00000000000044, 43.10000000000001], "episode_lengths": [500, 54, 148, 500, 38, 82, 70, 38, 500, 500, 48, 54, 242, 500, 238, 500, 500, 432, 228, 58, 500, 52, 58, 72, 282, 60, 38, 500, 320, 500, 500, 292, 42, 170, 238, 64, 42, 500, 500, 500, 94, 214, 500, 42, 386, 30, 500, 432, 500, 500, 74, 62, 120, 500, 46, 58, 500, 500, 480, 64, 132, 52, 500, 58, 500, 36, 500, 24, 500, 500, 34, 500, 102, 26, 500, 68, 500, 500, 156, 74, 500, 58, 254, 30, 500, 124, 500, 228, 38, 60, 332, 88, 52, 48, 458, 106, 500, 288, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39276507328929583, "mean_inference_ms": 1.2472926230839725, "mean_action_processing_ms": 0.14719602164435688, "mean_env_wait_ms": 0.08538900247168682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0350034236907959, "StateBufferConnector_ms": 0.004998683929443359, "ViewRequirementAgentConnector_ms": 0.12598252296447754}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5449.589751252184, "num_env_steps_trained_throughput_per_sec": 5449.589751252184, "timesteps_total": 192000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 2224.801, "sample_time_ms": 1957.8, "load_time_ms": 11.099, "load_throughput": 1081143.186, "learn_time_ms": 245.203, "learn_throughput": 48938.986, "synch_weights_time_ms": 9.799}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 705, "training_iteration": 16, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-44", "timestamp": 1698245024, "time_this_iter_s": 2.208000659942627, "time_total_s": 35.731003522872925, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 35.731003522872925, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 65.06666666666668, "ram_util_percent": 27.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.051757812500001e-06, "cur_lr": 0.0003, "total_loss": 6.1572843869527185, "policy_loss": -5.841131011644999e-05, "vf_loss": 6.157393423716227, "vf_explained_var": -7.470448811848958e-07, "kl": 4.399251678250948e-05, "entropy": 0.5072912116845448, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 248.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.447999999999809, "episode_len_mean": 266.12, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 11.499999999999723, 47.1, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.900000000000006, 38.10000000000002, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 2.0999999999995893, 43.7, 36.900000000000034, 44.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 39.90000000000002, 47.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 42.70000000000001, -50.00000000000044, 44.300000000000004, 24.69999999999991, 47.1, -50.00000000000044, 37.70000000000003, -50.00000000000044, 27.299999999999947, 46.3, 44.10000000000001, 16.8999999999998, 41.30000000000001, 44.900000000000006, 45.3, 4.299999999999621, 39.50000000000002, -50.00000000000044, 21.299999999999862, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, 36.900000000000034, 38.90000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.9, 46.099999999999994, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.10000000000001, 45.1, 47.1, 42.500000000000014, 43.7, 40.500000000000014, 46.099999999999994, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 34.900000000000034], "episode_lengths": [500, 42, 386, 30, 500, 432, 500, 500, 74, 62, 120, 500, 46, 58, 500, 500, 480, 64, 132, 52, 500, 58, 500, 36, 500, 24, 500, 500, 34, 500, 102, 26, 500, 68, 500, 500, 156, 74, 500, 58, 254, 30, 500, 124, 500, 228, 38, 60, 332, 88, 52, 48, 458, 106, 500, 288, 500, 70, 500, 500, 46, 500, 52, 34, 132, 112, 70, 500, 500, 48, 500, 500, 500, 238, 500, 500, 500, 40, 500, 500, 136, 42, 40, 500, 70, 500, 60, 50, 30, 76, 64, 96, 40, 500, 100, 500, 500, 500, 94, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39258425024786214, "mean_inference_ms": 1.2485367912288654, "mean_action_processing_ms": 0.147582368948089, "mean_env_wait_ms": 0.08580737333800871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699827194213867, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.11300492286682129}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.447999999999809, "episode_len_mean": 266.12, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 11.499999999999723, 47.1, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.900000000000006, 38.10000000000002, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 2.0999999999995893, 43.7, 36.900000000000034, 44.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 39.90000000000002, 47.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 42.70000000000001, -50.00000000000044, 44.300000000000004, 24.69999999999991, 47.1, -50.00000000000044, 37.70000000000003, -50.00000000000044, 27.299999999999947, 46.3, 44.10000000000001, 16.8999999999998, 41.30000000000001, 44.900000000000006, 45.3, 4.299999999999621, 39.50000000000002, -50.00000000000044, 21.299999999999862, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, 36.900000000000034, 38.90000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.9, 46.099999999999994, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.10000000000001, 45.1, 47.1, 42.500000000000014, 43.7, 40.500000000000014, 46.099999999999994, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 34.900000000000034], "episode_lengths": [500, 42, 386, 30, 500, 432, 500, 500, 74, 62, 120, 500, 46, 58, 500, 500, 480, 64, 132, 52, 500, 58, 500, 36, 500, 24, 500, 500, 34, 500, 102, 26, 500, 68, 500, 500, 156, 74, 500, 58, 254, 30, 500, 124, 500, 228, 38, 60, 332, 88, 52, 48, 458, 106, 500, 288, 500, 70, 500, 500, 46, 500, 52, 34, 132, 112, 70, 500, 500, 48, 500, 500, 500, 238, 500, 500, 500, 40, 500, 500, 136, 42, 40, 500, 70, 500, 60, 50, 30, 76, 64, 96, 40, 500, 100, 500, 500, 500, 94, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39258425024786214, "mean_inference_ms": 1.2485367912288654, "mean_action_processing_ms": 0.147582368948089, "mean_env_wait_ms": 0.08580737333800871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699827194213867, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.11300492286682129}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5165.730885420184, "num_env_steps_trained_throughput_per_sec": 5165.730885420184, "timesteps_total": 204000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 2230.501, "sample_time_ms": 1961.7, "load_time_ms": 11.199, "load_throughput": 1071483.423, "learn_time_ms": 247.003, "learn_throughput": 48582.348, "synch_weights_time_ms": 9.699}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 747, "training_iteration": 17, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-46", "timestamp": 1698245026, "time_this_iter_s": 2.328000783920288, "time_total_s": 38.05900430679321, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 38.05900430679321, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 62.76666666666667, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500005e-06, "cur_lr": 0.0003, "total_loss": 6.567899640401205, "policy_loss": 3.416339556376139e-05, "vf_loss": 6.5679173787434895, "vf_explained_var": 9.49700673421224e-07, "kl": 6.828641111458941e-05, "entropy": 0.519672421614329, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 263.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6129999999998024, "episode_len_mean": 269.48, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.299999999999947, 46.3, 44.10000000000001, 16.8999999999998, 41.30000000000001, 44.900000000000006, 45.3, 4.299999999999621, 39.50000000000002, -50.00000000000044, 21.299999999999862, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, 36.900000000000034, 38.90000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.9, 46.099999999999994, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.10000000000001, 45.1, 47.1, 42.500000000000014, 43.7, 40.500000000000014, 46.099999999999994, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 34.900000000000034, -50.00000000000044, 6.699999999999655, 45.1, 26.499999999999936, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, 0.2999999999995637, 44.300000000000004, 43.50000000000001, 4.499999999999623, 46.099999999999994, 45.1, 46.9, -50.00000000000044, 37.10000000000003, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.5, -50.00000000000044, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 1.099999999999575, 44.300000000000004, 47.1, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.3, 45.7, 41.70000000000002, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001], "episode_lengths": [500, 228, 38, 60, 332, 88, 52, 48, 458, 106, 500, 288, 500, 70, 500, 500, 46, 500, 52, 34, 132, 112, 70, 500, 500, 48, 500, 500, 500, 238, 500, 500, 500, 40, 500, 500, 136, 42, 40, 500, 70, 500, 60, 50, 30, 76, 64, 96, 40, 500, 100, 500, 500, 500, 94, 152, 500, 434, 50, 236, 500, 500, 46, 500, 72, 498, 58, 66, 456, 40, 50, 32, 500, 130, 54, 500, 96, 500, 500, 500, 32, 46, 500, 500, 480, 500, 490, 58, 30, 500, 500, 110, 48, 44, 84, 44, 500, 500, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39274667733709423, "mean_inference_ms": 1.2474313648326667, "mean_action_processing_ms": 0.14821441348129044, "mean_env_wait_ms": 0.08610213183496336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03899955749511719, "StateBufferConnector_ms": 0.005006313323974609, "ViewRequirementAgentConnector_ms": 0.1190030574798584}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6129999999998024, "episode_len_mean": 269.48, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.299999999999947, 46.3, 44.10000000000001, 16.8999999999998, 41.30000000000001, 44.900000000000006, 45.3, 4.299999999999621, 39.50000000000002, -50.00000000000044, 21.299999999999862, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, 36.900000000000034, 38.90000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.9, 46.099999999999994, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.10000000000001, 45.1, 47.1, 42.500000000000014, 43.7, 40.500000000000014, 46.099999999999994, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 34.900000000000034, -50.00000000000044, 6.699999999999655, 45.1, 26.499999999999936, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, 0.2999999999995637, 44.300000000000004, 43.50000000000001, 4.499999999999623, 46.099999999999994, 45.1, 46.9, -50.00000000000044, 37.10000000000003, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.5, -50.00000000000044, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 1.099999999999575, 44.300000000000004, 47.1, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.3, 45.7, 41.70000000000002, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001], "episode_lengths": [500, 228, 38, 60, 332, 88, 52, 48, 458, 106, 500, 288, 500, 70, 500, 500, 46, 500, 52, 34, 132, 112, 70, 500, 500, 48, 500, 500, 500, 238, 500, 500, 500, 40, 500, 500, 136, 42, 40, 500, 70, 500, 60, 50, 30, 76, 64, 96, 40, 500, 100, 500, 500, 500, 94, 152, 500, 434, 50, 236, 500, 500, 46, 500, 72, 498, 58, 66, 456, 40, 50, 32, 500, 130, 54, 500, 96, 500, 500, 500, 32, 46, 500, 500, 480, 500, 490, 58, 30, 500, 500, 110, 48, 44, 84, 44, 500, 500, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39274667733709423, "mean_inference_ms": 1.2474313648326667, "mean_action_processing_ms": 0.14821441348129044, "mean_env_wait_ms": 0.08610213183496336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03899955749511719, "StateBufferConnector_ms": 0.005006313323974609, "ViewRequirementAgentConnector_ms": 0.1190030574798584}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5711.566377281034, "num_env_steps_trained_throughput_per_sec": 5711.566377281034, "timesteps_total": 216000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 2220.601, "sample_time_ms": 1957.5, "load_time_ms": 10.799, "load_throughput": 1111174.477, "learn_time_ms": 241.5, "learn_throughput": 49689.363, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 791, "training_iteration": 18, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-48", "timestamp": 1698245028, "time_this_iter_s": 2.1059982776641846, "time_total_s": 40.1650025844574, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 40.1650025844574, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 56.833333333333336, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250003e-07, "cur_lr": 0.0003, "total_loss": 6.1022389729817705, "policy_loss": -0.000514581302801768, "vf_loss": 6.102805201212565, "vf_explained_var": -1.2199083964029947e-06, "kl": 0.0004505918071667262, "entropy": 0.5162491599718729, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 278.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.56399999999981, "episode_len_mean": 265.0, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 47.1, 42.500000000000014, 43.7, 40.500000000000014, 46.099999999999994, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 34.900000000000034, -50.00000000000044, 6.699999999999655, 45.1, 26.499999999999936, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, 0.2999999999995637, 44.300000000000004, 43.50000000000001, 4.499999999999623, 46.099999999999994, 45.1, 46.9, -50.00000000000044, 37.10000000000003, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.5, -50.00000000000044, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 1.099999999999575, 44.300000000000004, 47.1, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.3, 45.7, 41.70000000000002, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 32.90000000000003, 43.30000000000001, -50.00000000000044, 45.1, 45.5, 25.29999999999992, 11.29999999999972, 5.299999999999635, 45.3, 17.299999999999805, 18.29999999999982, -50.00000000000044, 45.7, 45.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 23.699999999999896, -50.00000000000044, 43.7, -50.00000000000044, 45.7, 45.3, 44.900000000000006, 36.30000000000003, 13.499999999999751, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.70000000000004, 26.69999999999994, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 46.099999999999994], "episode_lengths": [50, 30, 76, 64, 96, 40, 500, 100, 500, 500, 500, 94, 152, 500, 434, 50, 236, 500, 500, 46, 500, 72, 498, 58, 66, 456, 40, 50, 32, 500, 130, 54, 500, 96, 500, 500, 500, 32, 46, 500, 500, 480, 500, 490, 58, 30, 500, 500, 110, 48, 44, 84, 44, 500, 500, 500, 74, 172, 68, 500, 50, 46, 248, 388, 448, 48, 328, 318, 500, 44, 46, 500, 94, 500, 500, 44, 264, 500, 64, 500, 44, 48, 52, 138, 366, 500, 500, 44, 500, 154, 234, 500, 42, 500, 500, 500, 500, 54, 54, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3934662252057213, "mean_inference_ms": 1.2485309781887861, "mean_action_processing_ms": 0.14799211525288064, "mean_env_wait_ms": 0.08636320118063415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600716590881348, "StateBufferConnector_ms": 0.007002353668212891, "ViewRequirementAgentConnector_ms": 0.12596726417541504}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.56399999999981, "episode_len_mean": 265.0, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 47.1, 42.500000000000014, 43.7, 40.500000000000014, 46.099999999999994, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 34.900000000000034, -50.00000000000044, 6.699999999999655, 45.1, 26.499999999999936, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, 0.2999999999995637, 44.300000000000004, 43.50000000000001, 4.499999999999623, 46.099999999999994, 45.1, 46.9, -50.00000000000044, 37.10000000000003, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.5, -50.00000000000044, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 1.099999999999575, 44.300000000000004, 47.1, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.3, 45.7, 41.70000000000002, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 32.90000000000003, 43.30000000000001, -50.00000000000044, 45.1, 45.5, 25.29999999999992, 11.29999999999972, 5.299999999999635, 45.3, 17.299999999999805, 18.29999999999982, -50.00000000000044, 45.7, 45.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 23.699999999999896, -50.00000000000044, 43.7, -50.00000000000044, 45.7, 45.3, 44.900000000000006, 36.30000000000003, 13.499999999999751, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.70000000000004, 26.69999999999994, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 46.099999999999994], "episode_lengths": [50, 30, 76, 64, 96, 40, 500, 100, 500, 500, 500, 94, 152, 500, 434, 50, 236, 500, 500, 46, 500, 72, 498, 58, 66, 456, 40, 50, 32, 500, 130, 54, 500, 96, 500, 500, 500, 32, 46, 500, 500, 480, 500, 490, 58, 30, 500, 500, 110, 48, 44, 84, 44, 500, 500, 500, 74, 172, 68, 500, 50, 46, 248, 388, 448, 48, 328, 318, 500, 44, 46, 500, 94, 500, 500, 44, 264, 500, 64, 500, 44, 48, 52, 138, 366, 500, 500, 44, 500, 154, 234, 500, 42, 500, 500, 500, 500, 54, 54, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3934662252057213, "mean_inference_ms": 1.2485309781887861, "mean_action_processing_ms": 0.14799211525288064, "mean_env_wait_ms": 0.08636320118063415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600716590881348, "StateBufferConnector_ms": 0.007002353668212891, "ViewRequirementAgentConnector_ms": 0.12596726417541504}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5095.538264791662, "num_env_steps_trained_throughput_per_sec": 5095.538264791662, "timesteps_total": 228000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 2220.701, "sample_time_ms": 1963.1, "load_time_ms": 10.499, "load_throughput": 1142929.601, "learn_time_ms": 236.1, "learn_throughput": 50825.833, "synch_weights_time_ms": 10.002}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 834, "training_iteration": 19, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-51", "timestamp": 1698245031, "time_this_iter_s": 2.3599982261657715, "time_total_s": 42.52500081062317, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 42.52500081062317, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 66.89999999999999, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.8146972656250013e-07, "cur_lr": 0.0003, "total_loss": 7.144266160329183, "policy_loss": -0.00023365219434102376, "vf_loss": 7.144549433390299, "vf_explained_var": 8.344650268554688e-07, "kl": 0.0006286762186543152, "entropy": 0.4953780213991801, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.47299999999978815, "episode_len_mean": 290.86, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 1.099999999999575, 44.300000000000004, 47.1, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.3, 45.7, 41.70000000000002, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 32.90000000000003, 43.30000000000001, -50.00000000000044, 45.1, 45.5, 25.29999999999992, 11.29999999999972, 5.299999999999635, 45.3, 17.299999999999805, 18.29999999999982, -50.00000000000044, 45.7, 45.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 23.699999999999896, -50.00000000000044, 43.7, -50.00000000000044, 45.7, 45.3, 44.900000000000006, 36.30000000000003, 13.499999999999751, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.70000000000004, 26.69999999999994, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 44.5, 33.10000000000003, 45.5, 15.49999999999978, -50.00000000000044, 26.09999999999993, 40.500000000000014, -50.00000000000044, 3.499999999999609, 42.10000000000001, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, -50.00000000000044, 43.900000000000006, 19.69999999999984, 45.9, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 45.9, -50.00000000000044, 27.899999999999956, 41.70000000000002, -50.00000000000044, 45.7, 32.700000000000024], "episode_lengths": [500, 490, 58, 30, 500, 500, 110, 48, 44, 84, 44, 500, 500, 500, 74, 172, 68, 500, 50, 46, 248, 388, 448, 48, 328, 318, 500, 44, 46, 500, 94, 500, 500, 44, 264, 500, 64, 500, 44, 48, 52, 138, 366, 500, 500, 44, 500, 154, 234, 500, 42, 500, 500, 500, 500, 54, 54, 40, 500, 46, 500, 500, 88, 500, 500, 500, 138, 500, 220, 500, 500, 56, 170, 46, 346, 500, 240, 96, 500, 466, 80, 500, 500, 404, 500, 500, 62, 304, 42, 500, 500, 294, 500, 42, 500, 222, 84, 500, 44, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39386487652179325, "mean_inference_ms": 1.2517805536437665, "mean_action_processing_ms": 0.14774067837285276, "mean_env_wait_ms": 0.08614942773844979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027007102966308594, "StateBufferConnector_ms": 0.00799250602722168, "ViewRequirementAgentConnector_ms": 0.12293243408203125}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.47299999999978815, "episode_len_mean": 290.86, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 1.099999999999575, 44.300000000000004, 47.1, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.3, 45.7, 41.70000000000002, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 32.90000000000003, 43.30000000000001, -50.00000000000044, 45.1, 45.5, 25.29999999999992, 11.29999999999972, 5.299999999999635, 45.3, 17.299999999999805, 18.29999999999982, -50.00000000000044, 45.7, 45.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 23.699999999999896, -50.00000000000044, 43.7, -50.00000000000044, 45.7, 45.3, 44.900000000000006, 36.30000000000003, 13.499999999999751, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.70000000000004, 26.69999999999994, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 44.5, 33.10000000000003, 45.5, 15.49999999999978, -50.00000000000044, 26.09999999999993, 40.500000000000014, -50.00000000000044, 3.499999999999609, 42.10000000000001, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, -50.00000000000044, 43.900000000000006, 19.69999999999984, 45.9, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 45.9, -50.00000000000044, 27.899999999999956, 41.70000000000002, -50.00000000000044, 45.7, 32.700000000000024], "episode_lengths": [500, 490, 58, 30, 500, 500, 110, 48, 44, 84, 44, 500, 500, 500, 74, 172, 68, 500, 50, 46, 248, 388, 448, 48, 328, 318, 500, 44, 46, 500, 94, 500, 500, 44, 264, 500, 64, 500, 44, 48, 52, 138, 366, 500, 500, 44, 500, 154, 234, 500, 42, 500, 500, 500, 500, 54, 54, 40, 500, 46, 500, 500, 88, 500, 500, 500, 138, 500, 220, 500, 500, 56, 170, 46, 346, 500, 240, 96, 500, 466, 80, 500, 500, 404, 500, 500, 62, 304, 42, 500, 500, 294, 500, 42, 500, 222, 84, 500, 44, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39386487652179325, "mean_inference_ms": 1.2517805536437665, "mean_action_processing_ms": 0.14774067837285276, "mean_env_wait_ms": 0.08614942773844979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027007102966308594, "StateBufferConnector_ms": 0.00799250602722168, "ViewRequirementAgentConnector_ms": 0.12293243408203125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5253.93131615282, "num_env_steps_trained_throughput_per_sec": 5253.93131615282, "timesteps_total": 240000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 2247.001, "sample_time_ms": 1975.0, "load_time_ms": 11.4, "load_throughput": 1052666.046, "learn_time_ms": 249.3, "learn_throughput": 48134.717, "synch_weights_time_ms": 10.302}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 876, "training_iteration": 20, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-53", "timestamp": 1698245033, "time_this_iter_s": 2.2900009155273438, "time_total_s": 44.81500172615051, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 44.81500172615051, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 60.025000000000006, "ram_util_percent": 27.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125006e-07, "cur_lr": 0.0003, "total_loss": 6.45068998336792, "policy_loss": -0.0004774982730547587, "vf_loss": 6.451219622294108, "vf_explained_var": -3.0994415283203126e-07, "kl": 0.0005905286127064831, "entropy": 0.5221312642097473, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 308.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3069999999998085, "episode_len_mean": 272.52, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 44.5, 33.10000000000003, 45.5, 15.49999999999978, -50.00000000000044, 26.09999999999993, 40.500000000000014, -50.00000000000044, 3.499999999999609, 42.10000000000001, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, -50.00000000000044, 43.900000000000006, 19.69999999999984, 45.9, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 45.9, -50.00000000000044, 27.899999999999956, 41.70000000000002, -50.00000000000044, 45.7, 32.700000000000024, -50.00000000000044, 29.099999999999973, -50.00000000000044, 45.9, 39.70000000000002, 43.30000000000001, 38.50000000000003, 45.7, 46.099999999999994, 38.10000000000002, 47.1, -50.00000000000044, 45.1, -50.00000000000044, 41.100000000000016, 45.3, 46.3, 48.1, 43.10000000000001, 40.10000000000002, 37.50000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.900000000000034, 30.699999999999996, 35.900000000000034, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.30000000000001, 46.099999999999994, 46.5, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.900000000000006, 42.500000000000014, 43.7, 40.70000000000002, -50.00000000000044, -50.00000000000044, 26.499999999999936, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 42, 500, 500, 500, 500, 54, 54, 40, 500, 46, 500, 500, 88, 500, 500, 500, 138, 500, 220, 500, 500, 56, 170, 46, 346, 500, 240, 96, 500, 466, 80, 500, 500, 404, 500, 500, 62, 304, 42, 500, 500, 294, 500, 42, 500, 222, 84, 500, 44, 174, 500, 210, 500, 42, 104, 68, 116, 44, 40, 120, 30, 500, 50, 500, 90, 48, 38, 20, 70, 100, 126, 72, 500, 500, 152, 194, 142, 140, 500, 500, 68, 68, 40, 36, 500, 500, 116, 52, 76, 64, 94, 500, 500, 236, 500, 32, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39492130732946684, "mean_inference_ms": 1.2523583554696274, "mean_action_processing_ms": 0.14796116761675715, "mean_env_wait_ms": 0.08651467882141453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500509262084961, "StateBufferConnector_ms": 0.005995035171508789, "ViewRequirementAgentConnector_ms": 0.12696480751037598}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3069999999998085, "episode_len_mean": 272.52, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 44.5, 33.10000000000003, 45.5, 15.49999999999978, -50.00000000000044, 26.09999999999993, 40.500000000000014, -50.00000000000044, 3.499999999999609, 42.10000000000001, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, -50.00000000000044, 43.900000000000006, 19.69999999999984, 45.9, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 45.9, -50.00000000000044, 27.899999999999956, 41.70000000000002, -50.00000000000044, 45.7, 32.700000000000024, -50.00000000000044, 29.099999999999973, -50.00000000000044, 45.9, 39.70000000000002, 43.30000000000001, 38.50000000000003, 45.7, 46.099999999999994, 38.10000000000002, 47.1, -50.00000000000044, 45.1, -50.00000000000044, 41.100000000000016, 45.3, 46.3, 48.1, 43.10000000000001, 40.10000000000002, 37.50000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.900000000000034, 30.699999999999996, 35.900000000000034, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.30000000000001, 46.099999999999994, 46.5, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.900000000000006, 42.500000000000014, 43.7, 40.70000000000002, -50.00000000000044, -50.00000000000044, 26.499999999999936, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 42, 500, 500, 500, 500, 54, 54, 40, 500, 46, 500, 500, 88, 500, 500, 500, 138, 500, 220, 500, 500, 56, 170, 46, 346, 500, 240, 96, 500, 466, 80, 500, 500, 404, 500, 500, 62, 304, 42, 500, 500, 294, 500, 42, 500, 222, 84, 500, 44, 174, 500, 210, 500, 42, 104, 68, 116, 44, 40, 120, 30, 500, 50, 500, 90, 48, 38, 20, 70, 100, 126, 72, 500, 500, 152, 194, 142, 140, 500, 500, 68, 68, 40, 36, 500, 500, 116, 52, 76, 64, 94, 500, 500, 236, 500, 32, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39492130732946684, "mean_inference_ms": 1.2523583554696274, "mean_action_processing_ms": 0.14796116761675715, "mean_env_wait_ms": 0.08651467882141453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500509262084961, "StateBufferConnector_ms": 0.005995035171508789, "ViewRequirementAgentConnector_ms": 0.12696480751037598}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5432.318527862899, "num_env_steps_trained_throughput_per_sec": 5432.318527862899, "timesteps_total": 252000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 2238.101, "sample_time_ms": 1978.8, "load_time_ms": 10.7, "load_throughput": 1121521.636, "learn_time_ms": 237.2, "learn_throughput": 50590.189, "synch_weights_time_ms": 10.302}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 925, "training_iteration": 21, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-55", "timestamp": 1698245035, "time_this_iter_s": 2.2140002250671387, "time_total_s": 47.02900195121765, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 47.02900195121765, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 67.73333333333333, "ram_util_percent": 27.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062503e-08, "cur_lr": 0.0003, "total_loss": 6.265725040435791, "policy_loss": -0.0009213512142499288, "vf_loss": 6.266692606608073, "vf_explained_var": -2.2093454996744794e-06, "kl": 0.0011129991507611218, "entropy": 0.463305135567983, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 323.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.786999999999859, "episode_len_mean": 217.82, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, 39.70000000000002, 43.30000000000001, 38.50000000000003, 45.7, 46.099999999999994, 38.10000000000002, 47.1, -50.00000000000044, 45.1, -50.00000000000044, 41.100000000000016, 45.3, 46.3, 48.1, 43.10000000000001, 40.10000000000002, 37.50000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.900000000000034, 30.699999999999996, 35.900000000000034, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.30000000000001, 46.099999999999994, 46.5, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.900000000000006, 42.500000000000014, 43.7, 40.70000000000002, -50.00000000000044, -50.00000000000044, 26.499999999999936, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, 37.70000000000003, 45.9, 43.900000000000006, -50.00000000000044, 44.300000000000004, 43.7, 45.7, 46.699999999999996, 46.5, -50.00000000000044, 46.3, 43.30000000000001, 44.300000000000004, 43.10000000000001, 45.5, -50.00000000000044, 44.900000000000006, 45.1, 39.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.5, 41.100000000000016, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.699999999999996, 33.90000000000004, -50.00000000000044, -50.00000000000044, 46.9, 26.89999999999994, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.299999999999706, 31.1, -50.00000000000044, 46.3, 43.10000000000001, 46.5, 17.099999999999802, 47.1, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.10000000000001, 33.500000000000036], "episode_lengths": [42, 104, 68, 116, 44, 40, 120, 30, 500, 50, 500, 90, 48, 38, 20, 70, 100, 126, 72, 500, 500, 152, 194, 142, 140, 500, 500, 68, 68, 40, 36, 500, 500, 116, 52, 76, 64, 94, 500, 500, 236, 500, 32, 500, 500, 500, 500, 366, 500, 124, 42, 62, 500, 58, 64, 44, 34, 36, 500, 38, 68, 58, 70, 46, 500, 52, 50, 104, 58, 500, 500, 36, 90, 500, 146, 500, 34, 162, 500, 500, 32, 232, 48, 34, 500, 500, 500, 398, 190, 500, 38, 70, 36, 330, 30, 500, 88, 500, 60, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3956446704767359, "mean_inference_ms": 1.2522205003455122, "mean_action_processing_ms": 0.14796364594071382, "mean_env_wait_ms": 0.08666874538753479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03899860382080078, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.12001562118530273}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.786999999999859, "episode_len_mean": 217.82, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, 39.70000000000002, 43.30000000000001, 38.50000000000003, 45.7, 46.099999999999994, 38.10000000000002, 47.1, -50.00000000000044, 45.1, -50.00000000000044, 41.100000000000016, 45.3, 46.3, 48.1, 43.10000000000001, 40.10000000000002, 37.50000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.900000000000034, 30.699999999999996, 35.900000000000034, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.30000000000001, 46.099999999999994, 46.5, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.900000000000006, 42.500000000000014, 43.7, 40.70000000000002, -50.00000000000044, -50.00000000000044, 26.499999999999936, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, 37.70000000000003, 45.9, 43.900000000000006, -50.00000000000044, 44.300000000000004, 43.7, 45.7, 46.699999999999996, 46.5, -50.00000000000044, 46.3, 43.30000000000001, 44.300000000000004, 43.10000000000001, 45.5, -50.00000000000044, 44.900000000000006, 45.1, 39.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.5, 41.100000000000016, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.699999999999996, 33.90000000000004, -50.00000000000044, -50.00000000000044, 46.9, 26.89999999999994, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.299999999999706, 31.1, -50.00000000000044, 46.3, 43.10000000000001, 46.5, 17.099999999999802, 47.1, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.10000000000001, 33.500000000000036], "episode_lengths": [42, 104, 68, 116, 44, 40, 120, 30, 500, 50, 500, 90, 48, 38, 20, 70, 100, 126, 72, 500, 500, 152, 194, 142, 140, 500, 500, 68, 68, 40, 36, 500, 500, 116, 52, 76, 64, 94, 500, 500, 236, 500, 32, 500, 500, 500, 500, 366, 500, 124, 42, 62, 500, 58, 64, 44, 34, 36, 500, 38, 68, 58, 70, 46, 500, 52, 50, 104, 58, 500, 500, 36, 90, 500, 146, 500, 34, 162, 500, 500, 32, 232, 48, 34, 500, 500, 500, 398, 190, 500, 38, 70, 36, 330, 30, 500, 88, 500, 60, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3956446704767359, "mean_inference_ms": 1.2522205003455122, "mean_action_processing_ms": 0.14796364594071382, "mean_env_wait_ms": 0.08666874538753479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03899860382080078, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.12001562118530273}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5219.662289677727, "num_env_steps_trained_throughput_per_sec": 5219.662289677727, "timesteps_total": 264000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 2252.001, "sample_time_ms": 1980.2, "load_time_ms": 11.4, "load_throughput": 1052648.434, "learn_time_ms": 249.0, "learn_throughput": 48192.748, "synch_weights_time_ms": 10.302}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 979, "training_iteration": 22, "trial_id": "9f288_00003", "date": "2023-10-25_15-43-57", "timestamp": 1698245037, "time_this_iter_s": 2.303999662399292, "time_total_s": 49.33300161361694, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 49.33300161361694, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 62.56666666666666, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.7683715820312516e-08, "cur_lr": 0.0003, "total_loss": 6.619884713490804, "policy_loss": -0.0004362136125564575, "vf_loss": 6.6203687985738116, "vf_explained_var": -1.3192494710286458e-06, "kl": 0.0005438562066804783, "entropy": 0.4782970507939657, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.244999999999825, "episode_len_mean": 253.18, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, 37.70000000000003, 45.9, 43.900000000000006, -50.00000000000044, 44.300000000000004, 43.7, 45.7, 46.699999999999996, 46.5, -50.00000000000044, 46.3, 43.30000000000001, 44.300000000000004, 43.10000000000001, 45.5, -50.00000000000044, 44.900000000000006, 45.1, 39.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.5, 41.100000000000016, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.699999999999996, 33.90000000000004, -50.00000000000044, -50.00000000000044, 46.9, 26.89999999999994, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.299999999999706, 31.1, -50.00000000000044, 46.3, 43.10000000000001, 46.5, 17.099999999999802, 47.1, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.10000000000001, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 32.50000000000002, -50.00000000000044, 17.499999999999808, 46.099999999999994, -50.00000000000044, 17.099999999999802, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, 44.900000000000006, 23.699999999999896, 24.69999999999991, 41.30000000000001, -50.00000000000044, 43.30000000000001, 46.5, 31.900000000000013, 42.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 43.7, 42.900000000000006, 29.299999999999976, 43.900000000000006, 44.5, -50.00000000000044, 34.10000000000004, 45.7, 41.30000000000001, -50.00000000000044, 41.500000000000014, 45.5, 39.70000000000002, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 366, 500, 124, 42, 62, 500, 58, 64, 44, 34, 36, 500, 38, 68, 58, 70, 46, 500, 52, 50, 104, 58, 500, 500, 36, 90, 500, 146, 500, 34, 162, 500, 500, 32, 232, 48, 34, 500, 500, 500, 398, 190, 500, 38, 70, 36, 330, 30, 500, 88, 500, 60, 166, 500, 500, 500, 500, 500, 500, 26, 176, 500, 326, 40, 500, 330, 500, 272, 500, 500, 52, 264, 254, 88, 500, 68, 36, 182, 72, 48, 500, 500, 64, 72, 208, 62, 56, 500, 160, 44, 88, 500, 86, 46, 104, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39522381831333475, "mean_inference_ms": 1.2529227774516025, "mean_action_processing_ms": 0.14844335694628857, "mean_env_wait_ms": 0.08657356641472845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100419044494629, "StateBufferConnector_ms": 0.007993698120117188, "ViewRequirementAgentConnector_ms": 0.12501001358032227}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.244999999999825, "episode_len_mean": 253.18, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, 37.70000000000003, 45.9, 43.900000000000006, -50.00000000000044, 44.300000000000004, 43.7, 45.7, 46.699999999999996, 46.5, -50.00000000000044, 46.3, 43.30000000000001, 44.300000000000004, 43.10000000000001, 45.5, -50.00000000000044, 44.900000000000006, 45.1, 39.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.5, 41.100000000000016, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.699999999999996, 33.90000000000004, -50.00000000000044, -50.00000000000044, 46.9, 26.89999999999994, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.299999999999706, 31.1, -50.00000000000044, 46.3, 43.10000000000001, 46.5, 17.099999999999802, 47.1, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.10000000000001, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 32.50000000000002, -50.00000000000044, 17.499999999999808, 46.099999999999994, -50.00000000000044, 17.099999999999802, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, 44.900000000000006, 23.699999999999896, 24.69999999999991, 41.30000000000001, -50.00000000000044, 43.30000000000001, 46.5, 31.900000000000013, 42.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 43.7, 42.900000000000006, 29.299999999999976, 43.900000000000006, 44.5, -50.00000000000044, 34.10000000000004, 45.7, 41.30000000000001, -50.00000000000044, 41.500000000000014, 45.5, 39.70000000000002, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 366, 500, 124, 42, 62, 500, 58, 64, 44, 34, 36, 500, 38, 68, 58, 70, 46, 500, 52, 50, 104, 58, 500, 500, 36, 90, 500, 146, 500, 34, 162, 500, 500, 32, 232, 48, 34, 500, 500, 500, 398, 190, 500, 38, 70, 36, 330, 30, 500, 88, 500, 60, 166, 500, 500, 500, 500, 500, 500, 26, 176, 500, 326, 40, 500, 330, 500, 272, 500, 500, 52, 264, 254, 88, 500, 68, 36, 182, 72, 48, 500, 500, 64, 72, 208, 62, 56, 500, 160, 44, 88, 500, 86, 46, 104, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39522381831333475, "mean_inference_ms": 1.2529227774516025, "mean_action_processing_ms": 0.14844335694628857, "mean_env_wait_ms": 0.08657356641472845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100419044494629, "StateBufferConnector_ms": 0.007993698120117188, "ViewRequirementAgentConnector_ms": 0.12501001358032227}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5568.442469240701, "num_env_steps_trained_throughput_per_sec": 5568.442469240701, "timesteps_total": 276000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 2246.001, "sample_time_ms": 1992.4, "load_time_ms": 10.7, "load_throughput": 1121516.638, "learn_time_ms": 231.6, "learn_throughput": 51813.413, "synch_weights_time_ms": 10.302}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1022, "training_iteration": 23, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-00", "timestamp": 1698245040, "time_this_iter_s": 2.160001039505005, "time_total_s": 51.49300265312195, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 51.49300265312195, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 60.6, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156258e-08, "cur_lr": 0.0003, "total_loss": 6.863373406728109, "policy_loss": -0.0003103774972259998, "vf_loss": 6.863735898335775, "vf_explained_var": 1.4702479044596355e-07, "kl": 0.0006066800483874127, "entropy": 0.5225363870461782, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.4119999999998285, "episode_len_mean": 256.52, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.10000000000001, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 32.50000000000002, -50.00000000000044, 17.499999999999808, 46.099999999999994, -50.00000000000044, 17.099999999999802, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, 44.900000000000006, 23.699999999999896, 24.69999999999991, 41.30000000000001, -50.00000000000044, 43.30000000000001, 46.5, 31.900000000000013, 42.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 43.7, 42.900000000000006, 29.299999999999976, 43.900000000000006, 44.5, -50.00000000000044, 34.10000000000004, 45.7, 41.30000000000001, -50.00000000000044, 41.500000000000014, 45.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 40.10000000000002, 41.100000000000016, 40.90000000000002, -50.00000000000044, -50.00000000000044, 24.299999999999905, 43.7, -50.00000000000044, 42.500000000000014, 46.5, 46.5, 31.900000000000013, 42.900000000000006, -50.00000000000044, 13.499999999999751, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 33.30000000000003, 45.5, -50.00000000000044, 42.30000000000001, 40.500000000000014, 42.500000000000014, 42.900000000000006, 40.500000000000014, -50.00000000000044, 24.299999999999905, 45.9, 40.90000000000002, 28.29999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, 20.099999999999845, 46.5, 44.300000000000004, 22.099999999999874, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 32.30000000000002, 45.5, 21.499999999999865], "episode_lengths": [30, 500, 88, 500, 60, 166, 500, 500, 500, 500, 500, 500, 26, 176, 500, 326, 40, 500, 330, 500, 272, 500, 500, 52, 264, 254, 88, 500, 68, 36, 182, 72, 48, 500, 500, 64, 72, 208, 62, 56, 500, 160, 44, 88, 500, 86, 46, 104, 500, 500, 500, 54, 100, 90, 92, 500, 500, 258, 64, 500, 76, 36, 36, 182, 72, 500, 366, 500, 80, 500, 54, 500, 168, 46, 500, 78, 96, 76, 72, 96, 500, 258, 42, 92, 218, 58, 500, 500, 300, 36, 58, 280, 500, 500, 40, 500, 500, 178, 46, 286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3956583909690747, "mean_inference_ms": 1.2540646733459702, "mean_action_processing_ms": 0.14819208448298024, "mean_env_wait_ms": 0.08717588477273554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031015634536743164, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.13900518417358398}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.4119999999998285, "episode_len_mean": 256.52, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.10000000000001, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 32.50000000000002, -50.00000000000044, 17.499999999999808, 46.099999999999994, -50.00000000000044, 17.099999999999802, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, 44.900000000000006, 23.699999999999896, 24.69999999999991, 41.30000000000001, -50.00000000000044, 43.30000000000001, 46.5, 31.900000000000013, 42.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 43.7, 42.900000000000006, 29.299999999999976, 43.900000000000006, 44.5, -50.00000000000044, 34.10000000000004, 45.7, 41.30000000000001, -50.00000000000044, 41.500000000000014, 45.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 40.10000000000002, 41.100000000000016, 40.90000000000002, -50.00000000000044, -50.00000000000044, 24.299999999999905, 43.7, -50.00000000000044, 42.500000000000014, 46.5, 46.5, 31.900000000000013, 42.900000000000006, -50.00000000000044, 13.499999999999751, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 33.30000000000003, 45.5, -50.00000000000044, 42.30000000000001, 40.500000000000014, 42.500000000000014, 42.900000000000006, 40.500000000000014, -50.00000000000044, 24.299999999999905, 45.9, 40.90000000000002, 28.29999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, 20.099999999999845, 46.5, 44.300000000000004, 22.099999999999874, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 32.30000000000002, 45.5, 21.499999999999865], "episode_lengths": [30, 500, 88, 500, 60, 166, 500, 500, 500, 500, 500, 500, 26, 176, 500, 326, 40, 500, 330, 500, 272, 500, 500, 52, 264, 254, 88, 500, 68, 36, 182, 72, 48, 500, 500, 64, 72, 208, 62, 56, 500, 160, 44, 88, 500, 86, 46, 104, 500, 500, 500, 54, 100, 90, 92, 500, 500, 258, 64, 500, 76, 36, 36, 182, 72, 500, 366, 500, 80, 500, 54, 500, 168, 46, 500, 78, 96, 76, 72, 96, 500, 258, 42, 92, 218, 58, 500, 500, 300, 36, 58, 280, 500, 500, 40, 500, 500, 178, 46, 286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3956583909690747, "mean_inference_ms": 1.2540646733459702, "mean_action_processing_ms": 0.14819208448298024, "mean_env_wait_ms": 0.08717588477273554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031015634536743164, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.13900518417358398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5288.673855651146, "num_env_steps_trained_throughput_per_sec": 5288.673855651146, "timesteps_total": 288000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 2252.601, "sample_time_ms": 1994.0, "load_time_ms": 11.0, "load_throughput": 1090943.235, "learn_time_ms": 236.3, "learn_throughput": 50782.838, "synch_weights_time_ms": 10.202}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1073, "training_iteration": 24, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-02", "timestamp": 1698245042, "time_this_iter_s": 2.273998975753784, "time_total_s": 53.76700162887573, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 53.76700162887573, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 63.4, "ram_util_percent": 27.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078129e-08, "cur_lr": 0.0003, "total_loss": 6.524311097462972, "policy_loss": -6.975854436556498e-06, "vf_loss": 6.5243657747904455, "vf_explained_var": -2.662340799967448e-07, "kl": 3.146638773614541e-05, "entropy": 0.4771229028701782, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 368.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.304999999999828, "episode_len_mean": 252.58, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, 45.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 40.10000000000002, 41.100000000000016, 40.90000000000002, -50.00000000000044, -50.00000000000044, 24.299999999999905, 43.7, -50.00000000000044, 42.500000000000014, 46.5, 46.5, 31.900000000000013, 42.900000000000006, -50.00000000000044, 13.499999999999751, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 33.30000000000003, 45.5, -50.00000000000044, 42.30000000000001, 40.500000000000014, 42.500000000000014, 42.900000000000006, 40.500000000000014, -50.00000000000044, 24.299999999999905, 45.9, 40.90000000000002, 28.29999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, 20.099999999999845, 46.5, 44.300000000000004, 22.099999999999874, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 32.30000000000002, 45.5, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 38.50000000000003, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.10000000000001, 0.2999999999995637, 38.300000000000026, 39.50000000000002, -50.00000000000044, 45.9, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 46.3, 47.3, -50.00000000000044, 46.3, -50.00000000000044, 42.30000000000001, 46.3, -50.00000000000044, 41.30000000000001, -50.00000000000044, 33.10000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 35.500000000000036, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 44.10000000000001, 47.1, 46.5, -50.00000000000044, 46.699999999999996], "episode_lengths": [86, 46, 104, 500, 500, 500, 54, 100, 90, 92, 500, 500, 258, 64, 500, 76, 36, 36, 182, 72, 500, 366, 500, 80, 500, 54, 500, 168, 46, 500, 78, 96, 76, 72, 96, 500, 258, 42, 92, 218, 58, 500, 500, 300, 36, 58, 280, 500, 500, 40, 500, 500, 178, 46, 286, 500, 500, 500, 96, 116, 500, 108, 500, 70, 498, 118, 106, 500, 42, 500, 36, 500, 500, 500, 252, 38, 28, 500, 38, 500, 78, 38, 500, 88, 500, 170, 500, 72, 500, 56, 146, 52, 500, 32, 500, 60, 30, 36, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3960645384610933, "mean_inference_ms": 1.256229680642398, "mean_action_processing_ms": 0.14809811754940277, "mean_env_wait_ms": 0.08736600857687116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200531005859375, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.11943459510803223}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.304999999999828, "episode_len_mean": 252.58, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, 45.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 40.10000000000002, 41.100000000000016, 40.90000000000002, -50.00000000000044, -50.00000000000044, 24.299999999999905, 43.7, -50.00000000000044, 42.500000000000014, 46.5, 46.5, 31.900000000000013, 42.900000000000006, -50.00000000000044, 13.499999999999751, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 33.30000000000003, 45.5, -50.00000000000044, 42.30000000000001, 40.500000000000014, 42.500000000000014, 42.900000000000006, 40.500000000000014, -50.00000000000044, 24.299999999999905, 45.9, 40.90000000000002, 28.29999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, 20.099999999999845, 46.5, 44.300000000000004, 22.099999999999874, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 32.30000000000002, 45.5, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 38.50000000000003, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.10000000000001, 0.2999999999995637, 38.300000000000026, 39.50000000000002, -50.00000000000044, 45.9, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 46.3, 47.3, -50.00000000000044, 46.3, -50.00000000000044, 42.30000000000001, 46.3, -50.00000000000044, 41.30000000000001, -50.00000000000044, 33.10000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 35.500000000000036, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 44.10000000000001, 47.1, 46.5, -50.00000000000044, 46.699999999999996], "episode_lengths": [86, 46, 104, 500, 500, 500, 54, 100, 90, 92, 500, 500, 258, 64, 500, 76, 36, 36, 182, 72, 500, 366, 500, 80, 500, 54, 500, 168, 46, 500, 78, 96, 76, 72, 96, 500, 258, 42, 92, 218, 58, 500, 500, 300, 36, 58, 280, 500, 500, 40, 500, 500, 178, 46, 286, 500, 500, 500, 96, 116, 500, 108, 500, 70, 498, 118, 106, 500, 42, 500, 36, 500, 500, 500, 252, 38, 28, 500, 38, 500, 78, 38, 500, 88, 500, 170, 500, 72, 500, 56, 146, 52, 500, 32, 500, 60, 30, 36, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3960645384610933, "mean_inference_ms": 1.256229680642398, "mean_action_processing_ms": 0.14809811754940277, "mean_env_wait_ms": 0.08736600857687116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200531005859375, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.11943459510803223}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4834.808095238278, "num_env_steps_trained_throughput_per_sec": 4834.808095238278, "timesteps_total": 300000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 2267.901, "sample_time_ms": 1994.7, "load_time_ms": 11.2, "load_throughput": 1071458.332, "learn_time_ms": 250.8, "learn_throughput": 47846.856, "synch_weights_time_ms": 10.102}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 1118, "training_iteration": 25, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-04", "timestamp": 1698245044, "time_this_iter_s": 2.486999988555908, "time_total_s": 56.25400161743164, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 56.25400161743164, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 59.6, "ram_util_percent": 27.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.9604644775390645e-09, "cur_lr": 0.0003, "total_loss": 6.022162532806396, "policy_loss": -0.0002473111574848493, "vf_loss": 6.0224533398946125, "vf_explained_var": -1.4662742614746095e-06, "kl": 0.0002310189828193643, "entropy": 0.435822602113088, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.288999999999814, "episode_len_mean": 262.74, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.099999999999845, 46.5, 44.300000000000004, 22.099999999999874, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 32.30000000000002, 45.5, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 38.50000000000003, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.10000000000001, 0.2999999999995637, 38.300000000000026, 39.50000000000002, -50.00000000000044, 45.9, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 46.3, 47.3, -50.00000000000044, 46.3, -50.00000000000044, 42.30000000000001, 46.3, -50.00000000000044, 41.30000000000001, -50.00000000000044, 33.10000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 35.500000000000036, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 44.10000000000001, 47.1, 46.5, -50.00000000000044, 46.699999999999996, 36.50000000000003, -50.00000000000044, 44.10000000000001, 47.7, -50.00000000000044, 26.69999999999994, 38.700000000000024, -50.00000000000044, 43.900000000000006, 20.299999999999848, 45.9, 2.499999999999595, -50.00000000000044, 16.499999999999794, 25.699999999999925, 44.5, 45.9, 45.9, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, 47.5, 35.10000000000004, -50.00000000000044, 36.30000000000003, 39.70000000000002, 45.1, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 2.299999999999592, -50.00000000000044, 39.90000000000002, 44.300000000000004, 46.9, 19.09999999999983], "episode_lengths": [500, 300, 36, 58, 280, 500, 500, 40, 500, 500, 178, 46, 286, 500, 500, 500, 96, 116, 500, 108, 500, 70, 498, 118, 106, 500, 42, 500, 36, 500, 500, 500, 252, 38, 28, 500, 38, 500, 78, 38, 500, 88, 500, 170, 500, 72, 500, 56, 146, 52, 500, 32, 500, 60, 30, 36, 500, 34, 136, 500, 60, 24, 500, 234, 114, 500, 62, 298, 42, 476, 500, 336, 244, 56, 42, 42, 500, 28, 500, 500, 104, 26, 150, 500, 138, 104, 50, 500, 270, 500, 500, 500, 56, 40, 478, 500, 102, 58, 32, 310]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39626344053977336, "mean_inference_ms": 1.259150459912279, "mean_action_processing_ms": 0.1484688783570255, "mean_env_wait_ms": 0.08725627353048844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799677848815918, "StateBufferConnector_ms": 0.009000301361083984, "ViewRequirementAgentConnector_ms": 0.11944818496704102}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.288999999999814, "episode_len_mean": 262.74, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.099999999999845, 46.5, 44.300000000000004, 22.099999999999874, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 32.30000000000002, 45.5, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 38.50000000000003, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.10000000000001, 0.2999999999995637, 38.300000000000026, 39.50000000000002, -50.00000000000044, 45.9, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 46.3, 47.3, -50.00000000000044, 46.3, -50.00000000000044, 42.30000000000001, 46.3, -50.00000000000044, 41.30000000000001, -50.00000000000044, 33.10000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 35.500000000000036, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 44.10000000000001, 47.1, 46.5, -50.00000000000044, 46.699999999999996, 36.50000000000003, -50.00000000000044, 44.10000000000001, 47.7, -50.00000000000044, 26.69999999999994, 38.700000000000024, -50.00000000000044, 43.900000000000006, 20.299999999999848, 45.9, 2.499999999999595, -50.00000000000044, 16.499999999999794, 25.699999999999925, 44.5, 45.9, 45.9, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, 47.5, 35.10000000000004, -50.00000000000044, 36.30000000000003, 39.70000000000002, 45.1, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 2.299999999999592, -50.00000000000044, 39.90000000000002, 44.300000000000004, 46.9, 19.09999999999983], "episode_lengths": [500, 300, 36, 58, 280, 500, 500, 40, 500, 500, 178, 46, 286, 500, 500, 500, 96, 116, 500, 108, 500, 70, 498, 118, 106, 500, 42, 500, 36, 500, 500, 500, 252, 38, 28, 500, 38, 500, 78, 38, 500, 88, 500, 170, 500, 72, 500, 56, 146, 52, 500, 32, 500, 60, 30, 36, 500, 34, 136, 500, 60, 24, 500, 234, 114, 500, 62, 298, 42, 476, 500, 336, 244, 56, 42, 42, 500, 28, 500, 500, 104, 26, 150, 500, 138, 104, 50, 500, 270, 500, 500, 500, 56, 40, 478, 500, 102, 58, 32, 310]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39626344053977336, "mean_inference_ms": 1.259150459912279, "mean_action_processing_ms": 0.1484688783570255, "mean_env_wait_ms": 0.08725627353048844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799677848815918, "StateBufferConnector_ms": 0.009000301361083984, "ViewRequirementAgentConnector_ms": 0.11944818496704102}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5244.74680206486, "num_env_steps_trained_throughput_per_sec": 5244.74680206486, "timesteps_total": 312000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 2276.501, "sample_time_ms": 2001.3, "load_time_ms": 11.3, "load_throughput": 1061952.173, "learn_time_ms": 252.9, "learn_throughput": 47449.597, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 1160, "training_iteration": 26, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-07", "timestamp": 1698245047, "time_this_iter_s": 2.2939987182617188, "time_total_s": 58.54800033569336, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 58.54800033569336, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 64.06666666666666, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9802322387695322e-09, "cur_lr": 0.0003, "total_loss": 7.0259397506713865, "policy_loss": 9.812383602062862e-05, "vf_loss": 7.025888824462891, "vf_explained_var": -1.3271967569986979e-06, "kl": 5.5122608667564536e-05, "entropy": 0.4719940523306529, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 398.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.614999999999846, "episode_len_mean": 229.56, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 26.69999999999994, 38.700000000000024, -50.00000000000044, 43.900000000000006, 20.299999999999848, 45.9, 2.499999999999595, -50.00000000000044, 16.499999999999794, 25.699999999999925, 44.5, 45.9, 45.9, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, 47.5, 35.10000000000004, -50.00000000000044, 36.30000000000003, 39.70000000000002, 45.1, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 2.299999999999592, -50.00000000000044, 39.90000000000002, 44.300000000000004, 46.9, 19.09999999999983, -50.00000000000044, 45.9, 42.900000000000006, -50.00000000000044, 46.699999999999996, 46.5, 36.900000000000034, -50.00000000000044, 43.50000000000001, 46.5, -50.00000000000044, 47.1, 45.3, 0.09999999999956088, 44.7, 44.10000000000001, 46.3, 26.499999999999936, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 46.699999999999996, 31.900000000000013, 47.1, -50.00000000000044, 31.1, 39.10000000000002, -50.00000000000044, 46.099999999999994, 40.500000000000014, 43.30000000000001, 45.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 12.299999999999734, 42.900000000000006, 43.50000000000001, 47.7, 41.500000000000014, 46.9, -50.00000000000044, 45.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 38.50000000000003, 3.0999999999996035, 23.099999999999888, -50.00000000000044, 43.30000000000001, 32.30000000000002, 43.900000000000006, 45.7, 46.699999999999996, 43.30000000000001, 46.099999999999994], "episode_lengths": [500, 234, 114, 500, 62, 298, 42, 476, 500, 336, 244, 56, 42, 42, 500, 28, 500, 500, 104, 26, 150, 500, 138, 104, 50, 500, 270, 500, 500, 500, 56, 40, 478, 500, 102, 58, 32, 310, 500, 42, 72, 500, 34, 36, 132, 500, 66, 36, 500, 30, 48, 500, 54, 60, 38, 236, 40, 500, 500, 46, 34, 182, 30, 500, 190, 110, 500, 40, 96, 68, 42, 500, 500, 42, 500, 378, 72, 66, 24, 86, 32, 500, 46, 96, 500, 500, 500, 110, 500, 116, 470, 270, 500, 68, 178, 62, 44, 34, 68, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39782894266656016, "mean_inference_ms": 1.2645420752840215, "mean_action_processing_ms": 0.1492137892245747, "mean_env_wait_ms": 0.0879726989771177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027001619338989258, "StateBufferConnector_ms": 0.00900125503540039, "ViewRequirementAgentConnector_ms": 0.15001225471496582}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.614999999999846, "episode_len_mean": 229.56, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 26.69999999999994, 38.700000000000024, -50.00000000000044, 43.900000000000006, 20.299999999999848, 45.9, 2.499999999999595, -50.00000000000044, 16.499999999999794, 25.699999999999925, 44.5, 45.9, 45.9, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, 47.5, 35.10000000000004, -50.00000000000044, 36.30000000000003, 39.70000000000002, 45.1, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 2.299999999999592, -50.00000000000044, 39.90000000000002, 44.300000000000004, 46.9, 19.09999999999983, -50.00000000000044, 45.9, 42.900000000000006, -50.00000000000044, 46.699999999999996, 46.5, 36.900000000000034, -50.00000000000044, 43.50000000000001, 46.5, -50.00000000000044, 47.1, 45.3, 0.09999999999956088, 44.7, 44.10000000000001, 46.3, 26.499999999999936, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 46.699999999999996, 31.900000000000013, 47.1, -50.00000000000044, 31.1, 39.10000000000002, -50.00000000000044, 46.099999999999994, 40.500000000000014, 43.30000000000001, 45.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 12.299999999999734, 42.900000000000006, 43.50000000000001, 47.7, 41.500000000000014, 46.9, -50.00000000000044, 45.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 38.50000000000003, 3.0999999999996035, 23.099999999999888, -50.00000000000044, 43.30000000000001, 32.30000000000002, 43.900000000000006, 45.7, 46.699999999999996, 43.30000000000001, 46.099999999999994], "episode_lengths": [500, 234, 114, 500, 62, 298, 42, 476, 500, 336, 244, 56, 42, 42, 500, 28, 500, 500, 104, 26, 150, 500, 138, 104, 50, 500, 270, 500, 500, 500, 56, 40, 478, 500, 102, 58, 32, 310, 500, 42, 72, 500, 34, 36, 132, 500, 66, 36, 500, 30, 48, 500, 54, 60, 38, 236, 40, 500, 500, 46, 34, 182, 30, 500, 190, 110, 500, 40, 96, 68, 42, 500, 500, 42, 500, 378, 72, 66, 24, 86, 32, 500, 46, 96, 500, 500, 500, 110, 500, 116, 470, 270, 500, 68, 178, 62, 44, 34, 68, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39782894266656016, "mean_inference_ms": 1.2645420752840215, "mean_action_processing_ms": 0.1492137892245747, "mean_env_wait_ms": 0.0879726989771177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027001619338989258, "StateBufferConnector_ms": 0.00900125503540039, "ViewRequirementAgentConnector_ms": 0.15001225471496582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4761.903896894201, "num_env_steps_trained_throughput_per_sec": 4761.903896894201, "timesteps_total": 324000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 2296.201, "sample_time_ms": 2031.6, "load_time_ms": 10.9, "load_throughput": 1100917.759, "learn_time_ms": 242.5, "learn_throughput": 49484.552, "synch_weights_time_ms": 10.002}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1222, "training_iteration": 27, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-09", "timestamp": 1698245049, "time_this_iter_s": 2.5259993076324463, "time_total_s": 61.073999643325806, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 61.073999643325806, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 68.05000000000001, "ram_util_percent": 27.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4901161193847661e-09, "cur_lr": 0.0003, "total_loss": 6.479111099243164, "policy_loss": -0.0002712202568848928, "vf_loss": 6.47942419052124, "vf_explained_var": -1.6689300537109375e-06, "kl": 0.00017238784156248244, "entropy": 0.4184438645839691, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 413.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.722999999999821, "episode_len_mean": 248.4, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 46.5, 36.900000000000034, -50.00000000000044, 43.50000000000001, 46.5, -50.00000000000044, 47.1, 45.3, 0.09999999999956088, 44.7, 44.10000000000001, 46.3, 26.499999999999936, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 46.699999999999996, 31.900000000000013, 47.1, -50.00000000000044, 31.1, 39.10000000000002, -50.00000000000044, 46.099999999999994, 40.500000000000014, 43.30000000000001, 45.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 12.299999999999734, 42.900000000000006, 43.50000000000001, 47.7, 41.500000000000014, 46.9, -50.00000000000044, 45.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 38.50000000000003, 3.0999999999996035, 23.099999999999888, -50.00000000000044, 43.30000000000001, 32.30000000000002, 43.900000000000006, 45.7, 46.699999999999996, 43.30000000000001, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, 44.10000000000001, 37.50000000000003, -50.00000000000044, 45.7, 47.3, -50.00000000000044, 46.5, 18.899999999999828, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.7, 47.5, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.900000000000006, 45.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001], "episode_lengths": [34, 36, 132, 500, 66, 36, 500, 30, 48, 500, 54, 60, 38, 236, 40, 500, 500, 46, 34, 182, 30, 500, 190, 110, 500, 40, 96, 68, 42, 500, 500, 42, 500, 378, 72, 66, 24, 86, 32, 500, 46, 96, 500, 500, 500, 110, 500, 116, 470, 270, 500, 68, 178, 62, 44, 34, 68, 40, 500, 40, 500, 500, 500, 500, 500, 366, 60, 126, 500, 44, 28, 500, 36, 312, 500, 500, 290, 500, 72, 500, 500, 500, 50, 500, 44, 26, 44, 500, 58, 500, 500, 500, 500, 56, 52, 48, 72, 500, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3996254341568597, "mean_inference_ms": 1.2679209969691951, "mean_action_processing_ms": 0.15017530448303112, "mean_env_wait_ms": 0.08833129192145256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029003620147705078, "StateBufferConnector_ms": 0.008002042770385742, "ViewRequirementAgentConnector_ms": 0.16901326179504395}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.722999999999821, "episode_len_mean": 248.4, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 46.5, 36.900000000000034, -50.00000000000044, 43.50000000000001, 46.5, -50.00000000000044, 47.1, 45.3, 0.09999999999956088, 44.7, 44.10000000000001, 46.3, 26.499999999999936, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 46.699999999999996, 31.900000000000013, 47.1, -50.00000000000044, 31.1, 39.10000000000002, -50.00000000000044, 46.099999999999994, 40.500000000000014, 43.30000000000001, 45.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 12.299999999999734, 42.900000000000006, 43.50000000000001, 47.7, 41.500000000000014, 46.9, -50.00000000000044, 45.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 38.50000000000003, 3.0999999999996035, 23.099999999999888, -50.00000000000044, 43.30000000000001, 32.30000000000002, 43.900000000000006, 45.7, 46.699999999999996, 43.30000000000001, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, 44.10000000000001, 37.50000000000003, -50.00000000000044, 45.7, 47.3, -50.00000000000044, 46.5, 18.899999999999828, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.7, 47.5, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.900000000000006, 45.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001], "episode_lengths": [34, 36, 132, 500, 66, 36, 500, 30, 48, 500, 54, 60, 38, 236, 40, 500, 500, 46, 34, 182, 30, 500, 190, 110, 500, 40, 96, 68, 42, 500, 500, 42, 500, 378, 72, 66, 24, 86, 32, 500, 46, 96, 500, 500, 500, 110, 500, 116, 470, 270, 500, 68, 178, 62, 44, 34, 68, 40, 500, 40, 500, 500, 500, 500, 500, 366, 60, 126, 500, 44, 28, 500, 36, 312, 500, 500, 290, 500, 72, 500, 500, 500, 50, 500, 44, 26, 44, 500, 58, 500, 500, 500, 500, 56, 52, 48, 72, 500, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3996254341568597, "mean_inference_ms": 1.2679209969691951, "mean_action_processing_ms": 0.15017530448303112, "mean_env_wait_ms": 0.08833129192145256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029003620147705078, "StateBufferConnector_ms": 0.008002042770385742, "ViewRequirementAgentConnector_ms": 0.16901326179504395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4739.33324764583, "num_env_steps_trained_throughput_per_sec": 4739.33324764583, "timesteps_total": 336000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 2339.301, "sample_time_ms": 2054.2, "load_time_ms": 12.0, "load_throughput": 999989.033, "learn_time_ms": 261.9, "learn_throughput": 45819.045, "synch_weights_time_ms": 10.002}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 1264, "training_iteration": 28, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-12", "timestamp": 1698245052, "time_this_iter_s": 2.537001609802246, "time_total_s": 63.61100125312805, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 63.61100125312805, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 71.56666666666666, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.450580596923831e-10, "cur_lr": 0.0003, "total_loss": 6.1218962987264, "policy_loss": -0.00017587319016456603, "vf_loss": 6.122118377685547, "vf_explained_var": -5.245208740234375e-07, "kl": 0.00032444409338647044, "entropy": 0.46333614786465965, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 428.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.788000000000215, "episode_len_mean": 288.42, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 45.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 38.50000000000003, 3.0999999999996035, 23.099999999999888, -50.00000000000044, 43.30000000000001, 32.30000000000002, 43.900000000000006, 45.7, 46.699999999999996, 43.30000000000001, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, 44.10000000000001, 37.50000000000003, -50.00000000000044, 45.7, 47.3, -50.00000000000044, 46.5, 18.899999999999828, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.7, 47.5, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.900000000000006, 45.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 25.899999999999928, 34.70000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 39.90000000000002, 45.5, 31.900000000000013, -50.00000000000044, 29.899999999999984, -50.00000000000044, 43.7, 34.10000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 45.1, 46.3, 10.899999999999714, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [32, 500, 46, 96, 500, 500, 500, 110, 500, 116, 470, 270, 500, 68, 178, 62, 44, 34, 68, 40, 500, 40, 500, 500, 500, 500, 500, 366, 60, 126, 500, 44, 28, 500, 36, 312, 500, 500, 290, 500, 72, 500, 500, 500, 50, 500, 44, 26, 44, 500, 58, 500, 500, 500, 500, 56, 52, 48, 72, 500, 500, 66, 242, 154, 500, 68, 500, 500, 500, 208, 102, 46, 182, 500, 202, 500, 64, 160, 500, 36, 500, 500, 500, 54, 500, 500, 40, 62, 500, 50, 38, 392, 500, 500, 100, 500, 56, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4008547622140992, "mean_inference_ms": 1.2716170910602262, "mean_action_processing_ms": 0.151196158208272, "mean_env_wait_ms": 0.08868559847622175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099989891052246, "StateBufferConnector_ms": 0.010999917984008789, "ViewRequirementAgentConnector_ms": 0.16100764274597168}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.788000000000215, "episode_len_mean": 288.42, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 45.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 38.50000000000003, 3.0999999999996035, 23.099999999999888, -50.00000000000044, 43.30000000000001, 32.30000000000002, 43.900000000000006, 45.7, 46.699999999999996, 43.30000000000001, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, 44.10000000000001, 37.50000000000003, -50.00000000000044, 45.7, 47.3, -50.00000000000044, 46.5, 18.899999999999828, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.7, 47.5, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.900000000000006, 45.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 25.899999999999928, 34.70000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 39.90000000000002, 45.5, 31.900000000000013, -50.00000000000044, 29.899999999999984, -50.00000000000044, 43.7, 34.10000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 45.1, 46.3, 10.899999999999714, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [32, 500, 46, 96, 500, 500, 500, 110, 500, 116, 470, 270, 500, 68, 178, 62, 44, 34, 68, 40, 500, 40, 500, 500, 500, 500, 500, 366, 60, 126, 500, 44, 28, 500, 36, 312, 500, 500, 290, 500, 72, 500, 500, 500, 50, 500, 44, 26, 44, 500, 58, 500, 500, 500, 500, 56, 52, 48, 72, 500, 500, 66, 242, 154, 500, 68, 500, 500, 500, 208, 102, 46, 182, 500, 202, 500, 64, 160, 500, 36, 500, 500, 500, 54, 500, 500, 40, 62, 500, 50, 38, 392, 500, 500, 100, 500, 56, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4008547622140992, "mean_inference_ms": 1.2716170910602262, "mean_action_processing_ms": 0.151196158208272, "mean_env_wait_ms": 0.08868559847622175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099989891052246, "StateBufferConnector_ms": 0.010999917984008789, "ViewRequirementAgentConnector_ms": 0.16100764274597168}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5033.558424268778, "num_env_steps_trained_throughput_per_sec": 5033.558424268778, "timesteps_total": 348000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 2342.201, "sample_time_ms": 2072.1, "load_time_ms": 11.6, "load_throughput": 1034453.554, "learn_time_ms": 247.5, "learn_throughput": 48484.92, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 1302, "training_iteration": 29, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-14", "timestamp": 1698245054, "time_this_iter_s": 2.3889997005462646, "time_total_s": 66.00000095367432, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 66.00000095367432, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 66.225, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7252902984619153e-10, "cur_lr": 0.0003, "total_loss": 6.9747364044189455, "policy_loss": -0.0005350371201833089, "vf_loss": 6.9753190040588375, "vf_explained_var": 1.0728836059570313e-07, "kl": 0.0005856215706785406, "entropy": 0.4777069369951884, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 443.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.513999999999815, "episode_len_mean": 265.46, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.900000000000006, 45.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 25.899999999999928, 34.70000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 39.90000000000002, 45.5, 31.900000000000013, -50.00000000000044, 29.899999999999984, -50.00000000000044, 43.7, 34.10000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 45.1, 46.3, 10.899999999999714, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 22.099999999999874, 22.099999999999874, 45.9, 31.300000000000004, 45.1, 46.3, 47.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, 44.7, 45.3, 45.9, 45.9, 40.30000000000002, -50.00000000000044, 38.700000000000024, 47.1, -50.00000000000044, 39.300000000000026, -50.00000000000044, 33.500000000000036, 22.699999999999882, 44.5, 43.900000000000006, -50.00000000000044, 45.1, 10.699999999999712, 34.50000000000004, 42.10000000000001, 39.300000000000026, 7.499999999999666, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 500, 500, 56, 52, 48, 72, 500, 500, 66, 242, 154, 500, 68, 500, 500, 500, 208, 102, 46, 182, 500, 202, 500, 64, 160, 500, 36, 500, 500, 500, 54, 500, 500, 40, 62, 500, 50, 38, 392, 500, 500, 100, 500, 56, 500, 62, 500, 280, 280, 42, 188, 50, 38, 26, 54, 500, 500, 500, 104, 64, 54, 48, 42, 42, 98, 500, 114, 30, 500, 108, 500, 166, 274, 56, 62, 500, 50, 394, 156, 80, 108, 426, 500, 62, 38, 500, 176, 500, 500, 34, 500, 48, 500, 500, 500, 84, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021061472351735, "mean_inference_ms": 1.2763588324912656, "mean_action_processing_ms": 0.15098059751175533, "mean_env_wait_ms": 0.08938265964433305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699422836303711, "StateBufferConnector_ms": 0.011995315551757812, "ViewRequirementAgentConnector_ms": 0.14498519897460938}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.513999999999815, "episode_len_mean": 265.46, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.900000000000006, 45.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 25.899999999999928, 34.70000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 39.90000000000002, 45.5, 31.900000000000013, -50.00000000000044, 29.899999999999984, -50.00000000000044, 43.7, 34.10000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 45.1, 46.3, 10.899999999999714, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 22.099999999999874, 22.099999999999874, 45.9, 31.300000000000004, 45.1, 46.3, 47.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, 44.7, 45.3, 45.9, 45.9, 40.30000000000002, -50.00000000000044, 38.700000000000024, 47.1, -50.00000000000044, 39.300000000000026, -50.00000000000044, 33.500000000000036, 22.699999999999882, 44.5, 43.900000000000006, -50.00000000000044, 45.1, 10.699999999999712, 34.50000000000004, 42.10000000000001, 39.300000000000026, 7.499999999999666, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 500, 500, 56, 52, 48, 72, 500, 500, 66, 242, 154, 500, 68, 500, 500, 500, 208, 102, 46, 182, 500, 202, 500, 64, 160, 500, 36, 500, 500, 500, 54, 500, 500, 40, 62, 500, 50, 38, 392, 500, 500, 100, 500, 56, 500, 62, 500, 280, 280, 42, 188, 50, 38, 26, 54, 500, 500, 500, 104, 64, 54, 48, 42, 42, 98, 500, 114, 30, 500, 108, 500, 166, 274, 56, 62, 500, 50, 394, 156, 80, 108, 426, 500, 62, 38, 500, 176, 500, 500, 34, 500, 48, 500, 500, 500, 84, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021061472351735, "mean_inference_ms": 1.2763588324912656, "mean_action_processing_ms": 0.15098059751175533, "mean_env_wait_ms": 0.08938265964433305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699422836303711, "StateBufferConnector_ms": 0.011995315551757812, "ViewRequirementAgentConnector_ms": 0.14498519897460938}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5221.93460272785, "num_env_steps_trained_throughput_per_sec": 5221.93460272785, "timesteps_total": 360000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 2343.601, "sample_time_ms": 2068.5, "load_time_ms": 11.0, "load_throughput": 1090888.851, "learn_time_ms": 253.5, "learn_throughput": 47337.325, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1354, "training_iteration": 30, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-17", "timestamp": 1698245057, "time_this_iter_s": 2.3040008544921875, "time_total_s": 68.3040018081665, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.3040018081665, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 64.13333333333334, "ram_util_percent": 27.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309577e-10, "cur_lr": 0.0003, "total_loss": 6.948343435923259, "policy_loss": -0.00019619762897491456, "vf_loss": 6.948590087890625, "vf_explained_var": -1.8477439880371094e-06, "kl": 0.00046313141431255647, "entropy": 0.5051376720269521, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 458.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.302999999999821, "episode_len_mean": 262.62, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 22.099999999999874, 22.099999999999874, 45.9, 31.300000000000004, 45.1, 46.3, 47.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, 44.7, 45.3, 45.9, 45.9, 40.30000000000002, -50.00000000000044, 38.700000000000024, 47.1, -50.00000000000044, 39.300000000000026, -50.00000000000044, 33.500000000000036, 22.699999999999882, 44.5, 43.900000000000006, -50.00000000000044, 45.1, 10.699999999999712, 34.50000000000004, 42.10000000000001, 39.300000000000026, 7.499999999999666, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 4.499999999999623, -50.00000000000044, 35.70000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.10000000000002, 26.499999999999936, 37.70000000000003, 36.50000000000003, 46.3, 36.900000000000034, 23.8999999999999, 9.8999999999997, -50.00000000000044, 39.300000000000026, 11.499999999999723, -50.00000000000044, 40.30000000000002, 46.099999999999994, 43.10000000000001, 16.29999999999979, 29.299999999999976, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 0.2999999999995637, 43.900000000000006, 37.50000000000003, 46.3, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.7], "episode_lengths": [500, 100, 500, 56, 500, 62, 500, 280, 280, 42, 188, 50, 38, 26, 54, 500, 500, 500, 104, 64, 54, 48, 42, 42, 98, 500, 114, 30, 500, 108, 500, 166, 274, 56, 62, 500, 50, 394, 156, 80, 108, 426, 500, 62, 38, 500, 176, 500, 500, 34, 500, 48, 500, 500, 500, 84, 500, 58, 500, 456, 500, 144, 500, 58, 500, 100, 236, 124, 136, 38, 132, 262, 402, 500, 108, 386, 500, 98, 40, 70, 338, 208, 250, 500, 500, 500, 144, 500, 498, 62, 126, 38, 30, 500, 500, 500, 500, 82, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4020568159389113, "mean_inference_ms": 1.2768041240054004, "mean_action_processing_ms": 0.15106919086871975, "mean_env_wait_ms": 0.08921400303389401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000219345092773, "StateBufferConnector_ms": 0.007995128631591797, "ViewRequirementAgentConnector_ms": 0.1279773712158203}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.302999999999821, "episode_len_mean": 262.62, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 22.099999999999874, 22.099999999999874, 45.9, 31.300000000000004, 45.1, 46.3, 47.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, 44.7, 45.3, 45.9, 45.9, 40.30000000000002, -50.00000000000044, 38.700000000000024, 47.1, -50.00000000000044, 39.300000000000026, -50.00000000000044, 33.500000000000036, 22.699999999999882, 44.5, 43.900000000000006, -50.00000000000044, 45.1, 10.699999999999712, 34.50000000000004, 42.10000000000001, 39.300000000000026, 7.499999999999666, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 4.499999999999623, -50.00000000000044, 35.70000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.10000000000002, 26.499999999999936, 37.70000000000003, 36.50000000000003, 46.3, 36.900000000000034, 23.8999999999999, 9.8999999999997, -50.00000000000044, 39.300000000000026, 11.499999999999723, -50.00000000000044, 40.30000000000002, 46.099999999999994, 43.10000000000001, 16.29999999999979, 29.299999999999976, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 0.2999999999995637, 43.900000000000006, 37.50000000000003, 46.3, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.7], "episode_lengths": [500, 100, 500, 56, 500, 62, 500, 280, 280, 42, 188, 50, 38, 26, 54, 500, 500, 500, 104, 64, 54, 48, 42, 42, 98, 500, 114, 30, 500, 108, 500, 166, 274, 56, 62, 500, 50, 394, 156, 80, 108, 426, 500, 62, 38, 500, 176, 500, 500, 34, 500, 48, 500, 500, 500, 84, 500, 58, 500, 456, 500, 144, 500, 58, 500, 100, 236, 124, 136, 38, 132, 262, 402, 500, 108, 386, 500, 98, 40, 70, 338, 208, 250, 500, 500, 500, 144, 500, 498, 62, 126, 38, 30, 500, 500, 500, 500, 82, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4020568159389113, "mean_inference_ms": 1.2768041240054004, "mean_action_processing_ms": 0.15106919086871975, "mean_env_wait_ms": 0.08921400303389401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000219345092773, "StateBufferConnector_ms": 0.007995128631591797, "ViewRequirementAgentConnector_ms": 0.1279773712158203}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5617.971473069166, "num_env_steps_trained_throughput_per_sec": 5617.971473069166, "timesteps_total": 372000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 2336.301, "sample_time_ms": 2067.3, "load_time_ms": 10.9, "load_throughput": 1100905.718, "learn_time_ms": 247.5, "learn_throughput": 48484.883, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 1395, "training_iteration": 31, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-19", "timestamp": 1698245059, "time_this_iter_s": 2.1409995555877686, "time_total_s": 70.44500136375427, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 70.44500136375427, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 60.699999999999996, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154788e-11, "cur_lr": 0.0003, "total_loss": 6.327063528696696, "policy_loss": 1.4693538347880046e-05, "vf_loss": 6.327096970876058, "vf_explained_var": -4.3710072835286457e-07, "kl": 7.644962208435876e-05, "entropy": 0.48032239874204, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.808000000000211, "episode_len_mean": 298.66, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.699999999999712, 34.50000000000004, 42.10000000000001, 39.300000000000026, 7.499999999999666, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 4.499999999999623, -50.00000000000044, 35.70000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.10000000000002, 26.499999999999936, 37.70000000000003, 36.50000000000003, 46.3, 36.900000000000034, 23.8999999999999, 9.8999999999997, -50.00000000000044, 39.300000000000026, 11.499999999999723, -50.00000000000044, 40.30000000000002, 46.099999999999994, 43.10000000000001, 16.29999999999979, 29.299999999999976, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 0.2999999999995637, 43.900000000000006, 37.50000000000003, 46.3, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 41.90000000000001, -50.00000000000044, 41.100000000000016, 38.10000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 33.30000000000003, 22.299999999999876, 40.70000000000002, 0.49999999999956657, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 34.10000000000004, 38.300000000000026, 39.70000000000002, -50.00000000000044, -50.00000000000044, 32.30000000000002], "episode_lengths": [394, 156, 80, 108, 426, 500, 62, 38, 500, 176, 500, 500, 34, 500, 48, 500, 500, 500, 84, 500, 58, 500, 456, 500, 144, 500, 58, 500, 100, 236, 124, 136, 38, 132, 262, 402, 500, 108, 386, 500, 98, 40, 70, 338, 208, 250, 500, 500, 500, 144, 500, 498, 62, 126, 38, 30, 500, 500, 500, 500, 82, 500, 44, 500, 34, 500, 500, 56, 40, 82, 500, 90, 120, 500, 74, 500, 168, 278, 94, 496, 212, 500, 500, 500, 82, 500, 500, 94, 500, 500, 500, 112, 500, 500, 160, 118, 104, 500, 500, 178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4015986706694939, "mean_inference_ms": 1.276806973309103, "mean_action_processing_ms": 0.15116905756585455, "mean_env_wait_ms": 0.0888866811158416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700662612915039, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.12098479270935059}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.808000000000211, "episode_len_mean": 298.66, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.699999999999712, 34.50000000000004, 42.10000000000001, 39.300000000000026, 7.499999999999666, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 4.499999999999623, -50.00000000000044, 35.70000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.10000000000002, 26.499999999999936, 37.70000000000003, 36.50000000000003, 46.3, 36.900000000000034, 23.8999999999999, 9.8999999999997, -50.00000000000044, 39.300000000000026, 11.499999999999723, -50.00000000000044, 40.30000000000002, 46.099999999999994, 43.10000000000001, 16.29999999999979, 29.299999999999976, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 0.2999999999995637, 43.900000000000006, 37.50000000000003, 46.3, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 41.90000000000001, -50.00000000000044, 41.100000000000016, 38.10000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 33.30000000000003, 22.299999999999876, 40.70000000000002, 0.49999999999956657, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 34.10000000000004, 38.300000000000026, 39.70000000000002, -50.00000000000044, -50.00000000000044, 32.30000000000002], "episode_lengths": [394, 156, 80, 108, 426, 500, 62, 38, 500, 176, 500, 500, 34, 500, 48, 500, 500, 500, 84, 500, 58, 500, 456, 500, 144, 500, 58, 500, 100, 236, 124, 136, 38, 132, 262, 402, 500, 108, 386, 500, 98, 40, 70, 338, 208, 250, 500, 500, 500, 144, 500, 498, 62, 126, 38, 30, 500, 500, 500, 500, 82, 500, 44, 500, 34, 500, 500, 56, 40, 82, 500, 90, 120, 500, 74, 500, 168, 278, 94, 496, 212, 500, 500, 500, 82, 500, 500, 94, 500, 500, 500, 112, 500, 500, 160, 118, 104, 500, 500, 178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4015986706694939, "mean_inference_ms": 1.276806973309103, "mean_action_processing_ms": 0.15116905756585455, "mean_env_wait_ms": 0.0888866811158416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700662612915039, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.12098479270935059}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5400.540916261416, "num_env_steps_trained_throughput_per_sec": 5400.540916261416, "timesteps_total": 384000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 2328.601, "sample_time_ms": 2067.5, "load_time_ms": 10.5, "load_throughput": 1142854.34, "learn_time_ms": 240.2, "learn_throughput": 49958.404, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 1432, "training_iteration": 32, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-21", "timestamp": 1698245061, "time_this_iter_s": 2.2269997596740723, "time_total_s": 72.67200112342834, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 72.67200112342834, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 64.13333333333333, "ram_util_percent": 27.366666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.656612873077394e-11, "cur_lr": 0.0003, "total_loss": 6.762274424235026, "policy_loss": 7.986028989156086e-06, "vf_loss": 6.762315940856934, "vf_explained_var": -2.0583470662434895e-06, "kl": 1.953131928852751e-05, "entropy": 0.49485520720481874, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 488.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.501999999999822, "episode_len_mean": 255.6, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 41.90000000000001, -50.00000000000044, 41.100000000000016, 38.10000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 33.30000000000003, 22.299999999999876, 40.70000000000002, 0.49999999999956657, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 34.10000000000004, 38.300000000000026, 39.70000000000002, -50.00000000000044, -50.00000000000044, 32.30000000000002, 36.10000000000004, 43.50000000000001, 47.3, -50.00000000000044, 44.7, 44.10000000000001, 44.900000000000006, 43.30000000000001, -50.00000000000044, 43.900000000000006, 39.300000000000026, 45.7, -50.00000000000044, 42.70000000000001, 2.299999999999592, 42.30000000000001, -50.00000000000044, 26.09999999999993, 16.8999999999998, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.500000000000036, 41.100000000000016, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.699999999999996, 45.5, 46.099999999999994, 46.3, 45.5, -50.00000000000044, 41.30000000000001, 43.50000000000001, 44.300000000000004, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.50000000000001, 38.300000000000026, 39.90000000000002, 44.5, 11.899999999999729, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 40.10000000000002, 46.099999999999994], "episode_lengths": [500, 500, 82, 500, 44, 500, 34, 500, 500, 56, 40, 82, 500, 90, 120, 500, 74, 500, 168, 278, 94, 496, 212, 500, 500, 500, 82, 500, 500, 94, 500, 500, 500, 112, 500, 500, 160, 118, 104, 500, 500, 178, 140, 66, 28, 500, 54, 60, 52, 68, 500, 62, 108, 44, 500, 74, 478, 78, 500, 240, 332, 500, 48, 500, 52, 500, 500, 166, 90, 500, 52, 500, 34, 46, 40, 38, 46, 500, 88, 66, 58, 500, 48, 500, 40, 64, 500, 40, 500, 66, 118, 102, 56, 382, 500, 500, 42, 36, 100, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40143878816984097, "mean_inference_ms": 1.2752495586824537, "mean_action_processing_ms": 0.15167849867564687, "mean_env_wait_ms": 0.08907584346827786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031006813049316406, "StateBufferConnector_ms": 0.004002094268798828, "ViewRequirementAgentConnector_ms": 0.12900257110595703}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.501999999999822, "episode_len_mean": 255.6, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 41.90000000000001, -50.00000000000044, 41.100000000000016, 38.10000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 33.30000000000003, 22.299999999999876, 40.70000000000002, 0.49999999999956657, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 34.10000000000004, 38.300000000000026, 39.70000000000002, -50.00000000000044, -50.00000000000044, 32.30000000000002, 36.10000000000004, 43.50000000000001, 47.3, -50.00000000000044, 44.7, 44.10000000000001, 44.900000000000006, 43.30000000000001, -50.00000000000044, 43.900000000000006, 39.300000000000026, 45.7, -50.00000000000044, 42.70000000000001, 2.299999999999592, 42.30000000000001, -50.00000000000044, 26.09999999999993, 16.8999999999998, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.500000000000036, 41.100000000000016, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.699999999999996, 45.5, 46.099999999999994, 46.3, 45.5, -50.00000000000044, 41.30000000000001, 43.50000000000001, 44.300000000000004, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.50000000000001, 38.300000000000026, 39.90000000000002, 44.5, 11.899999999999729, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 40.10000000000002, 46.099999999999994], "episode_lengths": [500, 500, 82, 500, 44, 500, 34, 500, 500, 56, 40, 82, 500, 90, 120, 500, 74, 500, 168, 278, 94, 496, 212, 500, 500, 500, 82, 500, 500, 94, 500, 500, 500, 112, 500, 500, 160, 118, 104, 500, 500, 178, 140, 66, 28, 500, 54, 60, 52, 68, 500, 62, 108, 44, 500, 74, 478, 78, 500, 240, 332, 500, 48, 500, 52, 500, 500, 166, 90, 500, 52, 500, 34, 46, 40, 38, 46, 500, 88, 66, 58, 500, 48, 500, 40, 64, 500, 40, 500, 66, 118, 102, 56, 382, 500, 500, 42, 36, 100, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40143878816984097, "mean_inference_ms": 1.2752495586824537, "mean_action_processing_ms": 0.15167849867564687, "mean_env_wait_ms": 0.08907584346827786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031006813049316406, "StateBufferConnector_ms": 0.004002094268798828, "ViewRequirementAgentConnector_ms": 0.12900257110595703}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5314.43330863271, "num_env_steps_trained_throughput_per_sec": 5314.43330863271, "timesteps_total": 396000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 2338.901, "sample_time_ms": 2070.3, "load_time_ms": 10.6, "load_throughput": 1132060.764, "learn_time_ms": 247.7, "learn_throughput": 48445.766, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1490, "training_iteration": 33, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-23", "timestamp": 1698245063, "time_this_iter_s": 2.2629992961883545, "time_total_s": 74.9350004196167, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 74.9350004196167, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 63.833333333333336, "ram_util_percent": 27.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.328306436538697e-11, "cur_lr": 0.0003, "total_loss": 6.4534073829650875, "policy_loss": -0.0003502492482463519, "vf_loss": 6.453808561960856, "vf_explained_var": -6.477038065592448e-07, "kl": 0.000312184879065569, "entropy": 0.5118264595667521, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 503.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.650999999999827, "episode_len_mean": 249.12, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.30000000000002, 36.10000000000004, 43.50000000000001, 47.3, -50.00000000000044, 44.7, 44.10000000000001, 44.900000000000006, 43.30000000000001, -50.00000000000044, 43.900000000000006, 39.300000000000026, 45.7, -50.00000000000044, 42.70000000000001, 2.299999999999592, 42.30000000000001, -50.00000000000044, 26.09999999999993, 16.8999999999998, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.500000000000036, 41.100000000000016, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.699999999999996, 45.5, 46.099999999999994, 46.3, 45.5, -50.00000000000044, 41.30000000000001, 43.50000000000001, 44.300000000000004, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.50000000000001, 38.300000000000026, 39.90000000000002, 44.5, 11.899999999999729, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 40.10000000000002, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, 5.299999999999635, 32.700000000000024, 30.699999999999996, -50.00000000000044, -50.00000000000044, 45.9, 31.900000000000013, 43.30000000000001, 42.70000000000001, 46.5, 47.1, 34.50000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 39.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 34.70000000000004, 44.5, 41.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [178, 140, 66, 28, 500, 54, 60, 52, 68, 500, 62, 108, 44, 500, 74, 478, 78, 500, 240, 332, 500, 48, 500, 52, 500, 500, 166, 90, 500, 52, 500, 34, 46, 40, 38, 46, 500, 88, 66, 58, 500, 48, 500, 40, 64, 500, 40, 500, 66, 118, 102, 56, 382, 500, 500, 42, 36, 100, 40, 500, 54, 500, 448, 174, 194, 500, 500, 42, 182, 68, 74, 36, 30, 156, 500, 64, 500, 500, 500, 52, 56, 500, 102, 110, 500, 500, 154, 56, 88, 40, 500, 500, 212, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4023115106069512, "mean_inference_ms": 1.2760406347475, "mean_action_processing_ms": 0.15195592785910184, "mean_env_wait_ms": 0.08939900171070274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025001049041748047, "StateBufferConnector_ms": 0.0020024776458740234, "ViewRequirementAgentConnector_ms": 0.14198851585388184}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.650999999999827, "episode_len_mean": 249.12, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.30000000000002, 36.10000000000004, 43.50000000000001, 47.3, -50.00000000000044, 44.7, 44.10000000000001, 44.900000000000006, 43.30000000000001, -50.00000000000044, 43.900000000000006, 39.300000000000026, 45.7, -50.00000000000044, 42.70000000000001, 2.299999999999592, 42.30000000000001, -50.00000000000044, 26.09999999999993, 16.8999999999998, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.500000000000036, 41.100000000000016, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.699999999999996, 45.5, 46.099999999999994, 46.3, 45.5, -50.00000000000044, 41.30000000000001, 43.50000000000001, 44.300000000000004, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.50000000000001, 38.300000000000026, 39.90000000000002, 44.5, 11.899999999999729, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 40.10000000000002, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, 5.299999999999635, 32.700000000000024, 30.699999999999996, -50.00000000000044, -50.00000000000044, 45.9, 31.900000000000013, 43.30000000000001, 42.70000000000001, 46.5, 47.1, 34.50000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 39.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 34.70000000000004, 44.5, 41.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [178, 140, 66, 28, 500, 54, 60, 52, 68, 500, 62, 108, 44, 500, 74, 478, 78, 500, 240, 332, 500, 48, 500, 52, 500, 500, 166, 90, 500, 52, 500, 34, 46, 40, 38, 46, 500, 88, 66, 58, 500, 48, 500, 40, 64, 500, 40, 500, 66, 118, 102, 56, 382, 500, 500, 42, 36, 100, 40, 500, 54, 500, 448, 174, 194, 500, 500, 42, 182, 68, 74, 36, 30, 156, 500, 64, 500, 500, 500, 52, 56, 500, 102, 110, 500, 500, 154, 56, 88, 40, 500, 500, 212, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4023115106069512, "mean_inference_ms": 1.2760406347475, "mean_action_processing_ms": 0.15195592785910184, "mean_env_wait_ms": 0.08939900171070274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025001049041748047, "StateBufferConnector_ms": 0.0020024776458740234, "ViewRequirementAgentConnector_ms": 0.14198851585388184}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4870.127540332296, "num_env_steps_trained_throughput_per_sec": 4870.127540332296, "timesteps_total": 408000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 2358.401, "sample_time_ms": 2080.999, "load_time_ms": 11.1, "load_throughput": 1081050.301, "learn_time_ms": 256.1, "learn_throughput": 46856.756, "synch_weights_time_ms": 9.102}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 1531, "training_iteration": 34, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-26", "timestamp": 1698245066, "time_this_iter_s": 2.4690003395080566, "time_total_s": 77.40400075912476, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 77.40400075912476, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 62.324999999999996, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693485e-11, "cur_lr": 0.0003, "total_loss": 6.630364545186361, "policy_loss": -0.00017518202463785807, "vf_loss": 6.630592632293701, "vf_explained_var": -1.52587890625e-06, "kl": 0.0005931255288790756, "entropy": 0.5294987320899963, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.60800000000021, "episode_len_mean": 286.64, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, 43.50000000000001, 44.300000000000004, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.50000000000001, 38.300000000000026, 39.90000000000002, 44.5, 11.899999999999729, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 40.10000000000002, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, 5.299999999999635, 32.700000000000024, 30.699999999999996, -50.00000000000044, -50.00000000000044, 45.9, 31.900000000000013, 43.30000000000001, 42.70000000000001, 46.5, 47.1, 34.50000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 39.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 34.70000000000004, 44.5, 41.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 35.900000000000034, 45.5, -50.00000000000044, 43.50000000000001, 43.30000000000001, -50.00000000000044, 15.099999999999774, 41.30000000000001, 27.899999999999956, -50.00000000000044, 8.099999999999675, 44.7, -50.00000000000044, 12.899999999999743, 44.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.099999999999575, 42.70000000000001, -50.00000000000044, 43.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044], "episode_lengths": [88, 66, 58, 500, 48, 500, 40, 64, 500, 40, 500, 66, 118, 102, 56, 382, 500, 500, 42, 36, 100, 40, 500, 54, 500, 448, 174, 194, 500, 500, 42, 182, 68, 74, 36, 30, 156, 500, 64, 500, 500, 500, 52, 56, 500, 102, 110, 500, 500, 154, 56, 88, 40, 500, 500, 212, 500, 500, 500, 500, 500, 500, 500, 500, 500, 46, 500, 500, 500, 500, 500, 500, 164, 142, 46, 500, 66, 68, 500, 350, 88, 222, 500, 420, 54, 500, 372, 52, 68, 500, 500, 490, 74, 500, 68, 54, 500, 500, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021400130865284, "mean_inference_ms": 1.2784007409334304, "mean_action_processing_ms": 0.15234669690834823, "mean_env_wait_ms": 0.08904163757753653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029004573822021484, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.13899707794189453}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.60800000000021, "episode_len_mean": 286.64, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, 43.50000000000001, 44.300000000000004, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.50000000000001, 38.300000000000026, 39.90000000000002, 44.5, 11.899999999999729, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 40.10000000000002, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, 5.299999999999635, 32.700000000000024, 30.699999999999996, -50.00000000000044, -50.00000000000044, 45.9, 31.900000000000013, 43.30000000000001, 42.70000000000001, 46.5, 47.1, 34.50000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 39.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 34.70000000000004, 44.5, 41.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 35.900000000000034, 45.5, -50.00000000000044, 43.50000000000001, 43.30000000000001, -50.00000000000044, 15.099999999999774, 41.30000000000001, 27.899999999999956, -50.00000000000044, 8.099999999999675, 44.7, -50.00000000000044, 12.899999999999743, 44.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.099999999999575, 42.70000000000001, -50.00000000000044, 43.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044], "episode_lengths": [88, 66, 58, 500, 48, 500, 40, 64, 500, 40, 500, 66, 118, 102, 56, 382, 500, 500, 42, 36, 100, 40, 500, 54, 500, 448, 174, 194, 500, 500, 42, 182, 68, 74, 36, 30, 156, 500, 64, 500, 500, 500, 52, 56, 500, 102, 110, 500, 500, 154, 56, 88, 40, 500, 500, 212, 500, 500, 500, 500, 500, 500, 500, 500, 500, 46, 500, 500, 500, 500, 500, 500, 164, 142, 46, 500, 66, 68, 500, 350, 88, 222, 500, 420, 54, 500, 372, 52, 68, 500, 500, 490, 74, 500, 68, 54, 500, 500, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021400130865284, "mean_inference_ms": 1.2784007409334304, "mean_action_processing_ms": 0.15234669690834823, "mean_env_wait_ms": 0.08904163757753653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029004573822021484, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.13899707794189453}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5210.595476092349, "num_env_steps_trained_throughput_per_sec": 5210.595476092349, "timesteps_total": 420000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 2340.501, "sample_time_ms": 2083.499, "load_time_ms": 10.6, "load_throughput": 1132045.487, "learn_time_ms": 236.4, "learn_throughput": 50761.471, "synch_weights_time_ms": 8.902}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 1568, "training_iteration": 35, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-28", "timestamp": 1698245068, "time_this_iter_s": 2.3869996070861816, "time_total_s": 79.79100036621094, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 79.79100036621094, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 66.16666666666667, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346743e-12, "cur_lr": 0.0003, "total_loss": 6.391445382436117, "policy_loss": -0.00034780253966649376, "vf_loss": 6.3918455123901365, "vf_explained_var": -2.201398213704427e-06, "kl": 0.0003730046296595901, "entropy": 0.5233277082443237, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 533.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.575000000000241, "episode_len_mean": 321.24, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 39.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 34.70000000000004, 44.5, 41.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 35.900000000000034, 45.5, -50.00000000000044, 43.50000000000001, 43.30000000000001, -50.00000000000044, 15.099999999999774, 41.30000000000001, 27.899999999999956, -50.00000000000044, 8.099999999999675, 44.7, -50.00000000000044, 12.899999999999743, 44.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.099999999999575, 42.70000000000001, -50.00000000000044, 43.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 42.10000000000001, 43.900000000000006, 44.10000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.30000000000001, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 9.099999999999689, 31.900000000000013, 15.299999999999777, 44.900000000000006, 42.30000000000001, 39.70000000000002, -50.00000000000044, 29.69999999999998, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.7, 44.5], "episode_lengths": [500, 500, 500, 52, 56, 500, 102, 110, 500, 500, 154, 56, 88, 40, 500, 500, 212, 500, 500, 500, 500, 500, 500, 500, 500, 500, 46, 500, 500, 500, 500, 500, 500, 164, 142, 46, 500, 66, 68, 500, 350, 88, 222, 500, 420, 54, 500, 372, 52, 68, 500, 500, 490, 74, 500, 68, 54, 500, 500, 82, 500, 500, 500, 500, 142, 500, 80, 62, 60, 118, 500, 500, 60, 500, 500, 88, 78, 342, 500, 500, 500, 86, 500, 410, 182, 348, 52, 78, 104, 500, 204, 112, 500, 500, 500, 500, 500, 112, 54, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4025260415335523, "mean_inference_ms": 1.2796499074330228, "mean_action_processing_ms": 0.1521814540089354, "mean_env_wait_ms": 0.0890766457991252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027993440628051758, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.13298702239990234}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.575000000000241, "episode_len_mean": 321.24, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 39.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 34.70000000000004, 44.5, 41.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 35.900000000000034, 45.5, -50.00000000000044, 43.50000000000001, 43.30000000000001, -50.00000000000044, 15.099999999999774, 41.30000000000001, 27.899999999999956, -50.00000000000044, 8.099999999999675, 44.7, -50.00000000000044, 12.899999999999743, 44.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.099999999999575, 42.70000000000001, -50.00000000000044, 43.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 42.10000000000001, 43.900000000000006, 44.10000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.30000000000001, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 9.099999999999689, 31.900000000000013, 15.299999999999777, 44.900000000000006, 42.30000000000001, 39.70000000000002, -50.00000000000044, 29.69999999999998, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.7, 44.5], "episode_lengths": [500, 500, 500, 52, 56, 500, 102, 110, 500, 500, 154, 56, 88, 40, 500, 500, 212, 500, 500, 500, 500, 500, 500, 500, 500, 500, 46, 500, 500, 500, 500, 500, 500, 164, 142, 46, 500, 66, 68, 500, 350, 88, 222, 500, 420, 54, 500, 372, 52, 68, 500, 500, 490, 74, 500, 68, 54, 500, 500, 82, 500, 500, 500, 500, 142, 500, 80, 62, 60, 118, 500, 500, 60, 500, 500, 88, 78, 342, 500, 500, 500, 86, 500, 410, 182, 348, 52, 78, 104, 500, 204, 112, 500, 500, 500, 500, 500, 112, 54, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4025260415335523, "mean_inference_ms": 1.2796499074330228, "mean_action_processing_ms": 0.1521814540089354, "mean_env_wait_ms": 0.0890766457991252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027993440628051758, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.13298702239990234}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5128.199046265681, "num_env_steps_trained_throughput_per_sec": 5128.199046265681, "timesteps_total": 432000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 2345.701, "sample_time_ms": 2080.999, "load_time_ms": 11.1, "load_throughput": 1081066.554, "learn_time_ms": 243.6, "learn_throughput": 49261.057, "synch_weights_time_ms": 9.002}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1607, "training_iteration": 36, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-31", "timestamp": 1698245071, "time_this_iter_s": 2.3440005779266357, "time_total_s": 82.13500094413757, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 82.13500094413757, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 60.4, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9103830456733713e-12, "cur_lr": 0.0003, "total_loss": 6.568674691518148, "policy_loss": -0.0003444535036881765, "vf_loss": 6.569071896870931, "vf_explained_var": -2.845128377278646e-06, "kl": 0.0004626642272493579, "entropy": 0.5278933882713318, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 548.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5049999999997994, "episode_len_mean": 280.54, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.899999999999743, 44.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.099999999999575, 42.70000000000001, -50.00000000000044, 43.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 42.10000000000001, 43.900000000000006, 44.10000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.30000000000001, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 9.099999999999689, 31.900000000000013, 15.299999999999777, 44.900000000000006, 42.30000000000001, 39.70000000000002, -50.00000000000044, 29.69999999999998, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.7, 44.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.5, 39.300000000000026, 42.500000000000014, 26.499999999999936, 41.90000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.300000000000004, 45.1, 41.90000000000001, -50.00000000000044, 41.500000000000014, 45.3, 41.90000000000001, 45.1, 44.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 0.49999999999956657, 45.1, -50.00000000000044, 42.500000000000014, 42.500000000000014, 33.10000000000003, 40.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 41.100000000000016, 43.900000000000006, 0.49999999999956657], "episode_lengths": [372, 52, 68, 500, 500, 490, 74, 500, 68, 54, 500, 500, 82, 500, 500, 500, 500, 142, 500, 80, 62, 60, 118, 500, 500, 60, 500, 500, 88, 78, 342, 500, 500, 500, 86, 500, 410, 182, 348, 52, 78, 104, 500, 204, 112, 500, 500, 500, 500, 500, 112, 54, 56, 500, 54, 500, 500, 88, 500, 36, 108, 76, 236, 82, 76, 500, 500, 500, 86, 500, 58, 50, 82, 500, 86, 48, 82, 50, 52, 64, 500, 500, 500, 276, 496, 50, 500, 76, 76, 170, 92, 58, 500, 500, 500, 500, 110, 90, 62, 496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40215189290945885, "mean_inference_ms": 1.2795473378615185, "mean_action_processing_ms": 0.15255002924343938, "mean_env_wait_ms": 0.08908217349354906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999380111694336, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.10498809814453125}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5049999999997994, "episode_len_mean": 280.54, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.899999999999743, 44.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.099999999999575, 42.70000000000001, -50.00000000000044, 43.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 42.10000000000001, 43.900000000000006, 44.10000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.30000000000001, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 9.099999999999689, 31.900000000000013, 15.299999999999777, 44.900000000000006, 42.30000000000001, 39.70000000000002, -50.00000000000044, 29.69999999999998, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.7, 44.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.5, 39.300000000000026, 42.500000000000014, 26.499999999999936, 41.90000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.300000000000004, 45.1, 41.90000000000001, -50.00000000000044, 41.500000000000014, 45.3, 41.90000000000001, 45.1, 44.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 0.49999999999956657, 45.1, -50.00000000000044, 42.500000000000014, 42.500000000000014, 33.10000000000003, 40.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 41.100000000000016, 43.900000000000006, 0.49999999999956657], "episode_lengths": [372, 52, 68, 500, 500, 490, 74, 500, 68, 54, 500, 500, 82, 500, 500, 500, 500, 142, 500, 80, 62, 60, 118, 500, 500, 60, 500, 500, 88, 78, 342, 500, 500, 500, 86, 500, 410, 182, 348, 52, 78, 104, 500, 204, 112, 500, 500, 500, 500, 500, 112, 54, 56, 500, 54, 500, 500, 88, 500, 36, 108, 76, 236, 82, 76, 500, 500, 500, 86, 500, 58, 50, 82, 500, 86, 48, 82, 50, 52, 64, 500, 500, 500, 276, 496, 50, 500, 76, 76, 170, 92, 58, 500, 500, 500, 500, 110, 90, 62, 496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40215189290945885, "mean_inference_ms": 1.2795473378615185, "mean_action_processing_ms": 0.15255002924343938, "mean_env_wait_ms": 0.08908217349354906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999380111694336, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.10498809814453125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5054.759236936115, "num_env_steps_trained_throughput_per_sec": 5054.759236936115, "timesteps_total": 444000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 2331.101, "sample_time_ms": 2054.4, "load_time_ms": 11.6, "load_throughput": 1034464.184, "learn_time_ms": 255.2, "learn_throughput": 47021.938, "synch_weights_time_ms": 8.902}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 1654, "training_iteration": 37, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-33", "timestamp": 1698245073, "time_this_iter_s": 2.379000425338745, "time_total_s": 84.51400136947632, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 84.51400136947632, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 56.949999999999996, "ram_util_percent": 27.125000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366857e-12, "cur_lr": 0.0003, "total_loss": 6.837402693430582, "policy_loss": 6.166274348894755e-05, "vf_loss": 6.837396907806396, "vf_explained_var": -1.152356465657552e-06, "kl": 0.00038395739018900105, "entropy": 0.5581705848375956, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0229999999998074, "episode_len_mean": 275.36, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.7, 44.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.5, 39.300000000000026, 42.500000000000014, 26.499999999999936, 41.90000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.300000000000004, 45.1, 41.90000000000001, -50.00000000000044, 41.500000000000014, 45.3, 41.90000000000001, 45.1, 44.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 0.49999999999956657, 45.1, -50.00000000000044, 42.500000000000014, 42.500000000000014, 33.10000000000003, 40.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 41.100000000000016, 43.900000000000006, 0.49999999999956657, 38.50000000000003, 44.5, -50.00000000000044, 44.10000000000001, 41.30000000000001, 32.700000000000024, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 38.300000000000026, -50.00000000000044, 10.899999999999714, -50.00000000000044, 45.7, -50.00000000000044, 10.299999999999706, 40.70000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 29.899999999999984, -50.00000000000044, 30.699999999999996, -50.00000000000044, 45.3, 22.699999999999882, -50.00000000000044, 44.7, 38.10000000000002, -50.00000000000044, 45.7, 43.10000000000001, 42.70000000000001, 43.30000000000001, -50.00000000000044, 44.900000000000006, 35.70000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 112, 54, 56, 500, 54, 500, 500, 88, 500, 36, 108, 76, 236, 82, 76, 500, 500, 500, 86, 500, 58, 50, 82, 500, 86, 48, 82, 50, 52, 64, 500, 500, 500, 276, 496, 50, 500, 76, 76, 170, 92, 58, 500, 500, 500, 500, 110, 90, 62, 496, 116, 56, 500, 60, 88, 174, 500, 500, 86, 500, 500, 500, 170, 118, 500, 392, 500, 44, 500, 398, 94, 74, 500, 500, 500, 134, 202, 500, 194, 500, 48, 274, 500, 54, 120, 500, 44, 70, 74, 68, 500, 52, 144, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4018125107679667, "mean_inference_ms": 1.2797718988713602, "mean_action_processing_ms": 0.15214395190397617, "mean_env_wait_ms": 0.08887887444329418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026005268096923828, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.10902190208435059}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0229999999998074, "episode_len_mean": 275.36, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.7, 44.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.5, 39.300000000000026, 42.500000000000014, 26.499999999999936, 41.90000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.300000000000004, 45.1, 41.90000000000001, -50.00000000000044, 41.500000000000014, 45.3, 41.90000000000001, 45.1, 44.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 0.49999999999956657, 45.1, -50.00000000000044, 42.500000000000014, 42.500000000000014, 33.10000000000003, 40.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 41.100000000000016, 43.900000000000006, 0.49999999999956657, 38.50000000000003, 44.5, -50.00000000000044, 44.10000000000001, 41.30000000000001, 32.700000000000024, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 38.300000000000026, -50.00000000000044, 10.899999999999714, -50.00000000000044, 45.7, -50.00000000000044, 10.299999999999706, 40.70000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 29.899999999999984, -50.00000000000044, 30.699999999999996, -50.00000000000044, 45.3, 22.699999999999882, -50.00000000000044, 44.7, 38.10000000000002, -50.00000000000044, 45.7, 43.10000000000001, 42.70000000000001, 43.30000000000001, -50.00000000000044, 44.900000000000006, 35.70000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 112, 54, 56, 500, 54, 500, 500, 88, 500, 36, 108, 76, 236, 82, 76, 500, 500, 500, 86, 500, 58, 50, 82, 500, 86, 48, 82, 50, 52, 64, 500, 500, 500, 276, 496, 50, 500, 76, 76, 170, 92, 58, 500, 500, 500, 500, 110, 90, 62, 496, 116, 56, 500, 60, 88, 174, 500, 500, 86, 500, 500, 500, 170, 118, 500, 392, 500, 44, 500, 398, 94, 74, 500, 500, 500, 134, 202, 500, 194, 500, 48, 274, 500, 54, 120, 500, 44, 70, 74, 68, 500, 52, 144, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4018125107679667, "mean_inference_ms": 1.2797718988713602, "mean_action_processing_ms": 0.15214395190397617, "mean_env_wait_ms": 0.08887887444329418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026005268096923828, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.10902190208435059}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5201.558494224475, "num_env_steps_trained_throughput_per_sec": 5201.558494224475, "timesteps_total": 456000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 2308.601, "sample_time_ms": 2043.8, "load_time_ms": 11.0, "load_throughput": 1090888.851, "learn_time_ms": 244.0, "learn_throughput": 49180.37, "synch_weights_time_ms": 8.702}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 1699, "training_iteration": 38, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-35", "timestamp": 1698245075, "time_this_iter_s": 2.310999631881714, "time_total_s": 86.82500100135803, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 86.82500100135803, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 67.36666666666666, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183428e-13, "cur_lr": 0.0003, "total_loss": 6.855545902252198, "policy_loss": -0.0006517931818962097, "vf_loss": 6.856257184346517, "vf_explained_var": -1.3987223307291666e-06, "kl": 0.0007984087385163245, "entropy": 0.5944933891296387, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 578.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.111999999999825, "episode_len_mean": 269.52, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 41.100000000000016, 43.900000000000006, 0.49999999999956657, 38.50000000000003, 44.5, -50.00000000000044, 44.10000000000001, 41.30000000000001, 32.700000000000024, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 38.300000000000026, -50.00000000000044, 10.899999999999714, -50.00000000000044, 45.7, -50.00000000000044, 10.299999999999706, 40.70000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 29.899999999999984, -50.00000000000044, 30.699999999999996, -50.00000000000044, 45.3, 22.699999999999882, -50.00000000000044, 44.7, 38.10000000000002, -50.00000000000044, 45.7, 43.10000000000001, 42.70000000000001, 43.30000000000001, -50.00000000000044, 44.900000000000006, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, 40.70000000000002, -50.00000000000044, 31.300000000000004, 43.7, 42.500000000000014, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.7, 26.89999999999994, 3.0999999999996035, 40.70000000000002, -50.00000000000044, 41.100000000000016, 32.100000000000016, -50.00000000000044, 43.7, 42.10000000000001, -50.00000000000044, 40.90000000000002, 28.09999999999996, 32.90000000000003, -50.00000000000044, 35.70000000000003, 31.900000000000013, 47.3, 37.300000000000026, -50.00000000000044, 31.300000000000004, 44.10000000000001, -50.00000000000044, 39.50000000000002, 39.10000000000002, -50.00000000000044, 45.1, 44.10000000000001, 31.1, 35.500000000000036, -50.00000000000044, -50.00000000000044, 46.699999999999996, 13.099999999999746, 43.7, 38.700000000000024], "episode_lengths": [58, 500, 500, 500, 500, 110, 90, 62, 496, 116, 56, 500, 60, 88, 174, 500, 500, 86, 500, 500, 500, 170, 118, 500, 392, 500, 44, 500, 398, 94, 74, 500, 500, 500, 134, 202, 500, 194, 500, 48, 274, 500, 54, 120, 500, 44, 70, 74, 68, 500, 52, 144, 500, 500, 500, 412, 94, 500, 188, 64, 76, 500, 242, 500, 44, 232, 470, 94, 500, 90, 180, 500, 64, 80, 500, 92, 220, 172, 500, 144, 182, 28, 128, 500, 188, 60, 500, 106, 110, 500, 50, 60, 190, 146, 500, 500, 34, 370, 64, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021459179547155, "mean_inference_ms": 1.2795658441487714, "mean_action_processing_ms": 0.1522549213086798, "mean_env_wait_ms": 0.08889886165812094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200031280517578, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.13599133491516113}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.111999999999825, "episode_len_mean": 269.52, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 41.100000000000016, 43.900000000000006, 0.49999999999956657, 38.50000000000003, 44.5, -50.00000000000044, 44.10000000000001, 41.30000000000001, 32.700000000000024, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 38.300000000000026, -50.00000000000044, 10.899999999999714, -50.00000000000044, 45.7, -50.00000000000044, 10.299999999999706, 40.70000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 29.899999999999984, -50.00000000000044, 30.699999999999996, -50.00000000000044, 45.3, 22.699999999999882, -50.00000000000044, 44.7, 38.10000000000002, -50.00000000000044, 45.7, 43.10000000000001, 42.70000000000001, 43.30000000000001, -50.00000000000044, 44.900000000000006, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, 40.70000000000002, -50.00000000000044, 31.300000000000004, 43.7, 42.500000000000014, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.7, 26.89999999999994, 3.0999999999996035, 40.70000000000002, -50.00000000000044, 41.100000000000016, 32.100000000000016, -50.00000000000044, 43.7, 42.10000000000001, -50.00000000000044, 40.90000000000002, 28.09999999999996, 32.90000000000003, -50.00000000000044, 35.70000000000003, 31.900000000000013, 47.3, 37.300000000000026, -50.00000000000044, 31.300000000000004, 44.10000000000001, -50.00000000000044, 39.50000000000002, 39.10000000000002, -50.00000000000044, 45.1, 44.10000000000001, 31.1, 35.500000000000036, -50.00000000000044, -50.00000000000044, 46.699999999999996, 13.099999999999746, 43.7, 38.700000000000024], "episode_lengths": [58, 500, 500, 500, 500, 110, 90, 62, 496, 116, 56, 500, 60, 88, 174, 500, 500, 86, 500, 500, 500, 170, 118, 500, 392, 500, 44, 500, 398, 94, 74, 500, 500, 500, 134, 202, 500, 194, 500, 48, 274, 500, 54, 120, 500, 44, 70, 74, 68, 500, 52, 144, 500, 500, 500, 412, 94, 500, 188, 64, 76, 500, 242, 500, 44, 232, 470, 94, 500, 90, 180, 500, 64, 80, 500, 92, 220, 172, 500, 144, 182, 28, 128, 500, 188, 60, 500, 106, 110, 500, 50, 60, 190, 146, 500, 500, 34, 370, 64, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021459179547155, "mean_inference_ms": 1.2795658441487714, "mean_action_processing_ms": 0.1522549213086798, "mean_env_wait_ms": 0.08889886165812094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200031280517578, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.13599133491516113}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5156.8540060773685, "num_env_steps_trained_throughput_per_sec": 5156.8540060773685, "timesteps_total": 468000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 2302.901, "sample_time_ms": 2023.0, "load_time_ms": 13.4, "load_throughput": 895521.967, "learn_time_ms": 256.7, "learn_throughput": 46747.177, "synch_weights_time_ms": 8.702}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1745, "training_iteration": 39, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-38", "timestamp": 1698245078, "time_this_iter_s": 2.3319997787475586, "time_total_s": 89.15700078010559, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 89.15700078010559, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 62.46666666666667, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.637978807091714e-13, "cur_lr": 0.0003, "total_loss": 6.304102261861165, "policy_loss": -4.05016044775645e-05, "vf_loss": 6.3041963895161945, "vf_explained_var": -2.1219253540039063e-06, "kl": 0.00013803984228009843, "entropy": 0.5363167901833852, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 593.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9299999999998203, "episode_len_mean": 271.32, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, 22.699999999999882, -50.00000000000044, 44.7, 38.10000000000002, -50.00000000000044, 45.7, 43.10000000000001, 42.70000000000001, 43.30000000000001, -50.00000000000044, 44.900000000000006, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, 40.70000000000002, -50.00000000000044, 31.300000000000004, 43.7, 42.500000000000014, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.7, 26.89999999999994, 3.0999999999996035, 40.70000000000002, -50.00000000000044, 41.100000000000016, 32.100000000000016, -50.00000000000044, 43.7, 42.10000000000001, -50.00000000000044, 40.90000000000002, 28.09999999999996, 32.90000000000003, -50.00000000000044, 35.70000000000003, 31.900000000000013, 47.3, 37.300000000000026, -50.00000000000044, 31.300000000000004, 44.10000000000001, -50.00000000000044, 39.50000000000002, 39.10000000000002, -50.00000000000044, 45.1, 44.10000000000001, 31.1, 35.500000000000036, -50.00000000000044, -50.00000000000044, 46.699999999999996, 13.099999999999746, 43.7, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.900000000000006, 46.3, 37.90000000000003, 29.099999999999973, 47.5, 32.100000000000016, 44.10000000000001, 39.10000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, 24.099999999999902, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.10000000000001, 15.699999999999783, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 27.699999999999953, -50.00000000000044], "episode_lengths": [500, 48, 274, 500, 54, 120, 500, 44, 70, 74, 68, 500, 52, 144, 500, 500, 500, 412, 94, 500, 188, 64, 76, 500, 242, 500, 44, 232, 470, 94, 500, 90, 180, 500, 64, 80, 500, 92, 220, 172, 500, 144, 182, 28, 128, 500, 188, 60, 500, 106, 110, 500, 50, 60, 190, 146, 500, 500, 34, 370, 64, 114, 500, 500, 500, 500, 500, 92, 72, 38, 122, 210, 26, 180, 60, 110, 500, 188, 500, 260, 500, 44, 500, 500, 500, 84, 60, 344, 500, 40, 500, 156, 500, 500, 500, 500, 86, 500, 224, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4025095344362586, "mean_inference_ms": 1.2800098605797912, "mean_action_processing_ms": 0.1521971788787318, "mean_env_wait_ms": 0.08905823822782705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799820899963379, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.13898491859436035}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9299999999998203, "episode_len_mean": 271.32, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, 22.699999999999882, -50.00000000000044, 44.7, 38.10000000000002, -50.00000000000044, 45.7, 43.10000000000001, 42.70000000000001, 43.30000000000001, -50.00000000000044, 44.900000000000006, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, 40.70000000000002, -50.00000000000044, 31.300000000000004, 43.7, 42.500000000000014, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.7, 26.89999999999994, 3.0999999999996035, 40.70000000000002, -50.00000000000044, 41.100000000000016, 32.100000000000016, -50.00000000000044, 43.7, 42.10000000000001, -50.00000000000044, 40.90000000000002, 28.09999999999996, 32.90000000000003, -50.00000000000044, 35.70000000000003, 31.900000000000013, 47.3, 37.300000000000026, -50.00000000000044, 31.300000000000004, 44.10000000000001, -50.00000000000044, 39.50000000000002, 39.10000000000002, -50.00000000000044, 45.1, 44.10000000000001, 31.1, 35.500000000000036, -50.00000000000044, -50.00000000000044, 46.699999999999996, 13.099999999999746, 43.7, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.900000000000006, 46.3, 37.90000000000003, 29.099999999999973, 47.5, 32.100000000000016, 44.10000000000001, 39.10000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, 24.099999999999902, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.10000000000001, 15.699999999999783, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 27.699999999999953, -50.00000000000044], "episode_lengths": [500, 48, 274, 500, 54, 120, 500, 44, 70, 74, 68, 500, 52, 144, 500, 500, 500, 412, 94, 500, 188, 64, 76, 500, 242, 500, 44, 232, 470, 94, 500, 90, 180, 500, 64, 80, 500, 92, 220, 172, 500, 144, 182, 28, 128, 500, 188, 60, 500, 106, 110, 500, 50, 60, 190, 146, 500, 500, 34, 370, 64, 114, 500, 500, 500, 500, 500, 92, 72, 38, 122, 210, 26, 180, 60, 110, 500, 188, 500, 260, 500, 44, 500, 500, 500, 84, 60, 344, 500, 40, 500, 156, 500, 500, 500, 500, 86, 500, 224, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4025095344362586, "mean_inference_ms": 1.2800098605797912, "mean_action_processing_ms": 0.1521971788787318, "mean_env_wait_ms": 0.08905823822782705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799820899963379, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.13898491859436035}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5679.124940155628, "num_env_steps_trained_throughput_per_sec": 5679.124940155628, "timesteps_total": 480000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 2284.401, "sample_time_ms": 2024.6, "load_time_ms": 13.2, "load_throughput": 909084.551, "learn_time_ms": 236.7, "learn_throughput": 50697.103, "synch_weights_time_ms": 8.802}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 1783, "training_iteration": 40, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-40", "timestamp": 1698245080, "time_this_iter_s": 2.1180007457733154, "time_total_s": 91.2750015258789, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 91.2750015258789, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 61.06666666666666, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.818989403545857e-13, "cur_lr": 0.0003, "total_loss": 6.619147904713949, "policy_loss": -8.079620699087778e-05, "vf_loss": 6.619285297393799, "vf_explained_var": -3.4809112548828124e-06, "kl": 0.0002589964097078716, "entropy": 0.5652643163998922, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 608.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4639999999998088, "episode_len_mean": 285.96, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.90000000000003, -50.00000000000044, 35.70000000000003, 31.900000000000013, 47.3, 37.300000000000026, -50.00000000000044, 31.300000000000004, 44.10000000000001, -50.00000000000044, 39.50000000000002, 39.10000000000002, -50.00000000000044, 45.1, 44.10000000000001, 31.1, 35.500000000000036, -50.00000000000044, -50.00000000000044, 46.699999999999996, 13.099999999999746, 43.7, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.900000000000006, 46.3, 37.90000000000003, 29.099999999999973, 47.5, 32.100000000000016, 44.10000000000001, 39.10000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, 24.099999999999902, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.10000000000001, 15.699999999999783, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 11.699999999999726, 43.30000000000001, 42.900000000000006, -50.00000000000044, 34.10000000000004, 45.1, -50.00000000000044, 30.9, 3.2999999999996064, 45.3, 37.90000000000003, 13.099999999999746, -50.00000000000044, -50.00000000000044, 44.10000000000001, 14.09999999999976, 25.099999999999916, 25.699999999999925, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 30.699999999999996, 17.899999999999814, 44.5, -50.00000000000044, 38.90000000000002, 43.10000000000001, 44.900000000000006, -50.00000000000044, 41.70000000000002], "episode_lengths": [172, 500, 144, 182, 28, 128, 500, 188, 60, 500, 106, 110, 500, 50, 60, 190, 146, 500, 500, 34, 370, 64, 114, 500, 500, 500, 500, 500, 92, 72, 38, 122, 210, 26, 180, 60, 110, 500, 188, 500, 260, 500, 44, 500, 500, 500, 84, 60, 344, 500, 40, 500, 156, 500, 500, 500, 500, 86, 500, 224, 500, 500, 68, 500, 500, 384, 68, 72, 500, 160, 50, 500, 192, 468, 48, 122, 370, 500, 500, 60, 360, 250, 244, 500, 82, 500, 500, 500, 500, 500, 166, 194, 322, 56, 500, 112, 70, 52, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4023584629726163, "mean_inference_ms": 1.2801587825999672, "mean_action_processing_ms": 0.15216805598363126, "mean_env_wait_ms": 0.08916759094998111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998374938964844, "StateBufferConnector_ms": 0.002997159957885742, "ViewRequirementAgentConnector_ms": 0.1519794464111328}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4639999999998088, "episode_len_mean": 285.96, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.90000000000003, -50.00000000000044, 35.70000000000003, 31.900000000000013, 47.3, 37.300000000000026, -50.00000000000044, 31.300000000000004, 44.10000000000001, -50.00000000000044, 39.50000000000002, 39.10000000000002, -50.00000000000044, 45.1, 44.10000000000001, 31.1, 35.500000000000036, -50.00000000000044, -50.00000000000044, 46.699999999999996, 13.099999999999746, 43.7, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.900000000000006, 46.3, 37.90000000000003, 29.099999999999973, 47.5, 32.100000000000016, 44.10000000000001, 39.10000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, 24.099999999999902, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.10000000000001, 15.699999999999783, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 11.699999999999726, 43.30000000000001, 42.900000000000006, -50.00000000000044, 34.10000000000004, 45.1, -50.00000000000044, 30.9, 3.2999999999996064, 45.3, 37.90000000000003, 13.099999999999746, -50.00000000000044, -50.00000000000044, 44.10000000000001, 14.09999999999976, 25.099999999999916, 25.699999999999925, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 30.699999999999996, 17.899999999999814, 44.5, -50.00000000000044, 38.90000000000002, 43.10000000000001, 44.900000000000006, -50.00000000000044, 41.70000000000002], "episode_lengths": [172, 500, 144, 182, 28, 128, 500, 188, 60, 500, 106, 110, 500, 50, 60, 190, 146, 500, 500, 34, 370, 64, 114, 500, 500, 500, 500, 500, 92, 72, 38, 122, 210, 26, 180, 60, 110, 500, 188, 500, 260, 500, 44, 500, 500, 500, 84, 60, 344, 500, 40, 500, 156, 500, 500, 500, 500, 86, 500, 224, 500, 500, 68, 500, 500, 384, 68, 72, 500, 160, 50, 500, 192, 468, 48, 122, 370, 500, 500, 60, 360, 250, 244, 500, 82, 500, 500, 500, 500, 500, 166, 194, 322, 56, 500, 112, 70, 52, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4023584629726163, "mean_inference_ms": 1.2801587825999672, "mean_action_processing_ms": 0.15216805598363126, "mean_env_wait_ms": 0.08916759094998111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998374938964844, "StateBufferConnector_ms": 0.002997159957885742, "ViewRequirementAgentConnector_ms": 0.1519794464111328}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4940.304368929418, "num_env_steps_trained_throughput_per_sec": 4940.304368929418, "timesteps_total": 492000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 2313.701, "sample_time_ms": 2040.3, "load_time_ms": 13.5, "load_throughput": 888887.382, "learn_time_ms": 249.9, "learn_throughput": 48019.211, "synch_weights_time_ms": 8.902}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 1822, "training_iteration": 41, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-42", "timestamp": 1698245082, "time_this_iter_s": 2.4340004920959473, "time_total_s": 93.70900201797485, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 93.70900201797485, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 68.2, "ram_util_percent": 27.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729285e-14, "cur_lr": 0.0003, "total_loss": 6.5485427220662435, "policy_loss": -0.0005292143439874053, "vf_loss": 6.549128659566244, "vf_explained_var": -2.102057139078776e-06, "kl": 0.0006185299601687196, "entropy": 0.5672483285268147, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 623.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.984000000000216, "episode_len_mean": 300.4, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.70000000000002, 44.10000000000001, 15.699999999999783, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 11.699999999999726, 43.30000000000001, 42.900000000000006, -50.00000000000044, 34.10000000000004, 45.1, -50.00000000000044, 30.9, 3.2999999999996064, 45.3, 37.90000000000003, 13.099999999999746, -50.00000000000044, -50.00000000000044, 44.10000000000001, 14.09999999999976, 25.099999999999916, 25.699999999999925, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 30.699999999999996, 17.899999999999814, 44.5, -50.00000000000044, 38.90000000000002, 43.10000000000001, 44.900000000000006, -50.00000000000044, 41.70000000000002, 33.70000000000004, 37.300000000000026, -50.00000000000044, -50.00000000000044, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 33.10000000000003, 45.5, 13.499999999999751, 45.3, 3.2999999999996064, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 19.09999999999983, 44.900000000000006, 41.500000000000014, 44.10000000000001, 43.900000000000006, 40.10000000000002, 46.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994], "episode_lengths": [500, 500, 84, 60, 344, 500, 40, 500, 156, 500, 500, 500, 500, 86, 500, 224, 500, 500, 68, 500, 500, 384, 68, 72, 500, 160, 50, 500, 192, 468, 48, 122, 370, 500, 500, 60, 360, 250, 244, 500, 82, 500, 500, 500, 500, 500, 166, 194, 322, 56, 500, 112, 70, 52, 500, 84, 164, 128, 500, 500, 50, 76, 500, 500, 64, 58, 500, 500, 500, 58, 170, 46, 366, 48, 468, 96, 44, 500, 500, 500, 500, 500, 272, 500, 500, 500, 500, 36, 500, 310, 52, 86, 60, 62, 100, 38, 100, 500, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021101683294179, "mean_inference_ms": 1.2813537856623447, "mean_action_processing_ms": 0.15167001980463438, "mean_env_wait_ms": 0.08910485604351387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029989004135131836, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.12398982048034668}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.984000000000216, "episode_len_mean": 300.4, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.70000000000002, 44.10000000000001, 15.699999999999783, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 11.699999999999726, 43.30000000000001, 42.900000000000006, -50.00000000000044, 34.10000000000004, 45.1, -50.00000000000044, 30.9, 3.2999999999996064, 45.3, 37.90000000000003, 13.099999999999746, -50.00000000000044, -50.00000000000044, 44.10000000000001, 14.09999999999976, 25.099999999999916, 25.699999999999925, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 30.699999999999996, 17.899999999999814, 44.5, -50.00000000000044, 38.90000000000002, 43.10000000000001, 44.900000000000006, -50.00000000000044, 41.70000000000002, 33.70000000000004, 37.300000000000026, -50.00000000000044, -50.00000000000044, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 33.10000000000003, 45.5, 13.499999999999751, 45.3, 3.2999999999996064, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 19.09999999999983, 44.900000000000006, 41.500000000000014, 44.10000000000001, 43.900000000000006, 40.10000000000002, 46.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994], "episode_lengths": [500, 500, 84, 60, 344, 500, 40, 500, 156, 500, 500, 500, 500, 86, 500, 224, 500, 500, 68, 500, 500, 384, 68, 72, 500, 160, 50, 500, 192, 468, 48, 122, 370, 500, 500, 60, 360, 250, 244, 500, 82, 500, 500, 500, 500, 500, 166, 194, 322, 56, 500, 112, 70, 52, 500, 84, 164, 128, 500, 500, 50, 76, 500, 500, 64, 58, 500, 500, 500, 58, 170, 46, 366, 48, 468, 96, 44, 500, 500, 500, 500, 500, 272, 500, 500, 500, 500, 36, 500, 310, 52, 86, 60, 62, 100, 38, 100, 500, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021101683294179, "mean_inference_ms": 1.2813537856623447, "mean_action_processing_ms": 0.15167001980463438, "mean_env_wait_ms": 0.08910485604351387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029989004135131836, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.12398982048034668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5167.959127535777, "num_env_steps_trained_throughput_per_sec": 5167.959127535777, "timesteps_total": 504000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 2323.701, "sample_time_ms": 2044.7, "load_time_ms": 13.8, "load_throughput": 869562.141, "learn_time_ms": 255.003, "learn_throughput": 47058.283, "synch_weights_time_ms": 9.099}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1866, "training_iteration": 42, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-45", "timestamp": 1698245085, "time_this_iter_s": 2.326998710632324, "time_total_s": 96.03600072860718, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 96.03600072860718, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 64.46666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864643e-14, "cur_lr": 0.0003, "total_loss": 7.1639885902404785, "policy_loss": -8.93324613571167e-07, "vf_loss": 7.164045015970866, "vf_explained_var": -6.278355916341146e-07, "kl": 0.0004973844215783174, "entropy": 0.5551184952259064, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 638.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.157999999999843, "episode_len_mean": 249.08, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, 44.900000000000006, -50.00000000000044, 41.70000000000002, 33.70000000000004, 37.300000000000026, -50.00000000000044, -50.00000000000044, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 33.10000000000003, 45.5, 13.499999999999751, 45.3, 3.2999999999996064, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 19.09999999999983, 44.900000000000006, 41.500000000000014, 44.10000000000001, 43.900000000000006, 40.10000000000002, 46.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 16.8999999999998, 27.899999999999956, 39.70000000000002, 40.500000000000014, 35.10000000000004, -50.00000000000044, 46.3, 31.70000000000001, 31.900000000000013, 37.90000000000003, 35.70000000000003, -50.00000000000044, 27.299999999999947, 43.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, 46.099999999999994, 41.30000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 38.50000000000003, 43.10000000000001, -50.00000000000044, 40.10000000000002, 30.699999999999996, -50.00000000000044, 16.8999999999998, -50.00000000000044, 41.500000000000014, 40.10000000000002, 39.300000000000026, 45.3, -50.00000000000044, 38.300000000000026, 43.50000000000001, 38.50000000000003, 40.500000000000014, 44.7, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, 29.299999999999976, 24.69999999999991, 41.100000000000016], "episode_lengths": [70, 52, 500, 84, 164, 128, 500, 500, 50, 76, 500, 500, 64, 58, 500, 500, 500, 58, 170, 46, 366, 48, 468, 96, 44, 500, 500, 500, 500, 500, 272, 500, 500, 500, 500, 36, 500, 310, 52, 86, 60, 62, 100, 38, 100, 500, 500, 40, 332, 222, 104, 96, 150, 500, 38, 184, 182, 122, 144, 500, 228, 64, 500, 188, 500, 56, 500, 40, 88, 500, 70, 500, 96, 500, 116, 70, 500, 100, 194, 500, 332, 500, 86, 100, 108, 48, 500, 118, 66, 116, 96, 54, 72, 34, 500, 500, 44, 208, 254, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40216158144424996, "mean_inference_ms": 1.2812559554179308, "mean_action_processing_ms": 0.1516131168476619, "mean_env_wait_ms": 0.08922287910449915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024997711181640625, "StateBufferConnector_ms": 0.0049822330474853516, "ViewRequirementAgentConnector_ms": 0.0989980697631836}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.157999999999843, "episode_len_mean": 249.08, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, 44.900000000000006, -50.00000000000044, 41.70000000000002, 33.70000000000004, 37.300000000000026, -50.00000000000044, -50.00000000000044, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 33.10000000000003, 45.5, 13.499999999999751, 45.3, 3.2999999999996064, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 19.09999999999983, 44.900000000000006, 41.500000000000014, 44.10000000000001, 43.900000000000006, 40.10000000000002, 46.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 16.8999999999998, 27.899999999999956, 39.70000000000002, 40.500000000000014, 35.10000000000004, -50.00000000000044, 46.3, 31.70000000000001, 31.900000000000013, 37.90000000000003, 35.70000000000003, -50.00000000000044, 27.299999999999947, 43.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, 46.099999999999994, 41.30000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 38.50000000000003, 43.10000000000001, -50.00000000000044, 40.10000000000002, 30.699999999999996, -50.00000000000044, 16.8999999999998, -50.00000000000044, 41.500000000000014, 40.10000000000002, 39.300000000000026, 45.3, -50.00000000000044, 38.300000000000026, 43.50000000000001, 38.50000000000003, 40.500000000000014, 44.7, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, 29.299999999999976, 24.69999999999991, 41.100000000000016], "episode_lengths": [70, 52, 500, 84, 164, 128, 500, 500, 50, 76, 500, 500, 64, 58, 500, 500, 500, 58, 170, 46, 366, 48, 468, 96, 44, 500, 500, 500, 500, 500, 272, 500, 500, 500, 500, 36, 500, 310, 52, 86, 60, 62, 100, 38, 100, 500, 500, 40, 332, 222, 104, 96, 150, 500, 38, 184, 182, 122, 144, 500, 228, 64, 500, 188, 500, 56, 500, 40, 88, 500, 70, 500, 96, 500, 116, 70, 500, 100, 194, 500, 332, 500, 86, 100, 108, 48, 500, 118, 66, 116, 96, 54, 72, 34, 500, 500, 44, 208, 254, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40216158144424996, "mean_inference_ms": 1.2812559554179308, "mean_action_processing_ms": 0.1516131168476619, "mean_env_wait_ms": 0.08922287910449915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024997711181640625, "StateBufferConnector_ms": 0.0049822330474853516, "ViewRequirementAgentConnector_ms": 0.0989980697631836}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5390.840605142477, "num_env_steps_trained_throughput_per_sec": 5390.840605142477, "timesteps_total": 516000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 2320.5, "sample_time_ms": 2040.1, "load_time_ms": 14.3, "load_throughput": 839157.302, "learn_time_ms": 255.803, "learn_throughput": 46911.106, "synch_weights_time_ms": 9.199}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 1918, "training_iteration": 43, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-47", "timestamp": 1698245087, "time_this_iter_s": 2.2309982776641846, "time_total_s": 98.26699900627136, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 98.26699900627136, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 57.76666666666667, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2737367544323214e-14, "cur_lr": 0.0003, "total_loss": 7.079391924540202, "policy_loss": -0.00011603285868962605, "vf_loss": 7.0795619010925295, "vf_explained_var": -1.613299051920573e-06, "kl": 0.0002569914952346153, "entropy": 0.5405654609203339, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.97299999999986, "episode_len_mean": 235.98, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000004, -50.00000000000044, 46.3, 31.70000000000001, 31.900000000000013, 37.90000000000003, 35.70000000000003, -50.00000000000044, 27.299999999999947, 43.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, 46.099999999999994, 41.30000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 38.50000000000003, 43.10000000000001, -50.00000000000044, 40.10000000000002, 30.699999999999996, -50.00000000000044, 16.8999999999998, -50.00000000000044, 41.500000000000014, 40.10000000000002, 39.300000000000026, 45.3, -50.00000000000044, 38.300000000000026, 43.50000000000001, 38.50000000000003, 40.500000000000014, 44.7, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, 29.299999999999976, 24.69999999999991, 41.100000000000016, 12.099999999999731, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.7, 39.90000000000002, 46.699999999999996, 46.699999999999996, 24.299999999999905, -50.00000000000044, 44.5, 16.09999999999979, 44.10000000000001, -50.00000000000044, 44.7, 24.899999999999913, 22.699999999999882, 34.30000000000004, 31.500000000000007, 42.500000000000014, 42.70000000000001, 44.900000000000006, 11.099999999999717, -50.00000000000044, -50.00000000000044, 18.29999999999982, 44.7, -50.00000000000044, 42.500000000000014, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 42.500000000000014, 26.89999999999994, 36.50000000000003, 41.100000000000016, 40.70000000000002, -50.00000000000044, 41.70000000000002, 38.10000000000002, 21.89999999999987, -50.00000000000044, 32.30000000000002, -50.00000000000044, 32.90000000000003, 44.300000000000004], "episode_lengths": [150, 500, 38, 184, 182, 122, 144, 500, 228, 64, 500, 188, 500, 56, 500, 40, 88, 500, 70, 500, 96, 500, 116, 70, 500, 100, 194, 500, 332, 500, 86, 100, 108, 48, 500, 118, 66, 116, 96, 54, 72, 34, 500, 500, 44, 208, 254, 90, 380, 500, 500, 48, 500, 54, 102, 34, 34, 258, 500, 56, 340, 60, 500, 54, 252, 274, 158, 186, 76, 74, 52, 390, 500, 500, 318, 54, 500, 76, 500, 86, 500, 70, 500, 58, 500, 76, 76, 232, 136, 90, 94, 500, 84, 120, 282, 500, 178, 500, 172, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40236963110604806, "mean_inference_ms": 1.2813986723428328, "mean_action_processing_ms": 0.1516399508569059, "mean_env_wait_ms": 0.08934625488775151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028005599975585938, "StateBufferConnector_ms": 0.003981113433837891, "ViewRequirementAgentConnector_ms": 0.11099600791931152}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.97299999999986, "episode_len_mean": 235.98, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.10000000000004, -50.00000000000044, 46.3, 31.70000000000001, 31.900000000000013, 37.90000000000003, 35.70000000000003, -50.00000000000044, 27.299999999999947, 43.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, 46.099999999999994, 41.30000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 38.50000000000003, 43.10000000000001, -50.00000000000044, 40.10000000000002, 30.699999999999996, -50.00000000000044, 16.8999999999998, -50.00000000000044, 41.500000000000014, 40.10000000000002, 39.300000000000026, 45.3, -50.00000000000044, 38.300000000000026, 43.50000000000001, 38.50000000000003, 40.500000000000014, 44.7, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, 29.299999999999976, 24.69999999999991, 41.100000000000016, 12.099999999999731, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.7, 39.90000000000002, 46.699999999999996, 46.699999999999996, 24.299999999999905, -50.00000000000044, 44.5, 16.09999999999979, 44.10000000000001, -50.00000000000044, 44.7, 24.899999999999913, 22.699999999999882, 34.30000000000004, 31.500000000000007, 42.500000000000014, 42.70000000000001, 44.900000000000006, 11.099999999999717, -50.00000000000044, -50.00000000000044, 18.29999999999982, 44.7, -50.00000000000044, 42.500000000000014, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 42.500000000000014, 26.89999999999994, 36.50000000000003, 41.100000000000016, 40.70000000000002, -50.00000000000044, 41.70000000000002, 38.10000000000002, 21.89999999999987, -50.00000000000044, 32.30000000000002, -50.00000000000044, 32.90000000000003, 44.300000000000004], "episode_lengths": [150, 500, 38, 184, 182, 122, 144, 500, 228, 64, 500, 188, 500, 56, 500, 40, 88, 500, 70, 500, 96, 500, 116, 70, 500, 100, 194, 500, 332, 500, 86, 100, 108, 48, 500, 118, 66, 116, 96, 54, 72, 34, 500, 500, 44, 208, 254, 90, 380, 500, 500, 48, 500, 54, 102, 34, 34, 258, 500, 56, 340, 60, 500, 54, 252, 274, 158, 186, 76, 74, 52, 390, 500, 500, 318, 54, 500, 76, 500, 86, 500, 70, 500, 58, 500, 76, 76, 232, 136, 90, 94, 500, 84, 120, 282, 500, 178, 500, 172, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40236963110604806, "mean_inference_ms": 1.2813986723428328, "mean_action_processing_ms": 0.1516399508569059, "mean_env_wait_ms": 0.08934625488775151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028005599975585938, "StateBufferConnector_ms": 0.003981113433837891, "ViewRequirementAgentConnector_ms": 0.11099600791931152}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5111.037590943128, "num_env_steps_trained_throughput_per_sec": 5111.037590943128, "timesteps_total": 528000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 2308.886, "sample_time_ms": 2027.5, "load_time_ms": 14.4, "load_throughput": 833331.645, "learn_time_ms": 256.689, "learn_throughput": 46749.218, "synch_weights_time_ms": 9.199}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 1970, "training_iteration": 44, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-49", "timestamp": 1698245089, "time_this_iter_s": 2.3538589477539062, "time_total_s": 100.62085795402527, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 100.62085795402527, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 56.275, "ram_util_percent": 27.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161607e-14, "cur_lr": 0.0003, "total_loss": 7.053269577026367, "policy_loss": -0.00031578317284584043, "vf_loss": 7.053637472788493, "vf_explained_var": 7.947285970052083e-09, "kl": 0.00035985085363184527, "entropy": 0.521184382836024, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 668.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.991999999999884, "episode_len_mean": 210.86, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.09999999999979, 44.10000000000001, -50.00000000000044, 44.7, 24.899999999999913, 22.699999999999882, 34.30000000000004, 31.500000000000007, 42.500000000000014, 42.70000000000001, 44.900000000000006, 11.099999999999717, -50.00000000000044, -50.00000000000044, 18.29999999999982, 44.7, -50.00000000000044, 42.500000000000014, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 42.500000000000014, 26.89999999999994, 36.50000000000003, 41.100000000000016, 40.70000000000002, -50.00000000000044, 41.70000000000002, 38.10000000000002, 21.89999999999987, -50.00000000000044, 32.30000000000002, -50.00000000000044, 32.90000000000003, 44.300000000000004, -50.00000000000044, 45.7, 44.10000000000001, 37.10000000000003, 44.300000000000004, 31.300000000000004, 37.70000000000003, 44.7, -50.00000000000044, 12.69999999999974, 44.10000000000001, 41.100000000000016, -50.00000000000044, 30.9, 47.3, 30.9, 34.70000000000004, 17.69999999999981, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.300000000000026, -50.00000000000044, 9.499999999999694, 46.9, 0.49999999999956657, 29.69999999999998, 40.10000000000002, 45.3, 41.70000000000002, 21.499999999999865, 45.3, 19.499999999999837, 45.9, 46.9, 35.70000000000003, 45.5, 42.30000000000001, 42.30000000000001, 40.500000000000014, 37.50000000000003, 44.5, -50.00000000000044, 45.9, 41.100000000000016, 40.500000000000014, 41.90000000000001, 46.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.10000000000001, 46.3, 42.70000000000001, 42.500000000000014, 44.300000000000004, -50.00000000000044, 39.70000000000002, 39.10000000000002, -50.00000000000044], "episode_lengths": [340, 60, 500, 54, 252, 274, 158, 186, 76, 74, 52, 390, 500, 500, 318, 54, 500, 76, 500, 86, 500, 70, 500, 58, 500, 76, 76, 232, 136, 90, 94, 500, 84, 120, 282, 500, 178, 500, 172, 58, 500, 44, 60, 130, 58, 188, 124, 54, 500, 374, 60, 90, 500, 192, 28, 192, 154, 324, 500, 500, 74, 108, 500, 406, 32, 496, 204, 100, 48, 84, 286, 48, 306, 42, 32, 144, 46, 78, 78, 96, 126, 56, 500, 42, 90, 96, 82, 32, 500, 66, 500, 80, 38, 74, 76, 58, 500, 104, 110, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.402371789144585, "mean_inference_ms": 1.2801553570194393, "mean_action_processing_ms": 0.1520107944754803, "mean_env_wait_ms": 0.08932072357419457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800893783569336, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.14001774787902832}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.991999999999884, "episode_len_mean": 210.86, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.09999999999979, 44.10000000000001, -50.00000000000044, 44.7, 24.899999999999913, 22.699999999999882, 34.30000000000004, 31.500000000000007, 42.500000000000014, 42.70000000000001, 44.900000000000006, 11.099999999999717, -50.00000000000044, -50.00000000000044, 18.29999999999982, 44.7, -50.00000000000044, 42.500000000000014, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 42.500000000000014, 26.89999999999994, 36.50000000000003, 41.100000000000016, 40.70000000000002, -50.00000000000044, 41.70000000000002, 38.10000000000002, 21.89999999999987, -50.00000000000044, 32.30000000000002, -50.00000000000044, 32.90000000000003, 44.300000000000004, -50.00000000000044, 45.7, 44.10000000000001, 37.10000000000003, 44.300000000000004, 31.300000000000004, 37.70000000000003, 44.7, -50.00000000000044, 12.69999999999974, 44.10000000000001, 41.100000000000016, -50.00000000000044, 30.9, 47.3, 30.9, 34.70000000000004, 17.69999999999981, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.300000000000026, -50.00000000000044, 9.499999999999694, 46.9, 0.49999999999956657, 29.69999999999998, 40.10000000000002, 45.3, 41.70000000000002, 21.499999999999865, 45.3, 19.499999999999837, 45.9, 46.9, 35.70000000000003, 45.5, 42.30000000000001, 42.30000000000001, 40.500000000000014, 37.50000000000003, 44.5, -50.00000000000044, 45.9, 41.100000000000016, 40.500000000000014, 41.90000000000001, 46.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.10000000000001, 46.3, 42.70000000000001, 42.500000000000014, 44.300000000000004, -50.00000000000044, 39.70000000000002, 39.10000000000002, -50.00000000000044], "episode_lengths": [340, 60, 500, 54, 252, 274, 158, 186, 76, 74, 52, 390, 500, 500, 318, 54, 500, 76, 500, 86, 500, 70, 500, 58, 500, 76, 76, 232, 136, 90, 94, 500, 84, 120, 282, 500, 178, 500, 172, 58, 500, 44, 60, 130, 58, 188, 124, 54, 500, 374, 60, 90, 500, 192, 28, 192, 154, 324, 500, 500, 74, 108, 500, 406, 32, 496, 204, 100, 48, 84, 286, 48, 306, 42, 32, 144, 46, 78, 78, 96, 126, 56, 500, 42, 90, 96, 82, 32, 500, 66, 500, 80, 38, 74, 76, 58, 500, 104, 110, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.402371789144585, "mean_inference_ms": 1.2801553570194393, "mean_action_processing_ms": 0.1520107944754803, "mean_env_wait_ms": 0.08932072357419457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800893783569336, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.14001774787902832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5309.7266935896405, "num_env_steps_trained_throughput_per_sec": 5309.7266935896405, "timesteps_total": 540000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 2304.587, "sample_time_ms": 2020.1, "load_time_ms": 14.2, "load_throughput": 845064.985, "learn_time_ms": 259.889, "learn_throughput": 46173.625, "synch_weights_time_ms": 9.299}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2030, "training_iteration": 45, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-52", "timestamp": 1698245092, "time_this_iter_s": 2.266000270843506, "time_total_s": 102.88685822486877, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 102.88685822486877, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 67.03333333333335, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.684341886080803e-15, "cur_lr": 0.0003, "total_loss": 6.30758736928304, "policy_loss": -0.0005650460720062256, "vf_loss": 6.308203983306885, "vf_explained_var": -1.4066696166992188e-06, "kl": 0.0009510550889975396, "entropy": 0.5181079069773357, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 683.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.474999999999866, "episode_len_mean": 221.0, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 44.10000000000001, 37.10000000000003, 44.300000000000004, 31.300000000000004, 37.70000000000003, 44.7, -50.00000000000044, 12.69999999999974, 44.10000000000001, 41.100000000000016, -50.00000000000044, 30.9, 47.3, 30.9, 34.70000000000004, 17.69999999999981, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.300000000000026, -50.00000000000044, 9.499999999999694, 46.9, 0.49999999999956657, 29.69999999999998, 40.10000000000002, 45.3, 41.70000000000002, 21.499999999999865, 45.3, 19.499999999999837, 45.9, 46.9, 35.70000000000003, 45.5, 42.30000000000001, 42.30000000000001, 40.500000000000014, 37.50000000000003, 44.5, -50.00000000000044, 45.9, 41.100000000000016, 40.500000000000014, 41.90000000000001, 46.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.10000000000001, 46.3, 42.70000000000001, 42.500000000000014, 44.300000000000004, -50.00000000000044, 39.70000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 11.699999999999726, 40.10000000000002, 45.7, 38.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 37.10000000000003, 4.299999999999621, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.9, 34.50000000000004, 44.300000000000004, 44.10000000000001, 30.099999999999987, 43.30000000000001, -50.00000000000044, 42.30000000000001, 30.499999999999993, 45.5, 9.499999999999694, -50.00000000000044, 4.499999999999623, 35.500000000000036, -50.00000000000044, 39.70000000000002, 43.10000000000001], "episode_lengths": [44, 60, 130, 58, 188, 124, 54, 500, 374, 60, 90, 500, 192, 28, 192, 154, 324, 500, 500, 74, 108, 500, 406, 32, 496, 204, 100, 48, 84, 286, 48, 306, 42, 32, 144, 46, 78, 78, 96, 126, 56, 500, 42, 90, 96, 82, 32, 500, 66, 500, 80, 38, 74, 76, 58, 500, 104, 110, 500, 500, 500, 500, 72, 60, 500, 500, 500, 42, 30, 384, 100, 44, 120, 500, 58, 500, 500, 130, 458, 500, 106, 500, 500, 42, 156, 58, 60, 200, 68, 500, 78, 196, 46, 406, 500, 456, 146, 500, 104, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40239171164916043, "mean_inference_ms": 1.2788945086268102, "mean_action_processing_ms": 0.15181304925666833, "mean_env_wait_ms": 0.08952911257850982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031996965408325195, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.14201712608337402}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.474999999999866, "episode_len_mean": 221.0, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 44.10000000000001, 37.10000000000003, 44.300000000000004, 31.300000000000004, 37.70000000000003, 44.7, -50.00000000000044, 12.69999999999974, 44.10000000000001, 41.100000000000016, -50.00000000000044, 30.9, 47.3, 30.9, 34.70000000000004, 17.69999999999981, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.300000000000026, -50.00000000000044, 9.499999999999694, 46.9, 0.49999999999956657, 29.69999999999998, 40.10000000000002, 45.3, 41.70000000000002, 21.499999999999865, 45.3, 19.499999999999837, 45.9, 46.9, 35.70000000000003, 45.5, 42.30000000000001, 42.30000000000001, 40.500000000000014, 37.50000000000003, 44.5, -50.00000000000044, 45.9, 41.100000000000016, 40.500000000000014, 41.90000000000001, 46.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.10000000000001, 46.3, 42.70000000000001, 42.500000000000014, 44.300000000000004, -50.00000000000044, 39.70000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 11.699999999999726, 40.10000000000002, 45.7, 38.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 37.10000000000003, 4.299999999999621, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.9, 34.50000000000004, 44.300000000000004, 44.10000000000001, 30.099999999999987, 43.30000000000001, -50.00000000000044, 42.30000000000001, 30.499999999999993, 45.5, 9.499999999999694, -50.00000000000044, 4.499999999999623, 35.500000000000036, -50.00000000000044, 39.70000000000002, 43.10000000000001], "episode_lengths": [44, 60, 130, 58, 188, 124, 54, 500, 374, 60, 90, 500, 192, 28, 192, 154, 324, 500, 500, 74, 108, 500, 406, 32, 496, 204, 100, 48, 84, 286, 48, 306, 42, 32, 144, 46, 78, 78, 96, 126, 56, 500, 42, 90, 96, 82, 32, 500, 66, 500, 80, 38, 74, 76, 58, 500, 104, 110, 500, 500, 500, 500, 72, 60, 500, 500, 500, 42, 30, 384, 100, 44, 120, 500, 58, 500, 500, 130, 458, 500, 106, 500, 500, 42, 156, 58, 60, 200, 68, 500, 78, 196, 46, 406, 500, 456, 146, 500, 104, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40239171164916043, "mean_inference_ms": 1.2788945086268102, "mean_action_processing_ms": 0.15181304925666833, "mean_env_wait_ms": 0.08952911257850982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031996965408325195, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.14201712608337402}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5323.863731321339, "num_env_steps_trained_throughput_per_sec": 5323.863731321339, "timesteps_total": 552000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 2295.987, "sample_time_ms": 2013.4, "load_time_ms": 14.2, "load_throughput": 845062.148, "learn_time_ms": 258.088, "learn_throughput": 46495.706, "synch_weights_time_ms": 9.2}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 2071, "training_iteration": 46, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-54", "timestamp": 1698245094, "time_this_iter_s": 2.258999824523926, "time_total_s": 105.1458580493927, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 105.1458580493927, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 59.46666666666667, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404017e-15, "cur_lr": 0.0003, "total_loss": 6.003457323710124, "policy_loss": -6.336464236179987e-05, "vf_loss": 6.003566233317057, "vf_explained_var": -1.8437703450520833e-06, "kl": 6.845724668285887e-05, "entropy": 0.4541972021261851, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 698.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.321999999999821, "episode_len_mean": 257.4, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.90000000000001, 46.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.10000000000001, 46.3, 42.70000000000001, 42.500000000000014, 44.300000000000004, -50.00000000000044, 39.70000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 11.699999999999726, 40.10000000000002, 45.7, 38.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 37.10000000000003, 4.299999999999621, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.9, 34.50000000000004, 44.300000000000004, 44.10000000000001, 30.099999999999987, 43.30000000000001, -50.00000000000044, 42.30000000000001, 30.499999999999993, 45.5, 9.499999999999694, -50.00000000000044, 4.499999999999623, 35.500000000000036, -50.00000000000044, 39.70000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.50000000000001, 18.099999999999817, 40.70000000000002, 42.30000000000001, 45.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, -50.00000000000044, 46.099999999999994, 40.500000000000014, 42.10000000000001, 43.30000000000001, 24.299999999999905, -50.00000000000044, 42.70000000000001, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 36.70000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 31.500000000000007, 45.3, -50.00000000000044, 43.10000000000001, 45.1], "episode_lengths": [82, 32, 500, 66, 500, 80, 38, 74, 76, 58, 500, 104, 110, 500, 500, 500, 500, 72, 60, 500, 500, 500, 42, 30, 384, 100, 44, 120, 500, 58, 500, 500, 130, 458, 500, 106, 500, 500, 42, 156, 58, 60, 200, 68, 500, 78, 196, 46, 406, 500, 456, 146, 500, 104, 70, 500, 500, 62, 500, 66, 320, 94, 78, 46, 500, 86, 500, 500, 500, 110, 74, 500, 40, 96, 80, 68, 258, 500, 74, 40, 42, 500, 500, 500, 500, 36, 500, 500, 54, 500, 134, 74, 500, 500, 44, 186, 48, 500, 70, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.401453479436246, "mean_inference_ms": 1.278596164057058, "mean_action_processing_ms": 0.1519198206521528, "mean_env_wait_ms": 0.08898761464599449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799844741821289, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.13500690460205078}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.321999999999821, "episode_len_mean": 257.4, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.90000000000001, 46.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.10000000000001, 46.3, 42.70000000000001, 42.500000000000014, 44.300000000000004, -50.00000000000044, 39.70000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 11.699999999999726, 40.10000000000002, 45.7, 38.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 37.10000000000003, 4.299999999999621, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.9, 34.50000000000004, 44.300000000000004, 44.10000000000001, 30.099999999999987, 43.30000000000001, -50.00000000000044, 42.30000000000001, 30.499999999999993, 45.5, 9.499999999999694, -50.00000000000044, 4.499999999999623, 35.500000000000036, -50.00000000000044, 39.70000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.50000000000001, 18.099999999999817, 40.70000000000002, 42.30000000000001, 45.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, -50.00000000000044, 46.099999999999994, 40.500000000000014, 42.10000000000001, 43.30000000000001, 24.299999999999905, -50.00000000000044, 42.70000000000001, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 36.70000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 31.500000000000007, 45.3, -50.00000000000044, 43.10000000000001, 45.1], "episode_lengths": [82, 32, 500, 66, 500, 80, 38, 74, 76, 58, 500, 104, 110, 500, 500, 500, 500, 72, 60, 500, 500, 500, 42, 30, 384, 100, 44, 120, 500, 58, 500, 500, 130, 458, 500, 106, 500, 500, 42, 156, 58, 60, 200, 68, 500, 78, 196, 46, 406, 500, 456, 146, 500, 104, 70, 500, 500, 62, 500, 66, 320, 94, 78, 46, 500, 86, 500, 500, 500, 110, 74, 500, 40, 96, 80, 68, 258, 500, 74, 40, 42, 500, 500, 500, 500, 36, 500, 500, 54, 500, 134, 74, 500, 500, 44, 186, 48, 500, 70, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.401453479436246, "mean_inference_ms": 1.278596164057058, "mean_action_processing_ms": 0.1519198206521528, "mean_env_wait_ms": 0.08898761464599449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799844741821289, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.13500690460205078}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5636.448542242416, "num_env_steps_trained_throughput_per_sec": 5636.448542242416, "timesteps_total": 564000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 2271.487, "sample_time_ms": 2011.1, "load_time_ms": 13.2, "load_throughput": 909086.193, "learn_time_ms": 236.789, "learn_throughput": 50678.134, "synch_weights_time_ms": 9.299}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 2116, "training_iteration": 47, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-56", "timestamp": 1698245096, "time_this_iter_s": 2.1339993476867676, "time_total_s": 107.27985739707947, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 107.27985739707947, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 60.699999999999996, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202008e-15, "cur_lr": 0.0003, "total_loss": 6.46722043355306, "policy_loss": 2.5845132768154144e-05, "vf_loss": 6.467243035634358, "vf_explained_var": 1.4702479044596355e-07, "kl": 0.00014673191339322026, "entropy": 0.48504332105318704, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 713.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0409999999998085, "episode_len_mean": 275.18, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, 42.30000000000001, 30.499999999999993, 45.5, 9.499999999999694, -50.00000000000044, 4.499999999999623, 35.500000000000036, -50.00000000000044, 39.70000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.50000000000001, 18.099999999999817, 40.70000000000002, 42.30000000000001, 45.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, -50.00000000000044, 46.099999999999994, 40.500000000000014, 42.10000000000001, 43.30000000000001, 24.299999999999905, -50.00000000000044, 42.70000000000001, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 36.70000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 31.500000000000007, 45.3, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 40.500000000000014, 39.50000000000002, 42.10000000000001, 44.10000000000001, -50.00000000000044, 41.100000000000016, 40.30000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 45.5, -50.00000000000044, 43.50000000000001, 45.1, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, 43.50000000000001, 26.89999999999994, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 38.50000000000003, 15.099999999999774, 43.30000000000001, 33.10000000000003, -50.00000000000044], "episode_lengths": [68, 500, 78, 196, 46, 406, 500, 456, 146, 500, 104, 70, 500, 500, 62, 500, 66, 320, 94, 78, 46, 500, 86, 500, 500, 500, 110, 74, 500, 40, 96, 80, 68, 258, 500, 74, 40, 42, 500, 500, 500, 500, 36, 500, 500, 54, 500, 134, 74, 500, 500, 44, 186, 48, 500, 70, 50, 500, 122, 500, 48, 500, 500, 96, 106, 80, 60, 500, 90, 98, 134, 500, 500, 500, 370, 46, 500, 66, 50, 164, 500, 500, 500, 184, 500, 500, 152, 66, 232, 500, 200, 500, 500, 50, 500, 116, 350, 68, 170, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40102344157701525, "mean_inference_ms": 1.2789016958280686, "mean_action_processing_ms": 0.15136383588306987, "mean_env_wait_ms": 0.08877909143991858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199577331542969, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.12497949600219727}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0409999999998085, "episode_len_mean": 275.18, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, 42.30000000000001, 30.499999999999993, 45.5, 9.499999999999694, -50.00000000000044, 4.499999999999623, 35.500000000000036, -50.00000000000044, 39.70000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.50000000000001, 18.099999999999817, 40.70000000000002, 42.30000000000001, 45.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, -50.00000000000044, 46.099999999999994, 40.500000000000014, 42.10000000000001, 43.30000000000001, 24.299999999999905, -50.00000000000044, 42.70000000000001, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 36.70000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 31.500000000000007, 45.3, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 40.500000000000014, 39.50000000000002, 42.10000000000001, 44.10000000000001, -50.00000000000044, 41.100000000000016, 40.30000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 45.5, -50.00000000000044, 43.50000000000001, 45.1, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, 43.50000000000001, 26.89999999999994, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 38.50000000000003, 15.099999999999774, 43.30000000000001, 33.10000000000003, -50.00000000000044], "episode_lengths": [68, 500, 78, 196, 46, 406, 500, 456, 146, 500, 104, 70, 500, 500, 62, 500, 66, 320, 94, 78, 46, 500, 86, 500, 500, 500, 110, 74, 500, 40, 96, 80, 68, 258, 500, 74, 40, 42, 500, 500, 500, 500, 36, 500, 500, 54, 500, 134, 74, 500, 500, 44, 186, 48, 500, 70, 50, 500, 122, 500, 48, 500, 500, 96, 106, 80, 60, 500, 90, 98, 134, 500, 500, 500, 370, 46, 500, 66, 50, 164, 500, 500, 500, 184, 500, 500, 152, 66, 232, 500, 200, 500, 500, 50, 500, 116, 350, 68, 170, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40102344157701525, "mean_inference_ms": 1.2789016958280686, "mean_action_processing_ms": 0.15136383588306987, "mean_env_wait_ms": 0.08877909143991858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199577331542969, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.12497949600219727}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5385.993131023663, "num_env_steps_trained_throughput_per_sec": 5385.993131023663, "timesteps_total": 576000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 2263.587, "sample_time_ms": 2001.1, "load_time_ms": 13.0, "load_throughput": 923081.189, "learn_time_ms": 238.689, "learn_throughput": 50274.556, "synch_weights_time_ms": 9.799}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2159, "training_iteration": 48, "trial_id": "9f288_00003", "date": "2023-10-25_15-44-58", "timestamp": 1698245098, "time_this_iter_s": 2.2339985370635986, "time_total_s": 109.51385593414307, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 109.51385593414307, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 64.23333333333333, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601004e-16, "cur_lr": 0.0003, "total_loss": 6.535873381296794, "policy_loss": -0.00020955974857012432, "vf_loss": 6.536133543650309, "vf_explained_var": -1.8596649169921875e-06, "kl": 0.00027786154274143845, "entropy": 0.5067835330963135, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 728.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.285999999999854, "episode_len_mean": 237.82, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.90000000000003, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 40.500000000000014, 39.50000000000002, 42.10000000000001, 44.10000000000001, -50.00000000000044, 41.100000000000016, 40.30000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 45.5, -50.00000000000044, 43.50000000000001, 45.1, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, 43.50000000000001, 26.89999999999994, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 38.50000000000003, 15.099999999999774, 43.30000000000001, 33.10000000000003, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.300000000000026, -50.00000000000044, 40.10000000000002, 23.699999999999896, 42.500000000000014, 43.10000000000001, 38.10000000000002, -50.00000000000044, 39.90000000000002, -50.00000000000044, 37.10000000000003, 27.49999999999995, -50.00000000000044, 44.900000000000006, 28.89999999999997, 23.699999999999896, -50.00000000000044, 25.099999999999916, 43.7, 41.90000000000001, 43.10000000000001, 29.69999999999998, 47.1, 38.10000000000002, -50.00000000000044, 44.900000000000006, 40.90000000000002, 45.9, 46.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.499999999999922, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.699999999999996, 42.10000000000001, 45.3, -50.00000000000044, 45.1, 42.500000000000014, 41.70000000000002, 43.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 20.49999999999985, 45.3, 43.7, 42.500000000000014, 41.500000000000014, 38.700000000000024, 42.30000000000001, 40.10000000000002], "episode_lengths": [122, 500, 48, 500, 500, 96, 106, 80, 60, 500, 90, 98, 134, 500, 500, 500, 370, 46, 500, 66, 50, 164, 500, 500, 500, 184, 500, 500, 152, 66, 232, 500, 200, 500, 500, 50, 500, 116, 350, 68, 170, 500, 500, 142, 118, 500, 100, 264, 76, 70, 120, 500, 102, 500, 130, 226, 500, 52, 212, 264, 500, 250, 64, 82, 70, 204, 30, 120, 500, 52, 92, 42, 32, 500, 70, 500, 246, 68, 500, 40, 500, 34, 80, 48, 500, 50, 76, 84, 62, 30, 500, 500, 296, 48, 64, 76, 86, 114, 78, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4012959132404114, "mean_inference_ms": 1.2788994581218252, "mean_action_processing_ms": 0.15103489349580485, "mean_env_wait_ms": 0.08886887721915222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02998805046081543, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.11100363731384277}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.285999999999854, "episode_len_mean": 237.82, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.90000000000003, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 40.500000000000014, 39.50000000000002, 42.10000000000001, 44.10000000000001, -50.00000000000044, 41.100000000000016, 40.30000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 45.5, -50.00000000000044, 43.50000000000001, 45.1, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, 43.50000000000001, 26.89999999999994, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 38.50000000000003, 15.099999999999774, 43.30000000000001, 33.10000000000003, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.300000000000026, -50.00000000000044, 40.10000000000002, 23.699999999999896, 42.500000000000014, 43.10000000000001, 38.10000000000002, -50.00000000000044, 39.90000000000002, -50.00000000000044, 37.10000000000003, 27.49999999999995, -50.00000000000044, 44.900000000000006, 28.89999999999997, 23.699999999999896, -50.00000000000044, 25.099999999999916, 43.7, 41.90000000000001, 43.10000000000001, 29.69999999999998, 47.1, 38.10000000000002, -50.00000000000044, 44.900000000000006, 40.90000000000002, 45.9, 46.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.499999999999922, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.699999999999996, 42.10000000000001, 45.3, -50.00000000000044, 45.1, 42.500000000000014, 41.70000000000002, 43.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 20.49999999999985, 45.3, 43.7, 42.500000000000014, 41.500000000000014, 38.700000000000024, 42.30000000000001, 40.10000000000002], "episode_lengths": [122, 500, 48, 500, 500, 96, 106, 80, 60, 500, 90, 98, 134, 500, 500, 500, 370, 46, 500, 66, 50, 164, 500, 500, 500, 184, 500, 500, 152, 66, 232, 500, 200, 500, 500, 50, 500, 116, 350, 68, 170, 500, 500, 142, 118, 500, 100, 264, 76, 70, 120, 500, 102, 500, 130, 226, 500, 52, 212, 264, 500, 250, 64, 82, 70, 204, 30, 120, 500, 52, 92, 42, 32, 500, 70, 500, 246, 68, 500, 40, 500, 34, 80, 48, 500, 50, 76, 84, 62, 30, 500, 500, 296, 48, 64, 76, 86, 114, 78, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4012959132404114, "mean_inference_ms": 1.2788994581218252, "mean_action_processing_ms": 0.15103489349580485, "mean_env_wait_ms": 0.08886887721915222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02998805046081543, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.11100363731384277}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5089.05535038561, "num_env_steps_trained_throughput_per_sec": 5089.05535038561, "timesteps_total": 588000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 2266.687, "sample_time_ms": 2005.399, "load_time_ms": 11.3, "load_throughput": 1061954.413, "learn_time_ms": 239.189, "learn_throughput": 50169.475, "synch_weights_time_ms": 9.799}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 2217, "training_iteration": 49, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-01", "timestamp": 1698245101, "time_this_iter_s": 2.3639976978302, "time_total_s": 111.87785363197327, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 111.87785363197327, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 65.7, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.552713678800502e-16, "cur_lr": 0.0003, "total_loss": 6.649161020914714, "policy_loss": -0.00046469569206237794, "vf_loss": 6.649674701690674, "vf_explained_var": -1.8676122029622396e-07, "kl": 0.0004392457124216283, "entropy": 0.49023568630218506, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.875999999999852, "episode_len_mean": 231.94, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.300000000000026, -50.00000000000044, 40.10000000000002, 23.699999999999896, 42.500000000000014, 43.10000000000001, 38.10000000000002, -50.00000000000044, 39.90000000000002, -50.00000000000044, 37.10000000000003, 27.49999999999995, -50.00000000000044, 44.900000000000006, 28.89999999999997, 23.699999999999896, -50.00000000000044, 25.099999999999916, 43.7, 41.90000000000001, 43.10000000000001, 29.69999999999998, 47.1, 38.10000000000002, -50.00000000000044, 44.900000000000006, 40.90000000000002, 45.9, 46.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.499999999999922, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.699999999999996, 42.10000000000001, 45.3, -50.00000000000044, 45.1, 42.500000000000014, 41.70000000000002, 43.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 20.49999999999985, 45.3, 43.7, 42.500000000000014, 41.500000000000014, 38.700000000000024, 42.30000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.7, 39.90000000000002, 45.3, 13.899999999999757, -50.00000000000044, 21.09999999999986, 43.900000000000006, 43.7, 46.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 41.70000000000002, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 44.7, -50.00000000000044, 42.70000000000001, 43.900000000000006, 46.699999999999996, 43.900000000000006, 1.4999999999995808, 46.9, 43.7, -50.00000000000044, 30.9, -50.00000000000044, 23.699999999999896, 44.7], "episode_lengths": [118, 500, 100, 264, 76, 70, 120, 500, 102, 500, 130, 226, 500, 52, 212, 264, 500, 250, 64, 82, 70, 204, 30, 120, 500, 52, 92, 42, 32, 500, 70, 500, 246, 68, 500, 40, 500, 34, 80, 48, 500, 50, 76, 84, 62, 30, 500, 500, 296, 48, 64, 76, 86, 114, 78, 100, 500, 500, 102, 500, 64, 102, 48, 362, 500, 290, 62, 64, 38, 76, 500, 500, 500, 56, 84, 484, 500, 500, 286, 500, 500, 84, 500, 500, 92, 500, 54, 500, 74, 62, 34, 62, 486, 32, 64, 500, 192, 500, 264, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.401384135362293, "mean_inference_ms": 1.278985929891621, "mean_action_processing_ms": 0.1515370096365974, "mean_env_wait_ms": 0.08888079821232273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029997825622558594, "StateBufferConnector_ms": 0.003001689910888672, "ViewRequirementAgentConnector_ms": 0.0970163345336914}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.875999999999852, "episode_len_mean": 231.94, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.300000000000026, -50.00000000000044, 40.10000000000002, 23.699999999999896, 42.500000000000014, 43.10000000000001, 38.10000000000002, -50.00000000000044, 39.90000000000002, -50.00000000000044, 37.10000000000003, 27.49999999999995, -50.00000000000044, 44.900000000000006, 28.89999999999997, 23.699999999999896, -50.00000000000044, 25.099999999999916, 43.7, 41.90000000000001, 43.10000000000001, 29.69999999999998, 47.1, 38.10000000000002, -50.00000000000044, 44.900000000000006, 40.90000000000002, 45.9, 46.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.499999999999922, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.699999999999996, 42.10000000000001, 45.3, -50.00000000000044, 45.1, 42.500000000000014, 41.70000000000002, 43.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 20.49999999999985, 45.3, 43.7, 42.500000000000014, 41.500000000000014, 38.700000000000024, 42.30000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.7, 39.90000000000002, 45.3, 13.899999999999757, -50.00000000000044, 21.09999999999986, 43.900000000000006, 43.7, 46.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 41.70000000000002, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 44.7, -50.00000000000044, 42.70000000000001, 43.900000000000006, 46.699999999999996, 43.900000000000006, 1.4999999999995808, 46.9, 43.7, -50.00000000000044, 30.9, -50.00000000000044, 23.699999999999896, 44.7], "episode_lengths": [118, 500, 100, 264, 76, 70, 120, 500, 102, 500, 130, 226, 500, 52, 212, 264, 500, 250, 64, 82, 70, 204, 30, 120, 500, 52, 92, 42, 32, 500, 70, 500, 246, 68, 500, 40, 500, 34, 80, 48, 500, 50, 76, 84, 62, 30, 500, 500, 296, 48, 64, 76, 86, 114, 78, 100, 500, 500, 102, 500, 64, 102, 48, 362, 500, 290, 62, 64, 38, 76, 500, 500, 500, 56, 84, 484, 500, 500, 286, 500, 500, 84, 500, 500, 92, 500, 54, 500, 74, 62, 34, 62, 486, 32, 64, 500, 192, 500, 264, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.401384135362293, "mean_inference_ms": 1.278985929891621, "mean_action_processing_ms": 0.1515370096365974, "mean_env_wait_ms": 0.08888079821232273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029997825622558594, "StateBufferConnector_ms": 0.003001689910888672, "ViewRequirementAgentConnector_ms": 0.0970163345336914}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5314.432186348956, "num_env_steps_trained_throughput_per_sec": 5314.432186348956, "timesteps_total": 600000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 2281.187, "sample_time_ms": 2008.399, "load_time_ms": 11.6, "load_throughput": 1034500.33, "learn_time_ms": 250.389, "learn_throughput": 47925.382, "synch_weights_time_ms": 9.799}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 2261, "training_iteration": 50, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-03", "timestamp": 1698245103, "time_this_iter_s": 2.2629992961883545, "time_total_s": 114.14085292816162, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 114.14085292816162, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 58.425, "ram_util_percent": 27.049999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.776356839400251e-16, "cur_lr": 0.0003, "total_loss": 6.680434767405192, "policy_loss": -0.00014575223128000895, "vf_loss": 6.680632209777832, "vf_explained_var": -1.7325083414713542e-06, "kl": 0.0004373382400444825, "entropy": 0.5168718000253042, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 758.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.370999999999811, "episode_len_mean": 271.92, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, 45.3, -50.00000000000044, 45.1, 42.500000000000014, 41.70000000000002, 43.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 20.49999999999985, 45.3, 43.7, 42.500000000000014, 41.500000000000014, 38.700000000000024, 42.30000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.7, 39.90000000000002, 45.3, 13.899999999999757, -50.00000000000044, 21.09999999999986, 43.900000000000006, 43.7, 46.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 41.70000000000002, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 44.7, -50.00000000000044, 42.70000000000001, 43.900000000000006, 46.699999999999996, 43.900000000000006, 1.4999999999995808, 46.9, 43.7, -50.00000000000044, 30.9, -50.00000000000044, 23.699999999999896, 44.7, -50.00000000000044, 33.500000000000036, 45.7, 11.699999999999726, 34.70000000000004, 43.10000000000001, 20.899999999999856, -50.00000000000044, 13.899999999999757, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, 5.6999999999996405, -50.00000000000044, 40.500000000000014, 46.699999999999996, -50.00000000000044, 35.70000000000003, 44.10000000000001, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 46.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 37.50000000000003, 26.69999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [80, 48, 500, 50, 76, 84, 62, 30, 500, 500, 296, 48, 64, 76, 86, 114, 78, 100, 500, 500, 102, 500, 64, 102, 48, 362, 500, 290, 62, 64, 38, 76, 500, 500, 500, 56, 84, 484, 500, 500, 286, 500, 500, 84, 500, 500, 92, 500, 54, 500, 74, 62, 34, 62, 486, 32, 64, 500, 192, 500, 264, 54, 500, 166, 44, 384, 154, 70, 292, 500, 362, 78, 500, 500, 82, 390, 500, 500, 444, 500, 96, 34, 500, 144, 60, 228, 500, 500, 500, 500, 500, 210, 36, 500, 500, 94, 126, 234, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4007125812033368, "mean_inference_ms": 1.2779302514062965, "mean_action_processing_ms": 0.15151472437428404, "mean_env_wait_ms": 0.0887040682989122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400040626525879, "StateBufferConnector_ms": 0.0020008087158203125, "ViewRequirementAgentConnector_ms": 0.10900402069091797}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.370999999999811, "episode_len_mean": 271.92, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, 45.3, -50.00000000000044, 45.1, 42.500000000000014, 41.70000000000002, 43.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 20.49999999999985, 45.3, 43.7, 42.500000000000014, 41.500000000000014, 38.700000000000024, 42.30000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.7, 39.90000000000002, 45.3, 13.899999999999757, -50.00000000000044, 21.09999999999986, 43.900000000000006, 43.7, 46.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 41.70000000000002, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 44.7, -50.00000000000044, 42.70000000000001, 43.900000000000006, 46.699999999999996, 43.900000000000006, 1.4999999999995808, 46.9, 43.7, -50.00000000000044, 30.9, -50.00000000000044, 23.699999999999896, 44.7, -50.00000000000044, 33.500000000000036, 45.7, 11.699999999999726, 34.70000000000004, 43.10000000000001, 20.899999999999856, -50.00000000000044, 13.899999999999757, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, 5.6999999999996405, -50.00000000000044, 40.500000000000014, 46.699999999999996, -50.00000000000044, 35.70000000000003, 44.10000000000001, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 46.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 37.50000000000003, 26.69999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [80, 48, 500, 50, 76, 84, 62, 30, 500, 500, 296, 48, 64, 76, 86, 114, 78, 100, 500, 500, 102, 500, 64, 102, 48, 362, 500, 290, 62, 64, 38, 76, 500, 500, 500, 56, 84, 484, 500, 500, 286, 500, 500, 84, 500, 500, 92, 500, 54, 500, 74, 62, 34, 62, 486, 32, 64, 500, 192, 500, 264, 54, 500, 166, 44, 384, 154, 70, 292, 500, 362, 78, 500, 500, 82, 390, 500, 500, 444, 500, 96, 34, 500, 144, 60, 228, 500, 500, 500, 500, 500, 210, 36, 500, 500, 94, 126, 234, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4007125812033368, "mean_inference_ms": 1.2779302514062965, "mean_action_processing_ms": 0.15151472437428404, "mean_env_wait_ms": 0.0887040682989122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400040626525879, "StateBufferConnector_ms": 0.0020008087158203125, "ViewRequirementAgentConnector_ms": 0.10900402069091797}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5442.178235935625, "num_env_steps_trained_throughput_per_sec": 5442.178235935625, "timesteps_total": 612000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 2258.787, "sample_time_ms": 1985.899, "load_time_ms": 12.6, "load_throughput": 952385.104, "learn_time_ms": 249.492, "learn_throughput": 48097.675, "synch_weights_time_ms": 9.699}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2299, "training_iteration": 51, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-05", "timestamp": 1698245105, "time_this_iter_s": 2.2109968662261963, "time_total_s": 116.35184979438782, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 116.35184979438782, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 62.76666666666667, "ram_util_percent": 27.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001255e-17, "cur_lr": 0.0003, "total_loss": 6.871422894795736, "policy_loss": -0.0007599890232086182, "vf_loss": 6.872240416208903, "vf_explained_var": -1.1761983235677084e-06, "kl": 0.0010393776169545768, "entropy": 0.57532825867335, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 773.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.328999999999828, "episode_len_mean": 262.38, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 1.4999999999995808, 46.9, 43.7, -50.00000000000044, 30.9, -50.00000000000044, 23.699999999999896, 44.7, -50.00000000000044, 33.500000000000036, 45.7, 11.699999999999726, 34.70000000000004, 43.10000000000001, 20.899999999999856, -50.00000000000044, 13.899999999999757, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, 5.6999999999996405, -50.00000000000044, 40.500000000000014, 46.699999999999996, -50.00000000000044, 35.70000000000003, 44.10000000000001, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 46.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 37.50000000000003, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.499999999999936, 40.70000000000002, 16.29999999999979, 39.50000000000002, 39.90000000000002, 43.50000000000001, -50.00000000000044, 47.5, 44.300000000000004, 41.100000000000016, 12.099999999999731, 44.10000000000001, 6.8999999999996575, 45.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.10000000000001, 33.10000000000003, 32.90000000000003, 30.9, 16.09999999999979, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.7, 33.70000000000004, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.10000000000001, 46.5, 42.500000000000014, 44.5, 38.10000000000002, 45.9, 43.7, 42.30000000000001, 40.10000000000002, -50.00000000000044, 14.299999999999763, 39.70000000000002, 45.5], "episode_lengths": [62, 486, 32, 64, 500, 192, 500, 264, 54, 500, 166, 44, 384, 154, 70, 292, 500, 362, 78, 500, 500, 82, 390, 500, 500, 444, 500, 96, 34, 500, 144, 60, 228, 500, 500, 500, 500, 500, 210, 36, 500, 500, 94, 126, 234, 500, 500, 500, 236, 94, 338, 106, 102, 66, 500, 26, 58, 90, 380, 60, 432, 42, 500, 500, 60, 70, 170, 172, 192, 340, 500, 500, 142, 44, 164, 500, 500, 116, 40, 30, 60, 500, 500, 500, 500, 500, 86, 60, 36, 76, 56, 120, 42, 64, 78, 100, 500, 358, 104, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40062255430456406, "mean_inference_ms": 1.2770664948476504, "mean_action_processing_ms": 0.15108452386889226, "mean_env_wait_ms": 0.08858313808129284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01599597930908203, "StateBufferConnector_ms": 0.011002063751220703, "ViewRequirementAgentConnector_ms": 0.11790156364440918}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.328999999999828, "episode_len_mean": 262.38, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 1.4999999999995808, 46.9, 43.7, -50.00000000000044, 30.9, -50.00000000000044, 23.699999999999896, 44.7, -50.00000000000044, 33.500000000000036, 45.7, 11.699999999999726, 34.70000000000004, 43.10000000000001, 20.899999999999856, -50.00000000000044, 13.899999999999757, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, 5.6999999999996405, -50.00000000000044, 40.500000000000014, 46.699999999999996, -50.00000000000044, 35.70000000000003, 44.10000000000001, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 46.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 37.50000000000003, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.499999999999936, 40.70000000000002, 16.29999999999979, 39.50000000000002, 39.90000000000002, 43.50000000000001, -50.00000000000044, 47.5, 44.300000000000004, 41.100000000000016, 12.099999999999731, 44.10000000000001, 6.8999999999996575, 45.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.10000000000001, 33.10000000000003, 32.90000000000003, 30.9, 16.09999999999979, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.7, 33.70000000000004, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.10000000000001, 46.5, 42.500000000000014, 44.5, 38.10000000000002, 45.9, 43.7, 42.30000000000001, 40.10000000000002, -50.00000000000044, 14.299999999999763, 39.70000000000002, 45.5], "episode_lengths": [62, 486, 32, 64, 500, 192, 500, 264, 54, 500, 166, 44, 384, 154, 70, 292, 500, 362, 78, 500, 500, 82, 390, 500, 500, 444, 500, 96, 34, 500, 144, 60, 228, 500, 500, 500, 500, 500, 210, 36, 500, 500, 94, 126, 234, 500, 500, 500, 236, 94, 338, 106, 102, 66, 500, 26, 58, 90, 380, 60, 432, 42, 500, 500, 60, 70, 170, 172, 192, 340, 500, 500, 142, 44, 164, 500, 500, 116, 40, 30, 60, 500, 500, 500, 500, 500, 86, 60, 36, 76, 56, 120, 42, 64, 78, 100, 500, 358, 104, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40062255430456406, "mean_inference_ms": 1.2770664948476504, "mean_action_processing_ms": 0.15108452386889226, "mean_env_wait_ms": 0.08858313808129284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01599597930908203, "StateBufferConnector_ms": 0.011002063751220703, "ViewRequirementAgentConnector_ms": 0.11790156364440918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5489.473436802829, "num_env_steps_trained_throughput_per_sec": 5489.473436802829, "timesteps_total": 624000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 2245.187, "sample_time_ms": 1978.899, "load_time_ms": 12.0, "load_throughput": 1000002.941, "learn_time_ms": 243.389, "learn_throughput": 49303.725, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 2352, "training_iteration": 52, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-07", "timestamp": 1698245107, "time_this_iter_s": 2.1909995079040527, "time_total_s": 118.54284930229187, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 118.54284930229187, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 61.866666666666674, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.4408920985006276e-17, "cur_lr": 0.0003, "total_loss": 6.437605158487956, "policy_loss": -0.00018999030192693074, "vf_loss": 6.437849108378092, "vf_explained_var": -1.2079874674479166e-06, "kl": 0.00012350342692949803, "entropy": 0.5379896521568298, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 788.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7609999999998105, "episode_len_mean": 278.0, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 29.099999999999973, 46.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 37.50000000000003, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.499999999999936, 40.70000000000002, 16.29999999999979, 39.50000000000002, 39.90000000000002, 43.50000000000001, -50.00000000000044, 47.5, 44.300000000000004, 41.100000000000016, 12.099999999999731, 44.10000000000001, 6.8999999999996575, 45.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.10000000000001, 33.10000000000003, 32.90000000000003, 30.9, 16.09999999999979, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.7, 33.70000000000004, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.10000000000001, 46.5, 42.500000000000014, 44.5, 38.10000000000002, 45.9, 43.7, 42.30000000000001, 40.10000000000002, -50.00000000000044, 14.299999999999763, 39.70000000000002, 45.5, -50.00000000000044, 39.300000000000026, -50.00000000000044, 47.7, 2.299999999999592, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 11.099999999999717, 27.899999999999956, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, 34.900000000000034, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 35.10000000000004, 42.900000000000006, 42.30000000000001, 40.30000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003], "episode_lengths": [500, 500, 210, 36, 500, 500, 94, 126, 234, 500, 500, 500, 236, 94, 338, 106, 102, 66, 500, 26, 58, 90, 380, 60, 432, 42, 500, 500, 60, 70, 170, 172, 192, 340, 500, 500, 142, 44, 164, 500, 500, 116, 40, 30, 60, 500, 500, 500, 500, 500, 86, 60, 36, 76, 56, 120, 42, 64, 78, 100, 500, 358, 104, 46, 500, 108, 500, 24, 478, 500, 500, 500, 234, 390, 222, 36, 500, 500, 500, 500, 308, 152, 88, 500, 500, 500, 500, 500, 44, 500, 150, 72, 78, 98, 126, 500, 500, 500, 500, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40059466837845387, "mean_inference_ms": 1.2764073644883824, "mean_action_processing_ms": 0.15105422803996768, "mean_env_wait_ms": 0.08851526899216176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025998592376708984, "StateBufferConnector_ms": 0.013001441955566406, "ViewRequirementAgentConnector_ms": 0.12187743186950684}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7609999999998105, "episode_len_mean": 278.0, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 29.099999999999973, 46.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 37.50000000000003, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.499999999999936, 40.70000000000002, 16.29999999999979, 39.50000000000002, 39.90000000000002, 43.50000000000001, -50.00000000000044, 47.5, 44.300000000000004, 41.100000000000016, 12.099999999999731, 44.10000000000001, 6.8999999999996575, 45.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.10000000000001, 33.10000000000003, 32.90000000000003, 30.9, 16.09999999999979, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.7, 33.70000000000004, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.10000000000001, 46.5, 42.500000000000014, 44.5, 38.10000000000002, 45.9, 43.7, 42.30000000000001, 40.10000000000002, -50.00000000000044, 14.299999999999763, 39.70000000000002, 45.5, -50.00000000000044, 39.300000000000026, -50.00000000000044, 47.7, 2.299999999999592, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 11.099999999999717, 27.899999999999956, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, 34.900000000000034, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 35.10000000000004, 42.900000000000006, 42.30000000000001, 40.30000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003], "episode_lengths": [500, 500, 210, 36, 500, 500, 94, 126, 234, 500, 500, 500, 236, 94, 338, 106, 102, 66, 500, 26, 58, 90, 380, 60, 432, 42, 500, 500, 60, 70, 170, 172, 192, 340, 500, 500, 142, 44, 164, 500, 500, 116, 40, 30, 60, 500, 500, 500, 500, 500, 86, 60, 36, 76, 56, 120, 42, 64, 78, 100, 500, 358, 104, 46, 500, 108, 500, 24, 478, 500, 500, 500, 234, 390, 222, 36, 500, 500, 500, 500, 308, 152, 88, 500, 500, 500, 500, 500, 44, 500, 150, 72, 78, 98, 126, 500, 500, 500, 500, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40059466837845387, "mean_inference_ms": 1.2764073644883824, "mean_action_processing_ms": 0.15105422803996768, "mean_env_wait_ms": 0.08851526899216176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025998592376708984, "StateBufferConnector_ms": 0.013001441955566406, "ViewRequirementAgentConnector_ms": 0.12187743186950684}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5314.432747490773, "num_env_steps_trained_throughput_per_sec": 5314.432747490773, "timesteps_total": 636000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 2248.387, "sample_time_ms": 1973.899, "load_time_ms": 12.1, "load_throughput": 991742.932, "learn_time_ms": 251.689, "learn_throughput": 47677.81, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 2388, "training_iteration": 53, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-10", "timestamp": 1698245110, "time_this_iter_s": 2.2640018463134766, "time_total_s": 120.80685114860535, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 120.80685114860535, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 62.86666666666667, "ram_util_percent": 27.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503138e-17, "cur_lr": 0.0003, "total_loss": 6.768235397338867, "policy_loss": -0.00018920029203097025, "vf_loss": 6.768476168314616, "vf_explained_var": -1.4623006184895834e-06, "kl": 0.0004025662608910352, "entropy": 0.5157439430554708, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 803.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.006999999999812, "episode_len_mean": 275.54, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.500000000000014, 44.10000000000001, 46.5, 42.500000000000014, 44.5, 38.10000000000002, 45.9, 43.7, 42.30000000000001, 40.10000000000002, -50.00000000000044, 14.299999999999763, 39.70000000000002, 45.5, -50.00000000000044, 39.300000000000026, -50.00000000000044, 47.7, 2.299999999999592, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 11.099999999999717, 27.899999999999956, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, 34.900000000000034, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 35.10000000000004, 42.900000000000006, 42.30000000000001, 40.30000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 37.70000000000003, -50.00000000000044, 45.5, -50.00000000000044, 41.70000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, 44.5, 31.500000000000007, -50.00000000000044, 45.9, 36.10000000000004, 47.3, -50.00000000000044, 33.30000000000003, -50.00000000000044, 36.70000000000003, 39.50000000000002, 45.7, 38.700000000000024, 29.899999999999984, 7.499999999999666, 40.90000000000002, 43.50000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 30.099999999999987, 9.8999999999997, -50.00000000000044, 43.900000000000006, 42.10000000000001, -50.00000000000044, 11.499999999999723, -50.00000000000044, 41.90000000000001, 30.29999999999999, 31.500000000000007, -50.00000000000044], "episode_lengths": [500, 500, 86, 60, 36, 76, 56, 120, 42, 64, 78, 100, 500, 358, 104, 46, 500, 108, 500, 24, 478, 500, 500, 500, 234, 390, 222, 36, 500, 500, 500, 500, 308, 152, 88, 500, 500, 500, 500, 500, 44, 500, 150, 72, 78, 98, 126, 500, 500, 500, 500, 136, 124, 500, 46, 500, 84, 120, 500, 500, 500, 52, 500, 36, 72, 500, 56, 186, 500, 42, 140, 28, 500, 168, 500, 134, 106, 44, 114, 202, 426, 92, 66, 32, 500, 500, 500, 118, 200, 402, 500, 62, 80, 500, 386, 500, 82, 198, 186, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40025759610170053, "mean_inference_ms": 1.2748180468647516, "mean_action_processing_ms": 0.15077672680186616, "mean_env_wait_ms": 0.08833015537429223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025996923446655273, "StateBufferConnector_ms": 0.006996870040893555, "ViewRequirementAgentConnector_ms": 0.12097501754760742}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.006999999999812, "episode_len_mean": 275.54, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.500000000000014, 44.10000000000001, 46.5, 42.500000000000014, 44.5, 38.10000000000002, 45.9, 43.7, 42.30000000000001, 40.10000000000002, -50.00000000000044, 14.299999999999763, 39.70000000000002, 45.5, -50.00000000000044, 39.300000000000026, -50.00000000000044, 47.7, 2.299999999999592, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 11.099999999999717, 27.899999999999956, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, 34.900000000000034, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 35.10000000000004, 42.900000000000006, 42.30000000000001, 40.30000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 37.70000000000003, -50.00000000000044, 45.5, -50.00000000000044, 41.70000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, 44.5, 31.500000000000007, -50.00000000000044, 45.9, 36.10000000000004, 47.3, -50.00000000000044, 33.30000000000003, -50.00000000000044, 36.70000000000003, 39.50000000000002, 45.7, 38.700000000000024, 29.899999999999984, 7.499999999999666, 40.90000000000002, 43.50000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 30.099999999999987, 9.8999999999997, -50.00000000000044, 43.900000000000006, 42.10000000000001, -50.00000000000044, 11.499999999999723, -50.00000000000044, 41.90000000000001, 30.29999999999999, 31.500000000000007, -50.00000000000044], "episode_lengths": [500, 500, 86, 60, 36, 76, 56, 120, 42, 64, 78, 100, 500, 358, 104, 46, 500, 108, 500, 24, 478, 500, 500, 500, 234, 390, 222, 36, 500, 500, 500, 500, 308, 152, 88, 500, 500, 500, 500, 500, 44, 500, 150, 72, 78, 98, 126, 500, 500, 500, 500, 136, 124, 500, 46, 500, 84, 120, 500, 500, 500, 52, 500, 36, 72, 500, 56, 186, 500, 42, 140, 28, 500, 168, 500, 134, 106, 44, 114, 202, 426, 92, 66, 32, 500, 500, 500, 118, 200, 402, 500, 62, 80, 500, 386, 500, 82, 198, 186, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40025759610170053, "mean_inference_ms": 1.2748180468647516, "mean_action_processing_ms": 0.15077672680186616, "mean_env_wait_ms": 0.08833015537429223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025996923446655273, "StateBufferConnector_ms": 0.006996870040893555, "ViewRequirementAgentConnector_ms": 0.12097501754760742}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5599.621378750083, "num_env_steps_trained_throughput_per_sec": 5599.621378750083, "timesteps_total": 648000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 2227.902, "sample_time_ms": 1970.999, "load_time_ms": 11.1, "load_throughput": 1081082.809, "learn_time_ms": 235.004, "learn_throughput": 51063.06, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2436, "training_iteration": 54, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-12", "timestamp": 1698245112, "time_this_iter_s": 2.149000406265259, "time_total_s": 122.9558515548706, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 122.9558515548706, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 60.96666666666667, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251569e-17, "cur_lr": 0.0003, "total_loss": 6.87215305964152, "policy_loss": -0.0005161936084429423, "vf_loss": 6.872723642985026, "vf_explained_var": -2.2172927856445314e-06, "kl": 0.0005006499457825461, "entropy": 0.5429528474807739, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 818.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.654999999999835, "episode_len_mean": 259.1, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 37.70000000000003, -50.00000000000044, 45.5, -50.00000000000044, 41.70000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, 44.5, 31.500000000000007, -50.00000000000044, 45.9, 36.10000000000004, 47.3, -50.00000000000044, 33.30000000000003, -50.00000000000044, 36.70000000000003, 39.50000000000002, 45.7, 38.700000000000024, 29.899999999999984, 7.499999999999666, 40.90000000000002, 43.50000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 30.099999999999987, 9.8999999999997, -50.00000000000044, 43.900000000000006, 42.10000000000001, -50.00000000000044, 11.499999999999723, -50.00000000000044, 41.90000000000001, 30.29999999999999, 31.500000000000007, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 36.900000000000034, 42.10000000000001, 39.90000000000002, 43.7, -50.00000000000044, 47.9, 45.1, 39.90000000000002, 43.900000000000006, 43.10000000000001, 35.10000000000004, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.90000000000002, 46.9, 30.29999999999999, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 36.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, 41.100000000000016, 36.30000000000003, 45.7, 41.90000000000001, -50.00000000000044, 39.50000000000002, 12.899999999999743, -50.00000000000044, -50.00000000000044, 32.100000000000016, 26.89999999999994, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.7, 22.299999999999876, 32.50000000000002, -50.00000000000044, 42.70000000000001, 30.099999999999987], "episode_lengths": [500, 500, 500, 500, 136, 124, 500, 46, 500, 84, 120, 500, 500, 500, 52, 500, 36, 72, 500, 56, 186, 500, 42, 140, 28, 500, 168, 500, 134, 106, 44, 114, 202, 426, 92, 66, 32, 500, 500, 500, 118, 200, 402, 500, 62, 80, 500, 386, 500, 82, 198, 186, 500, 500, 494, 132, 80, 102, 64, 500, 22, 50, 102, 62, 70, 150, 500, 84, 500, 102, 32, 198, 54, 500, 84, 500, 136, 54, 500, 500, 90, 138, 44, 82, 500, 106, 372, 500, 500, 180, 232, 500, 102, 500, 44, 278, 176, 500, 74, 200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4000672274462262, "mean_inference_ms": 1.273853043951444, "mean_action_processing_ms": 0.14993556332044236, "mean_env_wait_ms": 0.08839312478063889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016997814178466797, "StateBufferConnector_ms": 0.004996061325073242, "ViewRequirementAgentConnector_ms": 0.13097548484802246}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.654999999999835, "episode_len_mean": 259.1, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 37.70000000000003, -50.00000000000044, 45.5, -50.00000000000044, 41.70000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, 44.5, 31.500000000000007, -50.00000000000044, 45.9, 36.10000000000004, 47.3, -50.00000000000044, 33.30000000000003, -50.00000000000044, 36.70000000000003, 39.50000000000002, 45.7, 38.700000000000024, 29.899999999999984, 7.499999999999666, 40.90000000000002, 43.50000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 30.099999999999987, 9.8999999999997, -50.00000000000044, 43.900000000000006, 42.10000000000001, -50.00000000000044, 11.499999999999723, -50.00000000000044, 41.90000000000001, 30.29999999999999, 31.500000000000007, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 36.900000000000034, 42.10000000000001, 39.90000000000002, 43.7, -50.00000000000044, 47.9, 45.1, 39.90000000000002, 43.900000000000006, 43.10000000000001, 35.10000000000004, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.90000000000002, 46.9, 30.29999999999999, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 36.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, 41.100000000000016, 36.30000000000003, 45.7, 41.90000000000001, -50.00000000000044, 39.50000000000002, 12.899999999999743, -50.00000000000044, -50.00000000000044, 32.100000000000016, 26.89999999999994, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.7, 22.299999999999876, 32.50000000000002, -50.00000000000044, 42.70000000000001, 30.099999999999987], "episode_lengths": [500, 500, 500, 500, 136, 124, 500, 46, 500, 84, 120, 500, 500, 500, 52, 500, 36, 72, 500, 56, 186, 500, 42, 140, 28, 500, 168, 500, 134, 106, 44, 114, 202, 426, 92, 66, 32, 500, 500, 500, 118, 200, 402, 500, 62, 80, 500, 386, 500, 82, 198, 186, 500, 500, 494, 132, 80, 102, 64, 500, 22, 50, 102, 62, 70, 150, 500, 84, 500, 102, 32, 198, 54, 500, 84, 500, 136, 54, 500, 500, 90, 138, 44, 82, 500, 106, 372, 500, 500, 180, 232, 500, 102, 500, 44, 278, 176, 500, 74, 200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4000672274462262, "mean_inference_ms": 1.273853043951444, "mean_action_processing_ms": 0.14993556332044236, "mean_env_wait_ms": 0.08839312478063889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016997814178466797, "StateBufferConnector_ms": 0.004996061325073242, "ViewRequirementAgentConnector_ms": 0.13097548484802246}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5046.253773036502, "num_env_steps_trained_throughput_per_sec": 5046.253773036502, "timesteps_total": 660000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 2239.701, "sample_time_ms": 1971.099, "load_time_ms": 12.0, "load_throughput": 1000000.954, "learn_time_ms": 245.604, "learn_throughput": 48859.222, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 2483, "training_iteration": 55, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-14", "timestamp": 1698245114, "time_this_iter_s": 2.382999897003174, "time_total_s": 125.33885145187378, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 125.33885145187378, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 63.56666666666667, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.5511151231257846e-18, "cur_lr": 0.0003, "total_loss": 6.756568336486817, "policy_loss": 6.480269754926364e-05, "vf_loss": 6.756552155812582, "vf_explained_var": -1.7881393432617188e-06, "kl": 0.0005081393711028188, "entropy": 0.48532790740331017, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.902999999999844, "episode_len_mean": 246.64, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.500000000000007, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 36.900000000000034, 42.10000000000001, 39.90000000000002, 43.7, -50.00000000000044, 47.9, 45.1, 39.90000000000002, 43.900000000000006, 43.10000000000001, 35.10000000000004, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.90000000000002, 46.9, 30.29999999999999, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 36.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, 41.100000000000016, 36.30000000000003, 45.7, 41.90000000000001, -50.00000000000044, 39.50000000000002, 12.899999999999743, -50.00000000000044, -50.00000000000044, 32.100000000000016, 26.89999999999994, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.7, 22.299999999999876, 32.50000000000002, -50.00000000000044, 42.70000000000001, 30.099999999999987, 23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.5, -50.00000000000044, 23.8999999999999, 46.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.50000000000001, -50.00000000000044, 45.1, 19.299999999999834, 41.70000000000002, 41.70000000000002, 45.5, -50.00000000000044, 36.30000000000003, 41.100000000000016, 41.90000000000001, -50.00000000000044, 41.70000000000002, 42.70000000000001, -50.00000000000044, 36.50000000000003, 44.300000000000004, 45.3, 38.700000000000024, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 20.299999999999848, 14.09999999999976, 46.9, 43.7, -50.00000000000044, 45.7, 43.50000000000001, -50.00000000000044, 25.699999999999925, 42.30000000000001, -50.00000000000044, 45.9, 33.90000000000004, 43.7, -50.00000000000044], "episode_lengths": [186, 500, 500, 494, 132, 80, 102, 64, 500, 22, 50, 102, 62, 70, 150, 500, 84, 500, 102, 32, 198, 54, 500, 84, 500, 136, 54, 500, 500, 90, 138, 44, 82, 500, 106, 372, 500, 500, 180, 232, 500, 102, 500, 44, 278, 176, 500, 74, 200, 264, 500, 500, 500, 500, 90, 46, 500, 262, 36, 500, 500, 72, 66, 500, 50, 308, 84, 84, 46, 500, 138, 90, 82, 500, 84, 74, 500, 136, 58, 48, 114, 500, 102, 500, 500, 298, 360, 32, 64, 500, 44, 66, 500, 244, 78, 500, 42, 162, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4001712141106, "mean_inference_ms": 1.2735411349425159, "mean_action_processing_ms": 0.150012046648464, "mean_env_wait_ms": 0.08844388349952945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028003931045532227, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.13200163841247559}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.902999999999844, "episode_len_mean": 246.64, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.500000000000007, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 36.900000000000034, 42.10000000000001, 39.90000000000002, 43.7, -50.00000000000044, 47.9, 45.1, 39.90000000000002, 43.900000000000006, 43.10000000000001, 35.10000000000004, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.90000000000002, 46.9, 30.29999999999999, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 36.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, 41.100000000000016, 36.30000000000003, 45.7, 41.90000000000001, -50.00000000000044, 39.50000000000002, 12.899999999999743, -50.00000000000044, -50.00000000000044, 32.100000000000016, 26.89999999999994, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.7, 22.299999999999876, 32.50000000000002, -50.00000000000044, 42.70000000000001, 30.099999999999987, 23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.5, -50.00000000000044, 23.8999999999999, 46.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.50000000000001, -50.00000000000044, 45.1, 19.299999999999834, 41.70000000000002, 41.70000000000002, 45.5, -50.00000000000044, 36.30000000000003, 41.100000000000016, 41.90000000000001, -50.00000000000044, 41.70000000000002, 42.70000000000001, -50.00000000000044, 36.50000000000003, 44.300000000000004, 45.3, 38.700000000000024, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 20.299999999999848, 14.09999999999976, 46.9, 43.7, -50.00000000000044, 45.7, 43.50000000000001, -50.00000000000044, 25.699999999999925, 42.30000000000001, -50.00000000000044, 45.9, 33.90000000000004, 43.7, -50.00000000000044], "episode_lengths": [186, 500, 500, 494, 132, 80, 102, 64, 500, 22, 50, 102, 62, 70, 150, 500, 84, 500, 102, 32, 198, 54, 500, 84, 500, 136, 54, 500, 500, 90, 138, 44, 82, 500, 106, 372, 500, 500, 180, 232, 500, 102, 500, 44, 278, 176, 500, 74, 200, 264, 500, 500, 500, 500, 90, 46, 500, 262, 36, 500, 500, 72, 66, 500, 50, 308, 84, 84, 46, 500, 138, 90, 82, 500, 84, 74, 500, 136, 58, 48, 114, 500, 102, 500, 500, 298, 360, 32, 64, 500, 44, 66, 500, 244, 78, 500, 42, 162, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4001712141106, "mean_inference_ms": 1.2735411349425159, "mean_action_processing_ms": 0.150012046648464, "mean_env_wait_ms": 0.08844388349952945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028003931045532227, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.13200163841247559}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5733.396562284599, "num_env_steps_trained_throughput_per_sec": 5733.396562284599, "timesteps_total": 672000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 2223.601, "sample_time_ms": 1971.799, "load_time_ms": 10.8, "load_throughput": 1111108.246, "learn_time_ms": 230.004, "learn_throughput": 52173.092, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 2534, "training_iteration": 56, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-16", "timestamp": 1698245116, "time_this_iter_s": 2.097999334335327, "time_total_s": 127.4368507862091, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 127.4368507862091, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 59.53333333333333, "ram_util_percent": 27.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7755575615628923e-18, "cur_lr": 0.0003, "total_loss": 5.984649054209391, "policy_loss": -0.0006177412656446298, "vf_loss": 5.98531452814738, "vf_explained_var": -1.2715657552083333e-06, "kl": 0.0006410367334069633, "entropy": 0.4777328610420227, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 848.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.541000000000208, "episode_len_mean": 290.96, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.90000000000001, -50.00000000000044, 39.50000000000002, 12.899999999999743, -50.00000000000044, -50.00000000000044, 32.100000000000016, 26.89999999999994, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.7, 22.299999999999876, 32.50000000000002, -50.00000000000044, 42.70000000000001, 30.099999999999987, 23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.5, -50.00000000000044, 23.8999999999999, 46.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.50000000000001, -50.00000000000044, 45.1, 19.299999999999834, 41.70000000000002, 41.70000000000002, 45.5, -50.00000000000044, 36.30000000000003, 41.100000000000016, 41.90000000000001, -50.00000000000044, 41.70000000000002, 42.70000000000001, -50.00000000000044, 36.50000000000003, 44.300000000000004, 45.3, 38.700000000000024, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 20.299999999999848, 14.09999999999976, 46.9, 43.7, -50.00000000000044, 45.7, 43.50000000000001, -50.00000000000044, 25.699999999999925, 42.30000000000001, -50.00000000000044, 45.9, 33.90000000000004, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.7, 19.899999999999842], "episode_lengths": [82, 500, 106, 372, 500, 500, 180, 232, 500, 102, 500, 44, 278, 176, 500, 74, 200, 264, 500, 500, 500, 500, 90, 46, 500, 262, 36, 500, 500, 72, 66, 500, 50, 308, 84, 84, 46, 500, 138, 90, 82, 500, 84, 74, 500, 136, 58, 48, 114, 500, 102, 500, 500, 298, 360, 32, 64, 500, 44, 66, 500, 244, 78, 500, 42, 162, 64, 500, 500, 44, 72, 500, 500, 500, 72, 500, 500, 500, 500, 500, 62, 40, 500, 500, 500, 500, 80, 54, 500, 500, 58, 500, 500, 500, 500, 114, 500, 500, 64, 302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3999824245391931, "mean_inference_ms": 1.2735201402072556, "mean_action_processing_ms": 0.1505044496215895, "mean_env_wait_ms": 0.08835797593790479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100442886352539, "StateBufferConnector_ms": 0.00900125503540039, "ViewRequirementAgentConnector_ms": 0.12500357627868652}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.541000000000208, "episode_len_mean": 290.96, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.90000000000001, -50.00000000000044, 39.50000000000002, 12.899999999999743, -50.00000000000044, -50.00000000000044, 32.100000000000016, 26.89999999999994, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.7, 22.299999999999876, 32.50000000000002, -50.00000000000044, 42.70000000000001, 30.099999999999987, 23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.5, -50.00000000000044, 23.8999999999999, 46.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.50000000000001, -50.00000000000044, 45.1, 19.299999999999834, 41.70000000000002, 41.70000000000002, 45.5, -50.00000000000044, 36.30000000000003, 41.100000000000016, 41.90000000000001, -50.00000000000044, 41.70000000000002, 42.70000000000001, -50.00000000000044, 36.50000000000003, 44.300000000000004, 45.3, 38.700000000000024, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 20.299999999999848, 14.09999999999976, 46.9, 43.7, -50.00000000000044, 45.7, 43.50000000000001, -50.00000000000044, 25.699999999999925, 42.30000000000001, -50.00000000000044, 45.9, 33.90000000000004, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.7, 19.899999999999842], "episode_lengths": [82, 500, 106, 372, 500, 500, 180, 232, 500, 102, 500, 44, 278, 176, 500, 74, 200, 264, 500, 500, 500, 500, 90, 46, 500, 262, 36, 500, 500, 72, 66, 500, 50, 308, 84, 84, 46, 500, 138, 90, 82, 500, 84, 74, 500, 136, 58, 48, 114, 500, 102, 500, 500, 298, 360, 32, 64, 500, 44, 66, 500, 244, 78, 500, 42, 162, 64, 500, 500, 44, 72, 500, 500, 500, 72, 500, 500, 500, 500, 500, 62, 40, 500, 500, 500, 500, 80, 54, 500, 500, 58, 500, 500, 500, 500, 114, 500, 500, 64, 302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3999824245391931, "mean_inference_ms": 1.2735201402072556, "mean_action_processing_ms": 0.1505044496215895, "mean_env_wait_ms": 0.08835797593790479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100442886352539, "StateBufferConnector_ms": 0.00900125503540039, "ViewRequirementAgentConnector_ms": 0.12500357627868652}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5291.006665945524, "num_env_steps_trained_throughput_per_sec": 5291.006665945524, "timesteps_total": 684000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 2237.501, "sample_time_ms": 1973.099, "load_time_ms": 11.0, "load_throughput": 1090914.86, "learn_time_ms": 242.404, "learn_throughput": 49504.234, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2566, "training_iteration": 57, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-19", "timestamp": 1698245119, "time_this_iter_s": 2.2729990482330322, "time_total_s": 129.70984983444214, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 129.70984983444214, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 60.825, "ram_util_percent": 27.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3877787807814461e-18, "cur_lr": 0.0003, "total_loss": 7.561632219950358, "policy_loss": -2.6351710160573324e-05, "vf_loss": 7.561711057027181, "vf_explained_var": -5.165735880533854e-07, "kl": 0.00010684424692044558, "entropy": 0.5268438418706258, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 863.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2909999999998054, "episode_len_mean": 272.7, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, 45.7, 43.50000000000001, -50.00000000000044, 25.699999999999925, 42.30000000000001, -50.00000000000044, 45.9, 33.90000000000004, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.7, 19.899999999999842, -50.00000000000044, 45.9, 41.100000000000016, -50.00000000000044, 46.099999999999994, 22.299999999999876, 21.699999999999868, 1.299999999999578, 35.900000000000034, 35.70000000000003, -50.00000000000044, 46.699999999999996, 47.5, 46.099999999999994, 29.69999999999998, -50.00000000000044, 45.1, 7.09999999999966, 44.7, 19.899999999999842, -50.00000000000044, 44.300000000000004, 37.90000000000003, 47.3, 29.899999999999984, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.9, 41.100000000000016, 31.70000000000001, 0.6999999999995694, 5.6999999999996405, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.5, 44.7, 43.10000000000001, 42.900000000000006, 29.69999999999998, 45.9, 46.5, 42.30000000000001, 44.5, 30.699999999999996, 46.699999999999996, 18.899999999999828, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, -50.00000000000044], "episode_lengths": [64, 500, 44, 66, 500, 244, 78, 500, 42, 162, 64, 500, 500, 44, 72, 500, 500, 500, 72, 500, 500, 500, 500, 500, 62, 40, 500, 500, 500, 500, 80, 54, 500, 500, 58, 500, 500, 500, 500, 114, 500, 500, 64, 302, 500, 42, 90, 500, 40, 278, 284, 488, 142, 144, 500, 34, 26, 40, 204, 500, 50, 430, 54, 302, 500, 58, 122, 28, 202, 500, 500, 40, 500, 42, 90, 184, 494, 444, 500, 108, 500, 46, 54, 70, 72, 204, 42, 36, 78, 56, 194, 34, 312, 276, 500, 500, 500, 60, 50, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39971934714350804, "mean_inference_ms": 1.272668499600615, "mean_action_processing_ms": 0.15033252791571788, "mean_env_wait_ms": 0.0883990221538143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031003475189208984, "StateBufferConnector_ms": 0.0075113773345947266, "ViewRequirementAgentConnector_ms": 0.1113884449005127}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2909999999998054, "episode_len_mean": 272.7, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, 45.7, 43.50000000000001, -50.00000000000044, 25.699999999999925, 42.30000000000001, -50.00000000000044, 45.9, 33.90000000000004, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.7, 19.899999999999842, -50.00000000000044, 45.9, 41.100000000000016, -50.00000000000044, 46.099999999999994, 22.299999999999876, 21.699999999999868, 1.299999999999578, 35.900000000000034, 35.70000000000003, -50.00000000000044, 46.699999999999996, 47.5, 46.099999999999994, 29.69999999999998, -50.00000000000044, 45.1, 7.09999999999966, 44.7, 19.899999999999842, -50.00000000000044, 44.300000000000004, 37.90000000000003, 47.3, 29.899999999999984, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.9, 41.100000000000016, 31.70000000000001, 0.6999999999995694, 5.6999999999996405, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.5, 44.7, 43.10000000000001, 42.900000000000006, 29.69999999999998, 45.9, 46.5, 42.30000000000001, 44.5, 30.699999999999996, 46.699999999999996, 18.899999999999828, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, -50.00000000000044], "episode_lengths": [64, 500, 44, 66, 500, 244, 78, 500, 42, 162, 64, 500, 500, 44, 72, 500, 500, 500, 72, 500, 500, 500, 500, 500, 62, 40, 500, 500, 500, 500, 80, 54, 500, 500, 58, 500, 500, 500, 500, 114, 500, 500, 64, 302, 500, 42, 90, 500, 40, 278, 284, 488, 142, 144, 500, 34, 26, 40, 204, 500, 50, 430, 54, 302, 500, 58, 122, 28, 202, 500, 500, 40, 500, 42, 90, 184, 494, 444, 500, 108, 500, 46, 54, 70, 72, 204, 42, 36, 78, 56, 194, 34, 312, 276, 500, 500, 500, 60, 50, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39971934714350804, "mean_inference_ms": 1.272668499600615, "mean_action_processing_ms": 0.15033252791571788, "mean_env_wait_ms": 0.0883990221538143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031003475189208984, "StateBufferConnector_ms": 0.0075113773345947266, "ViewRequirementAgentConnector_ms": 0.1113884449005127}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5439.4063168319635, "num_env_steps_trained_throughput_per_sec": 5439.4063168319635, "timesteps_total": 696000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 2235.313, "sample_time_ms": 1971.612, "load_time_ms": 10.9, "load_throughput": 1100927.391, "learn_time_ms": 242.303, "learn_throughput": 49524.756, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 2622, "training_iteration": 58, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-21", "timestamp": 1698245121, "time_this_iter_s": 2.2111241817474365, "time_total_s": 131.92097401618958, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 131.92097401618958, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 63.73333333333334, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.938893903907231e-19, "cur_lr": 0.0003, "total_loss": 6.518885612487793, "policy_loss": 5.643690625826518e-06, "vf_loss": 6.518931516011556, "vf_explained_var": -8.662541707356771e-07, "kl": 0.00018143084635463918, "entropy": 0.5146290759245554, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.199999999999868, "episode_len_mean": 218.76, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.699999999999868, 1.299999999999578, 35.900000000000034, 35.70000000000003, -50.00000000000044, 46.699999999999996, 47.5, 46.099999999999994, 29.69999999999998, -50.00000000000044, 45.1, 7.09999999999966, 44.7, 19.899999999999842, -50.00000000000044, 44.300000000000004, 37.90000000000003, 47.3, 29.899999999999984, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.9, 41.100000000000016, 31.70000000000001, 0.6999999999995694, 5.6999999999996405, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.5, 44.7, 43.10000000000001, 42.900000000000006, 29.69999999999998, 45.9, 46.5, 42.30000000000001, 44.5, 30.699999999999996, 46.699999999999996, 18.899999999999828, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, -50.00000000000044, 38.300000000000026, 6.099999999999646, 42.500000000000014, 42.10000000000001, 41.30000000000001, -50.00000000000044, 45.7, 40.70000000000002, 43.10000000000001, 39.70000000000002, 45.1, -50.00000000000044, 45.5, 28.29999999999996, 41.100000000000016, -50.00000000000044, 40.500000000000014, 45.3, 27.099999999999945, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 37.300000000000026, 44.900000000000006, -50.00000000000044, 38.90000000000002, 15.899999999999785, -50.00000000000044, 26.09999999999993, 31.300000000000004, -50.00000000000044, 42.70000000000001, 44.5, 42.30000000000001, -50.00000000000044, 42.500000000000014, 41.30000000000001, 41.100000000000016, -50.00000000000044, 46.5, 35.500000000000036, 45.7, 24.099999999999902, -50.00000000000044, 44.300000000000004, 40.70000000000002, 44.900000000000006, -50.00000000000044], "episode_lengths": [284, 488, 142, 144, 500, 34, 26, 40, 204, 500, 50, 430, 54, 302, 500, 58, 122, 28, 202, 500, 500, 40, 500, 42, 90, 184, 494, 444, 500, 108, 500, 46, 54, 70, 72, 204, 42, 36, 78, 56, 194, 34, 312, 276, 500, 500, 500, 60, 50, 500, 118, 440, 76, 80, 88, 500, 44, 94, 70, 104, 50, 500, 46, 218, 90, 500, 96, 48, 230, 40, 50, 500, 500, 86, 128, 52, 500, 112, 342, 500, 240, 188, 500, 74, 56, 78, 500, 76, 88, 90, 500, 36, 146, 44, 260, 500, 58, 94, 52, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4001255388264593, "mean_inference_ms": 1.2727467471840648, "mean_action_processing_ms": 0.1502242314560201, "mean_env_wait_ms": 0.08840661346854237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799701690673828, "StateBufferConnector_ms": 0.005509853363037109, "ViewRequirementAgentConnector_ms": 0.13235163688659668}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.199999999999868, "episode_len_mean": 218.76, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.699999999999868, 1.299999999999578, 35.900000000000034, 35.70000000000003, -50.00000000000044, 46.699999999999996, 47.5, 46.099999999999994, 29.69999999999998, -50.00000000000044, 45.1, 7.09999999999966, 44.7, 19.899999999999842, -50.00000000000044, 44.300000000000004, 37.90000000000003, 47.3, 29.899999999999984, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.9, 41.100000000000016, 31.70000000000001, 0.6999999999995694, 5.6999999999996405, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.5, 44.7, 43.10000000000001, 42.900000000000006, 29.69999999999998, 45.9, 46.5, 42.30000000000001, 44.5, 30.699999999999996, 46.699999999999996, 18.899999999999828, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, -50.00000000000044, 38.300000000000026, 6.099999999999646, 42.500000000000014, 42.10000000000001, 41.30000000000001, -50.00000000000044, 45.7, 40.70000000000002, 43.10000000000001, 39.70000000000002, 45.1, -50.00000000000044, 45.5, 28.29999999999996, 41.100000000000016, -50.00000000000044, 40.500000000000014, 45.3, 27.099999999999945, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 37.300000000000026, 44.900000000000006, -50.00000000000044, 38.90000000000002, 15.899999999999785, -50.00000000000044, 26.09999999999993, 31.300000000000004, -50.00000000000044, 42.70000000000001, 44.5, 42.30000000000001, -50.00000000000044, 42.500000000000014, 41.30000000000001, 41.100000000000016, -50.00000000000044, 46.5, 35.500000000000036, 45.7, 24.099999999999902, -50.00000000000044, 44.300000000000004, 40.70000000000002, 44.900000000000006, -50.00000000000044], "episode_lengths": [284, 488, 142, 144, 500, 34, 26, 40, 204, 500, 50, 430, 54, 302, 500, 58, 122, 28, 202, 500, 500, 40, 500, 42, 90, 184, 494, 444, 500, 108, 500, 46, 54, 70, 72, 204, 42, 36, 78, 56, 194, 34, 312, 276, 500, 500, 500, 60, 50, 500, 118, 440, 76, 80, 88, 500, 44, 94, 70, 104, 50, 500, 46, 218, 90, 500, 96, 48, 230, 40, 50, 500, 500, 86, 128, 52, 500, 112, 342, 500, 240, 188, 500, 74, 56, 78, 500, 76, 88, 90, 500, 36, 146, 44, 260, 500, 58, 94, 52, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4001255388264593, "mean_inference_ms": 1.2727467471840648, "mean_action_processing_ms": 0.1502242314560201, "mean_env_wait_ms": 0.08840661346854237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799701690673828, "StateBufferConnector_ms": 0.005509853363037109, "ViewRequirementAgentConnector_ms": 0.13235163688659668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5244.75390686464, "num_env_steps_trained_throughput_per_sec": 5244.75390686464, "timesteps_total": 708000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 2228.313, "sample_time_ms": 1963.212, "load_time_ms": 11.1, "load_throughput": 1081082.809, "learn_time_ms": 243.603, "learn_throughput": 49260.474, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 2672, "training_iteration": 59, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-23", "timestamp": 1698245123, "time_this_iter_s": 2.2930004596710205, "time_total_s": 134.2139744758606, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 134.2139744758606, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 64.99999999999999, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.4694469519536153e-19, "cur_lr": 0.0003, "total_loss": 6.945944849650065, "policy_loss": -0.0001550702378153801, "vf_loss": 6.946155007680257, "vf_explained_var": -9.775161743164062e-07, "kl": 0.000476241587447627, "entropy": 0.5518546283245087, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 893.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.002999999999876, "episode_len_mean": 215.72, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.70000000000002, 45.1, -50.00000000000044, 45.5, 28.29999999999996, 41.100000000000016, -50.00000000000044, 40.500000000000014, 45.3, 27.099999999999945, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 37.300000000000026, 44.900000000000006, -50.00000000000044, 38.90000000000002, 15.899999999999785, -50.00000000000044, 26.09999999999993, 31.300000000000004, -50.00000000000044, 42.70000000000001, 44.5, 42.30000000000001, -50.00000000000044, 42.500000000000014, 41.30000000000001, 41.100000000000016, -50.00000000000044, 46.5, 35.500000000000036, 45.7, 24.099999999999902, -50.00000000000044, 44.300000000000004, 40.70000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.3, -50.00000000000044, 9.299999999999692, 33.90000000000004, 43.7, 41.70000000000002, 44.5, 40.90000000000002, 44.5, 43.7, 37.90000000000003, 3.899999999999615, 25.29999999999992, 44.10000000000001, 29.299999999999976, 45.7, -50.00000000000044, 38.700000000000024, 44.10000000000001, 9.099999999999689, 43.30000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 32.30000000000002, 14.499999999999766, -50.00000000000044, 41.500000000000014, 44.300000000000004, 11.499999999999723, -50.00000000000044, 41.500000000000014, 37.70000000000003, 44.300000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, 39.10000000000002, 38.300000000000026, 37.10000000000003, 28.09999999999996, 41.70000000000002, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, 36.70000000000003, 41.500000000000014, 45.5, 43.900000000000006, 44.300000000000004, -50.00000000000044, 39.50000000000002], "episode_lengths": [104, 50, 500, 46, 218, 90, 500, 96, 48, 230, 40, 50, 500, 500, 86, 128, 52, 500, 112, 342, 500, 240, 188, 500, 74, 56, 78, 500, 76, 88, 90, 500, 36, 146, 44, 260, 500, 58, 94, 52, 500, 500, 76, 48, 500, 408, 162, 64, 84, 56, 92, 56, 64, 122, 462, 248, 60, 208, 44, 500, 114, 60, 410, 68, 500, 98, 500, 500, 178, 356, 500, 86, 58, 386, 500, 86, 124, 58, 500, 52, 500, 62, 64, 500, 110, 118, 130, 220, 84, 500, 68, 64, 500, 134, 86, 46, 62, 58, 500, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39958322836252536, "mean_inference_ms": 1.2723496336047346, "mean_action_processing_ms": 0.150316490828402, "mean_env_wait_ms": 0.08810291603787569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026978731155395508, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.10598564147949219}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.002999999999876, "episode_len_mean": 215.72, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.70000000000002, 45.1, -50.00000000000044, 45.5, 28.29999999999996, 41.100000000000016, -50.00000000000044, 40.500000000000014, 45.3, 27.099999999999945, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 37.300000000000026, 44.900000000000006, -50.00000000000044, 38.90000000000002, 15.899999999999785, -50.00000000000044, 26.09999999999993, 31.300000000000004, -50.00000000000044, 42.70000000000001, 44.5, 42.30000000000001, -50.00000000000044, 42.500000000000014, 41.30000000000001, 41.100000000000016, -50.00000000000044, 46.5, 35.500000000000036, 45.7, 24.099999999999902, -50.00000000000044, 44.300000000000004, 40.70000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.3, -50.00000000000044, 9.299999999999692, 33.90000000000004, 43.7, 41.70000000000002, 44.5, 40.90000000000002, 44.5, 43.7, 37.90000000000003, 3.899999999999615, 25.29999999999992, 44.10000000000001, 29.299999999999976, 45.7, -50.00000000000044, 38.700000000000024, 44.10000000000001, 9.099999999999689, 43.30000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 32.30000000000002, 14.499999999999766, -50.00000000000044, 41.500000000000014, 44.300000000000004, 11.499999999999723, -50.00000000000044, 41.500000000000014, 37.70000000000003, 44.300000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, 39.10000000000002, 38.300000000000026, 37.10000000000003, 28.09999999999996, 41.70000000000002, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, 36.70000000000003, 41.500000000000014, 45.5, 43.900000000000006, 44.300000000000004, -50.00000000000044, 39.50000000000002], "episode_lengths": [104, 50, 500, 46, 218, 90, 500, 96, 48, 230, 40, 50, 500, 500, 86, 128, 52, 500, 112, 342, 500, 240, 188, 500, 74, 56, 78, 500, 76, 88, 90, 500, 36, 146, 44, 260, 500, 58, 94, 52, 500, 500, 76, 48, 500, 408, 162, 64, 84, 56, 92, 56, 64, 122, 462, 248, 60, 208, 44, 500, 114, 60, 410, 68, 500, 98, 500, 500, 178, 356, 500, 86, 58, 386, 500, 86, 124, 58, 500, 52, 500, 62, 64, 500, 110, 118, 130, 220, 84, 500, 68, 64, 500, 134, 86, 46, 62, 58, 500, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39958322836252536, "mean_inference_ms": 1.2723496336047346, "mean_action_processing_ms": 0.150316490828402, "mean_env_wait_ms": 0.08810291603787569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026978731155395508, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.10598564147949219}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5777.560085288826, "num_env_steps_trained_throughput_per_sec": 5777.560085288826, "timesteps_total": 720000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 2210.213, "sample_time_ms": 1956.012, "load_time_ms": 10.6, "load_throughput": 1132063.311, "learn_time_ms": 233.103, "learn_throughput": 51479.386, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2731, "training_iteration": 60, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-25", "timestamp": 1698245125, "time_this_iter_s": 2.083000421524048, "time_total_s": 136.29697489738464, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 136.29697489738464, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 59.53333333333333, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768077e-19, "cur_lr": 0.0003, "total_loss": 7.105146249135335, "policy_loss": -8.90652338663737e-05, "vf_loss": 7.105293432871501, "vf_explained_var": -5.76178232828776e-07, "kl": 0.00014525974822845455, "entropy": 0.5798878033955892, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 908.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.486999999999862, "episode_len_mean": 230.86, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, 37.90000000000003, 3.899999999999615, 25.29999999999992, 44.10000000000001, 29.299999999999976, 45.7, -50.00000000000044, 38.700000000000024, 44.10000000000001, 9.099999999999689, 43.30000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 32.30000000000002, 14.499999999999766, -50.00000000000044, 41.500000000000014, 44.300000000000004, 11.499999999999723, -50.00000000000044, 41.500000000000014, 37.70000000000003, 44.300000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, 39.10000000000002, 38.300000000000026, 37.10000000000003, 28.09999999999996, 41.70000000000002, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, 36.70000000000003, 41.500000000000014, 45.5, 43.900000000000006, 44.300000000000004, -50.00000000000044, 39.50000000000002, -50.00000000000044, 42.500000000000014, 39.10000000000002, -50.00000000000044, 42.900000000000006, 41.30000000000001, 43.50000000000001, 46.699999999999996, 37.300000000000026, -50.00000000000044, 4.499999999999623, 25.499999999999922, 42.30000000000001, 42.500000000000014, 38.300000000000026, 42.70000000000001, -50.00000000000044, 35.900000000000034, 30.699999999999996, 45.3, 38.10000000000002, 45.7, 38.700000000000024, -50.00000000000044, 39.300000000000026, 37.300000000000026, 28.699999999999967, -50.00000000000044, 45.3, 41.100000000000016, 32.100000000000016, 25.699999999999925, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.30000000000001, 43.7, 37.10000000000003, 22.49999999999988, 45.1, -50.00000000000044, -50.00000000000044, 35.900000000000034, 44.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044], "episode_lengths": [64, 122, 462, 248, 60, 208, 44, 500, 114, 60, 410, 68, 500, 98, 500, 500, 178, 356, 500, 86, 58, 386, 500, 86, 124, 58, 500, 52, 500, 62, 64, 500, 110, 118, 130, 220, 84, 500, 68, 64, 500, 134, 86, 46, 62, 58, 500, 106, 500, 76, 110, 500, 72, 88, 66, 34, 128, 500, 456, 246, 78, 76, 118, 74, 500, 142, 194, 48, 120, 44, 114, 500, 108, 128, 214, 500, 48, 90, 180, 244, 500, 500, 452, 500, 72, 500, 68, 64, 130, 276, 50, 500, 500, 142, 54, 80, 500, 500, 148, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3994862681006293, "mean_inference_ms": 1.270999620746711, "mean_action_processing_ms": 0.15004427819251548, "mean_env_wait_ms": 0.08825606714707819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03198051452636719, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.09100461006164551}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.486999999999862, "episode_len_mean": 230.86, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, 37.90000000000003, 3.899999999999615, 25.29999999999992, 44.10000000000001, 29.299999999999976, 45.7, -50.00000000000044, 38.700000000000024, 44.10000000000001, 9.099999999999689, 43.30000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 32.30000000000002, 14.499999999999766, -50.00000000000044, 41.500000000000014, 44.300000000000004, 11.499999999999723, -50.00000000000044, 41.500000000000014, 37.70000000000003, 44.300000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, 39.10000000000002, 38.300000000000026, 37.10000000000003, 28.09999999999996, 41.70000000000002, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, 36.70000000000003, 41.500000000000014, 45.5, 43.900000000000006, 44.300000000000004, -50.00000000000044, 39.50000000000002, -50.00000000000044, 42.500000000000014, 39.10000000000002, -50.00000000000044, 42.900000000000006, 41.30000000000001, 43.50000000000001, 46.699999999999996, 37.300000000000026, -50.00000000000044, 4.499999999999623, 25.499999999999922, 42.30000000000001, 42.500000000000014, 38.300000000000026, 42.70000000000001, -50.00000000000044, 35.900000000000034, 30.699999999999996, 45.3, 38.10000000000002, 45.7, 38.700000000000024, -50.00000000000044, 39.300000000000026, 37.300000000000026, 28.699999999999967, -50.00000000000044, 45.3, 41.100000000000016, 32.100000000000016, 25.699999999999925, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.30000000000001, 43.7, 37.10000000000003, 22.49999999999988, 45.1, -50.00000000000044, -50.00000000000044, 35.900000000000034, 44.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044], "episode_lengths": [64, 122, 462, 248, 60, 208, 44, 500, 114, 60, 410, 68, 500, 98, 500, 500, 178, 356, 500, 86, 58, 386, 500, 86, 124, 58, 500, 52, 500, 62, 64, 500, 110, 118, 130, 220, 84, 500, 68, 64, 500, 134, 86, 46, 62, 58, 500, 106, 500, 76, 110, 500, 72, 88, 66, 34, 128, 500, 456, 246, 78, 76, 118, 74, 500, 142, 194, 48, 120, 44, 114, 500, 108, 128, 214, 500, 48, 90, 180, 244, 500, 500, 452, 500, 72, 500, 68, 64, 130, 276, 50, 500, 500, 142, 54, 80, 500, 500, 148, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3994862681006293, "mean_inference_ms": 1.270999620746711, "mean_action_processing_ms": 0.15004427819251548, "mean_env_wait_ms": 0.08825606714707819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03198051452636719, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.09100461006164551}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5550.414596770565, "num_env_steps_trained_throughput_per_sec": 5550.414596770565, "timesteps_total": 732000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 2205.913, "sample_time_ms": 1952.012, "load_time_ms": 9.6, "load_throughput": 1250009.885, "learn_time_ms": 233.8, "learn_throughput": 51325.944, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 2783, "training_iteration": 61, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-28", "timestamp": 1698245128, "time_this_iter_s": 2.1660003662109375, "time_total_s": 138.46297526359558, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 138.46297526359558, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 61.43333333333334, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884038e-20, "cur_lr": 0.0003, "total_loss": 7.467978636423747, "policy_loss": -0.0004502654696504275, "vf_loss": 7.468489297231039, "vf_explained_var": -8.821487426757813e-07, "kl": 0.0004279857261735742, "entropy": 0.6051813801129658, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 923.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.22399999999985, "episode_len_mean": 248.46, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.50000000000002, -50.00000000000044, 42.500000000000014, 39.10000000000002, -50.00000000000044, 42.900000000000006, 41.30000000000001, 43.50000000000001, 46.699999999999996, 37.300000000000026, -50.00000000000044, 4.499999999999623, 25.499999999999922, 42.30000000000001, 42.500000000000014, 38.300000000000026, 42.70000000000001, -50.00000000000044, 35.900000000000034, 30.699999999999996, 45.3, 38.10000000000002, 45.7, 38.700000000000024, -50.00000000000044, 39.300000000000026, 37.300000000000026, 28.699999999999967, -50.00000000000044, 45.3, 41.100000000000016, 32.100000000000016, 25.699999999999925, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.30000000000001, 43.7, 37.10000000000003, 22.49999999999988, 45.1, -50.00000000000044, -50.00000000000044, 35.900000000000034, 44.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 35.900000000000034, 20.49999999999985, 43.30000000000001, 32.90000000000003, 39.50000000000002, -50.00000000000044, 35.10000000000004, 15.099999999999774, 36.10000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 39.300000000000026, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 13.299999999999748, 16.699999999999797, 41.70000000000002, -50.00000000000044, 42.500000000000014, 40.90000000000002, -50.00000000000044, 39.10000000000002, 29.099999999999973, -50.00000000000044, 43.10000000000001, 40.500000000000014, 42.70000000000001, 36.900000000000034, 40.70000000000002, -50.00000000000044, 10.099999999999703, 14.09999999999976, -50.00000000000044, 28.499999999999964, 42.10000000000001, 38.700000000000024, -50.00000000000044, 45.1, -50.00000000000044, 43.7], "episode_lengths": [106, 500, 76, 110, 500, 72, 88, 66, 34, 128, 500, 456, 246, 78, 76, 118, 74, 500, 142, 194, 48, 120, 44, 114, 500, 108, 128, 214, 500, 48, 90, 180, 244, 500, 500, 452, 500, 72, 500, 68, 64, 130, 276, 50, 500, 500, 142, 54, 80, 500, 500, 148, 500, 142, 296, 68, 172, 106, 500, 150, 350, 140, 500, 74, 500, 500, 500, 144, 108, 78, 500, 500, 500, 56, 368, 334, 84, 500, 76, 92, 500, 110, 210, 500, 70, 96, 74, 132, 94, 500, 400, 360, 500, 216, 80, 114, 500, 50, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39917618710730707, "mean_inference_ms": 1.2693385346671926, "mean_action_processing_ms": 0.14949467635101857, "mean_env_wait_ms": 0.08831915334955123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032007694244384766, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.10900354385375977}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.22399999999985, "episode_len_mean": 248.46, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.50000000000002, -50.00000000000044, 42.500000000000014, 39.10000000000002, -50.00000000000044, 42.900000000000006, 41.30000000000001, 43.50000000000001, 46.699999999999996, 37.300000000000026, -50.00000000000044, 4.499999999999623, 25.499999999999922, 42.30000000000001, 42.500000000000014, 38.300000000000026, 42.70000000000001, -50.00000000000044, 35.900000000000034, 30.699999999999996, 45.3, 38.10000000000002, 45.7, 38.700000000000024, -50.00000000000044, 39.300000000000026, 37.300000000000026, 28.699999999999967, -50.00000000000044, 45.3, 41.100000000000016, 32.100000000000016, 25.699999999999925, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.30000000000001, 43.7, 37.10000000000003, 22.49999999999988, 45.1, -50.00000000000044, -50.00000000000044, 35.900000000000034, 44.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 35.900000000000034, 20.49999999999985, 43.30000000000001, 32.90000000000003, 39.50000000000002, -50.00000000000044, 35.10000000000004, 15.099999999999774, 36.10000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 39.300000000000026, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 13.299999999999748, 16.699999999999797, 41.70000000000002, -50.00000000000044, 42.500000000000014, 40.90000000000002, -50.00000000000044, 39.10000000000002, 29.099999999999973, -50.00000000000044, 43.10000000000001, 40.500000000000014, 42.70000000000001, 36.900000000000034, 40.70000000000002, -50.00000000000044, 10.099999999999703, 14.09999999999976, -50.00000000000044, 28.499999999999964, 42.10000000000001, 38.700000000000024, -50.00000000000044, 45.1, -50.00000000000044, 43.7], "episode_lengths": [106, 500, 76, 110, 500, 72, 88, 66, 34, 128, 500, 456, 246, 78, 76, 118, 74, 500, 142, 194, 48, 120, 44, 114, 500, 108, 128, 214, 500, 48, 90, 180, 244, 500, 500, 452, 500, 72, 500, 68, 64, 130, 276, 50, 500, 500, 142, 54, 80, 500, 500, 148, 500, 142, 296, 68, 172, 106, 500, 150, 350, 140, 500, 74, 500, 500, 500, 144, 108, 78, 500, 500, 500, 56, 368, 334, 84, 500, 76, 92, 500, 110, 210, 500, 70, 96, 74, 132, 94, 500, 400, 360, 500, 216, 80, 114, 500, 50, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39917618710730707, "mean_inference_ms": 1.2693385346671926, "mean_action_processing_ms": 0.14949467635101857, "mean_env_wait_ms": 0.08831915334955123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032007694244384766, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.10900354385375977}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5249.337779080306, "num_env_steps_trained_throughput_per_sec": 5249.337779080306, "timesteps_total": 744000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 2215.913, "sample_time_ms": 1954.112, "load_time_ms": 10.4, "load_throughput": 1153847.783, "learn_time_ms": 241.1, "learn_throughput": 49771.913, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 2830, "training_iteration": 62, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-30", "timestamp": 1698245130, "time_this_iter_s": 2.2910001277923584, "time_total_s": 140.75397539138794, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 140.75397539138794, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 60.06666666666666, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.336808689942019e-20, "cur_lr": 0.0003, "total_loss": 6.686558596293131, "policy_loss": 2.1271159251530965e-05, "vf_loss": 6.68659397761027, "vf_explained_var": -5.165735880533854e-07, "kl": 0.0007202524872506425, "entropy": 0.566776442527771, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 938.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.279999999999839, "episode_len_mean": 257.86, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 35.900000000000034, 20.49999999999985, 43.30000000000001, 32.90000000000003, 39.50000000000002, -50.00000000000044, 35.10000000000004, 15.099999999999774, 36.10000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 39.300000000000026, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 13.299999999999748, 16.699999999999797, 41.70000000000002, -50.00000000000044, 42.500000000000014, 40.90000000000002, -50.00000000000044, 39.10000000000002, 29.099999999999973, -50.00000000000044, 43.10000000000001, 40.500000000000014, 42.70000000000001, 36.900000000000034, 40.70000000000002, -50.00000000000044, 10.099999999999703, 14.09999999999976, -50.00000000000044, 28.499999999999964, 42.10000000000001, 38.700000000000024, -50.00000000000044, 45.1, -50.00000000000044, 43.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, 34.10000000000004, 46.3, -50.00000000000044, 41.90000000000001, 38.50000000000003, 46.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.500000000000014, 46.3, 32.700000000000024, 47.1, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, 34.30000000000004, 43.7, 44.7, 45.3, -50.00000000000044, -50.00000000000044, 9.8999999999997, 32.90000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 27.49999999999995, 43.10000000000001, 41.100000000000016, 29.49999999999998, 23.8999999999999, 44.5, 30.9, 47.1, 33.10000000000003, -50.00000000000044, 41.500000000000014], "episode_lengths": [80, 500, 500, 148, 500, 142, 296, 68, 172, 106, 500, 150, 350, 140, 500, 74, 500, 500, 500, 144, 108, 78, 500, 500, 500, 56, 368, 334, 84, 500, 76, 92, 500, 110, 210, 500, 70, 96, 74, 132, 94, 500, 400, 360, 500, 216, 80, 114, 500, 50, 500, 64, 500, 58, 500, 64, 160, 38, 500, 82, 116, 32, 500, 500, 102, 500, 86, 38, 174, 30, 500, 52, 500, 42, 500, 158, 64, 54, 48, 500, 500, 402, 172, 70, 500, 500, 500, 500, 220, 226, 70, 90, 206, 262, 56, 192, 30, 170, 500, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3985859089839703, "mean_inference_ms": 1.268672473496275, "mean_action_processing_ms": 0.1497135133602789, "mean_env_wait_ms": 0.0879264752435366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0270082950592041, "StateBufferConnector_ms": 0.00899505615234375, "ViewRequirementAgentConnector_ms": 0.11002302169799805}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.279999999999839, "episode_len_mean": 257.86, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 35.900000000000034, 20.49999999999985, 43.30000000000001, 32.90000000000003, 39.50000000000002, -50.00000000000044, 35.10000000000004, 15.099999999999774, 36.10000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 39.300000000000026, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 13.299999999999748, 16.699999999999797, 41.70000000000002, -50.00000000000044, 42.500000000000014, 40.90000000000002, -50.00000000000044, 39.10000000000002, 29.099999999999973, -50.00000000000044, 43.10000000000001, 40.500000000000014, 42.70000000000001, 36.900000000000034, 40.70000000000002, -50.00000000000044, 10.099999999999703, 14.09999999999976, -50.00000000000044, 28.499999999999964, 42.10000000000001, 38.700000000000024, -50.00000000000044, 45.1, -50.00000000000044, 43.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, 34.10000000000004, 46.3, -50.00000000000044, 41.90000000000001, 38.50000000000003, 46.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.500000000000014, 46.3, 32.700000000000024, 47.1, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, 34.30000000000004, 43.7, 44.7, 45.3, -50.00000000000044, -50.00000000000044, 9.8999999999997, 32.90000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 27.49999999999995, 43.10000000000001, 41.100000000000016, 29.49999999999998, 23.8999999999999, 44.5, 30.9, 47.1, 33.10000000000003, -50.00000000000044, 41.500000000000014], "episode_lengths": [80, 500, 500, 148, 500, 142, 296, 68, 172, 106, 500, 150, 350, 140, 500, 74, 500, 500, 500, 144, 108, 78, 500, 500, 500, 56, 368, 334, 84, 500, 76, 92, 500, 110, 210, 500, 70, 96, 74, 132, 94, 500, 400, 360, 500, 216, 80, 114, 500, 50, 500, 64, 500, 58, 500, 64, 160, 38, 500, 82, 116, 32, 500, 500, 102, 500, 86, 38, 174, 30, 500, 52, 500, 42, 500, 158, 64, 54, 48, 500, 500, 402, 172, 70, 500, 500, 500, 500, 220, 226, 70, 90, 206, 262, 56, 192, 30, 170, 500, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3985859089839703, "mean_inference_ms": 1.268672473496275, "mean_action_processing_ms": 0.1497135133602789, "mean_env_wait_ms": 0.0879264752435366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0270082950592041, "StateBufferConnector_ms": 0.00899505615234375, "ViewRequirementAgentConnector_ms": 0.11002302169799805}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5888.123238256457, "num_env_steps_trained_throughput_per_sec": 5888.123238256457, "timesteps_total": 756000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 2193.913, "sample_time_ms": 1948.912, "load_time_ms": 9.7, "load_throughput": 1237117.927, "learn_time_ms": 224.9, "learn_throughput": 53357.085, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2878, "training_iteration": 63, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-32", "timestamp": 1698245132, "time_this_iter_s": 2.043001174926758, "time_total_s": 142.7969765663147, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 142.7969765663147, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 58.199999999999996, "ram_util_percent": 27.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710096e-20, "cur_lr": 0.0003, "total_loss": 6.191657034556071, "policy_loss": -6.85123105843862e-05, "vf_loss": 6.191775449117025, "vf_explained_var": -2.2252400716145835e-06, "kl": 7.912203030476424e-05, "entropy": 0.4985487957795461, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 953.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.998999999999826, "episode_len_mean": 265.64, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, 42.70000000000001, 36.900000000000034, 40.70000000000002, -50.00000000000044, 10.099999999999703, 14.09999999999976, -50.00000000000044, 28.499999999999964, 42.10000000000001, 38.700000000000024, -50.00000000000044, 45.1, -50.00000000000044, 43.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, 34.10000000000004, 46.3, -50.00000000000044, 41.90000000000001, 38.50000000000003, 46.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.500000000000014, 46.3, 32.700000000000024, 47.1, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, 34.30000000000004, 43.7, 44.7, 45.3, -50.00000000000044, -50.00000000000044, 9.8999999999997, 32.90000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 27.49999999999995, 43.10000000000001, 41.100000000000016, 29.49999999999998, 23.8999999999999, 44.5, 30.9, 47.1, 33.10000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, 38.700000000000024, 33.70000000000004, 24.099999999999902, -50.00000000000044, 28.699999999999967, 45.7, 42.500000000000014, -50.00000000000044, 44.7, 35.500000000000036, 38.700000000000024, -50.00000000000044, 30.699999999999996, 45.9, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 45.1, 43.900000000000006, 31.500000000000007, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.7, 45.7], "episode_lengths": [96, 74, 132, 94, 500, 400, 360, 500, 216, 80, 114, 500, 50, 500, 64, 500, 58, 500, 64, 160, 38, 500, 82, 116, 32, 500, 500, 102, 500, 86, 38, 174, 30, 500, 52, 500, 42, 500, 158, 64, 54, 48, 500, 500, 402, 172, 70, 500, 500, 500, 500, 220, 226, 70, 90, 206, 262, 56, 192, 30, 170, 500, 86, 500, 114, 164, 260, 500, 214, 44, 76, 500, 54, 146, 114, 500, 194, 42, 500, 292, 500, 500, 500, 500, 500, 500, 136, 500, 500, 50, 62, 186, 500, 500, 342, 500, 500, 156, 44, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3985181886088513, "mean_inference_ms": 1.268074750448327, "mean_action_processing_ms": 0.15001478022472597, "mean_env_wait_ms": 0.08798554197166115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024008989334106445, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.10602498054504395}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.998999999999826, "episode_len_mean": 265.64, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, 42.70000000000001, 36.900000000000034, 40.70000000000002, -50.00000000000044, 10.099999999999703, 14.09999999999976, -50.00000000000044, 28.499999999999964, 42.10000000000001, 38.700000000000024, -50.00000000000044, 45.1, -50.00000000000044, 43.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, 34.10000000000004, 46.3, -50.00000000000044, 41.90000000000001, 38.50000000000003, 46.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.500000000000014, 46.3, 32.700000000000024, 47.1, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, 34.30000000000004, 43.7, 44.7, 45.3, -50.00000000000044, -50.00000000000044, 9.8999999999997, 32.90000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 27.49999999999995, 43.10000000000001, 41.100000000000016, 29.49999999999998, 23.8999999999999, 44.5, 30.9, 47.1, 33.10000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, 38.700000000000024, 33.70000000000004, 24.099999999999902, -50.00000000000044, 28.699999999999967, 45.7, 42.500000000000014, -50.00000000000044, 44.7, 35.500000000000036, 38.700000000000024, -50.00000000000044, 30.699999999999996, 45.9, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 45.1, 43.900000000000006, 31.500000000000007, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.7, 45.7], "episode_lengths": [96, 74, 132, 94, 500, 400, 360, 500, 216, 80, 114, 500, 50, 500, 64, 500, 58, 500, 64, 160, 38, 500, 82, 116, 32, 500, 500, 102, 500, 86, 38, 174, 30, 500, 52, 500, 42, 500, 158, 64, 54, 48, 500, 500, 402, 172, 70, 500, 500, 500, 500, 220, 226, 70, 90, 206, 262, 56, 192, 30, 170, 500, 86, 500, 114, 164, 260, 500, 214, 44, 76, 500, 54, 146, 114, 500, 194, 42, 500, 292, 500, 500, 500, 500, 500, 500, 136, 500, 500, 50, 62, 186, 500, 500, 342, 500, 500, 156, 44, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3985181886088513, "mean_inference_ms": 1.268074750448327, "mean_action_processing_ms": 0.15001478022472597, "mean_env_wait_ms": 0.08798554197166115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024008989334106445, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.10602498054504395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5284.013846119606, "num_env_steps_trained_throughput_per_sec": 5284.013846119606, "timesteps_total": 768000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 2206.713, "sample_time_ms": 1954.712, "load_time_ms": 9.9, "load_throughput": 1212130.25, "learn_time_ms": 231.9, "learn_throughput": 51746.464, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 2915, "training_iteration": 64, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-34", "timestamp": 1698245134, "time_this_iter_s": 2.276000499725342, "time_total_s": 145.07297706604004, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 145.07297706604004, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 63.46666666666667, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855048e-20, "cur_lr": 0.0003, "total_loss": 6.874652894337972, "policy_loss": -2.5747033456961315e-05, "vf_loss": 6.8747309366861975, "vf_explained_var": -6.278355916341146e-07, "kl": 5.1121548998859605e-05, "entropy": 0.522418224811554, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 968.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.800999999999821, "episode_len_mean": 267.62, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 28.09999999999996, 27.49999999999995, 43.10000000000001, 41.100000000000016, 29.49999999999998, 23.8999999999999, 44.5, 30.9, 47.1, 33.10000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, 38.700000000000024, 33.70000000000004, 24.099999999999902, -50.00000000000044, 28.699999999999967, 45.7, 42.500000000000014, -50.00000000000044, 44.7, 35.500000000000036, 38.700000000000024, -50.00000000000044, 30.699999999999996, 45.9, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 45.1, 43.900000000000006, 31.500000000000007, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.7, 45.7, -50.00000000000044, 44.7, 22.49999999999988, -50.00000000000044, 45.3, -50.00000000000044, 10.899999999999714, 43.10000000000001, 31.70000000000001, 43.10000000000001, 45.1, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 21.09999999999986, 45.1, 46.699999999999996, -50.00000000000044, 42.500000000000014, -50.00000000000044, 31.900000000000013, 45.1, 15.699999999999783, -50.00000000000044, 46.099999999999994, -50.00000000000044, 26.09999999999993, 4.299999999999621, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.3, 45.9, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 39.90000000000002, 44.7, 45.9, -50.00000000000044, 43.30000000000001, 42.10000000000001], "episode_lengths": [500, 220, 226, 70, 90, 206, 262, 56, 192, 30, 170, 500, 86, 500, 114, 164, 260, 500, 214, 44, 76, 500, 54, 146, 114, 500, 194, 42, 500, 292, 500, 500, 500, 500, 500, 500, 136, 500, 500, 50, 62, 186, 500, 500, 342, 500, 500, 156, 44, 44, 500, 54, 276, 500, 48, 500, 392, 70, 184, 70, 50, 500, 104, 500, 500, 500, 500, 192, 290, 50, 34, 500, 76, 500, 182, 50, 344, 500, 40, 500, 240, 458, 58, 48, 500, 500, 98, 500, 38, 42, 500, 54, 32, 500, 102, 54, 42, 500, 68, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39818809020312007, "mean_inference_ms": 1.2681274928105324, "mean_action_processing_ms": 0.15007799656398998, "mean_env_wait_ms": 0.08788622909757265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026002883911132812, "StateBufferConnector_ms": 0.005997180938720703, "ViewRequirementAgentConnector_ms": 0.1120157241821289}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.800999999999821, "episode_len_mean": 267.62, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 28.09999999999996, 27.49999999999995, 43.10000000000001, 41.100000000000016, 29.49999999999998, 23.8999999999999, 44.5, 30.9, 47.1, 33.10000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, 38.700000000000024, 33.70000000000004, 24.099999999999902, -50.00000000000044, 28.699999999999967, 45.7, 42.500000000000014, -50.00000000000044, 44.7, 35.500000000000036, 38.700000000000024, -50.00000000000044, 30.699999999999996, 45.9, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 45.1, 43.900000000000006, 31.500000000000007, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.7, 45.7, -50.00000000000044, 44.7, 22.49999999999988, -50.00000000000044, 45.3, -50.00000000000044, 10.899999999999714, 43.10000000000001, 31.70000000000001, 43.10000000000001, 45.1, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 21.09999999999986, 45.1, 46.699999999999996, -50.00000000000044, 42.500000000000014, -50.00000000000044, 31.900000000000013, 45.1, 15.699999999999783, -50.00000000000044, 46.099999999999994, -50.00000000000044, 26.09999999999993, 4.299999999999621, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.3, 45.9, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 39.90000000000002, 44.7, 45.9, -50.00000000000044, 43.30000000000001, 42.10000000000001], "episode_lengths": [500, 220, 226, 70, 90, 206, 262, 56, 192, 30, 170, 500, 86, 500, 114, 164, 260, 500, 214, 44, 76, 500, 54, 146, 114, 500, 194, 42, 500, 292, 500, 500, 500, 500, 500, 500, 136, 500, 500, 50, 62, 186, 500, 500, 342, 500, 500, 156, 44, 44, 500, 54, 276, 500, 48, 500, 392, 70, 184, 70, 50, 500, 104, 500, 500, 500, 500, 192, 290, 50, 34, 500, 76, 500, 182, 50, 344, 500, 40, 500, 240, 458, 58, 48, 500, 500, 98, 500, 38, 42, 500, 54, 32, 500, 102, 54, 42, 500, 68, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39818809020312007, "mean_inference_ms": 1.2681274928105324, "mean_action_processing_ms": 0.15007799656398998, "mean_env_wait_ms": 0.08788622909757265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026002883911132812, "StateBufferConnector_ms": 0.005997180938720703, "ViewRequirementAgentConnector_ms": 0.1120157241821289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5447.110912555467, "num_env_steps_trained_throughput_per_sec": 5447.110912555467, "timesteps_total": 780000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 2189.213, "sample_time_ms": 1950.712, "load_time_ms": 9.2, "load_throughput": 1304374.76, "learn_time_ms": 219.0, "learn_throughput": 54794.561, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 2965, "training_iteration": 65, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-36", "timestamp": 1698245136, "time_this_iter_s": 2.208001136779785, "time_total_s": 147.28097820281982, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 147.28097820281982, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 60.53333333333333, "ram_util_percent": 27.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427524e-21, "cur_lr": 0.0003, "total_loss": 7.180357615152995, "policy_loss": -0.00014071427285671233, "vf_loss": 7.180550034840902, "vf_explained_var": -7.390975952148438e-07, "kl": 0.00024161249982247076, "entropy": 0.5177680293718974, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 983.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.71499999999983, "episode_len_mean": 258.54, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.899999999999785, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.7, 45.7, -50.00000000000044, 44.7, 22.49999999999988, -50.00000000000044, 45.3, -50.00000000000044, 10.899999999999714, 43.10000000000001, 31.70000000000001, 43.10000000000001, 45.1, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 21.09999999999986, 45.1, 46.699999999999996, -50.00000000000044, 42.500000000000014, -50.00000000000044, 31.900000000000013, 45.1, 15.699999999999783, -50.00000000000044, 46.099999999999994, -50.00000000000044, 26.09999999999993, 4.299999999999621, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.3, 45.9, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 39.90000000000002, 44.7, 45.9, -50.00000000000044, 43.30000000000001, 42.10000000000001, 34.10000000000004, -50.00000000000044, -50.00000000000044, 39.300000000000026, 38.700000000000024, 23.29999999999989, -50.00000000000044, 31.900000000000013, -50.00000000000044, 6.699999999999655, 45.7, 42.900000000000006, 42.70000000000001, -50.00000000000044, 44.5, 40.10000000000002, 17.899999999999814, 45.3, -50.00000000000044, 40.90000000000002, 34.30000000000004, -50.00000000000044, 46.5, 20.699999999999854, 14.499999999999766, 44.900000000000006, -50.00000000000044, 18.099999999999817, 21.09999999999986, -50.00000000000044, 36.10000000000004, 23.499999999999893, -50.00000000000044, 44.300000000000004, 38.300000000000026, 26.499999999999936, 0.09999999999956088, 1.8999999999995865, 46.5, -50.00000000000044, 29.69999999999998, 41.30000000000001, 40.10000000000002, 46.099999999999994], "episode_lengths": [342, 500, 500, 156, 44, 44, 500, 54, 276, 500, 48, 500, 392, 70, 184, 70, 50, 500, 104, 500, 500, 500, 500, 192, 290, 50, 34, 500, 76, 500, 182, 50, 344, 500, 40, 500, 240, 458, 58, 48, 500, 500, 98, 500, 38, 42, 500, 54, 32, 500, 102, 54, 42, 500, 68, 80, 160, 500, 500, 108, 114, 268, 500, 182, 500, 434, 44, 72, 74, 500, 56, 100, 322, 48, 500, 92, 158, 500, 36, 294, 356, 52, 500, 320, 290, 500, 140, 266, 500, 58, 118, 236, 500, 482, 36, 500, 204, 88, 100, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3978236679137567, "mean_inference_ms": 1.2677538581324743, "mean_action_processing_ms": 0.15000760616779882, "mean_env_wait_ms": 0.08785563139047275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027995824813842773, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.12400531768798828}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.71499999999983, "episode_len_mean": 258.54, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.899999999999785, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.7, 45.7, -50.00000000000044, 44.7, 22.49999999999988, -50.00000000000044, 45.3, -50.00000000000044, 10.899999999999714, 43.10000000000001, 31.70000000000001, 43.10000000000001, 45.1, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 21.09999999999986, 45.1, 46.699999999999996, -50.00000000000044, 42.500000000000014, -50.00000000000044, 31.900000000000013, 45.1, 15.699999999999783, -50.00000000000044, 46.099999999999994, -50.00000000000044, 26.09999999999993, 4.299999999999621, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.3, 45.9, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 39.90000000000002, 44.7, 45.9, -50.00000000000044, 43.30000000000001, 42.10000000000001, 34.10000000000004, -50.00000000000044, -50.00000000000044, 39.300000000000026, 38.700000000000024, 23.29999999999989, -50.00000000000044, 31.900000000000013, -50.00000000000044, 6.699999999999655, 45.7, 42.900000000000006, 42.70000000000001, -50.00000000000044, 44.5, 40.10000000000002, 17.899999999999814, 45.3, -50.00000000000044, 40.90000000000002, 34.30000000000004, -50.00000000000044, 46.5, 20.699999999999854, 14.499999999999766, 44.900000000000006, -50.00000000000044, 18.099999999999817, 21.09999999999986, -50.00000000000044, 36.10000000000004, 23.499999999999893, -50.00000000000044, 44.300000000000004, 38.300000000000026, 26.499999999999936, 0.09999999999956088, 1.8999999999995865, 46.5, -50.00000000000044, 29.69999999999998, 41.30000000000001, 40.10000000000002, 46.099999999999994], "episode_lengths": [342, 500, 500, 156, 44, 44, 500, 54, 276, 500, 48, 500, 392, 70, 184, 70, 50, 500, 104, 500, 500, 500, 500, 192, 290, 50, 34, 500, 76, 500, 182, 50, 344, 500, 40, 500, 240, 458, 58, 48, 500, 500, 98, 500, 38, 42, 500, 54, 32, 500, 102, 54, 42, 500, 68, 80, 160, 500, 500, 108, 114, 268, 500, 182, 500, 434, 44, 72, 74, 500, 56, 100, 322, 48, 500, 92, 158, 500, 36, 294, 356, 52, 500, 320, 290, 500, 140, 266, 500, 58, 118, 236, 500, 482, 36, 500, 204, 88, 100, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3978236679137567, "mean_inference_ms": 1.2677538581324743, "mean_action_processing_ms": 0.15000760616779882, "mean_env_wait_ms": 0.08785563139047275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027995824813842773, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.12400531768798828}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5065.425481808542, "num_env_steps_trained_throughput_per_sec": 5065.425481808542, "timesteps_total": 792000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 2216.813, "sample_time_ms": 1958.313, "load_time_ms": 10.3, "load_throughput": 1165065.566, "learn_time_ms": 237.7, "learn_throughput": 50483.857, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 3009, "training_iteration": 66, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-39", "timestamp": 1698245139, "time_this_iter_s": 2.3740007877349854, "time_total_s": 149.6549789905548, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 149.6549789905548, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 60.5, "ram_util_percent": 27.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.710505431213762e-21, "cur_lr": 0.0003, "total_loss": 7.686244455973307, "policy_loss": -0.00040206958850224814, "vf_loss": 7.686704031626383, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0005873397702051383, "entropy": 0.5772769212722778, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 998.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.117999999999856, "episode_len_mean": 239.58, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.300000000000026, 38.700000000000024, 23.29999999999989, -50.00000000000044, 31.900000000000013, -50.00000000000044, 6.699999999999655, 45.7, 42.900000000000006, 42.70000000000001, -50.00000000000044, 44.5, 40.10000000000002, 17.899999999999814, 45.3, -50.00000000000044, 40.90000000000002, 34.30000000000004, -50.00000000000044, 46.5, 20.699999999999854, 14.499999999999766, 44.900000000000006, -50.00000000000044, 18.099999999999817, 21.09999999999986, -50.00000000000044, 36.10000000000004, 23.499999999999893, -50.00000000000044, 44.300000000000004, 38.300000000000026, 26.499999999999936, 0.09999999999956088, 1.8999999999995865, 46.5, -50.00000000000044, 29.69999999999998, 41.30000000000001, 40.10000000000002, 46.099999999999994, -50.00000000000044, 9.099999999999689, 44.10000000000001, 20.299999999999848, 4.899999999999629, 32.90000000000003, 39.50000000000002, 45.1, -50.00000000000044, -50.00000000000044, 15.299999999999777, 36.70000000000003, 23.8999999999999, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, 39.300000000000026, 38.300000000000026, 44.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, 42.900000000000006, 42.30000000000001, -50.00000000000044, 47.5, 45.7, 42.30000000000001, 9.8999999999997, 32.100000000000016, 43.7, -50.00000000000044, 31.70000000000001, 40.70000000000002, 45.9, 39.300000000000026, 43.50000000000001, 39.70000000000002, 43.50000000000001, 41.100000000000016, 37.300000000000026, 12.299999999999734, 43.7, -50.00000000000044, 33.30000000000003, 41.70000000000002, 30.699999999999996, 23.499999999999893, 44.900000000000006, -50.00000000000044, -50.00000000000044, 32.100000000000016, 42.500000000000014], "episode_lengths": [500, 500, 108, 114, 268, 500, 182, 500, 434, 44, 72, 74, 500, 56, 100, 322, 48, 500, 92, 158, 500, 36, 294, 356, 52, 500, 320, 290, 500, 140, 266, 500, 58, 118, 236, 500, 482, 36, 500, 204, 88, 100, 40, 500, 410, 60, 298, 452, 172, 106, 50, 500, 500, 348, 134, 262, 42, 500, 98, 500, 108, 118, 54, 500, 140, 500, 500, 30, 100, 72, 78, 500, 26, 44, 78, 402, 180, 64, 500, 184, 94, 42, 108, 66, 104, 66, 90, 128, 378, 64, 500, 168, 84, 194, 266, 52, 500, 500, 180, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3985388569943058, "mean_inference_ms": 1.2686247459611684, "mean_action_processing_ms": 0.15006150925252598, "mean_env_wait_ms": 0.08800696686025745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099966049194336, "StateBufferConnector_ms": 0.006982326507568359, "ViewRequirementAgentConnector_ms": 0.13101434707641602}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.117999999999856, "episode_len_mean": 239.58, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.300000000000026, 38.700000000000024, 23.29999999999989, -50.00000000000044, 31.900000000000013, -50.00000000000044, 6.699999999999655, 45.7, 42.900000000000006, 42.70000000000001, -50.00000000000044, 44.5, 40.10000000000002, 17.899999999999814, 45.3, -50.00000000000044, 40.90000000000002, 34.30000000000004, -50.00000000000044, 46.5, 20.699999999999854, 14.499999999999766, 44.900000000000006, -50.00000000000044, 18.099999999999817, 21.09999999999986, -50.00000000000044, 36.10000000000004, 23.499999999999893, -50.00000000000044, 44.300000000000004, 38.300000000000026, 26.499999999999936, 0.09999999999956088, 1.8999999999995865, 46.5, -50.00000000000044, 29.69999999999998, 41.30000000000001, 40.10000000000002, 46.099999999999994, -50.00000000000044, 9.099999999999689, 44.10000000000001, 20.299999999999848, 4.899999999999629, 32.90000000000003, 39.50000000000002, 45.1, -50.00000000000044, -50.00000000000044, 15.299999999999777, 36.70000000000003, 23.8999999999999, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, 39.300000000000026, 38.300000000000026, 44.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, 42.900000000000006, 42.30000000000001, -50.00000000000044, 47.5, 45.7, 42.30000000000001, 9.8999999999997, 32.100000000000016, 43.7, -50.00000000000044, 31.70000000000001, 40.70000000000002, 45.9, 39.300000000000026, 43.50000000000001, 39.70000000000002, 43.50000000000001, 41.100000000000016, 37.300000000000026, 12.299999999999734, 43.7, -50.00000000000044, 33.30000000000003, 41.70000000000002, 30.699999999999996, 23.499999999999893, 44.900000000000006, -50.00000000000044, -50.00000000000044, 32.100000000000016, 42.500000000000014], "episode_lengths": [500, 500, 108, 114, 268, 500, 182, 500, 434, 44, 72, 74, 500, 56, 100, 322, 48, 500, 92, 158, 500, 36, 294, 356, 52, 500, 320, 290, 500, 140, 266, 500, 58, 118, 236, 500, 482, 36, 500, 204, 88, 100, 40, 500, 410, 60, 298, 452, 172, 106, 50, 500, 500, 348, 134, 262, 42, 500, 98, 500, 108, 118, 54, 500, 140, 500, 500, 30, 100, 72, 78, 500, 26, 44, 78, 402, 180, 64, 500, 184, 94, 42, 108, 66, 104, 66, 90, 128, 378, 64, 500, 168, 84, 194, 266, 52, 500, 500, 180, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3985388569943058, "mean_inference_ms": 1.2686247459611684, "mean_action_processing_ms": 0.15006150925252598, "mean_env_wait_ms": 0.08800696686025745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099966049194336, "StateBufferConnector_ms": 0.006982326507568359, "ViewRequirementAgentConnector_ms": 0.13101434707641602}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5388.421835058882, "num_env_steps_trained_throughput_per_sec": 5388.421835058882, "timesteps_total": 804000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 2212.713, "sample_time_ms": 1965.912, "load_time_ms": 10.0, "load_throughput": 1200018.311, "learn_time_ms": 226.1, "learn_throughput": 53073.908, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 3066, "training_iteration": 67, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-41", "timestamp": 1698245141, "time_this_iter_s": 2.2329981327056885, "time_total_s": 151.8879771232605, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 151.8879771232605, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 66.86666666666666, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.355252715606881e-21, "cur_lr": 0.0003, "total_loss": 6.75486536026001, "policy_loss": -0.00010209525935351848, "vf_loss": 6.755024210611979, "vf_explained_var": -9.377797444661458e-07, "kl": 0.00012280151631784974, "entropy": 0.5676641623179118, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.141999999999868, "episode_len_mean": 219.32, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.50000000000002, 45.1, -50.00000000000044, -50.00000000000044, 15.299999999999777, 36.70000000000003, 23.8999999999999, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, 39.300000000000026, 38.300000000000026, 44.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, 42.900000000000006, 42.30000000000001, -50.00000000000044, 47.5, 45.7, 42.30000000000001, 9.8999999999997, 32.100000000000016, 43.7, -50.00000000000044, 31.70000000000001, 40.70000000000002, 45.9, 39.300000000000026, 43.50000000000001, 39.70000000000002, 43.50000000000001, 41.100000000000016, 37.300000000000026, 12.299999999999734, 43.7, -50.00000000000044, 33.30000000000003, 41.70000000000002, 30.699999999999996, 23.499999999999893, 44.900000000000006, -50.00000000000044, -50.00000000000044, 32.100000000000016, 42.500000000000014, 42.10000000000001, 44.300000000000004, -50.00000000000044, 45.5, 45.7, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.10000000000002, -50.00000000000044, 37.300000000000026, 43.900000000000006, 46.3, 41.90000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 32.50000000000002, 43.50000000000001, 42.10000000000001, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, 12.299999999999734, -50.00000000000044, 31.500000000000007, 40.10000000000002, 1.299999999999578, -50.00000000000044, 46.5, 42.30000000000001, 35.900000000000034, 46.3, 44.7, 39.300000000000026, 43.50000000000001, 6.8999999999996575, 44.10000000000001, 45.5, -50.00000000000044, 45.3], "episode_lengths": [106, 50, 500, 500, 348, 134, 262, 42, 500, 98, 500, 108, 118, 54, 500, 140, 500, 500, 30, 100, 72, 78, 500, 26, 44, 78, 402, 180, 64, 500, 184, 94, 42, 108, 66, 104, 66, 90, 128, 378, 64, 500, 168, 84, 194, 266, 52, 500, 500, 180, 76, 80, 58, 500, 46, 44, 150, 500, 500, 40, 100, 500, 128, 62, 38, 82, 62, 500, 500, 328, 500, 500, 50, 500, 176, 66, 80, 52, 48, 500, 500, 104, 378, 500, 186, 100, 488, 500, 36, 78, 142, 38, 54, 108, 66, 432, 60, 46, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39874823734388637, "mean_inference_ms": 1.2697834207592973, "mean_action_processing_ms": 0.14998679993658265, "mean_env_wait_ms": 0.0880695411401813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900075912475586, "StateBufferConnector_ms": 0.005980730056762695, "ViewRequirementAgentConnector_ms": 0.11900663375854492}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.141999999999868, "episode_len_mean": 219.32, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.50000000000002, 45.1, -50.00000000000044, -50.00000000000044, 15.299999999999777, 36.70000000000003, 23.8999999999999, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, 39.300000000000026, 38.300000000000026, 44.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, 42.900000000000006, 42.30000000000001, -50.00000000000044, 47.5, 45.7, 42.30000000000001, 9.8999999999997, 32.100000000000016, 43.7, -50.00000000000044, 31.70000000000001, 40.70000000000002, 45.9, 39.300000000000026, 43.50000000000001, 39.70000000000002, 43.50000000000001, 41.100000000000016, 37.300000000000026, 12.299999999999734, 43.7, -50.00000000000044, 33.30000000000003, 41.70000000000002, 30.699999999999996, 23.499999999999893, 44.900000000000006, -50.00000000000044, -50.00000000000044, 32.100000000000016, 42.500000000000014, 42.10000000000001, 44.300000000000004, -50.00000000000044, 45.5, 45.7, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.10000000000002, -50.00000000000044, 37.300000000000026, 43.900000000000006, 46.3, 41.90000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 32.50000000000002, 43.50000000000001, 42.10000000000001, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, 12.299999999999734, -50.00000000000044, 31.500000000000007, 40.10000000000002, 1.299999999999578, -50.00000000000044, 46.5, 42.30000000000001, 35.900000000000034, 46.3, 44.7, 39.300000000000026, 43.50000000000001, 6.8999999999996575, 44.10000000000001, 45.5, -50.00000000000044, 45.3], "episode_lengths": [106, 50, 500, 500, 348, 134, 262, 42, 500, 98, 500, 108, 118, 54, 500, 140, 500, 500, 30, 100, 72, 78, 500, 26, 44, 78, 402, 180, 64, 500, 184, 94, 42, 108, 66, 104, 66, 90, 128, 378, 64, 500, 168, 84, 194, 266, 52, 500, 500, 180, 76, 80, 58, 500, 46, 44, 150, 500, 500, 40, 100, 500, 128, 62, 38, 82, 62, 500, 500, 328, 500, 500, 50, 500, 176, 66, 80, 52, 48, 500, 500, 104, 378, 500, 186, 100, 488, 500, 36, 78, 142, 38, 54, 108, 66, 432, 60, 46, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39874823734388637, "mean_inference_ms": 1.2697834207592973, "mean_action_processing_ms": 0.14998679993658265, "mean_env_wait_ms": 0.0880695411401813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900075912475586, "StateBufferConnector_ms": 0.005980730056762695, "ViewRequirementAgentConnector_ms": 0.11900663375854492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5235.602512507615, "num_env_steps_trained_throughput_per_sec": 5235.602512507615, "timesteps_total": 816000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 2221.301, "sample_time_ms": 1971.5, "load_time_ms": 10.6, "load_throughput": 1132086.227, "learn_time_ms": 228.5, "learn_throughput": 52516.459, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 3115, "training_iteration": 68, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-43", "timestamp": 1698245143, "time_this_iter_s": 2.296999931335449, "time_total_s": 154.18497705459595, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 154.18497705459595, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 64.53333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034405e-22, "cur_lr": 0.0003, "total_loss": 6.394140179951986, "policy_loss": -0.0010340341444437702, "vf_loss": 6.395229434967041, "vf_explained_var": -9.258588155110677e-07, "kl": 0.0015731364175830245, "entropy": 0.5535728971163432, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1028.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.065999999999837, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.30000000000003, 41.70000000000002, 30.699999999999996, 23.499999999999893, 44.900000000000006, -50.00000000000044, -50.00000000000044, 32.100000000000016, 42.500000000000014, 42.10000000000001, 44.300000000000004, -50.00000000000044, 45.5, 45.7, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.10000000000002, -50.00000000000044, 37.300000000000026, 43.900000000000006, 46.3, 41.90000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 32.50000000000002, 43.50000000000001, 42.10000000000001, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, 12.299999999999734, -50.00000000000044, 31.500000000000007, 40.10000000000002, 1.299999999999578, -50.00000000000044, 46.5, 42.30000000000001, 35.900000000000034, 46.3, 44.7, 39.300000000000026, 43.50000000000001, 6.8999999999996575, 44.10000000000001, 45.5, -50.00000000000044, 45.3, -50.00000000000044, 42.900000000000006, 35.10000000000004, 37.70000000000003, 45.1, 38.700000000000024, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.50000000000001, -50.00000000000044, 39.50000000000002, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 47.7, 44.5, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.90000000000002, 45.1, 43.7, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 34.900000000000034, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 36.70000000000003], "episode_lengths": [168, 84, 194, 266, 52, 500, 500, 180, 76, 80, 58, 500, 46, 44, 150, 500, 500, 40, 100, 500, 128, 62, 38, 82, 62, 500, 500, 328, 500, 500, 50, 500, 176, 66, 80, 52, 48, 500, 500, 104, 378, 500, 186, 100, 488, 500, 36, 78, 142, 38, 54, 108, 66, 432, 60, 46, 500, 48, 500, 72, 150, 124, 50, 114, 500, 500, 86, 66, 500, 106, 102, 500, 500, 500, 192, 24, 56, 272, 500, 500, 500, 70, 112, 50, 64, 500, 148, 500, 50, 500, 500, 256, 500, 152, 248, 500, 500, 500, 228, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39836012611904903, "mean_inference_ms": 1.269765640319994, "mean_action_processing_ms": 0.1498806597134148, "mean_env_wait_ms": 0.08814135793422526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027994632720947266, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.13699579238891602}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.065999999999837, "episode_len_mean": 250.0, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.30000000000003, 41.70000000000002, 30.699999999999996, 23.499999999999893, 44.900000000000006, -50.00000000000044, -50.00000000000044, 32.100000000000016, 42.500000000000014, 42.10000000000001, 44.300000000000004, -50.00000000000044, 45.5, 45.7, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.10000000000002, -50.00000000000044, 37.300000000000026, 43.900000000000006, 46.3, 41.90000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 32.50000000000002, 43.50000000000001, 42.10000000000001, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, 12.299999999999734, -50.00000000000044, 31.500000000000007, 40.10000000000002, 1.299999999999578, -50.00000000000044, 46.5, 42.30000000000001, 35.900000000000034, 46.3, 44.7, 39.300000000000026, 43.50000000000001, 6.8999999999996575, 44.10000000000001, 45.5, -50.00000000000044, 45.3, -50.00000000000044, 42.900000000000006, 35.10000000000004, 37.70000000000003, 45.1, 38.700000000000024, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.50000000000001, -50.00000000000044, 39.50000000000002, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 47.7, 44.5, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.90000000000002, 45.1, 43.7, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 34.900000000000034, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 36.70000000000003], "episode_lengths": [168, 84, 194, 266, 52, 500, 500, 180, 76, 80, 58, 500, 46, 44, 150, 500, 500, 40, 100, 500, 128, 62, 38, 82, 62, 500, 500, 328, 500, 500, 50, 500, 176, 66, 80, 52, 48, 500, 500, 104, 378, 500, 186, 100, 488, 500, 36, 78, 142, 38, 54, 108, 66, 432, 60, 46, 500, 48, 500, 72, 150, 124, 50, 114, 500, 500, 86, 66, 500, 106, 102, 500, 500, 500, 192, 24, 56, 272, 500, 500, 500, 70, 112, 50, 64, 500, 148, 500, 50, 500, 500, 256, 500, 152, 248, 500, 500, 500, 228, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39836012611904903, "mean_inference_ms": 1.269765640319994, "mean_action_processing_ms": 0.1498806597134148, "mean_env_wait_ms": 0.08814135793422526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027994632720947266, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.13699579238891602}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5247.044294841917, "num_env_steps_trained_throughput_per_sec": 5247.044294841917, "timesteps_total": 828000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 2221.201, "sample_time_ms": 1976.3, "load_time_ms": 10.2, "load_throughput": 1176473.36, "learn_time_ms": 223.7, "learn_throughput": 53643.324, "synch_weights_time_ms": 9.801}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3157, "training_iteration": 69, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-46", "timestamp": 1698245146, "time_this_iter_s": 2.2920005321502686, "time_total_s": 156.47697758674622, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 156.47697758674622, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 58.56666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3881317890172025e-22, "cur_lr": 0.0003, "total_loss": 5.750660578409831, "policy_loss": -0.0009751783994336923, "vf_loss": 5.751690800984701, "vf_explained_var": -5.523363749186198e-07, "kl": 0.0020089220273500057, "entropy": 0.5503392299016316, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1043.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.486999999999807, "episode_len_mean": 280.72, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.70000000000002, 12.299999999999734, -50.00000000000044, 31.500000000000007, 40.10000000000002, 1.299999999999578, -50.00000000000044, 46.5, 42.30000000000001, 35.900000000000034, 46.3, 44.7, 39.300000000000026, 43.50000000000001, 6.8999999999996575, 44.10000000000001, 45.5, -50.00000000000044, 45.3, -50.00000000000044, 42.900000000000006, 35.10000000000004, 37.70000000000003, 45.1, 38.700000000000024, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.50000000000001, -50.00000000000044, 39.50000000000002, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 47.7, 44.5, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.90000000000002, 45.1, 43.7, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 34.900000000000034, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 44.300000000000004, 44.300000000000004, -50.00000000000044, 36.10000000000004, 39.50000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 25.899999999999928, 42.30000000000001, 22.699999999999882, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 16.699999999999797, -50.00000000000044, 40.70000000000002, 43.30000000000001, 44.10000000000001], "episode_lengths": [500, 500, 104, 378, 500, 186, 100, 488, 500, 36, 78, 142, 38, 54, 108, 66, 432, 60, 46, 500, 48, 500, 72, 150, 124, 50, 114, 500, 500, 86, 66, 500, 106, 102, 500, 500, 500, 192, 24, 56, 272, 500, 500, 500, 70, 112, 50, 64, 500, 148, 500, 50, 500, 500, 256, 500, 152, 248, 500, 500, 500, 228, 134, 500, 500, 500, 500, 204, 500, 58, 58, 500, 140, 106, 500, 66, 500, 66, 500, 66, 500, 122, 500, 242, 78, 274, 500, 82, 500, 46, 500, 500, 118, 500, 500, 334, 500, 94, 68, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39846890586478056, "mean_inference_ms": 1.2691545128754642, "mean_action_processing_ms": 0.15028664129537903, "mean_env_wait_ms": 0.08827602342834567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023996353149414062, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.12599730491638184}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.486999999999807, "episode_len_mean": 280.72, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.70000000000002, 12.299999999999734, -50.00000000000044, 31.500000000000007, 40.10000000000002, 1.299999999999578, -50.00000000000044, 46.5, 42.30000000000001, 35.900000000000034, 46.3, 44.7, 39.300000000000026, 43.50000000000001, 6.8999999999996575, 44.10000000000001, 45.5, -50.00000000000044, 45.3, -50.00000000000044, 42.900000000000006, 35.10000000000004, 37.70000000000003, 45.1, 38.700000000000024, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.50000000000001, -50.00000000000044, 39.50000000000002, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 47.7, 44.5, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.90000000000002, 45.1, 43.7, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 34.900000000000034, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 44.300000000000004, 44.300000000000004, -50.00000000000044, 36.10000000000004, 39.50000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 25.899999999999928, 42.30000000000001, 22.699999999999882, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 16.699999999999797, -50.00000000000044, 40.70000000000002, 43.30000000000001, 44.10000000000001], "episode_lengths": [500, 500, 104, 378, 500, 186, 100, 488, 500, 36, 78, 142, 38, 54, 108, 66, 432, 60, 46, 500, 48, 500, 72, 150, 124, 50, 114, 500, 500, 86, 66, 500, 106, 102, 500, 500, 500, 192, 24, 56, 272, 500, 500, 500, 70, 112, 50, 64, 500, 148, 500, 50, 500, 500, 256, 500, 152, 248, 500, 500, 500, 228, 134, 500, 500, 500, 500, 204, 500, 58, 58, 500, 140, 106, 500, 66, 500, 66, 500, 66, 500, 122, 500, 242, 78, 274, 500, 82, 500, 46, 500, 500, 118, 500, 500, 334, 500, 94, 68, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39846890586478056, "mean_inference_ms": 1.2691545128754642, "mean_action_processing_ms": 0.15028664129537903, "mean_env_wait_ms": 0.08827602342834567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023996353149414062, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.12599730491638184}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5263.153557855828, "num_env_steps_trained_throughput_per_sec": 5263.153557855828, "timesteps_total": 840000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 2241.501, "sample_time_ms": 1979.5, "load_time_ms": 11.0, "load_throughput": 1090929.048, "learn_time_ms": 240.1, "learn_throughput": 49979.19, "synch_weights_time_ms": 9.801}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 3194, "training_iteration": 70, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-48", "timestamp": 1698245148, "time_this_iter_s": 2.2840001583099365, "time_total_s": 158.76097774505615, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 158.76097774505615, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 57.125, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6940658945086012e-22, "cur_lr": 0.0003, "total_loss": 6.98944419225057, "policy_loss": -0.0004219507177670797, "vf_loss": 6.989925257364908, "vf_explained_var": -1.4464060465494791e-06, "kl": 0.0008506999229515107, "entropy": 0.5910818457603455, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1058.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": 45.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7609999999998116, "episode_len_mean": 277.98, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 24.499999999999908, -50.00000000000044, 34.900000000000034, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 44.300000000000004, 44.300000000000004, -50.00000000000044, 36.10000000000004, 39.50000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 25.899999999999928, 42.30000000000001, 22.699999999999882, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 16.699999999999797, -50.00000000000044, 40.70000000000002, 43.30000000000001, 44.10000000000001, -50.00000000000044, 36.900000000000034, 33.30000000000003, 40.500000000000014, 42.900000000000006, 45.3, -50.00000000000044, 32.700000000000024, -50.00000000000044, 42.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.50000000000001, 43.50000000000001, -50.00000000000044, 7.899999999999672, 42.900000000000006, 42.30000000000001, 43.30000000000001, -50.00000000000044, 24.499999999999908, -50.00000000000044, 41.100000000000016, -50.00000000000044, 22.099999999999874, 43.30000000000001, 40.70000000000002, 41.90000000000001, 42.70000000000001, 36.900000000000034, 45.1, -50.00000000000044, 41.90000000000001, 45.5, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.10000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.7, -50.00000000000044, 29.69999999999998, 38.10000000000002, -50.00000000000044, 44.7], "episode_lengths": [500, 256, 500, 152, 248, 500, 500, 500, 228, 134, 500, 500, 500, 500, 204, 500, 58, 58, 500, 140, 106, 500, 66, 500, 66, 500, 66, 500, 122, 500, 242, 78, 274, 500, 82, 500, 46, 500, 500, 118, 500, 500, 334, 500, 94, 68, 60, 500, 132, 168, 96, 72, 48, 500, 174, 500, 76, 64, 500, 500, 72, 66, 66, 500, 422, 72, 78, 68, 500, 256, 500, 90, 500, 280, 68, 94, 82, 74, 132, 50, 500, 82, 46, 308, 500, 500, 500, 76, 70, 82, 500, 500, 102, 500, 54, 500, 204, 120, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3985621847093766, "mean_inference_ms": 1.2690370036873773, "mean_action_processing_ms": 0.14997753756867624, "mean_env_wait_ms": 0.08833138863347326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023992300033569336, "StateBufferConnector_ms": 0.005003929138183594, "ViewRequirementAgentConnector_ms": 0.12998485565185547}}, "episode_reward_max": 45.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7609999999998116, "episode_len_mean": 277.98, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 24.499999999999908, -50.00000000000044, 34.900000000000034, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 44.300000000000004, 44.300000000000004, -50.00000000000044, 36.10000000000004, 39.50000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 25.899999999999928, 42.30000000000001, 22.699999999999882, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 16.699999999999797, -50.00000000000044, 40.70000000000002, 43.30000000000001, 44.10000000000001, -50.00000000000044, 36.900000000000034, 33.30000000000003, 40.500000000000014, 42.900000000000006, 45.3, -50.00000000000044, 32.700000000000024, -50.00000000000044, 42.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.50000000000001, 43.50000000000001, -50.00000000000044, 7.899999999999672, 42.900000000000006, 42.30000000000001, 43.30000000000001, -50.00000000000044, 24.499999999999908, -50.00000000000044, 41.100000000000016, -50.00000000000044, 22.099999999999874, 43.30000000000001, 40.70000000000002, 41.90000000000001, 42.70000000000001, 36.900000000000034, 45.1, -50.00000000000044, 41.90000000000001, 45.5, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.10000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.7, -50.00000000000044, 29.69999999999998, 38.10000000000002, -50.00000000000044, 44.7], "episode_lengths": [500, 256, 500, 152, 248, 500, 500, 500, 228, 134, 500, 500, 500, 500, 204, 500, 58, 58, 500, 140, 106, 500, 66, 500, 66, 500, 66, 500, 122, 500, 242, 78, 274, 500, 82, 500, 46, 500, 500, 118, 500, 500, 334, 500, 94, 68, 60, 500, 132, 168, 96, 72, 48, 500, 174, 500, 76, 64, 500, 500, 72, 66, 66, 500, 422, 72, 78, 68, 500, 256, 500, 90, 500, 280, 68, 94, 82, 74, 132, 50, 500, 82, 46, 308, 500, 500, 500, 76, 70, 82, 500, 500, 102, 500, 54, 500, 204, 120, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3985621847093766, "mean_inference_ms": 1.2690370036873773, "mean_action_processing_ms": 0.14997753756867624, "mean_env_wait_ms": 0.08833138863347326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023992300033569336, "StateBufferConnector_ms": 0.005003929138183594, "ViewRequirementAgentConnector_ms": 0.12998485565185547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5104.200985961828, "num_env_steps_trained_throughput_per_sec": 5104.200985961828, "timesteps_total": 852000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 2260.401, "sample_time_ms": 2000.5, "load_time_ms": 10.8, "load_throughput": 1111125.416, "learn_time_ms": 238.2, "learn_throughput": 50377.844, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 3247, "training_iteration": 71, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-50", "timestamp": 1698245150, "time_this_iter_s": 2.357001781463623, "time_total_s": 161.11797952651978, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 161.11797952651978, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 71.2, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543006e-23, "cur_lr": 0.0003, "total_loss": 7.257169596354166, "policy_loss": -0.00039134770631790163, "vf_loss": 7.257619508107504, "vf_explained_var": -1.1761983235677084e-06, "kl": 0.0014997103749569381, "entropy": 0.584268327554067, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1073.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.983999999999842, "episode_len_mean": 250.84, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.900000000000034, 33.30000000000003, 40.500000000000014, 42.900000000000006, 45.3, -50.00000000000044, 32.700000000000024, -50.00000000000044, 42.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.50000000000001, 43.50000000000001, -50.00000000000044, 7.899999999999672, 42.900000000000006, 42.30000000000001, 43.30000000000001, -50.00000000000044, 24.499999999999908, -50.00000000000044, 41.100000000000016, -50.00000000000044, 22.099999999999874, 43.30000000000001, 40.70000000000002, 41.90000000000001, 42.70000000000001, 36.900000000000034, 45.1, -50.00000000000044, 41.90000000000001, 45.5, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.10000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.7, -50.00000000000044, 29.69999999999998, 38.10000000000002, -50.00000000000044, 44.7, -50.00000000000044, 31.900000000000013, 36.70000000000003, 44.10000000000001, 28.29999999999996, 45.5, -50.00000000000044, -50.00000000000044, 14.09999999999976, 35.900000000000034, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 2.699999999999598, 45.3, 14.299999999999763, -50.00000000000044, 45.3, -50.00000000000044, 43.7, 40.30000000000002, -50.00000000000044, 46.099999999999994, 35.30000000000004, 28.09999999999996, 40.30000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 38.10000000000002, 40.70000000000002, 31.500000000000007, 42.900000000000006, 27.899999999999956, 42.500000000000014, -50.00000000000044, 27.099999999999945, 31.900000000000013, 28.89999999999997, 40.90000000000002], "episode_lengths": [132, 168, 96, 72, 48, 500, 174, 500, 76, 64, 500, 500, 72, 66, 66, 500, 422, 72, 78, 68, 500, 256, 500, 90, 500, 280, 68, 94, 82, 74, 132, 50, 500, 82, 46, 308, 500, 500, 500, 76, 70, 82, 500, 500, 102, 500, 54, 500, 204, 120, 500, 54, 500, 182, 134, 60, 218, 46, 500, 500, 360, 142, 500, 462, 500, 500, 52, 500, 194, 500, 500, 474, 48, 358, 500, 48, 500, 64, 98, 500, 40, 148, 220, 98, 52, 500, 500, 48, 54, 120, 94, 186, 72, 222, 76, 500, 230, 182, 212, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39984587991115417, "mean_inference_ms": 1.2733469744560355, "mean_action_processing_ms": 0.15032568169677987, "mean_env_wait_ms": 0.08873981278789576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995637893676758, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.16398954391479492}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.983999999999842, "episode_len_mean": 250.84, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.900000000000034, 33.30000000000003, 40.500000000000014, 42.900000000000006, 45.3, -50.00000000000044, 32.700000000000024, -50.00000000000044, 42.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.50000000000001, 43.50000000000001, -50.00000000000044, 7.899999999999672, 42.900000000000006, 42.30000000000001, 43.30000000000001, -50.00000000000044, 24.499999999999908, -50.00000000000044, 41.100000000000016, -50.00000000000044, 22.099999999999874, 43.30000000000001, 40.70000000000002, 41.90000000000001, 42.70000000000001, 36.900000000000034, 45.1, -50.00000000000044, 41.90000000000001, 45.5, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.10000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.7, -50.00000000000044, 29.69999999999998, 38.10000000000002, -50.00000000000044, 44.7, -50.00000000000044, 31.900000000000013, 36.70000000000003, 44.10000000000001, 28.29999999999996, 45.5, -50.00000000000044, -50.00000000000044, 14.09999999999976, 35.900000000000034, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 2.699999999999598, 45.3, 14.299999999999763, -50.00000000000044, 45.3, -50.00000000000044, 43.7, 40.30000000000002, -50.00000000000044, 46.099999999999994, 35.30000000000004, 28.09999999999996, 40.30000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 38.10000000000002, 40.70000000000002, 31.500000000000007, 42.900000000000006, 27.899999999999956, 42.500000000000014, -50.00000000000044, 27.099999999999945, 31.900000000000013, 28.89999999999997, 40.90000000000002], "episode_lengths": [132, 168, 96, 72, 48, 500, 174, 500, 76, 64, 500, 500, 72, 66, 66, 500, 422, 72, 78, 68, 500, 256, 500, 90, 500, 280, 68, 94, 82, 74, 132, 50, 500, 82, 46, 308, 500, 500, 500, 76, 70, 82, 500, 500, 102, 500, 54, 500, 204, 120, 500, 54, 500, 182, 134, 60, 218, 46, 500, 500, 360, 142, 500, 462, 500, 500, 52, 500, 194, 500, 500, 474, 48, 358, 500, 48, 500, 64, 98, 500, 40, 148, 220, 98, 52, 500, 500, 48, 54, 120, 94, 186, 72, 222, 76, 500, 230, 182, 212, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39984587991115417, "mean_inference_ms": 1.2733469744560355, "mean_action_processing_ms": 0.15032568169677987, "mean_env_wait_ms": 0.08873981278789576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995637893676758, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.16398954391479492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3759.3261548215046, "num_env_steps_trained_throughput_per_sec": 3759.3261548215046, "timesteps_total": 864000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 2351.007, "sample_time_ms": 2085.9, "load_time_ms": 10.8, "load_throughput": 1111154.852, "learn_time_ms": 243.006, "learn_throughput": 49381.484, "synch_weights_time_ms": 10.101}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3295, "training_iteration": 72, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-54", "timestamp": 1698245154, "time_this_iter_s": 3.1980605125427246, "time_total_s": 164.3160400390625, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 164.3160400390625, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 85.45, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.235164736271503e-23, "cur_lr": 0.0003, "total_loss": 6.60439281463623, "policy_loss": -0.0005203935007254283, "vf_loss": 6.604972394307454, "vf_explained_var": 1.986821492513021e-07, "kl": 0.0010865396130763352, "entropy": 0.5934598485628764, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1088.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.213999999999825, "episode_len_mean": 268.5, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, -50.00000000000044, 44.7, -50.00000000000044, 29.69999999999998, 38.10000000000002, -50.00000000000044, 44.7, -50.00000000000044, 31.900000000000013, 36.70000000000003, 44.10000000000001, 28.29999999999996, 45.5, -50.00000000000044, -50.00000000000044, 14.09999999999976, 35.900000000000034, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 2.699999999999598, 45.3, 14.299999999999763, -50.00000000000044, 45.3, -50.00000000000044, 43.7, 40.30000000000002, -50.00000000000044, 46.099999999999994, 35.30000000000004, 28.09999999999996, 40.30000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 38.10000000000002, 40.70000000000002, 31.500000000000007, 42.900000000000006, 27.899999999999956, 42.500000000000014, -50.00000000000044, 27.099999999999945, 31.900000000000013, 28.89999999999997, 40.90000000000002, -50.00000000000044, 40.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 44.300000000000004, 32.30000000000002, 26.89999999999994, 40.30000000000002, 40.90000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 32.30000000000002, 27.099999999999945, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 37.90000000000003, 45.9, 40.30000000000002, 46.3, 46.3, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.500000000000014, 8.49999999999968, -50.00000000000044, 46.099999999999994, 41.70000000000002], "episode_lengths": [102, 500, 54, 500, 204, 120, 500, 54, 500, 182, 134, 60, 218, 46, 500, 500, 360, 142, 500, 462, 500, 500, 52, 500, 194, 500, 500, 474, 48, 358, 500, 48, 500, 64, 98, 500, 40, 148, 220, 98, 52, 500, 500, 48, 54, 120, 94, 186, 72, 222, 76, 500, 230, 182, 212, 92, 500, 92, 500, 52, 500, 500, 364, 500, 58, 178, 232, 98, 92, 500, 118, 500, 500, 500, 500, 56, 178, 230, 90, 500, 500, 500, 116, 122, 42, 98, 38, 38, 78, 500, 500, 98, 500, 136, 500, 86, 416, 500, 40, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40170320205332827, "mean_inference_ms": 1.2786312459561082, "mean_action_processing_ms": 0.15148489998052406, "mean_env_wait_ms": 0.08919460955214951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029003143310546875, "StateBufferConnector_ms": 0.0049953460693359375, "ViewRequirementAgentConnector_ms": 0.19301652908325195}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.213999999999825, "episode_len_mean": 268.5, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, -50.00000000000044, 44.7, -50.00000000000044, 29.69999999999998, 38.10000000000002, -50.00000000000044, 44.7, -50.00000000000044, 31.900000000000013, 36.70000000000003, 44.10000000000001, 28.29999999999996, 45.5, -50.00000000000044, -50.00000000000044, 14.09999999999976, 35.900000000000034, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 2.699999999999598, 45.3, 14.299999999999763, -50.00000000000044, 45.3, -50.00000000000044, 43.7, 40.30000000000002, -50.00000000000044, 46.099999999999994, 35.30000000000004, 28.09999999999996, 40.30000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 38.10000000000002, 40.70000000000002, 31.500000000000007, 42.900000000000006, 27.899999999999956, 42.500000000000014, -50.00000000000044, 27.099999999999945, 31.900000000000013, 28.89999999999997, 40.90000000000002, -50.00000000000044, 40.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 44.300000000000004, 32.30000000000002, 26.89999999999994, 40.30000000000002, 40.90000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 32.30000000000002, 27.099999999999945, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 37.90000000000003, 45.9, 40.30000000000002, 46.3, 46.3, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.500000000000014, 8.49999999999968, -50.00000000000044, 46.099999999999994, 41.70000000000002], "episode_lengths": [102, 500, 54, 500, 204, 120, 500, 54, 500, 182, 134, 60, 218, 46, 500, 500, 360, 142, 500, 462, 500, 500, 52, 500, 194, 500, 500, 474, 48, 358, 500, 48, 500, 64, 98, 500, 40, 148, 220, 98, 52, 500, 500, 48, 54, 120, 94, 186, 72, 222, 76, 500, 230, 182, 212, 92, 500, 92, 500, 52, 500, 500, 364, 500, 58, 178, 232, 98, 92, 500, 118, 500, 500, 500, 500, 56, 178, 230, 90, 500, 500, 500, 116, 122, 42, 98, 38, 38, 78, 500, 500, 98, 500, 136, 500, 86, 416, 500, 40, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40170320205332827, "mean_inference_ms": 1.2786312459561082, "mean_action_processing_ms": 0.15148489998052406, "mean_env_wait_ms": 0.08919460955214951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029003143310546875, "StateBufferConnector_ms": 0.0049953460693359375, "ViewRequirementAgentConnector_ms": 0.19301652908325195}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3808.320556116146, "num_env_steps_trained_throughput_per_sec": 3808.320556116146, "timesteps_total": 876000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 2462.307, "sample_time_ms": 2176.0, "load_time_ms": 11.7, "load_throughput": 1025671.474, "learn_time_ms": 263.029, "learn_throughput": 45622.378, "synch_weights_time_ms": 10.378}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 3339, "training_iteration": 73, "trial_id": "9f288_00003", "date": "2023-10-25_15-45-57", "timestamp": 1698245157, "time_this_iter_s": 3.1578705310821533, "time_total_s": 167.47391057014465, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 167.47391057014465, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 83.67999999999999, "ram_util_percent": 27.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357516e-23, "cur_lr": 0.0003, "total_loss": 7.956971263885498, "policy_loss": -0.0005325093865394592, "vf_loss": 7.957568645477295, "vf_explained_var": -1.1205673217773438e-06, "kl": 0.0011634243316620996, "entropy": 0.6476428667704265, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1103.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.288999999999872, "episode_len_mean": 232.86, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 44.300000000000004, 32.30000000000002, 26.89999999999994, 40.30000000000002, 40.90000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 32.30000000000002, 27.099999999999945, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 37.90000000000003, 45.9, 40.30000000000002, 46.3, 46.3, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.500000000000014, 8.49999999999968, -50.00000000000044, 46.099999999999994, 41.70000000000002, 43.10000000000001, 34.50000000000004, 21.699999999999868, -50.00000000000044, -50.00000000000044, 24.69999999999991, 26.299999999999933, 40.70000000000002, 43.10000000000001, 34.30000000000004, 18.499999999999822, 30.099999999999987, 46.099999999999994, 27.699999999999953, 35.500000000000036, 39.50000000000002, 42.30000000000001, 45.7, 40.30000000000002, 42.70000000000001, 10.299999999999706, 44.900000000000006, 43.900000000000006, 5.299999999999635, 8.49999999999968, 37.50000000000003, 43.30000000000001, 36.900000000000034, 24.299999999999905, 39.50000000000002, 43.7, 43.900000000000006, -50.00000000000044, 37.10000000000003, -50.00000000000044, 38.50000000000003, 43.900000000000006, 25.699999999999925, 36.900000000000034, -50.00000000000044, 32.100000000000016, -50.00000000000044, 42.70000000000001, 38.300000000000026, 27.099999999999945, 42.900000000000006, 41.100000000000016, 28.499999999999964, 41.100000000000016, 45.7, -50.00000000000044, 34.10000000000004, 37.50000000000003, -50.00000000000044, 46.3, 37.70000000000003, 25.499999999999922, 18.699999999999825], "episode_lengths": [500, 52, 500, 500, 364, 500, 58, 178, 232, 98, 92, 500, 118, 500, 500, 500, 500, 56, 178, 230, 90, 500, 500, 500, 116, 122, 42, 98, 38, 38, 78, 500, 500, 98, 500, 136, 500, 86, 416, 500, 40, 84, 70, 156, 284, 500, 500, 254, 238, 94, 70, 158, 316, 200, 40, 224, 146, 106, 78, 44, 98, 74, 398, 52, 62, 448, 416, 126, 68, 132, 258, 106, 64, 62, 500, 130, 500, 116, 62, 244, 132, 500, 180, 500, 74, 118, 230, 72, 90, 216, 90, 44, 500, 160, 126, 500, 38, 124, 246, 314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.404566927417962, "mean_inference_ms": 1.28573676545908, "mean_action_processing_ms": 0.1524330026805602, "mean_env_wait_ms": 0.08973643974315582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04800128936767578, "StateBufferConnector_ms": 0.0069959163665771484, "ViewRequirementAgentConnector_ms": 0.1710352897644043}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.288999999999872, "episode_len_mean": 232.86, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 44.300000000000004, 32.30000000000002, 26.89999999999994, 40.30000000000002, 40.90000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 32.30000000000002, 27.099999999999945, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 37.90000000000003, 45.9, 40.30000000000002, 46.3, 46.3, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.500000000000014, 8.49999999999968, -50.00000000000044, 46.099999999999994, 41.70000000000002, 43.10000000000001, 34.50000000000004, 21.699999999999868, -50.00000000000044, -50.00000000000044, 24.69999999999991, 26.299999999999933, 40.70000000000002, 43.10000000000001, 34.30000000000004, 18.499999999999822, 30.099999999999987, 46.099999999999994, 27.699999999999953, 35.500000000000036, 39.50000000000002, 42.30000000000001, 45.7, 40.30000000000002, 42.70000000000001, 10.299999999999706, 44.900000000000006, 43.900000000000006, 5.299999999999635, 8.49999999999968, 37.50000000000003, 43.30000000000001, 36.900000000000034, 24.299999999999905, 39.50000000000002, 43.7, 43.900000000000006, -50.00000000000044, 37.10000000000003, -50.00000000000044, 38.50000000000003, 43.900000000000006, 25.699999999999925, 36.900000000000034, -50.00000000000044, 32.100000000000016, -50.00000000000044, 42.70000000000001, 38.300000000000026, 27.099999999999945, 42.900000000000006, 41.100000000000016, 28.499999999999964, 41.100000000000016, 45.7, -50.00000000000044, 34.10000000000004, 37.50000000000003, -50.00000000000044, 46.3, 37.70000000000003, 25.499999999999922, 18.699999999999825], "episode_lengths": [500, 52, 500, 500, 364, 500, 58, 178, 232, 98, 92, 500, 118, 500, 500, 500, 500, 56, 178, 230, 90, 500, 500, 500, 116, 122, 42, 98, 38, 38, 78, 500, 500, 98, 500, 136, 500, 86, 416, 500, 40, 84, 70, 156, 284, 500, 500, 254, 238, 94, 70, 158, 316, 200, 40, 224, 146, 106, 78, 44, 98, 74, 398, 52, 62, 448, 416, 126, 68, 132, 258, 106, 64, 62, 500, 130, 500, 116, 62, 244, 132, 500, 180, 500, 74, 118, 230, 72, 90, 216, 90, 44, 500, 160, 126, 500, 38, 124, 246, 314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.404566927417962, "mean_inference_ms": 1.28573676545908, "mean_action_processing_ms": 0.1524330026805602, "mean_env_wait_ms": 0.08973643974315582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04800128936767578, "StateBufferConnector_ms": 0.0069959163665771484, "ViewRequirementAgentConnector_ms": 0.1710352897644043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3997.37466937163, "num_env_steps_trained_throughput_per_sec": 3997.37466937163, "timesteps_total": 888000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 2535.404, "sample_time_ms": 2250.4, "load_time_ms": 11.7, "load_throughput": 1025673.564, "learn_time_ms": 261.371, "learn_throughput": 45911.714, "synch_weights_time_ms": 10.432}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 3397, "training_iteration": 74, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-00", "timestamp": 1698245160, "time_this_iter_s": 3.0066802501678467, "time_total_s": 170.4805908203125, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 170.4805908203125, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 86.275, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678758e-23, "cur_lr": 0.0003, "total_loss": 6.469103622436523, "policy_loss": -0.0003088901440302531, "vf_loss": 6.469469896952311, "vf_explained_var": -1.049041748046875e-06, "kl": 0.0002872100486456475, "entropy": 0.5740119377772014, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1118.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.349999999999874, "episode_len_mean": 227.24, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 24.69999999999991, 26.299999999999933, 40.70000000000002, 43.10000000000001, 34.30000000000004, 18.499999999999822, 30.099999999999987, 46.099999999999994, 27.699999999999953, 35.500000000000036, 39.50000000000002, 42.30000000000001, 45.7, 40.30000000000002, 42.70000000000001, 10.299999999999706, 44.900000000000006, 43.900000000000006, 5.299999999999635, 8.49999999999968, 37.50000000000003, 43.30000000000001, 36.900000000000034, 24.299999999999905, 39.50000000000002, 43.7, 43.900000000000006, -50.00000000000044, 37.10000000000003, -50.00000000000044, 38.50000000000003, 43.900000000000006, 25.699999999999925, 36.900000000000034, -50.00000000000044, 32.100000000000016, -50.00000000000044, 42.70000000000001, 38.300000000000026, 27.099999999999945, 42.900000000000006, 41.100000000000016, 28.499999999999964, 41.100000000000016, 45.7, -50.00000000000044, 34.10000000000004, 37.50000000000003, -50.00000000000044, 46.3, 37.70000000000003, 25.499999999999922, 18.699999999999825, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 25.899999999999928, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.70000000000002, 33.90000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 33.30000000000003, -50.00000000000044, 41.90000000000001, 32.50000000000002, -50.00000000000044, 47.5, 44.10000000000001, 43.30000000000001, 40.30000000000002, -50.00000000000044, 43.30000000000001, 46.099999999999994, 44.10000000000001, 45.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 43.50000000000001, 42.30000000000001, 41.500000000000014, -50.00000000000044, 32.90000000000003, 44.10000000000001], "episode_lengths": [500, 254, 238, 94, 70, 158, 316, 200, 40, 224, 146, 106, 78, 44, 98, 74, 398, 52, 62, 448, 416, 126, 68, 132, 258, 106, 64, 62, 500, 130, 500, 116, 62, 244, 132, 500, 180, 500, 74, 118, 230, 72, 90, 216, 90, 44, 500, 160, 126, 500, 38, 124, 246, 314, 500, 96, 500, 500, 500, 500, 64, 500, 242, 500, 154, 500, 52, 500, 94, 162, 500, 76, 500, 500, 500, 78, 168, 500, 82, 176, 500, 26, 60, 68, 98, 500, 68, 40, 60, 48, 102, 500, 500, 110, 66, 78, 86, 500, 172, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.405792980739252, "mean_inference_ms": 1.2906171870850158, "mean_action_processing_ms": 0.15339604982048424, "mean_env_wait_ms": 0.08973109802788556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048993587493896484, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.1722862720489502}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.349999999999874, "episode_len_mean": 227.24, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 24.69999999999991, 26.299999999999933, 40.70000000000002, 43.10000000000001, 34.30000000000004, 18.499999999999822, 30.099999999999987, 46.099999999999994, 27.699999999999953, 35.500000000000036, 39.50000000000002, 42.30000000000001, 45.7, 40.30000000000002, 42.70000000000001, 10.299999999999706, 44.900000000000006, 43.900000000000006, 5.299999999999635, 8.49999999999968, 37.50000000000003, 43.30000000000001, 36.900000000000034, 24.299999999999905, 39.50000000000002, 43.7, 43.900000000000006, -50.00000000000044, 37.10000000000003, -50.00000000000044, 38.50000000000003, 43.900000000000006, 25.699999999999925, 36.900000000000034, -50.00000000000044, 32.100000000000016, -50.00000000000044, 42.70000000000001, 38.300000000000026, 27.099999999999945, 42.900000000000006, 41.100000000000016, 28.499999999999964, 41.100000000000016, 45.7, -50.00000000000044, 34.10000000000004, 37.50000000000003, -50.00000000000044, 46.3, 37.70000000000003, 25.499999999999922, 18.699999999999825, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 25.899999999999928, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.70000000000002, 33.90000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 33.30000000000003, -50.00000000000044, 41.90000000000001, 32.50000000000002, -50.00000000000044, 47.5, 44.10000000000001, 43.30000000000001, 40.30000000000002, -50.00000000000044, 43.30000000000001, 46.099999999999994, 44.10000000000001, 45.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 43.50000000000001, 42.30000000000001, 41.500000000000014, -50.00000000000044, 32.90000000000003, 44.10000000000001], "episode_lengths": [500, 254, 238, 94, 70, 158, 316, 200, 40, 224, 146, 106, 78, 44, 98, 74, 398, 52, 62, 448, 416, 126, 68, 132, 258, 106, 64, 62, 500, 130, 500, 116, 62, 244, 132, 500, 180, 500, 74, 118, 230, 72, 90, 216, 90, 44, 500, 160, 126, 500, 38, 124, 246, 314, 500, 96, 500, 500, 500, 500, 64, 500, 242, 500, 154, 500, 52, 500, 94, 162, 500, 76, 500, 500, 500, 78, 168, 500, 82, 176, 500, 26, 60, 68, 98, 500, 68, 40, 60, 48, 102, 500, 500, 110, 66, 78, 86, 500, 172, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.405792980739252, "mean_inference_ms": 1.2906171870850158, "mean_action_processing_ms": 0.15339604982048424, "mean_env_wait_ms": 0.08973109802788556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048993587493896484, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.1722862720489502}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4098.187834651311, "num_env_steps_trained_throughput_per_sec": 4098.187834651311, "timesteps_total": 900000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 2607.916, "sample_time_ms": 2306.456, "load_time_ms": 12.3, "load_throughput": 975629.409, "learn_time_ms": 276.828, "learn_throughput": 43348.227, "synch_weights_time_ms": 10.632}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3443, "training_iteration": 75, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-03", "timestamp": 1698245163, "time_this_iter_s": 2.9361252784729004, "time_total_s": 173.4167160987854, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 173.4167160987854, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 80.025, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339379e-24, "cur_lr": 0.0003, "total_loss": 7.021215343475342, "policy_loss": -0.00028344260645098986, "vf_loss": 7.021555233001709, "vf_explained_var": -1.3907750447591145e-06, "kl": 0.0007302189983041293, "entropy": 0.5636249224344889, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1133.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.607999999999844, "episode_len_mean": 244.58, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.699999999999825, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 25.899999999999928, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.70000000000002, 33.90000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 33.30000000000003, -50.00000000000044, 41.90000000000001, 32.50000000000002, -50.00000000000044, 47.5, 44.10000000000001, 43.30000000000001, 40.30000000000002, -50.00000000000044, 43.30000000000001, 46.099999999999994, 44.10000000000001, 45.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 43.50000000000001, 42.30000000000001, 41.500000000000014, -50.00000000000044, 32.90000000000003, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 42.10000000000001, 34.70000000000004, 44.300000000000004, 40.90000000000002, 45.1, 43.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, 42.30000000000001, 27.299999999999947, 43.7, 45.9, 40.90000000000002, -50.00000000000044, 32.50000000000002, 42.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.3, 33.10000000000003, 46.3, 35.500000000000036, 39.300000000000026, 32.50000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, 35.500000000000036, 42.30000000000001, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.500000000000036, 45.1, 13.099999999999746, 1.8999999999995865], "episode_lengths": [314, 500, 96, 500, 500, 500, 500, 64, 500, 242, 500, 154, 500, 52, 500, 94, 162, 500, 76, 500, 500, 500, 78, 168, 500, 82, 176, 500, 26, 60, 68, 98, 500, 68, 40, 60, 48, 102, 500, 500, 110, 66, 78, 86, 500, 172, 60, 500, 42, 500, 80, 154, 58, 92, 50, 68, 72, 500, 500, 116, 40, 78, 228, 64, 42, 92, 500, 176, 72, 82, 500, 500, 62, 38, 170, 38, 146, 108, 176, 500, 500, 80, 500, 500, 44, 76, 500, 58, 82, 500, 146, 78, 484, 500, 500, 98, 166, 50, 370, 482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40697986353509935, "mean_inference_ms": 1.2944693909568776, "mean_action_processing_ms": 0.1532625510791556, "mean_env_wait_ms": 0.09012647047109867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0339961051940918, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.16426777839660645}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.607999999999844, "episode_len_mean": 244.58, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.699999999999825, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 25.899999999999928, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.70000000000002, 33.90000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 33.30000000000003, -50.00000000000044, 41.90000000000001, 32.50000000000002, -50.00000000000044, 47.5, 44.10000000000001, 43.30000000000001, 40.30000000000002, -50.00000000000044, 43.30000000000001, 46.099999999999994, 44.10000000000001, 45.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 43.50000000000001, 42.30000000000001, 41.500000000000014, -50.00000000000044, 32.90000000000003, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 42.10000000000001, 34.70000000000004, 44.300000000000004, 40.90000000000002, 45.1, 43.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, 42.30000000000001, 27.299999999999947, 43.7, 45.9, 40.90000000000002, -50.00000000000044, 32.50000000000002, 42.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.3, 33.10000000000003, 46.3, 35.500000000000036, 39.300000000000026, 32.50000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, 35.500000000000036, 42.30000000000001, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.500000000000036, 45.1, 13.099999999999746, 1.8999999999995865], "episode_lengths": [314, 500, 96, 500, 500, 500, 500, 64, 500, 242, 500, 154, 500, 52, 500, 94, 162, 500, 76, 500, 500, 500, 78, 168, 500, 82, 176, 500, 26, 60, 68, 98, 500, 68, 40, 60, 48, 102, 500, 500, 110, 66, 78, 86, 500, 172, 60, 500, 42, 500, 80, 154, 58, 92, 50, 68, 72, 500, 500, 116, 40, 78, 228, 64, 42, 92, 500, 176, 72, 82, 500, 500, 62, 38, 170, 38, 146, 108, 176, 500, 500, 80, 500, 500, 44, 76, 500, 58, 82, 500, 146, 78, 484, 500, 500, 98, 166, 50, 370, 482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40697986353509935, "mean_inference_ms": 1.2944693909568776, "mean_action_processing_ms": 0.1532625510791556, "mean_env_wait_ms": 0.09012647047109867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0339961051940918, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.16426777839660645}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4868.151031737603, "num_env_steps_trained_throughput_per_sec": 4868.151031737603, "timesteps_total": 912000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 2617.516, "sample_time_ms": 2336.256, "load_time_ms": 11.4, "load_throughput": 1052668.248, "learn_time_ms": 257.731, "learn_throughput": 46560.172, "synch_weights_time_ms": 10.629}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 3496, "training_iteration": 76, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-05", "timestamp": 1698245165, "time_this_iter_s": 2.469999313354492, "time_total_s": 175.8867154121399, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 175.8867154121399, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 78.45, "ram_util_percent": 27.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.6469779601696894e-24, "cur_lr": 0.0003, "total_loss": 6.0453025817871096, "policy_loss": -0.0005760153134663899, "vf_loss": 6.045930417378743, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.0006922554310979952, "entropy": 0.5181964476903279, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1148.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.477999999999854, "episode_len_mean": 235.9, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, -50.00000000000044, 32.90000000000003, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 42.10000000000001, 34.70000000000004, 44.300000000000004, 40.90000000000002, 45.1, 43.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, 42.30000000000001, 27.299999999999947, 43.7, 45.9, 40.90000000000002, -50.00000000000044, 32.50000000000002, 42.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.3, 33.10000000000003, 46.3, 35.500000000000036, 39.300000000000026, 32.50000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, 35.500000000000036, 42.30000000000001, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.500000000000036, 45.1, 13.099999999999746, 1.8999999999995865, -50.00000000000044, 46.9, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.10000000000001, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 27.899999999999956, -50.00000000000044, 41.30000000000001, 38.700000000000024, 40.70000000000002, 38.50000000000003, 43.30000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.1, 33.30000000000003, 45.5, 43.900000000000006, 37.70000000000003, 39.50000000000002, -50.00000000000044, 41.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 39.50000000000002, 41.70000000000002, 44.900000000000006, 44.7, -50.00000000000044], "episode_lengths": [86, 500, 172, 60, 500, 42, 500, 80, 154, 58, 92, 50, 68, 72, 500, 500, 116, 40, 78, 228, 64, 42, 92, 500, 176, 72, 82, 500, 500, 62, 38, 170, 38, 146, 108, 176, 500, 500, 80, 500, 500, 44, 76, 500, 58, 82, 500, 146, 78, 484, 500, 500, 98, 166, 50, 370, 482, 500, 32, 94, 500, 500, 500, 68, 80, 500, 202, 500, 500, 500, 66, 222, 500, 88, 114, 94, 116, 68, 108, 500, 500, 86, 50, 168, 46, 62, 124, 106, 500, 86, 48, 500, 500, 290, 500, 106, 84, 52, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4071720342468583, "mean_inference_ms": 1.2954915621756546, "mean_action_processing_ms": 0.15313953188206444, "mean_env_wait_ms": 0.09040710772963517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030002355575561523, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.1389915943145752}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.477999999999854, "episode_len_mean": 235.9, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, -50.00000000000044, 32.90000000000003, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 42.10000000000001, 34.70000000000004, 44.300000000000004, 40.90000000000002, 45.1, 43.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, 42.30000000000001, 27.299999999999947, 43.7, 45.9, 40.90000000000002, -50.00000000000044, 32.50000000000002, 42.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.3, 33.10000000000003, 46.3, 35.500000000000036, 39.300000000000026, 32.50000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, 35.500000000000036, 42.30000000000001, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.500000000000036, 45.1, 13.099999999999746, 1.8999999999995865, -50.00000000000044, 46.9, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.10000000000001, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 27.899999999999956, -50.00000000000044, 41.30000000000001, 38.700000000000024, 40.70000000000002, 38.50000000000003, 43.30000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.1, 33.30000000000003, 45.5, 43.900000000000006, 37.70000000000003, 39.50000000000002, -50.00000000000044, 41.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 39.50000000000002, 41.70000000000002, 44.900000000000006, 44.7, -50.00000000000044], "episode_lengths": [86, 500, 172, 60, 500, 42, 500, 80, 154, 58, 92, 50, 68, 72, 500, 500, 116, 40, 78, 228, 64, 42, 92, 500, 176, 72, 82, 500, 500, 62, 38, 170, 38, 146, 108, 176, 500, 500, 80, 500, 500, 44, 76, 500, 58, 82, 500, 146, 78, 484, 500, 500, 98, 166, 50, 370, 482, 500, 32, 94, 500, 500, 500, 68, 80, 500, 202, 500, 500, 500, 66, 222, 500, 88, 114, 94, 116, 68, 108, 500, 500, 86, 50, 168, 46, 62, 124, 106, 500, 86, 48, 500, 500, 290, 500, 106, 84, 52, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4071720342468583, "mean_inference_ms": 1.2954915621756546, "mean_action_processing_ms": 0.15313953188206444, "mean_env_wait_ms": 0.09040710772963517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030002355575561523, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.1389915943145752}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4899.957018474268, "num_env_steps_trained_throughput_per_sec": 4899.957018474268, "timesteps_total": 924000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 2639.716, "sample_time_ms": 2333.756, "load_time_ms": 12.4, "load_throughput": 967773.003, "learn_time_ms": 281.734, "learn_throughput": 42593.399, "synch_weights_time_ms": 10.426}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 3539, "training_iteration": 77, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-08", "timestamp": 1698245168, "time_this_iter_s": 2.454000234603882, "time_total_s": 178.34071564674377, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 178.34071564674377, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 72.66666666666667, "ram_util_percent": 27.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848447e-24, "cur_lr": 0.0003, "total_loss": 6.592017364501953, "policy_loss": 4.517833391825358e-05, "vf_loss": 6.592025661468506, "vf_explained_var": -3.178914388020833e-07, "kl": 9.355519296150305e-05, "entropy": 0.5351873795191447, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1163.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.065999999999846, "episode_len_mean": 240.02, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.500000000000036, 45.1, 13.099999999999746, 1.8999999999995865, -50.00000000000044, 46.9, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.10000000000001, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 27.899999999999956, -50.00000000000044, 41.30000000000001, 38.700000000000024, 40.70000000000002, 38.50000000000003, 43.30000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.1, 33.30000000000003, 45.5, 43.900000000000006, 37.70000000000003, 39.50000000000002, -50.00000000000044, 41.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 39.50000000000002, 41.70000000000002, 44.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, 45.7, 44.7, 45.3, 9.099999999999689, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.30000000000001, 39.300000000000026, 45.7, -50.00000000000044, 41.90000000000001, 44.5, 45.3, 41.90000000000001, 47.5, 22.299999999999876, 23.29999999999989, 16.8999999999998, 36.70000000000003, 46.099999999999994, 44.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 36.50000000000003, -50.00000000000044, 28.89999999999997, 44.5, 46.699999999999996, 27.899999999999956, 12.899999999999743, 43.50000000000001, 35.500000000000036, 44.5, 45.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.30000000000001, 45.5, -50.00000000000044, 35.10000000000004, -50.00000000000044], "episode_lengths": [166, 50, 370, 482, 500, 32, 94, 500, 500, 500, 68, 80, 500, 202, 500, 500, 500, 66, 222, 500, 88, 114, 94, 116, 68, 108, 500, 500, 86, 50, 168, 46, 62, 124, 106, 500, 86, 48, 500, 500, 290, 500, 106, 84, 52, 54, 500, 500, 44, 54, 48, 410, 56, 500, 500, 500, 90, 68, 108, 44, 500, 82, 56, 48, 82, 26, 278, 268, 332, 134, 40, 56, 500, 500, 90, 136, 500, 212, 56, 34, 222, 372, 66, 146, 56, 42, 62, 500, 500, 42, 500, 500, 500, 500, 96, 68, 46, 500, 150, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40754234881277057, "mean_inference_ms": 1.2951642595888455, "mean_action_processing_ms": 0.15323651977194128, "mean_env_wait_ms": 0.09055905188583342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099799156188965, "StateBufferConnector_ms": 0.009998083114624023, "ViewRequirementAgentConnector_ms": 0.11700439453125}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.065999999999846, "episode_len_mean": 240.02, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.500000000000036, 45.1, 13.099999999999746, 1.8999999999995865, -50.00000000000044, 46.9, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.10000000000001, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 27.899999999999956, -50.00000000000044, 41.30000000000001, 38.700000000000024, 40.70000000000002, 38.50000000000003, 43.30000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.1, 33.30000000000003, 45.5, 43.900000000000006, 37.70000000000003, 39.50000000000002, -50.00000000000044, 41.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 39.50000000000002, 41.70000000000002, 44.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, 45.7, 44.7, 45.3, 9.099999999999689, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.30000000000001, 39.300000000000026, 45.7, -50.00000000000044, 41.90000000000001, 44.5, 45.3, 41.90000000000001, 47.5, 22.299999999999876, 23.29999999999989, 16.8999999999998, 36.70000000000003, 46.099999999999994, 44.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 36.50000000000003, -50.00000000000044, 28.89999999999997, 44.5, 46.699999999999996, 27.899999999999956, 12.899999999999743, 43.50000000000001, 35.500000000000036, 44.5, 45.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.30000000000001, 45.5, -50.00000000000044, 35.10000000000004, -50.00000000000044], "episode_lengths": [166, 50, 370, 482, 500, 32, 94, 500, 500, 500, 68, 80, 500, 202, 500, 500, 500, 66, 222, 500, 88, 114, 94, 116, 68, 108, 500, 500, 86, 50, 168, 46, 62, 124, 106, 500, 86, 48, 500, 500, 290, 500, 106, 84, 52, 54, 500, 500, 44, 54, 48, 410, 56, 500, 500, 500, 90, 68, 108, 44, 500, 82, 56, 48, 82, 26, 278, 268, 332, 134, 40, 56, 500, 500, 90, 136, 500, 212, 56, 34, 222, 372, 66, 146, 56, 42, 62, 500, 500, 42, 500, 500, 500, 500, 96, 68, 46, 500, 150, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40754234881277057, "mean_inference_ms": 1.2951642595888455, "mean_action_processing_ms": 0.15323651977194128, "mean_env_wait_ms": 0.09055905188583342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099799156188965, "StateBufferConnector_ms": 0.009998083114624023, "ViewRequirementAgentConnector_ms": 0.11700439453125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5444.636683815323, "num_env_steps_trained_throughput_per_sec": 5444.636683815323, "timesteps_total": 936000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 2630.917, "sample_time_ms": 2337.357, "load_time_ms": 11.6, "load_throughput": 1034525.846, "learn_time_ms": 270.034, "learn_throughput": 44438.871, "synch_weights_time_ms": 10.527}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3592, "training_iteration": 78, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-10", "timestamp": 1698245170, "time_this_iter_s": 2.2099997997283936, "time_total_s": 180.55071544647217, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 180.55071544647217, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 62.53333333333334, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424224e-25, "cur_lr": 0.0003, "total_loss": 7.4399739901224775, "policy_loss": -0.001196546076486508, "vf_loss": 7.441220664978028, "vf_explained_var": -1.3748804728190104e-06, "kl": 0.0018572376978455078, "entropy": 0.502013913790385, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1178.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.36299999999985, "episode_len_mean": 232.08, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, 43.30000000000001, 39.300000000000026, 45.7, -50.00000000000044, 41.90000000000001, 44.5, 45.3, 41.90000000000001, 47.5, 22.299999999999876, 23.29999999999989, 16.8999999999998, 36.70000000000003, 46.099999999999994, 44.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 36.50000000000003, -50.00000000000044, 28.89999999999997, 44.5, 46.699999999999996, 27.899999999999956, 12.899999999999743, 43.50000000000001, 35.500000000000036, 44.5, 45.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.30000000000001, 45.5, -50.00000000000044, 35.10000000000004, -50.00000000000044, 7.499999999999666, 37.300000000000026, 43.900000000000006, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.3, 45.7, 45.3, -50.00000000000044, 24.299999999999905, 39.300000000000026, 45.1, 40.10000000000002, 44.5, 46.699999999999996, -50.00000000000044, 44.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 43.900000000000006, 45.3, 4.699999999999626, 30.699999999999996, -50.00000000000044, 45.1, 28.09999999999996, 43.50000000000001, 44.7, 16.8999999999998, 41.30000000000001, -50.00000000000044, 29.099999999999973, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.100000000000016, 12.299999999999734, 29.099999999999973, -50.00000000000044, 45.9, 5.499999999999638, -50.00000000000044, 41.70000000000002, 33.30000000000003], "episode_lengths": [500, 90, 68, 108, 44, 500, 82, 56, 48, 82, 26, 278, 268, 332, 134, 40, 56, 500, 500, 90, 136, 500, 212, 56, 34, 222, 372, 66, 146, 56, 42, 62, 500, 500, 42, 500, 500, 500, 500, 96, 68, 46, 500, 150, 500, 426, 128, 62, 44, 42, 500, 500, 94, 500, 500, 500, 44, 28, 44, 48, 500, 258, 108, 50, 100, 56, 34, 500, 56, 52, 500, 500, 500, 94, 62, 48, 454, 194, 500, 50, 220, 66, 54, 332, 88, 500, 210, 84, 500, 500, 52, 90, 378, 210, 500, 42, 446, 500, 84, 168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4083279136351585, "mean_inference_ms": 1.2947693572072523, "mean_action_processing_ms": 0.15327331924513238, "mean_env_wait_ms": 0.09073297720848364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025997161865234375, "StateBufferConnector_ms": 0.014995813369750977, "ViewRequirementAgentConnector_ms": 0.1050271987915039}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.36299999999985, "episode_len_mean": 232.08, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, 43.30000000000001, 39.300000000000026, 45.7, -50.00000000000044, 41.90000000000001, 44.5, 45.3, 41.90000000000001, 47.5, 22.299999999999876, 23.29999999999989, 16.8999999999998, 36.70000000000003, 46.099999999999994, 44.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 36.50000000000003, -50.00000000000044, 28.89999999999997, 44.5, 46.699999999999996, 27.899999999999956, 12.899999999999743, 43.50000000000001, 35.500000000000036, 44.5, 45.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.30000000000001, 45.5, -50.00000000000044, 35.10000000000004, -50.00000000000044, 7.499999999999666, 37.300000000000026, 43.900000000000006, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.3, 45.7, 45.3, -50.00000000000044, 24.299999999999905, 39.300000000000026, 45.1, 40.10000000000002, 44.5, 46.699999999999996, -50.00000000000044, 44.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 43.900000000000006, 45.3, 4.699999999999626, 30.699999999999996, -50.00000000000044, 45.1, 28.09999999999996, 43.50000000000001, 44.7, 16.8999999999998, 41.30000000000001, -50.00000000000044, 29.099999999999973, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.100000000000016, 12.299999999999734, 29.099999999999973, -50.00000000000044, 45.9, 5.499999999999638, -50.00000000000044, 41.70000000000002, 33.30000000000003], "episode_lengths": [500, 90, 68, 108, 44, 500, 82, 56, 48, 82, 26, 278, 268, 332, 134, 40, 56, 500, 500, 90, 136, 500, 212, 56, 34, 222, 372, 66, 146, 56, 42, 62, 500, 500, 42, 500, 500, 500, 500, 96, 68, 46, 500, 150, 500, 426, 128, 62, 44, 42, 500, 500, 94, 500, 500, 500, 44, 28, 44, 48, 500, 258, 108, 50, 100, 56, 34, 500, 56, 52, 500, 500, 500, 94, 62, 48, 454, 194, 500, 50, 220, 66, 54, 332, 88, 500, 210, 84, 500, 500, 52, 90, 378, 210, 500, 42, 446, 500, 84, 168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4083279136351585, "mean_inference_ms": 1.2947693572072523, "mean_action_processing_ms": 0.15327331924513238, "mean_env_wait_ms": 0.09073297720848364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025997161865234375, "StateBufferConnector_ms": 0.014995813369750977, "ViewRequirementAgentConnector_ms": 0.1050271987915039}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5123.818992284797, "num_env_steps_trained_throughput_per_sec": 5123.818992284797, "timesteps_total": 948000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 2636.417, "sample_time_ms": 2336.157, "load_time_ms": 11.299, "load_throughput": 1062005.95, "learn_time_ms": 277.234, "learn_throughput": 43284.744, "synch_weights_time_ms": 10.327}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 3647, "training_iteration": 79, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-12", "timestamp": 1698245172, "time_this_iter_s": 2.3480002880096436, "time_total_s": 182.8987157344818, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 182.8987157344818, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 64.67500000000001, "ram_util_percent": 27.150000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.308722450212112e-25, "cur_lr": 0.0003, "total_loss": 6.556132157643636, "policy_loss": -8.697311083475749e-07, "vf_loss": 6.556185785929362, "vf_explained_var": -8.742014567057291e-07, "kl": 0.00036715770432541224, "entropy": 0.5283994336922964, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1193.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.637999999999852, "episode_len_mean": 234.34, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.300000000000026, 43.900000000000006, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.3, 45.7, 45.3, -50.00000000000044, 24.299999999999905, 39.300000000000026, 45.1, 40.10000000000002, 44.5, 46.699999999999996, -50.00000000000044, 44.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 43.900000000000006, 45.3, 4.699999999999626, 30.699999999999996, -50.00000000000044, 45.1, 28.09999999999996, 43.50000000000001, 44.7, 16.8999999999998, 41.30000000000001, -50.00000000000044, 29.099999999999973, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.100000000000016, 12.299999999999734, 29.099999999999973, -50.00000000000044, 45.9, 5.499999999999638, -50.00000000000044, 41.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, 46.3, 39.90000000000002, 43.7, 28.09999999999996, -50.00000000000044, 45.1, 41.30000000000001, 30.499999999999993, 30.9, 41.90000000000001, 26.89999999999994, -50.00000000000044, 45.5, -50.00000000000044, 31.900000000000013, 21.09999999999986, 35.900000000000034, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.7, 25.499999999999922, -50.00000000000044, 46.699999999999996, 46.099999999999994, 42.500000000000014, 40.70000000000002, 6.499999999999652, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, 42.70000000000001, 27.299999999999947, 32.90000000000003, 42.10000000000001, 43.7, 43.7, 42.70000000000001, 38.700000000000024, 46.099999999999994, 3.899999999999615], "episode_lengths": [128, 62, 44, 42, 500, 500, 94, 500, 500, 500, 44, 28, 44, 48, 500, 258, 108, 50, 100, 56, 34, 500, 56, 52, 500, 500, 500, 94, 62, 48, 454, 194, 500, 50, 220, 66, 54, 332, 88, 500, 210, 84, 500, 500, 52, 90, 378, 210, 500, 42, 446, 500, 84, 168, 500, 500, 38, 102, 64, 220, 500, 50, 88, 196, 192, 82, 232, 500, 46, 500, 182, 290, 142, 500, 88, 500, 68, 500, 54, 246, 500, 34, 40, 76, 94, 436, 500, 328, 500, 500, 74, 228, 172, 80, 64, 64, 74, 114, 40, 462]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.408103012374304, "mean_inference_ms": 1.295717326632455, "mean_action_processing_ms": 0.15315938264344778, "mean_env_wait_ms": 0.0906675822951877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399444580078125, "StateBufferConnector_ms": 0.011996269226074219, "ViewRequirementAgentConnector_ms": 0.11802411079406738}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.637999999999852, "episode_len_mean": 234.34, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.300000000000026, 43.900000000000006, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.3, 45.7, 45.3, -50.00000000000044, 24.299999999999905, 39.300000000000026, 45.1, 40.10000000000002, 44.5, 46.699999999999996, -50.00000000000044, 44.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 43.900000000000006, 45.3, 4.699999999999626, 30.699999999999996, -50.00000000000044, 45.1, 28.09999999999996, 43.50000000000001, 44.7, 16.8999999999998, 41.30000000000001, -50.00000000000044, 29.099999999999973, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.100000000000016, 12.299999999999734, 29.099999999999973, -50.00000000000044, 45.9, 5.499999999999638, -50.00000000000044, 41.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, 46.3, 39.90000000000002, 43.7, 28.09999999999996, -50.00000000000044, 45.1, 41.30000000000001, 30.499999999999993, 30.9, 41.90000000000001, 26.89999999999994, -50.00000000000044, 45.5, -50.00000000000044, 31.900000000000013, 21.09999999999986, 35.900000000000034, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.7, 25.499999999999922, -50.00000000000044, 46.699999999999996, 46.099999999999994, 42.500000000000014, 40.70000000000002, 6.499999999999652, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, 42.70000000000001, 27.299999999999947, 32.90000000000003, 42.10000000000001, 43.7, 43.7, 42.70000000000001, 38.700000000000024, 46.099999999999994, 3.899999999999615], "episode_lengths": [128, 62, 44, 42, 500, 500, 94, 500, 500, 500, 44, 28, 44, 48, 500, 258, 108, 50, 100, 56, 34, 500, 56, 52, 500, 500, 500, 94, 62, 48, 454, 194, 500, 50, 220, 66, 54, 332, 88, 500, 210, 84, 500, 500, 52, 90, 378, 210, 500, 42, 446, 500, 84, 168, 500, 500, 38, 102, 64, 220, 500, 50, 88, 196, 192, 82, 232, 500, 46, 500, 182, 290, 142, 500, 88, 500, 68, 500, 54, 246, 500, 34, 40, 76, 94, 436, 500, 328, 500, 500, 74, 228, 172, 80, 64, 64, 74, 114, 40, 462]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.408103012374304, "mean_inference_ms": 1.295717326632455, "mean_action_processing_ms": 0.15315938264344778, "mean_env_wait_ms": 0.0906675822951877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399444580078125, "StateBufferConnector_ms": 0.011996269226074219, "ViewRequirementAgentConnector_ms": 0.11802411079406738}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5352.355177168002, "num_env_steps_trained_throughput_per_sec": 5352.355177168002, "timesteps_total": 960000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 2632.617, "sample_time_ms": 2346.657, "load_time_ms": 10.599, "load_throughput": 1132157.53, "learn_time_ms": 263.234, "learn_throughput": 45586.788, "synch_weights_time_ms": 10.626}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 3693, "training_iteration": 80, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-15", "timestamp": 1698245175, "time_this_iter_s": 2.246999502182007, "time_total_s": 185.14571523666382, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 185.14571523666382, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 74.56666666666666, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.654361225106056e-25, "cur_lr": 0.0003, "total_loss": 7.000018692016601, "policy_loss": -4.954412579536438e-05, "vf_loss": 7.0001276652018225, "vf_explained_var": -7.470448811848958e-07, "kl": 0.0001520195433954541, "entropy": 0.593477459748586, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1208.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.972999999999835, "episode_len_mean": 255.94, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 5.499999999999638, -50.00000000000044, 41.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, 46.3, 39.90000000000002, 43.7, 28.09999999999996, -50.00000000000044, 45.1, 41.30000000000001, 30.499999999999993, 30.9, 41.90000000000001, 26.89999999999994, -50.00000000000044, 45.5, -50.00000000000044, 31.900000000000013, 21.09999999999986, 35.900000000000034, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.7, 25.499999999999922, -50.00000000000044, 46.699999999999996, 46.099999999999994, 42.500000000000014, 40.70000000000002, 6.499999999999652, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, 42.70000000000001, 27.299999999999947, 32.90000000000003, 42.10000000000001, 43.7, 43.7, 42.70000000000001, 38.700000000000024, 46.099999999999994, 3.899999999999615, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 42.70000000000001, -50.00000000000044, 39.300000000000026, 42.70000000000001, 8.899999999999686, 46.3, 41.70000000000002, 41.500000000000014, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 14.499999999999766, 45.7, -50.00000000000044, 39.300000000000026, 26.09999999999993, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 42.10000000000001, 41.90000000000001, 41.90000000000001, 31.1, 41.90000000000001, 45.1, -50.00000000000044, 17.299999999999805, 43.50000000000001, -50.00000000000044, 33.30000000000003, -50.00000000000044], "episode_lengths": [500, 42, 446, 500, 84, 168, 500, 500, 38, 102, 64, 220, 500, 50, 88, 196, 192, 82, 232, 500, 46, 500, 182, 290, 142, 500, 88, 500, 68, 500, 54, 246, 500, 34, 40, 76, 94, 436, 500, 328, 500, 500, 74, 228, 172, 80, 64, 64, 74, 114, 40, 462, 500, 500, 58, 50, 500, 166, 500, 500, 500, 500, 202, 74, 500, 108, 74, 412, 38, 84, 86, 30, 60, 500, 500, 500, 500, 90, 356, 44, 500, 108, 240, 38, 500, 500, 500, 148, 80, 82, 82, 190, 82, 50, 500, 328, 66, 500, 168, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4075348793376347, "mean_inference_ms": 1.2961844902993658, "mean_action_processing_ms": 0.15355777456433745, "mean_env_wait_ms": 0.09044337620560176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028995990753173828, "StateBufferConnector_ms": 0.00899648666381836, "ViewRequirementAgentConnector_ms": 0.1269974708557129}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.972999999999835, "episode_len_mean": 255.94, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 5.499999999999638, -50.00000000000044, 41.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, 46.3, 39.90000000000002, 43.7, 28.09999999999996, -50.00000000000044, 45.1, 41.30000000000001, 30.499999999999993, 30.9, 41.90000000000001, 26.89999999999994, -50.00000000000044, 45.5, -50.00000000000044, 31.900000000000013, 21.09999999999986, 35.900000000000034, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.7, 25.499999999999922, -50.00000000000044, 46.699999999999996, 46.099999999999994, 42.500000000000014, 40.70000000000002, 6.499999999999652, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, 42.70000000000001, 27.299999999999947, 32.90000000000003, 42.10000000000001, 43.7, 43.7, 42.70000000000001, 38.700000000000024, 46.099999999999994, 3.899999999999615, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 42.70000000000001, -50.00000000000044, 39.300000000000026, 42.70000000000001, 8.899999999999686, 46.3, 41.70000000000002, 41.500000000000014, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 14.499999999999766, 45.7, -50.00000000000044, 39.300000000000026, 26.09999999999993, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 42.10000000000001, 41.90000000000001, 41.90000000000001, 31.1, 41.90000000000001, 45.1, -50.00000000000044, 17.299999999999805, 43.50000000000001, -50.00000000000044, 33.30000000000003, -50.00000000000044], "episode_lengths": [500, 42, 446, 500, 84, 168, 500, 500, 38, 102, 64, 220, 500, 50, 88, 196, 192, 82, 232, 500, 46, 500, 182, 290, 142, 500, 88, 500, 68, 500, 54, 246, 500, 34, 40, 76, 94, 436, 500, 328, 500, 500, 74, 228, 172, 80, 64, 64, 74, 114, 40, 462, 500, 500, 58, 50, 500, 166, 500, 500, 500, 500, 202, 74, 500, 108, 74, 412, 38, 84, 86, 30, 60, 500, 500, 500, 500, 90, 356, 44, 500, 108, 240, 38, 500, 500, 500, 148, 80, 82, 82, 190, 82, 50, 500, 328, 66, 500, 168, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4075348793376347, "mean_inference_ms": 1.2961844902993658, "mean_action_processing_ms": 0.15355777456433745, "mean_env_wait_ms": 0.09044337620560176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028995990753173828, "StateBufferConnector_ms": 0.00899648666381836, "ViewRequirementAgentConnector_ms": 0.1269974708557129}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4882.018957676038, "num_env_steps_trained_throughput_per_sec": 4882.018957676038, "timesteps_total": 972000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 2643.316, "sample_time_ms": 2348.257, "load_time_ms": 10.899, "load_throughput": 1100990.005, "learn_time_ms": 272.134, "learn_throughput": 44095.932, "synch_weights_time_ms": 10.526}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3741, "training_iteration": 81, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-17", "timestamp": 1698245177, "time_this_iter_s": 2.4629995822906494, "time_total_s": 187.60871481895447, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 187.60871481895447, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 71.93333333333334, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.27180612553028e-26, "cur_lr": 0.0003, "total_loss": 6.78687531153361, "policy_loss": -0.00021104216575622558, "vf_loss": 6.78713862101237, "vf_explained_var": -1.0728836059570312e-06, "kl": 0.00036039295545104246, "entropy": 0.5232649525006612, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1223.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.902999999999829, "episode_len_mean": 256.62, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.90000000000003, 42.10000000000001, 43.7, 43.7, 42.70000000000001, 38.700000000000024, 46.099999999999994, 3.899999999999615, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 42.70000000000001, -50.00000000000044, 39.300000000000026, 42.70000000000001, 8.899999999999686, 46.3, 41.70000000000002, 41.500000000000014, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 14.499999999999766, 45.7, -50.00000000000044, 39.300000000000026, 26.09999999999993, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 42.10000000000001, 41.90000000000001, 41.90000000000001, 31.1, 41.90000000000001, 45.1, -50.00000000000044, 17.299999999999805, 43.50000000000001, -50.00000000000044, 33.30000000000003, -50.00000000000044, 14.899999999999771, -50.00000000000044, 45.5, 43.50000000000001, 46.699999999999996, 14.899999999999771, 40.10000000000002, 32.700000000000024, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 41.30000000000001, 43.7, 26.89999999999994, 44.10000000000001, -50.00000000000044, 40.90000000000002, 46.3, 40.90000000000002, 46.5, -50.00000000000044, 35.10000000000004, 3.499999999999609, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.90000000000001, -50.00000000000044, 25.099999999999916, 35.70000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [172, 80, 64, 64, 74, 114, 40, 462, 500, 500, 58, 50, 500, 166, 500, 500, 500, 500, 202, 74, 500, 108, 74, 412, 38, 84, 86, 30, 60, 500, 500, 500, 500, 90, 356, 44, 500, 108, 240, 38, 500, 500, 500, 148, 80, 82, 82, 190, 82, 50, 500, 328, 66, 500, 168, 500, 352, 500, 46, 66, 34, 352, 100, 174, 500, 72, 500, 68, 500, 88, 64, 232, 60, 500, 92, 38, 92, 36, 500, 150, 466, 500, 500, 100, 500, 70, 500, 500, 96, 56, 500, 500, 60, 82, 500, 250, 144, 58, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4076123618266328, "mean_inference_ms": 1.2961210208125977, "mean_action_processing_ms": 0.1536408291787317, "mean_env_wait_ms": 0.09045329320456276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400373458862305, "StateBufferConnector_ms": 0.006997823715209961, "ViewRequirementAgentConnector_ms": 0.13898754119873047}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.902999999999829, "episode_len_mean": 256.62, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.90000000000003, 42.10000000000001, 43.7, 43.7, 42.70000000000001, 38.700000000000024, 46.099999999999994, 3.899999999999615, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 42.70000000000001, -50.00000000000044, 39.300000000000026, 42.70000000000001, 8.899999999999686, 46.3, 41.70000000000002, 41.500000000000014, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 14.499999999999766, 45.7, -50.00000000000044, 39.300000000000026, 26.09999999999993, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 42.10000000000001, 41.90000000000001, 41.90000000000001, 31.1, 41.90000000000001, 45.1, -50.00000000000044, 17.299999999999805, 43.50000000000001, -50.00000000000044, 33.30000000000003, -50.00000000000044, 14.899999999999771, -50.00000000000044, 45.5, 43.50000000000001, 46.699999999999996, 14.899999999999771, 40.10000000000002, 32.700000000000024, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 41.30000000000001, 43.7, 26.89999999999994, 44.10000000000001, -50.00000000000044, 40.90000000000002, 46.3, 40.90000000000002, 46.5, -50.00000000000044, 35.10000000000004, 3.499999999999609, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.90000000000001, -50.00000000000044, 25.099999999999916, 35.70000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [172, 80, 64, 64, 74, 114, 40, 462, 500, 500, 58, 50, 500, 166, 500, 500, 500, 500, 202, 74, 500, 108, 74, 412, 38, 84, 86, 30, 60, 500, 500, 500, 500, 90, 356, 44, 500, 108, 240, 38, 500, 500, 500, 148, 80, 82, 82, 190, 82, 50, 500, 328, 66, 500, 168, 500, 352, 500, 46, 66, 34, 352, 100, 174, 500, 72, 500, 68, 500, 88, 64, 232, 60, 500, 92, 38, 92, 36, 500, 150, 466, 500, 500, 100, 500, 70, 500, 500, 96, 56, 500, 500, 60, 82, 500, 250, 144, 58, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4076123618266328, "mean_inference_ms": 1.2961210208125977, "mean_action_processing_ms": 0.1536408291787317, "mean_env_wait_ms": 0.09045329320456276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400373458862305, "StateBufferConnector_ms": 0.006997823715209961, "ViewRequirementAgentConnector_ms": 0.13898754119873047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5361.9293535406005, "num_env_steps_trained_throughput_per_sec": 5361.9293535406005, "timesteps_total": 984000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 2547.91, "sample_time_ms": 2276.656, "load_time_ms": 9.899, "load_throughput": 1212197.394, "learn_time_ms": 249.728, "learn_throughput": 48052.251, "synch_weights_time_ms": 10.227}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 3785, "training_iteration": 82, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-19", "timestamp": 1698245179, "time_this_iter_s": 2.242997646331787, "time_total_s": 189.85171246528625, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 189.85171246528625, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 61.46666666666666, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.13590306276514e-26, "cur_lr": 0.0003, "total_loss": 7.701276461283366, "policy_loss": -6.539622942606608e-06, "vf_loss": 7.701333713531494, "vf_explained_var": 4.76837158203125e-08, "kl": 0.00022495477565864045, "entropy": 0.5087952713171641, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1238.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.504999999999836, "episode_len_mean": 260.64, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 17.299999999999805, 43.50000000000001, -50.00000000000044, 33.30000000000003, -50.00000000000044, 14.899999999999771, -50.00000000000044, 45.5, 43.50000000000001, 46.699999999999996, 14.899999999999771, 40.10000000000002, 32.700000000000024, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 41.30000000000001, 43.7, 26.89999999999994, 44.10000000000001, -50.00000000000044, 40.90000000000002, 46.3, 40.90000000000002, 46.5, -50.00000000000044, 35.10000000000004, 3.499999999999609, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.90000000000001, -50.00000000000044, 25.099999999999916, 35.70000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, 38.700000000000024, -50.00000000000044, 46.099999999999994, 30.099999999999987, 41.70000000000002, 37.300000000000026, -50.00000000000044, 45.5, 31.900000000000013, 30.9, 33.90000000000004, 37.10000000000003, 28.89999999999997, 44.300000000000004, 29.299999999999976, 34.900000000000034, 23.8999999999999, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 36.30000000000003, 9.099999999999689, 35.30000000000004, -50.00000000000044, 46.3, 42.900000000000006, 46.699999999999996, -50.00000000000044, 13.499999999999751, -50.00000000000044, -50.00000000000044, 46.5, 32.30000000000002, 27.299999999999947, 14.499999999999766, 46.099999999999994, 39.50000000000002, 45.1, 9.699999999999697, -50.00000000000044, -50.00000000000044, 6.699999999999655, 32.700000000000024, 43.7, 15.899999999999785, 46.5, 36.50000000000003], "episode_lengths": [500, 328, 66, 500, 168, 500, 352, 500, 46, 66, 34, 352, 100, 174, 500, 72, 500, 68, 500, 88, 64, 232, 60, 500, 92, 38, 92, 36, 500, 150, 466, 500, 500, 100, 500, 70, 500, 500, 96, 56, 500, 500, 60, 82, 500, 250, 144, 58, 500, 500, 500, 450, 114, 500, 40, 200, 84, 128, 500, 46, 182, 192, 162, 130, 212, 58, 208, 152, 262, 500, 500, 94, 500, 138, 410, 148, 500, 38, 72, 34, 500, 366, 500, 500, 36, 178, 228, 356, 40, 106, 50, 404, 500, 500, 434, 174, 64, 342, 36, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4078465601990013, "mean_inference_ms": 1.2957190260423521, "mean_action_processing_ms": 0.15332459091491607, "mean_env_wait_ms": 0.09059797122222216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800154685974121, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.11598801612854004}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.504999999999836, "episode_len_mean": 260.64, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 17.299999999999805, 43.50000000000001, -50.00000000000044, 33.30000000000003, -50.00000000000044, 14.899999999999771, -50.00000000000044, 45.5, 43.50000000000001, 46.699999999999996, 14.899999999999771, 40.10000000000002, 32.700000000000024, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 41.30000000000001, 43.7, 26.89999999999994, 44.10000000000001, -50.00000000000044, 40.90000000000002, 46.3, 40.90000000000002, 46.5, -50.00000000000044, 35.10000000000004, 3.499999999999609, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.90000000000001, -50.00000000000044, 25.099999999999916, 35.70000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, 38.700000000000024, -50.00000000000044, 46.099999999999994, 30.099999999999987, 41.70000000000002, 37.300000000000026, -50.00000000000044, 45.5, 31.900000000000013, 30.9, 33.90000000000004, 37.10000000000003, 28.89999999999997, 44.300000000000004, 29.299999999999976, 34.900000000000034, 23.8999999999999, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 36.30000000000003, 9.099999999999689, 35.30000000000004, -50.00000000000044, 46.3, 42.900000000000006, 46.699999999999996, -50.00000000000044, 13.499999999999751, -50.00000000000044, -50.00000000000044, 46.5, 32.30000000000002, 27.299999999999947, 14.499999999999766, 46.099999999999994, 39.50000000000002, 45.1, 9.699999999999697, -50.00000000000044, -50.00000000000044, 6.699999999999655, 32.700000000000024, 43.7, 15.899999999999785, 46.5, 36.50000000000003], "episode_lengths": [500, 328, 66, 500, 168, 500, 352, 500, 46, 66, 34, 352, 100, 174, 500, 72, 500, 68, 500, 88, 64, 232, 60, 500, 92, 38, 92, 36, 500, 150, 466, 500, 500, 100, 500, 70, 500, 500, 96, 56, 500, 500, 60, 82, 500, 250, 144, 58, 500, 500, 500, 450, 114, 500, 40, 200, 84, 128, 500, 46, 182, 192, 162, 130, 212, 58, 208, 152, 262, 500, 500, 94, 500, 138, 410, 148, 500, 38, 72, 34, 500, 366, 500, 500, 36, 178, 228, 356, 40, 106, 50, 404, 500, 500, 434, 174, 64, 342, 36, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4078465601990013, "mean_inference_ms": 1.2957190260423521, "mean_action_processing_ms": 0.15332459091491607, "mean_env_wait_ms": 0.09059797122222216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800154685974121, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.11598801612854004}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5242.458418968808, "num_env_steps_trained_throughput_per_sec": 5242.458418968808, "timesteps_total": 996000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 2461.711, "sample_time_ms": 2198.756, "load_time_ms": 9.299, "load_throughput": 1290419.417, "learn_time_ms": 242.405, "learn_throughput": 49503.84, "synch_weights_time_ms": 9.85}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 3835, "training_iteration": 83, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-22", "timestamp": 1698245182, "time_this_iter_s": 2.295001268386841, "time_total_s": 192.1467137336731, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 192.1467137336731, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 62.150000000000006, "ram_util_percent": 27.125000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.06795153138257e-26, "cur_lr": 0.0003, "total_loss": 6.870632457733154, "policy_loss": -4.788972437381744e-05, "vf_loss": 6.870732084910075, "vf_explained_var": -8.066495259602865e-07, "kl": 9.26448883054339e-05, "entropy": 0.5168860713640849, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1253.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.407999999999854, "episode_len_mean": 236.64, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 30.099999999999987, 41.70000000000002, 37.300000000000026, -50.00000000000044, 45.5, 31.900000000000013, 30.9, 33.90000000000004, 37.10000000000003, 28.89999999999997, 44.300000000000004, 29.299999999999976, 34.900000000000034, 23.8999999999999, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 36.30000000000003, 9.099999999999689, 35.30000000000004, -50.00000000000044, 46.3, 42.900000000000006, 46.699999999999996, -50.00000000000044, 13.499999999999751, -50.00000000000044, -50.00000000000044, 46.5, 32.30000000000002, 27.299999999999947, 14.499999999999766, 46.099999999999994, 39.50000000000002, 45.1, 9.699999999999697, -50.00000000000044, -50.00000000000044, 6.699999999999655, 32.700000000000024, 43.7, 15.899999999999785, 46.5, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.5, 38.90000000000002, -50.00000000000044, 45.3, 46.5, 47.1, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, 39.90000000000002, 33.10000000000003, 25.699999999999925, -50.00000000000044, 45.9, -50.00000000000044, 15.49999999999978, 17.099999999999802, 44.5, 47.1, 44.7, 39.10000000000002, 39.50000000000002, 42.10000000000001, 45.9, 46.099999999999994, 45.7, -50.00000000000044, 44.5, -50.00000000000044, 36.30000000000003, 46.3, 45.7, -50.00000000000044, 46.9, 37.300000000000026, 18.699999999999825, 44.300000000000004, 46.3, -50.00000000000044, 41.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.50000000000003, 44.900000000000006, 44.7, -50.00000000000044], "episode_lengths": [500, 40, 200, 84, 128, 500, 46, 182, 192, 162, 130, 212, 58, 208, 152, 262, 500, 500, 94, 500, 138, 410, 148, 500, 38, 72, 34, 500, 366, 500, 500, 36, 178, 228, 356, 40, 106, 50, 404, 500, 500, 434, 174, 64, 342, 36, 136, 500, 500, 500, 500, 116, 56, 112, 500, 48, 36, 30, 500, 316, 500, 500, 102, 170, 244, 500, 42, 500, 346, 330, 56, 30, 54, 110, 106, 80, 42, 40, 44, 500, 56, 500, 138, 38, 44, 500, 32, 128, 314, 58, 38, 500, 86, 40, 500, 500, 136, 52, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4081782860847904, "mean_inference_ms": 1.2963654368784054, "mean_action_processing_ms": 0.15358839252643589, "mean_env_wait_ms": 0.09059121144566444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500748634338379, "StateBufferConnector_ms": 0.0059964656829833984, "ViewRequirementAgentConnector_ms": 0.12800168991088867}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.407999999999854, "episode_len_mean": 236.64, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 30.099999999999987, 41.70000000000002, 37.300000000000026, -50.00000000000044, 45.5, 31.900000000000013, 30.9, 33.90000000000004, 37.10000000000003, 28.89999999999997, 44.300000000000004, 29.299999999999976, 34.900000000000034, 23.8999999999999, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 36.30000000000003, 9.099999999999689, 35.30000000000004, -50.00000000000044, 46.3, 42.900000000000006, 46.699999999999996, -50.00000000000044, 13.499999999999751, -50.00000000000044, -50.00000000000044, 46.5, 32.30000000000002, 27.299999999999947, 14.499999999999766, 46.099999999999994, 39.50000000000002, 45.1, 9.699999999999697, -50.00000000000044, -50.00000000000044, 6.699999999999655, 32.700000000000024, 43.7, 15.899999999999785, 46.5, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.5, 38.90000000000002, -50.00000000000044, 45.3, 46.5, 47.1, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, 39.90000000000002, 33.10000000000003, 25.699999999999925, -50.00000000000044, 45.9, -50.00000000000044, 15.49999999999978, 17.099999999999802, 44.5, 47.1, 44.7, 39.10000000000002, 39.50000000000002, 42.10000000000001, 45.9, 46.099999999999994, 45.7, -50.00000000000044, 44.5, -50.00000000000044, 36.30000000000003, 46.3, 45.7, -50.00000000000044, 46.9, 37.300000000000026, 18.699999999999825, 44.300000000000004, 46.3, -50.00000000000044, 41.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.50000000000003, 44.900000000000006, 44.7, -50.00000000000044], "episode_lengths": [500, 40, 200, 84, 128, 500, 46, 182, 192, 162, 130, 212, 58, 208, 152, 262, 500, 500, 94, 500, 138, 410, 148, 500, 38, 72, 34, 500, 366, 500, 500, 36, 178, 228, 356, 40, 106, 50, 404, 500, 500, 434, 174, 64, 342, 36, 136, 500, 500, 500, 500, 116, 56, 112, 500, 48, 36, 30, 500, 316, 500, 500, 102, 170, 244, 500, 42, 500, 346, 330, 56, 30, 54, 110, 106, 80, 42, 40, 44, 500, 56, 500, 138, 38, 44, 500, 32, 128, 314, 58, 38, 500, 86, 40, 500, 500, 136, 52, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4081782860847904, "mean_inference_ms": 1.2963654368784054, "mean_action_processing_ms": 0.15358839252643589, "mean_env_wait_ms": 0.09059121144566444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500748634338379, "StateBufferConnector_ms": 0.0059964656829833984, "ViewRequirementAgentConnector_ms": 0.12800168991088867}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5400.542075208106, "num_env_steps_trained_throughput_per_sec": 5400.542075208106, "timesteps_total": 1008000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 2383.714, "sample_time_ms": 2125.356, "load_time_ms": 9.499, "load_throughput": 1263258.966, "learn_time_ms": 237.663, "learn_throughput": 50491.651, "synch_weights_time_ms": 9.995}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3888, "training_iteration": 84, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-24", "timestamp": 1698245184, "time_this_iter_s": 2.2269973754882812, "time_total_s": 194.37371110916138, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 194.37371110916138, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 66.89999999999999, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.033975765691285e-26, "cur_lr": 0.0003, "total_loss": 6.549617799123128, "policy_loss": -0.0005494664112726847, "vf_loss": 6.550216643015544, "vf_explained_var": -1.1046727498372397e-06, "kl": 0.0006647053173234478, "entropy": 0.4926193118095398, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1268.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.78099999999982, "episode_len_mean": 257.84, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 6.699999999999655, 32.700000000000024, 43.7, 15.899999999999785, 46.5, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.5, 38.90000000000002, -50.00000000000044, 45.3, 46.5, 47.1, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, 39.90000000000002, 33.10000000000003, 25.699999999999925, -50.00000000000044, 45.9, -50.00000000000044, 15.49999999999978, 17.099999999999802, 44.5, 47.1, 44.7, 39.10000000000002, 39.50000000000002, 42.10000000000001, 45.9, 46.099999999999994, 45.7, -50.00000000000044, 44.5, -50.00000000000044, 36.30000000000003, 46.3, 45.7, -50.00000000000044, 46.9, 37.300000000000026, 18.699999999999825, 44.300000000000004, 46.3, -50.00000000000044, 41.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.50000000000003, 44.900000000000006, 44.7, -50.00000000000044, 43.30000000000001, 44.5, 2.8999999999996007, 40.500000000000014, 46.099999999999994, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 17.499999999999808, 38.90000000000002, 45.9, 44.5, 47.5, 35.10000000000004, 24.899999999999913, -50.00000000000044, 42.10000000000001, -50.00000000000044, 34.900000000000034, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 13.499999999999751, -50.00000000000044, 46.5, 41.100000000000016, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, 17.299999999999805], "episode_lengths": [500, 500, 434, 174, 64, 342, 36, 136, 500, 500, 500, 500, 116, 56, 112, 500, 48, 36, 30, 500, 316, 500, 500, 102, 170, 244, 500, 42, 500, 346, 330, 56, 30, 54, 110, 106, 80, 42, 40, 44, 500, 56, 500, 138, 38, 44, 500, 32, 128, 314, 58, 38, 500, 86, 40, 500, 500, 136, 52, 54, 500, 68, 56, 472, 96, 40, 94, 500, 500, 500, 500, 500, 48, 500, 326, 112, 42, 56, 26, 150, 252, 500, 80, 500, 152, 86, 500, 500, 500, 50, 500, 366, 500, 36, 90, 500, 348, 500, 500, 328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4073105747066679, "mean_inference_ms": 1.2957079760862695, "mean_action_processing_ms": 0.1536255146795834, "mean_env_wait_ms": 0.09071616256784676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023008108139038086, "StateBufferConnector_ms": 0.0059967041015625, "ViewRequirementAgentConnector_ms": 0.14099645614624023}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.78099999999982, "episode_len_mean": 257.84, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 6.699999999999655, 32.700000000000024, 43.7, 15.899999999999785, 46.5, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.5, 38.90000000000002, -50.00000000000044, 45.3, 46.5, 47.1, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, 39.90000000000002, 33.10000000000003, 25.699999999999925, -50.00000000000044, 45.9, -50.00000000000044, 15.49999999999978, 17.099999999999802, 44.5, 47.1, 44.7, 39.10000000000002, 39.50000000000002, 42.10000000000001, 45.9, 46.099999999999994, 45.7, -50.00000000000044, 44.5, -50.00000000000044, 36.30000000000003, 46.3, 45.7, -50.00000000000044, 46.9, 37.300000000000026, 18.699999999999825, 44.300000000000004, 46.3, -50.00000000000044, 41.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.50000000000003, 44.900000000000006, 44.7, -50.00000000000044, 43.30000000000001, 44.5, 2.8999999999996007, 40.500000000000014, 46.099999999999994, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 17.499999999999808, 38.90000000000002, 45.9, 44.5, 47.5, 35.10000000000004, 24.899999999999913, -50.00000000000044, 42.10000000000001, -50.00000000000044, 34.900000000000034, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 13.499999999999751, -50.00000000000044, 46.5, 41.100000000000016, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, 17.299999999999805], "episode_lengths": [500, 500, 434, 174, 64, 342, 36, 136, 500, 500, 500, 500, 116, 56, 112, 500, 48, 36, 30, 500, 316, 500, 500, 102, 170, 244, 500, 42, 500, 346, 330, 56, 30, 54, 110, 106, 80, 42, 40, 44, 500, 56, 500, 138, 38, 44, 500, 32, 128, 314, 58, 38, 500, 86, 40, 500, 500, 136, 52, 54, 500, 68, 56, 472, 96, 40, 94, 500, 500, 500, 500, 500, 48, 500, 326, 112, 42, 56, 26, 150, 252, 500, 80, 500, 152, 86, 500, 500, 500, 50, 500, 366, 500, 36, 90, 500, 348, 500, 500, 328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4073105747066679, "mean_inference_ms": 1.2957079760862695, "mean_action_processing_ms": 0.1536255146795834, "mean_env_wait_ms": 0.09071616256784676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023008108139038086, "StateBufferConnector_ms": 0.0059967041015625, "ViewRequirementAgentConnector_ms": 0.14099645614624023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5512.1719951624145, "num_env_steps_trained_throughput_per_sec": 5512.1719951624145, "timesteps_total": 1020000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 2308.601, "sample_time_ms": 2062.9, "load_time_ms": 9.299, "load_throughput": 1290439.268, "learn_time_ms": 225.809, "learn_throughput": 53142.156, "synch_weights_time_ms": 9.593}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 3927, "training_iteration": 85, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-26", "timestamp": 1698245186, "time_this_iter_s": 2.181997299194336, "time_total_s": 196.5557084083557, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 196.5557084083557, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 61.26666666666667, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.169878828456425e-27, "cur_lr": 0.0003, "total_loss": 6.686365572611491, "policy_loss": -0.00042217609783013664, "vf_loss": 6.686835257212321, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.0011771798459297618, "entropy": 0.47579694787661236, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1283.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.3109999999998205, "episode_len_mean": 262.52, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, 46.3, -50.00000000000044, 41.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.50000000000003, 44.900000000000006, 44.7, -50.00000000000044, 43.30000000000001, 44.5, 2.8999999999996007, 40.500000000000014, 46.099999999999994, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 17.499999999999808, 38.90000000000002, 45.9, 44.5, 47.5, 35.10000000000004, 24.899999999999913, -50.00000000000044, 42.10000000000001, -50.00000000000044, 34.900000000000034, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 13.499999999999751, -50.00000000000044, 46.5, 41.100000000000016, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, 45.3, 24.69999999999991, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 45.1, -50.00000000000044, 38.300000000000026, 34.900000000000034, 26.499999999999936, -50.00000000000044, 25.499999999999922, 31.900000000000013, 39.300000000000026, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, 47.5, 34.10000000000004, 43.30000000000001, 43.7, 46.699999999999996, -50.00000000000044, 32.100000000000016, 45.3, 24.099999999999902, 44.5, 27.299999999999947, 45.3, 32.700000000000024, 46.099999999999994, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.9, 15.899999999999785], "episode_lengths": [58, 38, 500, 86, 40, 500, 500, 136, 52, 54, 500, 68, 56, 472, 96, 40, 94, 500, 500, 500, 500, 500, 48, 500, 326, 112, 42, 56, 26, 150, 252, 500, 80, 500, 152, 86, 500, 500, 500, 50, 500, 366, 500, 36, 90, 500, 348, 500, 500, 328, 500, 500, 48, 254, 132, 500, 500, 34, 42, 50, 500, 118, 152, 236, 500, 246, 182, 108, 500, 118, 500, 500, 36, 500, 500, 40, 90, 26, 160, 68, 64, 34, 500, 180, 48, 260, 56, 228, 48, 174, 40, 500, 84, 500, 500, 500, 500, 174, 42, 342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40750540765722404, "mean_inference_ms": 1.2948830803530293, "mean_action_processing_ms": 0.15359235877040778, "mean_env_wait_ms": 0.09068009464397006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01499795913696289, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.11200451850891113}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.3109999999998205, "episode_len_mean": 262.52, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, 46.3, -50.00000000000044, 41.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.50000000000003, 44.900000000000006, 44.7, -50.00000000000044, 43.30000000000001, 44.5, 2.8999999999996007, 40.500000000000014, 46.099999999999994, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 17.499999999999808, 38.90000000000002, 45.9, 44.5, 47.5, 35.10000000000004, 24.899999999999913, -50.00000000000044, 42.10000000000001, -50.00000000000044, 34.900000000000034, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 13.499999999999751, -50.00000000000044, 46.5, 41.100000000000016, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, 45.3, 24.69999999999991, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 45.1, -50.00000000000044, 38.300000000000026, 34.900000000000034, 26.499999999999936, -50.00000000000044, 25.499999999999922, 31.900000000000013, 39.300000000000026, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, 47.5, 34.10000000000004, 43.30000000000001, 43.7, 46.699999999999996, -50.00000000000044, 32.100000000000016, 45.3, 24.099999999999902, 44.5, 27.299999999999947, 45.3, 32.700000000000024, 46.099999999999994, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.9, 15.899999999999785], "episode_lengths": [58, 38, 500, 86, 40, 500, 500, 136, 52, 54, 500, 68, 56, 472, 96, 40, 94, 500, 500, 500, 500, 500, 48, 500, 326, 112, 42, 56, 26, 150, 252, 500, 80, 500, 152, 86, 500, 500, 500, 50, 500, 366, 500, 36, 90, 500, 348, 500, 500, 328, 500, 500, 48, 254, 132, 500, 500, 34, 42, 50, 500, 118, 152, 236, 500, 246, 182, 108, 500, 118, 500, 500, 36, 500, 500, 40, 90, 26, 160, 68, 64, 34, 500, 180, 48, 260, 56, 228, 48, 174, 40, 500, 84, 500, 500, 500, 500, 174, 42, 342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40750540765722404, "mean_inference_ms": 1.2948830803530293, "mean_action_processing_ms": 0.15359235877040778, "mean_env_wait_ms": 0.09068009464397006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01499795913696289, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.11200451850891113}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5481.951920510052, "num_env_steps_trained_throughput_per_sec": 5481.951920510052, "timesteps_total": 1032000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 2281.001, "sample_time_ms": 2031.3, "load_time_ms": 9.399, "load_throughput": 1276697.993, "learn_time_ms": 229.706, "learn_throughput": 52240.598, "synch_weights_time_ms": 9.496}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 3977, "training_iteration": 86, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-28", "timestamp": 1698245188, "time_this_iter_s": 2.194002151489258, "time_total_s": 198.74971055984497, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 198.74971055984497, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 63.06666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5849394142282123e-27, "cur_lr": 0.0003, "total_loss": 6.469587326049805, "policy_loss": -0.00019829620917638142, "vf_loss": 6.469830131530761, "vf_explained_var": -1.3907750447591145e-06, "kl": 0.00017017252092349128, "entropy": 0.44459966421127317, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1298.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6119999999998114, "episode_len_mean": 274.48, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.499999999999751, -50.00000000000044, 46.5, 41.100000000000016, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, 45.3, 24.69999999999991, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 45.1, -50.00000000000044, 38.300000000000026, 34.900000000000034, 26.499999999999936, -50.00000000000044, 25.499999999999922, 31.900000000000013, 39.300000000000026, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, 47.5, 34.10000000000004, 43.30000000000001, 43.7, 46.699999999999996, -50.00000000000044, 32.100000000000016, 45.3, 24.099999999999902, 44.5, 27.299999999999947, 45.3, 32.700000000000024, 46.099999999999994, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.9, 15.899999999999785, -50.00000000000044, 31.70000000000001, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 44.7, 39.90000000000002, 45.1, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 31.1, 45.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 38.700000000000024, 22.299999999999876, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.1, -50.00000000000044, 45.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 18.499999999999822, 44.5, 45.9], "episode_lengths": [366, 500, 36, 90, 500, 348, 500, 500, 328, 500, 500, 48, 254, 132, 500, 500, 34, 42, 50, 500, 118, 152, 236, 500, 246, 182, 108, 500, 118, 500, 500, 36, 500, 500, 40, 90, 26, 160, 68, 64, 34, 500, 180, 48, 260, 56, 228, 48, 174, 40, 500, 84, 500, 500, 500, 500, 174, 42, 342, 500, 184, 160, 500, 500, 500, 500, 234, 500, 54, 102, 50, 500, 38, 500, 500, 190, 46, 48, 500, 500, 500, 88, 38, 500, 500, 114, 278, 500, 500, 104, 50, 500, 50, 80, 500, 500, 44, 316, 56, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.407483962310051, "mean_inference_ms": 1.2944474992670094, "mean_action_processing_ms": 0.15364139319356032, "mean_env_wait_ms": 0.09069357111547989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004220962524414, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.10300731658935547}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6119999999998114, "episode_len_mean": 274.48, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.499999999999751, -50.00000000000044, 46.5, 41.100000000000016, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, 45.3, 24.69999999999991, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 45.1, -50.00000000000044, 38.300000000000026, 34.900000000000034, 26.499999999999936, -50.00000000000044, 25.499999999999922, 31.900000000000013, 39.300000000000026, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, 47.5, 34.10000000000004, 43.30000000000001, 43.7, 46.699999999999996, -50.00000000000044, 32.100000000000016, 45.3, 24.099999999999902, 44.5, 27.299999999999947, 45.3, 32.700000000000024, 46.099999999999994, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.9, 15.899999999999785, -50.00000000000044, 31.70000000000001, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 44.7, 39.90000000000002, 45.1, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 31.1, 45.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 38.700000000000024, 22.299999999999876, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.1, -50.00000000000044, 45.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 18.499999999999822, 44.5, 45.9], "episode_lengths": [366, 500, 36, 90, 500, 348, 500, 500, 328, 500, 500, 48, 254, 132, 500, 500, 34, 42, 50, 500, 118, 152, 236, 500, 246, 182, 108, 500, 118, 500, 500, 36, 500, 500, 40, 90, 26, 160, 68, 64, 34, 500, 180, 48, 260, 56, 228, 48, 174, 40, 500, 84, 500, 500, 500, 500, 174, 42, 342, 500, 184, 160, 500, 500, 500, 500, 234, 500, 54, 102, 50, 500, 38, 500, 500, 190, 46, 48, 500, 500, 500, 88, 38, 500, 500, 114, 278, 500, 500, 104, 50, 500, 50, 80, 500, 500, 44, 316, 56, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.407483962310051, "mean_inference_ms": 1.2944474992670094, "mean_action_processing_ms": 0.15364139319356032, "mean_env_wait_ms": 0.09069357111547989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004220962524414, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.10300731658935547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4737.465024336482, "num_env_steps_trained_throughput_per_sec": 4737.465024336482, "timesteps_total": 1044000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 2289.401, "sample_time_ms": 2044.1, "load_time_ms": 9.099, "load_throughput": 1318776.903, "learn_time_ms": 225.504, "learn_throughput": 53214.231, "synch_weights_time_ms": 9.598}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 4018, "training_iteration": 87, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-31", "timestamp": 1698245191, "time_this_iter_s": 2.5379998683929443, "time_total_s": 201.28771042823792, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 201.28771042823792, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 59.7, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2924697071141062e-27, "cur_lr": 0.0003, "total_loss": 6.736551570892334, "policy_loss": -0.00029771309345960617, "vf_loss": 6.736896610260009, "vf_explained_var": -1.5179316202799478e-06, "kl": 0.0006564816465697732, "entropy": 0.4735378901163737, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1313.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.426999999999834, "episode_len_mean": 241.38, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.700000000000024, 45.9, 15.899999999999785, -50.00000000000044, 31.70000000000001, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 44.7, 39.90000000000002, 45.1, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 31.1, 45.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 38.700000000000024, 22.299999999999876, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.1, -50.00000000000044, 45.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 18.499999999999822, 44.5, 45.9, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 47.1, 45.9, 47.3, 15.899999999999785, 42.500000000000014, 40.90000000000002, 45.3, 46.699999999999996, 35.900000000000034, 28.699999999999967, 46.5, -50.00000000000044, 47.1, 47.1, -50.00000000000044, -50.00000000000044, 45.7, 26.69999999999994, 46.5, 23.699999999999896, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.30000000000002, 42.500000000000014, 46.099999999999994, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.9, 38.10000000000002, 46.3, 14.499999999999766, 45.9, 43.30000000000001, -50.00000000000044, 37.90000000000003, 46.099999999999994, -50.00000000000044, 47.1, 25.29999999999992, 39.10000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.500000000000014, 45.9, 42.10000000000001], "episode_lengths": [174, 42, 342, 500, 184, 160, 500, 500, 500, 500, 234, 500, 54, 102, 50, 500, 38, 500, 500, 190, 46, 48, 500, 500, 500, 88, 38, 500, 500, 114, 278, 500, 500, 104, 50, 500, 50, 80, 500, 500, 44, 316, 56, 42, 500, 78, 500, 500, 30, 42, 28, 342, 76, 92, 48, 34, 142, 214, 36, 500, 30, 30, 500, 500, 44, 234, 36, 264, 500, 52, 500, 98, 76, 40, 92, 500, 500, 34, 500, 34, 500, 42, 120, 38, 356, 42, 68, 500, 122, 40, 500, 30, 248, 110, 500, 74, 500, 76, 42, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40719783303672613, "mean_inference_ms": 1.2945823188976895, "mean_action_processing_ms": 0.1531153905091761, "mean_env_wait_ms": 0.09049920631961349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800917625427246, "StateBufferConnector_ms": 0.008995532989501953, "ViewRequirementAgentConnector_ms": 0.11900830268859863}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.426999999999834, "episode_len_mean": 241.38, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.700000000000024, 45.9, 15.899999999999785, -50.00000000000044, 31.70000000000001, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 44.7, 39.90000000000002, 45.1, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 31.1, 45.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 38.700000000000024, 22.299999999999876, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.1, -50.00000000000044, 45.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 18.499999999999822, 44.5, 45.9, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 47.1, 45.9, 47.3, 15.899999999999785, 42.500000000000014, 40.90000000000002, 45.3, 46.699999999999996, 35.900000000000034, 28.699999999999967, 46.5, -50.00000000000044, 47.1, 47.1, -50.00000000000044, -50.00000000000044, 45.7, 26.69999999999994, 46.5, 23.699999999999896, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.30000000000002, 42.500000000000014, 46.099999999999994, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.9, 38.10000000000002, 46.3, 14.499999999999766, 45.9, 43.30000000000001, -50.00000000000044, 37.90000000000003, 46.099999999999994, -50.00000000000044, 47.1, 25.29999999999992, 39.10000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.500000000000014, 45.9, 42.10000000000001], "episode_lengths": [174, 42, 342, 500, 184, 160, 500, 500, 500, 500, 234, 500, 54, 102, 50, 500, 38, 500, 500, 190, 46, 48, 500, 500, 500, 88, 38, 500, 500, 114, 278, 500, 500, 104, 50, 500, 50, 80, 500, 500, 44, 316, 56, 42, 500, 78, 500, 500, 30, 42, 28, 342, 76, 92, 48, 34, 142, 214, 36, 500, 30, 30, 500, 500, 44, 234, 36, 264, 500, 52, 500, 98, 76, 40, 92, 500, 500, 34, 500, 34, 500, 42, 120, 38, 356, 42, 68, 500, 122, 40, 500, 30, 248, 110, 500, 74, 500, 76, 42, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40719783303672613, "mean_inference_ms": 1.2945823188976895, "mean_action_processing_ms": 0.1531153905091761, "mean_env_wait_ms": 0.09049920631961349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800917625427246, "StateBufferConnector_ms": 0.008995532989501953, "ViewRequirementAgentConnector_ms": 0.11900830268859863}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5703.425036524862, "num_env_steps_trained_throughput_per_sec": 5703.425036524862, "timesteps_total": 1056000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 2279.401, "sample_time_ms": 2036.0, "load_time_ms": 9.199, "load_throughput": 1304428.848, "learn_time_ms": 223.203, "learn_throughput": 53762.605, "synch_weights_time_ms": 9.898}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 4074, "training_iteration": 88, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-33", "timestamp": 1698245193, "time_this_iter_s": 2.108999013900757, "time_total_s": 203.39670944213867, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 203.39670944213867, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 62.76666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.462348535570531e-28, "cur_lr": 0.0003, "total_loss": 6.097215270996093, "policy_loss": -0.000511195386449496, "vf_loss": 6.097770118713379, "vf_explained_var": -7.152557373046875e-07, "kl": 0.0003711069760962952, "entropy": 0.43776931961377463, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1328.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.59699999999984, "episode_len_mean": 229.68, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, -50.00000000000044, 47.1, 45.9, 47.3, 15.899999999999785, 42.500000000000014, 40.90000000000002, 45.3, 46.699999999999996, 35.900000000000034, 28.699999999999967, 46.5, -50.00000000000044, 47.1, 47.1, -50.00000000000044, -50.00000000000044, 45.7, 26.69999999999994, 46.5, 23.699999999999896, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.30000000000002, 42.500000000000014, 46.099999999999994, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.9, 38.10000000000002, 46.3, 14.499999999999766, 45.9, 43.30000000000001, -50.00000000000044, 37.90000000000003, 46.099999999999994, -50.00000000000044, 47.1, 25.29999999999992, 39.10000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.500000000000014, 45.9, 42.10000000000001, -50.00000000000044, 44.300000000000004, 44.900000000000006, 35.500000000000036, 47.3, 44.7, 41.90000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 47.5, 47.7, -50.00000000000044, 19.09999999999983, 45.1, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 45.1, 47.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.50000000000001, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 35.10000000000004], "episode_lengths": [78, 500, 500, 30, 42, 28, 342, 76, 92, 48, 34, 142, 214, 36, 500, 30, 30, 500, 500, 44, 234, 36, 264, 500, 52, 500, 98, 76, 40, 92, 500, 500, 34, 500, 34, 500, 42, 120, 38, 356, 42, 68, 500, 122, 40, 500, 30, 248, 110, 500, 74, 500, 76, 42, 80, 500, 58, 52, 146, 28, 54, 82, 500, 38, 500, 500, 500, 46, 500, 26, 24, 500, 310, 50, 46, 500, 74, 500, 74, 500, 500, 500, 500, 500, 32, 500, 32, 50, 26, 500, 500, 90, 66, 500, 78, 30, 500, 500, 92, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40711839908851466, "mean_inference_ms": 1.2948207198055837, "mean_action_processing_ms": 0.15284974338639976, "mean_env_wait_ms": 0.0904278832373473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025998353958129883, "StateBufferConnector_ms": 0.004994630813598633, "ViewRequirementAgentConnector_ms": 0.12200736999511719}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.59699999999984, "episode_len_mean": 229.68, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, -50.00000000000044, 47.1, 45.9, 47.3, 15.899999999999785, 42.500000000000014, 40.90000000000002, 45.3, 46.699999999999996, 35.900000000000034, 28.699999999999967, 46.5, -50.00000000000044, 47.1, 47.1, -50.00000000000044, -50.00000000000044, 45.7, 26.69999999999994, 46.5, 23.699999999999896, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.30000000000002, 42.500000000000014, 46.099999999999994, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.9, 38.10000000000002, 46.3, 14.499999999999766, 45.9, 43.30000000000001, -50.00000000000044, 37.90000000000003, 46.099999999999994, -50.00000000000044, 47.1, 25.29999999999992, 39.10000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.500000000000014, 45.9, 42.10000000000001, -50.00000000000044, 44.300000000000004, 44.900000000000006, 35.500000000000036, 47.3, 44.7, 41.90000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 47.5, 47.7, -50.00000000000044, 19.09999999999983, 45.1, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 45.1, 47.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.50000000000001, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 35.10000000000004], "episode_lengths": [78, 500, 500, 30, 42, 28, 342, 76, 92, 48, 34, 142, 214, 36, 500, 30, 30, 500, 500, 44, 234, 36, 264, 500, 52, 500, 98, 76, 40, 92, 500, 500, 34, 500, 34, 500, 42, 120, 38, 356, 42, 68, 500, 122, 40, 500, 30, 248, 110, 500, 74, 500, 76, 42, 80, 500, 58, 52, 146, 28, 54, 82, 500, 38, 500, 500, 500, 46, 500, 26, 24, 500, 310, 50, 46, 500, 74, 500, 74, 500, 500, 500, 500, 500, 32, 500, 32, 50, 26, 500, 500, 90, 66, 500, 78, 30, 500, 500, 92, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40711839908851466, "mean_inference_ms": 1.2948207198055837, "mean_action_processing_ms": 0.15284974338639976, "mean_env_wait_ms": 0.0904278832373473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025998353958129883, "StateBufferConnector_ms": 0.004994630813598633, "ViewRequirementAgentConnector_ms": 0.12200736999511719}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5415.161676499818, "num_env_steps_trained_throughput_per_sec": 5415.161676499818, "timesteps_total": 1068000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 2266.801, "sample_time_ms": 2029.999, "load_time_ms": 9.699, "load_throughput": 1237181.786, "learn_time_ms": 216.103, "learn_throughput": 55528.965, "synch_weights_time_ms": 9.898}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 4119, "training_iteration": 89, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-35", "timestamp": 1698245195, "time_this_iter_s": 2.2219996452331543, "time_total_s": 205.61870908737183, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 205.61870908737183, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 63.46666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.2311742677852654e-28, "cur_lr": 0.0003, "total_loss": 6.1326312065124515, "policy_loss": -0.00029443415502707163, "vf_loss": 6.132962544759114, "vf_explained_var": -1.5020370483398437e-06, "kl": 0.0009582650349140447, "entropy": 0.36816471417744956, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1343.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.5309999999997936, "episode_len_mean": 270.24, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.499999999999766, 45.9, 43.30000000000001, -50.00000000000044, 37.90000000000003, 46.099999999999994, -50.00000000000044, 47.1, 25.29999999999992, 39.10000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.500000000000014, 45.9, 42.10000000000001, -50.00000000000044, 44.300000000000004, 44.900000000000006, 35.500000000000036, 47.3, 44.7, 41.90000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 47.5, 47.7, -50.00000000000044, 19.09999999999983, 45.1, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 45.1, 47.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.50000000000001, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, 46.3, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, 48.1, 46.3, -50.00000000000044, 46.9, 0.2999999999995637, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [356, 42, 68, 500, 122, 40, 500, 30, 248, 110, 500, 74, 500, 76, 42, 80, 500, 58, 52, 146, 28, 54, 82, 500, 38, 500, 500, 500, 46, 500, 26, 24, 500, 310, 50, 46, 500, 74, 500, 74, 500, 500, 500, 500, 500, 32, 500, 32, 50, 26, 500, 500, 90, 66, 500, 78, 30, 500, 500, 92, 150, 500, 500, 500, 68, 500, 500, 76, 36, 38, 500, 298, 500, 500, 34, 500, 500, 54, 500, 66, 500, 36, 42, 500, 500, 36, 40, 20, 38, 500, 32, 498, 500, 34, 500, 500, 36, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4068492804521439, "mean_inference_ms": 1.2943623887853, "mean_action_processing_ms": 0.15336200571186193, "mean_env_wait_ms": 0.09056308900574958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03498959541320801, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.13196063041687012}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.5309999999997936, "episode_len_mean": 270.24, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.499999999999766, 45.9, 43.30000000000001, -50.00000000000044, 37.90000000000003, 46.099999999999994, -50.00000000000044, 47.1, 25.29999999999992, 39.10000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.500000000000014, 45.9, 42.10000000000001, -50.00000000000044, 44.300000000000004, 44.900000000000006, 35.500000000000036, 47.3, 44.7, 41.90000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 47.5, 47.7, -50.00000000000044, 19.09999999999983, 45.1, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 45.1, 47.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.50000000000001, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, 46.3, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, 48.1, 46.3, -50.00000000000044, 46.9, 0.2999999999995637, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [356, 42, 68, 500, 122, 40, 500, 30, 248, 110, 500, 74, 500, 76, 42, 80, 500, 58, 52, 146, 28, 54, 82, 500, 38, 500, 500, 500, 46, 500, 26, 24, 500, 310, 50, 46, 500, 74, 500, 74, 500, 500, 500, 500, 500, 32, 500, 32, 50, 26, 500, 500, 90, 66, 500, 78, 30, 500, 500, 92, 150, 500, 500, 500, 68, 500, 500, 76, 36, 38, 500, 298, 500, 500, 34, 500, 500, 54, 500, 66, 500, 36, 42, 500, 500, 36, 40, 20, 38, 500, 32, 498, 500, 34, 500, 500, 36, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4068492804521439, "mean_inference_ms": 1.2943623887853, "mean_action_processing_ms": 0.15336200571186193, "mean_env_wait_ms": 0.09056308900574958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03498959541320801, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.13196063041687012}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5354.553109459419, "num_env_steps_trained_throughput_per_sec": 5354.553109459419, "timesteps_total": 1080000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 2266.709, "sample_time_ms": 2018.599, "load_time_ms": 12.2, "load_throughput": 983641.328, "learn_time_ms": 225.311, "learn_throughput": 53259.628, "synch_weights_time_ms": 9.698}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4158, "training_iteration": 90, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-38", "timestamp": 1698245198, "time_this_iter_s": 2.2460825443267822, "time_total_s": 207.8647916316986, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 207.8647916316986, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 62.43333333333334, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6155871338926327e-28, "cur_lr": 0.0003, "total_loss": 6.13391850789388, "policy_loss": -0.00013777787486712138, "vf_loss": 6.134094524383545, "vf_explained_var": -8.861223856608073e-07, "kl": 0.00013353558232817402, "entropy": 0.38171540896097816, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1358.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.061000000000234, "episode_len_mean": 296.1, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 45.1, 47.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.50000000000001, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, 46.3, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, 48.1, 46.3, -50.00000000000044, 46.9, 0.2999999999995637, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.9, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 47.7, 46.099999999999994, 47.5, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.9, 31.500000000000007, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 10.099999999999703, -50.00000000000044, 41.90000000000001, 47.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, 44.5], "episode_lengths": [500, 500, 500, 500, 32, 500, 32, 50, 26, 500, 500, 90, 66, 500, 78, 30, 500, 500, 92, 150, 500, 500, 500, 68, 500, 500, 76, 36, 38, 500, 298, 500, 500, 34, 500, 500, 54, 500, 66, 500, 36, 42, 500, 500, 36, 40, 20, 38, 500, 32, 498, 500, 34, 500, 500, 36, 500, 500, 500, 500, 222, 500, 500, 500, 500, 98, 500, 42, 46, 500, 500, 500, 242, 24, 40, 26, 500, 120, 500, 32, 186, 34, 500, 500, 500, 28, 48, 36, 500, 500, 500, 62, 400, 500, 82, 24, 500, 134, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40689105889471916, "mean_inference_ms": 1.294110969691416, "mean_action_processing_ms": 0.15338921945359282, "mean_env_wait_ms": 0.09045778177847406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026988506317138672, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.11997246742248535}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.061000000000234, "episode_len_mean": 296.1, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 45.1, 47.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.50000000000001, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, 46.3, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, 48.1, 46.3, -50.00000000000044, 46.9, 0.2999999999995637, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.9, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 47.7, 46.099999999999994, 47.5, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.9, 31.500000000000007, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 10.099999999999703, -50.00000000000044, 41.90000000000001, 47.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, 44.5], "episode_lengths": [500, 500, 500, 500, 32, 500, 32, 50, 26, 500, 500, 90, 66, 500, 78, 30, 500, 500, 92, 150, 500, 500, 500, 68, 500, 500, 76, 36, 38, 500, 298, 500, 500, 34, 500, 500, 54, 500, 66, 500, 36, 42, 500, 500, 36, 40, 20, 38, 500, 32, 498, 500, 34, 500, 500, 36, 500, 500, 500, 500, 222, 500, 500, 500, 500, 98, 500, 42, 46, 500, 500, 500, 242, 24, 40, 26, 500, 120, 500, 32, 186, 34, 500, 500, 500, 28, 48, 36, 500, 500, 500, 62, 400, 500, 82, 24, 500, 134, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40689105889471916, "mean_inference_ms": 1.294110969691416, "mean_action_processing_ms": 0.15338921945359282, "mean_env_wait_ms": 0.09045778177847406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026988506317138672, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.11997246742248535}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5660.371934876252, "num_env_steps_trained_throughput_per_sec": 5660.371934876252, "timesteps_total": 1092000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 2232.909, "sample_time_ms": 2003.399, "load_time_ms": 11.7, "load_throughput": 1025681.925, "learn_time_ms": 207.112, "learn_throughput": 57939.778, "synch_weights_time_ms": 9.798}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 4199, "training_iteration": 91, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-40", "timestamp": 1698245200, "time_this_iter_s": 2.125000238418579, "time_total_s": 209.9897918701172, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 209.9897918701172, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 62.6, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.077935669463164e-29, "cur_lr": 0.0003, "total_loss": 6.505055586496989, "policy_loss": -0.0002660274505615234, "vf_loss": 6.505360412597656, "vf_explained_var": -1.7484029134114583e-06, "kl": 0.0002845438565541277, "entropy": 0.3878750463326772, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1373.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.197999999999822, "episode_len_mean": 238.64, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.9, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 47.7, 46.099999999999994, 47.5, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.9, 31.500000000000007, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 10.099999999999703, -50.00000000000044, 41.90000000000001, 47.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, 15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 42.900000000000006, 45.1, 45.1, 44.5, 44.5, 44.300000000000004, -50.00000000000044, 46.3, 45.1, 46.099999999999994, 45.5, 47.7, -50.00000000000044, 16.29999999999979, 34.10000000000004, 45.9, 46.9, 40.10000000000002, 47.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.7, -50.00000000000044, 43.900000000000006, 46.099999999999994, 46.5, 47.5, 44.7, -50.00000000000044, 46.3, 46.9, 46.9, -50.00000000000044, 38.700000000000024, 46.3, 46.5, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 46.3, 20.699999999999854, 45.3, -50.00000000000044, 41.500000000000014], "episode_lengths": [222, 500, 500, 500, 500, 98, 500, 42, 46, 500, 500, 500, 242, 24, 40, 26, 500, 120, 500, 32, 186, 34, 500, 500, 500, 28, 48, 36, 500, 500, 500, 62, 400, 500, 82, 24, 500, 134, 500, 56, 500, 500, 500, 60, 500, 38, 350, 500, 500, 500, 500, 32, 500, 48, 72, 50, 50, 56, 56, 58, 500, 38, 50, 40, 46, 24, 500, 338, 160, 42, 32, 100, 26, 500, 52, 500, 24, 500, 62, 40, 36, 26, 54, 500, 38, 32, 32, 500, 114, 38, 36, 500, 36, 30, 500, 38, 294, 48, 500, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4071041110249958, "mean_inference_ms": 1.2938358222769317, "mean_action_processing_ms": 0.15305069891893747, "mean_env_wait_ms": 0.09045037093088233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013004779815673828, "StateBufferConnector_ms": 0.007002830505371094, "ViewRequirementAgentConnector_ms": 0.10998845100402832}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.197999999999822, "episode_len_mean": 238.64, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.9, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 47.7, 46.099999999999994, 47.5, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.9, 31.500000000000007, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 10.099999999999703, -50.00000000000044, 41.90000000000001, 47.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, 15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 42.900000000000006, 45.1, 45.1, 44.5, 44.5, 44.300000000000004, -50.00000000000044, 46.3, 45.1, 46.099999999999994, 45.5, 47.7, -50.00000000000044, 16.29999999999979, 34.10000000000004, 45.9, 46.9, 40.10000000000002, 47.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.7, -50.00000000000044, 43.900000000000006, 46.099999999999994, 46.5, 47.5, 44.7, -50.00000000000044, 46.3, 46.9, 46.9, -50.00000000000044, 38.700000000000024, 46.3, 46.5, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 46.3, 20.699999999999854, 45.3, -50.00000000000044, 41.500000000000014], "episode_lengths": [222, 500, 500, 500, 500, 98, 500, 42, 46, 500, 500, 500, 242, 24, 40, 26, 500, 120, 500, 32, 186, 34, 500, 500, 500, 28, 48, 36, 500, 500, 500, 62, 400, 500, 82, 24, 500, 134, 500, 56, 500, 500, 500, 60, 500, 38, 350, 500, 500, 500, 500, 32, 500, 48, 72, 50, 50, 56, 56, 58, 500, 38, 50, 40, 46, 24, 500, 338, 160, 42, 32, 100, 26, 500, 52, 500, 24, 500, 62, 40, 36, 26, 54, 500, 38, 32, 32, 500, 114, 38, 36, 500, 36, 30, 500, 38, 294, 48, 500, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4071041110249958, "mean_inference_ms": 1.2938358222769317, "mean_action_processing_ms": 0.15305069891893747, "mean_env_wait_ms": 0.09045037093088233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013004779815673828, "StateBufferConnector_ms": 0.007002830505371094, "ViewRequirementAgentConnector_ms": 0.10998845100402832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5141.389506699165, "num_env_steps_trained_throughput_per_sec": 5141.389506699165, "timesteps_total": 1104000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 2242.509, "sample_time_ms": 1994.9, "load_time_ms": 12.2, "load_throughput": 983639.405, "learn_time_ms": 224.511, "learn_throughput": 53449.411, "synch_weights_time_ms": 9.998}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 4259, "training_iteration": 92, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-42", "timestamp": 1698245202, "time_this_iter_s": 2.338999032974243, "time_total_s": 212.32879090309143, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 212.32879090309143, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 64.43333333333334, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.038967834731582e-29, "cur_lr": 0.0003, "total_loss": 5.89554713567098, "policy_loss": -2.9779722293217977e-05, "vf_loss": 5.895617039998372, "vf_explained_var": -1.621246337890625e-06, "kl": 0.00017128940340474703, "entropy": 0.3997969448566437, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1388.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.175999999999831, "episode_len_mean": 228.88, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, 15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 42.900000000000006, 45.1, 45.1, 44.5, 44.5, 44.300000000000004, -50.00000000000044, 46.3, 45.1, 46.099999999999994, 45.5, 47.7, -50.00000000000044, 16.29999999999979, 34.10000000000004, 45.9, 46.9, 40.10000000000002, 47.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.7, -50.00000000000044, 43.900000000000006, 46.099999999999994, 46.5, 47.5, 44.7, -50.00000000000044, 46.3, 46.9, 46.9, -50.00000000000044, 38.700000000000024, 46.3, 46.5, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 46.3, 20.699999999999854, 45.3, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.5, -50.00000000000044, 38.50000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, 38.10000000000002, -50.00000000000044, 32.100000000000016, 45.9, 2.499999999999595, -50.00000000000044, 44.900000000000006, 46.5, 46.099999999999994, 47.9, 42.70000000000001, 38.700000000000024, -50.00000000000044, 45.1, 47.7, 24.899999999999913, 46.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001], "episode_lengths": [500, 60, 500, 38, 350, 500, 500, 500, 500, 32, 500, 48, 72, 50, 50, 56, 56, 58, 500, 38, 50, 40, 46, 24, 500, 338, 160, 42, 32, 100, 26, 500, 52, 500, 24, 500, 62, 40, 36, 26, 54, 500, 38, 32, 32, 500, 114, 38, 36, 500, 36, 30, 500, 38, 294, 48, 500, 86, 500, 500, 500, 500, 500, 500, 500, 30, 500, 500, 500, 36, 46, 500, 116, 76, 500, 500, 36, 120, 500, 180, 42, 476, 500, 52, 36, 40, 22, 74, 114, 500, 50, 24, 252, 36, 28, 500, 500, 500, 46, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4071872796462886, "mean_inference_ms": 1.294193292824319, "mean_action_processing_ms": 0.15346045911213746, "mean_env_wait_ms": 0.09046940408349348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900625228881836, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.12497591972351074}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.175999999999831, "episode_len_mean": 228.88, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, 15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 42.900000000000006, 45.1, 45.1, 44.5, 44.5, 44.300000000000004, -50.00000000000044, 46.3, 45.1, 46.099999999999994, 45.5, 47.7, -50.00000000000044, 16.29999999999979, 34.10000000000004, 45.9, 46.9, 40.10000000000002, 47.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.7, -50.00000000000044, 43.900000000000006, 46.099999999999994, 46.5, 47.5, 44.7, -50.00000000000044, 46.3, 46.9, 46.9, -50.00000000000044, 38.700000000000024, 46.3, 46.5, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 46.3, 20.699999999999854, 45.3, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.5, -50.00000000000044, 38.50000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, 38.10000000000002, -50.00000000000044, 32.100000000000016, 45.9, 2.499999999999595, -50.00000000000044, 44.900000000000006, 46.5, 46.099999999999994, 47.9, 42.70000000000001, 38.700000000000024, -50.00000000000044, 45.1, 47.7, 24.899999999999913, 46.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001], "episode_lengths": [500, 60, 500, 38, 350, 500, 500, 500, 500, 32, 500, 48, 72, 50, 50, 56, 56, 58, 500, 38, 50, 40, 46, 24, 500, 338, 160, 42, 32, 100, 26, 500, 52, 500, 24, 500, 62, 40, 36, 26, 54, 500, 38, 32, 32, 500, 114, 38, 36, 500, 36, 30, 500, 38, 294, 48, 500, 86, 500, 500, 500, 500, 500, 500, 500, 30, 500, 500, 500, 36, 46, 500, 116, 76, 500, 500, 36, 120, 500, 180, 42, 476, 500, 52, 36, 40, 22, 74, 114, 500, 50, 24, 252, 36, 28, 500, 500, 500, 46, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4071872796462886, "mean_inference_ms": 1.294193292824319, "mean_action_processing_ms": 0.15346045911213746, "mean_env_wait_ms": 0.09046940408349348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900625228881836, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.12497591972351074}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4930.153676076686, "num_env_steps_trained_throughput_per_sec": 4930.153676076686, "timesteps_total": 1116000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 2257.009, "sample_time_ms": 2013.5, "load_time_ms": 12.2, "load_throughput": 983639.405, "learn_time_ms": 220.311, "learn_throughput": 54468.392, "synch_weights_time_ms": 10.098}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4301, "training_iteration": 93, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-45", "timestamp": 1698245205, "time_this_iter_s": 2.439000129699707, "time_total_s": 214.76779103279114, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 214.76779103279114, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 64.35000000000001, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.019483917365791e-29, "cur_lr": 0.0003, "total_loss": 6.4599601109822595, "policy_loss": -0.00039317806561787924, "vf_loss": 6.460389264424642, "vf_explained_var": -4.887580871582031e-07, "kl": 0.000440149942479214, "entropy": 0.36008696754773456, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1403.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6209999999997984, "episode_len_mean": 269.36, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.5, 44.7, -50.00000000000044, 46.3, 46.9, 46.9, -50.00000000000044, 38.700000000000024, 46.3, 46.5, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 46.3, 20.699999999999854, 45.3, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.5, -50.00000000000044, 38.50000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, 38.10000000000002, -50.00000000000044, 32.100000000000016, 45.9, 2.499999999999595, -50.00000000000044, 44.900000000000006, 46.5, 46.099999999999994, 47.9, 42.70000000000001, 38.700000000000024, -50.00000000000044, 45.1, 47.7, 24.899999999999913, 46.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.7, 36.30000000000003, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 3.499999999999609, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, 33.70000000000004, 34.70000000000004, 25.699999999999925, -50.00000000000044, 13.899999999999757, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.300000000000026, 47.5], "episode_lengths": [26, 54, 500, 38, 32, 32, 500, 114, 38, 36, 500, 36, 30, 500, 38, 294, 48, 500, 86, 500, 500, 500, 500, 500, 500, 500, 30, 500, 500, 500, 36, 46, 500, 116, 76, 500, 500, 36, 120, 500, 180, 42, 476, 500, 52, 36, 40, 22, 74, 114, 500, 50, 24, 252, 36, 28, 500, 500, 500, 46, 74, 318, 500, 500, 500, 500, 500, 500, 42, 500, 44, 138, 36, 500, 500, 500, 38, 500, 500, 466, 74, 500, 500, 58, 96, 500, 500, 28, 40, 164, 154, 244, 500, 362, 58, 500, 500, 34, 108, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40690953962235915, "mean_inference_ms": 1.294002898339613, "mean_action_processing_ms": 0.15395555369681965, "mean_env_wait_ms": 0.09045756373331205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004697799682617, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.13199377059936523}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6209999999997984, "episode_len_mean": 269.36, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.5, 44.7, -50.00000000000044, 46.3, 46.9, 46.9, -50.00000000000044, 38.700000000000024, 46.3, 46.5, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 46.3, 20.699999999999854, 45.3, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.5, -50.00000000000044, 38.50000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, 38.10000000000002, -50.00000000000044, 32.100000000000016, 45.9, 2.499999999999595, -50.00000000000044, 44.900000000000006, 46.5, 46.099999999999994, 47.9, 42.70000000000001, 38.700000000000024, -50.00000000000044, 45.1, 47.7, 24.899999999999913, 46.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.7, 36.30000000000003, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 3.499999999999609, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, 33.70000000000004, 34.70000000000004, 25.699999999999925, -50.00000000000044, 13.899999999999757, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.300000000000026, 47.5], "episode_lengths": [26, 54, 500, 38, 32, 32, 500, 114, 38, 36, 500, 36, 30, 500, 38, 294, 48, 500, 86, 500, 500, 500, 500, 500, 500, 500, 30, 500, 500, 500, 36, 46, 500, 116, 76, 500, 500, 36, 120, 500, 180, 42, 476, 500, 52, 36, 40, 22, 74, 114, 500, 50, 24, 252, 36, 28, 500, 500, 500, 46, 74, 318, 500, 500, 500, 500, 500, 500, 42, 500, 44, 138, 36, 500, 500, 500, 38, 500, 500, 466, 74, 500, 500, 58, 96, 500, 500, 28, 40, 164, 154, 244, 500, 362, 58, 500, 500, 34, 108, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40690953962235915, "mean_inference_ms": 1.294002898339613, "mean_action_processing_ms": 0.15395555369681965, "mean_env_wait_ms": 0.09045756373331205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004697799682617, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.13199377059936523}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4796.157406008922, "num_env_steps_trained_throughput_per_sec": 4796.157406008922, "timesteps_total": 1128000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 2285.009, "sample_time_ms": 2026.3, "load_time_ms": 12.5, "load_throughput": 960036.622, "learn_time_ms": 235.411, "learn_throughput": 50974.632, "synch_weights_time_ms": 9.899}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 4340, "training_iteration": 94, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-47", "timestamp": 1698245207, "time_this_iter_s": 2.5069992542266846, "time_total_s": 217.27479028701782, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 217.27479028701782, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 73.16666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0097419586828954e-29, "cur_lr": 0.0003, "total_loss": 6.160694885253906, "policy_loss": -0.0003311586876710256, "vf_loss": 6.1610668182373045, "vf_explained_var": -7.947285970052084e-07, "kl": 0.00040416283563142014, "entropy": 0.40777801275253295, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6080000000002161, "episode_len_mean": 286.62, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.100000000000016, 45.9, 2.499999999999595, -50.00000000000044, 44.900000000000006, 46.5, 46.099999999999994, 47.9, 42.70000000000001, 38.700000000000024, -50.00000000000044, 45.1, 47.7, 24.899999999999913, 46.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.7, 36.30000000000003, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 3.499999999999609, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, 33.70000000000004, 34.70000000000004, 25.699999999999925, -50.00000000000044, 13.899999999999757, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.300000000000026, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.3, 20.49999999999985, 45.3, -50.00000000000044, 36.70000000000003, 36.30000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 47.7, -50.00000000000044, 25.899999999999928, -50.00000000000044, 46.5, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 44.7, 46.699999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 180, 42, 476, 500, 52, 36, 40, 22, 74, 114, 500, 50, 24, 252, 36, 28, 500, 500, 500, 46, 74, 318, 500, 500, 500, 500, 500, 500, 42, 500, 44, 138, 36, 500, 500, 500, 38, 500, 500, 466, 74, 500, 500, 58, 96, 500, 500, 28, 40, 164, 154, 244, 500, 362, 58, 500, 500, 34, 108, 26, 500, 500, 500, 32, 28, 296, 48, 500, 134, 138, 500, 500, 40, 500, 32, 500, 52, 50, 500, 24, 500, 242, 500, 36, 88, 500, 500, 500, 500, 500, 500, 500, 202, 54, 34, 58, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4068349013800577, "mean_inference_ms": 1.2944552132151, "mean_action_processing_ms": 0.15359989895154164, "mean_env_wait_ms": 0.09043475598853778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030001401901245117, "StateBufferConnector_ms": 0.00799703598022461, "ViewRequirementAgentConnector_ms": 0.1289992332458496}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6080000000002161, "episode_len_mean": 286.62, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.100000000000016, 45.9, 2.499999999999595, -50.00000000000044, 44.900000000000006, 46.5, 46.099999999999994, 47.9, 42.70000000000001, 38.700000000000024, -50.00000000000044, 45.1, 47.7, 24.899999999999913, 46.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.7, 36.30000000000003, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 3.499999999999609, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, 33.70000000000004, 34.70000000000004, 25.699999999999925, -50.00000000000044, 13.899999999999757, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.300000000000026, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.3, 20.49999999999985, 45.3, -50.00000000000044, 36.70000000000003, 36.30000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 47.7, -50.00000000000044, 25.899999999999928, -50.00000000000044, 46.5, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 44.7, 46.699999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 180, 42, 476, 500, 52, 36, 40, 22, 74, 114, 500, 50, 24, 252, 36, 28, 500, 500, 500, 46, 74, 318, 500, 500, 500, 500, 500, 500, 42, 500, 44, 138, 36, 500, 500, 500, 38, 500, 500, 466, 74, 500, 500, 58, 96, 500, 500, 28, 40, 164, 154, 244, 500, 362, 58, 500, 500, 34, 108, 26, 500, 500, 500, 32, 28, 296, 48, 500, 134, 138, 500, 500, 40, 500, 32, 500, 52, 50, 500, 24, 500, 242, 500, 36, 88, 500, 500, 500, 500, 500, 500, 500, 202, 54, 34, 58, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4068349013800577, "mean_inference_ms": 1.2944552132151, "mean_action_processing_ms": 0.15359989895154164, "mean_env_wait_ms": 0.09043475598853778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030001401901245117, "StateBufferConnector_ms": 0.00799703598022461, "ViewRequirementAgentConnector_ms": 0.1289992332458496}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5733.388725038847, "num_env_steps_trained_throughput_per_sec": 5733.388725038847, "timesteps_total": 1140000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 2276.609, "sample_time_ms": 2029.5, "load_time_ms": 11.8, "load_throughput": 1016977.657, "learn_time_ms": 224.508, "learn_throughput": 53450.166, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 4379, "training_iteration": 95, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-49", "timestamp": 1698245209, "time_this_iter_s": 2.0970001220703125, "time_total_s": 219.37179040908813, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 219.37179040908813, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 58.166666666666664, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.048709793414477e-30, "cur_lr": 0.0003, "total_loss": 6.151641368865967, "policy_loss": -0.0002817325294017792, "vf_loss": 6.151963583628336, "vf_explained_var": -1.5497207641601562e-06, "kl": 0.00038632020661376977, "entropy": 0.4063276767730713, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1433.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.0780000000002223, "episode_len_mean": 291.3, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.300000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, 33.70000000000004, 34.70000000000004, 25.699999999999925, -50.00000000000044, 13.899999999999757, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.300000000000026, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.3, 20.49999999999985, 45.3, -50.00000000000044, 36.70000000000003, 36.30000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 47.7, -50.00000000000044, 25.899999999999928, -50.00000000000044, 46.5, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 44.7, 46.699999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.5, -50.00000000000044, 46.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 47.7, -50.00000000000044, 46.9, 46.9, 11.499999999999723, 18.499999999999822, 42.900000000000006, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 21.299999999999862, 40.30000000000002, 45.5, 25.29999999999992, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5], "episode_lengths": [500, 500, 58, 96, 500, 500, 28, 40, 164, 154, 244, 500, 362, 58, 500, 500, 34, 108, 26, 500, 500, 500, 32, 28, 296, 48, 500, 134, 138, 500, 500, 40, 500, 32, 500, 52, 50, 500, 24, 500, 242, 500, 36, 88, 500, 500, 500, 500, 500, 500, 500, 202, 54, 34, 58, 500, 500, 500, 500, 90, 36, 500, 36, 500, 42, 500, 500, 500, 500, 500, 86, 62, 500, 52, 500, 500, 500, 82, 24, 500, 32, 32, 386, 316, 72, 32, 500, 34, 500, 288, 98, 46, 248, 50, 500, 500, 500, 500, 500, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4066416239481611, "mean_inference_ms": 1.2942340401429906, "mean_action_processing_ms": 0.1534976717010959, "mean_env_wait_ms": 0.09043246592769318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023992300033569336, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.13100981712341309}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.0780000000002223, "episode_len_mean": 291.3, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.300000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, 33.70000000000004, 34.70000000000004, 25.699999999999925, -50.00000000000044, 13.899999999999757, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.300000000000026, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.3, 20.49999999999985, 45.3, -50.00000000000044, 36.70000000000003, 36.30000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 47.7, -50.00000000000044, 25.899999999999928, -50.00000000000044, 46.5, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 44.7, 46.699999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.5, -50.00000000000044, 46.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 47.7, -50.00000000000044, 46.9, 46.9, 11.499999999999723, 18.499999999999822, 42.900000000000006, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 21.299999999999862, 40.30000000000002, 45.5, 25.29999999999992, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5], "episode_lengths": [500, 500, 58, 96, 500, 500, 28, 40, 164, 154, 244, 500, 362, 58, 500, 500, 34, 108, 26, 500, 500, 500, 32, 28, 296, 48, 500, 134, 138, 500, 500, 40, 500, 32, 500, 52, 50, 500, 24, 500, 242, 500, 36, 88, 500, 500, 500, 500, 500, 500, 500, 202, 54, 34, 58, 500, 500, 500, 500, 90, 36, 500, 36, 500, 42, 500, 500, 500, 500, 500, 86, 62, 500, 52, 500, 500, 500, 82, 24, 500, 32, 32, 386, 316, 72, 32, 500, 34, 500, 288, 98, 46, 248, 50, 500, 500, 500, 500, 500, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4066416239481611, "mean_inference_ms": 1.2942340401429906, "mean_action_processing_ms": 0.1534976717010959, "mean_env_wait_ms": 0.09043246592769318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023992300033569336, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.13100981712341309}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5444.642573568959, "num_env_steps_trained_throughput_per_sec": 5444.642573568959, "timesteps_total": 1152000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 2278.109, "sample_time_ms": 2019.0, "load_time_ms": 12.1, "load_throughput": 991766.382, "learn_time_ms": 236.108, "learn_throughput": 50824.134, "synch_weights_time_ms": 10.002}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4421, "training_iteration": 96, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-52", "timestamp": 1698245212, "time_this_iter_s": 2.209001302719116, "time_total_s": 221.58079171180725, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 221.58079171180725, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 62.5, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5243548967072386e-30, "cur_lr": 0.0003, "total_loss": 6.569527085622152, "policy_loss": -0.00039643595616022743, "vf_loss": 6.569967142740885, "vf_explained_var": -8.742014567057291e-07, "kl": 0.0006864749243050028, "entropy": 0.4363179326057434, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1448.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.160999999999815, "episode_len_mean": 254.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 46.699999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.5, -50.00000000000044, 46.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 47.7, -50.00000000000044, 46.9, 46.9, 11.499999999999723, 18.499999999999822, 42.900000000000006, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 21.299999999999862, 40.30000000000002, 45.5, 25.29999999999992, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 46.9, 44.5, 18.499999999999822, 38.50000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.10000000000001, 19.899999999999842, 44.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.90000000000002, -50.00000000000044, 45.9, 40.500000000000014, 44.7, -50.00000000000044, 19.499999999999837, 44.10000000000001, 43.7, 24.099999999999902, -50.00000000000044, 45.5, 45.1, -50.00000000000044, 47.1, 44.10000000000001, 35.30000000000004, 45.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, 25.699999999999925, 44.5, -50.00000000000044, 46.099999999999994, 46.5, 43.7, 47.7, -50.00000000000044, 24.099999999999902, -50.00000000000044, 43.30000000000001, 44.300000000000004, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006], "episode_lengths": [54, 34, 58, 500, 500, 500, 500, 90, 36, 500, 36, 500, 42, 500, 500, 500, 500, 500, 86, 62, 500, 52, 500, 500, 500, 82, 24, 500, 32, 32, 386, 316, 72, 32, 500, 34, 500, 288, 98, 46, 248, 50, 500, 500, 500, 500, 500, 26, 500, 32, 56, 316, 116, 500, 102, 500, 70, 302, 56, 66, 500, 500, 68, 102, 500, 42, 96, 54, 500, 306, 60, 64, 260, 500, 46, 50, 500, 30, 60, 148, 42, 96, 500, 500, 244, 56, 500, 40, 36, 64, 24, 500, 260, 500, 68, 58, 500, 42, 500, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40660426242356174, "mean_inference_ms": 1.2924363975807975, "mean_action_processing_ms": 0.15287779666703125, "mean_env_wait_ms": 0.09056473120754432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199554443359375, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.0999913215637207}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.160999999999815, "episode_len_mean": 254.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 46.699999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.5, -50.00000000000044, 46.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 47.7, -50.00000000000044, 46.9, 46.9, 11.499999999999723, 18.499999999999822, 42.900000000000006, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 21.299999999999862, 40.30000000000002, 45.5, 25.29999999999992, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 46.9, 44.5, 18.499999999999822, 38.50000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.10000000000001, 19.899999999999842, 44.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.90000000000002, -50.00000000000044, 45.9, 40.500000000000014, 44.7, -50.00000000000044, 19.499999999999837, 44.10000000000001, 43.7, 24.099999999999902, -50.00000000000044, 45.5, 45.1, -50.00000000000044, 47.1, 44.10000000000001, 35.30000000000004, 45.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, 25.699999999999925, 44.5, -50.00000000000044, 46.099999999999994, 46.5, 43.7, 47.7, -50.00000000000044, 24.099999999999902, -50.00000000000044, 43.30000000000001, 44.300000000000004, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006], "episode_lengths": [54, 34, 58, 500, 500, 500, 500, 90, 36, 500, 36, 500, 42, 500, 500, 500, 500, 500, 86, 62, 500, 52, 500, 500, 500, 82, 24, 500, 32, 32, 386, 316, 72, 32, 500, 34, 500, 288, 98, 46, 248, 50, 500, 500, 500, 500, 500, 26, 500, 32, 56, 316, 116, 500, 102, 500, 70, 302, 56, 66, 500, 500, 68, 102, 500, 42, 96, 54, 500, 306, 60, 64, 260, 500, 46, 50, 500, 30, 60, 148, 42, 96, 500, 500, 244, 56, 500, 40, 36, 64, 24, 500, 260, 500, 68, 58, 500, 42, 500, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40660426242356174, "mean_inference_ms": 1.2924363975807975, "mean_action_processing_ms": 0.15287779666703125, "mean_env_wait_ms": 0.09056473120754432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199554443359375, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.0999913215637207}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5279.365364070758, "num_env_steps_trained_throughput_per_sec": 5279.365364070758, "timesteps_total": 1164000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 2252.109, "sample_time_ms": 1996.5, "load_time_ms": 12.4, "load_throughput": 967752.534, "learn_time_ms": 232.408, "learn_throughput": 51633.308, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 4473, "training_iteration": 97, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-54", "timestamp": 1698245214, "time_this_iter_s": 2.277998924255371, "time_total_s": 223.85879063606262, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 223.85879063606262, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 59.633333333333326, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2621774483536193e-30, "cur_lr": 0.0003, "total_loss": 6.839720344543457, "policy_loss": -0.00042326441034674646, "vf_loss": 6.840185928344726, "vf_explained_var": -9.775161743164062e-07, "kl": 0.0004595054304597094, "entropy": 0.4241821785767873, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1463.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.434999999999835, "episode_len_mean": 241.3, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.499999999999822, 38.50000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.10000000000001, 19.899999999999842, 44.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.90000000000002, -50.00000000000044, 45.9, 40.500000000000014, 44.7, -50.00000000000044, 19.499999999999837, 44.10000000000001, 43.7, 24.099999999999902, -50.00000000000044, 45.5, 45.1, -50.00000000000044, 47.1, 44.10000000000001, 35.30000000000004, 45.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, 25.699999999999925, 44.5, -50.00000000000044, 46.099999999999994, 46.5, 43.7, 47.7, -50.00000000000044, 24.099999999999902, -50.00000000000044, 43.30000000000001, 44.300000000000004, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 6.099999999999646, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.9, -50.00000000000044, 46.099999999999994, 47.1, 45.1, 26.89999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.3, -50.00000000000044, 45.5, 38.90000000000002, -50.00000000000044, 25.29999999999992, 44.7, 45.5, 46.5, 40.70000000000002, 34.70000000000004, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.7, 35.10000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 41.100000000000016, 21.09999999999986, -50.00000000000044, 29.49999999999998], "episode_lengths": [316, 116, 500, 102, 500, 70, 302, 56, 66, 500, 500, 68, 102, 500, 42, 96, 54, 500, 306, 60, 64, 260, 500, 46, 50, 500, 30, 60, 148, 42, 96, 500, 500, 244, 56, 500, 40, 36, 64, 24, 500, 260, 500, 68, 58, 500, 42, 500, 52, 500, 500, 440, 36, 500, 500, 500, 64, 42, 500, 40, 30, 50, 232, 142, 500, 500, 500, 86, 38, 500, 46, 112, 500, 248, 54, 46, 36, 94, 154, 500, 46, 500, 52, 500, 44, 150, 58, 500, 500, 500, 50, 58, 500, 50, 50, 500, 90, 290, 500, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40688179672117, "mean_inference_ms": 1.2914423649281646, "mean_action_processing_ms": 0.1526820572461926, "mean_env_wait_ms": 0.09052086820215517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199840545654297, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.10400247573852539}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.434999999999835, "episode_len_mean": 241.3, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.499999999999822, 38.50000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.10000000000001, 19.899999999999842, 44.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.90000000000002, -50.00000000000044, 45.9, 40.500000000000014, 44.7, -50.00000000000044, 19.499999999999837, 44.10000000000001, 43.7, 24.099999999999902, -50.00000000000044, 45.5, 45.1, -50.00000000000044, 47.1, 44.10000000000001, 35.30000000000004, 45.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, 25.699999999999925, 44.5, -50.00000000000044, 46.099999999999994, 46.5, 43.7, 47.7, -50.00000000000044, 24.099999999999902, -50.00000000000044, 43.30000000000001, 44.300000000000004, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 6.099999999999646, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.9, -50.00000000000044, 46.099999999999994, 47.1, 45.1, 26.89999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.3, -50.00000000000044, 45.5, 38.90000000000002, -50.00000000000044, 25.29999999999992, 44.7, 45.5, 46.5, 40.70000000000002, 34.70000000000004, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.7, 35.10000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 41.100000000000016, 21.09999999999986, -50.00000000000044, 29.49999999999998], "episode_lengths": [316, 116, 500, 102, 500, 70, 302, 56, 66, 500, 500, 68, 102, 500, 42, 96, 54, 500, 306, 60, 64, 260, 500, 46, 50, 500, 30, 60, 148, 42, 96, 500, 500, 244, 56, 500, 40, 36, 64, 24, 500, 260, 500, 68, 58, 500, 42, 500, 52, 500, 500, 440, 36, 500, 500, 500, 64, 42, 500, 40, 30, 50, 232, 142, 500, 500, 500, 86, 38, 500, 46, 112, 500, 248, 54, 46, 36, 94, 154, 500, 46, 500, 52, 500, 44, 150, 58, 500, 500, 500, 50, 58, 500, 50, 50, 500, 90, 290, 500, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40688179672117, "mean_inference_ms": 1.2914423649281646, "mean_action_processing_ms": 0.1526820572461926, "mean_env_wait_ms": 0.09052086820215517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199840545654297, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.10400247573852539}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5755.390971273043, "num_env_steps_trained_throughput_per_sec": 5755.390971273043, "timesteps_total": 1176000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 2250.21, "sample_time_ms": 1991.5, "load_time_ms": 12.3, "load_throughput": 975629.409, "learn_time_ms": 235.508, "learn_throughput": 50953.639, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 4524, "training_iteration": 98, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-56", "timestamp": 1698245216, "time_this_iter_s": 2.0910019874572754, "time_total_s": 225.9497926235199, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 225.9497926235199, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 57.333333333333336, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.3108872417680965e-31, "cur_lr": 0.0003, "total_loss": 6.9099779764811196, "policy_loss": -0.00020484626293182373, "vf_loss": 6.910227839152018, "vf_explained_var": -1.3510386149088542e-06, "kl": 0.000670898866413457, "entropy": 0.45022515455881756, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1478.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.189999999999861, "episode_len_mean": 218.8, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, 45.9, -50.00000000000044, 46.099999999999994, 47.1, 45.1, 26.89999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.3, -50.00000000000044, 45.5, 38.90000000000002, -50.00000000000044, 25.29999999999992, 44.7, 45.5, 46.5, 40.70000000000002, 34.70000000000004, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.7, 35.10000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 41.100000000000016, 21.09999999999986, -50.00000000000044, 29.49999999999998, 26.499999999999936, 34.900000000000034, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, 45.7, -50.00000000000044, 39.70000000000002, -50.00000000000044, 44.900000000000006, 36.70000000000003, 29.49999999999998, 47.3, 46.099999999999994, 37.300000000000026, 46.5, 38.10000000000002, 47.3, 41.100000000000016, 40.30000000000002, 46.9, 40.90000000000002, 34.50000000000004, -50.00000000000044, -50.00000000000044, 45.7, 19.09999999999983, 44.300000000000004, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 43.10000000000001, 40.70000000000002, 43.900000000000006, -50.00000000000044, 20.49999999999985, -50.00000000000044, 40.500000000000014, 39.10000000000002, 46.3, 44.7, 26.09999999999993, -50.00000000000044, 43.7, 8.899999999999686, 40.90000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9], "episode_lengths": [64, 42, 500, 40, 30, 50, 232, 142, 500, 500, 500, 86, 38, 500, 46, 112, 500, 248, 54, 46, 36, 94, 154, 500, 46, 500, 52, 500, 44, 150, 58, 500, 500, 500, 50, 58, 500, 50, 50, 500, 90, 290, 500, 206, 236, 152, 58, 58, 500, 500, 72, 38, 44, 500, 104, 500, 52, 134, 206, 28, 40, 128, 36, 120, 28, 90, 98, 32, 92, 156, 500, 500, 44, 310, 58, 500, 500, 26, 500, 70, 94, 62, 500, 296, 500, 96, 110, 38, 54, 240, 500, 64, 412, 92, 500, 78, 500, 500, 34, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40686354810030656, "mean_inference_ms": 1.2907596838876167, "mean_action_processing_ms": 0.15269269315590756, "mean_env_wait_ms": 0.09053687937855182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100205421447754, "StateBufferConnector_ms": 0.005002260208129883, "ViewRequirementAgentConnector_ms": 0.12798786163330078}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.189999999999861, "episode_len_mean": 218.8, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, 45.9, -50.00000000000044, 46.099999999999994, 47.1, 45.1, 26.89999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.3, -50.00000000000044, 45.5, 38.90000000000002, -50.00000000000044, 25.29999999999992, 44.7, 45.5, 46.5, 40.70000000000002, 34.70000000000004, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.7, 35.10000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 41.100000000000016, 21.09999999999986, -50.00000000000044, 29.49999999999998, 26.499999999999936, 34.900000000000034, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, 45.7, -50.00000000000044, 39.70000000000002, -50.00000000000044, 44.900000000000006, 36.70000000000003, 29.49999999999998, 47.3, 46.099999999999994, 37.300000000000026, 46.5, 38.10000000000002, 47.3, 41.100000000000016, 40.30000000000002, 46.9, 40.90000000000002, 34.50000000000004, -50.00000000000044, -50.00000000000044, 45.7, 19.09999999999983, 44.300000000000004, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 43.10000000000001, 40.70000000000002, 43.900000000000006, -50.00000000000044, 20.49999999999985, -50.00000000000044, 40.500000000000014, 39.10000000000002, 46.3, 44.7, 26.09999999999993, -50.00000000000044, 43.7, 8.899999999999686, 40.90000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9], "episode_lengths": [64, 42, 500, 40, 30, 50, 232, 142, 500, 500, 500, 86, 38, 500, 46, 112, 500, 248, 54, 46, 36, 94, 154, 500, 46, 500, 52, 500, 44, 150, 58, 500, 500, 500, 50, 58, 500, 50, 50, 500, 90, 290, 500, 206, 236, 152, 58, 58, 500, 500, 72, 38, 44, 500, 104, 500, 52, 134, 206, 28, 40, 128, 36, 120, 28, 90, 98, 32, 92, 156, 500, 500, 44, 310, 58, 500, 500, 26, 500, 70, 94, 62, 500, 296, 500, 96, 110, 38, 54, 240, 500, 64, 412, 92, 500, 78, 500, 500, 34, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40686354810030656, "mean_inference_ms": 1.2907596838876167, "mean_action_processing_ms": 0.15269269315590756, "mean_env_wait_ms": 0.09053687937855182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100205421447754, "StateBufferConnector_ms": 0.005002260208129883, "ViewRequirementAgentConnector_ms": 0.12798786163330078}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5018.815504590824, "num_env_steps_trained_throughput_per_sec": 5018.815504590824, "timesteps_total": 1188000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 2267.71, "sample_time_ms": 2005.2, "load_time_ms": 12.0, "load_throughput": 1000018.835, "learn_time_ms": 239.608, "learn_throughput": 50081.74, "synch_weights_time_ms": 9.901}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4580, "training_iteration": 99, "trial_id": "9f288_00003", "date": "2023-10-25_15-46-58", "timestamp": 1698245218, "time_this_iter_s": 2.396000385284424, "time_total_s": 228.34579300880432, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 228.34579300880432, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 60.85000000000001, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.1554436208840483e-31, "cur_lr": 0.0003, "total_loss": 5.8754477818806965, "policy_loss": -0.00010826786359151205, "vf_loss": 5.8756002426147464, "vf_explained_var": -9.139378865559896e-07, "kl": 0.000525068991369911, "entropy": 0.44342960715293883, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1493.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.980999999999835, "episode_len_mean": 245.84, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 41.100000000000016, 21.09999999999986, -50.00000000000044, 29.49999999999998, 26.499999999999936, 34.900000000000034, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, 45.7, -50.00000000000044, 39.70000000000002, -50.00000000000044, 44.900000000000006, 36.70000000000003, 29.49999999999998, 47.3, 46.099999999999994, 37.300000000000026, 46.5, 38.10000000000002, 47.3, 41.100000000000016, 40.30000000000002, 46.9, 40.90000000000002, 34.50000000000004, -50.00000000000044, -50.00000000000044, 45.7, 19.09999999999983, 44.300000000000004, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 43.10000000000001, 40.70000000000002, 43.900000000000006, -50.00000000000044, 20.49999999999985, -50.00000000000044, 40.500000000000014, 39.10000000000002, 46.3, 44.7, 26.09999999999993, -50.00000000000044, 43.7, 8.899999999999686, 40.90000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 32.700000000000024, -50.00000000000044, 47.5, 46.699999999999996, 45.9, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.9, 34.900000000000034, -50.00000000000044, 38.10000000000002, 13.099999999999746, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 44.7, -50.00000000000044, 41.90000000000001, -50.00000000000044], "episode_lengths": [58, 500, 50, 50, 500, 90, 290, 500, 206, 236, 152, 58, 58, 500, 500, 72, 38, 44, 500, 104, 500, 52, 134, 206, 28, 40, 128, 36, 120, 28, 90, 98, 32, 92, 156, 500, 500, 44, 310, 58, 500, 500, 26, 500, 70, 94, 62, 500, 296, 500, 96, 110, 38, 54, 240, 500, 64, 412, 92, 500, 78, 500, 500, 34, 42, 174, 500, 26, 34, 42, 66, 500, 50, 500, 500, 500, 28, 500, 500, 60, 74, 500, 500, 398, 42, 152, 500, 120, 370, 500, 500, 70, 500, 500, 500, 276, 54, 500, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40611985704748327, "mean_inference_ms": 1.2907159459874142, "mean_action_processing_ms": 0.15247897768681923, "mean_env_wait_ms": 0.0904780439232385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021000146865844727, "StateBufferConnector_ms": 0.0040035247802734375, "ViewRequirementAgentConnector_ms": 0.13798213005065918}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.980999999999835, "episode_len_mean": 245.84, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 41.100000000000016, 21.09999999999986, -50.00000000000044, 29.49999999999998, 26.499999999999936, 34.900000000000034, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, 45.7, -50.00000000000044, 39.70000000000002, -50.00000000000044, 44.900000000000006, 36.70000000000003, 29.49999999999998, 47.3, 46.099999999999994, 37.300000000000026, 46.5, 38.10000000000002, 47.3, 41.100000000000016, 40.30000000000002, 46.9, 40.90000000000002, 34.50000000000004, -50.00000000000044, -50.00000000000044, 45.7, 19.09999999999983, 44.300000000000004, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 43.10000000000001, 40.70000000000002, 43.900000000000006, -50.00000000000044, 20.49999999999985, -50.00000000000044, 40.500000000000014, 39.10000000000002, 46.3, 44.7, 26.09999999999993, -50.00000000000044, 43.7, 8.899999999999686, 40.90000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 32.700000000000024, -50.00000000000044, 47.5, 46.699999999999996, 45.9, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.9, 34.900000000000034, -50.00000000000044, 38.10000000000002, 13.099999999999746, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 44.7, -50.00000000000044, 41.90000000000001, -50.00000000000044], "episode_lengths": [58, 500, 50, 50, 500, 90, 290, 500, 206, 236, 152, 58, 58, 500, 500, 72, 38, 44, 500, 104, 500, 52, 134, 206, 28, 40, 128, 36, 120, 28, 90, 98, 32, 92, 156, 500, 500, 44, 310, 58, 500, 500, 26, 500, 70, 94, 62, 500, 296, 500, 96, 110, 38, 54, 240, 500, 64, 412, 92, 500, 78, 500, 500, 34, 42, 174, 500, 26, 34, 42, 66, 500, 50, 500, 500, 500, 28, 500, 500, 60, 74, 500, 500, 398, 42, 152, 500, 120, 370, 500, 500, 70, 500, 500, 500, 276, 54, 500, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40611985704748327, "mean_inference_ms": 1.2907159459874142, "mean_action_processing_ms": 0.15247897768681923, "mean_env_wait_ms": 0.0904780439232385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021000146865844727, "StateBufferConnector_ms": 0.0040035247802734375, "ViewRequirementAgentConnector_ms": 0.13798213005065918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5512.161732678656, "num_env_steps_trained_throughput_per_sec": 5512.161732678656, "timesteps_total": 1200000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 2261.302, "sample_time_ms": 2003.1, "load_time_ms": 9.9, "load_throughput": 1212127.331, "learn_time_ms": 237.1, "learn_throughput": 50611.57, "synch_weights_time_ms": 10.002}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "episodes_total": 4615, "training_iteration": 100, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-01", "timestamp": 1698245221, "time_this_iter_s": 2.182999610900879, "time_total_s": 230.5287926197052, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 230.5287926197052, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 61.0, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5777218104420241e-31, "cur_lr": 0.0003, "total_loss": 6.482019138336182, "policy_loss": -0.00017308567961057028, "vf_loss": 6.482238260904948, "vf_explained_var": -9.775161743164062e-07, "kl": 0.00032408159771269617, "entropy": 0.4614958246548971, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1508.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.480999999999824, "episode_len_mean": 250.82, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, 8.899999999999686, 40.90000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 32.700000000000024, -50.00000000000044, 47.5, 46.699999999999996, 45.9, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.9, 34.900000000000034, -50.00000000000044, 38.10000000000002, 13.099999999999746, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 44.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.1, 43.7, 46.099999999999994, 46.3, 31.70000000000001, -50.00000000000044, 47.5, 40.90000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 47.1, 45.3, 39.70000000000002, 40.90000000000002, 46.699999999999996, 37.70000000000003, 29.299999999999976, 46.699999999999996, 43.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.5, 13.099999999999746, 41.70000000000002, 45.1, 17.899999999999814, 32.90000000000003, -50.00000000000044, 22.299999999999876, 38.700000000000024, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.5, 41.70000000000002, 44.7, 18.29999999999982], "episode_lengths": [64, 412, 92, 500, 78, 500, 500, 34, 42, 174, 500, 26, 34, 42, 66, 500, 50, 500, 500, 500, 28, 500, 500, 60, 74, 500, 500, 398, 42, 152, 500, 120, 370, 500, 500, 70, 500, 500, 500, 276, 54, 500, 82, 500, 500, 500, 500, 30, 50, 64, 40, 38, 184, 500, 26, 92, 90, 500, 500, 56, 500, 500, 44, 30, 48, 104, 92, 34, 124, 208, 34, 62, 56, 500, 500, 40, 44, 500, 36, 500, 500, 86, 36, 370, 84, 50, 322, 172, 500, 278, 114, 50, 500, 500, 500, 62, 36, 84, 54, 318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40532618569089635, "mean_inference_ms": 1.2917156440696191, "mean_action_processing_ms": 0.1527914972624703, "mean_env_wait_ms": 0.09018731297087439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023999452590942383, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.14699387550354004}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.480999999999824, "episode_len_mean": 250.82, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, 8.899999999999686, 40.90000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 32.700000000000024, -50.00000000000044, 47.5, 46.699999999999996, 45.9, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.9, 34.900000000000034, -50.00000000000044, 38.10000000000002, 13.099999999999746, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 44.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.1, 43.7, 46.099999999999994, 46.3, 31.70000000000001, -50.00000000000044, 47.5, 40.90000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 47.1, 45.3, 39.70000000000002, 40.90000000000002, 46.699999999999996, 37.70000000000003, 29.299999999999976, 46.699999999999996, 43.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.5, 13.099999999999746, 41.70000000000002, 45.1, 17.899999999999814, 32.90000000000003, -50.00000000000044, 22.299999999999876, 38.700000000000024, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.5, 41.70000000000002, 44.7, 18.29999999999982], "episode_lengths": [64, 412, 92, 500, 78, 500, 500, 34, 42, 174, 500, 26, 34, 42, 66, 500, 50, 500, 500, 500, 28, 500, 500, 60, 74, 500, 500, 398, 42, 152, 500, 120, 370, 500, 500, 70, 500, 500, 500, 276, 54, 500, 82, 500, 500, 500, 500, 30, 50, 64, 40, 38, 184, 500, 26, 92, 90, 500, 500, 56, 500, 500, 44, 30, 48, 104, 92, 34, 124, 208, 34, 62, 56, 500, 500, 40, 44, 500, 36, 500, 500, 86, 36, 370, 84, 50, 322, 172, 500, 278, 114, 50, 500, 500, 500, 62, 36, 84, 54, 318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40532618569089635, "mean_inference_ms": 1.2917156440696191, "mean_action_processing_ms": 0.1527914972624703, "mean_env_wait_ms": 0.09018731297087439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023999452590942383, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.14699387550354004}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4958.679972268556, "num_env_steps_trained_throughput_per_sec": 4958.679972268556, "timesteps_total": 1212000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 2291.302, "sample_time_ms": 2022.4, "load_time_ms": 10.6, "load_throughput": 1132076.042, "learn_time_ms": 247.2, "learn_throughput": 48543.701, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "episodes_total": 4671, "training_iteration": 101, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-03", "timestamp": 1698245223, "time_this_iter_s": 2.424999237060547, "time_total_s": 232.95379185676575, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 232.95379185676575, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 70.13333333333334, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.888609052210121e-32, "cur_lr": 0.0003, "total_loss": 6.548598384857177, "policy_loss": -3.250191609064738e-05, "vf_loss": 6.548676554361979, "vf_explained_var": -5.7220458984375e-07, "kl": 0.0006764196265748978, "entropy": 0.45729224880536395, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1523.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.587999999999818, "episode_len_mean": 254.74, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.1, 43.7, 46.099999999999994, 46.3, 31.70000000000001, -50.00000000000044, 47.5, 40.90000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 47.1, 45.3, 39.70000000000002, 40.90000000000002, 46.699999999999996, 37.70000000000003, 29.299999999999976, 46.699999999999996, 43.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.5, 13.099999999999746, 41.70000000000002, 45.1, 17.899999999999814, 32.90000000000003, -50.00000000000044, 22.299999999999876, 38.700000000000024, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.5, 41.70000000000002, 44.7, 18.29999999999982, -50.00000000000044, 46.9, 45.1, -50.00000000000044, 44.7, 2.8999999999996007, -50.00000000000044, 4.299999999999621, -50.00000000000044, -50.00000000000044, 46.699999999999996, 18.899999999999828, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.3, -50.00000000000044, 27.49999999999995, 46.099999999999994, -50.00000000000044, 43.50000000000001, -50.00000000000044, 29.099999999999973, 33.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 44.10000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 40.500000000000014], "episode_lengths": [500, 500, 500, 500, 30, 50, 64, 40, 38, 184, 500, 26, 92, 90, 500, 500, 56, 500, 500, 44, 30, 48, 104, 92, 34, 124, 208, 34, 62, 56, 500, 500, 40, 44, 500, 36, 500, 500, 86, 36, 370, 84, 50, 322, 172, 500, 278, 114, 50, 500, 500, 500, 62, 36, 84, 54, 318, 500, 32, 50, 500, 54, 472, 500, 458, 500, 500, 34, 312, 500, 500, 62, 500, 500, 30, 500, 48, 500, 226, 40, 500, 66, 500, 210, 168, 500, 40, 500, 28, 60, 500, 116, 500, 52, 500, 500, 40, 38, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40556321913189836, "mean_inference_ms": 1.2918536459875989, "mean_action_processing_ms": 0.15276619180104892, "mean_env_wait_ms": 0.09023970441098958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04100799560546875, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.1619892120361328}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.587999999999818, "episode_len_mean": 254.74, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.1, 43.7, 46.099999999999994, 46.3, 31.70000000000001, -50.00000000000044, 47.5, 40.90000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 47.1, 45.3, 39.70000000000002, 40.90000000000002, 46.699999999999996, 37.70000000000003, 29.299999999999976, 46.699999999999996, 43.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.5, 13.099999999999746, 41.70000000000002, 45.1, 17.899999999999814, 32.90000000000003, -50.00000000000044, 22.299999999999876, 38.700000000000024, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.5, 41.70000000000002, 44.7, 18.29999999999982, -50.00000000000044, 46.9, 45.1, -50.00000000000044, 44.7, 2.8999999999996007, -50.00000000000044, 4.299999999999621, -50.00000000000044, -50.00000000000044, 46.699999999999996, 18.899999999999828, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.3, -50.00000000000044, 27.49999999999995, 46.099999999999994, -50.00000000000044, 43.50000000000001, -50.00000000000044, 29.099999999999973, 33.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 44.10000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 40.500000000000014], "episode_lengths": [500, 500, 500, 500, 30, 50, 64, 40, 38, 184, 500, 26, 92, 90, 500, 500, 56, 500, 500, 44, 30, 48, 104, 92, 34, 124, 208, 34, 62, 56, 500, 500, 40, 44, 500, 36, 500, 500, 86, 36, 370, 84, 50, 322, 172, 500, 278, 114, 50, 500, 500, 500, 62, 36, 84, 54, 318, 500, 32, 50, 500, 54, 472, 500, 458, 500, 500, 34, 312, 500, 500, 62, 500, 500, 30, 500, 48, 500, 226, 40, 500, 66, 500, 210, 168, 500, 40, 500, 28, 60, 500, 116, 500, 52, 500, 500, 40, 38, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40556321913189836, "mean_inference_ms": 1.2918536459875989, "mean_action_processing_ms": 0.15276619180104892, "mean_env_wait_ms": 0.09023970441098958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04100799560546875, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.1619892120361328}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5298.010768935874, "num_env_steps_trained_throughput_per_sec": 5298.010768935874, "timesteps_total": 1224000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 2284.402, "sample_time_ms": 2022.3, "load_time_ms": 10.8, "load_throughput": 1111110.699, "learn_time_ms": 240.5, "learn_throughput": 49896.05, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4714, "training_iteration": 102, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-05", "timestamp": 1698245225, "time_this_iter_s": 2.273998498916626, "time_total_s": 235.22779035568237, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 235.22779035568237, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 59.0, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.9443045261050603e-32, "cur_lr": 0.0003, "total_loss": 6.507884534200032, "policy_loss": -0.000256879689792792, "vf_loss": 6.508186276753744, "vf_explained_var": -7.788340250651042e-07, "kl": 0.0002011885478471716, "entropy": 0.45088011026382446, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1538.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.9280000000002108, "episode_len_mean": 289.84, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, 45.1, 17.899999999999814, 32.90000000000003, -50.00000000000044, 22.299999999999876, 38.700000000000024, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.5, 41.70000000000002, 44.7, 18.29999999999982, -50.00000000000044, 46.9, 45.1, -50.00000000000044, 44.7, 2.8999999999996007, -50.00000000000044, 4.299999999999621, -50.00000000000044, -50.00000000000044, 46.699999999999996, 18.899999999999828, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.3, -50.00000000000044, 27.49999999999995, 46.099999999999994, -50.00000000000044, 43.50000000000001, -50.00000000000044, 29.099999999999973, 33.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 44.10000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 40.500000000000014, 30.29999999999999, 40.70000000000002, 25.499999999999922, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 36.50000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.500000000000014, 46.699999999999996, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, 42.500000000000014, 38.300000000000026, 19.69999999999984, -50.00000000000044, 39.70000000000002], "episode_lengths": [84, 50, 322, 172, 500, 278, 114, 50, 500, 500, 500, 62, 36, 84, 54, 318, 500, 32, 50, 500, 54, 472, 500, 458, 500, 500, 34, 312, 500, 500, 62, 500, 500, 30, 500, 48, 500, 226, 40, 500, 66, 500, 210, 168, 500, 40, 500, 28, 60, 500, 116, 500, 52, 500, 500, 40, 38, 500, 96, 198, 94, 246, 500, 50, 500, 500, 32, 500, 500, 500, 54, 136, 68, 500, 500, 44, 500, 500, 500, 68, 36, 500, 500, 106, 500, 500, 176, 76, 34, 226, 500, 500, 500, 500, 382, 76, 118, 304, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.405716609716923, "mean_inference_ms": 1.291105964801847, "mean_action_processing_ms": 0.1532751930080636, "mean_env_wait_ms": 0.09035725711329685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041010141372680664, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.1369931697845459}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.9280000000002108, "episode_len_mean": 289.84, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, 45.1, 17.899999999999814, 32.90000000000003, -50.00000000000044, 22.299999999999876, 38.700000000000024, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.5, 41.70000000000002, 44.7, 18.29999999999982, -50.00000000000044, 46.9, 45.1, -50.00000000000044, 44.7, 2.8999999999996007, -50.00000000000044, 4.299999999999621, -50.00000000000044, -50.00000000000044, 46.699999999999996, 18.899999999999828, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.3, -50.00000000000044, 27.49999999999995, 46.099999999999994, -50.00000000000044, 43.50000000000001, -50.00000000000044, 29.099999999999973, 33.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 44.10000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 40.500000000000014, 30.29999999999999, 40.70000000000002, 25.499999999999922, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 36.50000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.500000000000014, 46.699999999999996, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, 42.500000000000014, 38.300000000000026, 19.69999999999984, -50.00000000000044, 39.70000000000002], "episode_lengths": [84, 50, 322, 172, 500, 278, 114, 50, 500, 500, 500, 62, 36, 84, 54, 318, 500, 32, 50, 500, 54, 472, 500, 458, 500, 500, 34, 312, 500, 500, 62, 500, 500, 30, 500, 48, 500, 226, 40, 500, 66, 500, 210, 168, 500, 40, 500, 28, 60, 500, 116, 500, 52, 500, 500, 40, 38, 500, 96, 198, 94, 246, 500, 50, 500, 500, 32, 500, 500, 500, 54, 136, 68, 500, 500, 44, 500, 500, 500, 68, 36, 500, 500, 106, 500, 500, 176, 76, 34, 226, 500, 500, 500, 500, 382, 76, 118, 304, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.405716609716923, "mean_inference_ms": 1.291105964801847, "mean_action_processing_ms": 0.1532751930080636, "mean_env_wait_ms": 0.09035725711329685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041010141372680664, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.1369931697845459}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4497.751555306056, "num_env_steps_trained_throughput_per_sec": 4497.751555306056, "timesteps_total": 1236000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 2307.802, "sample_time_ms": 2037.699, "load_time_ms": 11.5, "load_throughput": 1043499.808, "learn_time_ms": 247.7, "learn_throughput": 48445.714, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "episodes_total": 4755, "training_iteration": 103, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-08", "timestamp": 1698245228, "time_this_iter_s": 2.673997402191162, "time_total_s": 237.90178775787354, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 237.90178775787354, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 70.73333333333333, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9721522630525302e-32, "cur_lr": 0.0003, "total_loss": 6.601616827646891, "policy_loss": -6.828407446543375e-05, "vf_loss": 6.601731077829997, "vf_explained_var": -1.2556711832682292e-06, "kl": 0.0004523683857087235, "entropy": 0.4583633840084076, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1553.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0349999999998023, "episode_len_mean": 275.22, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.3, 44.10000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 40.500000000000014, 30.29999999999999, 40.70000000000002, 25.499999999999922, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 36.50000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.500000000000014, 46.699999999999996, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, 42.500000000000014, 38.300000000000026, 19.69999999999984, -50.00000000000044, 39.70000000000002, -50.00000000000044, 41.70000000000002, 44.300000000000004, 25.699999999999925, 44.7, -50.00000000000044, 40.70000000000002, 47.3, 22.299999999999876, -50.00000000000044, -50.00000000000044, 38.700000000000024, 46.5, -50.00000000000044, 29.299999999999976, 16.8999999999998, 42.10000000000001, 44.900000000000006, 47.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, 45.9, 45.1, 46.5, -50.00000000000044, -50.00000000000044, 32.50000000000002, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 21.89999999999987, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.3, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [28, 60, 500, 116, 500, 52, 500, 500, 40, 38, 500, 96, 198, 94, 246, 500, 50, 500, 500, 32, 500, 500, 500, 54, 136, 68, 500, 500, 44, 500, 500, 500, 68, 36, 500, 500, 106, 500, 500, 176, 76, 34, 226, 500, 500, 500, 500, 382, 76, 118, 304, 500, 104, 500, 84, 58, 244, 54, 500, 94, 28, 278, 500, 500, 114, 36, 500, 208, 332, 80, 52, 28, 102, 500, 500, 66, 28, 500, 42, 50, 36, 500, 500, 176, 102, 500, 500, 36, 282, 500, 500, 102, 48, 500, 64, 500, 68, 72, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.406358056921588, "mean_inference_ms": 1.2929677496100933, "mean_action_processing_ms": 0.1530575833083057, "mean_env_wait_ms": 0.09030120834676318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026996374130249023, "StateBufferConnector_ms": 0.007997512817382812, "ViewRequirementAgentConnector_ms": 0.1319732666015625}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0349999999998023, "episode_len_mean": 275.22, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.3, 44.10000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 40.500000000000014, 30.29999999999999, 40.70000000000002, 25.499999999999922, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 36.50000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.500000000000014, 46.699999999999996, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, 42.500000000000014, 38.300000000000026, 19.69999999999984, -50.00000000000044, 39.70000000000002, -50.00000000000044, 41.70000000000002, 44.300000000000004, 25.699999999999925, 44.7, -50.00000000000044, 40.70000000000002, 47.3, 22.299999999999876, -50.00000000000044, -50.00000000000044, 38.700000000000024, 46.5, -50.00000000000044, 29.299999999999976, 16.8999999999998, 42.10000000000001, 44.900000000000006, 47.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, 45.9, 45.1, 46.5, -50.00000000000044, -50.00000000000044, 32.50000000000002, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 21.89999999999987, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.3, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [28, 60, 500, 116, 500, 52, 500, 500, 40, 38, 500, 96, 198, 94, 246, 500, 50, 500, 500, 32, 500, 500, 500, 54, 136, 68, 500, 500, 44, 500, 500, 500, 68, 36, 500, 500, 106, 500, 500, 176, 76, 34, 226, 500, 500, 500, 500, 382, 76, 118, 304, 500, 104, 500, 84, 58, 244, 54, 500, 94, 28, 278, 500, 500, 114, 36, 500, 208, 332, 80, 52, 28, 102, 500, 500, 66, 28, 500, 42, 50, 36, 500, 500, 176, 102, 500, 500, 36, 282, 500, 500, 102, 48, 500, 64, 500, 68, 72, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.406358056921588, "mean_inference_ms": 1.2929677496100933, "mean_action_processing_ms": 0.1530575833083057, "mean_env_wait_ms": 0.09030120834676318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026996374130249023, "StateBufferConnector_ms": 0.007997512817382812, "ViewRequirementAgentConnector_ms": 0.1319732666015625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4336.82769847101, "num_env_steps_trained_throughput_per_sec": 4336.82769847101, "timesteps_total": 1248000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 2334.301, "sample_time_ms": 2070.599, "load_time_ms": 11.8, "load_throughput": 1016959.163, "learn_time_ms": 240.9, "learn_throughput": 49813.192, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "episodes_total": 4802, "training_iteration": 104, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-11", "timestamp": 1698245231, "time_this_iter_s": 2.7720000743865967, "time_total_s": 240.67378783226013, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 240.67378783226013, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 70.125, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.860761315262651e-33, "cur_lr": 0.0003, "total_loss": 6.336869970957438, "policy_loss": -0.0003137404719988505, "vf_loss": 6.337228806813558, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.0005099608148839252, "entropy": 0.451644766330719, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1568.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.406999999999802, "episode_len_mean": 271.52, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, 42.500000000000014, 38.300000000000026, 19.69999999999984, -50.00000000000044, 39.70000000000002, -50.00000000000044, 41.70000000000002, 44.300000000000004, 25.699999999999925, 44.7, -50.00000000000044, 40.70000000000002, 47.3, 22.299999999999876, -50.00000000000044, -50.00000000000044, 38.700000000000024, 46.5, -50.00000000000044, 29.299999999999976, 16.8999999999998, 42.10000000000001, 44.900000000000006, 47.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, 45.9, 45.1, 46.5, -50.00000000000044, -50.00000000000044, 32.50000000000002, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 21.89999999999987, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.3, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 46.5, 43.7, 47.3, 46.099999999999994, 7.899999999999672, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.10000000000001, 42.900000000000006, 45.1, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 44.300000000000004, 40.500000000000014, 0.6999999999995694, 41.70000000000002, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 31.70000000000001, -50.00000000000044, 17.299999999999805, 45.5], "episode_lengths": [500, 500, 500, 500, 382, 76, 118, 304, 500, 104, 500, 84, 58, 244, 54, 500, 94, 28, 278, 500, 500, 114, 36, 500, 208, 332, 80, 52, 28, 102, 500, 500, 66, 28, 500, 42, 50, 36, 500, 500, 176, 102, 500, 500, 36, 282, 500, 500, 102, 48, 500, 64, 500, 68, 72, 500, 500, 500, 38, 500, 64, 500, 500, 72, 500, 500, 56, 36, 64, 28, 40, 422, 68, 500, 500, 500, 500, 500, 500, 500, 146, 60, 72, 50, 500, 50, 46, 500, 58, 96, 494, 84, 500, 40, 62, 500, 184, 500, 328, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40778740655121587, "mean_inference_ms": 1.2961586165550834, "mean_action_processing_ms": 0.15354485470718351, "mean_env_wait_ms": 0.0905920282444829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02301168441772461, "StateBufferConnector_ms": 0.009998559951782227, "ViewRequirementAgentConnector_ms": 0.1373281478881836}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.406999999999802, "episode_len_mean": 271.52, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, 42.500000000000014, 38.300000000000026, 19.69999999999984, -50.00000000000044, 39.70000000000002, -50.00000000000044, 41.70000000000002, 44.300000000000004, 25.699999999999925, 44.7, -50.00000000000044, 40.70000000000002, 47.3, 22.299999999999876, -50.00000000000044, -50.00000000000044, 38.700000000000024, 46.5, -50.00000000000044, 29.299999999999976, 16.8999999999998, 42.10000000000001, 44.900000000000006, 47.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, 45.9, 45.1, 46.5, -50.00000000000044, -50.00000000000044, 32.50000000000002, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 21.89999999999987, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.3, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 46.5, 43.7, 47.3, 46.099999999999994, 7.899999999999672, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.10000000000001, 42.900000000000006, 45.1, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 44.300000000000004, 40.500000000000014, 0.6999999999995694, 41.70000000000002, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 31.70000000000001, -50.00000000000044, 17.299999999999805, 45.5], "episode_lengths": [500, 500, 500, 500, 382, 76, 118, 304, 500, 104, 500, 84, 58, 244, 54, 500, 94, 28, 278, 500, 500, 114, 36, 500, 208, 332, 80, 52, 28, 102, 500, 500, 66, 28, 500, 42, 50, 36, 500, 500, 176, 102, 500, 500, 36, 282, 500, 500, 102, 48, 500, 64, 500, 68, 72, 500, 500, 500, 38, 500, 64, 500, 500, 72, 500, 500, 56, 36, 64, 28, 40, 422, 68, 500, 500, 500, 500, 500, 500, 500, 146, 60, 72, 50, 500, 50, 46, 500, 58, 96, 494, 84, 500, 40, 62, 500, 184, 500, 328, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40778740655121587, "mean_inference_ms": 1.2961586165550834, "mean_action_processing_ms": 0.15354485470718351, "mean_env_wait_ms": 0.0905920282444829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02301168441772461, "StateBufferConnector_ms": 0.009998559951782227, "ViewRequirementAgentConnector_ms": 0.1373281478881836}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3883.4955531458218, "num_env_steps_trained_throughput_per_sec": 3883.4955531458218, "timesteps_total": 1260000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 2434.001, "sample_time_ms": 2157.599, "load_time_ms": 12.2, "load_throughput": 983639.405, "learn_time_ms": 252.6, "learn_throughput": 47505.933, "synch_weights_time_ms": 10.202}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4845, "training_iteration": 105, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-14", "timestamp": 1698245234, "time_this_iter_s": 3.095999002456665, "time_total_s": 243.7697868347168, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 243.7697868347168, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 86.67999999999999, "ram_util_percent": 27.619999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.9303806576313254e-33, "cur_lr": 0.0003, "total_loss": 6.742327562967936, "policy_loss": -6.110594549681991e-05, "vf_loss": 6.742437330881755, "vf_explained_var": -9.377797444661458e-07, "kl": 0.00037293460212595164, "entropy": 0.4860017418861389, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1583.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.762999999999836, "episode_len_mean": 238.02, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 46.5, 43.7, 47.3, 46.099999999999994, 7.899999999999672, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.10000000000001, 42.900000000000006, 45.1, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 44.300000000000004, 40.500000000000014, 0.6999999999995694, 41.70000000000002, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 31.70000000000001, -50.00000000000044, 17.299999999999805, 45.5, -50.00000000000044, 46.3, 45.3, 46.5, 42.500000000000014, 43.7, 44.5, 33.10000000000003, 40.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.90000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 39.300000000000026, 19.69999999999984, 45.5, 40.500000000000014, 46.099999999999994, 36.50000000000003, 45.7, 39.90000000000002, 42.70000000000001, 46.699999999999996, 44.7, 14.09999999999976, 41.70000000000002, 37.300000000000026, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 46.3, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 45.7, 35.30000000000004, 44.900000000000006, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 42.500000000000014], "episode_lengths": [38, 500, 64, 500, 500, 72, 500, 500, 56, 36, 64, 28, 40, 422, 68, 500, 500, 500, 500, 500, 500, 500, 146, 60, 72, 50, 500, 50, 46, 500, 58, 96, 494, 84, 500, 40, 62, 500, 184, 500, 328, 46, 500, 38, 48, 36, 76, 64, 56, 170, 100, 500, 94, 500, 500, 500, 40, 82, 130, 500, 500, 500, 90, 54, 500, 500, 212, 500, 108, 304, 46, 96, 40, 136, 44, 102, 74, 34, 54, 360, 84, 128, 110, 500, 500, 46, 500, 38, 60, 32, 500, 500, 44, 148, 52, 48, 44, 500, 500, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40976866753956515, "mean_inference_ms": 1.3018314852636874, "mean_action_processing_ms": 0.15473747238156949, "mean_env_wait_ms": 0.09125838965851667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038033485412597656, "StateBufferConnector_ms": 0.008007287979125977, "ViewRequirementAgentConnector_ms": 0.16833972930908203}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.762999999999836, "episode_len_mean": 238.02, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 46.5, 43.7, 47.3, 46.099999999999994, 7.899999999999672, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.10000000000001, 42.900000000000006, 45.1, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 44.300000000000004, 40.500000000000014, 0.6999999999995694, 41.70000000000002, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 31.70000000000001, -50.00000000000044, 17.299999999999805, 45.5, -50.00000000000044, 46.3, 45.3, 46.5, 42.500000000000014, 43.7, 44.5, 33.10000000000003, 40.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.90000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 39.300000000000026, 19.69999999999984, 45.5, 40.500000000000014, 46.099999999999994, 36.50000000000003, 45.7, 39.90000000000002, 42.70000000000001, 46.699999999999996, 44.7, 14.09999999999976, 41.70000000000002, 37.300000000000026, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 46.3, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 45.7, 35.30000000000004, 44.900000000000006, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 42.500000000000014], "episode_lengths": [38, 500, 64, 500, 500, 72, 500, 500, 56, 36, 64, 28, 40, 422, 68, 500, 500, 500, 500, 500, 500, 500, 146, 60, 72, 50, 500, 50, 46, 500, 58, 96, 494, 84, 500, 40, 62, 500, 184, 500, 328, 46, 500, 38, 48, 36, 76, 64, 56, 170, 100, 500, 94, 500, 500, 500, 40, 82, 130, 500, 500, 500, 90, 54, 500, 500, 212, 500, 108, 304, 46, 96, 40, 136, 44, 102, 74, 34, 54, 360, 84, 128, 110, 500, 500, 46, 500, 38, 60, 32, 500, 500, 44, 148, 52, 48, 44, 500, 500, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40976866753956515, "mean_inference_ms": 1.3018314852636874, "mean_action_processing_ms": 0.15473747238156949, "mean_env_wait_ms": 0.09125838965851667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038033485412597656, "StateBufferConnector_ms": 0.008007287979125977, "ViewRequirementAgentConnector_ms": 0.16833972930908203}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3464.200862284526, "num_env_steps_trained_throughput_per_sec": 3464.200862284526, "timesteps_total": 1272000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 2560.001, "sample_time_ms": 2275.3, "load_time_ms": 13.3, "load_throughput": 902238.547, "learn_time_ms": 259.799, "learn_throughput": 46189.498, "synch_weights_time_ms": 10.302}, "counters": {"num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "episodes_total": 4903, "training_iteration": 106, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-17", "timestamp": 1698245237, "time_this_iter_s": 3.4720020294189453, "time_total_s": 247.24178886413574, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 247.24178886413574, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 90.5, "ram_util_percent": 27.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4651903288156627e-33, "cur_lr": 0.0003, "total_loss": 6.355903180440267, "policy_loss": -0.0006426001588503519, "vf_loss": 6.356595611572265, "vf_explained_var": -8.344650268554688e-07, "kl": 0.0006929470334512189, "entropy": 0.5000995258490245, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1598.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.916999999999832, "episode_len_mean": 246.48, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.70000000000001, -50.00000000000044, 17.299999999999805, 45.5, -50.00000000000044, 46.3, 45.3, 46.5, 42.500000000000014, 43.7, 44.5, 33.10000000000003, 40.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.90000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 39.300000000000026, 19.69999999999984, 45.5, 40.500000000000014, 46.099999999999994, 36.50000000000003, 45.7, 39.90000000000002, 42.70000000000001, 46.699999999999996, 44.7, 14.09999999999976, 41.70000000000002, 37.300000000000026, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 46.3, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 45.7, 35.30000000000004, 44.900000000000006, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.1, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.500000000000014, 0.6999999999995694, 47.1, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, 8.699999999999683, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.1, 39.10000000000002, -50.00000000000044, 18.499999999999822, 34.70000000000004, 42.500000000000014, 39.70000000000002, 38.300000000000026, -50.00000000000044, 42.10000000000001, 46.5, 46.099999999999994, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 32.700000000000024, -50.00000000000044], "episode_lengths": [184, 500, 328, 46, 500, 38, 48, 36, 76, 64, 56, 170, 100, 500, 94, 500, 500, 500, 40, 82, 130, 500, 500, 500, 90, 54, 500, 500, 212, 500, 108, 304, 46, 96, 40, 136, 44, 102, 74, 34, 54, 360, 84, 128, 110, 500, 500, 46, 500, 38, 60, 32, 500, 500, 44, 148, 52, 48, 44, 500, 500, 76, 50, 500, 500, 76, 76, 494, 30, 500, 500, 28, 500, 500, 500, 340, 500, 500, 414, 98, 500, 500, 50, 110, 500, 316, 154, 76, 104, 118, 500, 80, 36, 40, 500, 56, 500, 72, 174, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41058826659141623, "mean_inference_ms": 1.3063025363417886, "mean_action_processing_ms": 0.15547679547827808, "mean_env_wait_ms": 0.0913531229314157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04302263259887695, "StateBufferConnector_ms": 0.008006811141967773, "ViewRequirementAgentConnector_ms": 0.20201396942138672}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.916999999999832, "episode_len_mean": 246.48, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.70000000000001, -50.00000000000044, 17.299999999999805, 45.5, -50.00000000000044, 46.3, 45.3, 46.5, 42.500000000000014, 43.7, 44.5, 33.10000000000003, 40.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.90000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 39.300000000000026, 19.69999999999984, 45.5, 40.500000000000014, 46.099999999999994, 36.50000000000003, 45.7, 39.90000000000002, 42.70000000000001, 46.699999999999996, 44.7, 14.09999999999976, 41.70000000000002, 37.300000000000026, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 46.3, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 45.7, 35.30000000000004, 44.900000000000006, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.1, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.500000000000014, 0.6999999999995694, 47.1, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, 8.699999999999683, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.1, 39.10000000000002, -50.00000000000044, 18.499999999999822, 34.70000000000004, 42.500000000000014, 39.70000000000002, 38.300000000000026, -50.00000000000044, 42.10000000000001, 46.5, 46.099999999999994, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 32.700000000000024, -50.00000000000044], "episode_lengths": [184, 500, 328, 46, 500, 38, 48, 36, 76, 64, 56, 170, 100, 500, 94, 500, 500, 500, 40, 82, 130, 500, 500, 500, 90, 54, 500, 500, 212, 500, 108, 304, 46, 96, 40, 136, 44, 102, 74, 34, 54, 360, 84, 128, 110, 500, 500, 46, 500, 38, 60, 32, 500, 500, 44, 148, 52, 48, 44, 500, 500, 76, 50, 500, 500, 76, 76, 494, 30, 500, 500, 28, 500, 500, 500, 340, 500, 500, 414, 98, 500, 500, 50, 110, 500, 316, 154, 76, 104, 118, 500, 80, 36, 40, 500, 56, 500, 72, 174, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41058826659141623, "mean_inference_ms": 1.3063025363417886, "mean_action_processing_ms": 0.15547679547827808, "mean_env_wait_ms": 0.0913531229314157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04302263259887695, "StateBufferConnector_ms": 0.008006811141967773, "ViewRequirementAgentConnector_ms": 0.20201396942138672}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3658.535021675365, "num_env_steps_trained_throughput_per_sec": 3658.535021675365, "timesteps_total": 1284000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 2660.701, "sample_time_ms": 2384.6, "load_time_ms": 12.6, "load_throughput": 952372.49, "learn_time_ms": 251.599, "learn_throughput": 47694.857, "synch_weights_time_ms": 10.502}, "counters": {"num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "episodes_total": 4941, "training_iteration": 107, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-21", "timestamp": 1698245241, "time_this_iter_s": 3.2850000858306885, "time_total_s": 250.52678894996643, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 250.52678894996643, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 83.12, "ram_util_percent": 27.659999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2325951644078314e-33, "cur_lr": 0.0003, "total_loss": 6.109998861948649, "policy_loss": -0.00015636257206400235, "vf_loss": 6.1102031707763675, "vf_explained_var": -6.834665934244792e-07, "kl": 0.0004605122205854665, "entropy": 0.4802208781242371, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1613.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0319999999997977, "episode_len_mean": 280.26, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, 42.70000000000001, 46.699999999999996, 44.7, 14.09999999999976, 41.70000000000002, 37.300000000000026, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 46.3, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 45.7, 35.30000000000004, 44.900000000000006, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.1, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.500000000000014, 0.6999999999995694, 47.1, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, 8.699999999999683, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.1, 39.10000000000002, -50.00000000000044, 18.499999999999822, 34.70000000000004, 42.500000000000014, 39.70000000000002, 38.300000000000026, -50.00000000000044, 42.10000000000001, 46.5, 46.099999999999994, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.099999999999817, 45.7, -50.00000000000044, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 13.899999999999757, 38.50000000000003, 45.7, 31.70000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 34.900000000000034, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.099999999999994, 40.90000000000002, 44.300000000000004, -50.00000000000044, 42.30000000000001], "episode_lengths": [102, 74, 34, 54, 360, 84, 128, 110, 500, 500, 46, 500, 38, 60, 32, 500, 500, 44, 148, 52, 48, 44, 500, 500, 76, 50, 500, 500, 76, 76, 494, 30, 500, 500, 28, 500, 500, 500, 340, 500, 500, 414, 98, 500, 500, 50, 110, 500, 316, 154, 76, 104, 118, 500, 80, 36, 40, 500, 56, 500, 72, 174, 500, 500, 500, 320, 44, 500, 60, 38, 500, 500, 362, 116, 44, 184, 500, 500, 178, 500, 500, 44, 500, 500, 500, 56, 500, 152, 488, 500, 500, 500, 500, 146, 500, 40, 92, 58, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41128923811545076, "mean_inference_ms": 1.3088114595032543, "mean_action_processing_ms": 0.15604264322726108, "mean_env_wait_ms": 0.09131349927111529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04301571846008301, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.18402838706970215}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0319999999997977, "episode_len_mean": 280.26, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, 42.70000000000001, 46.699999999999996, 44.7, 14.09999999999976, 41.70000000000002, 37.300000000000026, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 46.3, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 45.7, 35.30000000000004, 44.900000000000006, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.1, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.500000000000014, 0.6999999999995694, 47.1, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, 8.699999999999683, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.1, 39.10000000000002, -50.00000000000044, 18.499999999999822, 34.70000000000004, 42.500000000000014, 39.70000000000002, 38.300000000000026, -50.00000000000044, 42.10000000000001, 46.5, 46.099999999999994, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.099999999999817, 45.7, -50.00000000000044, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 13.899999999999757, 38.50000000000003, 45.7, 31.70000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 34.900000000000034, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.099999999999994, 40.90000000000002, 44.300000000000004, -50.00000000000044, 42.30000000000001], "episode_lengths": [102, 74, 34, 54, 360, 84, 128, 110, 500, 500, 46, 500, 38, 60, 32, 500, 500, 44, 148, 52, 48, 44, 500, 500, 76, 50, 500, 500, 76, 76, 494, 30, 500, 500, 28, 500, 500, 500, 340, 500, 500, 414, 98, 500, 500, 50, 110, 500, 316, 154, 76, 104, 118, 500, 80, 36, 40, 500, 56, 500, 72, 174, 500, 500, 500, 320, 44, 500, 60, 38, 500, 500, 362, 116, 44, 184, 500, 500, 178, 500, 500, 44, 500, 500, 500, 56, 500, 152, 488, 500, 500, 500, 500, 146, 500, 40, 92, 58, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41128923811545076, "mean_inference_ms": 1.3088114595032543, "mean_action_processing_ms": 0.15604264322726108, "mean_env_wait_ms": 0.09131349927111529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04301571846008301, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.18402838706970215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5010.43945082683, "num_env_steps_trained_throughput_per_sec": 5010.43945082683, "timesteps_total": 1296000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 2691.701, "sample_time_ms": 2395.499, "load_time_ms": 13.6, "load_throughput": 882341.099, "learn_time_ms": 271.199, "learn_throughput": 44247.887, "synch_weights_time_ms": 10.102}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4978, "training_iteration": 108, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-23", "timestamp": 1698245243, "time_this_iter_s": 2.4010026454925537, "time_total_s": 252.92779159545898, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 252.92779159545898, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 64.16666666666667, "ram_util_percent": 27.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.162975822039157e-34, "cur_lr": 0.0003, "total_loss": 6.511791610717774, "policy_loss": -0.00018164645880460739, "vf_loss": 6.512023512522379, "vf_explained_var": -8.344650268554688e-07, "kl": 0.0007214755331081808, "entropy": 0.5020724515120188, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1628.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.645999999999803, "episode_len_mean": 274.12, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 39.70000000000002, 38.300000000000026, -50.00000000000044, 42.10000000000001, 46.5, 46.099999999999994, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.099999999999817, 45.7, -50.00000000000044, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 13.899999999999757, 38.50000000000003, 45.7, 31.70000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 34.900000000000034, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.099999999999994, 40.90000000000002, 44.300000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.1, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.90000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 28.29999999999996, 43.10000000000001, 43.50000000000001, 41.30000000000001, 46.099999999999994, 16.8999999999998, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 44.5, 43.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7, 43.10000000000001, 46.699999999999996, 37.10000000000003, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.70000000000002, 45.5, 2.699999999999598, 41.30000000000001, 44.5, 45.1, 44.300000000000004, -50.00000000000044], "episode_lengths": [76, 104, 118, 500, 80, 36, 40, 500, 56, 500, 72, 174, 500, 500, 500, 320, 44, 500, 60, 38, 500, 500, 362, 116, 44, 184, 500, 500, 178, 500, 500, 44, 500, 500, 500, 56, 500, 152, 488, 500, 500, 500, 500, 146, 500, 40, 92, 58, 500, 78, 500, 500, 64, 500, 500, 30, 42, 500, 500, 34, 82, 60, 500, 500, 218, 70, 66, 88, 40, 332, 214, 500, 500, 500, 46, 500, 500, 500, 260, 56, 68, 50, 500, 500, 82, 54, 70, 34, 130, 500, 100, 500, 94, 46, 474, 88, 56, 50, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4113089853055054, "mean_inference_ms": 1.3096532432738304, "mean_action_processing_ms": 0.1559579340037929, "mean_env_wait_ms": 0.09135352165229291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0220029354095459, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.11801934242248535}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.645999999999803, "episode_len_mean": 274.12, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 39.70000000000002, 38.300000000000026, -50.00000000000044, 42.10000000000001, 46.5, 46.099999999999994, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.099999999999817, 45.7, -50.00000000000044, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 13.899999999999757, 38.50000000000003, 45.7, 31.70000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 34.900000000000034, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.099999999999994, 40.90000000000002, 44.300000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.1, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.90000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 28.29999999999996, 43.10000000000001, 43.50000000000001, 41.30000000000001, 46.099999999999994, 16.8999999999998, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 44.5, 43.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7, 43.10000000000001, 46.699999999999996, 37.10000000000003, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.70000000000002, 45.5, 2.699999999999598, 41.30000000000001, 44.5, 45.1, 44.300000000000004, -50.00000000000044], "episode_lengths": [76, 104, 118, 500, 80, 36, 40, 500, 56, 500, 72, 174, 500, 500, 500, 320, 44, 500, 60, 38, 500, 500, 362, 116, 44, 184, 500, 500, 178, 500, 500, 44, 500, 500, 500, 56, 500, 152, 488, 500, 500, 500, 500, 146, 500, 40, 92, 58, 500, 78, 500, 500, 64, 500, 500, 30, 42, 500, 500, 34, 82, 60, 500, 500, 218, 70, 66, 88, 40, 332, 214, 500, 500, 500, 46, 500, 500, 500, 260, 56, 68, 50, 500, 500, 82, 54, 70, 34, 130, 500, 100, 500, 94, 46, 474, 88, 56, 50, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4113089853055054, "mean_inference_ms": 1.3096532432738304, "mean_action_processing_ms": 0.1559579340037929, "mean_env_wait_ms": 0.09135352165229291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0220029354095459, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.11801934242248535}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5607.471362780377, "num_env_steps_trained_throughput_per_sec": 5607.471362780377, "timesteps_total": 1308000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 2666.601, "sample_time_ms": 2384.699, "load_time_ms": 13.2, "load_throughput": 909082.909, "learn_time_ms": 257.399, "learn_throughput": 46620.152, "synch_weights_time_ms": 10.002}, "counters": {"num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "episodes_total": 5028, "training_iteration": 109, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-25", "timestamp": 1698245245, "time_this_iter_s": 2.145000457763672, "time_total_s": 255.07279205322266, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 255.07279205322266, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 57.26666666666667, "ram_util_percent": 27.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0814879110195784e-34, "cur_lr": 0.0003, "total_loss": 6.787076632181804, "policy_loss": 0.00014012033740679424, "vf_loss": 6.786984793345133, "vf_explained_var": -1.0013580322265625e-06, "kl": 0.00014192751737217199, "entropy": 0.48326278328895567, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1643.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.72999999999983, "episode_len_mean": 253.34, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, 44.300000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.1, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.90000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 28.29999999999996, 43.10000000000001, 43.50000000000001, 41.30000000000001, 46.099999999999994, 16.8999999999998, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 44.5, 43.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7, 43.10000000000001, 46.699999999999996, 37.10000000000003, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.70000000000002, 45.5, 2.699999999999598, 41.30000000000001, 44.5, 45.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 31.70000000000001, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 36.30000000000003, 25.29999999999992, 33.30000000000003, 41.30000000000001, 45.9, -50.00000000000044, 44.900000000000006, 14.299999999999763, 1.4999999999995808, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 45.3, 43.10000000000001, 44.10000000000001, 26.69999999999994, 28.699999999999967, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.10000000000002, 36.900000000000034, 38.10000000000002, 41.70000000000002, 44.7, 25.099999999999916, -50.00000000000044, -50.00000000000044], "episode_lengths": [92, 58, 500, 78, 500, 500, 64, 500, 500, 30, 42, 500, 500, 34, 82, 60, 500, 500, 218, 70, 66, 88, 40, 332, 214, 500, 500, 500, 46, 500, 500, 500, 260, 56, 68, 50, 500, 500, 82, 54, 70, 34, 130, 500, 100, 500, 94, 46, 474, 88, 56, 50, 58, 500, 500, 184, 60, 48, 500, 500, 80, 36, 500, 500, 52, 500, 500, 70, 138, 248, 168, 88, 42, 500, 52, 358, 486, 500, 70, 500, 500, 100, 48, 70, 60, 234, 214, 500, 226, 500, 500, 58, 120, 132, 120, 84, 54, 250, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4111908634091245, "mean_inference_ms": 1.3093343832232605, "mean_action_processing_ms": 0.15537050927863194, "mean_env_wait_ms": 0.09149463001678913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01599884033203125, "StateBufferConnector_ms": 0.0060040950775146484, "ViewRequirementAgentConnector_ms": 0.1250133514404297}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.72999999999983, "episode_len_mean": 253.34, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, 44.300000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.1, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.90000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 28.29999999999996, 43.10000000000001, 43.50000000000001, 41.30000000000001, 46.099999999999994, 16.8999999999998, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 44.5, 43.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7, 43.10000000000001, 46.699999999999996, 37.10000000000003, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.70000000000002, 45.5, 2.699999999999598, 41.30000000000001, 44.5, 45.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 31.70000000000001, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 36.30000000000003, 25.29999999999992, 33.30000000000003, 41.30000000000001, 45.9, -50.00000000000044, 44.900000000000006, 14.299999999999763, 1.4999999999995808, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 45.3, 43.10000000000001, 44.10000000000001, 26.69999999999994, 28.699999999999967, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.10000000000002, 36.900000000000034, 38.10000000000002, 41.70000000000002, 44.7, 25.099999999999916, -50.00000000000044, -50.00000000000044], "episode_lengths": [92, 58, 500, 78, 500, 500, 64, 500, 500, 30, 42, 500, 500, 34, 82, 60, 500, 500, 218, 70, 66, 88, 40, 332, 214, 500, 500, 500, 46, 500, 500, 500, 260, 56, 68, 50, 500, 500, 82, 54, 70, 34, 130, 500, 100, 500, 94, 46, 474, 88, 56, 50, 58, 500, 500, 184, 60, 48, 500, 500, 80, 36, 500, 500, 52, 500, 500, 70, 138, 248, 168, 88, 42, 500, 52, 358, 486, 500, 70, 500, 500, 100, 48, 70, 60, 234, 214, 500, 226, 500, 500, 58, 120, 132, 120, 84, 54, 250, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4111908634091245, "mean_inference_ms": 1.3093343832232605, "mean_action_processing_ms": 0.15537050927863194, "mean_env_wait_ms": 0.09149463001678913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01599884033203125, "StateBufferConnector_ms": 0.0060040950775146484, "ViewRequirementAgentConnector_ms": 0.1250133514404297}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5154.643774366109, "num_env_steps_trained_throughput_per_sec": 5154.643774366109, "timesteps_total": 1320000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 2681.7, "sample_time_ms": 2394.799, "load_time_ms": 13.5, "load_throughput": 888893.661, "learn_time_ms": 262.399, "learn_throughput": 45731.797, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "episodes_total": 5074, "training_iteration": 110, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-28", "timestamp": 1698245248, "time_this_iter_s": 2.3329970836639404, "time_total_s": 257.4057891368866, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 257.4057891368866, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 60.475, "ram_util_percent": 27.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5407439555097892e-34, "cur_lr": 0.0003, "total_loss": 6.380965169270834, "policy_loss": -0.00020320477584997814, "vf_loss": 6.381212743123372, "vf_explained_var": -9.775161743164062e-07, "kl": 0.0005733261542369898, "entropy": 0.44356365005175274, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1658.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.527999999999829, "episode_len_mean": 255.36, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, -50.00000000000044, 40.70000000000002, 45.5, 2.699999999999598, 41.30000000000001, 44.5, 45.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 31.70000000000001, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 36.30000000000003, 25.29999999999992, 33.30000000000003, 41.30000000000001, 45.9, -50.00000000000044, 44.900000000000006, 14.299999999999763, 1.4999999999995808, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 45.3, 43.10000000000001, 44.10000000000001, 26.69999999999994, 28.699999999999967, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.10000000000002, 36.900000000000034, 38.10000000000002, 41.70000000000002, 44.7, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, 43.30000000000001, 46.699999999999996, 20.099999999999845, 45.7, 46.099999999999994, 45.7, 28.89999999999997, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 36.30000000000003, 43.10000000000001, 37.10000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 29.899999999999984, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 37.90000000000003, 44.5, 26.69999999999994, 46.9, -50.00000000000044, 37.70000000000003, 42.500000000000014], "episode_lengths": [100, 500, 94, 46, 474, 88, 56, 50, 58, 500, 500, 184, 60, 48, 500, 500, 80, 36, 500, 500, 52, 500, 500, 70, 138, 248, 168, 88, 42, 500, 52, 358, 486, 500, 70, 500, 500, 100, 48, 70, 60, 234, 214, 500, 226, 500, 500, 58, 120, 132, 120, 84, 54, 250, 500, 500, 500, 500, 500, 256, 68, 34, 300, 44, 40, 44, 212, 80, 500, 44, 500, 500, 500, 60, 30, 500, 500, 500, 50, 138, 70, 130, 500, 36, 500, 500, 500, 102, 202, 500, 500, 36, 500, 122, 56, 234, 32, 500, 124, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4111784536031278, "mean_inference_ms": 1.3084932962754308, "mean_action_processing_ms": 0.15510221731780796, "mean_env_wait_ms": 0.09144559337531671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500295639038086, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.12900686264038086}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.527999999999829, "episode_len_mean": 255.36, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, -50.00000000000044, 40.70000000000002, 45.5, 2.699999999999598, 41.30000000000001, 44.5, 45.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 31.70000000000001, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 36.30000000000003, 25.29999999999992, 33.30000000000003, 41.30000000000001, 45.9, -50.00000000000044, 44.900000000000006, 14.299999999999763, 1.4999999999995808, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 45.3, 43.10000000000001, 44.10000000000001, 26.69999999999994, 28.699999999999967, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.10000000000002, 36.900000000000034, 38.10000000000002, 41.70000000000002, 44.7, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, 43.30000000000001, 46.699999999999996, 20.099999999999845, 45.7, 46.099999999999994, 45.7, 28.89999999999997, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 36.30000000000003, 43.10000000000001, 37.10000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 29.899999999999984, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 37.90000000000003, 44.5, 26.69999999999994, 46.9, -50.00000000000044, 37.70000000000003, 42.500000000000014], "episode_lengths": [100, 500, 94, 46, 474, 88, 56, 50, 58, 500, 500, 184, 60, 48, 500, 500, 80, 36, 500, 500, 52, 500, 500, 70, 138, 248, 168, 88, 42, 500, 52, 358, 486, 500, 70, 500, 500, 100, 48, 70, 60, 234, 214, 500, 226, 500, 500, 58, 120, 132, 120, 84, 54, 250, 500, 500, 500, 500, 500, 256, 68, 34, 300, 44, 40, 44, 212, 80, 500, 44, 500, 500, 500, 60, 30, 500, 500, 500, 50, 138, 70, 130, 500, 36, 500, 500, 500, 102, 202, 500, 500, 36, 500, 122, 56, 234, 32, 500, 124, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4111784536031278, "mean_inference_ms": 1.3084932962754308, "mean_action_processing_ms": 0.15510221731780796, "mean_env_wait_ms": 0.09144559337531671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500295639038086, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.12900686264038086}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5202.120841320665, "num_env_steps_trained_throughput_per_sec": 5202.120841320665, "timesteps_total": 1332000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 2670.375, "sample_time_ms": 2375.3, "load_time_ms": 15.199, "load_throughput": 789502.424, "learn_time_ms": 268.874, "learn_throughput": 44630.554, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5118, "training_iteration": 111, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-30", "timestamp": 1698245250, "time_this_iter_s": 2.3117473125457764, "time_total_s": 259.7175364494324, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 259.7175364494324, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 63.79999999999999, "ram_util_percent": 28.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.703719777548946e-35, "cur_lr": 0.0003, "total_loss": 6.5822478294372555, "policy_loss": -0.0005164812008539836, "vf_loss": 6.582812245686849, "vf_explained_var": -8.424123128255208e-07, "kl": 0.0007020823996147858, "entropy": 0.47808385888735455, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1673.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.582999999999818, "episode_len_mean": 259.78, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.300000000000004, 38.10000000000002, 36.900000000000034, 38.10000000000002, 41.70000000000002, 44.7, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, 43.30000000000001, 46.699999999999996, 20.099999999999845, 45.7, 46.099999999999994, 45.7, 28.89999999999997, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 36.30000000000003, 43.10000000000001, 37.10000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 29.899999999999984, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 37.90000000000003, 44.5, 26.69999999999994, 46.9, -50.00000000000044, 37.70000000000003, 42.500000000000014, -50.00000000000044, 30.9, 44.5, 42.70000000000001, 45.1, 46.5, 46.3, 45.9, -50.00000000000044, 18.699999999999825, 46.9, 46.5, -50.00000000000044, 44.900000000000006, 47.1, -50.00000000000044, 47.7, 41.500000000000014, -50.00000000000044, 10.699999999999712, 47.7, -50.00000000000044, 4.699999999999626, -50.00000000000044, 43.900000000000006, 32.30000000000002, -50.00000000000044, 18.499999999999822, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.90000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001], "episode_lengths": [500, 500, 58, 120, 132, 120, 84, 54, 250, 500, 500, 500, 500, 500, 256, 68, 34, 300, 44, 40, 44, 212, 80, 500, 44, 500, 500, 500, 60, 30, 500, 500, 500, 50, 138, 70, 130, 500, 36, 500, 500, 500, 102, 202, 500, 500, 36, 500, 122, 56, 234, 32, 500, 124, 76, 500, 192, 56, 74, 50, 36, 38, 42, 500, 314, 32, 36, 500, 52, 30, 500, 24, 86, 500, 394, 24, 500, 454, 500, 62, 178, 500, 316, 500, 58, 500, 500, 68, 26, 500, 500, 500, 96, 92, 76, 500, 500, 500, 46, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4113346014863978, "mean_inference_ms": 1.308028313315844, "mean_action_processing_ms": 0.1550596078132575, "mean_env_wait_ms": 0.09143733593526332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03001117706298828, "StateBufferConnector_ms": 0.003997325897216797, "ViewRequirementAgentConnector_ms": 0.12098884582519531}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.582999999999818, "episode_len_mean": 259.78, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.300000000000004, 38.10000000000002, 36.900000000000034, 38.10000000000002, 41.70000000000002, 44.7, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, 43.30000000000001, 46.699999999999996, 20.099999999999845, 45.7, 46.099999999999994, 45.7, 28.89999999999997, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 36.30000000000003, 43.10000000000001, 37.10000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 29.899999999999984, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 37.90000000000003, 44.5, 26.69999999999994, 46.9, -50.00000000000044, 37.70000000000003, 42.500000000000014, -50.00000000000044, 30.9, 44.5, 42.70000000000001, 45.1, 46.5, 46.3, 45.9, -50.00000000000044, 18.699999999999825, 46.9, 46.5, -50.00000000000044, 44.900000000000006, 47.1, -50.00000000000044, 47.7, 41.500000000000014, -50.00000000000044, 10.699999999999712, 47.7, -50.00000000000044, 4.699999999999626, -50.00000000000044, 43.900000000000006, 32.30000000000002, -50.00000000000044, 18.499999999999822, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.90000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001], "episode_lengths": [500, 500, 58, 120, 132, 120, 84, 54, 250, 500, 500, 500, 500, 500, 256, 68, 34, 300, 44, 40, 44, 212, 80, 500, 44, 500, 500, 500, 60, 30, 500, 500, 500, 50, 138, 70, 130, 500, 36, 500, 500, 500, 102, 202, 500, 500, 36, 500, 122, 56, 234, 32, 500, 124, 76, 500, 192, 56, 74, 50, 36, 38, 42, 500, 314, 32, 36, 500, 52, 30, 500, 24, 86, 500, 394, 24, 500, 454, 500, 62, 178, 500, 316, 500, 58, 500, 500, 68, 26, 500, 500, 500, 96, 92, 76, 500, 500, 500, 46, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4113346014863978, "mean_inference_ms": 1.308028313315844, "mean_action_processing_ms": 0.1550596078132575, "mean_env_wait_ms": 0.09143733593526332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03001117706298828, "StateBufferConnector_ms": 0.003997325897216797, "ViewRequirementAgentConnector_ms": 0.12098884582519531}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5639.092634385104, "num_env_steps_trained_throughput_per_sec": 5639.092634385104, "timesteps_total": 1344000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 2656.676, "sample_time_ms": 2365.6, "load_time_ms": 14.799, "load_throughput": 810840.843, "learn_time_ms": 265.174, "learn_throughput": 45253.263, "synch_weights_time_ms": 10.002}, "counters": {"num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "episodes_total": 5163, "training_iteration": 112, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-32", "timestamp": 1698245252, "time_this_iter_s": 2.1329996585845947, "time_total_s": 261.85053610801697, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 261.85053610801697, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 61.1, "ram_util_percent": 28.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.851859888774473e-35, "cur_lr": 0.0003, "total_loss": 6.468159294128418, "policy_loss": 3.335811197757721e-05, "vf_loss": 6.468170770009359, "vf_explained_var": -1.1205673217773438e-06, "kl": 8.363154909147852e-05, "entropy": 0.4479552567005157, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1688.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.993999999999825, "episode_len_mean": 250.7, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 26.69999999999994, 46.9, -50.00000000000044, 37.70000000000003, 42.500000000000014, -50.00000000000044, 30.9, 44.5, 42.70000000000001, 45.1, 46.5, 46.3, 45.9, -50.00000000000044, 18.699999999999825, 46.9, 46.5, -50.00000000000044, 44.900000000000006, 47.1, -50.00000000000044, 47.7, 41.500000000000014, -50.00000000000044, 10.699999999999712, 47.7, -50.00000000000044, 4.699999999999626, -50.00000000000044, 43.900000000000006, 32.30000000000002, -50.00000000000044, 18.499999999999822, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.90000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 6.299999999999649, -50.00000000000044, 45.1, 47.3, -50.00000000000044, -50.00000000000044, 21.699999999999868, 45.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.7, 45.9, -50.00000000000044, 29.299999999999976, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 45.7, 44.7, 46.9, 45.5, 4.099999999999618, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 21.89999999999987, -50.00000000000044, 40.90000000000002, -50.00000000000044, 33.70000000000004, 42.900000000000006, 47.3, 46.9, 30.099999999999987, 40.10000000000002, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044], "episode_lengths": [56, 234, 32, 500, 124, 76, 500, 192, 56, 74, 50, 36, 38, 42, 500, 314, 32, 36, 500, 52, 30, 500, 24, 86, 500, 394, 24, 500, 454, 500, 62, 178, 500, 316, 500, 58, 500, 500, 68, 26, 500, 500, 500, 96, 92, 76, 500, 500, 500, 46, 88, 438, 500, 50, 28, 500, 500, 284, 46, 500, 114, 500, 64, 42, 500, 208, 500, 120, 500, 500, 500, 26, 48, 44, 54, 32, 46, 460, 66, 48, 500, 500, 132, 500, 282, 500, 92, 500, 164, 72, 28, 32, 200, 100, 74, 44, 500, 500, 70, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41083556646243025, "mean_inference_ms": 1.3071364383110324, "mean_action_processing_ms": 0.1550922919994515, "mean_env_wait_ms": 0.09150901328838067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033005714416503906, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.11796903610229492}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.993999999999825, "episode_len_mean": 250.7, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 26.69999999999994, 46.9, -50.00000000000044, 37.70000000000003, 42.500000000000014, -50.00000000000044, 30.9, 44.5, 42.70000000000001, 45.1, 46.5, 46.3, 45.9, -50.00000000000044, 18.699999999999825, 46.9, 46.5, -50.00000000000044, 44.900000000000006, 47.1, -50.00000000000044, 47.7, 41.500000000000014, -50.00000000000044, 10.699999999999712, 47.7, -50.00000000000044, 4.699999999999626, -50.00000000000044, 43.900000000000006, 32.30000000000002, -50.00000000000044, 18.499999999999822, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.90000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 6.299999999999649, -50.00000000000044, 45.1, 47.3, -50.00000000000044, -50.00000000000044, 21.699999999999868, 45.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.7, 45.9, -50.00000000000044, 29.299999999999976, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 45.7, 44.7, 46.9, 45.5, 4.099999999999618, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 21.89999999999987, -50.00000000000044, 40.90000000000002, -50.00000000000044, 33.70000000000004, 42.900000000000006, 47.3, 46.9, 30.099999999999987, 40.10000000000002, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044], "episode_lengths": [56, 234, 32, 500, 124, 76, 500, 192, 56, 74, 50, 36, 38, 42, 500, 314, 32, 36, 500, 52, 30, 500, 24, 86, 500, 394, 24, 500, 454, 500, 62, 178, 500, 316, 500, 58, 500, 500, 68, 26, 500, 500, 500, 96, 92, 76, 500, 500, 500, 46, 88, 438, 500, 50, 28, 500, 500, 284, 46, 500, 114, 500, 64, 42, 500, 208, 500, 120, 500, 500, 500, 26, 48, 44, 54, 32, 46, 460, 66, 48, 500, 500, 132, 500, 282, 500, 92, 500, 164, 72, 28, 32, 200, 100, 74, 44, 500, 500, 70, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41083556646243025, "mean_inference_ms": 1.3071364383110324, "mean_action_processing_ms": 0.1550922919994515, "mean_env_wait_ms": 0.09150901328838067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033005714416503906, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.11796903610229492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5161.292863067068, "num_env_steps_trained_throughput_per_sec": 5161.292863067068, "timesteps_total": 1356000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 2622.375, "sample_time_ms": 2330.101, "load_time_ms": 14.5, "load_throughput": 827599.924, "learn_time_ms": 266.674, "learn_throughput": 44998.735, "synch_weights_time_ms": 10.102}, "counters": {"num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "episodes_total": 5212, "training_iteration": 113, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-35", "timestamp": 1698245255, "time_this_iter_s": 2.3299992084503174, "time_total_s": 264.1805353164673, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 264.1805353164673, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 64.33333333333333, "ram_util_percent": 28.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9259299443872365e-35, "cur_lr": 0.0003, "total_loss": 6.858546415964763, "policy_loss": -0.0006901805599530537, "vf_loss": 6.859286912282308, "vf_explained_var": -1.1046727498372397e-06, "kl": 0.0005897827387968846, "entropy": 0.502735455830892, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1703.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.209999999999837, "episode_len_mean": 238.56, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 21.699999999999868, 45.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.7, 45.9, -50.00000000000044, 29.299999999999976, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 45.7, 44.7, 46.9, 45.5, 4.099999999999618, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 21.89999999999987, -50.00000000000044, 40.90000000000002, -50.00000000000044, 33.70000000000004, 42.900000000000006, 47.3, 46.9, 30.099999999999987, 40.10000000000002, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.900000000000006, 41.70000000000002, 43.7, 39.300000000000026, 47.3, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 30.699999999999996, 45.3, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.7, 47.9, 43.30000000000001, 46.699999999999996, 44.900000000000006, 9.699999999999697, 17.69999999999981, 22.099999999999874, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.3, 45.5, -50.00000000000044, 41.30000000000001, 46.5, -50.00000000000044, 46.5, -50.00000000000044, 46.3, 46.3, 45.3, -50.00000000000044, -50.00000000000044, 24.899999999999913, -50.00000000000044, 47.7, 47.1, 46.9, 45.9, 41.70000000000002, 12.899999999999743, -50.00000000000044, 46.9, 29.299999999999976], "episode_lengths": [500, 500, 284, 46, 500, 114, 500, 64, 42, 500, 208, 500, 120, 500, 500, 500, 26, 48, 44, 54, 32, 46, 460, 66, 48, 500, 500, 132, 500, 282, 500, 92, 500, 164, 72, 28, 32, 200, 100, 74, 44, 500, 500, 70, 500, 500, 62, 72, 84, 64, 108, 28, 500, 500, 46, 58, 500, 500, 174, 500, 194, 48, 500, 500, 118, 64, 22, 68, 34, 52, 404, 324, 280, 106, 500, 500, 48, 46, 500, 88, 36, 500, 36, 500, 38, 38, 48, 500, 500, 252, 500, 24, 30, 32, 42, 84, 372, 500, 32, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4109222747079117, "mean_inference_ms": 1.3075309504555719, "mean_action_processing_ms": 0.15491143160176443, "mean_env_wait_ms": 0.09146371407307219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024993181228637695, "StateBufferConnector_ms": 0.0020008087158203125, "ViewRequirementAgentConnector_ms": 0.12496209144592285}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.209999999999837, "episode_len_mean": 238.56, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 21.699999999999868, 45.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.7, 45.9, -50.00000000000044, 29.299999999999976, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 45.7, 44.7, 46.9, 45.5, 4.099999999999618, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 21.89999999999987, -50.00000000000044, 40.90000000000002, -50.00000000000044, 33.70000000000004, 42.900000000000006, 47.3, 46.9, 30.099999999999987, 40.10000000000002, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.900000000000006, 41.70000000000002, 43.7, 39.300000000000026, 47.3, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 30.699999999999996, 45.3, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.7, 47.9, 43.30000000000001, 46.699999999999996, 44.900000000000006, 9.699999999999697, 17.69999999999981, 22.099999999999874, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.3, 45.5, -50.00000000000044, 41.30000000000001, 46.5, -50.00000000000044, 46.5, -50.00000000000044, 46.3, 46.3, 45.3, -50.00000000000044, -50.00000000000044, 24.899999999999913, -50.00000000000044, 47.7, 47.1, 46.9, 45.9, 41.70000000000002, 12.899999999999743, -50.00000000000044, 46.9, 29.299999999999976], "episode_lengths": [500, 500, 284, 46, 500, 114, 500, 64, 42, 500, 208, 500, 120, 500, 500, 500, 26, 48, 44, 54, 32, 46, 460, 66, 48, 500, 500, 132, 500, 282, 500, 92, 500, 164, 72, 28, 32, 200, 100, 74, 44, 500, 500, 70, 500, 500, 62, 72, 84, 64, 108, 28, 500, 500, 46, 58, 500, 500, 174, 500, 194, 48, 500, 500, 118, 64, 22, 68, 34, 52, 404, 324, 280, 106, 500, 500, 48, 46, 500, 88, 36, 500, 36, 500, 38, 38, 48, 500, 500, 252, 500, 24, 30, 32, 42, 84, 372, 500, 32, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4109222747079117, "mean_inference_ms": 1.3075309504555719, "mean_action_processing_ms": 0.15491143160176443, "mean_env_wait_ms": 0.09146371407307219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024993181228637695, "StateBufferConnector_ms": 0.0020008087158203125, "ViewRequirementAgentConnector_ms": 0.12496209144592285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5312.082042119959, "num_env_steps_trained_throughput_per_sec": 5312.082042119959, "timesteps_total": 1368000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 2571.576, "sample_time_ms": 2285.301, "load_time_ms": 13.8, "load_throughput": 869592.188, "learn_time_ms": 261.374, "learn_throughput": 45911.215, "synch_weights_time_ms": 10.102}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5267, "training_iteration": 114, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-37", "timestamp": 1698245257, "time_this_iter_s": 2.263000726699829, "time_total_s": 266.4435360431671, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 266.4435360431671, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 61.06666666666666, "ram_util_percent": 28.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.629649721936182e-36, "cur_lr": 0.0003, "total_loss": 6.5598855972290036, "policy_loss": -4.598051309585571e-05, "vf_loss": 6.559977944691976, "vf_explained_var": -8.265177408854167e-07, "kl": 0.00027366003273527896, "entropy": 0.4645189861456553, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1718.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.54199999999984, "episode_len_mean": 235.24, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, 43.7, 39.300000000000026, 47.3, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 30.699999999999996, 45.3, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.7, 47.9, 43.30000000000001, 46.699999999999996, 44.900000000000006, 9.699999999999697, 17.69999999999981, 22.099999999999874, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.3, 45.5, -50.00000000000044, 41.30000000000001, 46.5, -50.00000000000044, 46.5, -50.00000000000044, 46.3, 46.3, 45.3, -50.00000000000044, -50.00000000000044, 24.899999999999913, -50.00000000000044, 47.7, 47.1, 46.9, 45.9, 41.70000000000002, 12.899999999999743, -50.00000000000044, 46.9, 29.299999999999976, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, 46.099999999999994, 25.499999999999922, 37.300000000000026, -50.00000000000044, -50.00000000000044, 34.70000000000004, 45.3, 38.50000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.70000000000001, 47.1, 44.10000000000001, -50.00000000000044, 47.1, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.699999999999996, 40.500000000000014, -50.00000000000044, 44.300000000000004, 40.30000000000002, 43.50000000000001, 43.900000000000006, 44.7, 47.3, -50.00000000000044, -50.00000000000044, 46.9, 33.90000000000004, 46.699999999999996, 23.499999999999893, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.3], "episode_lengths": [84, 64, 108, 28, 500, 500, 46, 58, 500, 500, 174, 500, 194, 48, 500, 500, 118, 64, 22, 68, 34, 52, 404, 324, 280, 106, 500, 500, 48, 46, 500, 88, 36, 500, 36, 500, 38, 38, 48, 500, 500, 252, 500, 24, 30, 32, 42, 84, 372, 500, 32, 208, 500, 500, 218, 500, 500, 500, 268, 40, 246, 128, 500, 500, 154, 48, 116, 500, 52, 500, 74, 30, 60, 500, 30, 500, 44, 500, 500, 68, 34, 96, 500, 58, 98, 66, 62, 54, 28, 500, 500, 32, 162, 34, 266, 116, 500, 500, 74, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41084920146353915, "mean_inference_ms": 1.3069387064409363, "mean_action_processing_ms": 0.15527091956684613, "mean_env_wait_ms": 0.09140783308166052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023994922637939453, "StateBufferConnector_ms": 0.002994537353515625, "ViewRequirementAgentConnector_ms": 0.12200665473937988}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.54199999999984, "episode_len_mean": 235.24, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, 43.7, 39.300000000000026, 47.3, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 30.699999999999996, 45.3, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.7, 47.9, 43.30000000000001, 46.699999999999996, 44.900000000000006, 9.699999999999697, 17.69999999999981, 22.099999999999874, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.3, 45.5, -50.00000000000044, 41.30000000000001, 46.5, -50.00000000000044, 46.5, -50.00000000000044, 46.3, 46.3, 45.3, -50.00000000000044, -50.00000000000044, 24.899999999999913, -50.00000000000044, 47.7, 47.1, 46.9, 45.9, 41.70000000000002, 12.899999999999743, -50.00000000000044, 46.9, 29.299999999999976, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, 46.099999999999994, 25.499999999999922, 37.300000000000026, -50.00000000000044, -50.00000000000044, 34.70000000000004, 45.3, 38.50000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.70000000000001, 47.1, 44.10000000000001, -50.00000000000044, 47.1, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.699999999999996, 40.500000000000014, -50.00000000000044, 44.300000000000004, 40.30000000000002, 43.50000000000001, 43.900000000000006, 44.7, 47.3, -50.00000000000044, -50.00000000000044, 46.9, 33.90000000000004, 46.699999999999996, 23.499999999999893, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.3], "episode_lengths": [84, 64, 108, 28, 500, 500, 46, 58, 500, 500, 174, 500, 194, 48, 500, 500, 118, 64, 22, 68, 34, 52, 404, 324, 280, 106, 500, 500, 48, 46, 500, 88, 36, 500, 36, 500, 38, 38, 48, 500, 500, 252, 500, 24, 30, 32, 42, 84, 372, 500, 32, 208, 500, 500, 218, 500, 500, 500, 268, 40, 246, 128, 500, 500, 154, 48, 116, 500, 52, 500, 74, 30, 60, 500, 30, 500, 44, 500, 500, 68, 34, 96, 500, 58, 98, 66, 62, 54, 28, 500, 500, 32, 162, 34, 266, 116, 500, 500, 74, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41084920146353915, "mean_inference_ms": 1.3069387064409363, "mean_action_processing_ms": 0.15527091956684613, "mean_env_wait_ms": 0.09140783308166052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023994922637939453, "StateBufferConnector_ms": 0.002994537353515625, "ViewRequirementAgentConnector_ms": 0.12200665473937988}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5123.825251619633, "num_env_steps_trained_throughput_per_sec": 5123.825251619633, "timesteps_total": 1380000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 2496.776, "sample_time_ms": 2205.801, "load_time_ms": 14.5, "load_throughput": 827605.367, "learn_time_ms": 265.974, "learn_throughput": 45117.209, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "episodes_total": 5315, "training_iteration": 115, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-39", "timestamp": 1698245259, "time_this_iter_s": 2.3479995727539062, "time_total_s": 268.791535615921, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 268.791535615921, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 61.37500000000001, "ram_util_percent": 28.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.814824860968091e-36, "cur_lr": 0.0003, "total_loss": 6.0720312118530275, "policy_loss": -0.0002008054405450821, "vf_loss": 6.072279040018717, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.00040404019547395363, "entropy": 0.47022929390271506, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1733.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.911999999999811, "episode_len_mean": 261.46, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 24.899999999999913, -50.00000000000044, 47.7, 47.1, 46.9, 45.9, 41.70000000000002, 12.899999999999743, -50.00000000000044, 46.9, 29.299999999999976, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, 46.099999999999994, 25.499999999999922, 37.300000000000026, -50.00000000000044, -50.00000000000044, 34.70000000000004, 45.3, 38.50000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.70000000000001, 47.1, 44.10000000000001, -50.00000000000044, 47.1, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.699999999999996, 40.500000000000014, -50.00000000000044, 44.300000000000004, 40.30000000000002, 43.50000000000001, 43.900000000000006, 44.7, 47.3, -50.00000000000044, -50.00000000000044, 46.9, 33.90000000000004, 46.699999999999996, 23.499999999999893, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.699999999999996, 39.300000000000026, 46.699999999999996, 44.900000000000006, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 43.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 47.1, 41.100000000000016, 45.1], "episode_lengths": [500, 252, 500, 24, 30, 32, 42, 84, 372, 500, 32, 208, 500, 500, 218, 500, 500, 500, 268, 40, 246, 128, 500, 500, 154, 48, 116, 500, 52, 500, 74, 30, 60, 500, 30, 500, 44, 500, 500, 68, 34, 96, 500, 58, 98, 66, 62, 54, 28, 500, 500, 32, 162, 34, 266, 116, 500, 500, 74, 38, 500, 500, 500, 50, 34, 108, 34, 52, 500, 62, 500, 66, 500, 60, 500, 500, 58, 500, 500, 68, 500, 500, 48, 500, 500, 72, 46, 500, 500, 500, 500, 500, 192, 70, 86, 500, 500, 30, 90, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4104520311815786, "mean_inference_ms": 1.3064776640071927, "mean_action_processing_ms": 0.15543078790524217, "mean_env_wait_ms": 0.09108731916583737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029996633529663086, "StateBufferConnector_ms": 0.002994537353515625, "ViewRequirementAgentConnector_ms": 0.11901569366455078}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.911999999999811, "episode_len_mean": 261.46, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 24.899999999999913, -50.00000000000044, 47.7, 47.1, 46.9, 45.9, 41.70000000000002, 12.899999999999743, -50.00000000000044, 46.9, 29.299999999999976, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, 46.099999999999994, 25.499999999999922, 37.300000000000026, -50.00000000000044, -50.00000000000044, 34.70000000000004, 45.3, 38.50000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.70000000000001, 47.1, 44.10000000000001, -50.00000000000044, 47.1, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.699999999999996, 40.500000000000014, -50.00000000000044, 44.300000000000004, 40.30000000000002, 43.50000000000001, 43.900000000000006, 44.7, 47.3, -50.00000000000044, -50.00000000000044, 46.9, 33.90000000000004, 46.699999999999996, 23.499999999999893, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.699999999999996, 39.300000000000026, 46.699999999999996, 44.900000000000006, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 43.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 47.1, 41.100000000000016, 45.1], "episode_lengths": [500, 252, 500, 24, 30, 32, 42, 84, 372, 500, 32, 208, 500, 500, 218, 500, 500, 500, 268, 40, 246, 128, 500, 500, 154, 48, 116, 500, 52, 500, 74, 30, 60, 500, 30, 500, 44, 500, 500, 68, 34, 96, 500, 58, 98, 66, 62, 54, 28, 500, 500, 32, 162, 34, 266, 116, 500, 500, 74, 38, 500, 500, 500, 50, 34, 108, 34, 52, 500, 62, 500, 66, 500, 60, 500, 500, 58, 500, 500, 68, 500, 500, 48, 500, 500, 72, 46, 500, 500, 500, 500, 500, 192, 70, 86, 500, 500, 30, 90, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4104520311815786, "mean_inference_ms": 1.3064776640071927, "mean_action_processing_ms": 0.15543078790524217, "mean_env_wait_ms": 0.09108731916583737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029996633529663086, "StateBufferConnector_ms": 0.002994537353515625, "ViewRequirementAgentConnector_ms": 0.11901569366455078}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5388.4114513215845, "num_env_steps_trained_throughput_per_sec": 5388.4114513215845, "timesteps_total": 1392000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 2373.076, "sample_time_ms": 2100.001, "load_time_ms": 13.199, "load_throughput": 909156.804, "learn_time_ms": 249.475, "learn_throughput": 48101.104, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "episodes_total": 5355, "training_iteration": 116, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-42", "timestamp": 1698245262, "time_this_iter_s": 2.2320005893707275, "time_total_s": 271.02353620529175, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 271.02353620529175, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 64.96666666666665, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4074124304840456e-36, "cur_lr": 0.0003, "total_loss": 6.490155347188314, "policy_loss": -0.0005390298863252004, "vf_loss": 6.490737851460775, "vf_explained_var": -1.0172526041666667e-06, "kl": 0.0006954684880724927, "entropy": 0.43476446469624835, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1748.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.887999999999809, "episode_len_mean": 261.7, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.9, 33.90000000000004, 46.699999999999996, 23.499999999999893, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.699999999999996, 39.300000000000026, 46.699999999999996, 44.900000000000006, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 43.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 47.1, 41.100000000000016, 45.1, -50.00000000000044, 41.100000000000016, 44.5, 45.7, 47.1, 42.30000000000001, 45.7, 44.5, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044, 40.500000000000014, 45.5, 45.5, 11.499999999999723, 47.3, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.3, 44.900000000000006, 28.89999999999997, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 34.50000000000004, 34.10000000000004, 43.900000000000006, 7.899999999999672, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.9, 46.099999999999994, 28.699999999999967, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 32, 162, 34, 266, 116, 500, 500, 74, 38, 500, 500, 500, 50, 34, 108, 34, 52, 500, 62, 500, 66, 500, 60, 500, 500, 58, 500, 500, 68, 500, 500, 48, 500, 500, 72, 46, 500, 500, 500, 500, 500, 192, 70, 86, 500, 500, 30, 90, 50, 500, 90, 56, 44, 30, 78, 44, 56, 500, 500, 32, 30, 500, 96, 46, 46, 386, 28, 500, 252, 500, 500, 182, 500, 500, 54, 500, 38, 52, 212, 500, 500, 48, 500, 30, 156, 160, 62, 422, 52, 34, 500, 500, 70, 32, 40, 214, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.410647533758967, "mean_inference_ms": 1.3061850414186404, "mean_action_processing_ms": 0.15466930596152503, "mean_env_wait_ms": 0.09130469411333238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025994062423706055, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.12702155113220215}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.887999999999809, "episode_len_mean": 261.7, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.9, 33.90000000000004, 46.699999999999996, 23.499999999999893, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.699999999999996, 39.300000000000026, 46.699999999999996, 44.900000000000006, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 43.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 47.1, 41.100000000000016, 45.1, -50.00000000000044, 41.100000000000016, 44.5, 45.7, 47.1, 42.30000000000001, 45.7, 44.5, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044, 40.500000000000014, 45.5, 45.5, 11.499999999999723, 47.3, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.3, 44.900000000000006, 28.89999999999997, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 34.50000000000004, 34.10000000000004, 43.900000000000006, 7.899999999999672, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.9, 46.099999999999994, 28.699999999999967, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 32, 162, 34, 266, 116, 500, 500, 74, 38, 500, 500, 500, 50, 34, 108, 34, 52, 500, 62, 500, 66, 500, 60, 500, 500, 58, 500, 500, 68, 500, 500, 48, 500, 500, 72, 46, 500, 500, 500, 500, 500, 192, 70, 86, 500, 500, 30, 90, 50, 500, 90, 56, 44, 30, 78, 44, 56, 500, 500, 32, 30, 500, 96, 46, 46, 386, 28, 500, 252, 500, 500, 182, 500, 500, 54, 500, 38, 52, 212, 500, 500, 48, 500, 30, 156, 160, 62, 422, 52, 34, 500, 500, 70, 32, 40, 214, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.410647533758967, "mean_inference_ms": 1.3061850414186404, "mean_action_processing_ms": 0.15466930596152503, "mean_env_wait_ms": 0.09130469411333238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025994062423706055, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.12702155113220215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5134.788424670335, "num_env_steps_trained_throughput_per_sec": 5134.788424670335, "timesteps_total": 1404000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 2278.775, "sample_time_ms": 1995.701, "load_time_ms": 14.599, "load_throughput": 821974.7, "learn_time_ms": 258.375, "learn_throughput": 46444.199, "synch_weights_time_ms": 9.102}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5404, "training_iteration": 117, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-44", "timestamp": 1698245264, "time_this_iter_s": 2.3419992923736572, "time_total_s": 273.3655354976654, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 273.3655354976654, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 63.46666666666667, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2037062152420228e-36, "cur_lr": 0.0003, "total_loss": 6.964943758646647, "policy_loss": -0.000724685937166214, "vf_loss": 6.96571356455485, "vf_explained_var": -1.1046727498372397e-06, "kl": 0.0007849580208054856, "entropy": 0.45091890295346576, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1763.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.674999999999846, "episode_len_mean": 228.94, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 47.1, -50.00000000000044, 40.500000000000014, 45.5, 45.5, 11.499999999999723, 47.3, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.3, 44.900000000000006, 28.89999999999997, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 34.50000000000004, 34.10000000000004, 43.900000000000006, 7.899999999999672, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.9, 46.099999999999994, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 2.299999999999592, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.7, 44.5, 47.3, -50.00000000000044, 45.7, 46.9, 10.899999999999714, 46.9, 44.7, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.50000000000001, 34.30000000000004, 39.70000000000002, 45.3, 46.3, 45.1, 17.899999999999814, 25.899999999999928, 47.7, 47.3, 46.5, 43.30000000000001, 43.30000000000001, 40.500000000000014, 47.3, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 47.9, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.9, 30.099999999999987, 47.1, -50.00000000000044, 36.900000000000034, 46.5, 15.49999999999978, 44.10000000000001, 43.50000000000001, 37.10000000000003], "episode_lengths": [500, 32, 30, 500, 96, 46, 46, 386, 28, 500, 252, 500, 500, 182, 500, 500, 54, 500, 38, 52, 212, 500, 500, 48, 500, 30, 156, 160, 62, 422, 52, 34, 500, 500, 70, 32, 40, 214, 500, 500, 500, 234, 36, 500, 500, 500, 114, 478, 500, 100, 500, 44, 56, 28, 500, 44, 32, 392, 32, 54, 500, 286, 500, 500, 58, 66, 158, 104, 48, 38, 50, 322, 242, 24, 28, 36, 68, 68, 96, 28, 54, 34, 500, 500, 500, 36, 22, 500, 78, 500, 32, 200, 30, 500, 132, 36, 346, 60, 66, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4108498662829305, "mean_inference_ms": 1.3058720385140965, "mean_action_processing_ms": 0.15524347610917602, "mean_env_wait_ms": 0.09152830717062177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01799488067626953, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.15801429748535156}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.674999999999846, "episode_len_mean": 228.94, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 47.1, -50.00000000000044, 40.500000000000014, 45.5, 45.5, 11.499999999999723, 47.3, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.3, 44.900000000000006, 28.89999999999997, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 34.50000000000004, 34.10000000000004, 43.900000000000006, 7.899999999999672, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.9, 46.099999999999994, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 2.299999999999592, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.7, 44.5, 47.3, -50.00000000000044, 45.7, 46.9, 10.899999999999714, 46.9, 44.7, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.50000000000001, 34.30000000000004, 39.70000000000002, 45.3, 46.3, 45.1, 17.899999999999814, 25.899999999999928, 47.7, 47.3, 46.5, 43.30000000000001, 43.30000000000001, 40.500000000000014, 47.3, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 47.9, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.9, 30.099999999999987, 47.1, -50.00000000000044, 36.900000000000034, 46.5, 15.49999999999978, 44.10000000000001, 43.50000000000001, 37.10000000000003], "episode_lengths": [500, 32, 30, 500, 96, 46, 46, 386, 28, 500, 252, 500, 500, 182, 500, 500, 54, 500, 38, 52, 212, 500, 500, 48, 500, 30, 156, 160, 62, 422, 52, 34, 500, 500, 70, 32, 40, 214, 500, 500, 500, 234, 36, 500, 500, 500, 114, 478, 500, 100, 500, 44, 56, 28, 500, 44, 32, 392, 32, 54, 500, 286, 500, 500, 58, 66, 158, 104, 48, 38, 50, 322, 242, 24, 28, 36, 68, 68, 96, 28, 54, 34, 500, 500, 500, 36, 22, 500, 78, 500, 32, 200, 30, 500, 132, 36, 346, 60, 66, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4108498662829305, "mean_inference_ms": 1.3058720385140965, "mean_action_processing_ms": 0.15524347610917602, "mean_env_wait_ms": 0.09152830717062177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01799488067626953, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.15801429748535156}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5398.101277633931, "num_env_steps_trained_throughput_per_sec": 5398.101277633931, "timesteps_total": 1416000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 2261.576, "sample_time_ms": 1995.601, "load_time_ms": 13.999, "load_throughput": 857209.366, "learn_time_ms": 241.875, "learn_throughput": 49612.475, "synch_weights_time_ms": 9.102}, "counters": {"num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "episodes_total": 5464, "training_iteration": 118, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-46", "timestamp": 1698245266, "time_this_iter_s": 2.227999210357666, "time_total_s": 275.59353470802307, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 275.59353470802307, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 62.23333333333333, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.018531076210114e-37, "cur_lr": 0.0003, "total_loss": 6.447836017608642, "policy_loss": -0.0003510524829228719, "vf_loss": 6.448233032226563, "vf_explained_var": -8.185704549153645e-07, "kl": 0.0003114567727607209, "entropy": 0.46021099090576173, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1778.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.893999999999867, "episode_len_mean": 201.78, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 47.3, -50.00000000000044, 45.7, 46.9, 10.899999999999714, 46.9, 44.7, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.50000000000001, 34.30000000000004, 39.70000000000002, 45.3, 46.3, 45.1, 17.899999999999814, 25.899999999999928, 47.7, 47.3, 46.5, 43.30000000000001, 43.30000000000001, 40.500000000000014, 47.3, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 47.9, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.9, 30.099999999999987, 47.1, -50.00000000000044, 36.900000000000034, 46.5, 15.49999999999978, 44.10000000000001, 43.50000000000001, 37.10000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.9, -50.00000000000044, -50.00000000000044, 47.5, 21.09999999999986, -50.00000000000044, 45.9, -50.00000000000044, 45.7, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.5, 45.1, 44.10000000000001, 46.3, 40.30000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.10000000000002, 46.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.9, 47.1, 27.299999999999947, 47.1, 39.90000000000002, 46.9, 33.70000000000004, 45.7, 44.5, -50.00000000000044, 42.70000000000001, 35.500000000000036, 45.9, 36.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.30000000000002, 46.3], "episode_lengths": [56, 28, 500, 44, 32, 392, 32, 54, 500, 286, 500, 500, 58, 66, 158, 104, 48, 38, 50, 322, 242, 24, 28, 36, 68, 68, 96, 28, 54, 34, 500, 500, 500, 36, 22, 500, 78, 500, 32, 200, 30, 500, 132, 36, 346, 60, 66, 130, 500, 64, 500, 500, 98, 32, 500, 500, 26, 290, 500, 42, 500, 44, 54, 500, 500, 500, 500, 114, 46, 50, 60, 38, 98, 500, 34, 500, 120, 32, 40, 500, 500, 22, 30, 228, 30, 102, 32, 164, 44, 56, 500, 74, 146, 42, 136, 500, 500, 40, 98, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4108249720627694, "mean_inference_ms": 1.3071955071194057, "mean_action_processing_ms": 0.15638396873029134, "mean_env_wait_ms": 0.09143078012558982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025000333786010742, "StateBufferConnector_ms": 0.008998632431030273, "ViewRequirementAgentConnector_ms": 0.15403079986572266}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.893999999999867, "episode_len_mean": 201.78, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 47.3, -50.00000000000044, 45.7, 46.9, 10.899999999999714, 46.9, 44.7, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.50000000000001, 34.30000000000004, 39.70000000000002, 45.3, 46.3, 45.1, 17.899999999999814, 25.899999999999928, 47.7, 47.3, 46.5, 43.30000000000001, 43.30000000000001, 40.500000000000014, 47.3, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 47.9, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.9, 30.099999999999987, 47.1, -50.00000000000044, 36.900000000000034, 46.5, 15.49999999999978, 44.10000000000001, 43.50000000000001, 37.10000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.9, -50.00000000000044, -50.00000000000044, 47.5, 21.09999999999986, -50.00000000000044, 45.9, -50.00000000000044, 45.7, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.5, 45.1, 44.10000000000001, 46.3, 40.30000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.10000000000002, 46.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.9, 47.1, 27.299999999999947, 47.1, 39.90000000000002, 46.9, 33.70000000000004, 45.7, 44.5, -50.00000000000044, 42.70000000000001, 35.500000000000036, 45.9, 36.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.30000000000002, 46.3], "episode_lengths": [56, 28, 500, 44, 32, 392, 32, 54, 500, 286, 500, 500, 58, 66, 158, 104, 48, 38, 50, 322, 242, 24, 28, 36, 68, 68, 96, 28, 54, 34, 500, 500, 500, 36, 22, 500, 78, 500, 32, 200, 30, 500, 132, 36, 346, 60, 66, 130, 500, 64, 500, 500, 98, 32, 500, 500, 26, 290, 500, 42, 500, 44, 54, 500, 500, 500, 500, 114, 46, 50, 60, 38, 98, 500, 34, 500, 120, 32, 40, 500, 500, 22, 30, 228, 30, 102, 32, 164, 44, 56, 500, 74, 146, 42, 136, 500, 500, 40, 98, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4108249720627694, "mean_inference_ms": 1.3071955071194057, "mean_action_processing_ms": 0.15638396873029134, "mean_env_wait_ms": 0.09143078012558982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025000333786010742, "StateBufferConnector_ms": 0.008998632431030273, "ViewRequirementAgentConnector_ms": 0.15403079986572266}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3998.666889858011, "num_env_steps_trained_throughput_per_sec": 3998.666889858011, "timesteps_total": 1428000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 2347.676, "sample_time_ms": 2061.501, "load_time_ms": 14.899, "load_throughput": 805419.771, "learn_time_ms": 260.375, "learn_throughput": 46087.446, "synch_weights_time_ms": 9.901}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "episodes_total": 5516, "training_iteration": 119, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-49", "timestamp": 1698245269, "time_this_iter_s": 3.008000135421753, "time_total_s": 278.6015348434448, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 278.6015348434448, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 78.5, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.009265538105057e-37, "cur_lr": 0.0003, "total_loss": 6.000043169657389, "policy_loss": -3.8537879784901934e-05, "vf_loss": 6.000127951304118, "vf_explained_var": -1.3113021850585938e-06, "kl": 0.00015169693013679839, "entropy": 0.4624534746011098, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1793.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.099999999999812, "episode_len_mean": 259.6, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.9, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.9, 30.099999999999987, 47.1, -50.00000000000044, 36.900000000000034, 46.5, 15.49999999999978, 44.10000000000001, 43.50000000000001, 37.10000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.9, -50.00000000000044, -50.00000000000044, 47.5, 21.09999999999986, -50.00000000000044, 45.9, -50.00000000000044, 45.7, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.5, 45.1, 44.10000000000001, 46.3, 40.30000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.10000000000002, 46.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.9, 47.1, 27.299999999999947, 47.1, 39.90000000000002, 46.9, 33.70000000000004, 45.7, 44.5, -50.00000000000044, 42.70000000000001, 35.500000000000036, 45.9, 36.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.30000000000002, 46.3, 13.499999999999751, 43.30000000000001, 45.7, 15.899999999999785, -50.00000000000044, -50.00000000000044, 16.699999999999797, -50.00000000000044, 46.3, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 45.7, -50.00000000000044, 44.5, -50.00000000000044, 47.7, 35.30000000000004, 18.099999999999817, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [22, 500, 78, 500, 32, 200, 30, 500, 132, 36, 346, 60, 66, 130, 500, 64, 500, 500, 98, 32, 500, 500, 26, 290, 500, 42, 500, 44, 54, 500, 500, 500, 500, 114, 46, 50, 60, 38, 98, 500, 34, 500, 120, 32, 40, 500, 500, 22, 30, 228, 30, 102, 32, 164, 44, 56, 500, 74, 146, 42, 136, 500, 500, 40, 98, 38, 366, 68, 44, 342, 500, 500, 334, 500, 38, 88, 500, 500, 500, 80, 500, 500, 500, 500, 64, 500, 44, 500, 56, 500, 24, 148, 320, 500, 248, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41172428556589097, "mean_inference_ms": 1.308971808713398, "mean_action_processing_ms": 0.15618772394113556, "mean_env_wait_ms": 0.09149101575082592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0200040340423584, "StateBufferConnector_ms": 0.007997512817382812, "ViewRequirementAgentConnector_ms": 0.13602948188781738}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.099999999999812, "episode_len_mean": 259.6, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.9, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.9, 30.099999999999987, 47.1, -50.00000000000044, 36.900000000000034, 46.5, 15.49999999999978, 44.10000000000001, 43.50000000000001, 37.10000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.9, -50.00000000000044, -50.00000000000044, 47.5, 21.09999999999986, -50.00000000000044, 45.9, -50.00000000000044, 45.7, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.5, 45.1, 44.10000000000001, 46.3, 40.30000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.10000000000002, 46.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.9, 47.1, 27.299999999999947, 47.1, 39.90000000000002, 46.9, 33.70000000000004, 45.7, 44.5, -50.00000000000044, 42.70000000000001, 35.500000000000036, 45.9, 36.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.30000000000002, 46.3, 13.499999999999751, 43.30000000000001, 45.7, 15.899999999999785, -50.00000000000044, -50.00000000000044, 16.699999999999797, -50.00000000000044, 46.3, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 45.7, -50.00000000000044, 44.5, -50.00000000000044, 47.7, 35.30000000000004, 18.099999999999817, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [22, 500, 78, 500, 32, 200, 30, 500, 132, 36, 346, 60, 66, 130, 500, 64, 500, 500, 98, 32, 500, 500, 26, 290, 500, 42, 500, 44, 54, 500, 500, 500, 500, 114, 46, 50, 60, 38, 98, 500, 34, 500, 120, 32, 40, 500, 500, 22, 30, 228, 30, 102, 32, 164, 44, 56, 500, 74, 146, 42, 136, 500, 500, 40, 98, 38, 366, 68, 44, 342, 500, 500, 334, 500, 38, 88, 500, 500, 500, 80, 500, 500, 500, 500, 64, 500, 44, 500, 56, 500, 24, 148, 320, 500, 248, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41172428556589097, "mean_inference_ms": 1.308971808713398, "mean_action_processing_ms": 0.15618772394113556, "mean_env_wait_ms": 0.09149101575082592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0200040340423584, "StateBufferConnector_ms": 0.007997512817382812, "ViewRequirementAgentConnector_ms": 0.13602948188781738}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3701.417126417678, "num_env_steps_trained_throughput_per_sec": 3701.417126417678, "timesteps_total": 1440000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 2439.076, "sample_time_ms": 2143.201, "load_time_ms": 15.299, "load_throughput": 784360.797, "learn_time_ms": 269.375, "learn_throughput": 44547.632, "synch_weights_time_ms": 9.901}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5550, "training_iteration": 120, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-52", "timestamp": 1698245272, "time_this_iter_s": 3.248000144958496, "time_total_s": 281.8495349884033, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 281.8495349884033, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 91.75000000000001, "ram_util_percent": 27.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5046327690525285e-37, "cur_lr": 0.0003, "total_loss": 6.464898808797201, "policy_loss": -0.0006004550339033206, "vf_loss": 6.465546258290609, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.0006277292480827868, "entropy": 0.4697013278802236, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1808.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.3259999999998073, "episode_len_mean": 267.34, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, 27.299999999999947, 47.1, 39.90000000000002, 46.9, 33.70000000000004, 45.7, 44.5, -50.00000000000044, 42.70000000000001, 35.500000000000036, 45.9, 36.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.30000000000002, 46.3, 13.499999999999751, 43.30000000000001, 45.7, 15.899999999999785, -50.00000000000044, -50.00000000000044, 16.699999999999797, -50.00000000000044, 46.3, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 45.7, -50.00000000000044, 44.5, -50.00000000000044, 47.7, 35.30000000000004, 18.099999999999817, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.299999999999677, 46.5, 45.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.5, 46.5, 16.09999999999979, 47.5, -50.00000000000044, -50.00000000000044, 46.9, 3.899999999999615, -50.00000000000044, -50.00000000000044, 45.1, 45.9, 36.30000000000003, 24.69999999999991, 46.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 36.900000000000034, -50.00000000000044, 47.1, 43.10000000000001, 43.10000000000001, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 45.7, 33.10000000000003, 38.700000000000024, -50.00000000000044, 46.5, 38.10000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [30, 228, 30, 102, 32, 164, 44, 56, 500, 74, 146, 42, 136, 500, 500, 40, 98, 38, 366, 68, 44, 342, 500, 500, 334, 500, 38, 88, 500, 500, 500, 80, 500, 500, 500, 500, 64, 500, 44, 500, 56, 500, 24, 148, 320, 500, 248, 500, 500, 500, 500, 500, 418, 36, 46, 100, 500, 500, 500, 500, 86, 46, 36, 340, 26, 500, 500, 32, 462, 500, 500, 50, 42, 138, 254, 36, 44, 500, 500, 500, 500, 38, 132, 500, 30, 70, 70, 500, 38, 38, 500, 44, 170, 114, 500, 36, 120, 118, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4138417417299188, "mean_inference_ms": 1.3135641489971286, "mean_action_processing_ms": 0.15657497315004332, "mean_env_wait_ms": 0.09190613186480047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100205421447754, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.14900994300842285}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.3259999999998073, "episode_len_mean": 267.34, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, 27.299999999999947, 47.1, 39.90000000000002, 46.9, 33.70000000000004, 45.7, 44.5, -50.00000000000044, 42.70000000000001, 35.500000000000036, 45.9, 36.50000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.30000000000002, 46.3, 13.499999999999751, 43.30000000000001, 45.7, 15.899999999999785, -50.00000000000044, -50.00000000000044, 16.699999999999797, -50.00000000000044, 46.3, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 45.7, -50.00000000000044, 44.5, -50.00000000000044, 47.7, 35.30000000000004, 18.099999999999817, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.299999999999677, 46.5, 45.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.5, 46.5, 16.09999999999979, 47.5, -50.00000000000044, -50.00000000000044, 46.9, 3.899999999999615, -50.00000000000044, -50.00000000000044, 45.1, 45.9, 36.30000000000003, 24.69999999999991, 46.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 36.900000000000034, -50.00000000000044, 47.1, 43.10000000000001, 43.10000000000001, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 45.7, 33.10000000000003, 38.700000000000024, -50.00000000000044, 46.5, 38.10000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [30, 228, 30, 102, 32, 164, 44, 56, 500, 74, 146, 42, 136, 500, 500, 40, 98, 38, 366, 68, 44, 342, 500, 500, 334, 500, 38, 88, 500, 500, 500, 80, 500, 500, 500, 500, 64, 500, 44, 500, 56, 500, 24, 148, 320, 500, 248, 500, 500, 500, 500, 500, 418, 36, 46, 100, 500, 500, 500, 500, 86, 46, 36, 340, 26, 500, 500, 32, 462, 500, 500, 50, 42, 138, 254, 36, 44, 500, 500, 500, 500, 38, 132, 500, 30, 70, 70, 500, 38, 38, 500, 44, 170, 114, 500, 36, 120, 118, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4138417417299188, "mean_inference_ms": 1.3135641489971286, "mean_action_processing_ms": 0.15657497315004332, "mean_env_wait_ms": 0.09190613186480047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100205421447754, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.14900994300842285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3729.024313805681, "num_env_steps_trained_throughput_per_sec": 3729.024313805681, "timesteps_total": 1452000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 2530.201, "sample_time_ms": 2233.901, "load_time_ms": 14.299, "load_throughput": 839225.863, "learn_time_ms": 270.5, "learn_throughput": 44362.313, "synch_weights_time_ms": 10.101}, "counters": {"num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "episodes_total": 5598, "training_iteration": 121, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-56", "timestamp": 1698245276, "time_this_iter_s": 3.2240002155303955, "time_total_s": 285.0735352039337, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 285.0735352039337, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 88.53999999999999, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.523163845262643e-38, "cur_lr": 0.0003, "total_loss": 6.137208938598633, "policy_loss": -0.00014496619502703348, "vf_loss": 6.137398783365885, "vf_explained_var": -1.0093053181966146e-06, "kl": 0.0003688309117175474, "entropy": 0.4482798119386037, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1823.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1469999999998013, "episode_len_mean": 274.1, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.099999999999817, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.299999999999677, 46.5, 45.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.5, 46.5, 16.09999999999979, 47.5, -50.00000000000044, -50.00000000000044, 46.9, 3.899999999999615, -50.00000000000044, -50.00000000000044, 45.1, 45.9, 36.30000000000003, 24.69999999999991, 46.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 36.900000000000034, -50.00000000000044, 47.1, 43.10000000000001, 43.10000000000001, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 45.7, 33.10000000000003, 38.700000000000024, -50.00000000000044, 46.5, 38.10000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 46.3, 25.899999999999928, 38.50000000000003, 32.100000000000016, -50.00000000000044, 46.099999999999994, 46.9, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 46.3, 31.500000000000007, -50.00000000000044, 42.10000000000001, 45.7, 47.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 29.299999999999976, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.70000000000002], "episode_lengths": [320, 500, 248, 500, 500, 500, 500, 500, 418, 36, 46, 100, 500, 500, 500, 500, 86, 46, 36, 340, 26, 500, 500, 32, 462, 500, 500, 50, 42, 138, 254, 36, 44, 500, 500, 500, 500, 38, 132, 500, 30, 70, 70, 500, 38, 38, 500, 44, 170, 114, 500, 36, 120, 118, 500, 500, 500, 44, 38, 38, 242, 116, 180, 500, 40, 32, 40, 42, 500, 500, 500, 500, 500, 500, 132, 38, 186, 500, 80, 44, 28, 60, 500, 500, 88, 500, 500, 54, 92, 500, 500, 66, 208, 68, 500, 500, 500, 92, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4148036644926908, "mean_inference_ms": 1.3181696915668828, "mean_action_processing_ms": 0.1564354672212232, "mean_env_wait_ms": 0.09208373896246266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033005714416503906, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.15599298477172852}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1469999999998013, "episode_len_mean": 274.1, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.099999999999817, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.299999999999677, 46.5, 45.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.5, 46.5, 16.09999999999979, 47.5, -50.00000000000044, -50.00000000000044, 46.9, 3.899999999999615, -50.00000000000044, -50.00000000000044, 45.1, 45.9, 36.30000000000003, 24.69999999999991, 46.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 36.900000000000034, -50.00000000000044, 47.1, 43.10000000000001, 43.10000000000001, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 45.7, 33.10000000000003, 38.700000000000024, -50.00000000000044, 46.5, 38.10000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 46.3, 25.899999999999928, 38.50000000000003, 32.100000000000016, -50.00000000000044, 46.099999999999994, 46.9, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 46.3, 31.500000000000007, -50.00000000000044, 42.10000000000001, 45.7, 47.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 29.299999999999976, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.70000000000002], "episode_lengths": [320, 500, 248, 500, 500, 500, 500, 500, 418, 36, 46, 100, 500, 500, 500, 500, 86, 46, 36, 340, 26, 500, 500, 32, 462, 500, 500, 50, 42, 138, 254, 36, 44, 500, 500, 500, 500, 38, 132, 500, 30, 70, 70, 500, 38, 38, 500, 44, 170, 114, 500, 36, 120, 118, 500, 500, 500, 44, 38, 38, 242, 116, 180, 500, 40, 32, 40, 42, 500, 500, 500, 500, 500, 500, 132, 38, 186, 500, 80, 44, 28, 60, 500, 500, 88, 500, 500, 54, 92, 500, 500, 66, 208, 68, 500, 500, 500, 92, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4148036644926908, "mean_inference_ms": 1.3181696915668828, "mean_action_processing_ms": 0.1564354672212232, "mean_env_wait_ms": 0.09208373896246266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033005714416503906, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.15599298477172852}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3650.7443669727327, "num_env_steps_trained_throughput_per_sec": 3650.7443669727327, "timesteps_total": 1464000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 2646.101, "sample_time_ms": 2343.601, "load_time_ms": 14.599, "load_throughput": 821978.727, "learn_time_ms": 276.4, "learn_throughput": 43415.386, "synch_weights_time_ms": 10.101}, "counters": {"num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "episodes_total": 5642, "training_iteration": 122, "trial_id": "9f288_00003", "date": "2023-10-25_15-47-59", "timestamp": 1698245279, "time_this_iter_s": 3.2930002212524414, "time_total_s": 288.36653542518616, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 288.36653542518616, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 92.77499999999999, "ram_util_percent": 27.950000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7615819226313213e-38, "cur_lr": 0.0003, "total_loss": 6.046448008219401, "policy_loss": -0.0005701437592506408, "vf_loss": 6.0470605532328285, "vf_explained_var": -1.231829325358073e-06, "kl": 0.00039070461848496053, "entropy": 0.4234929919242859, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1838.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.5849999999998019, "episode_len_mean": 269.7, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 45.7, 33.10000000000003, 38.700000000000024, -50.00000000000044, 46.5, 38.10000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 46.3, 25.899999999999928, 38.50000000000003, 32.100000000000016, -50.00000000000044, 46.099999999999994, 46.9, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 46.3, 31.500000000000007, -50.00000000000044, 42.10000000000001, 45.7, 47.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 29.299999999999976, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.5, 43.7, 40.10000000000002, 46.5, 46.5, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 42.70000000000001, -50.00000000000044, 46.3, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 46.3, 45.1, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 45.7, 22.899999999999885, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044], "episode_lengths": [70, 500, 38, 38, 500, 44, 170, 114, 500, 36, 120, 118, 500, 500, 500, 44, 38, 38, 242, 116, 180, 500, 40, 32, 40, 42, 500, 500, 500, 500, 500, 500, 132, 38, 186, 500, 80, 44, 28, 60, 500, 500, 88, 500, 500, 54, 92, 500, 500, 66, 208, 68, 500, 500, 500, 92, 500, 84, 500, 500, 36, 64, 100, 36, 36, 34, 500, 34, 500, 78, 500, 500, 500, 266, 74, 500, 38, 500, 32, 500, 500, 500, 178, 500, 500, 38, 50, 500, 500, 28, 500, 36, 30, 500, 44, 272, 500, 500, 86, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4155724436131076, "mean_inference_ms": 1.3220473810434341, "mean_action_processing_ms": 0.15699330207150206, "mean_env_wait_ms": 0.09193237508729395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600430488586426, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.1829979419708252}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.5849999999998019, "episode_len_mean": 269.7, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 45.7, 33.10000000000003, 38.700000000000024, -50.00000000000044, 46.5, 38.10000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 46.3, 25.899999999999928, 38.50000000000003, 32.100000000000016, -50.00000000000044, 46.099999999999994, 46.9, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 46.3, 31.500000000000007, -50.00000000000044, 42.10000000000001, 45.7, 47.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 29.299999999999976, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.5, 43.7, 40.10000000000002, 46.5, 46.5, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 42.70000000000001, -50.00000000000044, 46.3, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 46.3, 45.1, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 45.7, 22.899999999999885, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044], "episode_lengths": [70, 500, 38, 38, 500, 44, 170, 114, 500, 36, 120, 118, 500, 500, 500, 44, 38, 38, 242, 116, 180, 500, 40, 32, 40, 42, 500, 500, 500, 500, 500, 500, 132, 38, 186, 500, 80, 44, 28, 60, 500, 500, 88, 500, 500, 54, 92, 500, 500, 66, 208, 68, 500, 500, 500, 92, 500, 84, 500, 500, 36, 64, 100, 36, 36, 34, 500, 34, 500, 78, 500, 500, 500, 266, 74, 500, 38, 500, 32, 500, 500, 500, 178, 500, 500, 38, 50, 500, 500, 28, 500, 36, 30, 500, 44, 272, 500, 500, 86, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4155724436131076, "mean_inference_ms": 1.3220473810434341, "mean_action_processing_ms": 0.15699330207150206, "mean_env_wait_ms": 0.09193237508729395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600430488586426, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.1829979419708252}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3550.2957377813304, "num_env_steps_trained_throughput_per_sec": 3550.2957377813304, "timesteps_total": 1476000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 2751.601, "sample_time_ms": 2440.801, "load_time_ms": 14.999, "load_throughput": 800060.531, "learn_time_ms": 283.5, "learn_throughput": 42328.077, "synch_weights_time_ms": 10.701}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5684, "training_iteration": 123, "trial_id": "9f288_00003", "date": "2023-10-25_15-48-02", "timestamp": 1698245282, "time_this_iter_s": 3.384999990463257, "time_total_s": 291.7515354156494, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 291.7515354156494, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 87.6, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8807909613156606e-38, "cur_lr": 0.0003, "total_loss": 6.909556770324707, "policy_loss": -0.00016930525501569112, "vf_loss": 6.909771664937337, "vf_explained_var": -8.662541707356771e-07, "kl": 0.000298889242454455, "entropy": 0.4551529129346212, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1853.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.1270000000002127, "episode_len_mean": 286.82, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 29.299999999999976, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.5, 43.7, 40.10000000000002, 46.5, 46.5, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 42.70000000000001, -50.00000000000044, 46.3, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 46.3, 45.1, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 45.7, 22.899999999999885, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, 45.5, -50.00000000000044, 45.5, 45.1, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 37.300000000000026, 31.500000000000007, 3.0999999999996035, 25.099999999999916, -50.00000000000044, 20.299999999999848, 46.3, 44.5, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 42.500000000000014, -50.00000000000044, 22.899999999999885, -50.00000000000044, 20.099999999999845, 40.70000000000002, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.5, 29.299999999999976, 47.1, 43.50000000000001, 45.1, 38.50000000000003, -50.00000000000044, 2.699999999999598, -50.00000000000044], "episode_lengths": [92, 500, 500, 66, 208, 68, 500, 500, 500, 92, 500, 84, 500, 500, 36, 64, 100, 36, 36, 34, 500, 34, 500, 78, 500, 500, 500, 266, 74, 500, 38, 500, 32, 500, 500, 500, 178, 500, 500, 38, 50, 500, 500, 28, 500, 36, 30, 500, 44, 272, 500, 500, 86, 500, 500, 302, 500, 46, 500, 46, 50, 500, 108, 500, 500, 128, 186, 470, 250, 500, 298, 38, 56, 500, 46, 500, 30, 76, 500, 272, 500, 300, 94, 500, 32, 500, 500, 88, 500, 500, 86, 36, 208, 30, 66, 50, 116, 500, 474, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4165775628318525, "mean_inference_ms": 1.3246753352934193, "mean_action_processing_ms": 0.15733781951554918, "mean_env_wait_ms": 0.09218943288152318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04201173782348633, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.17203092575073242}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.1270000000002127, "episode_len_mean": 286.82, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 29.299999999999976, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.5, 43.7, 40.10000000000002, 46.5, 46.5, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 42.70000000000001, -50.00000000000044, 46.3, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 46.3, 45.1, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 45.7, 22.899999999999885, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, 45.5, -50.00000000000044, 45.5, 45.1, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 37.300000000000026, 31.500000000000007, 3.0999999999996035, 25.099999999999916, -50.00000000000044, 20.299999999999848, 46.3, 44.5, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 42.500000000000014, -50.00000000000044, 22.899999999999885, -50.00000000000044, 20.099999999999845, 40.70000000000002, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.5, 29.299999999999976, 47.1, 43.50000000000001, 45.1, 38.50000000000003, -50.00000000000044, 2.699999999999598, -50.00000000000044], "episode_lengths": [92, 500, 500, 66, 208, 68, 500, 500, 500, 92, 500, 84, 500, 500, 36, 64, 100, 36, 36, 34, 500, 34, 500, 78, 500, 500, 500, 266, 74, 500, 38, 500, 32, 500, 500, 500, 178, 500, 500, 38, 50, 500, 500, 28, 500, 36, 30, 500, 44, 272, 500, 500, 86, 500, 500, 302, 500, 46, 500, 46, 50, 500, 108, 500, 500, 128, 186, 470, 250, 500, 298, 38, 56, 500, 46, 500, 30, 76, 500, 272, 500, 300, 94, 500, 32, 500, 500, 88, 500, 500, 86, 36, 208, 30, 66, 50, 116, 500, 474, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4165775628318525, "mean_inference_ms": 1.3246753352934193, "mean_action_processing_ms": 0.15733781951554918, "mean_env_wait_ms": 0.09218943288152318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04201173782348633, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.17203092575073242}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4864.206584294529, "num_env_steps_trained_throughput_per_sec": 4864.206584294529, "timesteps_total": 1488000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 2772.401, "sample_time_ms": 2465.101, "load_time_ms": 14.699, "load_throughput": 816380.405, "learn_time_ms": 280.3, "learn_throughput": 42811.321, "synch_weights_time_ms": 10.601}, "counters": {"num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "episodes_total": 5730, "training_iteration": 124, "trial_id": "9f288_00003", "date": "2023-10-25_15-48-05", "timestamp": 1698245285, "time_this_iter_s": 2.4730000495910645, "time_total_s": 294.2245354652405, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 294.2245354652405, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 82.03333333333335, "ram_util_percent": 27.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.403954806578303e-39, "cur_lr": 0.0003, "total_loss": 6.259126504262288, "policy_loss": -0.0005922476450602213, "vf_loss": 6.2597688357035315, "vf_explained_var": -1.0569890340169271e-06, "kl": 0.0009953985515418632, "entropy": 0.500406394402186, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1868.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.703999999999805, "episode_len_mean": 273.56, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 47.1, -50.00000000000044, 45.7, 22.899999999999885, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, 45.5, -50.00000000000044, 45.5, 45.1, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 37.300000000000026, 31.500000000000007, 3.0999999999996035, 25.099999999999916, -50.00000000000044, 20.299999999999848, 46.3, 44.5, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 42.500000000000014, -50.00000000000044, 22.899999999999885, -50.00000000000044, 20.099999999999845, 40.70000000000002, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.5, 29.299999999999976, 47.1, 43.50000000000001, 45.1, 38.50000000000003, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.90000000000002, 47.5, 41.500000000000014, -50.00000000000044, 18.899999999999828, 42.30000000000001, -50.00000000000044, 42.10000000000001, 31.500000000000007, -50.00000000000044, 44.10000000000001, 26.69999999999994, -50.00000000000044, -50.00000000000044, 7.899999999999672, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 45.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 33.30000000000003, 45.9, 44.7, 44.7, -50.00000000000044, 46.5, 37.10000000000003, 46.099999999999994, -50.00000000000044, 46.9, 47.1, 41.90000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 46.699999999999996], "episode_lengths": [500, 36, 30, 500, 44, 272, 500, 500, 86, 500, 500, 302, 500, 46, 500, 46, 50, 500, 108, 500, 500, 128, 186, 470, 250, 500, 298, 38, 56, 500, 46, 500, 30, 76, 500, 272, 500, 300, 94, 500, 32, 500, 500, 88, 500, 500, 86, 36, 208, 30, 66, 50, 116, 500, 474, 500, 500, 82, 92, 26, 86, 500, 312, 78, 500, 80, 186, 500, 60, 234, 500, 500, 422, 96, 500, 500, 500, 500, 242, 46, 500, 500, 76, 500, 168, 42, 54, 54, 500, 36, 130, 40, 500, 32, 30, 82, 500, 86, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4170697430166323, "mean_inference_ms": 1.3253182045285852, "mean_action_processing_ms": 0.15752175000009316, "mean_env_wait_ms": 0.09221580562631589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300642967224121, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.14602017402648926}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.703999999999805, "episode_len_mean": 273.56, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 47.1, -50.00000000000044, 45.7, 22.899999999999885, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, 45.5, -50.00000000000044, 45.5, 45.1, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 37.300000000000026, 31.500000000000007, 3.0999999999996035, 25.099999999999916, -50.00000000000044, 20.299999999999848, 46.3, 44.5, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 42.500000000000014, -50.00000000000044, 22.899999999999885, -50.00000000000044, 20.099999999999845, 40.70000000000002, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.5, 29.299999999999976, 47.1, 43.50000000000001, 45.1, 38.50000000000003, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.90000000000002, 47.5, 41.500000000000014, -50.00000000000044, 18.899999999999828, 42.30000000000001, -50.00000000000044, 42.10000000000001, 31.500000000000007, -50.00000000000044, 44.10000000000001, 26.69999999999994, -50.00000000000044, -50.00000000000044, 7.899999999999672, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 45.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 33.30000000000003, 45.9, 44.7, 44.7, -50.00000000000044, 46.5, 37.10000000000003, 46.099999999999994, -50.00000000000044, 46.9, 47.1, 41.90000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 46.699999999999996], "episode_lengths": [500, 36, 30, 500, 44, 272, 500, 500, 86, 500, 500, 302, 500, 46, 500, 46, 50, 500, 108, 500, 500, 128, 186, 470, 250, 500, 298, 38, 56, 500, 46, 500, 30, 76, 500, 272, 500, 300, 94, 500, 32, 500, 500, 88, 500, 500, 86, 36, 208, 30, 66, 50, 116, 500, 474, 500, 500, 82, 92, 26, 86, 500, 312, 78, 500, 80, 186, 500, 60, 234, 500, 500, 422, 96, 500, 500, 500, 500, 242, 46, 500, 500, 76, 500, 168, 42, 54, 54, 500, 36, 130, 40, 500, 32, 30, 82, 500, 86, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4170697430166323, "mean_inference_ms": 1.3253182045285852, "mean_action_processing_ms": 0.15752175000009316, "mean_env_wait_ms": 0.09221580562631589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300642967224121, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.14602017402648926}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5228.753650554087, "num_env_steps_trained_throughput_per_sec": 5228.753650554087, "timesteps_total": 1500000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 2767.701, "sample_time_ms": 2466.9, "load_time_ms": 14.799, "load_throughput": 810857.825, "learn_time_ms": 273.7, "learn_throughput": 43843.64, "synch_weights_time_ms": 10.701}, "counters": {"num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": true, "episodes_total": 5774, "training_iteration": 125, "trial_id": "9f288_00003", "date": "2023-10-25_15-48-07", "timestamp": 1698245287, "time_this_iter_s": 2.299999952316284, "time_total_s": 296.52453541755676, "pid": 20528, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 296.52453541755676, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 62.6, "ram_util_percent": 27.133333333333336}}
